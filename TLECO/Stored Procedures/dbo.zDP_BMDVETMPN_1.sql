SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_BMDVETMPN_1] (@BS int, @BENEFIT char(7), @BENEFIT_RS char(7), @BENEFIT_RE char(7)) AS  set nocount on IF @BENEFIT_RS IS NULL BEGIN SELECT TOP 25  BENEFIT, BENEFITCOST_I, BENEFITCOST2_I, MAXBENEFIT_I_1, MAXBENEFIT_I_2, MAXBENEFIT_I_3, MAXBENEFIT_I_4, MAXBENEFIT_I_5, MAXBENEFIT_I_6, MAXBENEFIT_I_7, MAXBENEFIT_I_8, MAXBENEFIT_I_9, MAXBENEFIT_I_10, MAXBENEFIT_I_11, MAXBENEFIT_I_12, MAXBENEFIT_I_13, MAXBENEFIT_I_14, MAXBENEFIT_I_15, MAXBENEFIT_I_16, MAXBENEFIT_I_17, MAXBENEFIT_I_18, MAXBENEFIT_I_19, MAXBENEFIT_I_20, NUMBERENROLLED_I, DEX_ROW_ID FROM .BMDVETMP WHERE ( BENEFIT > @BENEFIT ) ORDER BY BENEFIT ASC END ELSE IF @BENEFIT_RS = @BENEFIT_RE BEGIN SELECT TOP 25  BENEFIT, BENEFITCOST_I, BENEFITCOST2_I, MAXBENEFIT_I_1, MAXBENEFIT_I_2, MAXBENEFIT_I_3, MAXBENEFIT_I_4, MAXBENEFIT_I_5, MAXBENEFIT_I_6, MAXBENEFIT_I_7, MAXBENEFIT_I_8, MAXBENEFIT_I_9, MAXBENEFIT_I_10, MAXBENEFIT_I_11, MAXBENEFIT_I_12, MAXBENEFIT_I_13, MAXBENEFIT_I_14, MAXBENEFIT_I_15, MAXBENEFIT_I_16, MAXBENEFIT_I_17, MAXBENEFIT_I_18, MAXBENEFIT_I_19, MAXBENEFIT_I_20, NUMBERENROLLED_I, DEX_ROW_ID FROM .BMDVETMP WHERE BENEFIT = @BENEFIT_RS AND ( BENEFIT > @BENEFIT ) ORDER BY BENEFIT ASC END ELSE BEGIN SELECT TOP 25  BENEFIT, BENEFITCOST_I, BENEFITCOST2_I, MAXBENEFIT_I_1, MAXBENEFIT_I_2, MAXBENEFIT_I_3, MAXBENEFIT_I_4, MAXBENEFIT_I_5, MAXBENEFIT_I_6, MAXBENEFIT_I_7, MAXBENEFIT_I_8, MAXBENEFIT_I_9, MAXBENEFIT_I_10, MAXBENEFIT_I_11, MAXBENEFIT_I_12, MAXBENEFIT_I_13, MAXBENEFIT_I_14, MAXBENEFIT_I_15, MAXBENEFIT_I_16, MAXBENEFIT_I_17, MAXBENEFIT_I_18, MAXBENEFIT_I_19, MAXBENEFIT_I_20, NUMBERENROLLED_I, DEX_ROW_ID FROM .BMDVETMP WHERE BENEFIT BETWEEN @BENEFIT_RS AND @BENEFIT_RE AND ( BENEFIT > @BENEFIT ) ORDER BY BENEFIT ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_BMDVETMPN_1] TO [DYNGRP]
GO
