SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[taPopDistributionBuild]  @I_vPOPTYPE smallint=0,  @I_vPOPRCTNM char(17),   @I_vVENDORID char(15),  @I_vITEMNMBR char(30),  @I_vINDEX int,   @I_vDTSAMT numeric(19,5), @I_vCTSAMT numeric(19,5), @I_vTYPE int, @I_vCURRNIDX int, @I_vORDTAMT numeric(19,5), @I_vORCTAMT numeric(19,5), @I_vCURNCYID char(15),  @I_vRATETPID char(15),  @I_vEXGTBLID char(15),  @I_vXCHGRATE numeric(19,7),  @I_vEXCHDATE datetime,  @I_vTIME1 datetime,  @I_vRTCLCMTD smallint,  @O_iErrorState int output, @oErrString varchar(255) output  with encryption as  set transaction isolation level read uncommitted set nocount on  declare   @TYPE int,  @iStatus int,  @iError int,  @O_oErrorState int  select @O_iErrorState = 0,  @iStatus = 0,  @O_oErrorState = 0  if (  @I_vPOPTYPE is NULL or  @I_vPOPRCTNM is NULL or  @I_vVENDORID is NULL or  @I_vITEMNMBR is NULL or  @I_vDTSAMT is NULL or  @I_vTYPE is NULL or  @I_vCTSAMT is NULL or  @I_vCURRNIDX is NULL or  @I_vINDEX is NULL or  @I_vORDTAMT is NULL or  @I_vORCTAMT is NULL or  @I_vCURNCYID is NULL or  @I_vRATETPID is NULL or  @I_vEXGTBLID is NULL or  @I_vXCHGRATE is NULL or  @I_vEXCHDATE is NULL or  @I_vTIME1 is NULL or  @I_vRTCLCMTD is NULL) begin  select @O_iErrorState = 7150   return (@O_iErrorState) end  if(  @I_vPOPTYPE = 0 or  @I_vPOPRCTNM = '') begin  select @O_iErrorState = 7151   return (@O_iErrorState) end  select @I_vVENDORID = UPPER(@I_vVENDORID),  @I_vPOPRCTNM = UPPER(@I_vPOPRCTNM),  @I_vITEMNMBR = UPPER(@I_vITEMNMBR),  @I_vCURNCYID = UPPER(@I_vCURNCYID)  if ((@I_vDTSAMT > 0) or (@I_vCTSAMT > 0)) begin  if @I_vINDEX = 0  begin  exec @iStatus = taPopAuxAcctsGetIdx  @I_vPOPTYPE,  @I_vPOPRCTNM,  @I_vVENDORID,  @I_vITEMNMBR,  '',   @I_vTYPE ,  @I_vINDEX output,  @O_oErrorState output  select @iError = @@error   if @iStatus = 0 and @iError <> 0  select @iStatus = @iError   if (@iStatus <> 0) or (@O_oErrorState <> 0)  begin  select @O_iErrorState = 7152   return (@O_iErrorState)  end  end   exec @iStatus = taPopDistributionInsert  @I_vPOPTYPE,  @I_vPOPRCTNM,  @I_vINDEX,  @I_vDTSAMT,  @I_vCTSAMT,  @I_vTYPE,  @I_vCURRNIDX,  '',  '',  @I_vVENDORID,  @I_vORDTAMT,  @I_vORCTAMT,  @I_vCURNCYID,     @I_vRATETPID,     @I_vEXGTBLID,     @I_vXCHGRATE,     @I_vEXCHDATE,     @I_vTIME1,     @I_vRTCLCMTD,     @O_oErrorState output,  @oErrString output  select @iError = @@error  if @iStatus = 0 and @iError <> 0  select @iStatus = @iError  if (@iStatus <> 0) or (@O_oErrorState <> 0)  begin  select @O_iErrorState = 7153   return (@O_iErrorState)  end  end  return (@O_iErrorState)   
GO
GRANT EXECUTE ON  [dbo].[taPopDistributionBuild] TO [DYNGRP]
GO
