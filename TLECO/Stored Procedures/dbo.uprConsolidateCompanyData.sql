SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE  procedure [dbo].[uprConsolidateCompanyData]  @IN_TempFileName varchar(255)  as DECLARE @SQLString  varchar(1000)  SET @SQLString = 'INSERT INTO ' + @IN_TempFileName +' SELECT '' Consolidated Report'', PYRLRTYP, PAYROLCD ,'''' , '''' , '''' , '''' ,PYRLDSCR , ISNULL(SUM(MTDTXBWG), 0.0), ISNULL(SUM(MNTHHRS), 0.0), ISNULL(SUM(MNTHSWGS), 0.0), ISNULL(SUM(MNTHSTTL), 0.0), FLAG, ISNULL(SUM(MONTHTAX), 0.0), ISNULL(SUM(QTDHOURS), 0.0), ISNULL(SUM(QTDWAGES), 0.0), ISNULL(SUM(QTDTXWGS), 0.0), ISNULL(SUM(QTDTAX), 0.0), ISNULL(SUM(QTDTOTAL), 0.0), ISNULL(SUM(YTDHOURS), 0.0), ISNULL(SUM(YTDWAGES), 0.0), ISNULL(SUM(YTDTXWGS), 0.0), ISNULL(SUM(YTDTAX), 0.0), ISNULL(SUM(YTDTOTAL), 0.0) ' SET @SQLString = @SQLString + 'FROM ' + @IN_TempFileName  SET @SQLString = @SQLString + ' WHERE CMPNYNAM <> '''' ' SET @SQLString = @SQLString + ' GROUP BY PYRLRTYP, PAYROLCD, PYRLDSCR, FLAG '  EXEC(@SQLString)  return(@@ERROR)   
GO
GRANT EXECUTE ON  [dbo].[uprConsolidateCompanyData] TO [DYNGRP]
GO
