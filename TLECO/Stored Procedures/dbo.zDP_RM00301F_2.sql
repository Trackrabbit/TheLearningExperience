SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_RM00301F_2] (@SPRSNSLN_RS char(21), @SLPRSNFN_RS char(15), @SPRSNSMN_RS char(15), @SPRSNSLN_RE char(21), @SLPRSNFN_RE char(15), @SPRSNSMN_RE char(15)) AS  set nocount on IF @SPRSNSLN_RS IS NULL BEGIN SELECT TOP 25  SLPRSNID, EMPLOYID, VENDORID, SLPRSNFN, SPRSNSMN, SPRSNSLN, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIP, COUNTRY, PHONE1, PHONE2, PHONE3, FAX, INACTIVE, SALSTERR, COMMCODE, COMPRCNT, STDCPRCT, COMAPPTO, COSTTODT, CSTLSTYR, TTLCOMTD, TTLCOMLY, COMSLTDT, COMSLLYR, NCOMSLTD, NCOMSLYR, KPCALHST, KPERHIST, NOTEINDX, MODIFDT, CREATDDT, COMMDEST, DEX_ROW_TS, DEX_ROW_ID FROM .RM00301 ORDER BY SPRSNSLN ASC, SLPRSNFN ASC, SPRSNSMN ASC, DEX_ROW_ID ASC END ELSE IF @SPRSNSLN_RS = @SPRSNSLN_RE BEGIN SELECT TOP 25  SLPRSNID, EMPLOYID, VENDORID, SLPRSNFN, SPRSNSMN, SPRSNSLN, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIP, COUNTRY, PHONE1, PHONE2, PHONE3, FAX, INACTIVE, SALSTERR, COMMCODE, COMPRCNT, STDCPRCT, COMAPPTO, COSTTODT, CSTLSTYR, TTLCOMTD, TTLCOMLY, COMSLTDT, COMSLLYR, NCOMSLTD, NCOMSLYR, KPCALHST, KPERHIST, NOTEINDX, MODIFDT, CREATDDT, COMMDEST, DEX_ROW_TS, DEX_ROW_ID FROM .RM00301 WHERE SPRSNSLN = @SPRSNSLN_RS AND SLPRSNFN BETWEEN @SLPRSNFN_RS AND @SLPRSNFN_RE AND SPRSNSMN BETWEEN @SPRSNSMN_RS AND @SPRSNSMN_RE ORDER BY SPRSNSLN ASC, SLPRSNFN ASC, SPRSNSMN ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  SLPRSNID, EMPLOYID, VENDORID, SLPRSNFN, SPRSNSMN, SPRSNSLN, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIP, COUNTRY, PHONE1, PHONE2, PHONE3, FAX, INACTIVE, SALSTERR, COMMCODE, COMPRCNT, STDCPRCT, COMAPPTO, COSTTODT, CSTLSTYR, TTLCOMTD, TTLCOMLY, COMSLTDT, COMSLLYR, NCOMSLTD, NCOMSLYR, KPCALHST, KPERHIST, NOTEINDX, MODIFDT, CREATDDT, COMMDEST, DEX_ROW_TS, DEX_ROW_ID FROM .RM00301 WHERE SPRSNSLN BETWEEN @SPRSNSLN_RS AND @SPRSNSLN_RE AND SLPRSNFN BETWEEN @SLPRSNFN_RS AND @SLPRSNFN_RE AND SPRSNSMN BETWEEN @SPRSNSMN_RS AND @SPRSNSMN_RE ORDER BY SPRSNSLN ASC, SLPRSNFN ASC, SPRSNSMN ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_RM00301F_2] TO [DYNGRP]
GO
