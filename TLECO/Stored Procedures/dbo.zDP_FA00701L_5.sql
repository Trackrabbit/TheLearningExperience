SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_FA00701L_5] (@RETIREEVENT_RS int, @RETIRESEQ_RS smallint, @RETIREEVENT_RE int, @RETIRESEQ_RE smallint) AS  set nocount on IF @RETIREEVENT_RS IS NULL BEGIN SELECT TOP 25  RETIREMENTINDX, RETIRESEQ, RETIREEVENT, ASSETINDEX, ASSETID, RETDATESTAMP, RETTIMESTAMP, RETIREMENTTYPE, RETIREMENTDATE, RETIREMENTCODE, CASHPROCEEDS, Orig_Cash_Proceeds, NONCASHPROCEEDS, Orig_Non_Cash_Proceeds, EXPOFSALE, Orig_Expenses_of_Sale, PARTIALQTY, PARTIALCOST, PARTIALPCT, ASSETINDXAFTRET, NOTEINDX, CURNCYID, CURRNIDX, XCHGRATE, EXCHDATE, TIME1, EXGTBLID, RATETPID, RTCLCMTD, DENXRATE, MCTRXSTT, LASTMNTDDATE, LASTMNTDTIME, LASTMNTDUSERID, DEX_ROW_ID FROM .FA00701 ORDER BY RETIREEVENT DESC, RETIRESEQ DESC END ELSE IF @RETIREEVENT_RS = @RETIREEVENT_RE BEGIN SELECT TOP 25  RETIREMENTINDX, RETIRESEQ, RETIREEVENT, ASSETINDEX, ASSETID, RETDATESTAMP, RETTIMESTAMP, RETIREMENTTYPE, RETIREMENTDATE, RETIREMENTCODE, CASHPROCEEDS, Orig_Cash_Proceeds, NONCASHPROCEEDS, Orig_Non_Cash_Proceeds, EXPOFSALE, Orig_Expenses_of_Sale, PARTIALQTY, PARTIALCOST, PARTIALPCT, ASSETINDXAFTRET, NOTEINDX, CURNCYID, CURRNIDX, XCHGRATE, EXCHDATE, TIME1, EXGTBLID, RATETPID, RTCLCMTD, DENXRATE, MCTRXSTT, LASTMNTDDATE, LASTMNTDTIME, LASTMNTDUSERID, DEX_ROW_ID FROM .FA00701 WHERE RETIREEVENT = @RETIREEVENT_RS AND RETIRESEQ BETWEEN @RETIRESEQ_RS AND @RETIRESEQ_RE ORDER BY RETIREEVENT DESC, RETIRESEQ DESC END ELSE BEGIN SELECT TOP 25  RETIREMENTINDX, RETIRESEQ, RETIREEVENT, ASSETINDEX, ASSETID, RETDATESTAMP, RETTIMESTAMP, RETIREMENTTYPE, RETIREMENTDATE, RETIREMENTCODE, CASHPROCEEDS, Orig_Cash_Proceeds, NONCASHPROCEEDS, Orig_Non_Cash_Proceeds, EXPOFSALE, Orig_Expenses_of_Sale, PARTIALQTY, PARTIALCOST, PARTIALPCT, ASSETINDXAFTRET, NOTEINDX, CURNCYID, CURRNIDX, XCHGRATE, EXCHDATE, TIME1, EXGTBLID, RATETPID, RTCLCMTD, DENXRATE, MCTRXSTT, LASTMNTDDATE, LASTMNTDTIME, LASTMNTDUSERID, DEX_ROW_ID FROM .FA00701 WHERE RETIREEVENT BETWEEN @RETIREEVENT_RS AND @RETIREEVENT_RE AND RETIRESEQ BETWEEN @RETIRESEQ_RS AND @RETIRESEQ_RE ORDER BY RETIREEVENT DESC, RETIRESEQ DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_FA00701L_5] TO [DYNGRP]
GO
