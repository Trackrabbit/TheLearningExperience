SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SVC00607N_1] (@BS int, @CONSTS smallint, @CONTNBR char(11), @LNSEQNBR numeric(19,5), @CONSTS_RS smallint, @CONTNBR_RS char(11), @LNSEQNBR_RS numeric(19,5), @CONSTS_RE smallint, @CONTNBR_RE char(11), @LNSEQNBR_RE numeric(19,5)) AS  set nocount on IF @CONSTS_RS IS NULL BEGIN SELECT TOP 25  CONSTS, CONTNBR, LNSEQNBR, Meter_Bases_1, Meter_Bases_2, Meter_Bases_3, Meter_Bases_4, Meter_Bases_5, Meter_Overages_1, Meter_Overages_2, Meter_Overages_3, Meter_Overages_4, Meter_Overages_5, Meter_Overages_6, Meter_Overages_7, Meter_Overages_8, Meter_Overages_9, Meter_Overages_10, Meter_Overages_11, Meter_Overages_12, Meter_Overages_13, Meter_Overages_14, Meter_Overages_15, Meter_Overages_16, Meter_Overages_17, Meter_Overages_18, Meter_Overages_19, Meter_Overages_20, Meter_Charges_1, Meter_Charges_2, Meter_Charges_3, Meter_Charges_4, Meter_Charges_5, Meter_Charges_6, Meter_Charges_7, Meter_Charges_8, Meter_Charges_9, Meter_Charges_10, Meter_Charges_11, Meter_Charges_12, Meter_Charges_13, Meter_Charges_14, Meter_Charges_15, Meter_Charges_16, Meter_Charges_17, Meter_Charges_18, Meter_Charges_19, Meter_Charges_20, Meter_Expires_1, Meter_Expires_2, Meter_Expires_3, Meter_Expires_4, Meter_Expires_5, Meter_Internal_Uses_1, Meter_Internal_Uses_2, Meter_Internal_Uses_3, Meter_Internal_Uses_4, Meter_Internal_Uses_5, Meter_Actuals_1, Meter_Actuals_2, Meter_Actuals_3, Meter_Actuals_4, Meter_Actuals_5, Meter_Startings_1, Meter_Startings_2, Meter_Startings_3, Meter_Startings_4, Meter_Startings_5, Amount_To_Invoice, Invoiced_Amount, Total_Invoiced, INVODATE, Orig_Amount_To_Invoice, Orig_Invoiced_Amount, OrigTotalInvoiced, Originating_Meter_Charge_1, Originating_Meter_Charge_2, Originating_Meter_Charge_3, Originating_Meter_Charge_4, Originating_Meter_Charge_5, Originating_Meter_Charge_6, Originating_Meter_Charge_7, Originating_Meter_Charge_8, Originating_Meter_Charge_9, Originating_Meter_Charge_10, Originating_Meter_Charge_11, Originating_Meter_Charge_12, Originating_Meter_Charge_13, Originating_Meter_Charge_14, Originating_Meter_Charge_15, Originating_Meter_Charge_16, Originating_Meter_Charge_17, Originating_Meter_Charge_18, Originating_Meter_Charge_19, Originating_Meter_Charge_20, DEX_ROW_ID FROM .SVC00607 WHERE ( CONSTS = @CONSTS AND CONTNBR = @CONTNBR AND LNSEQNBR > @LNSEQNBR OR CONSTS = @CONSTS AND CONTNBR > @CONTNBR OR CONSTS > @CONSTS ) ORDER BY CONSTS ASC, CONTNBR ASC, LNSEQNBR ASC END ELSE IF @CONSTS_RS = @CONSTS_RE BEGIN SELECT TOP 25  CONSTS, CONTNBR, LNSEQNBR, Meter_Bases_1, Meter_Bases_2, Meter_Bases_3, Meter_Bases_4, Meter_Bases_5, Meter_Overages_1, Meter_Overages_2, Meter_Overages_3, Meter_Overages_4, Meter_Overages_5, Meter_Overages_6, Meter_Overages_7, Meter_Overages_8, Meter_Overages_9, Meter_Overages_10, Meter_Overages_11, Meter_Overages_12, Meter_Overages_13, Meter_Overages_14, Meter_Overages_15, Meter_Overages_16, Meter_Overages_17, Meter_Overages_18, Meter_Overages_19, Meter_Overages_20, Meter_Charges_1, Meter_Charges_2, Meter_Charges_3, Meter_Charges_4, Meter_Charges_5, Meter_Charges_6, Meter_Charges_7, Meter_Charges_8, Meter_Charges_9, Meter_Charges_10, Meter_Charges_11, Meter_Charges_12, Meter_Charges_13, Meter_Charges_14, Meter_Charges_15, Meter_Charges_16, Meter_Charges_17, Meter_Charges_18, Meter_Charges_19, Meter_Charges_20, Meter_Expires_1, Meter_Expires_2, Meter_Expires_3, Meter_Expires_4, Meter_Expires_5, Meter_Internal_Uses_1, Meter_Internal_Uses_2, Meter_Internal_Uses_3, Meter_Internal_Uses_4, Meter_Internal_Uses_5, Meter_Actuals_1, Meter_Actuals_2, Meter_Actuals_3, Meter_Actuals_4, Meter_Actuals_5, Meter_Startings_1, Meter_Startings_2, Meter_Startings_3, Meter_Startings_4, Meter_Startings_5, Amount_To_Invoice, Invoiced_Amount, Total_Invoiced, INVODATE, Orig_Amount_To_Invoice, Orig_Invoiced_Amount, OrigTotalInvoiced, Originating_Meter_Charge_1, Originating_Meter_Charge_2, Originating_Meter_Charge_3, Originating_Meter_Charge_4, Originating_Meter_Charge_5, Originating_Meter_Charge_6, Originating_Meter_Charge_7, Originating_Meter_Charge_8, Originating_Meter_Charge_9, Originating_Meter_Charge_10, Originating_Meter_Charge_11, Originating_Meter_Charge_12, Originating_Meter_Charge_13, Originating_Meter_Charge_14, Originating_Meter_Charge_15, Originating_Meter_Charge_16, Originating_Meter_Charge_17, Originating_Meter_Charge_18, Originating_Meter_Charge_19, Originating_Meter_Charge_20, DEX_ROW_ID FROM .SVC00607 WHERE CONSTS = @CONSTS_RS AND CONTNBR BETWEEN @CONTNBR_RS AND @CONTNBR_RE AND LNSEQNBR BETWEEN @LNSEQNBR_RS AND @LNSEQNBR_RE AND ( CONSTS = @CONSTS AND CONTNBR = @CONTNBR AND LNSEQNBR > @LNSEQNBR OR CONSTS = @CONSTS AND CONTNBR > @CONTNBR OR CONSTS > @CONSTS ) ORDER BY CONSTS ASC, CONTNBR ASC, LNSEQNBR ASC END ELSE BEGIN SELECT TOP 25  CONSTS, CONTNBR, LNSEQNBR, Meter_Bases_1, Meter_Bases_2, Meter_Bases_3, Meter_Bases_4, Meter_Bases_5, Meter_Overages_1, Meter_Overages_2, Meter_Overages_3, Meter_Overages_4, Meter_Overages_5, Meter_Overages_6, Meter_Overages_7, Meter_Overages_8, Meter_Overages_9, Meter_Overages_10, Meter_Overages_11, Meter_Overages_12, Meter_Overages_13, Meter_Overages_14, Meter_Overages_15, Meter_Overages_16, Meter_Overages_17, Meter_Overages_18, Meter_Overages_19, Meter_Overages_20, Meter_Charges_1, Meter_Charges_2, Meter_Charges_3, Meter_Charges_4, Meter_Charges_5, Meter_Charges_6, Meter_Charges_7, Meter_Charges_8, Meter_Charges_9, Meter_Charges_10, Meter_Charges_11, Meter_Charges_12, Meter_Charges_13, Meter_Charges_14, Meter_Charges_15, Meter_Charges_16, Meter_Charges_17, Meter_Charges_18, Meter_Charges_19, Meter_Charges_20, Meter_Expires_1, Meter_Expires_2, Meter_Expires_3, Meter_Expires_4, Meter_Expires_5, Meter_Internal_Uses_1, Meter_Internal_Uses_2, Meter_Internal_Uses_3, Meter_Internal_Uses_4, Meter_Internal_Uses_5, Meter_Actuals_1, Meter_Actuals_2, Meter_Actuals_3, Meter_Actuals_4, Meter_Actuals_5, Meter_Startings_1, Meter_Startings_2, Meter_Startings_3, Meter_Startings_4, Meter_Startings_5, Amount_To_Invoice, Invoiced_Amount, Total_Invoiced, INVODATE, Orig_Amount_To_Invoice, Orig_Invoiced_Amount, OrigTotalInvoiced, Originating_Meter_Charge_1, Originating_Meter_Charge_2, Originating_Meter_Charge_3, Originating_Meter_Charge_4, Originating_Meter_Charge_5, Originating_Meter_Charge_6, Originating_Meter_Charge_7, Originating_Meter_Charge_8, Originating_Meter_Charge_9, Originating_Meter_Charge_10, Originating_Meter_Charge_11, Originating_Meter_Charge_12, Originating_Meter_Charge_13, Originating_Meter_Charge_14, Originating_Meter_Charge_15, Originating_Meter_Charge_16, Originating_Meter_Charge_17, Originating_Meter_Charge_18, Originating_Meter_Charge_19, Originating_Meter_Charge_20, DEX_ROW_ID FROM .SVC00607 WHERE CONSTS BETWEEN @CONSTS_RS AND @CONSTS_RE AND CONTNBR BETWEEN @CONTNBR_RS AND @CONTNBR_RE AND LNSEQNBR BETWEEN @LNSEQNBR_RS AND @LNSEQNBR_RE AND ( CONSTS = @CONSTS AND CONTNBR = @CONTNBR AND LNSEQNBR > @LNSEQNBR OR CONSTS = @CONSTS AND CONTNBR > @CONTNBR OR CONSTS > @CONSTS ) ORDER BY CONSTS ASC, CONTNBR ASC, LNSEQNBR ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SVC00607N_1] TO [DYNGRP]
GO
