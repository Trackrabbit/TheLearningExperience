SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 Create Procedure [dbo].[SVC_Delete_Service_Inv_Dist]  @srvrectype int ,  @callnbr varchar(11) ,  @EquipLine integer,  @Line integer,  @LineType char(3),  @CMPNTSEQ int = 0 as declare @DistType smallint declare @AccountIndex integer declare @CurrencyIndex smallint  if @CMPNTSEQ = 0   begin  select @DistType = SVC_Distribution_Type, @AccountIndex = ACTINDX, @CurrencyIndex = CURRNIDX from SVC00231   where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and EQPLINE=@EquipLine   and LNITMSEQ = @Line and LINITMTYP=@LineType and POSTED = 0 and SVC_Distribution_Type = 4   delete from SVC00231  where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and POSTED = 0 and SVC_Distribution_Type = 4   and EQPLINE=@EquipLine and LNITMSEQ = @Line and LINITMTYP=@LineType    end else  begin  select @DistType = SVC_Distribution_Type, @AccountIndex = ACTINDX, @CurrencyIndex = CURRNIDX from SVC00231   where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and EQPLINE=@EquipLine and CMPNTSEQ = @CMPNTSEQ  and LNITMSEQ = @Line and LINITMTYP=@LineType and POSTED = 0 and SVC_Distribution_Type = 4   delete from SVC00231  where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and POSTED = 0 and SVC_Distribution_Type = 4   and EQPLINE=@EquipLine and LNITMSEQ = @Line and LINITMTYP=@LineType and CMPNTSEQ = @CMPNTSEQ  end  exec SVC_Set_Service_HDR_Dist @callnbr,@srvrectype,@DistType,@AccountIndex,0,@CurrencyIndex if @CMPNTSEQ = 0   begin  select @DistType = SVC_Distribution_Type, @AccountIndex = ACTINDX, @CurrencyIndex = CURRNIDX from SVC00231   where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and EQPLINE=@EquipLine   and LNITMSEQ = @Line and LINITMTYP=@LineType and POSTED = 0 and SVC_Distribution_Type = 5   delete from SVC00231  where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and POSTED = 0 and SVC_Distribution_Type = 5   and EQPLINE=@EquipLine and LNITMSEQ = @Line and LINITMTYP=@LineType   end else  begin  select @DistType = SVC_Distribution_Type, @AccountIndex = ACTINDX, @CurrencyIndex = CURRNIDX from SVC00231   where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and EQPLINE=@EquipLine and CMPNTSEQ = @CMPNTSEQ  and LNITMSEQ = @Line and LINITMTYP=@LineType and POSTED = 0 and SVC_Distribution_Type = 5   delete from SVC00231  where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and POSTED = 0 and SVC_Distribution_Type = 5   and EQPLINE=@EquipLine and LNITMSEQ = @Line and LINITMTYP=@LineType and CMPNTSEQ = @CMPNTSEQ  end  exec SVC_Set_Service_HDR_Dist @callnbr,@srvrectype,@DistType,@AccountIndex,0,@CurrencyIndex  return    
GO
GRANT EXECUTE ON  [dbo].[SVC_Delete_Service_Inv_Dist] TO [DYNGRP]
GO
