SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 Create Proc [dbo].[UPR_PopulateTimecardCurrentListTempForReportsTo] (@I_sListTempTableName char(30) = NULL, @I_sReportsToTableName char(30) = NULL, @I_nModule smallint = NULL, @EmployeeID varchar(15) = NULL, @UserDate as varchar(20) = NULL,  @O_SQL_Error_State int= NULL output )  AS DECLARE @SQLString nvarchar(4000), @OrderByColumn1 varchar(15) = NULL,  @OrderByColumn2 varchar(15) = NULL,  @OrderByColumn3 varchar(15) = NULL,   @OrderByColumn4 varchar(15) = NULL,  @OrderByColumn5 varchar(15) = NULL, @iStatus int,  @iError int  select  @O_SQL_Error_State = 0,  @iStatus = 0,   @iError = 0  if (  @I_sListTempTableName is NULL or  @I_sReportsToTableName is NULL or @I_nModule is NULL or  @UserDate is NULL )  begin  select @O_SQL_Error_State = 26000  return end  if @I_nModule = 35  or @I_nModule = 0 BEGIN  SELECT  @OrderByColumn1 = (CASE ASGMTPRTY_1 WHEN 1 THEN 'EMPLOYIDMATCH' WHEN 2 THEN 'EMPLCLASMATCH' WHEN 3 THEN 'JOBTITLEMATCH' WHEN 4 THEN 'DEPRTMNTMATCH' WHEN 5 THEN 'LOCATNIDMATCH' END),  @OrderByColumn2 = (CASE ASGMTPRTY_2 WHEN 1 THEN 'EMPLOYIDMATCH' WHEN 2 THEN 'EMPLCLASMATCH' WHEN 3 THEN 'JOBTITLEMATCH' WHEN 4 THEN 'DEPRTMNTMATCH' WHEN 5 THEN 'LOCATNIDMATCH' END),  @OrderByColumn3 = (CASE ASGMTPRTY_3 WHEN 1 THEN 'EMPLOYIDMATCH' WHEN 2 THEN 'EMPLCLASMATCH' WHEN 3 THEN 'JOBTITLEMATCH' WHEN 4 THEN 'DEPRTMNTMATCH' WHEN 5 THEN 'LOCATNIDMATCH' END),  @OrderByColumn4 = (CASE ASGMTPRTY_4 WHEN 1 THEN 'EMPLOYIDMATCH' WHEN 2 THEN 'EMPLCLASMATCH' WHEN 3 THEN 'JOBTITLEMATCH' WHEN 4 THEN 'DEPRTMNTMATCH' WHEN 5 THEN 'LOCATNIDMATCH' END),  @OrderByColumn5 = (CASE ASGMTPRTY_5 WHEN 1 THEN 'EMPLOYIDMATCH' WHEN 2 THEN 'EMPLCLASMATCH' WHEN 3 THEN 'JOBTITLEMATCH' WHEN 4 THEN 'DEPRTMNTMATCH' WHEN 5 THEN 'LOCATNIDMATCH' END)  FROM UPR40202 WHERE SETUPKEY = 1  IF @OrderByColumn1 IS NULL OR @OrderByColumn2 IS NULL OR @OrderByColumn3 IS NULL OR @OrderByColumn4 IS NULL OR @OrderByColumn5 IS NULL  BEGIN  SET @OrderByColumn1 = 'EMPLOYIDMATCH'  SET @OrderByColumn2 = 'EMPLCLASMATCH'  SET @OrderByColumn3 = 'JOBTITLEMATCH'  SET @OrderByColumn4 = 'DEPRTMNTMATCH'  SET @OrderByColumn5 = 'LOCATNIDMATCH'  END   SET @SQLString = '  DECLARE @O_SQL_Error_State AS int  exec UPR_PopulateTimecardCurrentListTempForEmployee ''' + @I_sListTempTableName + ''', ''' + @I_sReportsToTableName + ''', ''' + CAST(@I_nModule AS VARCHAR(2)) + ''', ''' + @EmployeeID + ''', ''' +  @OrderByColumn1 + ''', ''' + @OrderByColumn2 + ''', ''' + @OrderByColumn3 + ''', ''' + @OrderByColumn4 + ''', ''' + @OrderByColumn5 + ''', ''' +   @UserDate + ''', 1, @O_SQL_Error_State output '   exec(@SQLString)   SET @SQLString = '  DECLARE @O_SQL_Error_State AS int  exec UPR_PopulateTimecardCurrentListTempForEmployee ''' + @I_sListTempTableName + ''', ''' + @I_sReportsToTableName + ''', ''' + CAST(@I_nModule AS VARCHAR(2)) + ''', ''' + @EmployeeID + ''', ''' +  @OrderByColumn1 + ''', ''' + @OrderByColumn2 + ''', ''' + @OrderByColumn3 + ''', ''' + @OrderByColumn4 + ''', ''' + @OrderByColumn5 + ''', ''' +   @UserDate + ''', 2, @O_SQL_Error_State output '   exec(@SQLString)  END    
GO
GRANT EXECUTE ON  [dbo].[UPR_PopulateTimecardCurrentListTempForReportsTo] TO [DYNGRP]
GO
