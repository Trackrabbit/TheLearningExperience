SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopySOP] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255) select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '' if (@I_vData = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP00100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP00100 ( [PRCHLDID],[DSCRIPTN],[PASSWORD],[XFERPHOL],[POSTPHOL],[FUFIPHOL], [PRINPHOL],[WORKFLOWHOLD],[NOTEINDX],[USER2ENT],[CREATDDT],[MODIFDT] ) select [PRCHLDID],[DSCRIPTN],[PASSWORD],[XFERPHOL],[POSTPHOL],[FUFIPHOL], [PRINPHOL],[WORKFLOWHOLD],[NOTEINDX],[USER2ENT],[CREATDDT],[MODIFDT] from ' + rtrim(@I_vFromCompany) + '..SOP00100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP00200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP00200 ( [PROSPID],[NOTEINDX],[CUSTNAME],[CNTCPRSN],[ADDRESS1],[ADDRESS2], [ADDRESS3],[CITY],[STATE],[ZIP],[COUNTRY],[CUSTCLAS], [PHONE1],[PHONE2],[PHONE3],[PRCLEVEL],[FAX],[SHIPMTHD], [TAXSCHID],[USERDEF1],[USERDEF2],[USER2ENT],[CREATDDT],[MODIFDT] ) select [PROSPID],[NOTEINDX],[CUSTNAME],[CNTCPRSN],[ADDRESS1],[ADDRESS2], [ADDRESS3],[CITY],[STATE],[ZIP],[COUNTRY],[CUSTCLAS], [PHONE1],[PHONE2],[PHONE3],[PRCLEVEL],[FAX],[SHIPMTHD], [TAXSCHID],[USERDEF1],[USERDEF2],[USER2ENT],[CREATDDT],[MODIFDT] from ' + rtrim(@I_vFromCompany) + '..SOP00200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP00300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP00300 ( [CUSTNMBR],[ITEMNMBR],[SEQNUMBR],[SUBITEMNMBR],[SUBITEMDESC],[STRTDATE], [ENDDATE] ) select [CUSTNMBR],[ITEMNMBR],[SEQNUMBR],[SUBITEMNMBR],[SUBITEMDESC],[STRTDATE], [ENDDATE] from ' + rtrim(@I_vFromCompany) + '..SOP00300 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP10111' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP10111 ( [INSTRUCTIONID],[NOTEINDX],[COMMENT_1],[COMMENT_2],[COMMENT_3],[COMMENT_4], [PICKINGINSTRUCTION] ) select [INSTRUCTIONID],[NOTEINDX],[COMMENT_1],[COMMENT_2],[COMMENT_3],[COMMENT_4], [PICKINGINSTRUCTION] from ' + rtrim(@I_vFromCompany) + '..SOP10111 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP40100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP40100 ( [COMMNTID],[SETUPKEY],[DPYITMCS],[DQTYSWAR],[TRKVDTRX],[CALCKITC], [NEWRATES],[TRMSTNUM],[NXTMSTNO],[QUOTE],[PRDER],[INVORETU], [ACDSTRBN],[LOCNCODE],[CHEKBKID],[DFQTYSOP],[QUODOCID],[ORDDOCID], [BACDOCID],[INVDOCID],[RETDOCID],[DECPLQTY],[DECPLCUR],[USEACFRM], [USEADVTX],[TAXSCHID],[NONIVTXB],[NONIVSCH],[FRGTTXBL],[FRTSCHID], [MISCTXBL],[MSCSCHID],[MPACKSLP],[MPICKTIC],[PriceLevelWarning],[SOPALLOW_1], [SOPALLOW_2],[SOPALLOW_3],[SOPALLOW_4],[SOPALLOW_5],[SOPALLOW_6],[SOPALLOW_7], [SOPALLOW_8],[SOPALLOW_9],[SOPALLOW_10],[SOPPSSWD_1],[SOPPSSWD_2],[SOPPSSWD_3], [SOPPSSWD_4],[SOPPSSWD_5],[SOPPSSWD_6],[SOPPSSWD_7],[SOPPSSWD_8],[SOPPSSWD_9], [SOPPSSWD_10],[IVCDSTCK],[NUMOFTRX],[USRDFPR1],[USRDRPR2],[USRDRPR3], [USRDRPR4],[USRDRPR5],[USRDRPR6],[USRDRPR7],[USRDRPR8],[USRDRPR9], [USRDRP10],[USRDRP11],[USRDRP12],[USRDFPR13],[USRDFPR14],[USRDFPR15], [USRDFPR16],[USRDFPR17],[CREATDDT],[MODIFDT],[REQSHIP],[REQDAYS], [SITEPREF],[PREFSITE],[REQDATEPO],[Required_Days],[UMDEFAULT],[COMBONPO], [TXBASECS],[USEORGUC],[Prices_Not_Required_In_Pr],[PasswordUpper],[Convert_Functional_Price],[INDVPICKTICKETSORT], [PRINTAVAILABLEBINS],[FODOCID],[CombineDropshipSOLines],[CombineDropshipSODocs] ) select [COMMNTID],[SETUPKEY],[DPYITMCS],[DQTYSWAR],[TRKVDTRX],[CALCKITC], [NEWRATES],[TRMSTNUM],[NXTMSTNO],[QUOTE],[PRDER],[INVORETU], [ACDSTRBN],[LOCNCODE],[CHEKBKID],[DFQTYSOP],[QUODOCID],[ORDDOCID], [BACDOCID],[INVDOCID],[RETDOCID],[DECPLQTY],[DECPLCUR],[USEACFRM], [USEADVTX],[TAXSCHID],[NONIVTXB],[NONIVSCH],[FRGTTXBL],[FRTSCHID], [MISCTXBL],[MSCSCHID],[MPACKSLP],[MPICKTIC],[PriceLevelWarning],[SOPALLOW_1], [SOPALLOW_2],[SOPALLOW_3],[SOPALLOW_4],[SOPALLOW_5],[SOPALLOW_6],[SOPALLOW_7], [SOPALLOW_8],[SOPALLOW_9],[SOPALLOW_10],[SOPPSSWD_1],[SOPPSSWD_2],[SOPPSSWD_3], [SOPPSSWD_4],[SOPPSSWD_5],[SOPPSSWD_6],[SOPPSSWD_7],[SOPPSSWD_8],[SOPPSSWD_9], [SOPPSSWD_10],[IVCDSTCK],[NUMOFTRX],[USRDFPR1],[USRDRPR2],[USRDRPR3], [USRDRPR4],[USRDRPR5],[USRDRPR6],[USRDRPR7],[USRDRPR8],[USRDRPR9], [USRDRP10],[USRDRP11],[USRDRP12],[USRDFPR13],[USRDFPR14],[USRDFPR15], [USRDFPR16],[USRDFPR17],[CREATDDT],[MODIFDT],[REQSHIP],[REQDAYS], [SITEPREF],[PREFSITE],[REQDATEPO],[Required_Days],[UMDEFAULT],[COMBONPO], [TXBASECS],[USEORGUC],[Prices_Not_Required_In_Pr],[PasswordUpper],[Convert_Functional_Price],[INDVPICKTICKETSORT], [PRINTAVAILABLEBINS],[FODOCID],[CombineDropshipSOLines],[CombineDropshipSODocs] from ' + rtrim(@I_vFromCompany) + '..SOP40100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP40101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP40101 ( [SOPSTATUS],[SOPSTSDESCR] ) select [SOPSTATUS],[SOPSTSDESCR] from ' + rtrim(@I_vFromCompany) + '..SOP40101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP40200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP40200 ( [DOCID],[NOTEINDX],[SOPTYPE],[SETUPKEY],[DOCTYABR],[SOPNUMBE], [COMMNTID],[DOCUFORM],[DAYTOEXP],[ALLREPEA],[ALLOCABY],[USEPROSP], [USNXTINV],[USPFULPR],[QUOTOINV],[QUOTOORD],[INVTOBAC],[BACTOINV], [BACTOORD],[ORDTOBAC],[ORDTOORD],[USDOCID1],[USDOCID2],[QTYDEFAU], [SOPALLOW_1],[SOPALLOW_2],[SOPALLOW_3],[SOPALLOW_4],[SOPALLOW_5],[SOPALLOW_6], [SOPALLOW_7],[SOPALLOW_8],[SOPALLOW_9],[SOPALLOW_10],[SOPPSSWD_1],[SOPPSSWD_2], [SOPPSSWD_3],[SOPPSSWD_4],[SOPPSSWD_5],[SOPPSSWD_6],[SOPPSSWD_7],[SOPPSSWD_8], [SOPPSSWD_9],[SOPPSSWD_10],[SOPSEQNC_1],[SOPSEQNC_2],[SOPSEQNC_3],[SOPSEQNC_4], [SOPSEQNC_5],[SOPSEQNC_6],[SOPSEQNC_7],[SOPSEQNC_8],[USER2ENT],[CREATDDT], [MODIFDT],[SHPPGDOC],[CORRCTN],[SIMPLIFD],[ALLBACKODPRT],[XORDINVC], [USDOCID3],[WORKFLOWENABLED],[UPDTONPRINT],[CREDITLIMITHOLDID],[UPDTACTUALSHPDT],[WORKFLOWHOLDID], [OVERRIDEIVCBILLQTY],[ENABLEBACKORDER],[ENABLECANCELED],[SOPSTATUSACTIVE_1],[SOPSTATUSACTIVE_2],[SOPSTATUSACTIVE_3], [SOPSTATUSACTIVE_4],[SOPSTATUSACTIVE_5],[SOPSTATUSACTIVE_6],[SOPSTATUSACTIVE_7],[SOPSTATUSACTIVE_8],[SOPSTATUSACTIVE_9] ) select [DOCID],[NOTEINDX],[SOPTYPE],[SETUPKEY],[DOCTYABR],[SOPNUMBE], [COMMNTID],[DOCUFORM],[DAYTOEXP],[ALLREPEA],[ALLOCABY],[USEPROSP], [USNXTINV],[USPFULPR],[QUOTOINV],[QUOTOORD],[INVTOBAC],[BACTOINV], [BACTOORD],[ORDTOBAC],[ORDTOORD],[USDOCID1],[USDOCID2],[QTYDEFAU], [SOPALLOW_1],[SOPALLOW_2],[SOPALLOW_3],[SOPALLOW_4],[SOPALLOW_5],[SOPALLOW_6], [SOPALLOW_7],[SOPALLOW_8],[SOPALLOW_9],[SOPALLOW_10],[SOPPSSWD_1],[SOPPSSWD_2], [SOPPSSWD_3],[SOPPSSWD_4],[SOPPSSWD_5],[SOPPSSWD_6],[SOPPSSWD_7],[SOPPSSWD_8], [SOPPSSWD_9],[SOPPSSWD_10],[SOPSEQNC_1],[SOPSEQNC_2],[SOPSEQNC_3],[SOPSEQNC_4], [SOPSEQNC_5],[SOPSEQNC_6],[SOPSEQNC_7],[SOPSEQNC_8],[USER2ENT],[CREATDDT], [MODIFDT],[SHPPGDOC],[CORRCTN],[SIMPLIFD],[ALLBACKODPRT],[XORDINVC], [USDOCID3],[WORKFLOWENABLED],[UPDTONPRINT],[CREDITLIMITHOLDID],[UPDTACTUALSHPDT],[WORKFLOWHOLDID], [OVERRIDEIVCBILLQTY],[ENABLEBACKORDER],[ENABLECANCELED],[SOPSTATUSACTIVE_1],[SOPSTATUSACTIVE_2],[SOPSTATUSACTIVE_3], [SOPSTATUSACTIVE_4],[SOPSTATUSACTIVE_5],[SOPSTATUSACTIVE_6],[SOPSTATUSACTIVE_7],[SOPSTATUSACTIVE_8],[SOPSTATUSACTIVE_9] from ' + rtrim(@I_vFromCompany) + '..SOP40200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP40201' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP40201 ( [SOPTYPE],[DOCID],[PRCHLDID] ) select [SOPTYPE],[DOCID],[PRCHLDID] from ' + rtrim(@I_vFromCompany) + '..SOP40201 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP40300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP40300 ( [SOPTYPE],[DOCTYABR],[DOCTYNAM],[SOPNUMBE],[DOCUFORM],[SETUPKEY] ) select [SOPTYPE],[DOCTYABR],[DOCTYNAM],[SOPNUMBE],[DOCUFORM],[SETUPKEY] from ' + rtrim(@I_vFromCompany) + '..SOP40300 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP40400' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP40400 ( [INDEX1],[USTABVAL] ) select [INDEX1],[USTABVAL] from ' + rtrim(@I_vFromCompany) + '..SOP40400 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP40500' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP40500 ( [MSTRNUMB] ) select [MSTRNUMB] from ' + rtrim(@I_vFromCompany) + '..SOP40500 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP40600' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP40600 ( [CURNCYID],[DECPLCUR] ) select [CURNCYID],[DECPLCUR] from ' + rtrim(@I_vFromCompany) + '..SOP40600 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP60200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP60200 ( [INSTRUCTIONID],[CUSTNMBR],[ADRSCODE],[ITEMNMBR],[SEQNUMBR] ) select [INSTRUCTIONID],[CUSTNMBR],[ADRSCODE],[ITEMNMBR],[SEQNUMBR] from ' + rtrim(@I_vFromCompany) + '..SOP60200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP60300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP60300 ( [ITEMNMBR],[CUSTNMBR],[CUSTITEMNMBR],[CUSTITEMDESC],[CUSTITEMSHORNAME],[CUSTITEMGENERICDESC], [USERDEF1],[USERDEF2],[USRDEF03],[USRDEF04],[USRDEF05],[USERDEFKEY1], [USERDEFKEY2],[USERDEFKEY3],[USERDEFKEY4],[NOTEINDX] ) select [ITEMNMBR],[CUSTNMBR],[CUSTITEMNMBR],[CUSTITEMDESC],[CUSTITEMSHORNAME],[CUSTITEMGENERICDESC], [USERDEF1],[USERDEF2],[USRDEF03],[USRDEF04],[USRDEF05],[USERDEFKEY1], [USERDEFKEY2],[USERDEFKEY3],[USERDEFKEY4],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..SOP60300 ' exec(@cStatement) end return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopySOP] TO [DYNGRP]
GO
