SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_VAT10007N_2] (@BS int, @INTRSTTTYP smallint, @INTRSTTFLDDSC char(31), @INTRSTTFLD char(7), @INTRSTTTYP_RS smallint, @INTRSTTFLDDSC_RS char(31), @INTRSTTFLD_RS char(7), @INTRSTTTYP_RE smallint, @INTRSTTFLDDSC_RE char(31), @INTRSTTFLD_RE char(7)) AS  set nocount on IF @INTRSTTTYP_RS IS NULL BEGIN SELECT TOP 25  INTRSTTTYP, INTRSTTFLD, INTRSTTFLDDSC, NOTEINDX, DEX_ROW_ID FROM .VAT10007 WHERE ( INTRSTTTYP = @INTRSTTTYP AND INTRSTTFLDDSC = @INTRSTTFLDDSC AND INTRSTTFLD > @INTRSTTFLD OR INTRSTTTYP = @INTRSTTTYP AND INTRSTTFLDDSC > @INTRSTTFLDDSC OR INTRSTTTYP > @INTRSTTTYP ) ORDER BY INTRSTTTYP ASC, INTRSTTFLDDSC ASC, INTRSTTFLD ASC END ELSE IF @INTRSTTTYP_RS = @INTRSTTTYP_RE BEGIN SELECT TOP 25  INTRSTTTYP, INTRSTTFLD, INTRSTTFLDDSC, NOTEINDX, DEX_ROW_ID FROM .VAT10007 WHERE INTRSTTTYP = @INTRSTTTYP_RS AND INTRSTTFLDDSC BETWEEN @INTRSTTFLDDSC_RS AND @INTRSTTFLDDSC_RE AND INTRSTTFLD BETWEEN @INTRSTTFLD_RS AND @INTRSTTFLD_RE AND ( INTRSTTTYP = @INTRSTTTYP AND INTRSTTFLDDSC = @INTRSTTFLDDSC AND INTRSTTFLD > @INTRSTTFLD OR INTRSTTTYP = @INTRSTTTYP AND INTRSTTFLDDSC > @INTRSTTFLDDSC OR INTRSTTTYP > @INTRSTTTYP ) ORDER BY INTRSTTTYP ASC, INTRSTTFLDDSC ASC, INTRSTTFLD ASC END ELSE BEGIN SELECT TOP 25  INTRSTTTYP, INTRSTTFLD, INTRSTTFLDDSC, NOTEINDX, DEX_ROW_ID FROM .VAT10007 WHERE INTRSTTTYP BETWEEN @INTRSTTTYP_RS AND @INTRSTTTYP_RE AND INTRSTTFLDDSC BETWEEN @INTRSTTFLDDSC_RS AND @INTRSTTFLDDSC_RE AND INTRSTTFLD BETWEEN @INTRSTTFLD_RS AND @INTRSTTFLD_RE AND ( INTRSTTTYP = @INTRSTTTYP AND INTRSTTFLDDSC = @INTRSTTFLDDSC AND INTRSTTFLD > @INTRSTTFLD OR INTRSTTTYP = @INTRSTTTYP AND INTRSTTFLDDSC > @INTRSTTFLDDSC OR INTRSTTTYP > @INTRSTTTYP ) ORDER BY INTRSTTTYP ASC, INTRSTTFLDDSC ASC, INTRSTTFLD ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_VAT10007N_2] TO [DYNGRP]
GO
