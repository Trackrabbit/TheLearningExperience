SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IVC10102N_1] (@BS int, @DOCTYPE smallint, @INVCNMBR char(21), @LNITMSEQ int, @CMPNTSEQ int, @QTYTYPE smallint, @SLTSQNUM int, @DOCTYPE_RS smallint, @INVCNMBR_RS char(21), @LNITMSEQ_RS int, @CMPNTSEQ_RS int, @QTYTYPE_RS smallint, @SLTSQNUM_RS int, @DOCTYPE_RE smallint, @INVCNMBR_RE char(21), @LNITMSEQ_RE int, @CMPNTSEQ_RE int, @QTYTYPE_RE smallint, @SLTSQNUM_RE int) AS  set nocount on IF @DOCTYPE_RS IS NULL BEGIN SELECT TOP 25  INVCNMBR, DOCTYPE, CMPNTSEQ, LNITMSEQ, QTYTYPE, SLTSQNUM, ITEMNMBR, SERLTNUM, SERLTQTY, DATERECD, DTSEQNUM, UNITCOST, TRXSORCE, POSTED, OVRSERLT, MFGDATE, EXPNDATE, DEX_ROW_ID FROM .IVC10102 WHERE ( DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND QTYTYPE = @QTYTYPE AND SLTSQNUM > @SLTSQNUM OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND QTYTYPE > @QTYTYPE OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ > @CMPNTSEQ OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ > @LNITMSEQ OR DOCTYPE = @DOCTYPE AND INVCNMBR > @INVCNMBR OR DOCTYPE > @DOCTYPE ) ORDER BY DOCTYPE ASC, INVCNMBR ASC, LNITMSEQ ASC, CMPNTSEQ ASC, QTYTYPE ASC, SLTSQNUM ASC END ELSE IF @DOCTYPE_RS = @DOCTYPE_RE BEGIN SELECT TOP 25  INVCNMBR, DOCTYPE, CMPNTSEQ, LNITMSEQ, QTYTYPE, SLTSQNUM, ITEMNMBR, SERLTNUM, SERLTQTY, DATERECD, DTSEQNUM, UNITCOST, TRXSORCE, POSTED, OVRSERLT, MFGDATE, EXPNDATE, DEX_ROW_ID FROM .IVC10102 WHERE DOCTYPE = @DOCTYPE_RS AND INVCNMBR BETWEEN @INVCNMBR_RS AND @INVCNMBR_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE AND CMPNTSEQ BETWEEN @CMPNTSEQ_RS AND @CMPNTSEQ_RE AND QTYTYPE BETWEEN @QTYTYPE_RS AND @QTYTYPE_RE AND SLTSQNUM BETWEEN @SLTSQNUM_RS AND @SLTSQNUM_RE AND ( DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND QTYTYPE = @QTYTYPE AND SLTSQNUM > @SLTSQNUM OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND QTYTYPE > @QTYTYPE OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ > @CMPNTSEQ OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ > @LNITMSEQ OR DOCTYPE = @DOCTYPE AND INVCNMBR > @INVCNMBR OR DOCTYPE > @DOCTYPE ) ORDER BY DOCTYPE ASC, INVCNMBR ASC, LNITMSEQ ASC, CMPNTSEQ ASC, QTYTYPE ASC, SLTSQNUM ASC END ELSE BEGIN SELECT TOP 25  INVCNMBR, DOCTYPE, CMPNTSEQ, LNITMSEQ, QTYTYPE, SLTSQNUM, ITEMNMBR, SERLTNUM, SERLTQTY, DATERECD, DTSEQNUM, UNITCOST, TRXSORCE, POSTED, OVRSERLT, MFGDATE, EXPNDATE, DEX_ROW_ID FROM .IVC10102 WHERE DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND INVCNMBR BETWEEN @INVCNMBR_RS AND @INVCNMBR_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE AND CMPNTSEQ BETWEEN @CMPNTSEQ_RS AND @CMPNTSEQ_RE AND QTYTYPE BETWEEN @QTYTYPE_RS AND @QTYTYPE_RE AND SLTSQNUM BETWEEN @SLTSQNUM_RS AND @SLTSQNUM_RE AND ( DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND QTYTYPE = @QTYTYPE AND SLTSQNUM > @SLTSQNUM OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND QTYTYPE > @QTYTYPE OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ > @CMPNTSEQ OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ > @LNITMSEQ OR DOCTYPE = @DOCTYPE AND INVCNMBR > @INVCNMBR OR DOCTYPE > @DOCTYPE ) ORDER BY DOCTYPE ASC, INVCNMBR ASC, LNITMSEQ ASC, CMPNTSEQ ASC, QTYTYPE ASC, SLTSQNUM ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IVC10102N_1] TO [DYNGRP]
GO
