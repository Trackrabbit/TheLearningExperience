SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyCmpy] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255), @DestCMPANYID smallint, @SourcCMPANYID smallint select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '', @DestCMPANYID = 0, @SourcCMPANYID = 0 select @DestCMPANYID = CMPANYID from DYNAMICS..SY01500 where INTERID = @I_vToCompany select @SourcCMPANYID = CMPANYID from DYNAMICS..SY01500 where INTERID = @I_vFromCompany if (@I_vData = 1) begin if (exists(select top 1 1 from sysobjects where name = 'PA00001')) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00001' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00001 ( [CUSTNMBR],[VENDORID],[CURNCYID],[RATETPID],[CREATDDT],[CRUSRID], [MODIFDT] ) select [CUSTNMBR],[VENDORID],[CURNCYID],[RATETPID],[CREATDDT],[CRUSRID], [MODIFDT] from ' + rtrim(@I_vFromCompany) + '..PA00001 ' exec(@cStatement) end select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY00300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY00300 ( [SGMTNUMB],[SGMTNAME],[LOFSGMNT],[MXLENSEG],[USDFSGKY],[MNSEGIND], [SegmentWidth] ) select [SGMTNUMB],[SGMTNAME],[LOFSGMNT],[MXLENSEG],[USDFSGKY],[MNSEGIND], [SegmentWidth] from ' + rtrim(@I_vFromCompany) + '..SY00300 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY00600' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY00600 ( [CMPANYID],[LOCATNID],[LOCATNNM],[ADRSCODE],[ADRCNTCT],[ADDRESS1], [ADDRESS2],[ADDRESS3],[CITY],[COUNTY],[STATE],[ZIPCODE], [COUNTRY],[PHONE1],[PHONE2],[PHONE3],[FAXNUMBR],[CHANGEBY_I], [CHANGEDATE_I],[NOTEINDX],[CCode] ) select [CMPANYID],[LOCATNID],[LOCATNNM],[ADRSCODE],[ADRCNTCT],[ADDRESS1], [ADDRESS2],[ADDRESS3],[CITY],[COUNTY],[STATE],[ZIPCODE], [COUNTRY],[PHONE1],[PHONE2],[PHONE3],[FAXNUMBR],[CHANGEBY_I], [CHANGEDATE_I],[NOTEINDX],[CCode] from ' + rtrim(@I_vFromCompany) + '..SY00600 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY00700' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY00700 ( [NOTENAME],[DATE1],[TIME1],[DSPLNAME],[TXTFIELD] ) select [NOTENAME],[DATE1],[TIME1],[DSPLNAME],[TXTFIELD] from ' + rtrim(@I_vFromCompany) + '..SY00700 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY01100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY01100 ( [SERIES],[SEQNUMBR],[ACTINDX],[PTGACDSC] ) select [SERIES],[SEQNUMBR],[ACTINDX],[PTGACDSC] from ' + rtrim(@I_vFromCompany) + '..SY01100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY01200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY01200 ( [Master_Type],[Master_ID],[ADRSCODE],[INET1],[INET2],[INET3], [INET4],[INET5],[INET6],[INET7],[INET8],[Messenger_Address], [DEX_ROW_TS],[INETINFO],[EmailToAddress],[EmailCcAddress],[EmailBccAddress] ) select [Master_Type],[Master_ID],[ADRSCODE],[INET1],[INET2],[INET3], [INET4],[INET5],[INET6],[INET7],[INET8],[Messenger_Address], [DEX_ROW_TS],[INETINFO],[EmailToAddress],[EmailCcAddress],[EmailBccAddress] from ' + rtrim(@I_vFromCompany) + '..SY01200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY01201' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY01201 ( [CUSTOMLINKPRMPT],[CUSTOMLINKLBL],[CUSTOMLINKFIELDVAL],[CUSTOMLINKINETADDR],[CUSTOMLINKADDRTYPE],[CUSTOMLINKADDRFIELD] ) select [CUSTOMLINKPRMPT],[CUSTOMLINKLBL],[CUSTOMLINKFIELDVAL],[CUSTOMLINKINETADDR],[CUSTOMLINKADDRTYPE],[CUSTOMLINKADDRFIELD] from ' + rtrim(@I_vFromCompany) + '..SY01201 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY02200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY02200 ( [FILEXPNM],[PRNTJRNL],[SERIES],[TRXSOURC],[PTGRPTNM],[ASECTMNT], [PRTOPRNT],[PRTOSCNT],[PRTOFLNT],[EXPTTYPE],[APNDRPLC] ) select [FILEXPNM],[PRNTJRNL],[SERIES],[TRXSOURC],[PTGRPTNM],[ASECTMNT], [PRTOPRNT],[PRTOSCNT],[PRTOFLNT],[EXPTTYPE],[APNDRPLC] from ' + rtrim(@I_vFromCompany) + '..SY02200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY02300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY02300 ( [UPSTDTFR],[BCHEXIST],[PTGENLED],[SERIES],[TRXSOURC],[PSTOGLHW], [ALTRXPST],[AUTPSTGL],[VERBATOT],[VERTRX],[REQBAPRV],[PASSWORD], [INCMCINF],[Use_Account_Settings],[POSTINDETAIL] ) select [UPSTDTFR],[BCHEXIST],[PTGENLED],[SERIES],[TRXSOURC],[PSTOGLHW], [ALTRXPST],[AUTPSTGL],[VERBATOT],[VERTRX],[REQBAPRV],[PASSWORD], [INCMCINF],[Use_Account_Settings],[POSTINDETAIL] from ' + rtrim(@I_vFromCompany) + '..SY02300 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY03000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY03000 ( [SHIPMTHD],[SHMTHDSC],[PHONNAME],[CONTACT],[CARRACCT],[CARRIER], [SHIPTYPE],[NOTEINDX],[LSTUSRED],[CREATDDT],[MODIFDT] ) select [SHIPMTHD],[SHMTHDSC],[PHONNAME],[CONTACT],[CARRACCT],[CARRIER], [SHIPTYPE],[NOTEINDX],[LSTUSRED],[CREATDDT],[MODIFDT] from ' + rtrim(@I_vFromCompany) + '..SY03000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY03100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY03100 ( [PYBLGRBX],[RCVBGRBX],[CARDNAME],[CBPAYBLE],[CBRCVBLE],[CKBKNUM1], [CKBKNUM2],[ACTINDX],[VENDORID],[NOTEINDX],[LSTUSRED],[CREATDDT], [MODIFDT] ) select [PYBLGRBX],[RCVBGRBX],[CARDNAME],[CBPAYBLE],[CBRCVBLE],[CKBKNUM1], [CKBKNUM2],[ACTINDX],[VENDORID],[NOTEINDX],[LSTUSRED],[CREATDDT], [MODIFDT] from ' + rtrim(@I_vFromCompany) + '..SY03100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY03300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY03300 ( [PYMTRMID],[DUETYPE],[DUEDTDS],[DISCTYPE],[DISCDTDS],[DSCLCTYP], [DSCDLRAM],[DSCPCTAM],[SALPURCH],[DISCNTCB],[FREIGHT],[MISC], [TAX],[NOTEINDX],[CBUVATMD],[LSTUSRED],[MODIFDT],[CREATDDT], [USEGRPER] ) select [PYMTRMID],[DUETYPE],[DUEDTDS],[DISCTYPE],[DISCDTDS],[DSCLCTYP], [DSCDLRAM],[DSCPCTAM],[SALPURCH],[DISCNTCB],[FREIGHT],[MISC], [TAX],[NOTEINDX],[CBUVATMD],[LSTUSRED],[MODIFDT],[CREATDDT], [USEGRPER] from ' + rtrim(@I_vFromCompany) + '..SY03300 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY03900' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY03900 ( [NOTEINDX],[DATE1],[TIME1],[TXTFIELD] ) select [NOTEINDX],[DATE1],[TIME1],[TXTFIELD] from ' + rtrim(@I_vFromCompany) + '..SY03900 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY04100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY04100 ( [BANKID],[BANKNAME],[ADDRESS1],[ADDRESS2],[ADDRESS3],[CITY], [STATE],[ZIPCODE],[COUNTRY],[PHNUMBR1],[PHNUMBR2],[PHONE3], [FAXNUMBR],[TRNSTNBR],[BNKBRNCH],[NOTEINDX],[DDTRANUM] ) select [BANKID],[BANKNAME],[ADDRESS1],[ADDRESS2],[ADDRESS3],[CITY], [STATE],[ZIPCODE],[COUNTRY],[PHNUMBR1],[PHNUMBR2],[PHONE3], [FAXNUMBR],[TRNSTNBR],[BNKBRNCH],[NOTEINDX],[DDTRANUM] from ' + rtrim(@I_vFromCompany) + '..SY04100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY04200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY04200 ( [CMTSRIES],[COMMNTID],[NOTEINDX],[CMMTTEXT] ) select [CMTSRIES],[COMMNTID],[NOTEINDX],[CMMTTEXT] from ' + rtrim(@I_vFromCompany) + '..SY04200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY40100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY40100 ( [CLOSED],[SERIES],[ODESCTN],[FORIGIN],[PERIODID],[PERIODDT], [PERNAME],[PSERIES_1],[PSERIES_2],[PSERIES_3],[PSERIES_4],[PSERIES_5], [PSERIES_6],[YEAR1],[PERDENDT] ) select [CLOSED],[SERIES],[ODESCTN],[FORIGIN],[PERIODID],[PERIODDT], [PERNAME],[PSERIES_1],[PSERIES_2],[PSERIES_3],[PSERIES_4],[PSERIES_5], [PSERIES_6],[YEAR1],[PERDENDT] from ' + rtrim(@I_vFromCompany) + '..SY40100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY40101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY40101 ( [YEAR1],[FSTFSCDY],[LSTFSCDY],[NUMOFPER],[HISTORYR] ) select [YEAR1],[FSTFSCDY],[LSTFSCDY],[NUMOFPER],[HISTORYR] from ' + rtrim(@I_vFromCompany) + '..SY40101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY40102' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY40102 ( [CLOSED],[SERIES],[ODESCTN],[FORIGIN],[PERIODID],[PERIODDT], [PERNAME],[PSERIES_1],[PSERIES_2],[PSERIES_3],[PSERIES_4],[PSERIES_5], [PSERIES_6],[YEAR1] ) select [CLOSED],[SERIES],[ODESCTN],[FORIGIN],[PERIODID],[PERIODDT], [PERNAME],[PSERIES_1],[PSERIES_2],[PSERIES_3],[PSERIES_4],[PSERIES_5], [PSERIES_6],[YEAR1] from ' + rtrim(@I_vFromCompany) + '..SY40102 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY40103' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY40103 ( [YEAR1],[FSTFSCDY],[LSTFSCDY],[NUMOFPER],[HISTORYR] ) select [YEAR1],[FSTFSCDY],[LSTFSCDY],[NUMOFPER],[HISTORYR] from ' + rtrim(@I_vFromCompany) + '..SY40103 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY04951' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY04951 ( [PRODID],[RTGRSBIN],[RPRTNAME],[EmailMessageSubject],[EmailMessageBody] ) select [PRODID],[RTGRSBIN],[RPRTNAME],[EmailMessageSubject],[EmailMessageBody] from ' + rtrim(@I_vFromCompany) + '..SY04951 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..CO40100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..CO40100 ( [SETUPKEY],[Enable_Feature],[View_Attachment],[Internal_Attachment],[Allow_Removal],[Flow_From_Item], [Flow_From_Vendor],[Flow_From_Customer],[Scan_Location],[Delete_After_Attach],[EmailSetFileSize],[EmailMaxFileSize] ) select [SETUPKEY],[Enable_Feature],[View_Attachment],[Internal_Attachment],[Allow_Removal],[Flow_From_Item], [Flow_From_Vendor],[Flow_From_Customer],[Scan_Location],[Delete_After_Attach],[EmailSetFileSize],[EmailMaxFileSize] from ' + rtrim(@I_vFromCompany) + '..CO40100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY04900' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY04900 ( [SETUPKEY],[EmailAllowEmbedding],[EmailAllowAttachments],[EmailAllowDocXAttach],[EmailAllowHTMLAttach],[EmailAllowPDFAttach], [EmailAllowXPSAttach] ) select [SETUPKEY],[EmailAllowEmbedding],[EmailAllowAttachments],[EmailAllowDocXAttach],[EmailAllowHTMLAttach],[EmailAllowPDFAttach], [EmailAllowXPSAttach] from ' + rtrim(@I_vFromCompany) + '..SY04900 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY04901' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY04901 ( [EmailMessageID],[EmailDictionaryID],[EmailSeriesID],[EmailDocumentID],[EmailMessageDesc],[EmailMessageSubject], [EmailMessageFrom],[EmailReplyToAddress],[EmailMessageBody] ) select [EmailMessageID],[EmailDictionaryID],[EmailSeriesID],[EmailDocumentID],[EmailMessageDesc],[EmailMessageSubject], [EmailMessageFrom],[EmailReplyToAddress],[EmailMessageBody] from ' + rtrim(@I_vFromCompany) + '..SY04901 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY04902' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY04902 ( [EmailDictionaryID],[EmailSeriesID],[Email_Series_GetMSG_ID],[EmailMessageFrom],[EmailACF],[EmailAllowChangeReplyTo], [EmailAllowUpdateEntry],[EmailReplyToAddress] ) select [EmailDictionaryID],[EmailSeriesID],[Email_Series_GetMSG_ID],[EmailMessageFrom],[EmailACF],[EmailAllowChangeReplyTo], [EmailAllowUpdateEntry],[EmailReplyToAddress] from ' + rtrim(@I_vFromCompany) + '..SY04902 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY04903' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY04903 ( [EmailDictionaryID],[EmailSeriesID],[MODULE1],[EmailDocumentID],[EmailDocumentEnabled],[EmailMessageID] ) select [EmailDictionaryID],[EmailSeriesID],[MODULE1],[EmailDocumentID],[EmailDocumentEnabled],[EmailMessageID] from ' + rtrim(@I_vFromCompany) + '..SY04903 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY04904' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY04904 ( [EmailDictionaryID],[EmailSeriesID],[EmailCardID],[EmailAllowEmbedding],[EmailAllowAttachments],[AllowMultipleAtt], [EmailSetFileSize],[EmailMaxFileSize] ) select [EmailDictionaryID],[EmailSeriesID],[EmailCardID],[EmailAllowEmbedding],[EmailAllowAttachments],[AllowMultipleAtt], [EmailSetFileSize],[EmailMaxFileSize] from ' + rtrim(@I_vFromCompany) + '..SY04904 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY04905' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY04905 ( [EmailDictionaryID],[EmailSeriesID],[MODULE1],[EmailCardID],[EmailDocumentID],[EmailDocumentEnabled], [EmailMessageID],[EmailDocumentFormat] ) select [EmailDictionaryID],[EmailSeriesID],[MODULE1],[EmailCardID],[EmailDocumentID],[EmailDocumentEnabled], [EmailMessageID],[EmailDocumentFormat] from ' + rtrim(@I_vFromCompany) + '..SY04905 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..TX00101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..TX00101 ( [TAXSCHID],[TXSCHDSC],[NOTEINDX] ) select [TAXSCHID],[TXSCHDSC],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..TX00101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..TX00102' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..TX00102 ( [TAXSCHID],[TAXDTLID],[TXDTLBSE],[TDTAXTAX],[Auto_Calculate] ) select [TAXSCHID],[TAXDTLID],[TXDTLBSE],[TDTAXTAX],[Auto_Calculate] from ' + rtrim(@I_vFromCompany) + '..TX00102 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..TX00201' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..TX00201 ( [TAXDTLID],[TXDTLDSC],[TXDTLTYP],[ACTINDX],[TXIDNMBR],[TXDTLBSE], [TXDTLPCT],[TXDTLAMT],[TDTLRNDG],[TXDBODTL],[TDTABMIN],[TDTABMAX], [TDTAXMIN],[TDTAXMAX],[TDRNGTYP],[TXDTQUAL],[TDTAXTAX],[TXDTLPDC], [TXDTLPCH],[TXDXDISC],[CMNYTXID],[NOTEINDX],[NAME],[CNTCPRSN], [ADDRESS1],[ADDRESS2],[ADDRESS3],[CITY],[STATE],[ZIPCODE], [COUNTRY],[PHONE1],[PHONE2],[PHONE3],[FAX],[TXUSRDF1], [TXUSRDF2],[VATREGTX],[TaxInvReqd],[TaxPostToAcct],[TaxBoxes],[IGNRGRSSAMNT], [TDTABPCT] ) select [TAXDTLID],[TXDTLDSC],[TXDTLTYP],[ACTINDX],[TXIDNMBR],[TXDTLBSE], [TXDTLPCT],[TXDTLAMT],[TDTLRNDG],[TXDBODTL],[TDTABMIN],[TDTABMAX], [TDTAXMIN],[TDTAXMAX],[TDRNGTYP],[TXDTQUAL],[TDTAXTAX],[TXDTLPDC], [TXDTLPCH],[TXDXDISC],[CMNYTXID],[NOTEINDX],[NAME],[CNTCPRSN], [ADDRESS1],[ADDRESS2],[ADDRESS3],[CITY],[STATE],[ZIPCODE], [COUNTRY],[PHONE1],[PHONE2],[PHONE3],[FAX],[TXUSRDF1], [TXUSRDF2],[VATREGTX],[TaxInvReqd],[TaxPostToAcct],[TaxBoxes],[IGNRGRSSAMNT], [TDTABPCT] from ' + rtrim(@I_vFromCompany) + '..TX00201 ' exec(@cStatement) end if (@I_vReportOptions = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY70100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY70100 ( [RPTGRIND],[RTGRSBIN],[RTPACHIN],[GRPSBIND],[RPTINDX1],[RPTINDX2], [RTCFGWIN],[RPTINDX3] ) select [RPTGRIND],[RTGRSBIN],[RTPACHIN],[GRPSBIND],[RPTINDX1],[RPTINDX2], [RTCFGWIN],[RPTINDX3] from ' + rtrim(@I_vFromCompany) + '..SY70100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY70200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY70200 ( [RTPACHIN],[RPTGRIND],[RTGRSBIN],[RPTGRNMS] ) select [RTPACHIN],[RPTGRIND],[RTGRSBIN],[RPTGRNMS] from ' + rtrim(@I_vFromCompany) + '..SY70200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY70300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY70300 ( [RTGRSBIN],[RTPACHIN],[RPTGRIND],[RPTGRNMS],[RTCFGWIN] ) select [RTGRSBIN],[RTPACHIN],[RPTGRIND],[RPTGRNMS],[RTCFGWIN] from ' + rtrim(@I_vFromCompany) + '..SY70300 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY70400' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY70400 ( [RPTGRIND],[RPTGRNMS],[RTGRSBIN],[RTPACHIN] ) select [RPTGRIND],[RPTGRNMS],[RTGRSBIN],[RTPACHIN] from ' + rtrim(@I_vFromCompany) + '..SY70400 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY70500' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY70500 ( [STDPSSRS],[ENDPSERS],[STSERVID],[ENDSRVID],[FINRPTNM],[PRNTNOTS], [PRNTTYPE],[STRTCMNM],[STRTZPCD],[STWSTNTY],[STTCATEG],[ENDCATEG], [ENDCMPNM],[ENDZIPCD],[ENDWSTYP],[ASKECHTM],[INCLGNDS],[PRNTOFIL], [PRTOPRTR],[PRTOSCRN],[IFFILXST],[FILEXPNM],[EXPTTYPE],[RPTGRIND], [RTPACHIN],[RTGRSBIN],[SORTBY],[RPTYPSEC],[ENDUSRID],[ENDUSRNM], [ENDUSRCL],[ENDINGDT],[ENDTKNDT],[ENDFRSRS],[STTUSRID],[STTUSRNM], [STTUSRCL],[STRTNGDT],[STTOKNDT],[STTFMSRS],[STCURRID],[ENDCURID], [STCURRDESC],[ENDCURRDESC],[STEXTABID],[ENDEXTABID],[STEXTABDESC],[ENDEXTABDESC], [STICID],[ENDICID],[STSECMODALTID],[STSECROLEID],[STSECTASKCAT],[STSECTASKID], [ENDSECMODALTID],[ENDSECROLEID],[ENDSECTASKCAT],[ENDSECTASKID],[IncludeInactiveUsers] ) select [STDPSSRS],[ENDPSERS],[STSERVID],[ENDSRVID],[FINRPTNM],[PRNTNOTS], [PRNTTYPE],[STRTCMNM],[STRTZPCD],[STWSTNTY],[STTCATEG],[ENDCATEG], [ENDCMPNM],[ENDZIPCD],[ENDWSTYP],[ASKECHTM],[INCLGNDS],[PRNTOFIL], [PRTOPRTR],[PRTOSCRN],[IFFILXST],[FILEXPNM],[EXPTTYPE],[RPTGRIND], [RTPACHIN],[RTGRSBIN],[SORTBY],[RPTYPSEC],[ENDUSRID],[ENDUSRNM], [ENDUSRCL],[ENDINGDT],[ENDTKNDT],[ENDFRSRS],[STTUSRID],[STTUSRNM], [STTUSRCL],[STRTNGDT],[STTOKNDT],[STTFMSRS],[STCURRID],[ENDCURID], [STCURRDESC],[ENDCURRDESC],[STEXTABID],[ENDEXTABID],[STEXTABDESC],[ENDEXTABDESC], [STICID],[ENDICID],[STSECMODALTID],[STSECROLEID],[STSECTASKCAT],[STSECTASKID], [ENDSECMODALTID],[ENDSECROLEID],[ENDSECTASKCAT],[ENDSECTASKID],[IncludeInactiveUsers] from ' + rtrim(@I_vFromCompany) + '..SY70500 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY70501' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY70501 ( [ORIGINGB],[STRTYEAR],[ENDYEAR],[STICID],[ENDICID],[FINRPTNM], [SJRNTPRT],[PRNTNOTS],[PRNTTYPE],[ASKECHTM],[PRNTOFIL],[PRTOPRTR], [PRTOSCRN],[INCLGNDS],[IFFILXST],[FILEXPNM],[EXPTTYPE],[RPTGRIND], [RTPACHIN],[RTGRSBIN],[SORTBY],[STTLOCID],[STTLOCNM],[STADDCTT], [SSRCEDOC],[SSDOCDSC],[STTSTATE],[STRTZPCD],[STTFLSRS],[STARTSRS], [STTRXSRC],[STTNOTNM],[SRPTGRNM],[STTPALNM],[STTUSRID],[STENDTYP], [STTCRDNM],[STTPYTID],[STTSHMTH],[SRTCOMSR],[SRTCOMID],[ENDLOCID], [ENDLOCNM],[ENDADDCT],[ENDSRCDC],[ENDSDDSC],[ENDSTATE],[ENDZIPCD], [ENDFLSRS],[ENDSERIS],[ENDTRXSR],[ENDNOTNM],[ENDRPGNM],[ENDPALNM], [ENDUSRID],[ENDENDTY],[ENDCRDNM],[ENDPYTID],[ENDSHMTH],[ENDCOMID], [ENDCOMSR],[ENDNAME],[ENDID],[STARTID],[STRTNAME],[STRTCITY], [ENDCITY],[ENDCNTRY],[STTCNTRY],[LBLFRMAT],[NUMOCPIS],[NUMACROS], [INCADADR],[INCCNTCT],[FRCEUPCS],[YEAR1],[PRNTDTLD],[ENTXDDSC], [ETXDTLID],[ETXSCHDS],[ETXSCHID],[STTXDDSC],[STTXDTID],[STXSCDSC], [STXSCHID],[ENDPEROD],[STPERIOD],[STDTLTYP],[ENDETTYP],[STXIDNUM], [ETXIDNBR],[HISTTYPE],[STBCHNUM],[STRTDATE],[STDOCNUM],[ENDBNMBR], [ENDOCNUM],[ENDDATE],[PRNSHPTO],[PRTBLLTO],[ARVLDEPART],[STCUSTID], [ENCUSTID],[STSOPTYP],[EDSOPTYP],[UPSIDNBR],[STTDOCDT],[ENDDOCDT], [STDOCTYP],[ENDOCTYP],[STVNDRID],[ENDVNDID],[STRMTKDT],[ENRMTKDT], [STTXUSR1],[ENTXUSR1],[STTOKNDT],[ENDTKNDT],[STTXPYDT],[ENTXPYDT], [STTPSTDT],[ENDPSTDT],[STGENINT1],[STDECLID],[ENDDECLID],[STINTRSTTRTRNID], [ENDINTRSTTRTRNID],[STTCC],[ENDTCC],[STTXRGNNUM],[ENDTXRGNNUM],[STRTAMNT], [ENDAMNT],[GROUPBOX],[GROUPBX2],[EXCLVOID],[PRNTCSV] ) select [ORIGINGB],[STRTYEAR],[ENDYEAR],[STICID],[ENDICID],[FINRPTNM], [SJRNTPRT],[PRNTNOTS],[PRNTTYPE],[ASKECHTM],[PRNTOFIL],[PRTOPRTR], [PRTOSCRN],[INCLGNDS],[IFFILXST],[FILEXPNM],[EXPTTYPE],[RPTGRIND], [RTPACHIN],[RTGRSBIN],[SORTBY],[STTLOCID],[STTLOCNM],[STADDCTT], [SSRCEDOC],[SSDOCDSC],[STTSTATE],[STRTZPCD],[STTFLSRS],[STARTSRS], [STTRXSRC],[STTNOTNM],[SRPTGRNM],[STTPALNM],[STTUSRID],[STENDTYP], [STTCRDNM],[STTPYTID],[STTSHMTH],[SRTCOMSR],[SRTCOMID],[ENDLOCID], [ENDLOCNM],[ENDADDCT],[ENDSRCDC],[ENDSDDSC],[ENDSTATE],[ENDZIPCD], [ENDFLSRS],[ENDSERIS],[ENDTRXSR],[ENDNOTNM],[ENDRPGNM],[ENDPALNM], [ENDUSRID],[ENDENDTY],[ENDCRDNM],[ENDPYTID],[ENDSHMTH],[ENDCOMID], [ENDCOMSR],[ENDNAME],[ENDID],[STARTID],[STRTNAME],[STRTCITY], [ENDCITY],[ENDCNTRY],[STTCNTRY],[LBLFRMAT],[NUMOCPIS],[NUMACROS], [INCADADR],[INCCNTCT],[FRCEUPCS],[YEAR1],[PRNTDTLD],[ENTXDDSC], [ETXDTLID],[ETXSCHDS],[ETXSCHID],[STTXDDSC],[STTXDTID],[STXSCDSC], [STXSCHID],[ENDPEROD],[STPERIOD],[STDTLTYP],[ENDETTYP],[STXIDNUM], [ETXIDNBR],[HISTTYPE],[STBCHNUM],[STRTDATE],[STDOCNUM],[ENDBNMBR], [ENDOCNUM],[ENDDATE],[PRNSHPTO],[PRTBLLTO],[ARVLDEPART],[STCUSTID], [ENCUSTID],[STSOPTYP],[EDSOPTYP],[UPSIDNBR],[STTDOCDT],[ENDDOCDT], [STDOCTYP],[ENDOCTYP],[STVNDRID],[ENDVNDID],[STRMTKDT],[ENRMTKDT], [STTXUSR1],[ENTXUSR1],[STTOKNDT],[ENDTKNDT],[STTXPYDT],[ENTXPYDT], [STTPSTDT],[ENDPSTDT],[STGENINT1],[STDECLID],[ENDDECLID],[STINTRSTTRTRNID], [ENDINTRSTTRTRNID],[STTCC],[ENDTCC],[STTXRGNNUM],[ENDTXRGNNUM],[STRTAMNT], [ENDAMNT],[GROUPBOX],[GROUPBX2],[EXCLVOID],[PRNTCSV] from ' + rtrim(@I_vFromCompany) + '..SY70501 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY70600' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY70600 ( [RPTGRIND],[RTPACHIN],[RTGRSBIN],[Report_Selection],[ASECTMNT],[PRTOFLNT], [PRTOPRNT],[PRTOSCNT],[FILEXPNM],[XPRTFTYP],[RPRTNAME],[Named_Printers] ) select [RPTGRIND],[RTPACHIN],[RTGRSBIN],[Report_Selection],[ASECTMNT],[PRTOFLNT], [PRTOPRNT],[PRTOSCNT],[FILEXPNM],[XPRTFTYP],[RPRTNAME],[Named_Printers] from ' + rtrim(@I_vFromCompany) + '..SY70600 ' exec(@cStatement) end select @cStatement = 'update ' + rtrim(@I_vToCompany) + '..SY00600 set CMPANYID = ' + cast(@DestCMPANYID as varchar) exec(@cStatement) return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyCmpy] TO [DYNGRP]
GO
