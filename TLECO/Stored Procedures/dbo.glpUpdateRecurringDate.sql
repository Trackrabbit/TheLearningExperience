SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[glpUpdateRecurringDate]   @I_sBatchFrequency      smallint        = NULL,  @I_iMiscBatchDays       int             = NULL,  @IO_dDate                       datetime        = NULL output,  @O_iErrorState          int             = NULL output as  declare  @WEEKLY         smallint,  @BIWEEKLY               smallint,  @SEMIMONTHLY    smallint,  @MONTHLY                smallint,  @BIMONTHLY      smallint,  @QUARTERLY      smallint,  @MISCELLANEOUS  smallint,  @iTempDay               int,  @iTempMonth     int,   @iTempYear      int  select @O_iErrorState = 0  if      @IO_dDate                       is NULL or  @I_sBatchFrequency      is NULL or  @I_iMiscBatchDays       is NULL begin  select @O_iErrorState = 20576  return end   select  @WEEKLY         = 2,  @BIWEEKLY               = 3,  @SEMIMONTHLY    = 4,  @MONTHLY                = 5,  @BIMONTHLY      = 6,  @QUARTERLY      = 7,  @MISCELLANEOUS  = 8  if @I_sBatchFrequency = @WEEKLY  select @IO_dDate = dateadd(dd,7,@IO_dDate)  else if @I_sBatchFrequency = @BIWEEKLY  select @IO_dDate = dateadd(dd,14,@IO_dDate)  else if @I_sBatchFrequency = @SEMIMONTHLY begin  select  @iTempDay               = datepart(dd,@IO_dDate),  @iTempMonth     = datepart(mm,@IO_dDate),  @iTempYear      = datepart(yy,@IO_dDate)   if @iTempDay < 15  select @IO_dDate =  convert(char(2),@iTempMonth) +  '/' + convert(char(2),15) +  '/' + convert(char(4),@iTempYear)   else   begin  select @iTempMonth      = @iTempMonth + 1   if @iTempMonth = 13  select   @iTempMonth     = 1,  @iTempYear      = @iTempYear + 1   select @IO_dDate = convert(char(2),@iTempMonth) +  '/' + convert(char(2),1) +  '/' + convert(char(4),@iTempYear)   end   end   else if @I_sBatchFrequency = @MONTHLY  select @IO_dDate = dateadd(mm,1,@IO_dDate)  else if @I_sBatchFrequency = @BIMONTHLY  select @IO_dDate = dateadd(mm,2,@IO_dDate)  else if @I_sBatchFrequency = @QUARTERLY  select @IO_dDate = dateadd(mm,3,@IO_dDate)  else if @I_sBatchFrequency = @MISCELLANEOUS  select @IO_dDate = dateadd(dd,@I_iMiscBatchDays,@IO_dDate)  return    
GO
GRANT EXECUTE ON  [dbo].[glpUpdateRecurringDate] TO [DYNGRP]
GO
