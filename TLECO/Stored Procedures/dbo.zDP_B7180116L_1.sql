SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE PROC [dbo].[zDP_B7180116L_1] (@VCHRNMBR_RS char(21), @CNTRLTYP_RS smallint, @APTVCHNM_RS char(21), @SPCLDIST_RS smallint, @DSTSQNUM_RS int, @SQNCLINE_RS numeric(19,5), @VCHRNMBR_RE char(21), @CNTRLTYP_RE smallint, @APTVCHNM_RE char(21), @SPCLDIST_RE smallint, @DSTSQNUM_RE int, @SQNCLINE_RE numeric(19,5)) AS /* 12.00.0311.000 */ set nocount on IF @VCHRNMBR_RS IS NULL BEGIN SELECT TOP 25  VCHRNMBR, DOCTYPE, CNTRLTYP, APTVCHNM, SPCLDIST, DSTSQNUM, SQNCLINE, BSSI_Deferrable, BSSI_DeferralStartDate, BSSI_Recog_TemplateID, BSSI_Recog_Acct_Index, BSSI_ScheduleBasedOnDate, BSSI_Recog_Frequency, BSSI_DeferralEndDate, DEX_ROW_ID FROM .B7180116 ORDER BY VCHRNMBR DESC, CNTRLTYP DESC, APTVCHNM DESC, SPCLDIST DESC, DSTSQNUM DESC, SQNCLINE DESC END ELSE IF @VCHRNMBR_RS = @VCHRNMBR_RE BEGIN SELECT TOP 25  VCHRNMBR, DOCTYPE, CNTRLTYP, APTVCHNM, SPCLDIST, DSTSQNUM, SQNCLINE, BSSI_Deferrable, BSSI_DeferralStartDate, BSSI_Recog_TemplateID, BSSI_Recog_Acct_Index, BSSI_ScheduleBasedOnDate, BSSI_Recog_Frequency, BSSI_DeferralEndDate, DEX_ROW_ID FROM .B7180116 WHERE VCHRNMBR = @VCHRNMBR_RS AND CNTRLTYP BETWEEN @CNTRLTYP_RS AND @CNTRLTYP_RE AND APTVCHNM BETWEEN @APTVCHNM_RS AND @APTVCHNM_RE AND SPCLDIST BETWEEN @SPCLDIST_RS AND @SPCLDIST_RE AND DSTSQNUM BETWEEN @DSTSQNUM_RS AND @DSTSQNUM_RE AND SQNCLINE BETWEEN @SQNCLINE_RS AND @SQNCLINE_RE ORDER BY VCHRNMBR DESC, CNTRLTYP DESC, APTVCHNM DESC, SPCLDIST DESC, DSTSQNUM DESC, SQNCLINE DESC END ELSE BEGIN SELECT TOP 25  VCHRNMBR, DOCTYPE, CNTRLTYP, APTVCHNM, SPCLDIST, DSTSQNUM, SQNCLINE, BSSI_Deferrable, BSSI_DeferralStartDate, BSSI_Recog_TemplateID, BSSI_Recog_Acct_Index, BSSI_ScheduleBasedOnDate, BSSI_Recog_Frequency, BSSI_DeferralEndDate, DEX_ROW_ID FROM .B7180116 WHERE VCHRNMBR BETWEEN @VCHRNMBR_RS AND @VCHRNMBR_RE AND CNTRLTYP BETWEEN @CNTRLTYP_RS AND @CNTRLTYP_RE AND APTVCHNM BETWEEN @APTVCHNM_RS AND @APTVCHNM_RE AND SPCLDIST BETWEEN @SPCLDIST_RS AND @SPCLDIST_RE AND DSTSQNUM BETWEEN @DSTSQNUM_RS AND @DSTSQNUM_RE AND SQNCLINE BETWEEN @SQNCLINE_RS AND @SQNCLINE_RE ORDER BY VCHRNMBR DESC, CNTRLTYP DESC, APTVCHNM DESC, SPCLDIST DESC, DSTSQNUM DESC, SQNCLINE DESC END set nocount off 
GO
GRANT EXECUTE ON  [dbo].[zDP_B7180116L_1] TO [DYNGRP]
GO
