SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_POP30310UN_2] (@BS int, @ITEMNMBR char(31), @POPRCTNM char(17), @RCPTLNNM int, @ITEMNMBR_RS char(31), @POPRCTNM_RS char(17), @RCPTLNNM_RS int, @ITEMNMBR_RE char(31), @POPRCTNM_RE char(17), @RCPTLNNM_RE int) AS  set nocount on IF @ITEMNMBR_RS IS NULL BEGIN SELECT TOP 25  POPRCTNM, RCPTLNNM, PONUMBER, ITEMNMBR, ITEMDESC, VNDITNUM, VNDITDSC, UMQTYINB, ACTLSHIP, COMMNTID, INVINDX, UOFM, UNITCOST, EXTDCOST, LOCNCODE, RcptLineNoteIDArray_1, RcptLineNoteIDArray_2, RcptLineNoteIDArray_3, RcptLineNoteIDArray_4, RcptLineNoteIDArray_5, RcptLineNoteIDArray_6, RcptLineNoteIDArray_7, RcptLineNoteIDArray_8, NONINVEN, DECPLCUR, DECPLQTY, ITMTRKOP, TRXSORCE, JOBNUMBR, COSTCODE, COSTTYPE, CURRNIDX, ORUNTCST, OREXTCST, ODECPLCU, BOLPRONUMBER, Capital_Item, Product_Indicator, Purchase_IV_Item_Taxable, Purchase_Item_Tax_Schedu, Purchase_Site_Tax_Schedu, BSIVCTTL, TAXAMNT, ORTAXAMT, BCKTXAMT, OBTAXAMT, PURPVIDX, SHIPMTHD, Landed_Cost_Group_ID, Landed_Cost_Warnings, Landed_Cost, Invoice_Match, RCPTRETNUM, RCPTRETLNNUM, INVRETNUM, INVRETLNNUM, ISLINEINTRA, ProjNum, CostCatID, TrackedDropShipped, OriginatingPrepaymentAmt, ORDISTKN, ORTDISAM, DEX_ROW_ID FROM .POP30310 WHERE ( ITEMNMBR = @ITEMNMBR AND POPRCTNM = @POPRCTNM AND RCPTLNNM > @RCPTLNNM OR ITEMNMBR = @ITEMNMBR AND POPRCTNM > @POPRCTNM OR ITEMNMBR > @ITEMNMBR ) ORDER BY ITEMNMBR ASC, POPRCTNM ASC, RCPTLNNM ASC, DEX_ROW_ID ASC END ELSE IF @ITEMNMBR_RS = @ITEMNMBR_RE BEGIN SELECT TOP 25  POPRCTNM, RCPTLNNM, PONUMBER, ITEMNMBR, ITEMDESC, VNDITNUM, VNDITDSC, UMQTYINB, ACTLSHIP, COMMNTID, INVINDX, UOFM, UNITCOST, EXTDCOST, LOCNCODE, RcptLineNoteIDArray_1, RcptLineNoteIDArray_2, RcptLineNoteIDArray_3, RcptLineNoteIDArray_4, RcptLineNoteIDArray_5, RcptLineNoteIDArray_6, RcptLineNoteIDArray_7, RcptLineNoteIDArray_8, NONINVEN, DECPLCUR, DECPLQTY, ITMTRKOP, TRXSORCE, JOBNUMBR, COSTCODE, COSTTYPE, CURRNIDX, ORUNTCST, OREXTCST, ODECPLCU, BOLPRONUMBER, Capital_Item, Product_Indicator, Purchase_IV_Item_Taxable, Purchase_Item_Tax_Schedu, Purchase_Site_Tax_Schedu, BSIVCTTL, TAXAMNT, ORTAXAMT, BCKTXAMT, OBTAXAMT, PURPVIDX, SHIPMTHD, Landed_Cost_Group_ID, Landed_Cost_Warnings, Landed_Cost, Invoice_Match, RCPTRETNUM, RCPTRETLNNUM, INVRETNUM, INVRETLNNUM, ISLINEINTRA, ProjNum, CostCatID, TrackedDropShipped, OriginatingPrepaymentAmt, ORDISTKN, ORTDISAM, DEX_ROW_ID FROM .POP30310 WHERE ITEMNMBR = @ITEMNMBR_RS AND POPRCTNM BETWEEN @POPRCTNM_RS AND @POPRCTNM_RE AND RCPTLNNM BETWEEN @RCPTLNNM_RS AND @RCPTLNNM_RE AND ( ITEMNMBR = @ITEMNMBR AND POPRCTNM = @POPRCTNM AND RCPTLNNM > @RCPTLNNM OR ITEMNMBR = @ITEMNMBR AND POPRCTNM > @POPRCTNM OR ITEMNMBR > @ITEMNMBR ) ORDER BY ITEMNMBR ASC, POPRCTNM ASC, RCPTLNNM ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  POPRCTNM, RCPTLNNM, PONUMBER, ITEMNMBR, ITEMDESC, VNDITNUM, VNDITDSC, UMQTYINB, ACTLSHIP, COMMNTID, INVINDX, UOFM, UNITCOST, EXTDCOST, LOCNCODE, RcptLineNoteIDArray_1, RcptLineNoteIDArray_2, RcptLineNoteIDArray_3, RcptLineNoteIDArray_4, RcptLineNoteIDArray_5, RcptLineNoteIDArray_6, RcptLineNoteIDArray_7, RcptLineNoteIDArray_8, NONINVEN, DECPLCUR, DECPLQTY, ITMTRKOP, TRXSORCE, JOBNUMBR, COSTCODE, COSTTYPE, CURRNIDX, ORUNTCST, OREXTCST, ODECPLCU, BOLPRONUMBER, Capital_Item, Product_Indicator, Purchase_IV_Item_Taxable, Purchase_Item_Tax_Schedu, Purchase_Site_Tax_Schedu, BSIVCTTL, TAXAMNT, ORTAXAMT, BCKTXAMT, OBTAXAMT, PURPVIDX, SHIPMTHD, Landed_Cost_Group_ID, Landed_Cost_Warnings, Landed_Cost, Invoice_Match, RCPTRETNUM, RCPTRETLNNUM, INVRETNUM, INVRETLNNUM, ISLINEINTRA, ProjNum, CostCatID, TrackedDropShipped, OriginatingPrepaymentAmt, ORDISTKN, ORTDISAM, DEX_ROW_ID FROM .POP30310 WHERE ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND POPRCTNM BETWEEN @POPRCTNM_RS AND @POPRCTNM_RE AND RCPTLNNM BETWEEN @RCPTLNNM_RS AND @RCPTLNNM_RE AND ( ITEMNMBR = @ITEMNMBR AND POPRCTNM = @POPRCTNM AND RCPTLNNM > @RCPTLNNM OR ITEMNMBR = @ITEMNMBR AND POPRCTNM > @POPRCTNM OR ITEMNMBR > @ITEMNMBR ) ORDER BY ITEMNMBR ASC, POPRCTNM ASC, RCPTLNNM ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_POP30310UN_2] TO [DYNGRP]
GO
