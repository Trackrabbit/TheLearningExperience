SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[taPopRctUserDefined] @I_vPOPRCTNM char(17),      @I_vUser_Defined_List01 char(31) = '',   @I_vUser_Defined_List02 char(31) = '',   @I_vUser_Defined_List03 char(31) = '',   @I_vUser_Defined_List04 char(31) = '',   @I_vUser_Defined_List05 char(31) = '',   @I_vUser_Defined_Text01 char(31) = '',   @I_vUser_Defined_Text02 char(31) = '',   @I_vUser_Defined_Text03 char(31) = '',   @I_vUser_Defined_Text04 char(31) = '',   @I_vUser_Defined_Text05 char(31) = '',   @I_vUser_Defined_Text06 char(31) = '',   @I_vUser_Defined_Text07 char(31) = '',   @I_vUser_Defined_Text08 char(31) = '',   @I_vUser_Defined_Text09 char(31) = '',   @I_vUser_Defined_Text10 char(31) = '',   @I_vUser_Defined_Date01 datetime = '',   @I_vUser_Defined_Date02 datetime = '',   @I_vUser_Defined_Date03 datetime = '',   @I_vUser_Defined_Date04 datetime = '',   @I_vUser_Defined_Date05 datetime = '',   @I_vUser_Defined_Date06 datetime = '',   @I_vUser_Defined_Date07 datetime = '',   @I_vUser_Defined_Date08 datetime = '',   @I_vUser_Defined_Date09 datetime = '',   @I_vUser_Defined_Date10 datetime = '',   @I_vUser_Defined_Date11 datetime = '',   @I_vUser_Defined_Date12 datetime = '',   @I_vUser_Defined_Date13 datetime = '',   @I_vUser_Defined_Date14 datetime = '',   @I_vUser_Defined_Date15 datetime = '',   @I_vUser_Defined_Date16 datetime = '',   @I_vUser_Defined_Date17 datetime = '',   @I_vUser_Defined_Date18 datetime = '',   @I_vUser_Defined_Date19 datetime = '',   @I_vUser_Defined_Date20 datetime = '',   @I_vRequesterTrx smallint = 0,    @I_vUSRDEFND1 char(50) = '',    @I_vUSRDEFND2 char(50) = '',    @I_vUSRDEFND3 char(50) = '',    @I_vUSRDEFND4 varchar(8000) = '',   @I_vUSRDEFND5 varchar(8000) = '',   @O_iErrorState int output,    @oErrString varchar(255) output     with encryption as  set transaction isolation level read uncommitted set nocount on  declare  @iStatus int,  @iError int,  @iCustomState int,  @iCustomErrString varchar(255),  @O_oErrorState int  select  @iStatus = 0,  @iError = 0,  @iCustomState = 0,  @iCustomErrString = '',  @O_iErrorState = 0  if (@oErrString is NULL) begin  select @oErrString = '' end  exec @iStatus = taPopRctUserDefinedPre  @I_vPOPRCTNM output,  @I_vUser_Defined_List01 output,  @I_vUser_Defined_List02 output,  @I_vUser_Defined_List03 output,  @I_vUser_Defined_List04 output,  @I_vUser_Defined_List05 output,  @I_vUser_Defined_Text01 output,  @I_vUser_Defined_Text02 output,  @I_vUser_Defined_Text03 output,  @I_vUser_Defined_Text04 output,  @I_vUser_Defined_Text05 output,  @I_vUser_Defined_Text06 output,  @I_vUser_Defined_Text07 output,  @I_vUser_Defined_Text08 output,  @I_vUser_Defined_Text09 output,  @I_vUser_Defined_Text10 output,  @I_vUser_Defined_Date01 output,  @I_vUser_Defined_Date02 output,  @I_vUser_Defined_Date03 output,  @I_vUser_Defined_Date04 output,  @I_vUser_Defined_Date05 output,  @I_vUser_Defined_Date06 output,  @I_vUser_Defined_Date07 output,  @I_vUser_Defined_Date08 output,  @I_vUser_Defined_Date09 output,  @I_vUser_Defined_Date10 output,  @I_vUser_Defined_Date11 output,  @I_vUser_Defined_Date12 output,  @I_vUser_Defined_Date13 output,  @I_vUser_Defined_Date14 output,  @I_vUser_Defined_Date15 output,  @I_vUser_Defined_Date16 output,  @I_vUser_Defined_Date17 output,  @I_vUser_Defined_Date18 output,  @I_vUser_Defined_Date19 output,  @I_vUser_Defined_Date20 output,  @I_vRequesterTrx output,  @I_vUSRDEFND1 output,  @I_vUSRDEFND2 output,  @I_vUSRDEFND3 output,  @I_vUSRDEFND4 output,  @I_vUSRDEFND5 output,  @O_iErrorState = @iCustomState output,  @oErrString = @iCustomErrString output select @iError = @@error if @iStatus = 0 and @iError <> 0 begin  select @iStatus = @iError end if (@iStatus <> 0) or (@iCustomState <> 0) begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@iCustomErrString))  select @O_iErrorState = 759    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if(  @I_vPOPRCTNM is NULL) begin  select @O_iErrorState = 816    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if( @I_vPOPRCTNM = '') begin  select @O_iErrorState = 817    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vUser_Defined_List01 <> '') begin  if not exists(select 1 from POP40400 (nolock) where INDEX1 = 1 and DSCRIPTN = @I_vUser_Defined_List01)   begin  insert POP40400 (INDEX1, DSCRIPTN)  select 1, @I_vUser_Defined_List01  end  if (@@error <> 0)  begin  select @O_iErrorState = 835     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  if (@I_vUser_Defined_List02 <> '') begin  if not exists(select 1 from POP40400 (nolock) where INDEX1 = 2 and DSCRIPTN = @I_vUser_Defined_List02)   begin  insert POP40400 (INDEX1, DSCRIPTN)  select 2, @I_vUser_Defined_List02  end  if (@@error <> 0)  begin  select @O_iErrorState = 125     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  if (@I_vUser_Defined_List03 <> '') begin  if not exists(select 1 from POP40400 (nolock) where INDEX1 = 3 and DSCRIPTN = @I_vUser_Defined_List03)   begin  insert POP40400 (INDEX1, DSCRIPTN)  select 3, @I_vUser_Defined_List03  end  if (@@error <> 0)  begin  select @O_iErrorState = 988     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  if (@I_vUser_Defined_List04 <> '') begin  if not exists(select 1 from POP40400 (nolock) where INDEX1 = 4 and DSCRIPTN = @I_vUser_Defined_List04)   begin  insert POP40400 (INDEX1, DSCRIPTN)  select 4, @I_vUser_Defined_List04  end  if (@@error <> 0)  begin  select @O_iErrorState = 755     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  if (@I_vUser_Defined_List05 <> '') begin  if not exists(select 1 from POP40400 (nolock) where INDEX1 = 5 and DSCRIPTN = @I_vUser_Defined_List05)   begin  insert POP40400 (INDEX1, DSCRIPTN)  select 5, @I_vUser_Defined_List05  end  if (@@error <> 0)  begin  select @O_iErrorState = 756     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  if (@oErrString <> '')  return (@O_iErrorState)  if (@I_vRequesterTrx=0) begin  exec @iStatus = eConnectOutVerify  @I_vDOCTYPE='PO_Receiving_Transaction',  @I_vINDEX1=@I_vPOPRCTNM,  @I_vINDEX2='',  @I_vINDEX3='',  @I_vINDEX4='',  @I_vINDEX5='',  @I_vINDEX6='',  @I_vINDEX7='',  @I_vINDEX8='',  @I_vINDEX9='',  @I_vINDEX10='',  @I_vINDEX11='',  @I_vINDEX12='',  @I_vINDEX13='',  @I_vINDEX14='',  @I_vINDEX15='',  @I_vDelete = 0,  @O_iErrorState = @iCustomState output  select @iError = @@error  if @iStatus = 0 and @iError <> 0  begin  select @iStatus = @iError  end  if (@iStatus <> 0) or (@iCustomState <> 0)  begin  select @O_iErrorState = 2771   exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  insert POP10306  (  POPRCTNM,  User_Defined_List01,  User_Defined_List02,  User_Defined_List03,  User_Defined_List04,  User_Defined_List05,  User_Defined_Text01,  User_Defined_Text02,  User_Defined_Text03,  User_Defined_Text04,  User_Defined_Text05,  User_Defined_Text06,  User_Defined_Text07,  User_Defined_Text08,  User_Defined_Text09,  User_Defined_Text10,  User_Defined_Date01,  User_Defined_Date02,  User_Defined_Date03,  User_Defined_Date04,  User_Defined_Date05,  User_Defined_Date06,  User_Defined_Date07,  User_Defined_Date08,  User_Defined_Date09,  User_Defined_Date10,  User_Defined_Date11,  User_Defined_Date12,  User_Defined_Date13,  User_Defined_Date14,  User_Defined_Date15,  User_Defined_Date16,  User_Defined_Date17,  User_Defined_Date18,  User_Defined_Date19,  User_Defined_Date20  )  select   @I_vPOPRCTNM,  @I_vUser_Defined_List01,  @I_vUser_Defined_List02,  @I_vUser_Defined_List03,  @I_vUser_Defined_List04,  @I_vUser_Defined_List05,  @I_vUser_Defined_Text01,  @I_vUser_Defined_Text02,  @I_vUser_Defined_Text03,  @I_vUser_Defined_Text04,  @I_vUser_Defined_Text05,  @I_vUser_Defined_Text06,  @I_vUser_Defined_Text07,  @I_vUser_Defined_Text08,  @I_vUser_Defined_Text09,  @I_vUser_Defined_Text10,  @I_vUser_Defined_Date01,  @I_vUser_Defined_Date02,  @I_vUser_Defined_Date03,  @I_vUser_Defined_Date04,  @I_vUser_Defined_Date05,  @I_vUser_Defined_Date06,  @I_vUser_Defined_Date07,  @I_vUser_Defined_Date08,  @I_vUser_Defined_Date09,  @I_vUser_Defined_Date10,  @I_vUser_Defined_Date11,  @I_vUser_Defined_Date12,  @I_vUser_Defined_Date13,  @I_vUser_Defined_Date14,  @I_vUser_Defined_Date15,  @I_vUser_Defined_Date16,  @I_vUser_Defined_Date17,  @I_vUser_Defined_Date18,  @I_vUser_Defined_Date19,  @I_vUser_Defined_Date20  if (@@error <> 0) begin  select @O_iErrorState = 757     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  exec @iStatus = taPopRctUserDefinedPost  @I_vPOPRCTNM,  @I_vUser_Defined_List01,  @I_vUser_Defined_List02,  @I_vUser_Defined_List03,  @I_vUser_Defined_List04,  @I_vUser_Defined_List05,  @I_vUser_Defined_Text01,  @I_vUser_Defined_Text02,  @I_vUser_Defined_Text03,  @I_vUser_Defined_Text04,  @I_vUser_Defined_Text05,  @I_vUser_Defined_Text06,  @I_vUser_Defined_Text07,  @I_vUser_Defined_Text08,  @I_vUser_Defined_Text09,  @I_vUser_Defined_Text10,  @I_vUser_Defined_Date01,  @I_vUser_Defined_Date02,  @I_vUser_Defined_Date03,  @I_vUser_Defined_Date04,  @I_vUser_Defined_Date05,  @I_vUser_Defined_Date06,  @I_vUser_Defined_Date07,  @I_vUser_Defined_Date08,  @I_vUser_Defined_Date09,  @I_vUser_Defined_Date10,  @I_vUser_Defined_Date11,  @I_vUser_Defined_Date12,  @I_vUser_Defined_Date13,  @I_vUser_Defined_Date14,  @I_vUser_Defined_Date15,  @I_vUser_Defined_Date16,  @I_vUser_Defined_Date17,  @I_vUser_Defined_Date18,  @I_vUser_Defined_Date19,  @I_vUser_Defined_Date20,  @I_vRequesterTrx,  @I_vUSRDEFND1,  @I_vUSRDEFND2,  @I_vUSRDEFND3,  @I_vUSRDEFND4,  @I_vUSRDEFND5,  @O_iErrorState = @iCustomState output,  @oErrString = @iCustomErrString output select @iError = @@error if @iStatus = 0 and @iError <> 0 begin  select @iStatus = @iError end if (@iStatus <> 0) or (@iCustomState <> 0) begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@iCustomErrString))  select @O_iErrorState = 758    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if (@I_vRequesterTrx=0) begin  exec @iStatus = eConnectOutVerify  @I_vDOCTYPE='PO_Receiving_Transaction',  @I_vINDEX1=@I_vPOPRCTNM,  @I_vINDEX2='',  @I_vINDEX3='',  @I_vINDEX4='',  @I_vINDEX5='',  @I_vINDEX6='',  @I_vINDEX7='',  @I_vINDEX8='',  @I_vINDEX9='',  @I_vINDEX10='',  @I_vINDEX11='',  @I_vINDEX12='',  @I_vINDEX13='',  @I_vINDEX14='',  @I_vINDEX15='',  @I_vDelete = 1,  @O_iErrorState = @iCustomState output  select @iError = @@error  if (@iStatus = 0 and @iError <> 0)  begin  select @iStatus = @iError  end  if (@iStatus <> 0) or (@iCustomState <> 0)  begin  select @O_iErrorState = 2772   exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  return (@O_iErrorState)   
GO
GRANT EXECUTE ON  [dbo].[taPopRctUserDefined] TO [DYNGRP]
GO
