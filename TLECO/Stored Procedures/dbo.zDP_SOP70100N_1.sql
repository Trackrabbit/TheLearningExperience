SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SOP70100N_1] (@BS int, @INQID char(15), @INQID_RS char(15), @INQID_RE char(15)) AS  set nocount on IF @INQID_RS IS NULL BEGIN SELECT TOP 25  INQID, HISTORY, UNPSTTRX, SORTBY, NOTEINDX, CREATDDT, MODIFDT, USER2ENT, STCUSTID, ENCUSTID, STCUSTNM, ENCSTNAM, STTDOCDT, ENDDOCDT, STDOCNUM, ENDOCNUM, STSOPTYP, EDSOPTYP, STTDOCID, ENDDOCID, STTITNUM, ENITMNBR, STMSTNMB, EDMASNMB, STTPHON1, ENDPHON1, STQUOEXD, EDQUOEXD, STREQDAT, ENDREQDT, STSPRSID, ENSPSNID, STTUDEF1, ENUSRDF1, Start_Purchasing_Status, End_Purchasing_Status, DEX_ROW_ID FROM .SOP70100 WHERE ( INQID > @INQID ) ORDER BY INQID ASC END ELSE IF @INQID_RS = @INQID_RE BEGIN SELECT TOP 25  INQID, HISTORY, UNPSTTRX, SORTBY, NOTEINDX, CREATDDT, MODIFDT, USER2ENT, STCUSTID, ENCUSTID, STCUSTNM, ENCSTNAM, STTDOCDT, ENDDOCDT, STDOCNUM, ENDOCNUM, STSOPTYP, EDSOPTYP, STTDOCID, ENDDOCID, STTITNUM, ENITMNBR, STMSTNMB, EDMASNMB, STTPHON1, ENDPHON1, STQUOEXD, EDQUOEXD, STREQDAT, ENDREQDT, STSPRSID, ENSPSNID, STTUDEF1, ENUSRDF1, Start_Purchasing_Status, End_Purchasing_Status, DEX_ROW_ID FROM .SOP70100 WHERE INQID = @INQID_RS AND ( INQID > @INQID ) ORDER BY INQID ASC END ELSE BEGIN SELECT TOP 25  INQID, HISTORY, UNPSTTRX, SORTBY, NOTEINDX, CREATDDT, MODIFDT, USER2ENT, STCUSTID, ENCUSTID, STCUSTNM, ENCSTNAM, STTDOCDT, ENDDOCDT, STDOCNUM, ENDOCNUM, STSOPTYP, EDSOPTYP, STTDOCID, ENDDOCID, STTITNUM, ENITMNBR, STMSTNMB, EDMASNMB, STTPHON1, ENDPHON1, STQUOEXD, EDQUOEXD, STREQDAT, ENDREQDT, STSPRSID, ENSPSNID, STTUDEF1, ENUSRDF1, Start_Purchasing_Status, End_Purchasing_Status, DEX_ROW_ID FROM .SOP70100 WHERE INQID BETWEEN @INQID_RS AND @INQID_RE AND ( INQID > @INQID ) ORDER BY INQID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SOP70100N_1] TO [DYNGRP]
GO
