SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_AAG00903VN_1] (@BS int, @PERIODDT datetime, @aaFiscalPeriod smallint, @PERIODDT_RS datetime, @aaFiscalPeriod_RS smallint, @PERIODDT_RE datetime, @aaFiscalPeriod_RE smallint) AS  set nocount on IF @PERIODDT_RS IS NULL BEGIN SELECT TOP 25  PERIODDT, aaFiscalPeriod, PERDBLNC, DEX_ROW_ID FROM .AAG00903V WHERE ( PERIODDT = @PERIODDT AND aaFiscalPeriod > @aaFiscalPeriod OR PERIODDT > @PERIODDT ) ORDER BY PERIODDT ASC, aaFiscalPeriod ASC END ELSE IF @PERIODDT_RS = @PERIODDT_RE BEGIN SELECT TOP 25  PERIODDT, aaFiscalPeriod, PERDBLNC, DEX_ROW_ID FROM .AAG00903V WHERE PERIODDT = @PERIODDT_RS AND aaFiscalPeriod BETWEEN @aaFiscalPeriod_RS AND @aaFiscalPeriod_RE AND ( PERIODDT = @PERIODDT AND aaFiscalPeriod > @aaFiscalPeriod OR PERIODDT > @PERIODDT ) ORDER BY PERIODDT ASC, aaFiscalPeriod ASC END ELSE BEGIN SELECT TOP 25  PERIODDT, aaFiscalPeriod, PERDBLNC, DEX_ROW_ID FROM .AAG00903V WHERE PERIODDT BETWEEN @PERIODDT_RS AND @PERIODDT_RE AND aaFiscalPeriod BETWEEN @aaFiscalPeriod_RS AND @aaFiscalPeriod_RE AND ( PERIODDT = @PERIODDT AND aaFiscalPeriod > @aaFiscalPeriod OR PERIODDT > @PERIODDT ) ORDER BY PERIODDT ASC, aaFiscalPeriod ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_AAG00903VN_1] TO [DYNGRP]
GO
