SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[smChangeAccountIndex2]  @O_SQL_Error_State int = NULL  output with encryption as set transaction isolation level read uncommitted set nocount on declare @ACCOUNT_CHG 		char(255) declare @cStatement 		varchar(255) declare @budgetid		char(30) declare @fields			char(50) declare @statement		varchar(255) declare @ColumnName		varchar(100) select @O_SQL_Error_State =0 create table #values (fields char(50)) insert #values  Values ('FINOFFST') insert #values  Values ('INSRINDX') insert #values  Values ('INUSINDX') insert #values  Values ('INVINDX') insert #values  Values ('IVCOGSIX') insert #values  Values ('IVDMGIDX') insert #values  Values ('IVINSVIX') insert #values  Values ('IVINUSIX') insert #values  Values ('IVIVINDX') insert #values  Values ('IVIVOFIX') insert #values  Values ('IVSLDSIX') insert #values values ('IVSLSIDX') insert #values  Values ('IVSLRNIX') insert #values  Values ('IVVARIDX') insert #values  Values ('OFFINDX') insert #values  Values ('PMAPINDX') insert #values  Values ('PMCSHIDX') insert #values  Values ('PMDAVIDX') insert #values  Values ('PMDTKIDX') insert #values  Values ('PMFINIDX') insert #values  Values ('PMFRTIDX') insert #values  Values ('PMMSCHIX') insert #values  Values ('PMPRCHIX') insert #values  Values ('PMRTNGIX') insert #values  Values ('PMTAXIDX') insert #values  Values ('PMTDSCIX') insert #values  Values ('PMWRTIDX') insert #values  Values ('RTNSINDX') insert #values  Values ('RVLUEIDX') insert #values  Values ('RMARACC') insert #values  Values ('RMCSHACC') insert #values  Values ('RMCOSACC') insert #values  Values ('RMAVACC') insert #values  Values ('RMTAKACC') insert #values  Values ('RMFCGACC') insert #values  Values ('RMIVACC') insert #values  Values ('RMSLSACC') insert #values  Values ('RMWRACC') insert #values  Values ('SLSINDX') insert #values  Values ('MKDNINDX') insert #values  Values ('DMGDINDX') insert #values  Values ('CSLSINDX') insert #values  Values ('DPSHPIDX') insert #values  Values ('PURPVIDX') insert #values  Values ('IVRETIDX') insert #values  Values ('ASMVRIDX') insert #values  Values ('ACPURIDX') insert #values  Values ('TXDETACTIDX') insert #values  Values ('Cash_Account_Index') insert #values  Values ('Realized_GL_Account_Inde') insert #values  Values ('INFLAEQU') insert #values  Values ('INFLAREV') insert #values  Values ('UPPVIDX') insert #values  Values ('CGSINFLX') insert #values  Values ('CGSMCIDX') insert #values  Values ('IVINFIDX') insert #values  Values ('INVMCIDX') insert #values  Values ('PINFLIDX') insert #values  Values ('PURMCIDX') insert #values values ('PURACCACCT')							 insert #values values ('PURACCT')							 insert #values values ('ACCTPAYACCT')							 insert #values values ('ACCTPAYACCACCT')						 insert #values values ('DEFPURACCT')							 insert #values	 values ('DEFPURACCACCT')						 insert #values values ('PPVAccount')							 insert #values values ('DEFAULTIVVARIANCEINDEX')					 insert #values values ('Variance_Index')						 insert #values values ('WS_Account_Index_1')						 insert #values values ('WS_Account_Index_2')						 insert #values values ('WS_Account_Index_3')						 insert #values values ('WS_Account_Index_4')						 insert #values values ('WS_Account_Index_5')						 insert #values values ('WS_Account_Index_6')						 insert #values values ('WS_Account_Index_7')						 insert #values values ('WS_Account_Index_8')						 insert #values values ('WS_Account_Index_9')						 insert #values values ('WS_Account_Index_10')						 insert #values values ('WS_Account_Index_11')						 insert #values values ('WS_Account_Index_12')						 insert #values values ('WS_Account_Index_13')						 insert #values values ('WS_Account_Index_14')						 insert #values values ('WS_Account_Index_15')						 insert #values values ('WS_Account_Index_16')						 insert #values values ('WS_Account_Index_17')						 insert #values values ('WS_Account_Index_18')						 insert #values values ('WS_Account_Index_19')						 insert #values values ('WS_Account_Index_20')						 insert #values values ('WS_Account_Index_21')						 insert #values values ('WS_Account_Index_22')						 insert #values values ('WS_Account_Index_23')						 insert #values values ('WS_Account_Index_24')						 insert #values values ('WS_Account_Index_25')						 insert #values values ('Wennsoft_Account_Index_1')					 insert #values values ('Wennsoft_Account_Index_2')					 insert #values values ('Wennsoft_Account_Index_3')					 insert #values values ('Wennsoft_Account_Index_4')					 insert #values values ('Wennsoft_Account_Index_5')					 insert #values values ('Wennsoft_Account_Index_6')					 insert #values values ('Wennsoft_Account_Index_7')					 insert #values values ('Wennsoft_Account_Index_8')					 insert #values values ('Wennsoft_Account_Index_9')					 insert #values values ('Wennsoft_Account_Index_10')					 insert #values values ('Wennsoft_Account_Index_11')					 insert #values values ('Wennsoft_Account_Index_12')					 insert #values values ('Wennsoft_Account_Index_13')					 insert #values values ('Wennsoft_Account_Index_14')					 insert #values values ('Wennsoft_Account_Index_15')					 insert #values values ('Wennsoft_Account_Index_16')					 insert #values values ('Wennsoft_Account_Index_17')					 insert #values values ('Wennsoft_Account_Index_18')					 insert #values values ('Wennsoft_Account_Index_19')					 insert #values values ('Wennsoft_Account_Index_20')					 insert #values values ('Wennsoft_Account_Index_21')					 insert #values values ('Wennsoft_Account_Index_22')					 insert #values values ('Wennsoft_Account_Index_23')					 insert #values values ('Wennsoft_Account_Index_24')					 insert #values values ('Wennsoft_Account_Index_25')					 insert #values values ('Wennsoft_Account_Index_26')					 insert #values values ('Wennsoft_Account_Index_27')					 insert #values values ('Wennsoft_Account_Index_28')					 insert #values values ('Wennsoft_Account_Index_29')					 insert #values values ('Wennsoft_Account_Index_30')					 insert #values values ('Wennsoft_Account_Index_31')					 insert #values values ('Wennsoft_Account_Index_32')					 insert #values values ('Wennsoft_Account_Index_33')					 insert #values values ('Wennsoft_Account_Index_34')					 insert #values values ('Wennsoft_Account_Index_35')					 insert #values values ('Wennsoft_Account_Index_36')					 insert #values values ('Wennsoft_Account_Index_37')					 insert #values values ('Wennsoft_Account_Index_38')					 insert #values values ('Wennsoft_Account_Index_39')					 insert #values values ('Wennsoft_Account_Index_40')					 insert #values values ('DEPREXPACCTINDX')						 insert #values values ('DEPRRESVACCTINDX')						 insert #values values ('PRIORYRDEPRACCTINDX')						 insert #values values ('ASSETCOSTACCTINDX')						 insert #values values ('PROCEEDSACCTINDX')						 insert #values values ('RECGAINLOSSACCTINDX')						 insert #values values ('NONRECGAINLOSSACCTINDX')					 insert #values values ('CLEARINGACCTINDX')						 insert #values values ('FROMDEPREXPACCTINDX')						 insert #values values ('FROMDEPRRESVACCTINDX')						 insert #values values ('FROMPRYRDEPRACCTINDX')						 insert #values values ('FROMASSETCOSTACCTINDX')					 insert #values values ('FROMPROCEEDSACCTINDX')						 insert #values values ('FROMRECGAINLOSSACCTINDX')					 insert #values values ('FROMNONRECGAINLOSSACCTINDX')					 insert #values values ('FROMCLEARACCTINDX')						 insert #values values ('TODEPREXPACCTINDX')						 insert #values values ('TODEPRRESVACCTINDX')						 insert #values values ('TOPRYRDEPRACCTINDX')						 insert #values values ('TOASSETCOSTACCTINDX')						 insert #values values ('TOPROCEEDSACCTINDX')						 insert #values values ('TORECGAINLOSSACCTINDX')					 insert #values values ('TONONRECGAINLOSSACCTINDX')					 insert #values values ('TOCLEARACCTINDX')						 insert #values values ('GLINTACCTINDX')						 insert #values values ('PAACTINDX')							 insert #values values ('PACGBWIPIDX')							 insert #values values ('PAUnbilled_AR_Idx')						 insert #values values ('PACogs_Idx')							 insert #values values ('PAContra_Account_IDX')						 insert #values values ('PAOverhead_IDX')						 insert #values values ('PAUnbilled_Proj_Rev_Idx')					 insert #values values ('PA_Trade_IDX')							 insert #values values ('PA_Project_Sales_IDX')						 insert #values values ('PAAR_IDX')							 insert #values values ('PA_Deferred_RevIDX')						 insert #values values ('PABProjectBlgsIDX')						 insert #values values ('PA_FF_AR_IDX')							 insert #values values ('PABProjectRevenueIDX')						 insert #values values ('PA_Retention_AR')						 insert #values values ('PA_FF_Deferred_Rev_IDX')					 insert #values values ('PA_Retention_IDX')						 insert #values values ('PARev_IDX')							 insert #values values ('PABillRevAcctIdx')						 insert #values values ('PA_Sales_IDX')							 insert #values values ('PABBillingsIDX')						 insert #values values ('PABBIEEIDX')							 insert #values values ('PABEIEBIDX')							 insert #values values ('PABExpenseIDX')						 insert #values values ('PABLossIDX')							 insert #values values ('OFFACCT')							 insert #values  values ('PP_Deferred_BC_Index')						 insert #values											 values ('PP_Deferrals_Transfer_In')					 insert #values values ('PP_Recognition_Index')						 insert #values  values ('RMSORACC')							 insert #values  values ('PAY_OFFSET_ACCT_IDX')						 insert #values  values ('INT_INCOME_ACCT_IDX')						 insert #values  values ('REC_ACCT_IDX')							 insert #values  values ('CashInTransAcctIdx')						 insert #values values ('INT_EXP_ACCT_IDX')						 insert #values values ('PAY_ACCT_IDX')							 insert #values values ('REC_OFFSET_ACCT_IDX')						 insert #values  values ('COMM_Expense_Account_Index_LO')				 insert #values  values ('COMM_Payable_IDX')						 insert #values values ('STACCNDX')							 insert #values values ('EDACCNDX')							 insert #values values ('COMM_Expense_Account_Ind')					 insert #values values ('COMM_Payable_Account_Ind')					 insert #values values ('PCB_Cost_Account_Index')					 insert #values values ('PCB_Sales_Account_Index')					 insert #values values ('PCB_WIP_Account_Index')					 insert #values values ('PCB_Recovery_Account_Ind')					 insert #values values ('PCB_Accrual_Account_Inde')					 insert #values values ('PCB_Cash_Account_Index')					 insert #values values ('PCB_Creditor_Account_Ind')					 insert #values values ('PCB_Debtor_Account_Index')					 insert #values values ('PCB_Deposit_Account_Inde')					 insert #values values ('CASHINDEX')							 insert #values values ('DEPINDEX')							 insert #values values ('GL_Account_Number_CMP_In')					 insert #values values ('RERINDX')							 insert #values values ('NON_INV_CRED_ACCT_IDX_I')					 insert #values  values ('NON_INV_DEB_ACCT_IDX_I')					 insert #values values ('REALGAIN') insert #values values ('REALLOSS')    insert #values values ('UNRLGAIN')     insert #values values ('UNRLLOSS')       insert #values values ('PUROFFST')     insert #values values ('SLSOFFST')      insert #values values ('RNDWTOFF')          insert #values values ('RNDDIFF')   insert #values values ('SVC_Sales_Index_Part') insert #values values ('SVC_Sales_Index_Labor') insert #values values ('SVC_Sales_Index_Misc') insert #values values ('SVC_Sales_Index_Expense') insert #values  values ('SVC_COGS_Index_Part') insert #values  values ('SVC_COGS_Index_Labor') insert #values  values ('SVC_COGS_Index_Misc') insert #values  values ('SVC_COGS_Index_Expense') insert #values values ('SVC_Sales_Return_Index') insert #values values ('SVC_Purchase_Index') insert #values values ('SVC_Cost_Index') insert #values values ('SVC_Reimbursement_Index') insert #values values ('SVC_COGS_Index') insert #values  values ('SVC_Scrap_Index') insert #values values ('SVC_Repair_Sales_Index') insert #values values ('SVC_Expense_Index') insert #values values ('GL_Prepaid_Account') insert #values  values ('GL_Service_Account') insert #values values ('SVC_Discount_Account') insert #values  values ('RMOvrpymtWrtoffAcctIdx') insert #values values ('CAM_ControlAccountIndex')  insert #values values ('CAM_AccrualAccountIndex')  insert #values values ('if_fund_account_index')  insert #values values ('if_cfct_account_index') insert #values values ('PDebitAccountIndex') insert #values values ('PCreditAccountIndex') insert #values values ('PWCBDebitAccountIndex') insert #values values ('PQPPDebitAcctIdx') insert #values values ('PWCBCreditAccountIndex') insert #values values ('PCPPAccountIndex') insert #values values ('PAccountNumberIndex') insert #values values ('PUnitAccountIndex') insert #values values ('PCashAccountIndex') insert #values values ('PChequeingAccountIndex') insert #values values ('PDirectAccountIndex') insert #values values ('PAccountIndex') insert #values values ('PEIAcctIndex') insert #values values ('PMBHlthExpAcctInx') insert #values values ('PMBHlthPayAcctInx') insert #values values ('PNFHlthExpAcctInx') insert #values values ('PNFHlthPayAcctInx') insert #values values ('POntHlthExpAcctInx') insert #values values ('POntHlthPayAcctInx') insert #values values ('PPQHlthExpAcctInx') insert #values values ('PPQHlthPayAcctInx') insert #values values ('POwedFromEEAcctIndex') insert #values values ('PEmployeeARAcctIndex') insert #values values ('PBankedStatPayableAcctId') insert #values values ('PBenOffsetAcctInx') insert #values values ('PBnkSickLossAcctInx') insert #values values ('PBnkStatLossAcctInx') insert #values values ('PVacGainLossAcctInx') insert #values values ('PVacPayPayAcctInx') insert #values values ('Account_Index_Array_2_1') insert #values values ('Account_Index_Array_2_2') insert #values values ('Account_Index_Array_2_3') insert #values values ('Account_Index_Array_2_4') insert #values values ('Account_Index_Array_2_5') Delete ACColumn declare T_cursor insensitive CURSOR for  select fields from #values open T_cursor fetch next from T_cursor into @fields while (@@FETCH_STATUS <> -1) begin declare T_cursor1 insensitive CURSOR for select o.name, @fields as Columname from sysobjects o, syscolumns c where	(o.id = c.id and o.type = 'U' and c.name = rtrim(@fields)) order by o.name open T_cursor1 fetch next from T_cursor1 INTO @ACCOUNT_CHG,@ColumnName while (@@FETCH_STATUS <> -1) begin select @statement = 'insert into ACColumn values (''' + rtrim(@ACCOUNT_CHG) + ''',''' + rtrim(@ColumnName) + ''')' exec (@statement) fetch next from T_cursor1 into @ACCOUNT_CHG,@ColumnName end deallocate T_cursor1 fetch next from T_cursor into @fields end deallocate T_cursor 
GO
GRANT EXECUTE ON  [dbo].[smChangeAccountIndex2] TO [DYNGRP]
GO
