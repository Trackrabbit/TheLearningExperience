SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IVC10100N_4] (@BS int, @BCHSOURC char(15), @BACHNUMB char(15), @DOCTYPE smallint, @INVCNMBR char(21), @BCHSOURC_RS char(15), @BACHNUMB_RS char(15), @DOCTYPE_RS smallint, @INVCNMBR_RS char(21), @BCHSOURC_RE char(15), @BACHNUMB_RE char(15), @DOCTYPE_RE smallint, @INVCNMBR_RE char(21)) AS  set nocount on IF @BCHSOURC_RS IS NULL BEGIN SELECT TOP 25  DOCTYPE, INVCNMBR, BACHNUMB, BCHSOURC, PCKSLPNO, CUSTNMBR, CUSTNAME, CSTPONBR, POSTDATE, GLPOSTDT, DOCDATE, QUOTEDAT, ORDRDATE, DISCDATE, DUEDATE, HOLDNT, SHIPMTHD, TAXEXMT1, TAXEXMT2, TAXSCHID, FRTSCHID, FRGTTXBL, FRTTXAMT, MSCSCHID, MISCTXBL, MSCTXAMT, SLPRSNID, SALSTERR, TXRGNNUM, PYMTRMID, PRCLEVEL, LOCNCODE, CURNCYID, COMMNTID, DOCAMNT, SUBTOTAL, FRTAMNT, MISCAMNT, TAXAMNT, TXBTXAMT, BCKTXAMT, BKTSLSAM, BKTFRTAM, BKTMSCAM, DISCFRGT, DISCMISC, TRDISPCT, TRDISAMT, ACCTAMNT, PYMTRCVD, CODAMNT, EXTDCOST, DISCRTND, DISAVTKN, DISTKNAM, DISAVAMT, DSCDLRAM, DSCPCTAM, MRKDNAMT, PRBTADCD, PRSTADCD, CNTCPRSN, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, CCode, COUNTRY, PHNUMBR1, PHNUMBR2, PHONE3, FAXNUMBR, COMAPPTO, COMDLRAM, NCOMAMNT, UPSZONE, LSTUSRED, LSTEDTDT, MODIFDT, CREATDDT, USER2ENT, NOTEINDX, TIMESPRT, NOCARTNS, USERDEF1, USERDEF2, VOIDSTTS, TRXSORCE, PSTGSTUS, IVCHDER1, IVCHDER2, IVCLINEERR, LNITMSEQ, COMMENT_1, COMMENT_2, COMMENT_3, COMMENT_4, ECTRX, ShipToName, Tax_Date, APLYWITH, WITHHAMT, BackoutTradeDisc, DEX_ROW_ID, CMMTTEXT FROM .IVC10100 WHERE ( BCHSOURC = @BCHSOURC AND BACHNUMB = @BACHNUMB AND DOCTYPE = @DOCTYPE AND INVCNMBR > @INVCNMBR OR BCHSOURC = @BCHSOURC AND BACHNUMB = @BACHNUMB AND DOCTYPE > @DOCTYPE OR BCHSOURC = @BCHSOURC AND BACHNUMB > @BACHNUMB OR BCHSOURC > @BCHSOURC ) ORDER BY BCHSOURC ASC, BACHNUMB ASC, DOCTYPE ASC, INVCNMBR ASC END ELSE IF @BCHSOURC_RS = @BCHSOURC_RE BEGIN SELECT TOP 25  DOCTYPE, INVCNMBR, BACHNUMB, BCHSOURC, PCKSLPNO, CUSTNMBR, CUSTNAME, CSTPONBR, POSTDATE, GLPOSTDT, DOCDATE, QUOTEDAT, ORDRDATE, DISCDATE, DUEDATE, HOLDNT, SHIPMTHD, TAXEXMT1, TAXEXMT2, TAXSCHID, FRTSCHID, FRGTTXBL, FRTTXAMT, MSCSCHID, MISCTXBL, MSCTXAMT, SLPRSNID, SALSTERR, TXRGNNUM, PYMTRMID, PRCLEVEL, LOCNCODE, CURNCYID, COMMNTID, DOCAMNT, SUBTOTAL, FRTAMNT, MISCAMNT, TAXAMNT, TXBTXAMT, BCKTXAMT, BKTSLSAM, BKTFRTAM, BKTMSCAM, DISCFRGT, DISCMISC, TRDISPCT, TRDISAMT, ACCTAMNT, PYMTRCVD, CODAMNT, EXTDCOST, DISCRTND, DISAVTKN, DISTKNAM, DISAVAMT, DSCDLRAM, DSCPCTAM, MRKDNAMT, PRBTADCD, PRSTADCD, CNTCPRSN, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, CCode, COUNTRY, PHNUMBR1, PHNUMBR2, PHONE3, FAXNUMBR, COMAPPTO, COMDLRAM, NCOMAMNT, UPSZONE, LSTUSRED, LSTEDTDT, MODIFDT, CREATDDT, USER2ENT, NOTEINDX, TIMESPRT, NOCARTNS, USERDEF1, USERDEF2, VOIDSTTS, TRXSORCE, PSTGSTUS, IVCHDER1, IVCHDER2, IVCLINEERR, LNITMSEQ, COMMENT_1, COMMENT_2, COMMENT_3, COMMENT_4, ECTRX, ShipToName, Tax_Date, APLYWITH, WITHHAMT, BackoutTradeDisc, DEX_ROW_ID, CMMTTEXT FROM .IVC10100 WHERE BCHSOURC = @BCHSOURC_RS AND BACHNUMB BETWEEN @BACHNUMB_RS AND @BACHNUMB_RE AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND INVCNMBR BETWEEN @INVCNMBR_RS AND @INVCNMBR_RE AND ( BCHSOURC = @BCHSOURC AND BACHNUMB = @BACHNUMB AND DOCTYPE = @DOCTYPE AND INVCNMBR > @INVCNMBR OR BCHSOURC = @BCHSOURC AND BACHNUMB = @BACHNUMB AND DOCTYPE > @DOCTYPE OR BCHSOURC = @BCHSOURC AND BACHNUMB > @BACHNUMB OR BCHSOURC > @BCHSOURC ) ORDER BY BCHSOURC ASC, BACHNUMB ASC, DOCTYPE ASC, INVCNMBR ASC END ELSE BEGIN SELECT TOP 25  DOCTYPE, INVCNMBR, BACHNUMB, BCHSOURC, PCKSLPNO, CUSTNMBR, CUSTNAME, CSTPONBR, POSTDATE, GLPOSTDT, DOCDATE, QUOTEDAT, ORDRDATE, DISCDATE, DUEDATE, HOLDNT, SHIPMTHD, TAXEXMT1, TAXEXMT2, TAXSCHID, FRTSCHID, FRGTTXBL, FRTTXAMT, MSCSCHID, MISCTXBL, MSCTXAMT, SLPRSNID, SALSTERR, TXRGNNUM, PYMTRMID, PRCLEVEL, LOCNCODE, CURNCYID, COMMNTID, DOCAMNT, SUBTOTAL, FRTAMNT, MISCAMNT, TAXAMNT, TXBTXAMT, BCKTXAMT, BKTSLSAM, BKTFRTAM, BKTMSCAM, DISCFRGT, DISCMISC, TRDISPCT, TRDISAMT, ACCTAMNT, PYMTRCVD, CODAMNT, EXTDCOST, DISCRTND, DISAVTKN, DISTKNAM, DISAVAMT, DSCDLRAM, DSCPCTAM, MRKDNAMT, PRBTADCD, PRSTADCD, CNTCPRSN, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, CCode, COUNTRY, PHNUMBR1, PHNUMBR2, PHONE3, FAXNUMBR, COMAPPTO, COMDLRAM, NCOMAMNT, UPSZONE, LSTUSRED, LSTEDTDT, MODIFDT, CREATDDT, USER2ENT, NOTEINDX, TIMESPRT, NOCARTNS, USERDEF1, USERDEF2, VOIDSTTS, TRXSORCE, PSTGSTUS, IVCHDER1, IVCHDER2, IVCLINEERR, LNITMSEQ, COMMENT_1, COMMENT_2, COMMENT_3, COMMENT_4, ECTRX, ShipToName, Tax_Date, APLYWITH, WITHHAMT, BackoutTradeDisc, DEX_ROW_ID, CMMTTEXT FROM .IVC10100 WHERE BCHSOURC BETWEEN @BCHSOURC_RS AND @BCHSOURC_RE AND BACHNUMB BETWEEN @BACHNUMB_RS AND @BACHNUMB_RE AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND INVCNMBR BETWEEN @INVCNMBR_RS AND @INVCNMBR_RE AND ( BCHSOURC = @BCHSOURC AND BACHNUMB = @BACHNUMB AND DOCTYPE = @DOCTYPE AND INVCNMBR > @INVCNMBR OR BCHSOURC = @BCHSOURC AND BACHNUMB = @BACHNUMB AND DOCTYPE > @DOCTYPE OR BCHSOURC = @BCHSOURC AND BACHNUMB > @BACHNUMB OR BCHSOURC > @BCHSOURC ) ORDER BY BCHSOURC ASC, BACHNUMB ASC, DOCTYPE ASC, INVCNMBR ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IVC10100N_4] TO [DYNGRP]
GO
