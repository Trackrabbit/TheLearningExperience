SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_Dynamics_AccountTransactions] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqlstring11 varchar(8000),  @sqlstring12 varchar(8000),  @sqlstring13 varchar(8000), @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @Journal_Entry varchar(255), @Currency_ID varchar(255), @Currency_Index varchar(255), @Account_Type varchar(255), @Document_Status varchar(255), @Balance_For_Calculation varchar(255), @Batch_Number varchar(255), @DTA_GL_Status varchar(255), @DTA_Index varchar(255), @Description varchar(255), @Exchange_Date varchar(255), @Exchange_Rate varchar(255), @Exchange_Table_ID varchar(255), @History_Year varchar(255), @IC_TRX varchar(255), @Account_Index varchar(255), @Last_Date_Edited varchar(255), @Last_User varchar(255), @Fixed_Or_Variable varchar(255), @Intercompany_ID varchar(255), @Note_Index varchar(255), @Open_Year varchar(255), @Originating_Company_ID varchar(255), @Originating_Control_Number varchar(255), @Originating_DTA_Series varchar(255), @Originating_Document_Number varchar(255), @Originating_Journal_Entry varchar(255), @Originating_Master_ID varchar(255), @Originating_Master_Name varchar(255), @Originating_Posted_Date varchar(255), @Originating_Sequence_Number varchar(255), @Originating_Source varchar(255), @Originating_TRX_Source varchar(255), @Originating_TRX_Type varchar(255), @Originating_Type varchar(255), @Polled_Transaction varchar(255), @Quick_Offset varchar(255), @Rate_Calculation_Method varchar(255), @Posting_Type varchar(255), @Rate_Type_ID varchar(255), @Recurring_TRX_Sequence varchar(255), @Reference varchar(255), @Sequence_Number varchar(255), @Series varchar(255), @Source_Document varchar(255), @TRX_Date varchar(255), @TRX_Source varchar(255), @User_Who_Posted varchar(255), @Account_Number varchar(255), @Account_Description varchar(255), @Credit_Amount varchar(255), @Debit_Amount varchar(255), @Originating_Credit_Amount varchar(255), @Originating_Debit_Amount varchar(255), @Document_Date varchar(255), @Denomination_Exchange_Rate varchar(255), @Period_Posting_Number varchar(255), @Posting_Number varchar(255), @Period_ID varchar(255), @Line_Status varchar(255), @MC_Transaction_State varchar(255), @Time varchar(255), @Reversing_Date varchar(255), @Recurring_TRX varchar(255), @Transaction_Type varchar(255), @Reversing_TRX_Source varchar(255), @DTA_Control_Number varchar(255), @Closed_Year varchar(255), @History_TRX varchar(255), @Reversing_Period_ID varchar(255), @Reversing_Year varchar(255), @Reversing_Closed_Year varchar(255), @Reversing_History_TRX varchar(255), @ICDists varchar(255), @Printing_Status varchar(255), @Decimal_Places varchar(255), @Error_State varchar(255), @DTA_TRX_Type varchar(255), @Main_Account_Segment varchar(255), @Segment1 varchar(255), @Segment2 varchar(255), @Segment3 varchar(255), @Account_Type_from_Account_Master varchar(255), @Account_Description_from_Account_Master varchar(255), @Posting_Type_from_Account_Master varchar(255), @Account_Category_Number varchar(255), @Active varchar(255), @Typical_Balance varchar(255), @Decimal_Places_from_Account_Master varchar(255), @Fixed_Or_Variable_from_Account_Master varchar(255), @Balance_For_Calculation_from_Account_Master varchar(255), @Conversion_Method varchar(255), @Historical_Rate varchar(255), @Note_Index_from_Account_Master varchar(255), @Created_Date varchar(255), @Modified_Date varchar(255), @User_Defined_1 varchar(255), @User_Defined_2 varchar(255), @Post_Sales_In varchar(255), @Post_Inventory_In varchar(255), @Post_Purchasing_In varchar(255), @Post_Payroll_In varchar(255), @Adjust_for_Inflation varchar(255), @Inflation_Equity_Account_Index varchar(255), @Inflation_Revenue_Account_Index varchar(255), @CorrespondingUnit varchar(255), @Tax_Date varchar(255), @Batch_Source varchar(255), @Voided varchar(255), @Back_Out_JE varchar(255), @Original_JE varchar(255), @Correcting_JE varchar(255), @Segments varchar(255), @Workflow_Priority varchar(255), @Workflow_Approval_Status varchar(255), @Ledger_Name varchar(255), @Ledger_Description varchar(255), @DrillBack_Base_Url varchar(255), @Account_Index_For_DrillBack varchar(255), @Journal_Entry_For_DrillBack varchar(255), @Approval_User varchar(255), @Approval_Date varchar(255)  select @DrillBack_Base_Url = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),0)  select @I_iDictID = 1493 select @I_iMessageNumber = 24400 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Journal_Entry output  select @I_iDictID = 1493 select @I_iMessageNumber = 24401 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Currency_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 24402 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Currency_Index output  select @I_iDictID = 1493 select @I_iMessageNumber = 24403 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Account_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 24404 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Document_Status output  select @I_iDictID = 1493 select @I_iMessageNumber = 24405 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Balance_For_Calculation output  select @I_iDictID = 1493 select @I_iMessageNumber = 24406 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Batch_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 24407 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @DTA_GL_Status output  select @I_iDictID = 1493 select @I_iMessageNumber = 24408 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @DTA_Index output  select @I_iDictID = 1493 select @I_iMessageNumber = 24409 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Description output  select @I_iDictID = 1493 select @I_iMessageNumber = 24410 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 24411 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Rate output  select @I_iDictID = 1493 select @I_iMessageNumber = 24412 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Table_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 24413 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @History_Year output  select @I_iDictID = 1493 select @I_iMessageNumber = 24414 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @IC_TRX output  select @I_iDictID = 1493 select @I_iMessageNumber = 24415 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Account_Index output  select @I_iDictID = 1493 select @I_iMessageNumber = 24416 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Date_Edited output  select @I_iDictID = 1493 select @I_iMessageNumber = 24417 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_User output  select @I_iDictID = 1493 select @I_iMessageNumber = 24418 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Fixed_Or_Variable output  select @I_iDictID = 1493 select @I_iMessageNumber = 24419 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Intercompany_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 24420 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Note_Index output  select @I_iDictID = 1493 select @I_iMessageNumber = 24421 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Open_Year output  select @I_iDictID = 1493 select @I_iMessageNumber = 24423 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Company_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 24424 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Control_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 24425 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_DTA_Series output  select @I_iDictID = 1493 select @I_iMessageNumber = 24426 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Document_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 24427 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Journal_Entry output  select @I_iDictID = 1493 select @I_iMessageNumber = 24428 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Master_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 24429 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Master_Name output  select @I_iDictID = 1493 select @I_iMessageNumber = 24430 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Posted_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 24431 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Sequence_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 24432 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Source output  select @I_iDictID = 1493 select @I_iMessageNumber = 24433 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_TRX_Source output  select @I_iDictID = 1493 select @I_iMessageNumber = 24434 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_TRX_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 24435 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 24436 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Polled_Transaction output  select @I_iDictID = 1493 select @I_iMessageNumber = 24437 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Quick_Offset output  select @I_iDictID = 1493 select @I_iMessageNumber = 24438 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Rate_Calculation_Method output  select @I_iDictID = 1493 select @I_iMessageNumber = 24439 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Posting_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 24440 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Rate_Type_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 24441 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Recurring_TRX_Sequence output  select @I_iDictID = 1493 select @I_iMessageNumber = 24442 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reference output  select @I_iDictID = 1493 select @I_iMessageNumber = 24443 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Sequence_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 24444 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Series output  select @I_iDictID = 1493 select @I_iMessageNumber = 24445 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Source_Document output  select @I_iDictID = 1493 select @I_iMessageNumber = 24447 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TRX_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 24448 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TRX_Source output  select @I_iDictID = 1493 select @I_iMessageNumber = 24449 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Who_Posted output  select @I_iDictID = 1493 select @I_iMessageNumber = 24450 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 24451 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Account_Description output  select @I_iDictID = 1493 select @I_iMessageNumber = 24452 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Credit_Amount output  select @I_iDictID = 1493 select @I_iMessageNumber = 24453 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Debit_Amount output  select @I_iDictID = 1493 select @I_iMessageNumber = 24454 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Credit_Amount output  select @I_iDictID = 1493 select @I_iMessageNumber = 24455 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Debit_Amount output  select @I_iDictID = 1493 select @I_iMessageNumber = 24456 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Document_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 24457 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Denomination_Exchange_Rate output  select @I_iDictID = 1493 select @I_iMessageNumber = 24458 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Period_Posting_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 24459 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Posting_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 24460 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Period_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 24461 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Line_Status output  select @I_iDictID = 1493 select @I_iMessageNumber = 24462 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @MC_Transaction_State output  select @I_iDictID = 1493 select @I_iMessageNumber = 24463 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Time output  select @I_iDictID = 1493 select @I_iMessageNumber = 24464 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reversing_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 24465 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Recurring_TRX output  select @I_iDictID = 1493 select @I_iMessageNumber = 24467 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Transaction_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 24468 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reversing_TRX_Source output  select @I_iDictID = 1493 select @I_iMessageNumber = 24469 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @DTA_Control_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 24471 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Closed_Year output  select @I_iDictID = 1493 select @I_iMessageNumber = 24472 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @History_TRX output  select @I_iDictID = 1493 select @I_iMessageNumber = 24473 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reversing_Period_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 24474 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reversing_Year output  select @I_iDictID = 1493 select @I_iMessageNumber = 24475 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reversing_Closed_Year output  select @I_iDictID = 1493 select @I_iMessageNumber = 24476 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reversing_History_TRX output  select @I_iDictID = 1493 select @I_iMessageNumber = 24477 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ICDists output  select @I_iDictID = 1493 select @I_iMessageNumber = 24478 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Printing_Status output  select @I_iDictID = 1493 select @I_iMessageNumber = 24479 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Decimal_Places output  select @I_iDictID = 1493 select @I_iMessageNumber = 24485 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Error_State output  select @I_iDictID = 1493 select @I_iMessageNumber = 24486 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @DTA_TRX_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 22503 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Main_Account_Segment output  select @I_iDictID = 1493 select @I_iMessageNumber = 22529 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Segment1 output  select @I_iDictID = 1493 select @I_iMessageNumber = 22530 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Segment2 output  select @I_iDictID = 1493 select @I_iMessageNumber = 22531 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Segment3 output  select @I_iDictID = 1493 select @I_iMessageNumber = 22504 select @I_iAliasMessageNumber = 22481 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Account_Type_from_Account_Master output  select @I_iDictID = 1493 select @I_iMessageNumber = 22505 select @I_iAliasMessageNumber = 22481 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Account_Description_from_Account_Master output  select @I_iDictID = 1493 select @I_iMessageNumber = 22506 select @I_iAliasMessageNumber = 22481 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Posting_Type_from_Account_Master output  select @I_iDictID = 1493 select @I_iMessageNumber = 22507 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Account_Category_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 22508 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Active output  select @I_iDictID = 1493 select @I_iMessageNumber = 22509 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Typical_Balance output  select @I_iDictID = 1493 select @I_iMessageNumber = 22510 select @I_iAliasMessageNumber = 22481 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Decimal_Places_from_Account_Master output  select @I_iDictID = 1493 select @I_iMessageNumber = 22511 select @I_iAliasMessageNumber = 22481 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Fixed_Or_Variable_from_Account_Master output  select @I_iDictID = 1493 select @I_iMessageNumber = 22512 select @I_iAliasMessageNumber = 22481 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Balance_For_Calculation_from_Account_Master output  select @I_iDictID = 1493 select @I_iMessageNumber = 22514 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Conversion_Method output  select @I_iDictID = 1493 select @I_iMessageNumber = 22515 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Historical_Rate output  select @I_iDictID = 1493 select @I_iMessageNumber = 22516 select @I_iAliasMessageNumber = 22481 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Note_Index_from_Account_Master output  select @I_iDictID = 1493 select @I_iMessageNumber = 22517 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Created_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 22518 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Modified_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 22519 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_1 output  select @I_iDictID = 1493 select @I_iMessageNumber = 22520 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_2 output  select @I_iDictID = 1493 select @I_iMessageNumber = 22521 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Post_Sales_In output  select @I_iDictID = 1493 select @I_iMessageNumber = 22522 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Post_Inventory_In output  select @I_iDictID = 1493 select @I_iMessageNumber = 22523 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Post_Purchasing_In output  select @I_iDictID = 1493 select @I_iMessageNumber = 22524 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Post_Payroll_In output  select @I_iDictID = 1493 select @I_iMessageNumber = 22525 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Adjust_for_Inflation output  select @I_iDictID = 1493 select @I_iMessageNumber = 22526 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inflation_Equity_Account_Index output  select @I_iDictID = 1493 select @I_iMessageNumber = 22527 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inflation_Revenue_Account_Index output  select @I_iDictID = 1493 select @I_iMessageNumber = 24487 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @CorrespondingUnit output  select @I_iDictID = 1493 select @I_iMessageNumber = 24488 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tax_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 24489 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Batch_Source output  select @I_iDictID = 1493 select @I_iMessageNumber = 24490 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Voided output  select @I_iDictID = 1493 select @I_iMessageNumber = 24491 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Back_Out_JE output  select @I_iDictID = 1493 select @I_iMessageNumber = 24492 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Original_JE output  select @I_iDictID = 1493 select @I_iMessageNumber = 24493 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Correcting_JE output  select @I_iDictID = 0 select @I_iMessageNumber = 22021 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Segments output   select @I_iDictID = 0 select @I_iMessageNumber = 22070 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Workflow_Approval_Status output  select @I_iDictID = 0 select @I_iMessageNumber = 22078 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Workflow_Priority output  select @I_iDictID = 0 select @I_iMessageNumber = 22212 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ledger_Name output  select @I_iDictID = 0 select @I_iMessageNumber = 22213 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ledger_Description output  select @I_iDictID = 1493 select @I_iMessageNumber = 24415 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Account_Index_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 24400 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Journal_Entry_For_DrillBack output   select @I_iDictID = 0 select @I_iMessageNumber = 22232 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Approval_User output  select @I_iDictID = 0 select @I_iMessageNumber = 22233 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Approval_Date output  select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[AccountTransactions]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[AccountTransactions] '  select @sqldefaultstring =   'CREATE VIEW AccountTransactions AS ' +   'select ' +   '[''Transaction Amounts Work''].[JRNENTRY] as ''' + @Journal_Entry + ''', ' + '''' + @Series + ''' = dbo.DYN_FUNC_Series_GL_Trx([''Transaction Work''].[SERIES]), ' + '[''Transaction Work''].[TRXDATE] as ''' + @TRX_Date + ''', ' + '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Account Master''].[ACTINDX]) as ''' + @Account_Number + ''', ' + 'rtrim([''Account Master''].[ACTDESCR]) as ''' + @Account_Description + ''', ' + '[''Transaction Amounts Work''].[DEBITAMT] as ''' + @Debit_Amount + ''', ' + '[''Transaction Amounts Work''].[CRDTAMNT] as ''' + @Credit_Amount + ''', '   select @sqlstring1 =   '''' + @Account_Category_Number + ''' = dbo.DYN_FUNC_Account_Category_Number([''Account Master''].[ACCATNUM]), ' +  'rtrim([''Account Master''].[ACTDESCR]) as ''' + @Account_Description_from_Account_Master + ''', ' +  '[''Transaction Amounts Work''].[ACTINDX] as ''' + @Account_Index + ''', ' +  '''' + @Account_Type + ''' = dbo.DYN_FUNC_Account_Type([''Account Master''].[ACCTTYPE]), ' +  '''' + @Account_Type_from_Account_Master + ''' = dbo.DYN_FUNC_Account_Type([''Account Master''].[ACCTTYPE]), ' +  '''' + @Active + ''' = dbo.DYN_FUNC_Boolean_All([''Account Master''].[ACTIVE]), ' +  '''' + @Adjust_for_Inflation + ''' = dbo.DYN_FUNC_Boolean_All([''Account Master''].[ADJINFL]), ' +  'NULL  as ''' + @Back_Out_JE + ''', ' +  '''' + @Balance_For_Calculation + ''' = dbo.DYN_FUNC_Balance_For_Calculation([''Transaction Amounts Work''].[BALFRCLC]), ' +  '''' + @Balance_For_Calculation_from_Account_Master + ''' = dbo.DYN_FUNC_Balance_For_Calculation([''Account Master''].[BALFRCLC]), ' +  'rtrim([''Transaction Amounts Work''].[BACHNUMB]) as ''' + @Batch_Number + ''', ' +  'rtrim([''Transaction Work''].[BCHSOURC]) as ''' + @Batch_Source + ''', ' +  '''' + @Closed_Year + ''' = dbo.DYN_FUNC_Closed_Year([''Transaction Work''].[CLOSEDYR]), ' +  '''' + @Conversion_Method + ''' = dbo.DYN_FUNC_Conversion_Method([''Account Master''].[CNVRMTHD]), ' +  'NULL  as ''' + @Correcting_JE + ''', ' +  'rtrim([''Transaction Amounts Work''].[CorrespondingUnit]) as ''' + @CorrespondingUnit + ''', ' +  '[''Account Master''].[CREATDDT] as ''' + @Created_Date + ''', ' +  'rtrim([''Currency Setup''].[CURNCYID]) as ''' + @Currency_ID + ''', ' +  '[''Transaction Amounts Work''].[CURRNIDX] as ''' + @Currency_Index + ''', ' +  'rtrim([''Transaction Work''].[DTAControlNum]) as ''' + @DTA_Control_Number + ''', ' +  '[''Transaction Amounts Work''].[DTA_GL_Status] as ''' + @DTA_GL_Status + ''', ' +  '[''Transaction Work''].[DTA_Index] as ''' + @DTA_Index + ''', ' +  '[''Transaction Work''].[DTATRXType] as ''' + @DTA_TRX_Type + ''', ' +  '''' + @Decimal_Places + ''' = dbo.DYN_FUNC_Decimal_Places_QTYS([''Transaction Amounts Work''].[DECPLACS]), ' +  '''' + @Decimal_Places_from_Account_Master + ''' = dbo.DYN_FUNC_Decimal_Places_QTYS([''Account Master''].[DECPLACS]), ' +  '[''Transaction Work''].[DENXRATE] as ''' + @Denomination_Exchange_Rate + ''', ' +  'rtrim([''Transaction Amounts Work''].[DSCRIPTN]) as ''' + @Description + ''', ' +  '[''Transaction Work''].[DOCDATE] as ''' + @Document_Date + ''', ' +  '''' + @Document_Status + ''' = dbo.DYN_FUNC_Document_Status_GL_Trx(1), ' +  '[''Transaction Work''].[ERRSTATE] as ''' + @Error_State + ''', ' +  '[''Transaction Amounts Work''].[EXCHDATE] as ''' + @Exchange_Date + ''', ' +  '[''Transaction Amounts Work''].[XCHGRATE] as ''' + @Exchange_Rate + ''', ' +  'rtrim([''Transaction Amounts Work''].[EXGTBLID]) as ''' + @Exchange_Table_ID + ''', ' +  '''' + @Fixed_Or_Variable + ''' = dbo.DYN_FUNC_Fixed_Or_Variable([''Transaction Amounts Work''].[FXDORVAR]), ' +  '''' + @Fixed_Or_Variable_from_Account_Master + ''' = dbo.DYN_FUNC_Fixed_Or_Variable([''Account Master''].[FXDORVAR]), ' +  '[''Account Master''].[HSTRCLRT] as ''' + @Historical_Rate + ''', ' +  '''' + @History_TRX + ''' = dbo.DYN_FUNC_Boolean_All([''Transaction Work''].[HISTRX]), ' +  'NULL  as ''' + @History_Year + ''', ' +  '''' + @ICDists + ''' = dbo.DYN_FUNC_Boolean_All([''Transaction Work''].[ICDISTS]), ' +  '''' + @IC_TRX + ''' = dbo.DYN_FUNC_Boolean_All([''Transaction Work''].[ICTRX]), ' +  '[''Account Master''].[INFLAEQU] as ''' + @Inflation_Equity_Account_Index + ''', ' +  '[''Account Master''].[INFLAREV] as ''' + @Inflation_Revenue_Account_Index + ''', ' +  'rtrim([''Transaction Amounts Work''].[INTERID]) as ''' + @Intercompany_ID + ''', ' +  '[''Transaction Work''].[LSTDTEDT] as ''' + @Last_Date_Edited + ''', ' +  'rtrim([''Transaction Work''].[LASTUSER]) as ''' + @Last_User + ''', ' +  '''' + @Line_Status + ''' = dbo.DYN_FUNC_Line_Status([''Transaction Amounts Work''].[LNESTAT]), ' +  '''' + @MC_Transaction_State + ''' = dbo.DYN_FUNC_MC_Transaction_State([''Transaction Amounts Work''].[MCTRXSTT]), ' +  'rtrim([''Account Master''].[MNACSGMT]) as ''' + @Main_Account_Segment + ''', ' +  '[''Account Master''].[MODIFDT] as ''' + @Modified_Date + ''', ' +  '[''Transaction Work''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  '[''Account Master''].[NOTEINDX] as ''' + @Note_Index_from_Account_Master + ''', ' +  '''' + @Open_Year + ''' = dbo.DYN_FUNC_Open_Year([''Transaction Work''].[OPENYEAR]), ' +  '[''Transaction Work''].[Original_JE] as ''' + @Original_JE + ''', ' +  'rtrim([''Transaction Work''].[ORCOMID]) as ''' + @Originating_Company_ID + ''', ' +  'rtrim([''Transaction Amounts Work''].[ORCTRNUM]) as ''' + @Originating_Control_Number + ''', ' +  '[''Transaction Amounts Work''].[ORCRDAMT] as ''' + @Originating_Credit_Amount + ''', ' +  '''' + @Originating_DTA_Series + ''' = dbo.DYN_FUNC_Originating_DTA_Series([''Transaction Work''].[OrigDTASeries]), ' +  '[''Transaction Amounts Work''].[ORDBTAMT] as ''' + @Originating_Debit_Amount + ''', ' +  'rtrim([''Transaction Amounts Work''].[ORDOCNUM]) as ''' + @Originating_Document_Number + ''', ' +  '[''Transaction Work''].[ORIGINJE] as ''' + @Originating_Journal_Entry + ''', ' +  'rtrim([''Transaction Amounts Work''].[ORMSTRID]) as ''' + @Originating_Master_ID + ''', ' +  'rtrim([''Transaction Amounts Work''].[ORMSTRNM]) as ''' + @Originating_Master_Name + ''', ' +  '[''Transaction Work''].[ORPSTDDT] as ''' + @Originating_Posted_Date + ''', ' +  '[''Transaction Amounts Work''].[OrigSeqNum] as ''' + @Originating_Sequence_Number + ''', ' +  'NULL  as ''' + @Originating_Source + ''', ' +  'rtrim([''Transaction Work''].[ORTRXSRC]) as ''' + @Originating_TRX_Source + ''', ' +  '''' + @Originating_TRX_Type + ''' = dbo.DYN_FUNC_Originating_TRX_Type([''Transaction Amounts Work''].[ORTRXTYP]), ' +  'NULL  as ''' + @Originating_Type + ''', ' +  '[''Transaction Work''].[PERIODID] as ''' + @Period_ID + ''', ' +  'NULL  as ''' + @Period_Posting_Number + ''', '  select @sqlstring2 =   '''''  as ''' + @Approval_User + ''', ' +  'NULL  as ''' + @Approval_Date + ''', ' + 'NULL  as ''' + @Polled_Transaction + ''', ' +  '''' + @Post_Inventory_In + ''' = dbo.DYN_FUNC_Post_Inventory_In([''Account Master''].[PostIvIn]), ' +  '''' + @Post_Payroll_In + ''' = dbo.DYN_FUNC_Post_Payroll_In([''Account Master''].[PostPRIn]), ' +  '''' + @Post_Purchasing_In + ''' = dbo.DYN_FUNC_Post_Purchasing_In([''Account Master''].[PostPurchIn]), ' +  '''' + @Post_Sales_In + ''' = dbo.DYN_FUNC_Post_Sales_In([''Account Master''].[PostSlsIn]), ' +  'NULL  as ''' + @Posting_Number + ''', ' +  '''' + @Posting_Type + ''' = dbo.DYN_FUNC_Posting_Type([''Account Master''].[PSTNGTYP]), ' +  '''' + @Posting_Type_from_Account_Master + ''' = dbo.DYN_FUNC_Posting_Type([''Account Master''].[PSTNGTYP]), ' +  '''' + @Printing_Status + ''' = dbo.DYN_FUNC_Printing_Status([''Transaction Work''].[PRNTSTUS]), ' +  'NULL  as ''' + @Quick_Offset + ''', ' +  '''' + @Rate_Calculation_Method + ''' = dbo.DYN_FUNC_Rate_Calculation_Method([''Transaction Work''].[RTCLCMTD]), ' +  'rtrim([''Transaction Work''].[RATETPID]) as ''' + @Rate_Type_ID + ''', ' +  '''' + @Recurring_TRX + ''' = dbo.DYN_FUNC_Boolean_All([''Transaction Work''].[RCRNGTRX]), ' +  '[''Transaction Work''].[RCTRXSEQ] as ''' + @Recurring_TRX_Sequence + ''', ' +  'rtrim([''Transaction Work''].[REFRENCE]) as ''' + @Reference + ''', ' +  '''' + @Reversing_Closed_Year + ''' = dbo.DYN_FUNC_Reversing_Closed_Year([''Transaction Work''].[REVCLYR]), ' +  '[''Transaction Work''].[RVRSNGDT] as ''' + @Reversing_Date + ''', ' +  '''' + @Reversing_History_TRX + ''' = dbo.DYN_FUNC_Boolean_All([''Transaction Work''].[REVHIST]), ' +  '[''Transaction Work''].[REVPRDID] as ''' + @Reversing_Period_ID + ''', ' +  'rtrim([''Transaction Work''].[RVTRXSRC]) as ''' + @Reversing_TRX_Source + ''', ' +  '''' + @Reversing_Year + ''' = dbo.DYN_FUNC_Reversing_Year([''Transaction Work''].[REVYEAR]), '  select @tNumberSegments = count(SGMTNUMB) from SY00300  select @tSegment = 1  while @tSegment <= @tNumberSegments  begin  select @sqlstring2 = @sqlstring2 + '[''Account Master''].[ACTNUMBR_' + RTRIM(CAST(@tSegment as char(2))) + '] as ''Segment' + RTRIM(CAST(@tSegment as char(2))) +''', '  select @tSegment = @tSegment + 1  end  select @sqlstring2 = @sqlstring2 +  '[''Transaction Amounts Work''].[SQNCLINE] as ''' + @Sequence_Number + ''', ' +  'rtrim([''Transaction Work''].[SOURCDOC]) as ''' + @Source_Document + ''', ' +  'rtrim([''Transaction Work''].[TRXSORCE]) as ''' + @TRX_Source + ''', ' +  '[''Transaction Work''].[Tax_Date] as ''' + @Tax_Date + ''', ' +  '[''Transaction Amounts Work''].[TIME1] as ''' + @Time + ''', ' +  '''' + @Transaction_Type + ''' = dbo.DYN_FUNC_Transaction_Type([''Transaction Work''].[TRXTYPE]), ' +  '''' + @Typical_Balance + ''' = dbo.DYN_FUNC_Typical_Balance([''Account Master''].[TPCLBLNC]), ' +  'rtrim([''Account Master''].[USERDEF1]) as ''' + @User_Defined_1 + ''', ' +  'rtrim([''Account Master''].[USERDEF2]) as ''' + @User_Defined_2 + ''', ' +  'rtrim([''Transaction Work''].[USWHPSTD]) as ''' + @User_Who_Posted + ''', ' +  '''' + @Voided + ''' = dbo.DYN_FUNC_Boolean_All([''Transaction Work''].[VOIDED]), '  select @sqlstring3 = '''' + CAST(@tNumberSegments as varchar(3)) + ''' as ''' + @Segments + ''', ' + '''' + @Workflow_Approval_Status + ''' = dbo.DYN_FUNC_Workflow_Approval_Status([''Posting Definitions Master''].[Workflow_Approval_Status]), ' +  '''' + @Workflow_Priority + ''' = dbo.DYN_FUNC_Workflow_Priority([''Posting Definitions Master''].[Workflow_Priority]), ' +  '''' + @Ledger_Name + ''' = dbo.DYN_FUNC_GL_Ledger_Name([''Transaction Work''].[Ledger_ID]), '   select @sqlstring4 =  '''' + @Ledger_Description + ''' = dbo.DYN_FUNC_GL_Ledger_Description([''Transaction Work''].[Ledger_ID]), '+ '''' + @Account_Index_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Transaction Amounts Work''].[ACTINDX] ), '+ '''' + @Journal_Entry_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppJournalEntry(1,[''Transaction Amounts Work''].[JRNENTRY],[''Transaction Work''].[RCTRXSEQ],1,1 ) ' +  'from [GL10001] as [''Transaction Amounts Work''] with (NOLOCK) '   + 'left outer join [GL00100] as [''Account Master''] with (NOLOCK) on '   + '[''Transaction Amounts Work''].[ACTINDX] = [''Account Master''].[ACTINDX] '   + 'left outer join [GL10000] as [''Transaction Work''] with (NOLOCK) on '   + '[''Transaction Amounts Work''].[JRNENTRY] = [''Transaction Work''].[JRNENTRY] '   + 'left outer join [DYNAMICS].[dbo].[MC40200] as [''Currency Setup''] with (NOLOCK) on ' +   + '[''Transaction Amounts Work''].[CURRNIDX] = [''Currency Setup''].[CURRNIDX] '   + 'left outer join [SY00500] as [''Posting Definitions Master''] with (NOLOCK) on '   + '[''Transaction Work''].[BCHSOURC] = [''Posting Definitions Master''].[BCHSOURC] '   + ' and [''Transaction Work''].[BACHNUMB] = [''Posting Definitions Master''].[BACHNUMB] '   select @sqlstring5 =   'union all ' +   'select ' +   '[''Year-to-Date Transaction Open''].[JRNENTRY] as ''' + @Journal_Entry + ''', ' + '''' + @Series + ''' = dbo.DYN_FUNC_Series_GL_Trx([''Year-to-Date Transaction Open''].[SERIES]), ' + '[''Year-to-Date Transaction Open''].[TRXDATE] as ''' + @TRX_Date + ''', ' + '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Account Master''].[ACTINDX]) as ''' + @Account_Number + ''', ' + 'rtrim([''Account Master''].[ACTDESCR]) as ''' + @Account_Description + ''', ' + '[''Year-to-Date Transaction Open''].[DEBITAMT] as ''' + @Debit_Amount + ''', ' + '[''Year-to-Date Transaction Open''].[CRDTAMNT] as ''' + @Credit_Amount + ''', '   select @sqlstring6 =   '''' + @Account_Category_Number + ''' = dbo.DYN_FUNC_Account_Category_Number([''Account Master''].[ACCATNUM]), ' +  'rtrim([''Account Master''].[ACTDESCR]) as ''' + @Account_Description_from_Account_Master + ''', ' +  '[''Year-to-Date Transaction Open''].[ACTINDX] as ''' + @Account_Index + ''', ' +  '''' + @Account_Type + ''' = dbo.DYN_FUNC_Account_Type([''Account Master''].[ACCTTYPE]), ' +  '''' + @Account_Type_from_Account_Master + ''' = dbo.DYN_FUNC_Account_Type([''Account Master''].[ACCTTYPE]), ' +  '''' + @Active + ''' = dbo.DYN_FUNC_Boolean_All([''Account Master''].[ACTIVE]), ' +  '''' + @Adjust_for_Inflation + ''' = dbo.DYN_FUNC_Boolean_All([''Account Master''].[ADJINFL]), ' +  '[''Year-to-Date Transaction Open''].[Back_Out_JE] as ''' + @Back_Out_JE + ''', ' +  'NULL  as ''' + @Balance_For_Calculation + ''', ' +  '''' + @Balance_For_Calculation_from_Account_Master + ''' = dbo.DYN_FUNC_Balance_For_Calculation([''Account Master''].[BALFRCLC]), ' +  'NULL  as ''' + @Batch_Number + ''', ' +  'NULL  as ''' + @Batch_Source + ''', ' +  'NULL  as ''' + @Closed_Year + ''', ' +  '''' + @Conversion_Method + ''' = dbo.DYN_FUNC_Conversion_Method([''Account Master''].[CNVRMTHD]), ' +  '[''Year-to-Date Transaction Open''].[Correcting_JE] as ''' + @Correcting_JE + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[CorrespondingUnit]) as ''' + @CorrespondingUnit + ''', ' +  '[''Account Master''].[CREATDDT] as ''' + @Created_Date + ''', ' +  'rtrim([''Currency Setup''].[CURNCYID]) as ''' + @Currency_ID + ''', ' +  '[''Year-to-Date Transaction Open''].[CURRNIDX] as ''' + @Currency_Index + ''', ' +  'NULL  as ''' + @DTA_Control_Number + ''', ' +  '[''Year-to-Date Transaction Open''].[DTA_GL_Status] as ''' + @DTA_GL_Status + ''', ' +  '[''Year-to-Date Transaction Open''].[DTA_Index] as ''' + @DTA_Index + ''', ' +  'NULL  as ''' + @DTA_TRX_Type + ''', ' +  'NULL  as ''' + @Decimal_Places + ''', ' +  '''' + @Decimal_Places_from_Account_Master + ''' = dbo.DYN_FUNC_Decimal_Places_QTYS([''Account Master''].[DECPLACS]), ' +  '[''Year-to-Date Transaction Open''].[DENXRATE] as ''' + @Denomination_Exchange_Rate + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[DSCRIPTN]) as ''' + @Description + ''', ' +  '[''Year-to-Date Transaction Open''].[DOCDATE] as ''' + @Document_Date + ''', ' +  '''' + @Document_Status + ''' = dbo.DYN_FUNC_Document_Status_GL_Trx(2), ' +  'NULL  as ''' + @Error_State + ''', ' +  '[''Year-to-Date Transaction Open''].[EXCHDATE] as ''' + @Exchange_Date + ''', ' +  '[''Year-to-Date Transaction Open''].[XCHGRATE] as ''' + @Exchange_Rate + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[EXGTBLID]) as ''' + @Exchange_Table_ID + ''', ' +  'NULL  as ''' + @Fixed_Or_Variable + ''', ' +  '''' + @Fixed_Or_Variable_from_Account_Master + ''' = dbo.DYN_FUNC_Fixed_Or_Variable([''Account Master''].[FXDORVAR]), ' +  '[''Account Master''].[HSTRCLRT] as ''' + @Historical_Rate + ''', ' +  '''' + @History_TRX + ''' = dbo.DYN_FUNC_Boolean_All(0), ' +  'NULL  as ''' + @History_Year + ''', ' +  'NULL  as ''' + @ICDists + ''', ' +  '''' + @IC_TRX + ''' = dbo.DYN_FUNC_Boolean_All([''Year-to-Date Transaction Open''].[ICTRX]), ' +  '[''Account Master''].[INFLAEQU] as ''' + @Inflation_Equity_Account_Index + ''', ' +  '[''Account Master''].[INFLAREV] as ''' + @Inflation_Revenue_Account_Index + ''', ' +  'NULL  as ''' + @Intercompany_ID + ''', ' +  '[''Year-to-Date Transaction Open''].[LSTDTEDT] as ''' + @Last_Date_Edited + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[LASTUSER]) as ''' + @Last_User + ''', ' +  'NULL  as ''' + @Line_Status + ''', ' +  '''' + @MC_Transaction_State + ''' = dbo.DYN_FUNC_MC_Transaction_State([''Year-to-Date Transaction Open''].[MCTRXSTT]), ' +  'rtrim([''Account Master''].[MNACSGMT]) as ''' + @Main_Account_Segment + ''', ' +  '[''Account Master''].[MODIFDT] as ''' + @Modified_Date + ''', ' +  '[''Year-to-Date Transaction Open''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  '[''Account Master''].[NOTEINDX] as ''' + @Note_Index_from_Account_Master + ''', ' +  '''' + @Open_Year + ''' = dbo.DYN_FUNC_Open_Year([''Year-to-Date Transaction Open''].[OPENYEAR]), ' +  '[''Year-to-Date Transaction Open''].[Original_JE] as ''' + @Original_JE + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[ORCOMID]) as ''' + @Originating_Company_ID + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[ORCTRNUM]) as ''' + @Originating_Control_Number + ''', ' +  '[''Year-to-Date Transaction Open''].[ORCRDAMT] as ''' + @Originating_Credit_Amount + ''', ' +  '''' + @Originating_DTA_Series + ''' = dbo.DYN_FUNC_Originating_DTA_Series([''Year-to-Date Transaction Open''].[OrigDTASeries]), ' +  '[''Year-to-Date Transaction Open''].[ORDBTAMT] as ''' + @Originating_Debit_Amount + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[ORDOCNUM]) as ''' + @Originating_Document_Number + ''', ' +  '[''Year-to-Date Transaction Open''].[ORIGINJE] as ''' + @Originating_Journal_Entry + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[ORMSTRID]) as ''' + @Originating_Master_ID + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[ORMSTRNM]) as ''' + @Originating_Master_Name + ''', ' +  '[''Year-to-Date Transaction Open''].[ORPSTDDT] as ''' + @Originating_Posted_Date + ''', ' +  '[''Year-to-Date Transaction Open''].[OrigSeqNum] as ''' + @Originating_Sequence_Number + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[ORGNTSRC]) as ''' + @Originating_Source + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[ORTRXSRC]) as ''' + @Originating_TRX_Source + ''', ' +  '''' + @Originating_TRX_Type + ''' = dbo.DYN_FUNC_Originating_TRX_Type([''Year-to-Date Transaction Open''].[ORTRXTYP]), ' +  '''' + @Originating_Type + ''' = dbo.DYN_FUNC_Originating_Type([''Year-to-Date Transaction Open''].[ORGNATYP]), ' +  '[''Year-to-Date Transaction Open''].[PERIODID] as ''' + @Period_ID + ''', ' +  '[''Year-to-Date Transaction Open''].[PPSGNMBR] as ''' + @Period_Posting_Number + ''', '   select @sqlstring7 =  '[''Year-to-Date Transaction Open''].[APRVLUSERID] as ''' + @Approval_User + ''', ' +  '[''Year-to-Date Transaction Open''].[APPRVLDT] as ''' + @Approval_Date + ''', ' + '''' + @Polled_Transaction + ''' = dbo.DYN_FUNC_Boolean_All([''Year-to-Date Transaction Open''].[POLLDTRX]), ' + '''' + @Post_Inventory_In + ''' = dbo.DYN_FUNC_Post_Inventory_In([''Account Master''].[PostIvIn]), ' +  '''' + @Post_Payroll_In + ''' = dbo.DYN_FUNC_Post_Payroll_In([''Account Master''].[PostPRIn]), ' +  '''' + @Post_Purchasing_In + ''' = dbo.DYN_FUNC_Post_Purchasing_In([''Account Master''].[PostPurchIn]), ' +  '''' + @Post_Sales_In + ''' = dbo.DYN_FUNC_Post_Sales_In([''Account Master''].[PostSlsIn]), ' +  '[''Year-to-Date Transaction Open''].[PSTGNMBR] as ''' + @Posting_Number + ''', ' +  '''' + @Posting_Type + ''' = dbo.DYN_FUNC_Posting_Type([''Account Master''].[PSTNGTYP]), ' +  '''' + @Posting_Type_from_Account_Master + ''' = dbo.DYN_FUNC_Posting_Type([''Account Master''].[PSTNGTYP]), ' +  'NULL  as ''' + @Printing_Status + ''', ' + '[''Year-to-Date Transaction Open''].[QKOFSET] as ''' + @Quick_Offset + ''', ' +  '''' + @Rate_Calculation_Method + ''' = dbo.DYN_FUNC_Rate_Calculation_Method([''Year-to-Date Transaction Open''].[RTCLCMTD]), ' +  'rtrim([''Year-to-Date Transaction Open''].[RATETPID]) as ''' + @Rate_Type_ID + ''', ' +  'NULL  as ''' + @Recurring_TRX + ''', ' +  '[''Year-to-Date Transaction Open''].[RCTRXSEQ] as ''' + @Recurring_TRX_Sequence + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[REFRENCE]) as ''' + @Reference + ''', ' +  'NULL  as ''' + @Reversing_Closed_Year + ''', ' +  'NULL  as ''' + @Reversing_Date + ''', ' +  'NULL  as ''' + @Reversing_History_TRX + ''', ' +  'NULL  as ''' + @Reversing_Period_ID + ''', ' +  'NULL  as ''' + @Reversing_TRX_Source + ''', ' +  'NULL  as ''' + @Reversing_Year + ''', '  select @tNumberSegments = count(SGMTNUMB) from SY00300  select @tSegment = 1  while @tSegment <= @tNumberSegments  begin  select @sqlstring7 = @sqlstring7 + '[''Account Master''].[ACTNUMBR_' + RTRIM(CAST(@tSegment as char(2))) + '] as ''Segment' + RTRIM(CAST(@tSegment as char(2))) +''', '  select @tSegment = @tSegment + 1  end  select @sqlstring7 = @sqlstring7 +  '[''Year-to-Date Transaction Open''].[SEQNUMBR] as ''' + @Sequence_Number + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[SOURCDOC]) as ''' + @Source_Document + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[TRXSORCE]) as ''' + @TRX_Source + ''', ' +  'NULL  as ''' + @Tax_Date + ''', ' +  '[''Year-to-Date Transaction Open''].[TIME1] as ''' + @Time + ''', ' +  'NULL  as ''' + @Transaction_Type + ''', ' +  '''' + @Typical_Balance + ''' = dbo.DYN_FUNC_Typical_Balance([''Account Master''].[TPCLBLNC]), ' +  'rtrim([''Account Master''].[USERDEF1]) as ''' + @User_Defined_1 + ''', '   select @sqlstring8 =  'rtrim([''Account Master''].[USERDEF2]) as ''' + @User_Defined_2 + ''', ' +  'rtrim([''Year-to-Date Transaction Open''].[USWHPSTD]) as ''' + @User_Who_Posted + ''', ' +  '''' + @Voided + ''' = dbo.DYN_FUNC_Boolean_All([''Year-to-Date Transaction Open''].[VOIDED]), ' + '''' + CAST(@tNumberSegments as varchar(3)) + ''' as ''' + @Segments + ''', ' + 'NULL  as ''' + @Workflow_Approval_Status + ''', ' +  'NULL  as ''' + @Workflow_Priority + ''', ' +  '''' + @Ledger_Name + ''' = dbo.DYN_FUNC_GL_Ledger_Name([''Year-to-Date Transaction Open''].[Ledger_ID]), ' +  '''' + @Ledger_Description + ''' = dbo.DYN_FUNC_GL_Ledger_Description([''Year-to-Date Transaction Open''].[Ledger_ID]), '+ '''' + @Account_Index_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Year-to-Date Transaction Open''].[ACTINDX] ), '+ '''' + @Journal_Entry_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppJournalInquiry(1,[''Year-to-Date Transaction Open''].[JRNENTRY],[''Year-to-Date Transaction Open''].[RCTRXSEQ],[''Year-to-Date Transaction Open''].[OPENYEAR],[''Year-to-Date Transaction Open''].[TRXDATE] ) '  select @sqlstring9 =   'from [GL20000] as [''Year-to-Date Transaction Open''] with (NOLOCK) '   + 'left outer join [GL00100] as [''Account Master''] with (NOLOCK) on '   + '[''Year-to-Date Transaction Open''].[ACTINDX] = [''Account Master''].[ACTINDX] '   + 'left outer join [DYNAMICS].[dbo].[MC40200] as [''Currency Setup''] with (NOLOCK) on ' +   + '[''Year-to-Date Transaction Open''].[CURRNIDX] = [''Currency Setup''].[CURRNIDX] '   select @sqlstring10 =   'union all ' +  'select ' +   '[''Account Transaction History''].[JRNENTRY] as ''' + @Journal_Entry + ''', ' + '''' + @Series + ''' = dbo.DYN_FUNC_Series_GL_Trx([''Account Transaction History''].[SERIES]), ' + '[''Account Transaction History''].[TRXDATE] as ''' + @TRX_Date + ''', ' + '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Account Master''].[ACTINDX]) as ''' + @Account_Number + ''', ' + 'rtrim([''Account Master''].[ACTDESCR]) as ''' + @Account_Description + ''', ' + '[''Account Transaction History''].[DEBITAMT] as ''' + @Debit_Amount + ''', ' + '[''Account Transaction History''].[CRDTAMNT] as ''' + @Credit_Amount + ''', '   select @sqlstring11 =   '''' + @Account_Category_Number + ''' = dbo.DYN_FUNC_Account_Category_Number([''Account Master''].[ACCATNUM]), ' +  'rtrim([''Account Master''].[ACTDESCR]) as ''' + @Account_Description_from_Account_Master + ''', ' +  '[''Account Transaction History''].[ACTINDX] as ''' + @Account_Index + ''', ' +  '''' + @Account_Type + ''' = dbo.DYN_FUNC_Account_Type([''Account Master''].[ACCTTYPE]), ' +  '''' + @Account_Type_from_Account_Master + ''' = dbo.DYN_FUNC_Account_Type([''Account Master''].[ACCTTYPE]), ' +  '''' + @Active + ''' = dbo.DYN_FUNC_Boolean_All([''Account Master''].[ACTIVE]), ' +  '''' + @Adjust_for_Inflation + ''' = dbo.DYN_FUNC_Boolean_All([''Account Master''].[ADJINFL]), ' +  'NULL  as ''' + @Back_Out_JE + ''', ' +  'NULL  as ''' + @Balance_For_Calculation + ''', ' +  '''' + @Balance_For_Calculation_from_Account_Master + ''' = dbo.DYN_FUNC_Balance_For_Calculation([''Account Master''].[BALFRCLC]), ' +  'NULL  as ''' + @Batch_Number + ''', ' +  'NULL  as ''' + @Batch_Source + ''', ' +  'NULL  as ''' + @Closed_Year + ''', ' +  '''' + @Conversion_Method + ''' = dbo.DYN_FUNC_Conversion_Method([''Account Master''].[CNVRMTHD]), ' +  '[''Account Transaction History''].[Correcting_JE] as ''' + @Correcting_JE + ''', ' +  'rtrim([''Account Transaction History''].[CorrespondingUnit]) as ''' + @CorrespondingUnit + ''', ' +  '[''Account Master''].[CREATDDT] as ''' + @Created_Date + ''', ' +  'rtrim([''Currency Setup''].[CURNCYID]) as ''' + @Currency_ID + ''', ' +  '[''Account Transaction History''].[CURRNIDX] as ''' + @Currency_Index + ''', ' +  'NULL  as ''' + @DTA_Control_Number + ''', ' +  '[''Account Transaction History''].[DTA_GL_Status] as ''' + @DTA_GL_Status + ''', ' +  '[''Account Transaction History''].[DTA_Index] as ''' + @DTA_Index + ''', ' +  'NULL  as ''' + @DTA_TRX_Type + ''', ' +  'NULL  as ''' + @Decimal_Places + ''', ' +  '''' + @Decimal_Places_from_Account_Master + ''' = dbo.DYN_FUNC_Decimal_Places_QTYS([''Account Master''].[DECPLACS]), ' +  '[''Account Transaction History''].[DENXRATE] as ''' + @Denomination_Exchange_Rate + ''', ' +  'rtrim([''Account Transaction History''].[DSCRIPTN]) as ''' + @Description + ''', ' +  '[''Account Transaction History''].[DOCDATE] as ''' + @Document_Date + ''', ' +  '''' + @Document_Status + ''' = dbo.DYN_FUNC_Document_Status_GL_Trx(3), ' +  'NULL  as ''' + @Error_State + ''', ' +  '[''Account Transaction History''].[EXCHDATE] as ''' + @Exchange_Date + ''', ' +  '[''Account Transaction History''].[XCHGRATE] as ''' + @Exchange_Rate + ''', ' +  'rtrim([''Account Transaction History''].[EXGTBLID]) as ''' + @Exchange_Table_ID + ''', ' +  'NULL  as ''' + @Fixed_Or_Variable + ''', ' +  '''' + @Fixed_Or_Variable_from_Account_Master + ''' = dbo.DYN_FUNC_Fixed_Or_Variable([''Account Master''].[FXDORVAR]), ' +  '[''Account Master''].[HSTRCLRT] as ''' + @Historical_Rate + ''', ' +  '''' + @History_TRX + ''' = dbo.DYN_FUNC_Boolean_All(1), ' +  '''' + @History_Year + ''' = [''Account Transaction History''].[HSTYEAR], ' +  'NULL  as ''' + @ICDists + ''', ' +  '''' + @IC_TRX + ''' = dbo.DYN_FUNC_Boolean_All([''Account Transaction History''].[ICTRX]), ' +  '[''Account Master''].[INFLAEQU] as ''' + @Inflation_Equity_Account_Index + ''', ' +  '[''Account Master''].[INFLAREV] as ''' + @Inflation_Revenue_Account_Index + ''', ' +  'NULL  as ''' + @Intercompany_ID + ''', ' +  '[''Account Transaction History''].[LSTDTEDT] as ''' + @Last_Date_Edited + ''', ' +  'rtrim([''Account Transaction History''].[LASTUSER]) as ''' + @Last_User + ''', ' +  'NULL  as ''' + @Line_Status + ''', ' +  '''' + @MC_Transaction_State + ''' = dbo.DYN_FUNC_MC_Transaction_State([''Account Transaction History''].[MCTRXSTT]), ' +  'rtrim([''Account Master''].[MNACSGMT]) as ''' + @Main_Account_Segment + ''', ' +  '[''Account Master''].[MODIFDT] as ''' + @Modified_Date + ''', ' +  '[''Account Transaction History''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  '[''Account Master''].[NOTEINDX] as ''' + @Note_Index_from_Account_Master + ''', ' +  'NULL  as ''' + @Open_Year + ''', ' +  '[''Account Transaction History''].[Original_JE] as ''' + @Original_JE + ''', ' +  'rtrim([''Account Transaction History''].[ORCOMID]) as ''' + @Originating_Company_ID + ''', ' +  'rtrim([''Account Transaction History''].[ORCTRNUM]) as ''' + @Originating_Control_Number + ''', ' +  '[''Account Transaction History''].[ORCRDAMT] as ''' + @Originating_Credit_Amount + ''', ' +  '''' + @Originating_DTA_Series + ''' = dbo.DYN_FUNC_Originating_DTA_Series([''Account Transaction History''].[OrigDTASeries]), ' +  '[''Account Transaction History''].[ORDBTAMT] as ''' + @Originating_Debit_Amount + ''', ' +  'rtrim([''Account Transaction History''].[ORDOCNUM]) as ''' + @Originating_Document_Number + ''', ' +  '[''Account Transaction History''].[ORIGINJE] as ''' + @Originating_Journal_Entry + ''', ' +  'rtrim([''Account Transaction History''].[ORMSTRID]) as ''' + @Originating_Master_ID + ''', ' +  'rtrim([''Account Transaction History''].[ORMSTRNM]) as ''' + @Originating_Master_Name + ''', ' +  '[''Account Transaction History''].[ORPSTDDT] as ''' + @Originating_Posted_Date + ''', ' +  '[''Account Transaction History''].[OrigSeqNum] as ''' + @Originating_Sequence_Number + ''', ' +  'NULL  as ''' + @Originating_Source + ''', ' +  'rtrim([''Account Transaction History''].[ORTRXSRC]) as ''' + @Originating_TRX_Source + ''', ' +  '''' + @Originating_TRX_Type + ''' = dbo.DYN_FUNC_Originating_TRX_Type([''Account Transaction History''].[ORTRXTYP]), ' +  '''' + @Originating_Type + ''' = dbo.DYN_FUNC_Originating_Type([''Account Transaction History''].[ORGNATYP]), ' +  '[''Account Transaction History''].[PERIODID] as ''' + @Period_ID + ''', ' +  '[''Account Transaction History''].[PPSGNMBR] as ''' + @Period_Posting_Number + ''', '   select @sqlstring12 =  '[''Account Transaction History''].[APRVLUSERID] as ''' + @Approval_User + ''', ' +  '[''Account Transaction History''].[APPRVLDT] as ''' + @Approval_Date + ''', ' + '''' + @Polled_Transaction + ''' = dbo.DYN_FUNC_Boolean_All([''Account Transaction History''].[POLLDTRX]), ' +  '''' + @Post_Inventory_In + ''' = dbo.DYN_FUNC_Post_Inventory_In([''Account Master''].[PostIvIn]), ' +  '''' + @Post_Payroll_In + ''' = dbo.DYN_FUNC_Post_Payroll_In([''Account Master''].[PostPRIn]), ' + '''' + @Post_Purchasing_In + ''' = dbo.DYN_FUNC_Post_Purchasing_In([''Account Master''].[PostPurchIn]), ' +  '''' + @Post_Sales_In + ''' = dbo.DYN_FUNC_Post_Sales_In([''Account Master''].[PostSlsIn]), ' +  '[''Account Transaction History''].[PSTGNMBR] as ''' + @Posting_Number + ''', ' +  '''' + @Posting_Type + ''' = dbo.DYN_FUNC_Posting_Type([''Account Master''].[PSTNGTYP]), ' +  '''' + @Posting_Type_from_Account_Master + ''' = dbo.DYN_FUNC_Posting_Type([''Account Master''].[PSTNGTYP]), ' +  'NULL  as ''' + @Printing_Status + ''', ' +  '[''Account Transaction History''].[QKOFSET] as ''' + @Quick_Offset + ''', ' +  '''' + @Rate_Calculation_Method + ''' = dbo.DYN_FUNC_Rate_Calculation_Method([''Account Transaction History''].[RTCLCMTD]), ' +  'rtrim([''Account Transaction History''].[RATETPID]) as ''' + @Rate_Type_ID + ''', ' +  'NULL  as ''' + @Recurring_TRX + ''', ' +  '[''Account Transaction History''].[RCTRXSEQ] as ''' + @Recurring_TRX_Sequence + ''', ' +  'rtrim([''Account Transaction History''].[REFRENCE]) as ''' + @Reference + ''', ' +  'NULL  as ''' + @Reversing_Closed_Year + ''', ' +  'NULL  as ''' + @Reversing_Date + ''', ' +  'NULL  as ''' + @Reversing_History_TRX + ''', ' +  'NULL  as ''' + @Reversing_Period_ID + ''', ' +  'NULL  as ''' + @Reversing_TRX_Source + ''', ' +  'NULL  as ''' + @Reversing_Year + ''', '  select @tNumberSegments = count(SGMTNUMB) from SY00300  select @tSegment = 1  while @tSegment <= @tNumberSegments  begin  select @sqlstring12 = @sqlstring12 + '[''Account Master''].[ACTNUMBR_' + RTRIM(CAST(@tSegment as char(2))) + '] as ''Segment' + RTRIM(CAST(@tSegment as char(2))) +''', '  select @tSegment = @tSegment + 1  end  select @sqlstring12 = @sqlstring12 +  '[''Account Transaction History''].[SEQNUMBR] as ''' + @Sequence_Number + ''', ' +  'rtrim([''Account Transaction History''].[SOURCDOC]) as ''' + @Source_Document + ''', ' +  'rtrim([''Account Transaction History''].[TRXSORCE]) as ''' + @TRX_Source + ''', ' +  'NULL  as ''' + @Tax_Date + ''', ' +  '[''Account Transaction History''].[TIME1] as ''' + @Time + ''', ' +  'NULL  as ''' + @Transaction_Type + ''', '   select @sqlstring13 = '''' + CAST(@tNumberSegments as varchar(3)) + ''' as ''' + @Segments + ''', ' + '''' + @Typical_Balance + ''' = dbo.DYN_FUNC_Typical_Balance([''Account Master''].[TPCLBLNC]), ' +  'rtrim([''Account Master''].[USERDEF1]) as ''' + @User_Defined_1 + ''', ' +  'rtrim([''Account Master''].[USERDEF2]) as ''' + @User_Defined_2 + ''', ' +  'rtrim([''Account Transaction History''].[USWHPSTD]) as ''' + @User_Who_Posted + ''', ' +  '''' + @Voided + ''' = dbo.DYN_FUNC_Boolean_All([''Account Transaction History''].[VOIDED]), ' + 'NULL  as ''' + @Workflow_Approval_Status + ''', ' +  'NULL  as ''' + @Workflow_Priority + ''', ' +  '''' + @Ledger_Name + ''' = dbo.DYN_FUNC_GL_Ledger_Name([''Account Transaction History''].[Ledger_ID]), ' +  '''' + @Ledger_Description + ''' = dbo.DYN_FUNC_GL_Ledger_Description([''Account Transaction History''].[Ledger_ID]), '+ '''' + @Account_Index_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Account Transaction History''].[ACTINDX] ), '+ '''' + @Journal_Entry_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppJournalInquiry(1,[''Account Transaction History''].[JRNENTRY],[''Account Transaction History''].[RCTRXSEQ],[''Account Transaction History''].[HSTYEAR],[''Account Transaction History''].[TRXDATE]  ) '  select @sqljoinstring =   'from [GL30000] as [''Account Transaction History''] with (NOLOCK) '   + 'left outer join [GL00100] as [''Account Master''] with (NOLOCK) on '   + '[''Account Transaction History''].[ACTINDX] = [''Account Master''].[ACTINDX] '   + 'left outer join [DYNAMICS].[dbo].[MC40200] as [''Currency Setup''] with (NOLOCK) on ' +   + '[''Account Transaction History''].[CURRNIDX] = [''Currency Setup''].[CURRNIDX] '   select @sqlaccessstring = ''  if CONVERT(char(20), SERVERPROPERTY('productversion')) not like '8.00.%'  select @sqlaccessstring = 'GRANT ALTER ON [dbo].[AccountTransactions] TO [DYNGRP]'   select @sqlaccessstring = @sqlaccessstring +  'GRANT SELECT ON [dbo].[AccountTransactions] TO [rpt_warehouse manager]' + 'GRANT SELECT ON [dbo].[AccountTransactions] TO [rpt_materials manager]' + 'GRANT SELECT ON [dbo].[AccountTransactions] TO [rpt_operations manager]' + 'GRANT SELECT ON [dbo].[AccountTransactions] TO [rpt_production manager]' + 'GRANT SELECT ON [dbo].[AccountTransactions] TO [rpt_accounting manager]' + 'GRANT SELECT ON [dbo].[AccountTransactions] TO [rpt_bookkeeper]' + 'GRANT SELECT ON [dbo].[AccountTransactions] TO [rpt_certified accountant]' + 'GRANT SELECT ON [dbo].[AccountTransactions] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[AccountTransactions] TO [rpt_order processor]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqlstring11+' '+@sqlstring12+' '+@sqlstring13+' '+@sqljoinstring)exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_Dynamics_AccountTransactions] TO [DYNGRP]
GO
