SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SOP00200N_1] (@BS int, @PROSPID char(15), @PROSPID_RS char(15), @PROSPID_RE char(15)) AS  set nocount on IF @PROSPID_RS IS NULL BEGIN SELECT TOP 25  PROSPID, NOTEINDX, CUSTNAME, CNTCPRSN, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIP, COUNTRY, CUSTCLAS, PHONE1, PHONE2, PHONE3, PRCLEVEL, FAX, SHIPMTHD, TAXSCHID, USERDEF1, USERDEF2, USER2ENT, CREATDDT, MODIFDT, DEX_ROW_ID FROM .SOP00200 WHERE ( PROSPID > @PROSPID ) ORDER BY PROSPID ASC END ELSE IF @PROSPID_RS = @PROSPID_RE BEGIN SELECT TOP 25  PROSPID, NOTEINDX, CUSTNAME, CNTCPRSN, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIP, COUNTRY, CUSTCLAS, PHONE1, PHONE2, PHONE3, PRCLEVEL, FAX, SHIPMTHD, TAXSCHID, USERDEF1, USERDEF2, USER2ENT, CREATDDT, MODIFDT, DEX_ROW_ID FROM .SOP00200 WHERE PROSPID = @PROSPID_RS AND ( PROSPID > @PROSPID ) ORDER BY PROSPID ASC END ELSE BEGIN SELECT TOP 25  PROSPID, NOTEINDX, CUSTNAME, CNTCPRSN, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIP, COUNTRY, CUSTCLAS, PHONE1, PHONE2, PHONE3, PRCLEVEL, FAX, SHIPMTHD, TAXSCHID, USERDEF1, USERDEF2, USER2ENT, CREATDDT, MODIFDT, DEX_ROW_ID FROM .SOP00200 WHERE PROSPID BETWEEN @PROSPID_RS AND @PROSPID_RE AND ( PROSPID > @PROSPID ) ORDER BY PROSPID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SOP00200N_1] TO [DYNGRP]
GO
