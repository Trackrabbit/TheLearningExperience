SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[BindDynamicsDefaults] @I_sAction smallint as  declare @vcObject varchar(255), @iCount int  create table #defaults ( vcObject  varchar(255) not null)  if @I_sAction = 0 or @I_sAction = 1  begin insert into #defaults ( vcObject) select object_name(c.id) + '.' + c.name  from  dbo.syscolumns c, dbo.sysobjects  o where  c.id = o.id and c.type = 61 and o.type = 'U'  select @iCount = count(vcObject)  from #defaults  set rowcount 1  while @iCount > 0  begin select @vcObject = vcObject from #defaults  exec sp_bindefault GPS_DATE, @vcObject   delete #defaults  select @iCount = @iCount - 1  end  set rowcount 0  select @iCount = count(vcObject)  from #defaults  if @iCount = 0 select 'Success: DEF_DATE default was bound to all tables' else select 'Error: DEF_DATE default was not bound to all tables'  if @I_sAction = 1 begin drop table #defaults return end  end  if @I_sAction = 0 or @I_sAction = 2 begin  insert into #defaults ( vcObject) select object_name(c.id) + '.' + c.name  from  dbo.syscolumns c, dbo.sysobjects  o where  c.id = o.id and c.type = 47 and o.type = 'U'  select @iCount = count(vcObject)  from #defaults  set rowcount 1  while @iCount > 0  begin select @vcObject = vcObject from #defaults  exec sp_bindefault GPS_CHAR, @vcObject   delete #defaults  select @iCount = @iCount - 1  end  set rowcount 0  select @iCount = count(vcObject)  from #defaults  if @iCount = 0 select 'Success: DEF_CHAR default was bound to all tables' else select 'Error: DEF_CHAR default was not bound to all tables'  if @I_sAction = 2 begin drop table #defaults return end  end  if @I_sAction = 0 or @I_sAction = 3 begin insert into #defaults ( vcObject) select object_name(c.id) + '.' + c.name  from  dbo.syscolumns c, dbo.sysobjects  o where  c.id = o.id and o.type = 'U' and (c.type = 45   or c.type = 48   or c.type = 52   or  c.type = 56)    select @iCount = count(vcObject)  from #defaults  set rowcount 1  while @iCount > 0  begin select @vcObject = vcObject from #defaults  exec sp_bindefault GPS_INT, @vcObject   delete #defaults  select @iCount = @iCount - 1  end  set rowcount 0  select @iCount = count(vcObject)  from #defaults  if @iCount = 0 select 'Success: DEF_INT default was bound to all tables' else select 'Error: DEF_INT default was not bound to all tables'  if @I_sAction = 3 begin drop table #defaults return end  end  if @I_sAction = 0 or @I_sAction = 4 begin insert into #defaults ( vcObject) select object_name(c.id) + '.' + c.name  from  dbo.syscolumns c, dbo.sysobjects  o where  c.id = o.id and (c.type = 60 or c.type = 63) and o.type = 'U'  select @iCount = count(vcObject)  from #defaults  set rowcount 1  while @iCount > 0  begin select @vcObject = vcObject from #defaults  exec sp_bindefault GPS_MONEY, @vcObject   delete #defaults  select @iCount = @iCount - 1  end  set rowcount 0  select @iCount = count(vcObject)  from #defaults  if @iCount = 0 select 'Success: DEF_MONEY default was bound to all tables' else select 'Error: DEF_MONEY default was not bound to all tables'  if @I_sAction = 4 begin drop table #defaults return end  end  drop table #defaults    
GO
GRANT EXECUTE ON  [dbo].[BindDynamicsDefaults] TO [DYNGRP]
GO
