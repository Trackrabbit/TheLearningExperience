SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[SVC_TS_Office_Calls]  (@OFFICEID varchar(11)) AS select distinct  SVC00200.CALLNBR, CONVERT(char(10),SVC00200.ETADTE,101) + ' ' + CONVERT(char(5),SVC00200.ETATME,108) 'ETA', SVC00200.SVCDESCR, RM00101.CUSTNAME, SVC00200.CNTCPRSN 'CONTACT',  SVC00200.ADRSCODE,  IsNull(IV00101.ITEMDESC,'') 'ITEMDESC', IsNull(SVC00300.SERLNMBR,'') 'SERLNMBR', IsNull(SVC00907.DSCRIPTN,'Not Defined') 'PROBLEM' , SVC00200.SRVSTAT,  SVC00200.SRVTYPE, SVC00200.priorityLevel,  SVC00200.ETADTE, SVC00200.ENTDTE + ' ' + CONVERT(char(5),SVC00200.ENTTME,108) 'ENTERED',  SVC00200.Response_Date+ ' ' + CONVERT(char(5),SVC00200.Response_Time,108) 'RESPONSE' ,  SVC00200.ETTR,  CONVERT(numeric(19,2),DATEDIFF(ss,GETDATE(),  case   when (CONVERT(char(10),SVC00200.Response_Date,101)  = '01/01/1900')  THEN GETDATE()   ELSE SVC00200.Response_Date + ' ' + CONVERT(char(5),SVC00200.Response_Time,108)   end))/  IsNull(NullIf(CONVERT(numeric(19,2),DATEDIFF(ss,(SVC00200.ENTDTE + ' ' + CONVERT(char(5),SVC00200.ENTTME,108)),   case   when (CONVERT(char(10),SVC00200.Response_Date,101) = '01/01/1900')   THEN GETDATE()   ELSE SVC00200.Response_Date + ' ' + CONVERT(char(5),SVC00200.Response_Time,108)   end)),0),1)  'RESPONSETYPE',  SVC00200.CONTNBR from SVC00200 INNER JOIN   RM00101 ON (SVC00200.CUSTNMBR = RM00101.CUSTNMBR) LEFT OUTER JOIN  SVC00201 ON (SVC00200.SRVRECTYPE = SVC00201.SRVRECTYPE and SVC00200.CALLNBR = SVC00201.CALLNBR) LEFT OUTER JOIN  SVC00300 ON (SVC00201.EQUIPID = SVC00300.EQUIPID) LEFT OUTER JOIN  IV00101 ON (SVC00201.ITEMNMBR = IV00101.ITEMNMBR) LEFT OUTER JOIN  SVC00907 ON (SVC00201.PROBCDE = SVC00907.PROBCDE) LEFT OUTER JOIN  SVC00100 ON (SVC00200.TECHID = SVC00100.TECHID) where SVC00200.SRVRECTYPE = 2 and  SVC00200.COMPDTE = '01/01/1900' and  SVC00200.OFFID = @OFFICEID and  SVC00201.LNITMSEQ = 1 order by   SVC00200.ETADTE,  SVC00200.CALLNBR   
GO
GRANT EXECUTE ON  [dbo].[SVC_TS_Office_Calls] TO [DYNGRP]
GO
