SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[aagMLDropTables]  @iDebug tinyint = 0 as  set nocount on set dateformat ymd  if @iDebug = 1  begin  print ''  print '*****************************'  print '** aagMLDropTables started **'  print '*****************************'  print '' end  if exists(select name from tempdb..sysobjects where name = '##Options'    and type = 'U') drop table ##Options if exists(select name from tempdb..sysobjects where name = '##Lvl'        and type = 'U') drop table ##Lvl if exists(select name from tempdb..sysobjects where name = '##Col'        and type = 'U') drop table ##Col if exists(select name from tempdb..sysobjects where name = '##ExpCols'    and type = 'U') drop table ##ExpCols if exists(select name from tempdb..sysobjects where name = '##RowImport'  and type = 'U') drop table ##RowImport if exists(select name from tempdb..sysobjects where name = '##CellImport' and type = 'U') drop table ##CellImport if exists(select name from tempdb..sysobjects where name = '##Rows'       and type = 'U') drop table ##Rows if exists(select name from tempdb..sysobjects where name = '##PreCalc'    and type = 'U') drop table ##PreCalc if @iDebug = 3 begin  if exists(select name from tempdb..sysobjects where name = '##BudCodes'    and type = 'U') drop table ##BudCodes  if exists(select name from tempdb..sysobjects where name = '##BudParam'    and type = 'U') drop table ##BudParam  if exists(select name from tempdb..sysobjects where name = '##RowCols'    and type = 'U') drop table ##RowCols  if exists(select name from tempdb..sysobjects where name = '##UDF'    and type = 'U') drop table ##UDF  if exists(select name from tempdb..sysobjects where name = '##Level'    and type = 'U') drop table ##Level end   if @iDebug = 1  begin  print ''  print '******************************'  print '** aagMLDropTables finished **'  print '******************************'  print '' end set nocount off return 0    
GO
GRANT EXECUTE ON  [dbo].[aagMLDropTables] TO [DYNGRP]
GO
