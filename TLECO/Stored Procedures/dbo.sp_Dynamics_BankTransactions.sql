SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_Dynamics_BankTransactions] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @Record_Number varchar(255), @Record_Number_String varchar(255), @Control_Type varchar(255), @Deposited varchar(255), @Modified_User_ID varchar(255), @Modified_Date varchar(255), @Checkbook_ID varchar(255), @Deposit_Number varchar(255), @Receipt_Number varchar(255), @Receipt_Date varchar(255), @Receipt_Amount varchar(255), @Receipt_Type varchar(255), @Card_Name varchar(255), @Currency_ID varchar(255), @Bank_Name varchar(255), @Bank_Branch varchar(255), @GL_Posting_Date varchar(255), @Posted_Date varchar(255), @Posted_User_ID varchar(255), @CMLinkID varchar(255), @Received_From varchar(255), @Description varchar(255), @Voided varchar(255), @Void_Date varchar(255), @Void_GL_Posting_Date varchar(255), @Void_Description varchar(255), @User_Defined_1 varchar(255), @User_Defined_2 varchar(255), @Note_Index varchar(255), @Record_Status varchar(255), @Source_Document varchar(255), @Source_Doc_Number varchar(255), @Source_Doc_Type varchar(255), @Audit_Trail_Code varchar(255), @Originating_Amount varchar(255), @Checkbook_Amount varchar(255), @Rate_Type_ID varchar(255), @Receiving_Rate_Type_ID varchar(255), @Exchange_Table_ID varchar(255), @Exchange_Rate varchar(255), @Receiving_Exchange_Rate varchar(255), @Exchange_Date varchar(255), @Time varchar(255), @Rate_Calculation_Method varchar(255), @Receiving_Rate_Calc_Method varchar(255), @Expiration_Date varchar(255), @Currency_Index varchar(255), @Decimal_Places_Currency varchar(255), @Realized_Gain_Loss_Amount varchar(255), @Cash_Account_Number varchar(255), @Realized_GL_Account_Number varchar(255), @Denomination_Exchange_Rate varchar(255), @MC_Transaction_State varchar(255), @Receiving_Denomination_Exchange_Rate varchar(255), @Receiving_MC_Transaction_State varchar(255), @Document_Status varchar(255), @CM_Trx_Number varchar(255), @CM_Trx_Type varchar(255), @CM_Trx_Type_Int varchar(255), @TRX_Date varchar(255), @TRX_Amount varchar(255), @Paid_ToRcvd_From varchar(255), @Reconciled varchar(255), @Reconcile_Number varchar(255), @Cleared_Amount varchar(255), @Cleared_Date varchar(255), @Deposit_Type varchar(255), @Xfr_Record_Number varchar(255), @Checkbook_Description varchar(255), @CM_User_Defined_1 varchar(255), @Current_Balance varchar(255), @DrillBack_Base_Url varchar(255), @CheckbookID_For_DrillBack varchar(255), @Cash_Account_Number_For_Drillback varchar(255), @Realized_GL_Account_Number_For_Drillback varchar(255)  select @DrillBack_Base_Url = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),0)  select @I_iDictID = 1493 select @I_iMessageNumber = 26700 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Record_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26701 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Record_Number_String output  select @I_iDictID = 1493 select @I_iMessageNumber = 26702 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Control_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 26703 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Deposited output  select @I_iDictID = 1493 select @I_iMessageNumber = 26704 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Modified_User_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 26705 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Modified_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26706 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Checkbook_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 26707 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Deposit_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26708 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receipt_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26709 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receipt_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26710 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receipt_Amount output  select @I_iDictID = 1493 select @I_iMessageNumber = 26711 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receipt_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 26712 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Card_Name output  select @I_iDictID = 1493 select @I_iMessageNumber = 26713 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Currency_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 26714 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Bank_Name output  select @I_iDictID = 1493 select @I_iMessageNumber = 26715 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Bank_Branch output  select @I_iDictID = 1493 select @I_iMessageNumber = 26716 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @GL_Posting_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26717 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Posted_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26718 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Posted_User_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 26719 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @CMLinkID output  select @I_iDictID = 1493 select @I_iMessageNumber = 26720 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Received_From output  select @I_iDictID = 1493 select @I_iMessageNumber = 26721 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Description output  select @I_iDictID = 1493 select @I_iMessageNumber = 26722 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Voided output  select @I_iDictID = 1493 select @I_iMessageNumber = 26723 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Void_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26724 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Void_GL_Posting_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26725 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Void_Description output  select @I_iDictID = 1493 select @I_iMessageNumber = 26726 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_1 output  select @I_iDictID = 1493 select @I_iMessageNumber = 26727 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_2 output  select @I_iDictID = 1493 select @I_iMessageNumber = 26728 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Note_Index output  select @I_iDictID = 1493 select @I_iMessageNumber = 26729 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Record_Status output  select @I_iDictID = 1493 select @I_iMessageNumber = 26730 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Source_Document output  select @I_iDictID = 1493 select @I_iMessageNumber = 26731 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Source_Doc_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26732 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Source_Doc_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 26733 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Audit_Trail_Code output  select @I_iDictID = 1493 select @I_iMessageNumber = 26734 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Amount output  select @I_iDictID = 1493 select @I_iMessageNumber = 26735 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Checkbook_Amount output  select @I_iDictID = 1493 select @I_iMessageNumber = 26736 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Rate_Type_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 26737 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receiving_Rate_Type_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 26738 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Table_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 26739 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Rate output  select @I_iDictID = 1493 select @I_iMessageNumber = 26740 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receiving_Exchange_Rate output  select @I_iDictID = 1493 select @I_iMessageNumber = 26741 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26742 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Time output  select @I_iDictID = 1493 select @I_iMessageNumber = 26743 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Rate_Calculation_Method output  select @I_iDictID = 1493 select @I_iMessageNumber = 26744 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receiving_Rate_Calc_Method output  select @I_iDictID = 1493 select @I_iMessageNumber = 26745 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Expiration_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26746 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Currency_Index output  select @I_iDictID = 1493 select @I_iMessageNumber = 26747 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Decimal_Places_Currency output  select @I_iDictID = 1493 select @I_iMessageNumber = 26748 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Realized_Gain_Loss_Amount output  select @I_iDictID = 1493 select @I_iMessageNumber = 26749 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Cash_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26750 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Realized_GL_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26751 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Denomination_Exchange_Rate output  select @I_iDictID = 1493 select @I_iMessageNumber = 26752 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @MC_Transaction_State output  select @I_iDictID = 1493 select @I_iMessageNumber = 26753 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receiving_Denomination_Exchange_Rate output  select @I_iDictID = 1493 select @I_iMessageNumber = 26754 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receiving_MC_Transaction_State output  select @I_iDictID = 1493 select @I_iMessageNumber = 26755 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Document_Status output  select @I_iDictID = 1493 select @I_iMessageNumber = 26756 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @CM_Trx_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26757 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @CM_Trx_Type output  select @I_iDictID = 0 select @I_iMessageNumber = 22058 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @CM_Trx_Type_Int output  select @I_iDictID = 1493 select @I_iMessageNumber = 26758 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TRX_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26759 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TRX_Amount output  select @I_iDictID = 1493 select @I_iMessageNumber = 26760 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Paid_ToRcvd_From output  select @I_iDictID = 1493 select @I_iMessageNumber = 26761 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reconciled output  select @I_iDictID = 1493 select @I_iMessageNumber = 26762 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reconcile_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26763 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Cleared_Amount output  select @I_iDictID = 1493 select @I_iMessageNumber = 26764 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Cleared_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26765 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Deposit_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 26766 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Xfr_Record_Number output  select @I_iDictID = 0 select @I_iMessageNumber = 22037 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Checkbook_Description output  select @I_iDictID = 0 select @I_iMessageNumber = 22036 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @CM_User_Defined_1 output  select @I_iDictID = 1493 select @I_iMessageNumber = 24201 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Current_Balance output   select @I_iDictID = 1493 select @I_iMessageNumber = 26706 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @CheckbookID_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 26749 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Cash_Account_Number_For_Drillback output   select @I_iDictID = 1493 select @I_iMessageNumber = 26750 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Realized_GL_Account_Number_For_Drillback output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[BankTransactions]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[BankTransactions] '  select @sqldefaultstring =   'CREATE VIEW BankTransactions AS ' +   'select ' +   'rtrim([''CM Transaction''].[CHEKBKID]) as ''' + @Checkbook_ID + ''', ' + '[''CM Transaction''].[GLPOSTDT] as ''' + @GL_Posting_Date + ''', ' + 'rtrim([''CM Transaction''].[DSCRIPTN]) as ''' + @Description + ''', ' + 'rtrim([''CM Transaction''].[SOURCDOC]) as ''' + @Source_Document + ''', ' + '[''CM Transaction''].[Checkbook_Amount] as ''' + @Checkbook_Amount + ''', '   select @sqlstring1 =   'rtrim([''CM Transaction''].[AUDITTRAIL]) as ''' + @Audit_Trail_Code + ''', ' +  'NULL  as ''' + @Bank_Branch + ''', ' +  'NULL  as ''' + @Bank_Name + ''', ' +  'rtrim([''CM Transaction''].[CMLinkID]) as ''' + @CMLinkID + ''', ' +  'rtrim([''CM Transaction''].[CMTrxNum]) as ''' + @CM_Trx_Number + ''', ' +  '''' + @CM_Trx_Type + ''' = dbo.DYN_FUNC_CM_Trx_Type([''CM Transaction''].[CMTrxType]), ' +  '[''CM Transaction''].[CMTrxType] as ''' + @CM_Trx_Type_Int + ''', ' +  'NULL  as ''' + @Card_Name + ''', ' +  'NULL  as ''' + @Cash_Account_Number + ''', ' +  '[''CM Transaction''].[ClrdAmt] as ''' + @Cleared_Amount + ''', ' +  '[''CM Transaction''].[clearedate] as ''' + @Cleared_Date + ''', ' +  'NULL  as ''' + @Control_Type + ''', ' +  'rtrim([''CM Transaction''].[CURNCYID]) as ''' + @Currency_ID + ''', ' +  '[''CM Transaction''].[CURRNIDX] as ''' + @Currency_Index + ''', ' +  '''' + @Decimal_Places_Currency + ''' = dbo.DYN_FUNC_Decimal_Places_Currency([''CM Transaction''].[DECPLCUR]), ' +  '[''CM Transaction''].[DENXRATE] as ''' + @Denomination_Exchange_Rate + ''', ' +  'NULL  as ''' + @Deposit_Number + ''', ' +  '''' + @Deposit_Type + ''' = dbo.DYN_FUNC_Deposit_Type([''CM Transaction''].[DEPTYPE]), ' +  'NULL  as ''' + @Deposited + ''', ' +  '''' + @Document_Status + ''' = dbo.DYN_FUNC_Document_Status_CM_Trx(2), ' +  '[''CM Transaction''].[EXCHDATE] as ''' + @Exchange_Date + ''', ' +  '[''CM Transaction''].[XCHGRATE] as ''' + @Exchange_Rate + ''', ' +  'rtrim([''CM Transaction''].[EXGTBLID]) as ''' + @Exchange_Table_ID + ''', ' +  '[''CM Transaction''].[EXPNDATE] as ''' + @Expiration_Date + ''', ' +  '''' + @MC_Transaction_State + ''' = dbo.DYN_FUNC_MC_Transaction_State([''CM Transaction''].[MCTRXSTT]), ' +  '[''CM Transaction''].[MODIFDT] as ''' + @Modified_Date + ''', ' +  'rtrim([''CM Transaction''].[MDFUSRID]) as ''' + @Modified_User_ID + ''', ' +  '[''CM Transaction''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  '[''CM Transaction''].[ORIGAMT] as ''' + @Originating_Amount + ''', ' +  'rtrim([''CM Transaction''].[paidtorcvdfrom]) as ''' + @Paid_ToRcvd_From + ''', ' +  '[''CM Transaction''].[POSTEDDT] as ''' + @Posted_Date + ''', ' +  'rtrim([''CM Transaction''].[PTDUSRID]) as ''' + @Posted_User_ID + ''', ' +  '''' + @Rate_Calculation_Method + ''' = dbo.DYN_FUNC_Rate_Calculation_Method([''CM Transaction''].[RTCLCMTD]), ' +  'rtrim([''CM Transaction''].[RATETPID]) as ''' + @Rate_Type_ID + ''', ' +  'NULL  as ''' + @Realized_GL_Account_Number + ''', ' +  'NULL  as ''' + @Realized_Gain_Loss_Amount + ''', ' +  'NULL  as ''' + @Receipt_Amount + ''', ' +  'NULL  as ''' + @Receipt_Date + ''', ' +  'NULL  as ''' + @Receipt_Number + ''', ' +  'NULL  as ''' + @Receipt_Type + ''', ' +  'NULL  as ''' + @Received_From + ''', ' +  'NULL  as ''' + @Receiving_Denomination_Exchange_Rate + ''', ' +  'NULL  as ''' + @Receiving_Exchange_Rate + ''', ' +  'NULL  as ''' + @Receiving_MC_Transaction_State + ''', ' +  'NULL  as ''' + @Receiving_Rate_Calc_Method + ''', ' +  'NULL  as ''' + @Receiving_Rate_Type_ID + ''', ' +  '[''CM Transaction''].[RECONUM] as ''' + @Reconcile_Number + ''', ' +  '''' + @Reconciled + ''' = dbo.DYN_FUNC_Boolean_All([''CM Transaction''].[Recond]), ' +  '[''CM Transaction''].[CMRECNUM] as ''' + @Record_Number + ''', ' +  'rtrim([''CM Transaction''].[sRecNum]) as ''' + @Record_Number_String + ''', ' +  '''' + @Record_Status + ''' = dbo.DYN_FUNC_Record_Status([''CM Transaction''].[RCRDSTTS]), ' +  'rtrim([''CM Transaction''].[SRCDOCNUM]) as ''' + @Source_Doc_Number + ''', ' +  '[''CM Transaction''].[SRCDOCTYP] as ''' + @Source_Doc_Type + ''', ' +  '[''CM Transaction''].[TRXAMNT] as ''' + @TRX_Amount + ''', ' +  '[''CM Transaction''].[TRXDATE] as ''' + @TRX_Date + ''', ' +  '[''CM Transaction''].[TIME1] as ''' + @Time + ''', ' +  'rtrim([''CM Transaction''].[USERDEF1]) as ''' + @User_Defined_1 + ''', ' +  'rtrim([''CM Transaction''].[USERDEF2]) as ''' + @User_Defined_2 + ''', ' +  '[''CM Transaction''].[VOIDDATE] as ''' + @Void_Date + ''', ' +  'rtrim([''CM Transaction''].[VOIDDESC]) as ''' + @Void_Description + ''', ' +  '[''CM Transaction''].[VOIDPDATE] as ''' + @Void_GL_Posting_Date + ''', ' +  '''' + @Voided + ''' = dbo.DYN_FUNC_Boolean_All([''CM Transaction''].[VOIDED]), ' +  '[''CM Transaction''].[Xfr_Record_Number] as ''' + @Xfr_Record_Number + ''', ' + 'rtrim([''CM Checkbook Master''].[DSCRIPTN]) as ''' + @Checkbook_Description + ''', ' +  'rtrim([''CM Checkbook Master''].[CMUSRDF1]) as ''' + @CM_User_Defined_1 + ''', ' +  '[''CM Checkbook Master''].[CURRBLNC] as ''' + @Current_Balance + ''', ' + 'NULL  as ''' + @Cash_Account_Number_For_Drillback + ''', ' +  'NULL  as ''' + @Realized_GL_Account_Number_For_Drillback + ''', ' +  '''' + @CheckbookID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppCheckbookID(1,[''CM Transaction''].[CHEKBKID] ) '  select @sqlstring2 =   'from [CM20200] as [''CM Transaction''] with (NOLOCK) ' + + 'left outer join [CM00100] as [''CM Checkbook Master''] with (NOLOCK) on '  + '[''CM Transaction''].[CHEKBKID] = [''CM Checkbook Master''].[CHEKBKID] '   select @sqlstring3 =  'union all ' + 'select ' +   'rtrim([''CM Receipt''].[CHEKBKID]) as ''' + @Checkbook_ID + ''', ' + '[''CM Receipt''].[GLPOSTDT] as ''' + @GL_Posting_Date + ''', ' + 'rtrim([''CM Receipt''].[DSCRIPTN]) as ''' + @Description + ''', ' + 'rtrim([''CM Receipt''].[SOURCDOC]) as ''' + @Source_Document + ''', ' + '[''CM Receipt''].[Checkbook_Amount] as ''' + @Checkbook_Amount + ''', '   select @sqlstring4 =   'rtrim([''CM Receipt''].[AUDITTRAIL]) as ''' + @Audit_Trail_Code + ''', ' +  'rtrim([''CM Receipt''].[BNKBRNCH]) as ''' + @Bank_Branch + ''', ' +  'rtrim([''CM Receipt''].[BANKNAME]) as ''' + @Bank_Name + ''', ' +  'rtrim([''CM Receipt''].[CMLinkID]) as ''' + @CMLinkID + ''', ' +  'NULL  as ''' + @CM_Trx_Number + ''', ' +  'NULL  as ''' + @CM_Trx_Type + ''', ' +  'NULL  as ''' + @CM_Trx_Type_Int + ''', ' +  'rtrim([''CM Receipt''].[CARDNAME]) as ''' + @Card_Name + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''CM Receipt''].[Cash_Account_Index]) as ''' + @Cash_Account_Number + ''', ' +  'NULL  as ''' + @Cleared_Amount + ''', ' +  'NULL  as ''' + @Cleared_Date + ''', ' +  '''' + @Control_Type + ''' = dbo.DYN_FUNC_Control_Type_CM([''CM Receipt''].[CNTRLTYP]), ' +  'rtrim([''CM Receipt''].[CURNCYID]) as ''' + @Currency_ID + ''', ' +  '[''CM Receipt''].[CURRNIDX] as ''' + @Currency_Index + ''', ' +  '''' + @Decimal_Places_Currency + ''' = dbo.DYN_FUNC_Decimal_Places_Currency([''CM Receipt''].[DECPLCUR]), ' +  '[''CM Receipt''].[DENXRATE] as ''' + @Denomination_Exchange_Rate + ''', ' +  'rtrim([''CM Receipt''].[depositnumber]) as ''' + @Deposit_Number + ''', ' +  'NULL  as ''' + @Deposit_Type + ''', ' +  '''' + @Deposited + ''' = dbo.DYN_FUNC_Boolean_All([''CM Receipt''].[DEPOSITED]), ' +  '''' + @Document_Status + ''' = dbo.DYN_FUNC_Document_Status_CM_Trx(1), ' +  '[''CM Receipt''].[EXCHDATE] as ''' + @Exchange_Date + ''', ' +  '[''CM Receipt''].[XCHGRATE] as ''' + @Exchange_Rate + ''', ' +  'rtrim([''CM Receipt''].[EXGTBLID]) as ''' + @Exchange_Table_ID + ''', ' +  '[''CM Receipt''].[EXPNDATE] as ''' + @Expiration_Date + ''', ' +  '''' + @MC_Transaction_State + ''' = dbo.DYN_FUNC_MC_Transaction_State([''CM Receipt''].[MCTRXSTT]), ' +  '[''CM Receipt''].[MODIFDT] as ''' + @Modified_Date + ''', ' +  'rtrim([''CM Receipt''].[MDFUSRID]) as ''' + @Modified_User_ID + ''', ' +  '[''CM Receipt''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  '[''CM Receipt''].[ORIGAMT] as ''' + @Originating_Amount + ''', ' +  'NULL  as ''' + @Paid_ToRcvd_From + ''', ' +  '[''CM Receipt''].[POSTEDDT] as ''' + @Posted_Date + ''', ' +  'rtrim([''CM Receipt''].[PTDUSRID]) as ''' + @Posted_User_ID + ''', ' +  '''' + @Rate_Calculation_Method + ''' = dbo.DYN_FUNC_Rate_Calculation_Method([''CM Receipt''].[RTCLCMTD]), ' +  'rtrim([''CM Receipt''].[RATETPID]) as ''' + @Rate_Type_ID + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''CM Receipt''].[Realized_GL_Account_Inde]) as ''' + @Realized_GL_Account_Number + ''', ' +  '[''CM Receipt''].[RLGANLOS] as ''' + @Realized_Gain_Loss_Amount + ''', ' +  '[''CM Receipt''].[RCPTAMT] as ''' + @Receipt_Amount + ''', ' +  '[''CM Receipt''].[receiptdate] as ''' + @Receipt_Date + ''', ' +  'rtrim([''CM Receipt''].[RCPTNMBR]) as ''' + @Receipt_Number + ''', ' +  '''' + @Receipt_Type + ''' = dbo.DYN_FUNC_Receipt_Type([''CM Receipt''].[RcpType]), ' +  'rtrim([''CM Receipt''].[RcvdFrom]) as ''' + @Received_From + ''', ' +  '[''CM Receipt''].[Receiving_DenomEXRate] as ''' + @Receiving_Denomination_Exchange_Rate + ''', ' +  '[''CM Receipt''].[Receiving_Exchange_Rate] as ''' + @Receiving_Exchange_Rate + ''', ' +  '''' + @Receiving_MC_Transaction_State + ''' = dbo.DYN_FUNC_Receiving_MC_Transaction_State([''CM Receipt''].[Receiving_MC_Transaction]), ' +  '''' + @Receiving_Rate_Calc_Method + ''' = dbo.DYN_FUNC_Receiving_Rate_Calc_Method([''CM Receipt''].[RCVGRTCLCMTD]), ' +  'rtrim([''CM Receipt''].[RCVGRATETPID]) as ''' + @Receiving_Rate_Type_ID + ''', ' +  'NULL  as ''' + @Reconcile_Number + ''', ' +  'NULL  as ''' + @Reconciled + ''', ' +  '[''CM Receipt''].[CMRECNUM] as ''' + @Record_Number + ''', ' +  'rtrim([''CM Receipt''].[sRecNum]) as ''' + @Record_Number_String + ''', ' +  '''' + @Record_Status + ''' = dbo.DYN_FUNC_Record_Status([''CM Receipt''].[RCRDSTTS]), ' +  'rtrim([''CM Receipt''].[SRCDOCNUM]) as ''' + @Source_Doc_Number + ''', ' +  '[''CM Receipt''].[SRCDOCTYP] as ''' + @Source_Doc_Type + ''', ' +  'NULL  as ''' + @TRX_Amount + ''', ' +  'NULL  as ''' + @TRX_Date + ''', ' +  '[''CM Receipt''].[TIME1] as ''' + @Time + ''', ' +  'rtrim([''CM Receipt''].[USERDEF1]) as ''' + @User_Defined_1 + ''', ' +  'rtrim([''CM Receipt''].[USERDEF2]) as ''' + @User_Defined_2 + ''', ' +  '[''CM Receipt''].[VOIDDATE] as ''' + @Void_Date + ''', ' +  'rtrim([''CM Receipt''].[VOIDDESC]) as ''' + @Void_Description + ''', ' +  '[''CM Receipt''].[VOIDPDATE] as ''' + @Void_GL_Posting_Date + ''', ' +  '''' + @Voided + ''' = dbo.DYN_FUNC_Boolean_All([''CM Receipt''].[VOIDED]), ' +  'NULL  as ''' + @Xfr_Record_Number + ''', '  + 'rtrim([''CM Checkbook Master''].[DSCRIPTN]) as ''' + @Checkbook_Description + ''', ' +  'rtrim([''CM Checkbook Master''].[CMUSRDF1]) as ''' + @CM_User_Defined_1 + ''', ' +  '[''CM Checkbook Master''].[CURRBLNC] as ''' + @Current_Balance + ''', ' + '''' + @Cash_Account_Number_For_Drillback + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''CM Receipt''].[Cash_Account_Index] ), '+ '''' + @Realized_GL_Account_Number_For_Drillback + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''CM Receipt''].[Realized_GL_Account_Inde] ), '+ '''' + @CheckbookID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppCheckbookID(1,[''CM Receipt''].[CHEKBKID] ) '  select @sqljoinstring =   'from [CM20300] as [''CM Receipt''] with (NOLOCK) ' + + 'left outer join [CM00100] as [''CM Checkbook Master''] with (NOLOCK) on '  + '[''CM Receipt''].[CHEKBKID] = [''CM Checkbook Master''].[CHEKBKID] '   select @sqlaccessstring =   'GRANT SELECT ON [dbo].[BankTransactions] TO [rpt_accounting manager]' + 'GRANT SELECT ON [dbo].[BankTransactions] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[BankTransactions] TO [rpt_bookkeeper]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_Dynamics_BankTransactions] TO [DYNGRP]
GO
