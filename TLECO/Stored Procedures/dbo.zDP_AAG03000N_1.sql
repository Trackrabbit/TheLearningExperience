SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_AAG03000N_1] (@BS int, @EMPLOYID char(15), @JOBTITLE char(7), @DEPRTMNT char(7), @UPRACTYP smallint, @PAYROLCD char(7), @aaAliasID int, @EMPLOYID_RS char(15), @JOBTITLE_RS char(7), @DEPRTMNT_RS char(7), @UPRACTYP_RS smallint, @PAYROLCD_RS char(7), @aaAliasID_RS int, @EMPLOYID_RE char(15), @JOBTITLE_RE char(7), @DEPRTMNT_RE char(7), @UPRACTYP_RE smallint, @PAYROLCD_RE char(7), @aaAliasID_RE int) AS  set nocount on IF @EMPLOYID_RS IS NULL BEGIN SELECT TOP 25  EMPLOYID, DEPRTMNT, JOBTITLE, PAYROLCD, UPRACTYP, aaAliasID, aaAssignedPercent, DEX_ROW_ID FROM .AAG03000 WHERE ( EMPLOYID = @EMPLOYID AND JOBTITLE = @JOBTITLE AND DEPRTMNT = @DEPRTMNT AND UPRACTYP = @UPRACTYP AND PAYROLCD = @PAYROLCD AND aaAliasID > @aaAliasID OR EMPLOYID = @EMPLOYID AND JOBTITLE = @JOBTITLE AND DEPRTMNT = @DEPRTMNT AND UPRACTYP = @UPRACTYP AND PAYROLCD > @PAYROLCD OR EMPLOYID = @EMPLOYID AND JOBTITLE = @JOBTITLE AND DEPRTMNT = @DEPRTMNT AND UPRACTYP > @UPRACTYP OR EMPLOYID = @EMPLOYID AND JOBTITLE = @JOBTITLE AND DEPRTMNT > @DEPRTMNT OR EMPLOYID = @EMPLOYID AND JOBTITLE > @JOBTITLE OR EMPLOYID > @EMPLOYID ) ORDER BY EMPLOYID ASC, JOBTITLE ASC, DEPRTMNT ASC, UPRACTYP ASC, PAYROLCD ASC, aaAliasID ASC END ELSE IF @EMPLOYID_RS = @EMPLOYID_RE BEGIN SELECT TOP 25  EMPLOYID, DEPRTMNT, JOBTITLE, PAYROLCD, UPRACTYP, aaAliasID, aaAssignedPercent, DEX_ROW_ID FROM .AAG03000 WHERE EMPLOYID = @EMPLOYID_RS AND JOBTITLE BETWEEN @JOBTITLE_RS AND @JOBTITLE_RE AND DEPRTMNT BETWEEN @DEPRTMNT_RS AND @DEPRTMNT_RE AND UPRACTYP BETWEEN @UPRACTYP_RS AND @UPRACTYP_RE AND PAYROLCD BETWEEN @PAYROLCD_RS AND @PAYROLCD_RE AND aaAliasID BETWEEN @aaAliasID_RS AND @aaAliasID_RE AND ( EMPLOYID = @EMPLOYID AND JOBTITLE = @JOBTITLE AND DEPRTMNT = @DEPRTMNT AND UPRACTYP = @UPRACTYP AND PAYROLCD = @PAYROLCD AND aaAliasID > @aaAliasID OR EMPLOYID = @EMPLOYID AND JOBTITLE = @JOBTITLE AND DEPRTMNT = @DEPRTMNT AND UPRACTYP = @UPRACTYP AND PAYROLCD > @PAYROLCD OR EMPLOYID = @EMPLOYID AND JOBTITLE = @JOBTITLE AND DEPRTMNT = @DEPRTMNT AND UPRACTYP > @UPRACTYP OR EMPLOYID = @EMPLOYID AND JOBTITLE = @JOBTITLE AND DEPRTMNT > @DEPRTMNT OR EMPLOYID = @EMPLOYID AND JOBTITLE > @JOBTITLE OR EMPLOYID > @EMPLOYID ) ORDER BY EMPLOYID ASC, JOBTITLE ASC, DEPRTMNT ASC, UPRACTYP ASC, PAYROLCD ASC, aaAliasID ASC END ELSE BEGIN SELECT TOP 25  EMPLOYID, DEPRTMNT, JOBTITLE, PAYROLCD, UPRACTYP, aaAliasID, aaAssignedPercent, DEX_ROW_ID FROM .AAG03000 WHERE EMPLOYID BETWEEN @EMPLOYID_RS AND @EMPLOYID_RE AND JOBTITLE BETWEEN @JOBTITLE_RS AND @JOBTITLE_RE AND DEPRTMNT BETWEEN @DEPRTMNT_RS AND @DEPRTMNT_RE AND UPRACTYP BETWEEN @UPRACTYP_RS AND @UPRACTYP_RE AND PAYROLCD BETWEEN @PAYROLCD_RS AND @PAYROLCD_RE AND aaAliasID BETWEEN @aaAliasID_RS AND @aaAliasID_RE AND ( EMPLOYID = @EMPLOYID AND JOBTITLE = @JOBTITLE AND DEPRTMNT = @DEPRTMNT AND UPRACTYP = @UPRACTYP AND PAYROLCD = @PAYROLCD AND aaAliasID > @aaAliasID OR EMPLOYID = @EMPLOYID AND JOBTITLE = @JOBTITLE AND DEPRTMNT = @DEPRTMNT AND UPRACTYP = @UPRACTYP AND PAYROLCD > @PAYROLCD OR EMPLOYID = @EMPLOYID AND JOBTITLE = @JOBTITLE AND DEPRTMNT = @DEPRTMNT AND UPRACTYP > @UPRACTYP OR EMPLOYID = @EMPLOYID AND JOBTITLE = @JOBTITLE AND DEPRTMNT > @DEPRTMNT OR EMPLOYID = @EMPLOYID AND JOBTITLE > @JOBTITLE OR EMPLOYID > @EMPLOYID ) ORDER BY EMPLOYID ASC, JOBTITLE ASC, DEPRTMNT ASC, UPRACTYP ASC, PAYROLCD ASC, aaAliasID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_AAG03000N_1] TO [DYNGRP]
GO
