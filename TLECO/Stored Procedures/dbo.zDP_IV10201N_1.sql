SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IV10201N_1] (@BS int, @ITEMNMBR char(31), @TRXLOCTN char(11), @QTYTYPE smallint, @DOCDATE datetime, @RCTSEQNM int, @SRCRCTSEQNM int, @ITEMNMBR_RS char(31), @TRXLOCTN_RS char(11), @QTYTYPE_RS smallint, @DOCDATE_RS datetime, @RCTSEQNM_RS int, @SRCRCTSEQNM_RS int, @ITEMNMBR_RE char(31), @TRXLOCTN_RE char(11), @QTYTYPE_RE smallint, @DOCDATE_RE datetime, @RCTSEQNM_RE int, @SRCRCTSEQNM_RE int) AS  set nocount on IF @ITEMNMBR_RS IS NULL BEGIN SELECT TOP 25  ITEMNMBR, TRXLOCTN, QTYTYPE, DOCDATE, RCTSEQNM, ORIGINDOCTYPE, ORIGINDOCID, LNSEQNBR, CMPNTSEQ, QTYSOLD, UNITCOST, IVIVINDX, IVIVOFIX, SRCRCTSEQNM, TRXREFERENCE, PCHSRCTY, DEX_ROW_ID FROM .IV10201 WHERE ( ITEMNMBR = @ITEMNMBR AND TRXLOCTN = @TRXLOCTN AND QTYTYPE = @QTYTYPE AND DOCDATE = @DOCDATE AND RCTSEQNM = @RCTSEQNM AND SRCRCTSEQNM > @SRCRCTSEQNM OR ITEMNMBR = @ITEMNMBR AND TRXLOCTN = @TRXLOCTN AND QTYTYPE = @QTYTYPE AND DOCDATE = @DOCDATE AND RCTSEQNM > @RCTSEQNM OR ITEMNMBR = @ITEMNMBR AND TRXLOCTN = @TRXLOCTN AND QTYTYPE = @QTYTYPE AND DOCDATE > @DOCDATE OR ITEMNMBR = @ITEMNMBR AND TRXLOCTN = @TRXLOCTN AND QTYTYPE > @QTYTYPE OR ITEMNMBR = @ITEMNMBR AND TRXLOCTN > @TRXLOCTN OR ITEMNMBR > @ITEMNMBR ) ORDER BY ITEMNMBR ASC, TRXLOCTN ASC, QTYTYPE ASC, DOCDATE ASC, RCTSEQNM ASC, SRCRCTSEQNM ASC END ELSE IF @ITEMNMBR_RS = @ITEMNMBR_RE BEGIN SELECT TOP 25  ITEMNMBR, TRXLOCTN, QTYTYPE, DOCDATE, RCTSEQNM, ORIGINDOCTYPE, ORIGINDOCID, LNSEQNBR, CMPNTSEQ, QTYSOLD, UNITCOST, IVIVINDX, IVIVOFIX, SRCRCTSEQNM, TRXREFERENCE, PCHSRCTY, DEX_ROW_ID FROM .IV10201 WHERE ITEMNMBR = @ITEMNMBR_RS AND TRXLOCTN BETWEEN @TRXLOCTN_RS AND @TRXLOCTN_RE AND QTYTYPE BETWEEN @QTYTYPE_RS AND @QTYTYPE_RE AND DOCDATE BETWEEN @DOCDATE_RS AND @DOCDATE_RE AND RCTSEQNM BETWEEN @RCTSEQNM_RS AND @RCTSEQNM_RE AND SRCRCTSEQNM BETWEEN @SRCRCTSEQNM_RS AND @SRCRCTSEQNM_RE AND ( ITEMNMBR = @ITEMNMBR AND TRXLOCTN = @TRXLOCTN AND QTYTYPE = @QTYTYPE AND DOCDATE = @DOCDATE AND RCTSEQNM = @RCTSEQNM AND SRCRCTSEQNM > @SRCRCTSEQNM OR ITEMNMBR = @ITEMNMBR AND TRXLOCTN = @TRXLOCTN AND QTYTYPE = @QTYTYPE AND DOCDATE = @DOCDATE AND RCTSEQNM > @RCTSEQNM OR ITEMNMBR = @ITEMNMBR AND TRXLOCTN = @TRXLOCTN AND QTYTYPE = @QTYTYPE AND DOCDATE > @DOCDATE OR ITEMNMBR = @ITEMNMBR AND TRXLOCTN = @TRXLOCTN AND QTYTYPE > @QTYTYPE OR ITEMNMBR = @ITEMNMBR AND TRXLOCTN > @TRXLOCTN OR ITEMNMBR > @ITEMNMBR ) ORDER BY ITEMNMBR ASC, TRXLOCTN ASC, QTYTYPE ASC, DOCDATE ASC, RCTSEQNM ASC, SRCRCTSEQNM ASC END ELSE BEGIN SELECT TOP 25  ITEMNMBR, TRXLOCTN, QTYTYPE, DOCDATE, RCTSEQNM, ORIGINDOCTYPE, ORIGINDOCID, LNSEQNBR, CMPNTSEQ, QTYSOLD, UNITCOST, IVIVINDX, IVIVOFIX, SRCRCTSEQNM, TRXREFERENCE, PCHSRCTY, DEX_ROW_ID FROM .IV10201 WHERE ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND TRXLOCTN BETWEEN @TRXLOCTN_RS AND @TRXLOCTN_RE AND QTYTYPE BETWEEN @QTYTYPE_RS AND @QTYTYPE_RE AND DOCDATE BETWEEN @DOCDATE_RS AND @DOCDATE_RE AND RCTSEQNM BETWEEN @RCTSEQNM_RS AND @RCTSEQNM_RE AND SRCRCTSEQNM BETWEEN @SRCRCTSEQNM_RS AND @SRCRCTSEQNM_RE AND ( ITEMNMBR = @ITEMNMBR AND TRXLOCTN = @TRXLOCTN AND QTYTYPE = @QTYTYPE AND DOCDATE = @DOCDATE AND RCTSEQNM = @RCTSEQNM AND SRCRCTSEQNM > @SRCRCTSEQNM OR ITEMNMBR = @ITEMNMBR AND TRXLOCTN = @TRXLOCTN AND QTYTYPE = @QTYTYPE AND DOCDATE = @DOCDATE AND RCTSEQNM > @RCTSEQNM OR ITEMNMBR = @ITEMNMBR AND TRXLOCTN = @TRXLOCTN AND QTYTYPE = @QTYTYPE AND DOCDATE > @DOCDATE OR ITEMNMBR = @ITEMNMBR AND TRXLOCTN = @TRXLOCTN AND QTYTYPE > @QTYTYPE OR ITEMNMBR = @ITEMNMBR AND TRXLOCTN > @TRXLOCTN OR ITEMNMBR > @ITEMNMBR ) ORDER BY ITEMNMBR ASC, TRXLOCTN ASC, QTYTYPE ASC, DOCDATE ASC, RCTSEQNM ASC, SRCRCTSEQNM ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IV10201N_1] TO [DYNGRP]
GO
