SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 CREATE Procedure [dbo].[SVC_Make_PO](  @PromisedDate datetime,  @OrderedBy char(15),  @BatchNum char(15),  @ItemNumber char(30),  @VendorItemNumber char(30),  @LocationCode char(10),  @UofM char(8),  @Qty numeric(19,5),  @Cost numeric(19,5),  @VendorID char(15),  @ShipTo char(30),  @ShipMethod char(20),  @UserDate datetime,  @CallNumber char(16),  @PO_Number char(17) output,  @PO_LineSeq numeric(19,5) output,  @DropShipCustomer char(15) = '',  @DropShipCustomerSite char(21) = '',  @CompanyID smallint,  @CURNCYID  char(15),  @CURRNIDX  smallint,  @I_sRateCalcMethod  smallint ,           @I_sViewMode  smallint,                  @I_nExchangeRate  numeric(15,7),         @I_nDenomExchangeRate numeric(15,7),     @I_sMCTrxState  smallint,                @I_sDecimalPlaces  smallint,             @RateType  char(15),  @ExchangeTableType char(15),  @ExchangeDate datetime,  @ExchangeTime datetime,  @AccountIndex int,  @Consolidate tinyint   ) as declare @Use_POP smallint  select @Use_POP = Use_POP from SVC00998 if @Use_POP = 2 and exists(select * from sysobjects where name = 'SVC_POP_Make_PO')  exec SVC_POP_Make_PO  @PromisedDate,  @OrderedBy,  @BatchNum,  @ItemNumber,  @VendorItemNumber,  @LocationCode,  @UofM,  @Qty,  @Cost,  @VendorID,  @ShipTo,  @ShipMethod,  @UserDate,  @CallNumber,  @PO_Number output,  @PO_LineSeq output,  @DropShipCustomer,  @DropShipCustomerSite,  @CompanyID,  @CURNCYID,  @CURRNIDX,  @I_sRateCalcMethod,  @I_sViewMode,  @I_nExchangeRate,  @I_nDenomExchangeRate,@I_sMCTrxState,@I_sDecimalPlaces,  @RateType,  @ExchangeTableType,  @ExchangeDate,  @ExchangeTime,  @AccountIndex,  @Consolidate else  BEGIN  if @Use_POP = 3 and exists(select * from sysobjects where name = 'PO40100')  exec SVC_APOP_Make_PO  @PromisedDate,  @OrderedBy,  @BatchNum,  @ItemNumber,  @VendorItemNumber,  @LocationCode,  @UofM,  @Qty,  @Cost,  @VendorID,  @ShipTo,  @ShipMethod,  @UserDate,  @CallNumber,  @PO_Number output,  @PO_LineSeq output,  @DropShipCustomer,  @DropShipCustomerSite,  @CompanyID,  @CURNCYID,  @CURRNIDX,  @I_sRateCalcMethod,  @I_sViewMode,  @I_nExchangeRate,  @I_nDenomExchangeRate,@I_sMCTrxState,@I_sDecimalPlaces,  @RateType,  @ExchangeTableType,  @ExchangeDate,  @ExchangeTime,  @AccountIndex,  @Consolidate  END return 0    
GO
GRANT EXECUTE ON  [dbo].[SVC_Make_PO] TO [DYNGRP]
GO
