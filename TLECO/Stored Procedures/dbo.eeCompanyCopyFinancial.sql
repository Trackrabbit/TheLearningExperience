SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyFinancial] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255), @DestCMPANYID smallint, @SourcCMPANYID smallint select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '', @DestCMPANYID = 0, @SourcCMPANYID = 0 select @DestCMPANYID = CMPANYID from DYNAMICS..SY01500 where INTERID = @I_vToCompany select @SourcCMPANYID = CMPANYID from DYNAMICS..SY01500 where INTERID = @I_vFromCompany if (@I_vData = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..CM00100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..CM00100 ( [CHEKBKID],[DSCRIPTN],[BANKID],[CURNCYID],[ACTINDX],[BNKACTNM], [NXTCHNUM],[Next_Deposit_Number],[INACTIVE],[DYDEPCLR],[XCDMCHPW],[MXCHDLR], [DUPCHNUM],[OVCHNUM1],[LOCATNID],[NOTEINDX],[CMUSRDF1],[CMUSRDF2], [Last_Reconciled_Date],[Last_Reconciled_Balance],[CURRBLNC],[CREATDDT],[MODIFDT],[Recond], [Reconcile_In_Progress],[Deposit_In_Progress],[CHBKPSWD],[CURNCYPD],[CRNCYRCD],[ADPVADLR], [ADPVAPWD],[DYCHTCLR],[CMPANYID],[CHKBKTYP],[DDACTNUM],[DDINDNAM], [DDTRANS],[PaymentRateTypeID],[DepositRateTypeID],[CashInTransAcctIdx] ) select [CHEKBKID],[DSCRIPTN],[BANKID],[CURNCYID],[ACTINDX],[BNKACTNM], [NXTCHNUM],[Next_Deposit_Number],[INACTIVE],[DYDEPCLR],[XCDMCHPW],[MXCHDLR], [DUPCHNUM],[OVCHNUM1],[LOCATNID],[NOTEINDX],[CMUSRDF1],[CMUSRDF2], [Last_Reconciled_Date],[Last_Reconciled_Balance],[CURRBLNC],[CREATDDT],[MODIFDT],[Recond], [Reconcile_In_Progress],[Deposit_In_Progress],[CHBKPSWD],[CURNCYPD],[CRNCYRCD],[ADPVADLR], [ADPVAPWD],[DYCHTCLR],[CMPANYID],[CHKBKTYP],[DDACTNUM],[DDINDNAM], [DDTRANS],[PaymentRateTypeID],[DepositRateTypeID],[CashInTransAcctIdx] from ' + rtrim(@I_vFromCompany) + '..CM00100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..CM40100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..CM40100 ( [CMRECNUM],[NXTNUM],[CMHISTORY],[USRDFPR1],[USRDRPR2],[CHEKBKID] ) select [CMRECNUM],[NXTNUM],[CMHISTORY],[USRDFPR1],[USRDRPR2],[CHEKBKID] from ' + rtrim(@I_vFromCompany) + '..CM40100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..CM40101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..CM40101 ( [CMSortType],[CMTrxType],[DOCTYNAM],[DOCABREV] ) select [CMSortType],[CMTrxType],[DOCTYNAM],[DOCABREV] from ' + rtrim(@I_vFromCompany) + '..CM40101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GL00100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GL00100 ( [ACTINDX]' select @cStatement2 = rtrim(@cStatement2)+rtrim(','+'[ACTNUMBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement3 = ',[ACTALIAS],[MNACSGMT], [ACCTTYPE],[ACTDESCR],[PSTNGTYP],[ACCATNUM],[ACTIVE],[TPCLBLNC], [DECPLACS],[FXDORVAR],[BALFRCLC],[DSPLKUPS],[CNVRMTHD],[HSTRCLRT], [NOTEINDX],[CREATDDT],[MODIFDT],[USERDEF1],[USERDEF2],[PostSlsIn], [PostIvIn],[PostPurchIn],[PostPRIn],[ADJINFL],[INFLAREV],[INFLAEQU], [ACCTENTR],[USRDEFS1],[USRDEFS2],[Clear_Balance] ) select [ACTINDX]' select @cStatement4 = rtrim(@cStatement4)+rtrim(','+'[ACTNUMBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement5 = ',[ACTALIAS],[MNACSGMT], [ACCTTYPE],[ACTDESCR],[PSTNGTYP],[ACCATNUM],[ACTIVE],[TPCLBLNC], [DECPLACS],[FXDORVAR],[BALFRCLC],[DSPLKUPS],[CNVRMTHD],[HSTRCLRT], [NOTEINDX],[CREATDDT],[MODIFDT],[USERDEF1],[USERDEF2],[PostSlsIn], [PostIvIn],[PostPurchIn],[PostPRIn],[ADJINFL],[INFLAREV],[INFLAEQU], [ACCTENTR],[USRDEFS1],[USRDEFS2],[Clear_Balance] from ' + rtrim(@I_vFromCompany) + '..GL00100 ' exec(@cStatement+@cStatement2+@cStatement3+@cStatement4+@cStatement5) select @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '' select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GL00102' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GL00102 ( [ACCATNUM],[ACCATDSC] ) select [ACCATNUM],[ACCATDSC] from ' + rtrim(@I_vFromCompany) + '..GL00102 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GL00103' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GL00103 ( [ACTINDX],[PRCNTAGE],[DSTINDX] ) select [ACTINDX],[PRCNTAGE],[DSTINDX] from ' + rtrim(@I_vFromCompany) + '..GL00103 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GL00104' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GL00104 ( [ACTINDX],[SEPRATR1],[DSTINDX],[SEPRATR2],[BDNINDX] ) select [ACTINDX],[SEPRATR1],[DSTINDX],[SEPRATR2],[BDNINDX] from ' + rtrim(@I_vFromCompany) + '..GL00104 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GL00105' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GL00105 ( [ACTINDX]' select @cStatement2 = rtrim(@cStatement2)+rtrim(','+'[ACTNUMBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement3 = ',[ACTNUMST] ) select [ACTINDX]' select @cStatement4 = rtrim(@cStatement4)+rtrim(','+'[ACTNUMBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement5 = ',[ACTNUMST] from ' + rtrim(@I_vFromCompany) + '..GL00105 ' exec(@cStatement+@cStatement2+@cStatement3+@cStatement4+@cStatement5) select @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '' select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GL00200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GL00200 ( [BUDGETID],[BUDCOMNT],[BUDPWRD],[YEAR1],[Based_On],[From_Date], [TODATE],[NOTEINDX] ) select [BUDGETID],[BUDCOMNT],[BUDPWRD],[YEAR1],[Based_On],[From_Date], [TODATE],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..GL00200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GL00201' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GL00201 ( [BUDGETID]' select @cStatement2 = rtrim(@cStatement2)+rtrim(','+'[ACTNUMBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement3 = ',[PERIODID], [BUDGETAMT],[ACCATNUM],[ACTINDX],[YEAR1] ) select [BUDGETID]' select @cStatement4 = rtrim(@cStatement4)+rtrim(','+'[ACTNUMBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement5 = ',[PERIODID], [BUDGETAMT],[ACCATNUM],[ACTINDX],[YEAR1] from ' + rtrim(@I_vFromCompany) + '..GL00201 ' exec(@cStatement+@cStatement2+@cStatement3+@cStatement4+@cStatement5) select @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '' select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GL40000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GL40000 ( [UNIQKEY],[NJRNLENT],[RERINDX],[LSTCLSDT],[TRERCLSG],[DIVACTSG], [BLNCDSPL],[KPGACHST],[KPGTRXHS],[AHSTPSTG],[USRDFPR1],[USRDRPR2], [USRDRPR3],[USRDRPR4],[UPDTACCEL],[Posting_Number_Type],[Delete_Saved_Trx],[Void_Sub_Trx], [Correct_IC_Trx],[Allow_Reporting_Ledgers],[UseLedgersForAcctBalance],[NXTBUDJRLENT],[KPBUDTRXHIST],[NextReconciliationNumber] ) select [UNIQKEY],[NJRNLENT],[RERINDX],[LSTCLSDT],[TRERCLSG],[DIVACTSG], [BLNCDSPL],[KPGACHST],[KPGTRXHS],[AHSTPSTG],[USRDFPR1],[USRDRPR2], [USRDRPR3],[USRDRPR4],[UPDTACCEL],[Posting_Number_Type],[Delete_Saved_Trx],[Void_Sub_Trx], [Correct_IC_Trx],[Allow_Reporting_Ledgers],[UseLedgersForAcctBalance],[NXTBUDJRLENT],[KPBUDTRXHIST],[NextReconciliationNumber] from ' + rtrim(@I_vFromCompany) + '..GL40000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GL40100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GL40100 ( [BSNSFMID],[BSNSFDSC],[OFFINDX],[OVOACNUM],[BCHEMSG1],[BCHEMSG2], [SOURCDOC],[REFRENCE],[BRKDNALL],[NOTEINDX] ) select [BSNSFMID],[BSNSFDSC],[OFFINDX],[OVOACNUM],[BCHEMSG1],[BCHEMSG2], [SOURCDOC],[REFRENCE],[BRKDNALL],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..GL40100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GL40101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GL40101 ( [BSNSFMID],[SEQUENCE1],[ACTINDX] ) select [BSNSFMID],[SEQUENCE1],[ACTINDX] from ' + rtrim(@I_vFromCompany) + '..GL40101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GL40200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GL40200 ( [SGMTNUMB],[SGMNTID],[DSCRIPTN],[SEGCOUNT],[NOTEINDX] ) select [SGMTNUMB],[SGMNTID],[DSCRIPTN],[SEGCOUNT],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..GL40200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SY04100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SY04100 ( [BANKID],[BANKNAME],[ADDRESS1],[ADDRESS2],[ADDRESS3],[CITY], [STATE],[ZIPCODE],[COUNTRY],[PHNUMBR1],[PHNUMBR2],[PHONE3], [FAXNUMBR],[TRNSTNBR],[BNKBRNCH],[NOTEINDX],[DDTRANUM] ) select [BANKID],[BANKNAME],[ADDRESS1],[ADDRESS2],[ADDRESS3],[CITY], [STATE],[ZIPCODE],[COUNTRY],[PHNUMBR1],[PHNUMBR2],[PHONE3], [FAXNUMBR],[TRNSTNBR],[BNKBRNCH],[NOTEINDX],[DDTRANUM] from ' + rtrim(@I_vFromCompany) + '..SY04100 ' exec(@cStatement) end if (@I_vReportOptions = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..DTA00700' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..DTA00700 ( [RPTGRIND],[RTGRSBIN],[RTPACHIN]' select @cStatement2 = rtrim(@cStatement2)+rtrim(','+'[STTACNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement3 = rtrim(@cStatement3)+rtrim(','+'[EACCNBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement4 = ',[STRTDATE],[ENDDATE],[STARTGRP], [ENDGROUP],[STRTCODE],[ENDCODE],[PRNTDTLD],[UNPSTTRX],[OPEN1], [HISTORY],[STTPSTDT],[ENDPSTDT] ) select [RPTGRIND],[RTGRSBIN],[RTPACHIN]' select @cStatement5 = rtrim(@cStatement5)+rtrim(','+'[STTACNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement6 = rtrim(@cStatement6)+rtrim(','+'[EACCNBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement7 = ',[STRTDATE],[ENDDATE],[STARTGRP], [ENDGROUP],[STRTCODE],[ENDCODE],[PRNTDTLD],[UNPSTTRX],[OPEN1], [HISTORY],[STTPSTDT],[ENDPSTDT] from ' + rtrim(@I_vFromCompany) + '..DTA00700 ' exec(@cStatement+@cStatement2+@cStatement3+@cStatement4+@cStatement5+@cStatement6+@cStatement7) select @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '' select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GL70500' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GL70500 ( [IFFILXST],[FILEXPNM],[EXPTTYPE],[ASKECHTM],[PRNTOFIL],[PRTOPRTR], [PRTOSCRN],[PRNTTYPE],[RPTGRIND],[RTPACHIN],[RTGRSBIN],[REPORTID], [FINRPTNM],[STGENINT1],[ENDGENINT1],[STGENINT2],[ENDGENINT2],[STRTNGDT], [ENDINGDT],[STTCATEG],[STTUDEF1],[ENUSRDF1],[ENDCATEG],[STTCATNM], [ENDCATNM],[STRTJRNL],[ENDJRNAL],[STRXSRC],[ENTRXSRC],[STRTCMTRXNUM], [ENDCMTRXNUM],[SSRCEDOC],[ENDSRCDC],[STTACDSC],[ENDACDSC],[STBDBSID], [ENBDBSID],[STBDBSDS],[ENBDBSDS],[STCHBKID],[ENCHBKID],[STRTDSCR], [ENDDESCR],[STTSEGID],[ENDSEGID],[STCTRNUM],[ENCNTNUM],[STDOCNUM], [ENDOCNUM],[STMASTID],[ENMASTID],[STMASTNM],[ENMASTNM],[SORTBY], [CBINACTS],[PSTNGACT],[UNITACCT],[RPRTSHOW],[PRRPTFOR],[PRVYRCMB], [RPTDETAL],[INDIVDUL_1],[INDIVDUL_2],[INDIVDUL_3],[INDIVDUL_4],[INDIVDUL_5], [INDIVDUL_6],[INDIVDUL_7],[INDIVDUL_8],[INDIVDUL_9],[INDIVDUL_10],[INDIVDUL_11], [INDIVDUL_12],[INDIVDUL_13],[INDIVDUL_14],[INDIVDUL_15],[INDIVDUL_16],[INDIVDUL_17], [INDIVDUL_18],[INDIVDUL_19],[INDIVDUL_20],[INDIVDUL_21],[INDIVDUL_22],[INDIVDUL_23], [INDIVDUL_24],[INDIVDUL_25],[INDIVDUL_26],[INDIVDUL_27],[INDIVDUL_28],[INDIVDUL_29], [INDIVDUL_30],[INDIVDUL_31],[INDIVDUL_32],[INDIVDUL_33],[INDIVDUL_34],[INDIVDUL_35], [INDIVDUL_36],[INDIVDUL_37],[INDIVDUL_38],[INDIVDUL_39],[INDIVDUL_40],[INDIVDUL_41], [PRNTDSCR],[PRZROBAL],[CLCRATIO],[INCLGNDS],[GLSTTKDT],[GLENTKDT], [PRUNTACT]' select @cStatement2 = rtrim(@cStatement2)+rtrim(','+'[STACCNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement3 = rtrim(@cStatement3)+rtrim(','+'[EDGACNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement4 = ',[SEGSRTBY],[RANGEBY],[ACCLSTAT],[USEACCEL],[CBZBNA], [Accounts_Included],[Start_Position_String],[End_Position_String],[RPTXRATE],[RPRTCLMD],[PRTCURIN], [Checkbook_Date],[End_Month],[Start_Month],[YEAR1],[INCMCINF],[STCURRID], [ENDCURID],[Include_Voided_Trx],[UseLedgersForAcctBalance] ) select [IFFILXST],[FILEXPNM],[EXPTTYPE],[ASKECHTM],[PRNTOFIL],[PRTOPRTR], [PRTOSCRN],[PRNTTYPE],[RPTGRIND],[RTPACHIN],[RTGRSBIN],[REPORTID], [FINRPTNM],[STGENINT1],[ENDGENINT1],[STGENINT2],[ENDGENINT2],[STRTNGDT], [ENDINGDT],[STTCATEG],[STTUDEF1],[ENUSRDF1],[ENDCATEG],[STTCATNM], [ENDCATNM],[STRTJRNL],[ENDJRNAL],[STRXSRC],[ENTRXSRC],[STRTCMTRXNUM], [ENDCMTRXNUM],[SSRCEDOC],[ENDSRCDC],[STTACDSC],[ENDACDSC],[STBDBSID], [ENBDBSID],[STBDBSDS],[ENBDBSDS],[STCHBKID],[ENCHBKID],[STRTDSCR], [ENDDESCR],[STTSEGID],[ENDSEGID],[STCTRNUM],[ENCNTNUM],[STDOCNUM], [ENDOCNUM],[STMASTID],[ENMASTID],[STMASTNM],[ENMASTNM],[SORTBY], [CBINACTS],[PSTNGACT],[UNITACCT],[RPRTSHOW],[PRRPTFOR],[PRVYRCMB], [RPTDETAL],[INDIVDUL_1],[INDIVDUL_2],[INDIVDUL_3],[INDIVDUL_4],[INDIVDUL_5], [INDIVDUL_6],[INDIVDUL_7],[INDIVDUL_8],[INDIVDUL_9],[INDIVDUL_10],[INDIVDUL_11], [INDIVDUL_12],[INDIVDUL_13],[INDIVDUL_14],[INDIVDUL_15],[INDIVDUL_16],[INDIVDUL_17], [INDIVDUL_18],[INDIVDUL_19],[INDIVDUL_20],[INDIVDUL_21],[INDIVDUL_22],[INDIVDUL_23], [INDIVDUL_24],[INDIVDUL_25],[INDIVDUL_26],[INDIVDUL_27],[INDIVDUL_28],[INDIVDUL_29], [INDIVDUL_30],[INDIVDUL_31],[INDIVDUL_32],[INDIVDUL_33],[INDIVDUL_34],[INDIVDUL_35], [INDIVDUL_36],[INDIVDUL_37],[INDIVDUL_38],[INDIVDUL_39],[INDIVDUL_40],[INDIVDUL_41], [PRNTDSCR],[PRZROBAL],[CLCRATIO],[INCLGNDS],[GLSTTKDT],[GLENTKDT], [PRUNTACT]' select @cStatement5 = rtrim(@cStatement5)+rtrim(','+'[STACCNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement6 = rtrim(@cStatement6)+rtrim(','+'[EDGACNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement7 = ',[SEGSRTBY],[RANGEBY],[ACCLSTAT],[USEACCEL],[CBZBNA], [Accounts_Included],[Start_Position_String],[End_Position_String],[RPTXRATE],[RPRTCLMD],[PRTCURIN], [Checkbook_Date],[End_Month],[Start_Month],[YEAR1],[INCMCINF],[STCURRID], [ENDCURID],[Include_Voided_Trx],[UseLedgersForAcctBalance] from ' + rtrim(@I_vFromCompany) + '..GL70500 ' exec(@cStatement+@cStatement2+@cStatement3+@cStatement4+@cStatement5+@cStatement6+@cStatement7) select @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '' select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..LK4000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..LK4000 ( [FINRPTNM],[STACNMST],[End_Account_Number_String],[IFFILXST],[ASKECHTM],[LK_Start_Token_Date], [LKEnd_Token_Date],[PRRPTFOR],[PRVYRCMB],[PRTOSCRN],[PRTOPRTR],[EXPTTYPE], [PRNTOFIL],[FILEXPNM],[RPTGRIND],[RTGRSBIN],[RTPACHIN],[REPORTID], [STRTNGDT],[ENDINGDT]' select @cStatement2 = rtrim(@cStatement2)+rtrim(','+'[STTACNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement3 = rtrim(@cStatement3)+rtrim(','+'[EACCNBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement4 = ',[STRTJRNL],[ENDJRNAL],[SSRCEDOC],[ENDSRCDC], [STRXSRC],[LK_Start_Group],[LK_End_Group],[ENTRXSRC],[Start_LK_Link_No],[End_LK_Link_No], [STRTDATE],[ENDDATE],[STTUSRID],[ENDUSRID],[SORTBY],[LK_Link_Balance], [Multicurrency_Information] ) select [FINRPTNM],[STACNMST],[End_Account_Number_String],[IFFILXST],[ASKECHTM],[LK_Start_Token_Date], [LKEnd_Token_Date],[PRRPTFOR],[PRVYRCMB],[PRTOSCRN],[PRTOPRTR],[EXPTTYPE], [PRNTOFIL],[FILEXPNM],[RPTGRIND],[RTGRSBIN],[RTPACHIN],[REPORTID], [STRTNGDT],[ENDINGDT]' select @cStatement5 = rtrim(@cStatement5)+rtrim(','+'[STTACNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement6 = rtrim(@cStatement6)+rtrim(','+'[EACCNBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement7 = ',[STRTJRNL],[ENDJRNAL],[SSRCEDOC],[ENDSRCDC], [STRXSRC],[LK_Start_Group],[LK_End_Group],[ENTRXSRC],[Start_LK_Link_No],[End_LK_Link_No], [STRTDATE],[ENDDATE],[STTUSRID],[ENDUSRID],[SORTBY],[LK_Link_Balance], [Multicurrency_Information] from ' + rtrim(@I_vFromCompany) + '..LK4000 ' exec(@cStatement+@cStatement2+@cStatement3+@cStatement4+@cStatement5+@cStatement6+@cStatement7) select @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '' select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..LK40001' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..LK40001 ( [RTGRSBIN],[RTPACHIN],[RPTGRIND],[RPTGRNMS],[RTCFGWIN] ) select [RTGRSBIN],[RTPACHIN],[RPTGRIND],[RPTGRNMS],[RTCFGWIN] from ' + rtrim(@I_vFromCompany) + '..LK40001 ' exec(@cStatement) end select @cStatement = 'update ' + rtrim(@I_vToCompany) + '..CM00100 set CMPANYID = ' + cast(@DestCMPANYID as varchar) exec(@cStatement) select @cStatement = 'update ' + rtrim(@I_vToCompany) + '..CM00100 set CURRBLNC = 0, Last_Reconciled_Balance = 0' exec(@cStatement) return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyFinancial] TO [DYNGRP]
GO
