SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sopFillSopItemPrintOptionTemp]   @LocationCode varchar (11),  @ItemNumberAll tinyint,  @FromItemNumber varchar (31),  @ToItemNumber varchar (31),  @DescriptionAll tinyint,  @FromDescription varchar (100),  @ToDescription varchar (100),  @ItemClassCodeAll tinyint,  @FromItemClassCode varchar (11),  @ToItemClassCode varchar (11),  @OSName varchar(31),  @ItemPickingOption tinyint AS  DECLARE @sql_statement as varchar(8000)  select @sql_statement = '' select @sql_statement = @sql_statement + 'delete from ' +  @OSName exec (@sql_statement)  set @sql_statement = '' set @sql_statement = @sql_statement + 'insert into ' + @OSName + ' select a.ITEMNMBR, a.LOCNCODE, b.ITEMDESC, ' set @sql_statement = @sql_statement + 'b.ITMGEDSC, b.ITMCLSCD, a.PICKTICKETITEMOPT, ' + ltrim(str(@ItemPickingOption)) + ' from IV00102 a, IV00101 b where '  if @ItemNumberAll = 1  begin  if @FromItemNumber = '' and @ToItemNumber <> ''  set @sql_statement = @sql_statement + 'a.ITEMNMBR <= ''' +  @ToItemNumber + ''' and '   if @FromItemNumber <> '' and @ToItemNumber = ''  set @sql_statement = @sql_statement + 'a.ITEMNMBR >= ''' +  @FromItemNumber + ''' and '   if @FromItemNumber <> '' and @ToItemNumber <> ''  begin  set @sql_statement = @sql_statement + 'a.ITEMNMBR >= ''' + @FromItemNumber + ''' and a.ITEMNMBR <= '   set @sql_statement = @sql_statement + '''' +  @ToItemNumber + ''' and '  end end  if @DescriptionAll = 1 begin  if @FromDescription = '' and @ToDescription <> ''  set @sql_statement = @sql_statement + 'b.ITMGEDSC <= ''' +  @ToDescription + ''' and '    if @FromDescription <> '' and @ToDescription = ''  set @sql_statement = @sql_statement + 'b.ITMGEDSC >= ''' +  @FromDescription + ''' and '   if @FromDescription <> '' and @ToDescription <> ''  begin  set @sql_statement = @sql_statement + 'b.ITMGEDSC >= ''' + @FromDescription + ''' and b.ITMGEDSC <= '   set @sql_statement = @sql_statement + '''' + @ToDescription + ''' and '  end end   if @ItemClassCodeAll = 1 begin  if @FromItemClassCode = '' and @ToItemClassCode <> ''  set @sql_statement = @sql_statement + 'b.ITMCLSCD <= ''' +  @ToDescription + ''' and '    if @FromItemClassCode <> '' and @ToItemClassCode = ''  set @sql_statement = @sql_statement + 'b.ITMCLSCD >= ''' +  @FromItemClassCode + ''' and '    if @FromItemClassCode <> '' and @ToItemClassCode <> ''  begin  set @sql_statement = @sql_statement + 'b.ITMCLSCD >= ''' + @FromItemClassCode + ''' and b.ITMCLSCD <= '  set @sql_statement = @sql_statement + '''' + @ToItemClassCode + ''' and '   end end  set @sql_statement = @sql_statement + 'a.ITEMNMBR = b.ITEMNMBR and a.RCRDTYPE = 2 and a.LOCNCODE = ''' + @LocationCode set @sql_statement = @sql_statement + ''' order by a.ITEMNMBR, a.LOCNCODE, b.ITEMDESC, b.ITMGEDSC, b.ITMCLSCD'  exec (@sql_statement)    
GO
GRANT EXECUTE ON  [dbo].[sopFillSopItemPrintOptionTemp] TO [DYNGRP]
GO
