SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_POP10500N_6] (@BS int, @VENDORID char(15), @Status smallint, @ITEMNMBR char(31), @APPYTYPE smallint, @PONUMBER char(17), @DEX_ROW_ID int, @VENDORID_RS char(15), @Status_RS smallint, @ITEMNMBR_RS char(31), @APPYTYPE_RS smallint, @PONUMBER_RS char(17), @VENDORID_RE char(15), @Status_RE smallint, @ITEMNMBR_RE char(31), @APPYTYPE_RE smallint, @PONUMBER_RE char(17)) AS  set nocount on IF @VENDORID_RS IS NULL BEGIN SELECT TOP 25  PONUMBER, POLNENUM, POPRCTNM, RCPTLNNM, QTYSHPPD, QTYINVCD, QTYREJ, QTYMATCH, QTYRESERVED, QTYINVRESERVE, Status, UMQTYINB, OLDCUCST, JOBNUMBR, COSTCODE, COSTTYPE, ORCPTCOST, OSTDCOST, APPYTYPE, POPTYPE, VENDORID, ITEMNMBR, UOFM, TRXLOCTN, DATERECD, RCTSEQNM, SPRCTSEQ, PCHRPTCT, SPRCPTCT, OREXTCST, RUPPVAMT, ACPURIDX, INVINDX, UPPVIDX, NOTEINDX, CURNCYID, CURRNIDX, XCHGRATE, RATECALC, DENXRATE, RATETPID, EXGTBLID, Capital_Item, Product_Indicator, Total_Landed_Cost_Amount, QTYTYPE, Posted_LC_PPV_Amount, QTYREPLACED, QTYINVADJ, DEX_ROW_ID FROM .POP10500 WHERE ( VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND APPYTYPE = @APPYTYPE AND PONUMBER = @PONUMBER AND DEX_ROW_ID > @DEX_ROW_ID OR VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND APPYTYPE = @APPYTYPE AND PONUMBER > @PONUMBER OR VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND APPYTYPE > @APPYTYPE OR VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR > @ITEMNMBR OR VENDORID = @VENDORID AND Status > @Status OR VENDORID > @VENDORID ) ORDER BY VENDORID ASC, Status ASC, ITEMNMBR ASC, APPYTYPE ASC, PONUMBER ASC, DEX_ROW_ID ASC END ELSE IF @VENDORID_RS = @VENDORID_RE BEGIN SELECT TOP 25  PONUMBER, POLNENUM, POPRCTNM, RCPTLNNM, QTYSHPPD, QTYINVCD, QTYREJ, QTYMATCH, QTYRESERVED, QTYINVRESERVE, Status, UMQTYINB, OLDCUCST, JOBNUMBR, COSTCODE, COSTTYPE, ORCPTCOST, OSTDCOST, APPYTYPE, POPTYPE, VENDORID, ITEMNMBR, UOFM, TRXLOCTN, DATERECD, RCTSEQNM, SPRCTSEQ, PCHRPTCT, SPRCPTCT, OREXTCST, RUPPVAMT, ACPURIDX, INVINDX, UPPVIDX, NOTEINDX, CURNCYID, CURRNIDX, XCHGRATE, RATECALC, DENXRATE, RATETPID, EXGTBLID, Capital_Item, Product_Indicator, Total_Landed_Cost_Amount, QTYTYPE, Posted_LC_PPV_Amount, QTYREPLACED, QTYINVADJ, DEX_ROW_ID FROM .POP10500 WHERE VENDORID = @VENDORID_RS AND Status BETWEEN @Status_RS AND @Status_RE AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND APPYTYPE BETWEEN @APPYTYPE_RS AND @APPYTYPE_RE AND PONUMBER BETWEEN @PONUMBER_RS AND @PONUMBER_RE AND ( VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND APPYTYPE = @APPYTYPE AND PONUMBER = @PONUMBER AND DEX_ROW_ID > @DEX_ROW_ID OR VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND APPYTYPE = @APPYTYPE AND PONUMBER > @PONUMBER OR VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND APPYTYPE > @APPYTYPE OR VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR > @ITEMNMBR OR VENDORID = @VENDORID AND Status > @Status OR VENDORID > @VENDORID ) ORDER BY VENDORID ASC, Status ASC, ITEMNMBR ASC, APPYTYPE ASC, PONUMBER ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  PONUMBER, POLNENUM, POPRCTNM, RCPTLNNM, QTYSHPPD, QTYINVCD, QTYREJ, QTYMATCH, QTYRESERVED, QTYINVRESERVE, Status, UMQTYINB, OLDCUCST, JOBNUMBR, COSTCODE, COSTTYPE, ORCPTCOST, OSTDCOST, APPYTYPE, POPTYPE, VENDORID, ITEMNMBR, UOFM, TRXLOCTN, DATERECD, RCTSEQNM, SPRCTSEQ, PCHRPTCT, SPRCPTCT, OREXTCST, RUPPVAMT, ACPURIDX, INVINDX, UPPVIDX, NOTEINDX, CURNCYID, CURRNIDX, XCHGRATE, RATECALC, DENXRATE, RATETPID, EXGTBLID, Capital_Item, Product_Indicator, Total_Landed_Cost_Amount, QTYTYPE, Posted_LC_PPV_Amount, QTYREPLACED, QTYINVADJ, DEX_ROW_ID FROM .POP10500 WHERE VENDORID BETWEEN @VENDORID_RS AND @VENDORID_RE AND Status BETWEEN @Status_RS AND @Status_RE AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND APPYTYPE BETWEEN @APPYTYPE_RS AND @APPYTYPE_RE AND PONUMBER BETWEEN @PONUMBER_RS AND @PONUMBER_RE AND ( VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND APPYTYPE = @APPYTYPE AND PONUMBER = @PONUMBER AND DEX_ROW_ID > @DEX_ROW_ID OR VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND APPYTYPE = @APPYTYPE AND PONUMBER > @PONUMBER OR VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND APPYTYPE > @APPYTYPE OR VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR > @ITEMNMBR OR VENDORID = @VENDORID AND Status > @Status OR VENDORID > @VENDORID ) ORDER BY VENDORID ASC, Status ASC, ITEMNMBR ASC, APPYTYPE ASC, PONUMBER ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_POP10500N_6] TO [DYNGRP]
GO
