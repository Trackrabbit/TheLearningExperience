SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_UPR10111F_1] (@YEAR1_RS smallint, @EMPLOYID_RS char(15), @YEAR1_RE smallint, @EMPLOYID_RE char(15)) AS  set nocount on IF @YEAR1_RS IS NULL BEGIN SELECT TOP 25  YEAR1, EMPLOYID, MonthofCoverage_1, MonthofCoverage_2, MonthofCoverage_3, MonthofCoverage_4, MonthofCoverage_5, MonthofCoverage_6, MonthofCoverage_7, MonthofCoverage_8, MonthofCoverage_9, MonthofCoverage_10, MonthofCoverage_11, MonthofCoverage_12, MonthofCost_1, MonthofCost_2, MonthofCost_3, MonthofCost_4, MonthofCost_5, MonthofCost_6, MonthofCost_7, MonthofCost_8, MonthofCost_9, MonthofCost_10, MonthofCost_11, MonthofCost_12, MonthofSafeHarbor_1, MonthofSafeHarbor_2, MonthofSafeHarbor_3, MonthofSafeHarbor_4, MonthofSafeHarbor_5, MonthofSafeHarbor_6, MonthofSafeHarbor_7, MonthofSafeHarbor_8, MonthofSafeHarbor_9, MonthofSafeHarbor_10, MonthofSafeHarbor_11, MonthofSafeHarbor_12, CHANGEBY_I, CHANGEDATE_I, DEX_ROW_ID FROM .UPR10111 ORDER BY YEAR1 ASC, EMPLOYID ASC END ELSE IF @YEAR1_RS = @YEAR1_RE BEGIN SELECT TOP 25  YEAR1, EMPLOYID, MonthofCoverage_1, MonthofCoverage_2, MonthofCoverage_3, MonthofCoverage_4, MonthofCoverage_5, MonthofCoverage_6, MonthofCoverage_7, MonthofCoverage_8, MonthofCoverage_9, MonthofCoverage_10, MonthofCoverage_11, MonthofCoverage_12, MonthofCost_1, MonthofCost_2, MonthofCost_3, MonthofCost_4, MonthofCost_5, MonthofCost_6, MonthofCost_7, MonthofCost_8, MonthofCost_9, MonthofCost_10, MonthofCost_11, MonthofCost_12, MonthofSafeHarbor_1, MonthofSafeHarbor_2, MonthofSafeHarbor_3, MonthofSafeHarbor_4, MonthofSafeHarbor_5, MonthofSafeHarbor_6, MonthofSafeHarbor_7, MonthofSafeHarbor_8, MonthofSafeHarbor_9, MonthofSafeHarbor_10, MonthofSafeHarbor_11, MonthofSafeHarbor_12, CHANGEBY_I, CHANGEDATE_I, DEX_ROW_ID FROM .UPR10111 WHERE YEAR1 = @YEAR1_RS AND EMPLOYID BETWEEN @EMPLOYID_RS AND @EMPLOYID_RE ORDER BY YEAR1 ASC, EMPLOYID ASC END ELSE BEGIN SELECT TOP 25  YEAR1, EMPLOYID, MonthofCoverage_1, MonthofCoverage_2, MonthofCoverage_3, MonthofCoverage_4, MonthofCoverage_5, MonthofCoverage_6, MonthofCoverage_7, MonthofCoverage_8, MonthofCoverage_9, MonthofCoverage_10, MonthofCoverage_11, MonthofCoverage_12, MonthofCost_1, MonthofCost_2, MonthofCost_3, MonthofCost_4, MonthofCost_5, MonthofCost_6, MonthofCost_7, MonthofCost_8, MonthofCost_9, MonthofCost_10, MonthofCost_11, MonthofCost_12, MonthofSafeHarbor_1, MonthofSafeHarbor_2, MonthofSafeHarbor_3, MonthofSafeHarbor_4, MonthofSafeHarbor_5, MonthofSafeHarbor_6, MonthofSafeHarbor_7, MonthofSafeHarbor_8, MonthofSafeHarbor_9, MonthofSafeHarbor_10, MonthofSafeHarbor_11, MonthofSafeHarbor_12, CHANGEBY_I, CHANGEDATE_I, DEX_ROW_ID FROM .UPR10111 WHERE YEAR1 BETWEEN @YEAR1_RS AND @YEAR1_RE AND EMPLOYID BETWEEN @EMPLOYID_RS AND @EMPLOYID_RE ORDER BY YEAR1 ASC, EMPLOYID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_UPR10111F_1] TO [DYNGRP]
GO
