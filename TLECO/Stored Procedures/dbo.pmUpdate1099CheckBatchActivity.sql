SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[pmUpdate1099CheckBatchActivity]  @I_CompanyName char(64) = NULL,  @O_nPostingActivity int   = NULL  output,  @O_SQL_Error_State int   = NULL output  as  declare @iStatus int,  @iError int,  @cPMTrxEntry varchar(255),  @cPMPayment varchar(255),  @cPMCChecks varchar(255),  @cPOPRcvEntry varchar(255),  @cPOIVCEntry varchar(255),  @cPORetEntry varchar(255)  select @O_SQL_Error_State = 0,  @O_nPostingActivity = 0  select @iStatus = 0 exec @iStatus = DYNAMICS.dbo.smGetConstantString 'PM_TRXENT_STR', @cPMTrxEntry output, @O_SQL_Error_State output  select @iError = @@error if @iStatus = 0 and @iError <> 0  select @iStatus = @iError  if ( (@iStatus <> 0) or (@O_SQL_Error_State <> 0) )  return (@iStatus)  exec @iStatus = DYNAMICS.dbo.smGetConstantString 'PM_PAYMENT_STR', @cPMPayment output, @O_SQL_Error_State output  select @iError = @@error if @iStatus = 0 and @iError <> 0  select @iStatus = @iError  if ( (@iStatus <> 0) or (@O_SQL_Error_State <> 0) )  return (@iStatus)  exec @iStatus = DYNAMICS.dbo.smGetConstantString 'XPM_CCHECKS_STR', @cPMCChecks output, @O_SQL_Error_State output  select @iError = @@error if @iStatus = 0 and @iError <> 0  select @iStatus = @iError  if ( (@iStatus <> 0) or (@O_SQL_Error_State <> 0) )  return (@iStatus)   exec @iStatus = DYNAMICS.dbo.smGetConstantString 'BATCH_SOURCE_POP_RCV_ENTRY', @cPOPRcvEntry output, @O_SQL_Error_State output  select @iError = @@error if @iStatus = 0 and @iError <> 0  select @iStatus = @iError  if ( (@iStatus <> 0) or (@O_SQL_Error_State <> 0) )  return (@iStatus) exec @iStatus = DYNAMICS.dbo.smGetConstantString 'BATCH_SOURCE_POP_IVC_ENTRY', @cPOIVCEntry output, @O_SQL_Error_State output  select @iError = @@error if @iStatus = 0 and @iError <> 0  select @iStatus = @iError  if ( (@iStatus <> 0) or (@O_SQL_Error_State <> 0) )  return (@iStatus) exec @iStatus = DYNAMICS.dbo.smGetConstantString 'BATCH_SOURCE_POP_RET_ENTRY', @cPORetEntry output, @O_SQL_Error_State output  select @iError = @@error if @iStatus = 0 and @iError <> 0  select @iStatus = @iError  if ( (@iStatus <> 0) or (@O_SQL_Error_State <> 0) )  return (@iStatus)  if exists (select 1 from DYNAMICS.dbo.SY00800   where ( BCHSOURC = @cPMTrxEntry or BCHSOURC = @cPMPayment or BCHSOURC = @cPMCChecks ) and POSTING = 1 and CMPNYNAM = @I_CompanyName )  select @O_nPostingActivity = 1  if exists (select 1 from DYNAMICS.dbo.SY00800   where ( BCHSOURC = @cPOPRcvEntry or BCHSOURC = @cPOIVCEntry or BCHSOURC = @cPORetEntry ) and POSTING = 1 and CMPNYNAM = @I_CompanyName )  select @O_nPostingActivity = 3  return   
GO
GRANT EXECUTE ON  [dbo].[pmUpdate1099CheckBatchActivity] TO [DYNGRP]
GO
