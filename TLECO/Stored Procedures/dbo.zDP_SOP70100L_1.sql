SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SOP70100L_1] (@INQID_RS char(15), @INQID_RE char(15)) AS  set nocount on IF @INQID_RS IS NULL BEGIN SELECT TOP 25  INQID, HISTORY, UNPSTTRX, SORTBY, NOTEINDX, CREATDDT, MODIFDT, USER2ENT, STCUSTID, ENCUSTID, STCUSTNM, ENCSTNAM, STTDOCDT, ENDDOCDT, STDOCNUM, ENDOCNUM, STSOPTYP, EDSOPTYP, STTDOCID, ENDDOCID, STTITNUM, ENITMNBR, STMSTNMB, EDMASNMB, STTPHON1, ENDPHON1, STQUOEXD, EDQUOEXD, STREQDAT, ENDREQDT, STSPRSID, ENSPSNID, STTUDEF1, ENUSRDF1, Start_Purchasing_Status, End_Purchasing_Status, DEX_ROW_ID FROM .SOP70100 ORDER BY INQID DESC END ELSE IF @INQID_RS = @INQID_RE BEGIN SELECT TOP 25  INQID, HISTORY, UNPSTTRX, SORTBY, NOTEINDX, CREATDDT, MODIFDT, USER2ENT, STCUSTID, ENCUSTID, STCUSTNM, ENCSTNAM, STTDOCDT, ENDDOCDT, STDOCNUM, ENDOCNUM, STSOPTYP, EDSOPTYP, STTDOCID, ENDDOCID, STTITNUM, ENITMNBR, STMSTNMB, EDMASNMB, STTPHON1, ENDPHON1, STQUOEXD, EDQUOEXD, STREQDAT, ENDREQDT, STSPRSID, ENSPSNID, STTUDEF1, ENUSRDF1, Start_Purchasing_Status, End_Purchasing_Status, DEX_ROW_ID FROM .SOP70100 WHERE INQID = @INQID_RS ORDER BY INQID DESC END ELSE BEGIN SELECT TOP 25  INQID, HISTORY, UNPSTTRX, SORTBY, NOTEINDX, CREATDDT, MODIFDT, USER2ENT, STCUSTID, ENCUSTID, STCUSTNM, ENCSTNAM, STTDOCDT, ENDDOCDT, STDOCNUM, ENDOCNUM, STSOPTYP, EDSOPTYP, STTDOCID, ENDDOCID, STTITNUM, ENITMNBR, STMSTNMB, EDMASNMB, STTPHON1, ENDPHON1, STQUOEXD, EDQUOEXD, STREQDAT, ENDREQDT, STSPRSID, ENSPSNID, STTUDEF1, ENUSRDF1, Start_Purchasing_Status, End_Purchasing_Status, DEX_ROW_ID FROM .SOP70100 WHERE INQID BETWEEN @INQID_RS AND @INQID_RE ORDER BY INQID DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SOP70100L_1] TO [DYNGRP]
GO
