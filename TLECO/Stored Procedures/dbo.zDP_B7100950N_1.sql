SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE PROC [dbo].[zDP_B7100950N_1] (@BS int, @BACHNUMB char(15), @JRNENTRY int, @SQNCLINE numeric(19,5), @USERID char(15), @BACHNUMB_RS char(15), @JRNENTRY_RS int, @SQNCLINE_RS numeric(19,5), @USERID_RS char(15), @BACHNUMB_RE char(15), @JRNENTRY_RE int, @SQNCLINE_RE numeric(19,5), @USERID_RE char(15)) AS /* 12.00.0270.000 */ set nocount on IF @BACHNUMB_RS IS NULL BEGIN SELECT TOP 25  BACHNUMB, JRNENTRY, SQNCLINE, INTERID, ACTINDX, USERID, TRXDATE, ORCRDAMT, DEX_ROW_ID FROM .B7100950 WHERE ( BACHNUMB = @BACHNUMB AND JRNENTRY = @JRNENTRY AND SQNCLINE = @SQNCLINE AND USERID > @USERID OR BACHNUMB = @BACHNUMB AND JRNENTRY = @JRNENTRY AND SQNCLINE > @SQNCLINE OR BACHNUMB = @BACHNUMB AND JRNENTRY > @JRNENTRY OR BACHNUMB > @BACHNUMB ) ORDER BY BACHNUMB ASC, JRNENTRY ASC, SQNCLINE ASC, USERID ASC END ELSE IF @BACHNUMB_RS = @BACHNUMB_RE BEGIN SELECT TOP 25  BACHNUMB, JRNENTRY, SQNCLINE, INTERID, ACTINDX, USERID, TRXDATE, ORCRDAMT, DEX_ROW_ID FROM .B7100950 WHERE BACHNUMB = @BACHNUMB_RS AND JRNENTRY BETWEEN @JRNENTRY_RS AND @JRNENTRY_RE AND SQNCLINE BETWEEN @SQNCLINE_RS AND @SQNCLINE_RE AND USERID BETWEEN @USERID_RS AND @USERID_RE AND ( BACHNUMB = @BACHNUMB AND JRNENTRY = @JRNENTRY AND SQNCLINE = @SQNCLINE AND USERID > @USERID OR BACHNUMB = @BACHNUMB AND JRNENTRY = @JRNENTRY AND SQNCLINE > @SQNCLINE OR BACHNUMB = @BACHNUMB AND JRNENTRY > @JRNENTRY OR BACHNUMB > @BACHNUMB ) ORDER BY BACHNUMB ASC, JRNENTRY ASC, SQNCLINE ASC, USERID ASC END ELSE BEGIN SELECT TOP 25  BACHNUMB, JRNENTRY, SQNCLINE, INTERID, ACTINDX, USERID, TRXDATE, ORCRDAMT, DEX_ROW_ID FROM .B7100950 WHERE BACHNUMB BETWEEN @BACHNUMB_RS AND @BACHNUMB_RE AND JRNENTRY BETWEEN @JRNENTRY_RS AND @JRNENTRY_RE AND SQNCLINE BETWEEN @SQNCLINE_RS AND @SQNCLINE_RE AND USERID BETWEEN @USERID_RS AND @USERID_RE AND ( BACHNUMB = @BACHNUMB AND JRNENTRY = @JRNENTRY AND SQNCLINE = @SQNCLINE AND USERID > @USERID OR BACHNUMB = @BACHNUMB AND JRNENTRY = @JRNENTRY AND SQNCLINE > @SQNCLINE OR BACHNUMB = @BACHNUMB AND JRNENTRY > @JRNENTRY OR BACHNUMB > @BACHNUMB ) ORDER BY BACHNUMB ASC, JRNENTRY ASC, SQNCLINE ASC, USERID ASC END set nocount off 
GO
GRANT EXECUTE ON  [dbo].[zDP_B7100950N_1] TO [DYNGRP]
GO
