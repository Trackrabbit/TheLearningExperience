SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[glPeriodConsolidationUpdateTranslationHist]  @I_sYear smallint = NULL,  @I_dPeriodZeroDate datetime = NULL,  @I_iJournal_EntryBase int   = NULL,  @I_iJournal_EntryIFRS int   = NULL,  @I_iJournal_EntryLOCAL int   = NULL,  @I_cNext_Trx_Source char(13) = NULL,  @O_SQL_Error_State int   = NULL output  as  declare  @cBFSource varchar(255),  @cDBName char(5),  @iStatus int,  @iError int  if  @I_sYear is NULL or  @I_dPeriodZeroDate is NULL or  @I_iJournal_EntryBase is NULL or  @I_iJournal_EntryIFRS is NULL or  @I_iJournal_EntryLOCAL is NULL or  @I_cNext_Trx_Source is NULL  begin  select @O_SQL_Error_State = 20856  return  end   select @iStatus = 0,   @iError = 0 select @cDBName = db_name()  exec    @iStatus = DYNAMICS.dbo.smGetMsgString 12029, @cDBName, @cBFSource output, @O_SQL_Error_State output  select @iError = @@error if @iStatus = 0 and @iError <> 0  select @iStatus = @iError  if ( (@iStatus <> 0) or (@O_SQL_Error_State <> 0) )  return (@iStatus)  update GL30001 set Identity_Column = isnull(GL30000.DEX_ROW_ID, 0),  Original_Exchange_Rate = GL30000.XCHGRATE from GL30000 where GL30001.HSTYEAR = @I_sYear  and (GL30001.JRNENTRY = @I_iJournal_EntryBase or GL30001.JRNENTRY = @I_iJournal_EntryIFRS or GL30001.JRNENTRY = @I_iJournal_EntryLOCAL)  and GL30001.TRXDATE = @I_dPeriodZeroDate  and GL30001.SOURCDOC = @cBFSource  and GL30001.TRXSORCE = @I_cNext_Trx_Source  and GL30001.HSTYEAR = GL30000.HSTYEAR  and GL30001.ACTINDX = GL30000.ACTINDX  and GL30001.Ledger_ID = GL30000.Ledger_ID  and GL30001.CURNCYID = GL30000.CURNCYID   and GL30001.JRNENTRY = GL30000.JRNENTRY  and GL30001.TRXDATE = GL30000.TRXDATE  and GL30001.SEQNUMBR = GL30000.SEQNUMBR  return (@iStatus)   
GO
GRANT EXECUTE ON  [dbo].[glPeriodConsolidationUpdateTranslationHist] TO [DYNGRP]
GO
