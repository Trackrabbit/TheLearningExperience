SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE PROC [dbo].[zDP_WF30100N_1] (@BS int, @WorkflowInstanceID char(37), @WorkflowStepInstanceID char(37), @Workflow_History_User char(85), @Workflow_Completion_Date datetime, @Workflow_Completion_Time datetime, @Milliseconds smallint, @WorkflowInstanceID_RS char(37), @WorkflowStepInstanceID_RS char(37), @Workflow_History_User_RS char(85), @Workflow_Completion_Date_RS datetime, @Workflow_Completion_Time_RS datetime, @Milliseconds_RS smallint, @WorkflowInstanceID_RE char(37), @WorkflowStepInstanceID_RE char(37), @Workflow_History_User_RE char(85), @Workflow_Completion_Date_RE datetime, @Workflow_Completion_Time_RE datetime, @Milliseconds_RE smallint) AS /* 14.00.0084.000 */ set nocount on IF @WorkflowInstanceID_RS IS NULL BEGIN SELECT TOP 25  WorkflowInstanceID, WorkflowStepInstanceID, Workflow_History_User, Workflow_Name, Workflow_Step_Name, Workflow_Step_Assign_To, Workflow_Action, Workflow_Due_Date, Workflow_Due_Time, Workflow_Completion_Date, Workflow_Completion_Time, Milliseconds, DEX_ROW_ID, Workflow_Comments FROM .WF30100 WHERE ( WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND Workflow_History_User = @Workflow_History_User AND Workflow_Completion_Date = @Workflow_Completion_Date AND Workflow_Completion_Time = @Workflow_Completion_Time AND Milliseconds > @Milliseconds OR WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND Workflow_History_User = @Workflow_History_User AND Workflow_Completion_Date = @Workflow_Completion_Date AND Workflow_Completion_Time > @Workflow_Completion_Time OR WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND Workflow_History_User = @Workflow_History_User AND Workflow_Completion_Date > @Workflow_Completion_Date OR WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND Workflow_History_User > @Workflow_History_User OR WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID > @WorkflowStepInstanceID OR WorkflowInstanceID > @WorkflowInstanceID ) ORDER BY WorkflowInstanceID ASC, WorkflowStepInstanceID ASC, Workflow_History_User ASC, Workflow_Completion_Date ASC, Workflow_Completion_Time ASC, Milliseconds ASC END ELSE IF @WorkflowInstanceID_RS = @WorkflowInstanceID_RE BEGIN SELECT TOP 25  WorkflowInstanceID, WorkflowStepInstanceID, Workflow_History_User, Workflow_Name, Workflow_Step_Name, Workflow_Step_Assign_To, Workflow_Action, Workflow_Due_Date, Workflow_Due_Time, Workflow_Completion_Date, Workflow_Completion_Time, Milliseconds, DEX_ROW_ID, Workflow_Comments FROM .WF30100 WHERE WorkflowInstanceID = @WorkflowInstanceID_RS AND WorkflowStepInstanceID BETWEEN @WorkflowStepInstanceID_RS AND @WorkflowStepInstanceID_RE AND Workflow_History_User BETWEEN @Workflow_History_User_RS AND @Workflow_History_User_RE AND Workflow_Completion_Date BETWEEN @Workflow_Completion_Date_RS AND @Workflow_Completion_Date_RE AND Workflow_Completion_Time BETWEEN @Workflow_Completion_Time_RS AND @Workflow_Completion_Time_RE AND Milliseconds BETWEEN @Milliseconds_RS AND @Milliseconds_RE AND ( WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND Workflow_History_User = @Workflow_History_User AND Workflow_Completion_Date = @Workflow_Completion_Date AND Workflow_Completion_Time = @Workflow_Completion_Time AND Milliseconds > @Milliseconds OR WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND Workflow_History_User = @Workflow_History_User AND Workflow_Completion_Date = @Workflow_Completion_Date AND Workflow_Completion_Time > @Workflow_Completion_Time OR WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND Workflow_History_User = @Workflow_History_User AND Workflow_Completion_Date > @Workflow_Completion_Date OR WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND Workflow_History_User > @Workflow_History_User OR WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID > @WorkflowStepInstanceID OR WorkflowInstanceID > @WorkflowInstanceID ) ORDER BY WorkflowInstanceID ASC, WorkflowStepInstanceID ASC, Workflow_History_User ASC, Workflow_Completion_Date ASC, Workflow_Completion_Time ASC, Milliseconds ASC END ELSE BEGIN SELECT TOP 25  WorkflowInstanceID, WorkflowStepInstanceID, Workflow_History_User, Workflow_Name, Workflow_Step_Name, Workflow_Step_Assign_To, Workflow_Action, Workflow_Due_Date, Workflow_Due_Time, Workflow_Completion_Date, Workflow_Completion_Time, Milliseconds, DEX_ROW_ID, Workflow_Comments FROM .WF30100 WHERE WorkflowInstanceID BETWEEN @WorkflowInstanceID_RS AND @WorkflowInstanceID_RE AND WorkflowStepInstanceID BETWEEN @WorkflowStepInstanceID_RS AND @WorkflowStepInstanceID_RE AND Workflow_History_User BETWEEN @Workflow_History_User_RS AND @Workflow_History_User_RE AND Workflow_Completion_Date BETWEEN @Workflow_Completion_Date_RS AND @Workflow_Completion_Date_RE AND Workflow_Completion_Time BETWEEN @Workflow_Completion_Time_RS AND @Workflow_Completion_Time_RE AND Milliseconds BETWEEN @Milliseconds_RS AND @Milliseconds_RE AND ( WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND Workflow_History_User = @Workflow_History_User AND Workflow_Completion_Date = @Workflow_Completion_Date AND Workflow_Completion_Time = @Workflow_Completion_Time AND Milliseconds > @Milliseconds OR WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND Workflow_History_User = @Workflow_History_User AND Workflow_Completion_Date = @Workflow_Completion_Date AND Workflow_Completion_Time > @Workflow_Completion_Time OR WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND Workflow_History_User = @Workflow_History_User AND Workflow_Completion_Date > @Workflow_Completion_Date OR WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND Workflow_History_User > @Workflow_History_User OR WorkflowInstanceID = @WorkflowInstanceID AND WorkflowStepInstanceID > @WorkflowStepInstanceID OR WorkflowInstanceID > @WorkflowInstanceID ) ORDER BY WorkflowInstanceID ASC, WorkflowStepInstanceID ASC, Workflow_History_User ASC, Workflow_Completion_Date ASC, Workflow_Completion_Time ASC, Milliseconds ASC END set nocount off 
GO
GRANT EXECUTE ON  [dbo].[zDP_WF30100N_1] TO [DYNGRP]
GO
