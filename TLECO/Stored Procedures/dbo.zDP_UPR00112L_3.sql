SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_UPR00112L_3] (@GPA_RS char(5), @GPABASE_RS char(3), @GPA_RE char(5), @GPABASE_RE char(3)) AS  set nocount on IF @GPA_RS IS NULL BEGIN SELECT TOP 25  EMPLOYID, SEQNUMBR, UNIVERSITY, DEGREE, MAJOR, GPA, GPABASE, GRADUATIONYEAR, YEARS, NOTEINDX, CHANGEBY_I, CHANGEDATE_I, DEX_ROW_ID FROM .UPR00112 ORDER BY GPA DESC, GPABASE DESC, DEX_ROW_ID DESC END ELSE IF @GPA_RS = @GPA_RE BEGIN SELECT TOP 25  EMPLOYID, SEQNUMBR, UNIVERSITY, DEGREE, MAJOR, GPA, GPABASE, GRADUATIONYEAR, YEARS, NOTEINDX, CHANGEBY_I, CHANGEDATE_I, DEX_ROW_ID FROM .UPR00112 WHERE GPA = @GPA_RS AND GPABASE BETWEEN @GPABASE_RS AND @GPABASE_RE ORDER BY GPA DESC, GPABASE DESC, DEX_ROW_ID DESC END ELSE BEGIN SELECT TOP 25  EMPLOYID, SEQNUMBR, UNIVERSITY, DEGREE, MAJOR, GPA, GPABASE, GRADUATIONYEAR, YEARS, NOTEINDX, CHANGEBY_I, CHANGEDATE_I, DEX_ROW_ID FROM .UPR00112 WHERE GPA BETWEEN @GPA_RS AND @GPA_RE AND GPABASE BETWEEN @GPABASE_RS AND @GPABASE_RE ORDER BY GPA DESC, GPABASE DESC, DEX_ROW_ID DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_UPR00112L_3] TO [DYNGRP]
GO
