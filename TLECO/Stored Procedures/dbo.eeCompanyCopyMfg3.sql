SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyMfg3] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255), @DestCMPANYID smallint, @SourcCMPANYID smallint select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '', @DestCMPANYID = 0, @SourcCMPANYID = 0 select @DestCMPANYID = CMPANYID from DYNAMICS..SY01500 where INTERID = @I_vToCompany select @SourcCMPANYID = CMPANYID from DYNAMICS..SY01500 where INTERID = @I_vFromCompany if (@I_vData = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..MPSF1000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..MPSF1000 ( [PLANNAME_I],[LOCNCODE],[DEMANDFENCE] ) select [PLANNAME_I],[LOCNCODE],[DEMANDFENCE] from ' + rtrim(@I_vFromCompany) + '..MPSF1000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..MPUF0130' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..MPUF0130 ( [REPORTOPTION_I],[REPORTINDEX_I],[ASKECHTM],[INCLGNDS],[PRNTOFIL],[PRTOPRTR], [PRTOSCRN],[IFFILXST],[FILEXPNM],[EXPTTYPE],[STARTMCDESC_I],[STARTINSTDATE_I], [ENDMCDESC_I],[ENDINSTDATE_I],[SORTBY_I],[STTLOCCD],[ENLOCNCD],[STTITNUM], [ENITMNBR],[STARTBUYERID],[STARTPLANNERCODE_I],[ENDBUYERID],[ENDPLANNERCODE_I],[NETACROSSSITES_I], [CBXUSETEXTBUTTONS_I],[STVNDRID],[ENDVNDID],[STTUSRID],[ENDUSRID],[Start_Regen_Type], [End_Regen_Type],[STRTDATE],[ENDDATE],[DueDateFrom],[DueDateTo],[ReleaseFrom], [ReleaseTo],[Start_Counter],[End_Counter],[MRPQTYNUM_I],[MRPUSERNAME_I],[RSRCID] ) select [REPORTOPTION_I],[REPORTINDEX_I],[ASKECHTM],[INCLGNDS],[PRNTOFIL],[PRTOPRTR], [PRTOSCRN],[IFFILXST],[FILEXPNM],[EXPTTYPE],[STARTMCDESC_I],[STARTINSTDATE_I], [ENDMCDESC_I],[ENDINSTDATE_I],[SORTBY_I],[STTLOCCD],[ENLOCNCD],[STTITNUM], [ENITMNBR],[STARTBUYERID],[STARTPLANNERCODE_I],[ENDBUYERID],[ENDPLANNERCODE_I],[NETACROSSSITES_I], [CBXUSETEXTBUTTONS_I],[STVNDRID],[ENDVNDID],[STTUSRID],[ENDUSRID],[Start_Regen_Type], [End_Regen_Type],[STRTDATE],[ENDDATE],[DueDateFrom],[DueDateTo],[ReleaseFrom], [ReleaseTo],[Start_Counter],[End_Counter],[MRPQTYNUM_I],[MRPUSERNAME_I],[RSRCID] from ' + rtrim(@I_vFromCompany) + '..MPUF0130 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..MRP6060' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..MRP6060 ( [USERID],[QUERYNAME],[MRPQTYNUM_I],[STTITNUM],[ENITMNBR],[ITEMDESC], [STTITCLS],[ENITMCLS],[STTLOCCD],[ENLOCNCD],[STARTORDERNMBR],[ENDORDERNMBR], [STARTBUYERID],[ENDBUYERID],[STARTPLANNERID],[ENDPLANNERID],[STARTRELEASEDATE],[ENDRELEASEDATE], [STTDUEDT],[ENDDUEDT],[MRPQUERYIV_1],[MRPQUERYIV_2],[MRPQUERYIV_3],[MRPQUERYIV_4], [MRPQUERYPO_1],[MRPQUERYPO_2],[MRPQUERYPO_3],[MRPQUERYPO_4],[MRPQUERYSO_1],[MRPQUERYSO_2], [MRPQUERYSO_3],[MRPQUERYSO_4],[MRPQUERYSO_5],[MRPQUERYSO_6],[MRPQUERYSO_7],[MRPQUERYMO_1], [MRPQUERYMO_2],[MRPQUERYMO_3],[MRPQUERYMO_4],[MRPQUERYMO_5],[MRPQUERYMO_6],[MRPQUERYPK_1], [MRPQUERYPK_2],[MRPQUERYPK_3],[MRPQUERYPK_4],[MRPQUERYPK_5],[MRPQUERYPK_6],[MRPQUERYSUGGESTIONS_1], [MRPQUERYSUGGESTIONS_2],[MRPQUERYSUGGESTIONS_3],[MRPQUERYSUGGESTIONS_4],[MRPQUERYEXCEPTIONS_1],[MRPQUERYEXCEPTIONS_2],[MRPQUERYEXCEPTIONS_3], [MRPQUERYEXCEPTIONS_4],[MRPQUERYEXCEPTIONS_5],[MRPQUERYEXCEPTIONS_6],[MRPQUERYEXCEPTIONS_7],[MRPQUERYEXCEPTIONS_8],[MRPQUERYEXCEPTIONS_9], [MRPQUERYDUEDATE],[MRPQUERYRLSDATE] ) select [USERID],[QUERYNAME],[MRPQTYNUM_I],[STTITNUM],[ENITMNBR],[ITEMDESC], [STTITCLS],[ENITMCLS],[STTLOCCD],[ENLOCNCD],[STARTORDERNMBR],[ENDORDERNMBR], [STARTBUYERID],[ENDBUYERID],[STARTPLANNERID],[ENDPLANNERID],[STARTRELEASEDATE],[ENDRELEASEDATE], [STTDUEDT],[ENDDUEDT],[MRPQUERYIV_1],[MRPQUERYIV_2],[MRPQUERYIV_3],[MRPQUERYIV_4], [MRPQUERYPO_1],[MRPQUERYPO_2],[MRPQUERYPO_3],[MRPQUERYPO_4],[MRPQUERYSO_1],[MRPQUERYSO_2], [MRPQUERYSO_3],[MRPQUERYSO_4],[MRPQUERYSO_5],[MRPQUERYSO_6],[MRPQUERYSO_7],[MRPQUERYMO_1], [MRPQUERYMO_2],[MRPQUERYMO_3],[MRPQUERYMO_4],[MRPQUERYMO_5],[MRPQUERYMO_6],[MRPQUERYPK_1], [MRPQUERYPK_2],[MRPQUERYPK_3],[MRPQUERYPK_4],[MRPQUERYPK_5],[MRPQUERYPK_6],[MRPQUERYSUGGESTIONS_1], [MRPQUERYSUGGESTIONS_2],[MRPQUERYSUGGESTIONS_3],[MRPQUERYSUGGESTIONS_4],[MRPQUERYEXCEPTIONS_1],[MRPQUERYEXCEPTIONS_2],[MRPQUERYEXCEPTIONS_3], [MRPQUERYEXCEPTIONS_4],[MRPQUERYEXCEPTIONS_5],[MRPQUERYEXCEPTIONS_6],[MRPQUERYEXCEPTIONS_7],[MRPQUERYEXCEPTIONS_8],[MRPQUERYEXCEPTIONS_9], [MRPQUERYDUEDATE],[MRPQUERYRLSDATE] from ' + rtrim(@I_vFromCompany) + '..MRP6060 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..OC010000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..OC010000 ( [Option_Category],[DSCRIPTN],[MFGNOTEINDEX_I],[Item_Selection_Option],[CHANGEDATE_I],[USERID] ) select [Option_Category],[DSCRIPTN],[MFGNOTEINDEX_I],[Item_Selection_Option],[CHANGEDATE_I],[USERID] from ' + rtrim(@I_vFromCompany) + '..OC010000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..OC010100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..OC010100 ( [BASEUOFM],[Option_Category],[ITEMNMBR],[CB_I],[BOMCAT_I],[BOMNAME_I], [MINORQTY],[MAXIMUMORDQTY_I],[PRCLEVEL],[AVERAGEORDQTY_I],[MFGNOTEINDEX_I],[DEFAULT_ORD_QTY] ) select [BASEUOFM],[Option_Category],[ITEMNMBR],[CB_I],[BOMCAT_I],[BOMNAME_I], [MINORQTY],[MAXIMUMORDQTY_I],[PRCLEVEL],[AVERAGEORDQTY_I],[MFGNOTEINDEX_I],[DEFAULT_ORD_QTY] from ' + rtrim(@I_vFromCompany) + '..OC010100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..OC010200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..OC010200 ( [BOMCAT_I],[BOMNAME_I],[Option_Category],[Excluded_Category],[ITEMNMBR],[Exclude], [Excluded_BOM_Cat],[Excluded_BOM_Name],[Excluded_Item] ) select [BOMCAT_I],[BOMNAME_I],[Option_Category],[Excluded_Category],[ITEMNMBR],[Exclude], [Excluded_BOM_Cat],[Excluded_BOM_Name],[Excluded_Item] from ' + rtrim(@I_vFromCompany) + '..OC010200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..OC010300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..OC010300 ( [BOMCAT_I],[BOMNAME_I],[Option_Category],[ITEMNMBR],[Option_Include],[Included_BOM_Cat], [Included_BOM_Name],[Included_Item],[Included_Category] ) select [BOMCAT_I],[BOMNAME_I],[Option_Category],[ITEMNMBR],[Option_Include],[Included_BOM_Cat], [Included_BOM_Name],[Included_Item],[Included_Category] from ' + rtrim(@I_vFromCompany) + '..OC010300 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..OC010400' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..OC010400 ( [Option_Category],[ITEMNMBR],[BOMCAT_I],[BOMNAME_I],[PROMOTION_ID_I],[STRTDATE], [ENDDATE],[MRKDNAMT],[MRKDNPCT],[MRKDNTYP],[MFGNOTEINDEX_I],[CHANGEDATE_I], [USERID] ) select [Option_Category],[ITEMNMBR],[BOMCAT_I],[BOMNAME_I],[PROMOTION_ID_I],[STRTDATE], [ENDDATE],[MRKDNAMT],[MRKDNPCT],[MRKDNTYP],[MFGNOTEINDEX_I],[CHANGEDATE_I], [USERID] from ' + rtrim(@I_vFromCompany) + '..OC010400 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..OCUF0010' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..OCUF0010 ( [REPORTOPTION_I],[REPORTINDEX_I],[ASKECHTM],[SORTBY_I],[TEXTREPTS_I],[LEVEL_I], [STARTITEMNUM_I],[ENDITEMNUM_I],[INCLGNDS],[PRNTOFIL],[PRTOPRTR],[PRTOSCRN], [IFFILXST],[FILEXPNM],[EXPTTYPE],[Start_Option_Category],[End_Option_Category],[STARTBNAME_I], [ENDBNAME_I],[STARTEFFDATE_I],[ENDEFFDATE_I],[Start_Promotion_ID],[End_Promotion_ID],[RSRCID] ) select [REPORTOPTION_I],[REPORTINDEX_I],[ASKECHTM],[SORTBY_I],[TEXTREPTS_I],[LEVEL_I], [STARTITEMNUM_I],[ENDITEMNUM_I],[INCLGNDS],[PRNTOFIL],[PRTOPRTR],[PRTOSCRN], [IFFILXST],[FILEXPNM],[EXPTTYPE],[Start_Option_Category],[End_Option_Category],[STARTBNAME_I], [ENDBNAME_I],[STARTEFFDATE_I],[ENDEFFDATE_I],[Start_Promotion_ID],[End_Promotion_ID],[RSRCID] from ' + rtrim(@I_vFromCompany) + '..OCUF0010 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PC010000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PC010000 ( [PLANNERCODE_I],[PLANNERNAME] ) select [PLANNERCODE_I],[PLANNERNAME] from ' + rtrim(@I_vFromCompany) + '..PC010000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PFH10000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PFH10000 ( [KEYINT_I],[USERID] ) select [KEYINT_I],[USERID] from ' + rtrim(@I_vFromCompany) + '..PFH10000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PRPF0113' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PRPF0113 ( [CMPANYID],[USERID],[CONQUANTITIES_I],[CONSOLIDATERANGE_I],[ADJUSTFOREOQ_I],[ADJUSTFORLOTQTY_I], [AUTOSELPRISUP_I] ) select [CMPANYID],[USERID],[CONQUANTITIES_I],[CONSOLIDATERANGE_I],[ADJUSTFOREOQ_I],[ADJUSTFORLOTQTY_I], [AUTOSELPRISUP_I] from ' + rtrim(@I_vFromCompany) + '..PRPF0113 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..QA100032' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..QA100032 ( [Procedure_Number],[QAPROCREVLEVI],[QAPROCNAMI],[EFFECTIVEDATE_I] ) select [Procedure_Number],[QAPROCREVLEVI],[QAPROCNAMI],[EFFECTIVEDATE_I] from ' + rtrim(@I_vFromCompany) + '..QA100032 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..QA100132' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..QA100132 ( [Procedure_Number],[Procedure_stepnumber],[CHANGEDATE_I],[USERID],[Inspector_ID],[DWGNUM_I], [GB_Sample],[GB_Statistics],[GB_ExclusiveInclusive],[QAMEASSTRLHV],[QA_Test_Logical_DDL],[QA_Test_RHV], [QA_Test_RHV2],[Measurement_Type],[Measurement_Unit],[QATESTCONCI],[AQL_Table_Name],[LOTAQL_I], [MFGNOTEINDEX_I] ) select [Procedure_Number],[Procedure_stepnumber],[CHANGEDATE_I],[USERID],[Inspector_ID],[DWGNUM_I], [GB_Sample],[GB_Statistics],[GB_ExclusiveInclusive],[QAMEASSTRLHV],[QA_Test_Logical_DDL],[QA_Test_RHV], [QA_Test_RHV2],[Measurement_Type],[Measurement_Unit],[QATESTCONCI],[AQL_Table_Name],[LOTAQL_I], [MFGNOTEINDEX_I] from ' + rtrim(@I_vFromCompany) + '..QA100132 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..QA100232' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..QA100232 ( [Procedure_Number],[QAPROCREVLEVI],[QAPROCNAMI],[EFFECTIVEDATE_I] ) select [Procedure_Number],[QAPROCREVLEVI],[QAPROCNAMI],[EFFECTIVEDATE_I] from ' + rtrim(@I_vFromCompany) + '..QA100232 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..QA100332' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..QA100332 ( [Procedure_Number],[QAPROCREVLEVI],[Procedure_stepnumber],[CHANGEDATE_I],[USERID],[Inspector_ID], [DWGNUM_I],[GB_Sample],[GB_Statistics],[GB_ExclusiveInclusive],[QAMEASSTRLHV],[QA_Test_Logical_DDL], [QA_Test_RHV],[QA_Test_RHV2],[Measurement_Type],[Measurement_Unit],[QATESTCONCI],[AQL_Table_Name], [LOTAQL_I],[MFGNOTEINDEX_I] ) select [Procedure_Number],[QAPROCREVLEVI],[Procedure_stepnumber],[CHANGEDATE_I],[USERID],[Inspector_ID], [DWGNUM_I],[GB_Sample],[GB_Statistics],[GB_ExclusiveInclusive],[QAMEASSTRLHV],[QA_Test_Logical_DDL], [QA_Test_RHV],[QA_Test_RHV2],[Measurement_Type],[Measurement_Unit],[QATESTCONCI],[AQL_Table_Name], [LOTAQL_I],[MFGNOTEINDEX_I] from ' + rtrim(@I_vFromCompany) + '..QA100332 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..QA110132' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..QA110132 ( [AQL_Table_Name],[QALOTSIZE1],[QALOTSIZE2] ) select [AQL_Table_Name],[QALOTSIZE1],[QALOTSIZE2] from ' + rtrim(@I_vFromCompany) + '..QA110132 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..QA110232' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..QA110232 ( [AQL_Table_Name],[QALOTSIZE1],[QAAQLLevel],[QASAMPSIZEI],[QAACCEPTNO],[QAREJECTNUMI] ) select [AQL_Table_Name],[QALOTSIZE1],[QAAQLLevel],[QASAMPSIZEI],[QAACCEPTNO],[QAREJECTNUMI] from ' + rtrim(@I_vFromCompany) + '..QA110232 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..QA120032' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..QA120032 ( [Inspector_ID],[Inspector_Description],[CHANGEDATE_I],[USERID],[MFGNOTEINDEX_I] ) select [Inspector_ID],[Inspector_Description],[CHANGEDATE_I],[USERID],[MFGNOTEINDEX_I] from ' + rtrim(@I_vFromCompany) + '..QA120032 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..QA140032' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..QA140032 ( [defcode],[Defect_Code_Description],[CHANGEDATE_I],[USERID],[MFGNOTEINDEX_I] ) select [defcode],[Defect_Code_Description],[CHANGEDATE_I],[USERID],[MFGNOTEINDEX_I] from ' + rtrim(@I_vFromCompany) + '..QA140032 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..QA150032' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..QA150032 ( [Disposition_Code],[Disposition_Code_Descrip],[CHANGEDATE_I],[USERID],[MFGNOTEINDEX_I] ) select [Disposition_Code],[Disposition_Code_Descrip],[CHANGEDATE_I],[USERID],[MFGNOTEINDEX_I] from ' + rtrim(@I_vFromCompany) + '..QA150032 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..QA160032' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..QA160032 ( [ITEMNMBR],[Procedure_Number],[CHANGEDATE_I],[USERID],[MFGNOTEINDEX_I] ) select [ITEMNMBR],[Procedure_Number],[CHANGEDATE_I],[USERID],[MFGNOTEINDEX_I] from ' + rtrim(@I_vFromCompany) + '..QA160032 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..QADUF132' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..QADUF132 ( [REPORTOPTION_I],[REPORTINDEX_I],[ASKECHTM],[SORTBY_I],[TEXTREPTS_I],[LEVEL_I], [INCLGNDS],[PRNTOFIL],[PRTOPRTR],[PRTOSCRN],[IFFILXST],[FILEXPNM], [EXPTTYPE],[STRTDATE],[ENDDATE],[STARTDATEINSPECT],[ENDDATEINSPECT],[STARTDEFCOD], [ENDDEFCODE],[STARTDISPCOD],[ENDDISPCODE],[STARTINSPECT],[ENDINSPECT],[STTITNUM], [ENITMNBR],[STRPONUM],[ENDPONUM],[StartPOPRcptNum],[EndPOPRcptNum],[STVNDRID], [ENDVNDID],[Destroyed_in_Testing],[FLAGDESTRYTEST],[Passed_Inspection],[FLAGPASSEDINSP],[QACOMPLETED], [FLAGQACOMPLETE],[AQL_Table_Name],[STTDOCDT],[ENDDOCDT],[STRTORGNTOR],[ENDORGNTOR], [STARTEFFECTIVEDATE_I],[ENDEFFECTIVEDATE_I],[STTDUEDT],[ENDDUEDT],[STTPSTDT],[ENDPSTDT], [STTLOCCD],[ENLOCNCD],[STARTNSRNUMI],[ENDNSRNUMI],[STARTSCARNUMI],[ENDSCARNUMI], [RSRCID] ) select [REPORTOPTION_I],[REPORTINDEX_I],[ASKECHTM],[SORTBY_I],[TEXTREPTS_I],[LEVEL_I], [INCLGNDS],[PRNTOFIL],[PRTOPRTR],[PRTOSCRN],[IFFILXST],[FILEXPNM], [EXPTTYPE],[STRTDATE],[ENDDATE],[STARTDATEINSPECT],[ENDDATEINSPECT],[STARTDEFCOD], [ENDDEFCODE],[STARTDISPCOD],[ENDDISPCODE],[STARTINSPECT],[ENDINSPECT],[STTITNUM], [ENITMNBR],[STRPONUM],[ENDPONUM],[StartPOPRcptNum],[EndPOPRcptNum],[STVNDRID], [ENDVNDID],[Destroyed_in_Testing],[FLAGDESTRYTEST],[Passed_Inspection],[FLAGPASSEDINSP],[QACOMPLETED], [FLAGQACOMPLETE],[AQL_Table_Name],[STTDOCDT],[ENDDOCDT],[STRTORGNTOR],[ENDORGNTOR], [STARTEFFECTIVEDATE_I],[ENDEFFECTIVEDATE_I],[STTDUEDT],[ENDDUEDT],[STTPSTDT],[ENDPSTDT], [STTLOCCD],[ENLOCNCD],[STARTNSRNUMI],[ENDNSRNUMI],[STARTSCARNUMI],[ENDSCARNUMI], [RSRCID] from ' + rtrim(@I_vFromCompany) + '..QADUF132 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..QAPS0032' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..QAPS0032 ( [CMPANYID],[LOCNCODE],[nsrnum],[SCAR_Number] ) select [CMPANYID],[LOCNCODE],[nsrnum],[SCAR_Number] from ' + rtrim(@I_vFromCompany) + '..QAPS0032 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RT010001' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RT010001 ( [ROUTINGNAME_I],[ITEMNMBR],[RTPRIMARY_I],[REVISIONLEVEL_I],[RTSTATUSDDL_I],[NOTEINDX] ) select [ROUTINGNAME_I],[ITEMNMBR],[RTPRIMARY_I],[REVISIONLEVEL_I],[RTSTATUSDDL_I],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..RT010001 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RT010400' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RT010400 ( [RTGWCID_I],[WCALTERNATEPREFS_I],[WCIDALT_I],[OPCODE_I] ) select [RTGWCID_I],[WCALTERNATEPREFS_I],[WCIDALT_I],[OPCODE_I] from ' + rtrim(@I_vFromCompany) + '..RT010400 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RTH10100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RTH10100 ( [ITEMNMBR],[ROUTINGNAME_I],[QUEUETIME_I],[MACHINETIME_I],[RUNTIME_I],[LABORTIME_I], [SETUPTIME_I],[CYCLETIME_I],[MOVETIME_I] ) select [ITEMNMBR],[ROUTINGNAME_I],[QUEUETIME_I],[MACHINETIME_I],[RUNTIME_I],[LABORTIME_I], [SETUPTIME_I],[CYCLETIME_I],[MOVETIME_I] from ' + rtrim(@I_vFromCompany) + '..RTH10100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RTPS0130' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RTPS0130 ( [CMPANYID],[CBXCHECKFORLABELAR_I],[CBXCHECKFORLABLEPR_I],[CBXCHECKFORPOSAR_I],[CBXCHECKFORPOSPR_I],[CBXCHECKFORVALUAR_I], [CBXCHECKFORVALUPR_I],[CBXCONFIRMSAVEAR_I],[CBXCONFIRMSAVEPR_I],[CBXCOPYWCCOMMENTS_I],[CBXCOPYWCDESC_I],[CBXITEMNUMBER_I], [CBXROUTERNAME_I],[CBXUSEWCTEMPLATES_I],[CBXREPLACESEQDESCR_I],[CBXAPPENDEMPTY_I],[CBXMATCHWCIDAR_I],[CBXMATCHWCIDPR_I], [DEFAULTRTSEQNUM_I],[INCLUDENOTES],[NotesWithPO] ) select [CMPANYID],[CBXCHECKFORLABELAR_I],[CBXCHECKFORLABLEPR_I],[CBXCHECKFORPOSAR_I],[CBXCHECKFORPOSPR_I],[CBXCHECKFORVALUAR_I], [CBXCHECKFORVALUPR_I],[CBXCONFIRMSAVEAR_I],[CBXCONFIRMSAVEPR_I],[CBXCOPYWCCOMMENTS_I],[CBXCOPYWCDESC_I],[CBXITEMNUMBER_I], [CBXROUTERNAME_I],[CBXUSEWCTEMPLATES_I],[CBXREPLACESEQDESCR_I],[CBXAPPENDEMPTY_I],[CBXMATCHWCIDAR_I],[CBXMATCHWCIDPR_I], [DEFAULTRTSEQNUM_I],[INCLUDENOTES],[NotesWithPO] from ' + rtrim(@I_vFromCompany) + '..RTPS0130 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RTPU0130' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RTPU0130 ( [CMPANYID],[USERID],[CBXCHECKFORLABELAR_I],[CBXCHECKFORLABLEPR_I],[CBXCHECKFORPOSAR_I],[CBXCHECKFORPOSPR_I], [CBXCHECKFORVALUAR_I],[CBXCHECKFORVALUPR_I],[CBXCONFIRMSAVEAR_I],[CBXCONFIRMSAVEPR_I],[CBXCOPYWCCOMMENTS_I],[CBXCOPYWCDESC_I], [CBXITEMNUMBER_I],[CBXROUTERNAME_I],[CBXAPPENDEMPTY_I],[CBXREPLACESEQDESCR_I],[CBXUSEWCTEMPLATES_I],[CBXMATCHWCIDAR_I], [CBXMATCHWCIDPR_I],[DEFAULTRTSEQNUM_I] ) select [CMPANYID],[USERID],[CBXCHECKFORLABELAR_I],[CBXCHECKFORLABLEPR_I],[CBXCHECKFORPOSAR_I],[CBXCHECKFORPOSPR_I], [CBXCHECKFORVALUAR_I],[CBXCHECKFORVALUPR_I],[CBXCONFIRMSAVEAR_I],[CBXCONFIRMSAVEPR_I],[CBXCOPYWCCOMMENTS_I],[CBXCOPYWCDESC_I], [CBXITEMNUMBER_I],[CBXROUTERNAME_I],[CBXAPPENDEMPTY_I],[CBXREPLACESEQDESCR_I],[CBXUSEWCTEMPLATES_I],[CBXMATCHWCIDAR_I], [CBXMATCHWCIDPR_I],[DEFAULTRTSEQNUM_I] from ' + rtrim(@I_vFromCompany) + '..RTPU0130 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RTUF0130' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RTUF0130 ( [REPORTOPTION_I],[REPORTINDEX_I],[ASKECHTM],[INCLGNDS],[PRNTOFIL],[PRTOPRTR], [PRTOSCRN],[IFFILXST],[FILEXPNM],[EXPTTYPE],[STTITNUM],[ENITMNBR], [RTSEQNUMEND_I],[RTSEQNUMSTART_I],[ROUTINGNAMEEND_I],[ROUTINGNAMESTART_I],[STTLOCCD],[ENLOCNCD], [RTPRIMARY_I],[CBXUSETEXTBUTTONS_I],[SORTBY_I],[STR30DUMMY_I],[RSRCID] ) select [REPORTOPTION_I],[REPORTINDEX_I],[ASKECHTM],[INCLGNDS],[PRNTOFIL],[PRTOPRTR], [PRTOSCRN],[IFFILXST],[FILEXPNM],[EXPTTYPE],[STTITNUM],[ENITMNBR], [RTSEQNUMEND_I],[RTSEQNUMSTART_I],[ROUTINGNAMEEND_I],[ROUTINGNAMESTART_I],[STTLOCCD],[ENLOCNCD], [RTPRIMARY_I],[CBXUSETEXTBUTTONS_I],[SORTBY_I],[STR30DUMMY_I],[RSRCID] from ' + rtrim(@I_vFromCompany) + '..RTUF0130 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RTW20000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RTW20000 ( [ROUTINGNAME_I],[ITEMNMBR],[USERNAME] ) select [ROUTINGNAME_I],[ITEMNMBR],[USERNAME] from ' + rtrim(@I_vFromCompany) + '..RTW20000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SC020030' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SC020030 ( [PLANNAME_I],[USERID],[CHANGEDATE_I],[CHANGETIME_I],[PLANDESCRIPTION_I],[PLANFREQ_I], [PLANSPAN_I],[PLANSTARTDATE_I],[PLANENDDATE_I],[FORECASTSTARTDATE_I],[FORECASTENDDATE_I],[LOCNCODE], [MFGNOTEINDEX_I] ) select [PLANNAME_I],[USERID],[CHANGEDATE_I],[CHANGETIME_I],[PLANDESCRIPTION_I],[PLANFREQ_I], [PLANSPAN_I],[PLANSTARTDATE_I],[PLANENDDATE_I],[FORECASTSTARTDATE_I],[FORECASTENDDATE_I],[LOCNCODE], [MFGNOTEINDEX_I] from ' + rtrim(@I_vFromCompany) + '..SC020030 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SC020130' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SC020130 ( [PLANNAME_I],[SFLINEITEM_I],[ITEMNMBR],[LISTPRCE],[UNITCOST],[TOTALQTYTOFORECAST_I] ) select [PLANNAME_I],[SFLINEITEM_I],[ITEMNMBR],[LISTPRCE],[UNITCOST],[TOTALQTYTOFORECAST_I] from ' + rtrim(@I_vFromCompany) + '..SC020130 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SC020230' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SC020230 ( [PLANNAME_I],[SFLINEITEM_I],[DATE1],[QTYTORDR],[XTNDPRCE],[QTYTOFORECOST_I], [PLANSTARTDATE_I],[PLANENDDATE_I] ) select [PLANNAME_I],[SFLINEITEM_I],[DATE1],[QTYTORDR],[XTNDPRCE],[QTYTOFORECOST_I], [PLANSTARTDATE_I],[PLANENDDATE_I] from ' + rtrim(@I_vFromCompany) + '..SC020230 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SC020330' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SC020330 ( [PLANNAME_I],[CUSTNMBR] ) select [PLANNAME_I],[CUSTNMBR] from ' + rtrim(@I_vFromCompany) + '..SC020330 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SC020430' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SC020430 ( [PLANNAME_I],[SLPRSNID] ) select [PLANNAME_I],[SLPRSNID] from ' + rtrim(@I_vFromCompany) + '..SC020430 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SC020730' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SC020730 ( [PLANNAME_I],[SFLINEITEM_I],[DEMAND_PLANNER_I] ) select [PLANNAME_I],[SFLINEITEM_I],[DEMAND_PLANNER_I] from ' + rtrim(@I_vFromCompany) + '..SC020730 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SCSU0010' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SCSU0010 ( [SETUPKEY],[Display_Labor_and_Machin],[Display_Due_Date],[CHANGEDATE_I],[USERID],[Display_PromotionWarning] ) select [SETUPKEY],[Display_Labor_and_Machin],[Display_Due_Date],[CHANGEDATE_I],[USERID],[Display_PromotionWarning] from ' + rtrim(@I_vFromCompany) + '..SCSU0010 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SCUF0101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SCUF0101 ( [REPORTOPTION_I],[REPORTINDEX_I],[ASKECHTM],[SORTBY_I],[TEXTREPTS_I],[INCLGNDS], [PRNTOFIL],[PRTOPRTR],[PRTOSCRN],[IFFILXST],[FILEXPNM],[EXPTTYPE], [STARTPLANNAME_I],[ENDPLANNAME_I],[STPLANDESC_I],[ENDPLANDESCRIPTION_I],[STARTPLANSTARTDATE_I],[ENDPLANSTARTDATE_I], [STARTPLANSPAN_I],[ENDPLANSPAN_I],[STTUSRID],[ENDUSRID],[STTLOCCD],[ENLOCNCD], [STFORECASTSTDT_I],[ENDFORECASTSTDT_I],[SYSDATEPLUS_I],[SYSDATEMINUS_I],[RSRCID] ) select [REPORTOPTION_I],[REPORTINDEX_I],[ASKECHTM],[SORTBY_I],[TEXTREPTS_I],[INCLGNDS], [PRNTOFIL],[PRTOPRTR],[PRTOSCRN],[IFFILXST],[FILEXPNM],[EXPTTYPE], [STARTPLANNAME_I],[ENDPLANNAME_I],[STPLANDESC_I],[ENDPLANDESCRIPTION_I],[STARTPLANSTARTDATE_I],[ENDPLANSTARTDATE_I], [STARTPLANSPAN_I],[ENDPLANSPAN_I],[STTUSRID],[ENDUSRID],[STTLOCCD],[ENLOCNCD], [STFORECASTSTDT_I],[ENDFORECASTSTDT_I],[SYSDATEPLUS_I],[SYSDATEMINUS_I],[RSRCID] from ' + rtrim(@I_vFromCompany) + '..SCUF0101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SFUF0130' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SFUF0130 ( [REPORTINDEX_I],[REPORTOPTION_I],[SORTBY_I],[SORTBYNUMBER_I],[ASKECHTM],[INCLGNDS], [PRNTOFIL],[PRTOPRTR],[PRTOSCRN],[IFFILXST],[FILEXPNM],[EXPTTYPE], [MANORDERSTART_I],[MANORDEREND_I],[STTITNUM],[ENITMNBR],[STARTWCID_I],[ENDWCID_I], [STTEMPID],[ENDEMPL],[STRTMCID],[ENDMACID],[ROUTINGNAMESTART_I],[ROUTINGNAMEEND_I], [STRTDATE],[ENDDATE],[RTSEQNUMSTART_I],[RTSEQNUMEND_I],[STARTLABORCODE_I],[ENDLABORCODE_I], [STRTPYCD],[ENDPAYCD],[RSRCID] ) select [REPORTINDEX_I],[REPORTOPTION_I],[SORTBY_I],[SORTBYNUMBER_I],[ASKECHTM],[INCLGNDS], [PRNTOFIL],[PRTOPRTR],[PRTOSCRN],[IFFILXST],[FILEXPNM],[EXPTTYPE], [MANORDERSTART_I],[MANORDEREND_I],[STTITNUM],[ENITMNBR],[STARTWCID_I],[ENDWCID_I], [STTEMPID],[ENDEMPL],[STRTMCID],[ENDMACID],[ROUTINGNAMESTART_I],[ROUTINGNAMEEND_I], [STRTDATE],[ENDDATE],[RTSEQNUMSTART_I],[RTSEQNUMEND_I],[STARTLABORCODE_I],[ENDLABORCODE_I], [STRTPYCD],[ENDPAYCD],[RSRCID] from ' + rtrim(@I_vFromCompany) + '..SFUF0130 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SO030000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SO030000 ( [SOPFOB_I] ) select [SOPFOB_I] from ' + rtrim(@I_vFromCompany) + '..SO030000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SP010016' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SP010016 ( [SCHEDULINGPREFEREN_I],[APPSHRINKTOENDITEM_I],[APPSHRINKTORAWMAT_I],[MFGNOTEINDEX_I],[USERID],[CHANGEDATE_I], [DRAWFROMSITE_I],[POSTTOSITE_I],[DEFLTCLS],[Schedule_Start_QTY],[Delete_Configured_BOM],[Archive_Configured_BOM], [ICSS_Schedule_Firmed_MO],[ICSS_Schedule_QTY],[SCHEDULEMETHOD_I] ) select [SCHEDULINGPREFEREN_I],[APPSHRINKTOENDITEM_I],[APPSHRINKTORAWMAT_I],[MFGNOTEINDEX_I],[USERID],[CHANGEDATE_I], [DRAWFROMSITE_I],[POSTTOSITE_I],[DEFLTCLS],[Schedule_Start_QTY],[Delete_Configured_BOM],[Archive_Configured_BOM], [ICSS_Schedule_Firmed_MO],[ICSS_Schedule_QTY],[SCHEDULEMETHOD_I] from ' + rtrim(@I_vFromCompany) + '..SP010016 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SP010100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SP010100 ( [SCHEDULINGPREFEREN_I],[INDEX1],[STR30DUMMY_I] ) select [SCHEDULINGPREFEREN_I],[INDEX1],[STR30DUMMY_I] from ' + rtrim(@I_vFromCompany) + '..SP010100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..TARD1001' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..TARD1001 ( [PPN_I],[CPN_I],[BOMCAT_I],[BOMNAME_I],[SERLNMBR],[BOMSEQ_I], [POSITION_NUMBER] ) select [PPN_I],[CPN_I],[BOMCAT_I],[BOMNAME_I],[SERLNMBR],[BOMSEQ_I], [POSITION_NUMBER] from ' + rtrim(@I_vFromCompany) + '..TARD1001 ' exec(@cStatement) exec @iStatus = eeCompanyCopyMfg4 @I_vFromCompany,			 @I_vToCompany,				 @I_vData,					 @I_vReportOptions,			 @O_iErrorState output		 if ((@iStatus <> 0) or (@O_iErrorState <> 0)) begin select @O_iErrorState = 1  return (@O_iErrorState) end end return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyMfg3] TO [DYNGRP]
GO
