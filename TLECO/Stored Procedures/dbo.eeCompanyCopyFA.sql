SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyFA] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255), @DestCMPANYID smallint, @SourcCMPANYID smallint select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '', @DestCMPANYID = 0, @SourcCMPANYID = 0 select @DestCMPANYID = CMPANYID from DYNAMICS..SY01500 where INTERID = @I_vToCompany select @SourcCMPANYID = CMPANYID from DYNAMICS..SY01500 where INTERID = @I_vFromCompany if (@I_vData = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA00100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA00100 ( [ASSETINDEX],[ASSETID],[ASSETIDSUF],[SHRTNAME],[ASSETDESC],[EXTASSETDESC], [Master_Asset_ID],[STRUCTUREID],[ASSETCLASSID],[LOCATNID],[ACQDATE],[Acquisition_Cost], [ASSETTYPE],[ASSETSTATUS],[PROPTYPE],[ASSETQTY],[ASSETBEGQTY],[ASSETCURRMAINT], [ASSETYTDMAINT],[ASSETLTDMAINT],[LASTMAINTDATE],[ASSESSEDVALUE],[MFGRNAME],[SERLNMBR], [MODELNUMBER],[WARRENTYDATE],[CUSTODIAN],[NOTEINDX],[DATEADDED],[DELETEDATE], [Physical_Location_ID],[Asset_Label],[Verified_Date],[PIN],[LASTPURCHLINESEQ],[LASTMNTDDATE], [LASTMNTDTIME],[LASTMNTDUSERID],[aaAliasID] ) select [ASSETINDEX],[ASSETID],[ASSETIDSUF],[SHRTNAME],[ASSETDESC],[EXTASSETDESC], [Master_Asset_ID],[STRUCTUREID],[ASSETCLASSID],[LOCATNID],[ACQDATE],[Acquisition_Cost], [ASSETTYPE],[ASSETSTATUS],[PROPTYPE],[ASSETQTY],[ASSETBEGQTY],[ASSETCURRMAINT], [ASSETYTDMAINT],[ASSETLTDMAINT],[LASTMAINTDATE],[ASSESSEDVALUE],[MFGRNAME],[SERLNMBR], [MODELNUMBER],[WARRENTYDATE],[CUSTODIAN],[NOTEINDX],[DATEADDED],[DELETEDATE], [Physical_Location_ID],[Asset_Label],[Verified_Date],[PIN],[LASTPURCHLINESEQ],[LASTMNTDDATE], [LASTMNTDTIME],[LASTMNTDUSERID],[aaAliasID] from ' + rtrim(@I_vFromCompany) + '..FA00100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA00200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA00200 ( [ASSETINDEX],[BOOKINDX],[PLINSERVDATE],[DELETEDATE],[DEPRBEGDATE],[FULLYDEPRFLAG], [FULLYDEPRDATE],[ORIGINALLIFEYEARS],[ORIGINALLIFEDAYS],[REMAININGLIFEYEARS],[REMAININGLIFEDAYS],[DEPRTODATE], [LASTRECALCDATE],[LASTRECALCDATEFISYR],[BEGINYEARCOST],[BAGINSALVAGE],[BEGINRESERVE],[COSTBASIS], [SALVAGEVALUE],[DEPRECIATIONMETHOD],[AVERAGINGCONV],[SWITCHOVER],[SWITCHFM1METHOD],[SWITCHFM1AMOUNT], [SWITCHFM1DATE],[DLYDEPRRATE],[PERDEPRRATE],[YRLYDEPRRATE],[SAVEDLYDEPRRATE],[SAVEPERDEPRRATE], [SAVEYRLYDEPRRATE],[AMORTIZATIONCODE],[AMORTIZATIONAMOUNT],[CURRUNDEPRAMT],[PREVRUNDEPRAMT],[YTDDEPRAMT], [LTDDEPRAMT],[NETBOOKVALUE],[LUXAUTOIND],[PRORATEDRETDATE],[DEPRTODATEBFRET],[RECGAINLOSS], [NONRECGAINLOSS],[STLINEDEPRATRET],[COSTBFRETORDEL],[Initial_Allowance_Perc],[Initial_Allowance_Amount],[SPECDEPRALLOW], [SPECDEPRALLOWPCT],[SPECDEPRALLOWAMT],[NOTEINDX],[DATEADDED],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID],[LUXVANTRUCK],[LUXELAUTO] ) select [ASSETINDEX],[BOOKINDX],[PLINSERVDATE],[DELETEDATE],[DEPRBEGDATE],[FULLYDEPRFLAG], [FULLYDEPRDATE],[ORIGINALLIFEYEARS],[ORIGINALLIFEDAYS],[REMAININGLIFEYEARS],[REMAININGLIFEDAYS],[DEPRTODATE], [LASTRECALCDATE],[LASTRECALCDATEFISYR],[BEGINYEARCOST],[BAGINSALVAGE],[BEGINRESERVE],[COSTBASIS], [SALVAGEVALUE],[DEPRECIATIONMETHOD],[AVERAGINGCONV],[SWITCHOVER],[SWITCHFM1METHOD],[SWITCHFM1AMOUNT], [SWITCHFM1DATE],[DLYDEPRRATE],[PERDEPRRATE],[YRLYDEPRRATE],[SAVEDLYDEPRRATE],[SAVEPERDEPRRATE], [SAVEYRLYDEPRRATE],[AMORTIZATIONCODE],[AMORTIZATIONAMOUNT],[CURRUNDEPRAMT],[PREVRUNDEPRAMT],[YTDDEPRAMT], [LTDDEPRAMT],[NETBOOKVALUE],[LUXAUTOIND],[PRORATEDRETDATE],[DEPRTODATEBFRET],[RECGAINLOSS], [NONRECGAINLOSS],[STLINEDEPRATRET],[COSTBFRETORDEL],[Initial_Allowance_Perc],[Initial_Allowance_Amount],[SPECDEPRALLOW], [SPECDEPRALLOWPCT],[SPECDEPRALLOWAMT],[NOTEINDX],[DATEADDED],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID],[LUXVANTRUCK],[LUXELAUTO] from ' + rtrim(@I_vFromCompany) + '..FA00200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA00300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA00300 ( [ASSETINDEX],[BOOKINDX],[TEFRAFLAG],[ITCAMTTAKEN],[ITCAMTALLOWED],[ITCRECAPTURE], [ORGCOSTBASIS],[SECT179EXPDED],[ITCCODEREDAMT],[MISCCOSTADJ],[NETCOSTBASIS],[NOTEINDX], [LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] ) select [ASSETINDEX],[BOOKINDX],[TEFRAFLAG],[ITCAMTTAKEN],[ITCAMTALLOWED],[ITCRECAPTURE], [ORGCOSTBASIS],[SECT179EXPDED],[ITCCODEREDAMT],[MISCCOSTADJ],[NETCOSTBASIS],[NOTEINDX], [LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA00300 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA00400' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA00400 ( [ASSETINDEX],[DEPREXPACCTINDX],[DEPRRESVACCTINDX],[PRIORYRDEPRACCTINDX],[ASSETCOSTACCTINDX],[PROCEEDSACCTINDX], [RECGAINLOSSACCTINDX],[NONRECGAINLOSSACCTINDX],[CLEARINGACCTINDX],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] ) select [ASSETINDEX],[DEPREXPACCTINDX],[DEPRRESVACCTINDX],[PRIORYRDEPRACCTINDX],[ASSETCOSTACCTINDX],[PROCEEDSACCTINDX], [RECGAINLOSSACCTINDX],[NONRECGAINLOSSACCTINDX],[CLEARINGACCTINDX],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA00400 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA00500' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA00500 ( [ASSETINDEX],[LEASECOMPINDX],[LEASETYPE],[LEASECONTRACTID],[LEASEPAYMENT],[LEASEINTRATE], [LEASEENDDATE],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] ) select [ASSETINDEX],[LEASECOMPINDX],[LEASETYPE],[LEASECONTRACTID],[LEASEPAYMENT],[LEASEINTRATE], [LEASEENDDATE],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA00500 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA00600' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA00600 ( [ASSETINDEX],[INSCLASSINDX],[INSURANCEYEAR],[INSURANCEVALUE],[REPLACEMENTCOST],[REPROCOST], [DEPRREPROCOST],[EXCLUSIONAMT],[EXCLUSIONTYPE],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] ) select [ASSETINDEX],[INSCLASSINDX],[INSURANCEYEAR],[INSURANCEVALUE],[REPLACEMENTCOST],[REPROCOST], [DEPRREPROCOST],[EXCLUSIONAMT],[EXCLUSIONTYPE],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA00600 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA00902' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA00902 ( [FINANCIALINDX],[ASSETINDEX],[BOOKINDX],[FA_Doc_Number],[TRANSDATESTAMP],[TRANSTIMESTAMP], [FISCALYRADDED],[FAYEAR],[FAPERIOD],[DEPRFROMDATE],[DEPRTODATE],[AMOUNT], [TRANSUSERID],[SOURCDOC],[TRANSACCTTYPE],[INTERFACEGL],[GLINTTRXDATE],[GLINTDATESTAMP], [GLINTTIMESTAMP],[GLINTACCTINDX],[GLINTBTCHNUM],[FA_Reset_Offset_Index],[FA_Reset_User_ID],[FA_Reset_Date], [FA_Reset_Time],[Ledger_ID],[REFRENCE] ) select [FINANCIALINDX],[ASSETINDEX],[BOOKINDX],[FA_Doc_Number],[TRANSDATESTAMP],[TRANSTIMESTAMP], [FISCALYRADDED],[FAYEAR],[FAPERIOD],[DEPRFROMDATE],[DEPRTODATE],[AMOUNT], [TRANSUSERID],[SOURCDOC],[TRANSACCTTYPE],[INTERFACEGL],[GLINTTRXDATE],[GLINTDATESTAMP], [GLINTTIMESTAMP],[GLINTACCTINDX],[GLINTBTCHNUM],[FA_Reset_Offset_Index],[FA_Reset_User_ID],[FA_Reset_Date], [FA_Reset_Time],[Ledger_ID],[REFRENCE] from ' + rtrim(@I_vFromCompany) + '..FA00902 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA00904' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA00904 ( [FINANCIALINDX],[ASSETINDEX],[BOOKINDX],[FA_Doc_Number],[TRANSDATESTAMP],[TRANSTIMESTAMP], [FISCALYRADDED],[FAYEAR],[FAPERIOD],[DEPRFROMDATE],[DEPRTODATE],[AMOUNT], [TRANSUSERID],[SOURCDOC],[TRANSACCTTYPE],[INTERFACEGL],[GLINTTRXDATE],[GLINTDATESTAMP], [GLINTTIMESTAMP],[GLINTACCTINDX],[GLINTBTCHNUM],[FA_Reset_Offset_Index],[FA_Reset_User_ID],[FA_Reset_Date], [FA_Reset_Time],[Ledger_ID],[REFRENCE] ) select [FINANCIALINDX],[ASSETINDEX],[BOOKINDX],[FA_Doc_Number],[TRANSDATESTAMP],[TRANSTIMESTAMP], [FISCALYRADDED],[FAYEAR],[FAPERIOD],[DEPRFROMDATE],[DEPRTODATE],[AMOUNT], [TRANSUSERID],[SOURCDOC],[TRANSACCTTYPE],[INTERFACEGL],[GLINTTRXDATE],[GLINTDATESTAMP], [GLINTTIMESTAMP],[GLINTACCTINDX],[GLINTBTCHNUM],[FA_Reset_Offset_Index],[FA_Reset_User_ID],[FA_Reset_Date], [FA_Reset_Time],[Ledger_ID],[REFRENCE] from ' + rtrim(@I_vFromCompany) + '..FA00904 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA01100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA01100 ( [FA_AP_Post_Index],[MARKED],[FAPRIMARY],[CNTRLTYP],[APPLDAMT],[ORAPPAMT], [Purchased_Quantity],[Applied_Quantity],[ASSETID],[ASSETIDSUF],[SHRTNAME],[ASSETDESC], [EXTASSETDESC],[Master_Asset_ID],[STRUCTUREID],[ASSETCLASSID],[LOCATNID],[ACQDATE], [Acquisition_Cost],[Orig_Acquisition_Cost],[ASSETTYPE],[PROPTYPE],[ASSETQTY],[ASSETBEGQTY], [ASSETCURRMAINT],[ASSETYTDMAINT],[ASSETLTDMAINT],[LASTMAINTDATE],[ASSESSEDVALUE],[VENDORID], [DOCNUMBR],[DOCDATE],[TRXSORCE],[ORCTRNUM],[PORDNMBR],[PO_Line], [MFGRNAME],[SERLNMBR],[MODELNUMBER],[WARRENTYDATE],[CUSTODIAN],[DATEADDED], [DELETEDATE],[Physical_Location_ID],[Asset_Label],[Verified_Date],[PIN],[CURNCYID], [CURRNIDX],[XCHGRATE],[EXCHDATE],[TIME1],[EXGTBLID],[RATETPID], [RTCLCMTD],[DENXRATE],[MCTRXSTT],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] ) select [FA_AP_Post_Index],[MARKED],[FAPRIMARY],[CNTRLTYP],[APPLDAMT],[ORAPPAMT], [Purchased_Quantity],[Applied_Quantity],[ASSETID],[ASSETIDSUF],[SHRTNAME],[ASSETDESC], [EXTASSETDESC],[Master_Asset_ID],[STRUCTUREID],[ASSETCLASSID],[LOCATNID],[ACQDATE], [Acquisition_Cost],[Orig_Acquisition_Cost],[ASSETTYPE],[PROPTYPE],[ASSETQTY],[ASSETBEGQTY], [ASSETCURRMAINT],[ASSETYTDMAINT],[ASSETLTDMAINT],[LASTMAINTDATE],[ASSESSEDVALUE],[VENDORID], [DOCNUMBR],[DOCDATE],[TRXSORCE],[ORCTRNUM],[PORDNMBR],[PO_Line], [MFGRNAME],[SERLNMBR],[MODELNUMBER],[WARRENTYDATE],[CUSTODIAN],[DATEADDED], [DELETEDATE],[Physical_Location_ID],[Asset_Label],[Verified_Date],[PIN],[CURNCYID], [CURRNIDX],[XCHGRATE],[EXCHDATE],[TIME1],[EXGTBLID],[RATETPID], [RTCLCMTD],[DENXRATE],[MCTRXSTT],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA01100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA01400' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA01400 ( [ASSETINDEX],[PURCHLINESEQ],[PURCHDESC],[Acquisition_Cost],[Orig_Acquisition_Cost],[VENDORID], [DOCNUMBR],[DOCDATE],[TRXSORCE],[ORCTRNUM],[FA_AP_Post_Index],[PORDNMBR], [CURNCYID],[CURRNIDX],[XCHGRATE],[EXCHDATE],[TIME1],[EXGTBLID], [RATETPID],[RTCLCMTD],[DENXRATE],[MCTRXSTT],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] ) select [ASSETINDEX],[PURCHLINESEQ],[PURCHDESC],[Acquisition_Cost],[Orig_Acquisition_Cost],[VENDORID], [DOCNUMBR],[DOCDATE],[TRXSORCE],[ORCTRNUM],[FA_AP_Post_Index],[PORDNMBR], [CURNCYID],[CURRNIDX],[XCHGRATE],[EXCHDATE],[TIME1],[EXGTBLID], [RATETPID],[RTCLCMTD],[DENXRATE],[MCTRXSTT],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA01400 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA01401' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA01401 ( [ASSETINDEX],[PURCHLINESEQ],[PURCHDESC],[Acquisition_Cost],[Orig_Acquisition_Cost],[VENDORID], [DOCNUMBR],[DOCDATE],[TRXSORCE],[ORCTRNUM],[FA_AP_Post_Index],[PORDNMBR], [CURNCYID],[CURRNIDX],[XCHGRATE],[EXCHDATE],[TIME1],[EXGTBLID], [RATETPID],[RTCLCMTD],[DENXRATE],[MCTRXSTT],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] ) select [ASSETINDEX],[PURCHLINESEQ],[PURCHDESC],[Acquisition_Cost],[Orig_Acquisition_Cost],[VENDORID], [DOCNUMBR],[DOCDATE],[TRXSORCE],[ORCTRNUM],[FA_AP_Post_Index],[PORDNMBR], [CURNCYID],[CURRNIDX],[XCHGRATE],[EXCHDATE],[TIME1],[EXGTBLID], [RATETPID],[RTCLCMTD],[DENXRATE],[MCTRXSTT],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA01401 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA19900' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA19900 ( [ASSETINDEX],[USRFIELD1],[USRFIELD2],[USRFIELD3],[USRFIELD4],[USRFIELD5], [USRFIELD6],[USRFIELD7],[USRFIELD8],[USRFIELD9],[USRFIELD10],[USRFIELD11], [USRFIELD12],[USRFIELD13],[USRFIELD14],[USRFIELD15],[NOTEINDX],[LASTMNTDDATE], [LASTMNTDTIME],[LASTMNTDUSERID] ) select [ASSETINDEX],[USRFIELD1],[USRFIELD2],[USRFIELD3],[USRFIELD4],[USRFIELD5], [USRFIELD6],[USRFIELD7],[USRFIELD8],[USRFIELD9],[USRFIELD10],[USRFIELD11], [USRFIELD12],[USRFIELD13],[USRFIELD14],[USRFIELD15],[NOTEINDX],[LASTMNTDDATE], [LASTMNTDTIME],[LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA19900 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA40200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA40200 ( [BOOKINDX],[BOOKID],[BOOKDESC],[DEPRPERIOD],[CURRFISCALYR],[YEAR1], [Auto_Add_Book_Info],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID],[PTGENLED], [Ledger_ID],[CALNDRID] ) select [BOOKINDX],[BOOKID],[BOOKDESC],[DEPRPERIOD],[CURRFISCALYR],[YEAR1], [Auto_Add_Book_Info],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID],[PTGENLED], [Ledger_ID],[CALNDRID] from ' + rtrim(@I_vFromCompany) + '..FA40200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA40201' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA40201 ( [ASSETCLASSINDX],[ASSETCLASSID],[ASSETCLASSIDDESC],[DEFACCTGRPINDX],[DEFINSCLASSINDX],[NOTEINDX], [LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] ) select [ASSETCLASSINDX],[ASSETCLASSID],[ASSETCLASSIDDESC],[DEFACCTGRPINDX],[DEFINSCLASSINDX],[NOTEINDX], [LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA40201 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA40202' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA40202 ( [BOOKCLASSINDX],[BOOKID],[ASSETCLASSID],[EFFECTDATEBEGIN],[EFFECTDATEEND],[DEPRECIATIONMETHOD], [AVERAGINGCONV],[AMORTIZATIONCODE],[AMORTIZATIONAMOUNT],[ORIGINALLIFEYEARS],[ORIGINALLIFEDAYS],[SWITCHOVER], [SALVAGEEST],[SALVAGEPCT],[TEFRAFLAG],[LUXAUTOIND],[Initial_Allowance_Perc],[SPECDEPRALLOW], [SPECDEPRALLOWPCT],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID],[LUXVANTRUCK], [LUXELAUTO] ) select [BOOKCLASSINDX],[BOOKID],[ASSETCLASSID],[EFFECTDATEBEGIN],[EFFECTDATEEND],[DEPRECIATIONMETHOD], [AVERAGINGCONV],[AMORTIZATIONCODE],[AMORTIZATIONAMOUNT],[ORIGINALLIFEYEARS],[ORIGINALLIFEDAYS],[SWITCHOVER], [SALVAGEEST],[SALVAGEPCT],[TEFRAFLAG],[LUXAUTOIND],[Initial_Allowance_Perc],[SPECDEPRALLOW], [SPECDEPRALLOWPCT],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID],[LUXVANTRUCK], [LUXELAUTO] from ' + rtrim(@I_vFromCompany) + '..FA40202 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA40203' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA40203 ( [USERID],[BOOKINDX],[BOOKID] ) select [USERID],[BOOKINDX],[BOOKID] from ' + rtrim(@I_vFromCompany) + '..FA40203 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA40300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA40300 ( [USERID],[BOOKIDARRAY_1],[BOOKIDARRAY_2],[BOOKIDARRAY_3] ) select [USERID],[BOOKIDARRAY_1],[BOOKIDARRAY_2],[BOOKIDARRAY_3] from ' + rtrim(@I_vFromCompany) + '..FA40300 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA41000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA41000 ( [QUARTERINDX],[YEAR1],[QUARTERID],[QUARTERSTARTDATE],[QUARTERENDDATE],[QUARTERMIDDATE], [NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID],[CALNDRID] ) select [QUARTERINDX],[YEAR1],[QUARTERID],[QUARTERSTARTDATE],[QUARTERENDDATE],[QUARTERMIDDATE], [NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID],[CALNDRID] from ' + rtrim(@I_vFromCompany) + '..FA41000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA41100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA41100 ( [LOCATIONINDX],[LOCATNID],[STATEDESCR],[COUNTYDESCR],[CITYDESCR],[STATEABBREV], [STATECD],[COUNTYCODE],[CITYCODE],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] ) select [LOCATIONINDX],[LOCATNID],[STATEDESCR],[COUNTYDESCR],[CITYDESCR],[STATEABBREV], [STATECD],[COUNTYCODE],[CITYCODE],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA41100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA41200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA41200 ( [INSCLASSINDX],[INSCLASSID],[INSCLASSDESC],[INFLATIONRATEPCT],[DEPRRATEPCT],[NOTEINDX], [LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] ) select [INSCLASSINDX],[INSCLASSID],[INSCLASSDESC],[INFLATIONRATEPCT],[DEPRRATEPCT],[NOTEINDX], [LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA41200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA41300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA41300 ( [ACCTGRPINDEX],[ACCTGRPID],[ACCTGRPDESC],[DEPREXPACCTINDX],[DEPRRESVACCTINDX],[PRIORYRDEPRACCTINDX], [ASSETCOSTACCTINDX],[PROCEEDSACCTINDX],[RECGAINLOSSACCTINDX],[NONRECGAINLOSSACCTINDX],[CLEARINGACCTINDX],[NOTEINDX], [LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] ) select [ACCTGRPINDEX],[ACCTGRPID],[ACCTGRPDESC],[DEPREXPACCTINDX],[DEPRRESVACCTINDX],[PRIORYRDEPRACCTINDX], [ASSETCOSTACCTINDX],[PROCEEDSACCTINDX],[RECGAINLOSSACCTINDX],[NONRECGAINLOSSACCTINDX],[CLEARINGACCTINDX],[NOTEINDX], [LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA41300 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA41400' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA41400 ( [RETIREMENTCODE],[RETIRECODEDESCR],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] ) select [RETIREMENTCODE],[RETIRECODEDESCR],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA41400 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA41500' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA41500 ( [STRUCTUREINDX],[STRUCTUREID],[STRUCTDESCR],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] ) select [STRUCTUREINDX],[STRUCTUREID],[STRUCTDESCR],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA41500 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA41600' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA41600 ( [LEASECOMPINDX],[LEASECOMPID],[VENDORID],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] ) select [LEASECOMPINDX],[LEASECOMPID],[VENDORID],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA41600 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA42100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA42100 ( [PERIODSTARTDATE],[PERIODENDDATE],[PERIODID],[FISCALYEAR],[CALNDRID] ) select [PERIODSTARTDATE],[PERIODENDDATE],[PERIODID],[FISCALYEAR],[CALNDRID] from ' + rtrim(@I_vFromCompany) + '..FA42100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA42200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA42200 ( [ACTINDX],[ASSETCLASSID],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] ) select [ACTINDX],[ASSETCLASSID],[LASTMNTDDATE],[LASTMNTDTIME],[LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA42200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA42400' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA42400 ( [Physical_Location_Index],[Physical_Location_ID],[Physical_Location_Desc],[LOCATNID],[Last_Inventory_Date],[LASTMNTDDATE], [LASTMNTDTIME],[LASTMNTDUSERID] ) select [Physical_Location_Index],[Physical_Location_ID],[Physical_Location_Desc],[LOCATNID],[Last_Inventory_Date],[LASTMNTDDATE], [LASTMNTDTIME],[LASTMNTDUSERID] from ' + rtrim(@I_vFromCompany) + '..FA42400 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA42500' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA42500 ( [UserField],[TableValue] ) select [UserField],[TableValue] from ' + rtrim(@I_vFromCompany) + '..FA42500 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA42600' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA42600 ( [CALNDRID],[DESCRPTN] ) select [CALNDRID],[DESCRPTN] from ' + rtrim(@I_vFromCompany) + '..FA42600 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA49900' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA49900 ( [CMPANYID],[ORGSEGMENT],[ACCTSEGMENT],[PROJSEGMENT],[CORPBOOKINDX],[USERDATAAUTOFMT], [REQACCOUNT],[USRFLD1PROMPT],[USRFIELD1FMT],[USRFLD2PROMPT],[USRFIELD2FMT],[USRFLD3PROMPT], [USRFIELD3FMT],[USRFLD4PROMPT],[USRFIELD4FMT],[USRFLD5PROMPT],[USRFIELD5FMT],[USRFLD6PROMPT], [USRFIELD6FMT],[USRFLD7PROMPT],[USRFIELD7FMT],[USRFLD8PROMPT],[USRFIELD8FMT],[USRFLD9PROMPT], [USRFIELD9FMT],[USRFLD10PROMPT],[USRFIELD10FMT],[USRFLD11PROMPT],[USRFIELD11FMT],[USRFLD12PROMPT], [USRFIELD12FMT],[USRFLD13PROMPT],[USRFIELD13FMT],[USRFLD14PROMPT],[USRFIELD14FMT],[USRFLD15PROMPT], [USRFIELD15FMT],[ListValidValues_1],[ListValidValues_2],[ListValidValues_3],[ListValidValues_4],[ListValidValues_5], [ListValidValues_6],[ListValidValues_7],[ListValidValues_8],[ListValidValues_9],[ListValidValues_10],[ValidDate_1], [ValidDate_2],[ValidDate_3],[ValidDate_4],[Post_Table_Delete_Option],[PO_System_Used],[AP_Post_Option], [FA_Post_From_POP],[POP_Post_Option],[Include_Matching_Invoice],[FA_Country],[Auto_Add_Book_Info],[Deflt_Asset_Lbl_from_ID], [Validate_Custodian],[DEPREXPACCTINDX],[DEPRRESVACCTINDX],[PRIORYRDEPRACCTINDX],[ASSETCOSTACCTINDX],[PROCEEDSACCTINDX], [RECGAINLOSSACCTINDX],[NONRECGAINLOSSACCTINDX],[CLEARINGACCTINDX],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID],[FA_Allow_Reporting_Ledge],[FA_Reset_History_In_Deta],[POSTINDETAIL],[NXTASSETIDFLG],[NXTASSETID] ) select [CMPANYID],[ORGSEGMENT],[ACCTSEGMENT],[PROJSEGMENT],[CORPBOOKINDX],[USERDATAAUTOFMT], [REQACCOUNT],[USRFLD1PROMPT],[USRFIELD1FMT],[USRFLD2PROMPT],[USRFIELD2FMT],[USRFLD3PROMPT], [USRFIELD3FMT],[USRFLD4PROMPT],[USRFIELD4FMT],[USRFLD5PROMPT],[USRFIELD5FMT],[USRFLD6PROMPT], [USRFIELD6FMT],[USRFLD7PROMPT],[USRFIELD7FMT],[USRFLD8PROMPT],[USRFIELD8FMT],[USRFLD9PROMPT], [USRFIELD9FMT],[USRFLD10PROMPT],[USRFIELD10FMT],[USRFLD11PROMPT],[USRFIELD11FMT],[USRFLD12PROMPT], [USRFIELD12FMT],[USRFLD13PROMPT],[USRFIELD13FMT],[USRFLD14PROMPT],[USRFIELD14FMT],[USRFLD15PROMPT], [USRFIELD15FMT],[ListValidValues_1],[ListValidValues_2],[ListValidValues_3],[ListValidValues_4],[ListValidValues_5], [ListValidValues_6],[ListValidValues_7],[ListValidValues_8],[ListValidValues_9],[ListValidValues_10],[ValidDate_1], [ValidDate_2],[ValidDate_3],[ValidDate_4],[Post_Table_Delete_Option],[PO_System_Used],[AP_Post_Option], [FA_Post_From_POP],[POP_Post_Option],[Include_Matching_Invoice],[FA_Country],[Auto_Add_Book_Info],[Deflt_Asset_Lbl_from_ID], [Validate_Custodian],[DEPREXPACCTINDX],[DEPRRESVACCTINDX],[PRIORYRDEPRACCTINDX],[ASSETCOSTACCTINDX],[PROCEEDSACCTINDX], [RECGAINLOSSACCTINDX],[NONRECGAINLOSSACCTINDX],[CLEARINGACCTINDX],[NOTEINDX],[LASTMNTDDATE],[LASTMNTDTIME], [LASTMNTDUSERID],[FA_Allow_Reporting_Ledge],[FA_Reset_History_In_Deta],[POSTINDETAIL],[NXTASSETIDFLG],[NXTASSETID] from ' + rtrim(@I_vFromCompany) + '..FA49900 ' exec(@cStatement) end if (@I_vReportOptions = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA45000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA45000 ( [FILEXPNM],[EXPTTYPE],[ASKECHTM],[IFFILXST],[PRNTOFIL],[PRTOPRTR], [PRTOSCRN],[PRNTTYPE],[RPTGRIND],[RTPACHIN],[RTGRSBIN],[REPORTID], [FAREPTNAME],[SORTBY],[Sort_By_Value],[BOOKINDX],[BOOKID],[CURRFISCALYR], [Begin_Current_Fiscal_Yr],[End_Current_Fiscal_Year],[Second_Book_Index],[Second_Book_ID],[Current_Fiscal_Year_2],[Second_Begin_Current_FY], [Second_End_Current_FY],[ACTIVE],[RETIRED],[PARTIALOPEN],[Multicurrency_Information],[In_Detail], [Only_Not_Interfaced],[Start_Master_Asset_ID],[End_Master_Asset_ID],[Start_Asset_ID],[End_Asset_ID],[Start_Asset_ID_Suffix], [End_Asset_ID_Suffix],[Start_Asset_Description],[End_Asset_Description],[Start_Structure_ID],[End_Structure_ID],[STTCLSID], [ENDCLSID],[STTLOCID],[ENDLOCID],[Start_YTD_Depreciation],[End_YTD_Depreciation],[Start_LTD_Depreciation], [End_LTD_Depreciation],[Start_Net_Book_Value],[End_Net_Book_Value],[SSRCEDOC],[ENDSRCDC],[Start_GL_Account_Index], [End_GL_Account_Index],[Start_FA_Year],[End_FA_Year],[Start_FA_Period],[End_FA_Period],[Start_Property_Type], [End_Property_Type],[Start_Asset_Type],[End_Asset_Type],[Start_Asset_Quantity],[End_Asset_Quantity],[Start_Original_Life_Year], [End_Original_Life_Years],[Start_Original_Life_Days],[End_Original_Life_Days],[Start_Remaining_Life_Yea],[End_Remaining_Life_Years],[Start_Remaining_Life_Day], [End_Remaining_Life_Days],[Start_Depr_Method],[End_Depreciation_Method],[Start_Averaging_Conventi],[End_Averaging_Convention],[Start_Amortization_Code], [End_Amortization_Code],[Start_Retirement_Type],[End_Retirement_Type],[Start_Trx_Acct_Type],[End_Trx_Acct_Type],[Start_Cost_Basis], [End_Cost_Basis],[Start_Fiscal_Year_Added],[End_Fiscal_Year_Added],[Start_Place_in_Service],[End_Place_in_Service],[Start_PIS_Token], [End_PIS_Token],[Start_Acquisition_Date],[End_Acquisition_Date],[Start_Acq_Token],[End_Acq_Token],[Start_Date_Added], [End_Date_Added],[Start_Date_Added_Token],[End_Date_Added_Token],[Start_Fully_Depr_Date],[End_Fully_Depr_Date],[Start_Fully_DTD_Token], [End_Fully_DTD_Token],[Start_Retirement_Date],[End_Retirement_Date],[Start_Ret_Date_Token],[End_Ret_Date_Token],[Start_Transfer_Date], [End_Transfer_Date],[Start_Transfer_Date_Toke],[End_Transfer_Date_Token],[Start_Switchover_Date],[End_Switchover_Date],[Start_Switch_Date_Token], [End_Switch_Date_Token],[Start_GL_Intf_TRX_Date],[End_GL_Intf_TRX_Date],[Start_GL_Intf_Date_Token],[End_GL_Intf_Date_Token],[STBCHNUM], [ENDBNMBR],[FISCALYEAR],[PROJFROM],[PROJTO],[FA_Depreciation_As_Of],[FA_Depreciation_As_Of_Dt], [FA_Calc_With_Reset_Amts],[FA_Display_Reset_Amounts] ) select [FILEXPNM],[EXPTTYPE],[ASKECHTM],[IFFILXST],[PRNTOFIL],[PRTOPRTR], [PRTOSCRN],[PRNTTYPE],[RPTGRIND],[RTPACHIN],[RTGRSBIN],[REPORTID], [FAREPTNAME],[SORTBY],[Sort_By_Value],[BOOKINDX],[BOOKID],[CURRFISCALYR], [Begin_Current_Fiscal_Yr],[End_Current_Fiscal_Year],[Second_Book_Index],[Second_Book_ID],[Current_Fiscal_Year_2],[Second_Begin_Current_FY], [Second_End_Current_FY],[ACTIVE],[RETIRED],[PARTIALOPEN],[Multicurrency_Information],[In_Detail], [Only_Not_Interfaced],[Start_Master_Asset_ID],[End_Master_Asset_ID],[Start_Asset_ID],[End_Asset_ID],[Start_Asset_ID_Suffix], [End_Asset_ID_Suffix],[Start_Asset_Description],[End_Asset_Description],[Start_Structure_ID],[End_Structure_ID],[STTCLSID], [ENDCLSID],[STTLOCID],[ENDLOCID],[Start_YTD_Depreciation],[End_YTD_Depreciation],[Start_LTD_Depreciation], [End_LTD_Depreciation],[Start_Net_Book_Value],[End_Net_Book_Value],[SSRCEDOC],[ENDSRCDC],[Start_GL_Account_Index], [End_GL_Account_Index],[Start_FA_Year],[End_FA_Year],[Start_FA_Period],[End_FA_Period],[Start_Property_Type], [End_Property_Type],[Start_Asset_Type],[End_Asset_Type],[Start_Asset_Quantity],[End_Asset_Quantity],[Start_Original_Life_Year], [End_Original_Life_Years],[Start_Original_Life_Days],[End_Original_Life_Days],[Start_Remaining_Life_Yea],[End_Remaining_Life_Years],[Start_Remaining_Life_Day], [End_Remaining_Life_Days],[Start_Depr_Method],[End_Depreciation_Method],[Start_Averaging_Conventi],[End_Averaging_Convention],[Start_Amortization_Code], [End_Amortization_Code],[Start_Retirement_Type],[End_Retirement_Type],[Start_Trx_Acct_Type],[End_Trx_Acct_Type],[Start_Cost_Basis], [End_Cost_Basis],[Start_Fiscal_Year_Added],[End_Fiscal_Year_Added],[Start_Place_in_Service],[End_Place_in_Service],[Start_PIS_Token], [End_PIS_Token],[Start_Acquisition_Date],[End_Acquisition_Date],[Start_Acq_Token],[End_Acq_Token],[Start_Date_Added], [End_Date_Added],[Start_Date_Added_Token],[End_Date_Added_Token],[Start_Fully_Depr_Date],[End_Fully_Depr_Date],[Start_Fully_DTD_Token], [End_Fully_DTD_Token],[Start_Retirement_Date],[End_Retirement_Date],[Start_Ret_Date_Token],[End_Ret_Date_Token],[Start_Transfer_Date], [End_Transfer_Date],[Start_Transfer_Date_Toke],[End_Transfer_Date_Token],[Start_Switchover_Date],[End_Switchover_Date],[Start_Switch_Date_Token], [End_Switch_Date_Token],[Start_GL_Intf_TRX_Date],[End_GL_Intf_TRX_Date],[Start_GL_Intf_Date_Token],[End_GL_Intf_Date_Token],[STBCHNUM], [ENDBNMBR],[FISCALYEAR],[PROJFROM],[PROJTO],[FA_Depreciation_As_Of],[FA_Depreciation_As_Of_Dt], [FA_Calc_With_Reset_Amts],[FA_Display_Reset_Amounts] from ' + rtrim(@I_vFromCompany) + '..FA45000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..FA45100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..FA45100 ( [RTGRSBIN],[RTPACHIN],[RPTGRIND],[RPTGRNMS],[RTCFGWIN] ) select [RTGRSBIN],[RTPACHIN],[RPTGRIND],[RPTGRNMS],[RTCFGWIN] from ' + rtrim(@I_vFromCompany) + '..FA45100 ' exec(@cStatement) end select @cStatement = 'update ' + rtrim(@I_vToCompany) + '..FA49900 set CMPANYID = ' + cast(@DestCMPANYID as varchar) exec(@cStatement) return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyFA] TO [DYNGRP]
GO
