SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SVC00400N_4] (@BS int, @Rev_Level char(5), @DEX_ROW_ID int, @Rev_Level_RS char(5), @Rev_Level_RE char(5)) AS  set nocount on IF @Rev_Level_RS IS NULL BEGIN SELECT TOP 25  CONFGREF, DSCRIPTN, CUSTNMBR, ADRSCODE, Rev_Level, DEX_ROW_ID FROM .SVC00400 WHERE ( Rev_Level = @Rev_Level AND DEX_ROW_ID > @DEX_ROW_ID OR Rev_Level > @Rev_Level ) ORDER BY Rev_Level ASC, DEX_ROW_ID ASC END ELSE IF @Rev_Level_RS = @Rev_Level_RE BEGIN SELECT TOP 25  CONFGREF, DSCRIPTN, CUSTNMBR, ADRSCODE, Rev_Level, DEX_ROW_ID FROM .SVC00400 WHERE Rev_Level = @Rev_Level_RS AND ( Rev_Level = @Rev_Level AND DEX_ROW_ID > @DEX_ROW_ID OR Rev_Level > @Rev_Level ) ORDER BY Rev_Level ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  CONFGREF, DSCRIPTN, CUSTNMBR, ADRSCODE, Rev_Level, DEX_ROW_ID FROM .SVC00400 WHERE Rev_Level BETWEEN @Rev_Level_RS AND @Rev_Level_RE AND ( Rev_Level = @Rev_Level AND DEX_ROW_ID > @DEX_ROW_ID OR Rev_Level > @Rev_Level ) ORDER BY Rev_Level ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SVC00400N_4] TO [DYNGRP]
GO
