SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_PM00400F_1] (@CNTRLTYP_RS smallint, @CNTRLNUM_RS char(21), @CNTRLTYP_RE smallint, @CNTRLNUM_RE char(21)) AS  set nocount on IF @CNTRLTYP_RS IS NULL BEGIN SELECT TOP 25  CNTRLNUM, CNTRLTYP, DCSTATUS, DOCTYPE, VENDORID, DOCNUMBR, TRXSORCE, CHEKBKID, DUEDATE, DISCDATE, BCHSOURC, DOCDATE, USERID, DEX_ROW_ID FROM .PM00400 ORDER BY CNTRLTYP ASC, CNTRLNUM ASC END ELSE IF @CNTRLTYP_RS = @CNTRLTYP_RE BEGIN SELECT TOP 25  CNTRLNUM, CNTRLTYP, DCSTATUS, DOCTYPE, VENDORID, DOCNUMBR, TRXSORCE, CHEKBKID, DUEDATE, DISCDATE, BCHSOURC, DOCDATE, USERID, DEX_ROW_ID FROM .PM00400 WHERE CNTRLTYP = @CNTRLTYP_RS AND CNTRLNUM BETWEEN @CNTRLNUM_RS AND @CNTRLNUM_RE ORDER BY CNTRLTYP ASC, CNTRLNUM ASC END ELSE BEGIN SELECT TOP 25  CNTRLNUM, CNTRLTYP, DCSTATUS, DOCTYPE, VENDORID, DOCNUMBR, TRXSORCE, CHEKBKID, DUEDATE, DISCDATE, BCHSOURC, DOCDATE, USERID, DEX_ROW_ID FROM .PM00400 WHERE CNTRLTYP BETWEEN @CNTRLTYP_RS AND @CNTRLTYP_RE AND CNTRLNUM BETWEEN @CNTRLNUM_RS AND @CNTRLNUM_RE ORDER BY CNTRLTYP ASC, CNTRLNUM ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_PM00400F_1] TO [DYNGRP]
GO
