SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[glCommitPMGLTransactions]  @iPMPMatchTable varchar(50),  @iGLPMatchTable varchar(50),  @iPMUMatchTable varchar(50),  @iGLUMatchTable varchar(50)  AS  DECLARE  @lSQLError int  if SYSTEM_USER = 'sa'  begin  TRUNCATE TABLE PM50503  TRUNCATE TABLE PM50504  TRUNCATE TABLE GL50503  TRUNCATE TABLE GL50504  end else  begin  DELETE FROM PM50503  DELETE FROM PM50504  DELETE FROM GL50503  DELETE FROM GL50504  end  EXEC(  'insert into PM50503  select PSTGDATE,VENDORID,TRXSORCE,ORTRXSRC,VCHRNMBR,DOCNUMBR,STRVAL,TRX_ID,ACCTAMNT,CNTRLTYP from '+@iPMPMatchTable+' ') EXEC(  'insert into PM50504  select PSTGDATE,VENDORID,TRXSORCE,VCHRNMBR,DOCNUMBR,STRVAL,TRX_ID,ACCTAMNT,CNTRLTYP from '+@iPMUMatchTable+' ') EXEC(  'insert into GL50503  select TRXDATE,JRNENTRY,ORTRXSRC,ORCTRNUM,ACTINDX,DEBITAMT,CRDTAMNT,ACCTAMNT from '+@iGLPMatchTable+' ') EXEC(  'insert into GL50504  select TRXDATE,JRNENTRY,ORTRXSRC,ORCTRNUM,ACTINDX,DEBITAMT,CRDTAMNT from '+@iGLUMatchTable+' ')  RETURN (@lSQLError)    
GO
GRANT EXECUTE ON  [dbo].[glCommitPMGLTransactions] TO [DYNGRP]
GO
