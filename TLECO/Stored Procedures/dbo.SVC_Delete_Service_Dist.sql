SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[SVC_Delete_Service_Dist]  @srvrectype int ,  @callnbr varchar(11) ,  @EquipLine integer,  @Line integer,  @LineType char(3),  @CMPNTSEQ int = 0  as declare @DistType smallint declare @AccountIndex integer declare @CurrencyIndex smallint  if @Line = 0  BEGIN  delete from SVC00230  where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and POSTED = 0  delete from SVC00231  where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and POSTED = 0  return (0) END  select @DistType = SVC_Distribution_Type, @AccountIndex = ACTINDX,  @CurrencyIndex = CURRNIDX from SVC00231  where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and CMPNTSEQ = @CMPNTSEQ  and EQPLINE=@EquipLine and LNITMSEQ = @Line and LINITMTYP=@LineType and POSTED = 0  and SVC_Distribution_Type = 1  delete from SVC00231 where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and CMPNTSEQ = @CMPNTSEQ  and EQPLINE=@EquipLine and LNITMSEQ = @Line and LINITMTYP=@LineType and POSTED = 0  and SVC_Distribution_Type = 1 exec SVC_Set_Service_HDR_Dist @callnbr,@srvrectype,@DistType,@AccountIndex,0,@CurrencyIndex  select @DistType = SVC_Distribution_Type, @AccountIndex = ACTINDX,  @CurrencyIndex = CURRNIDX from SVC00231  where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and CMPNTSEQ = @CMPNTSEQ  and EQPLINE=@EquipLine and LNITMSEQ = @Line and LINITMTYP=@LineType and POSTED = 0  and SVC_Distribution_Type = 2 delete from SVC00231 where SRVRECTYPE = @srvrectype and CALLNBR = @callnbr and CMPNTSEQ = @CMPNTSEQ  and EQPLINE=@EquipLine and LNITMSEQ = @Line and LINITMTYP=@LineType and POSTED = 0  and SVC_Distribution_Type = 2 exec SVC_Set_Service_HDR_Dist @callnbr,@srvrectype,@DistType,@AccountIndex,0,@CurrencyIndex  return     
GO
GRANT EXECUTE ON  [dbo].[SVC_Delete_Service_Dist] TO [DYNGRP]
GO
