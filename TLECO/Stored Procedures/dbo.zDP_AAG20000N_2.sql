SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_AAG20000N_2] (@BS int, @SERIES smallint, @DOCTYPE smallint, @DOCNUMBR char(21), @Master_ID char(31), @PYRNTYPE smallint, @SERIES_RS smallint, @DOCTYPE_RS smallint, @DOCNUMBR_RS char(21), @Master_ID_RS char(31), @PYRNTYPE_RS smallint, @SERIES_RE smallint, @DOCTYPE_RE smallint, @DOCNUMBR_RE char(21), @Master_ID_RE char(31), @PYRNTYPE_RE smallint) AS  set nocount on IF @SERIES_RS IS NULL BEGIN SELECT TOP 25  aaSubLedgerHdrID, SERIES, DOCTYPE, DOCNUMBR, Master_ID, PYRNTYPE, aaHdrErrors, DEX_ROW_ID FROM .AAG20000 WHERE ( SERIES = @SERIES AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND Master_ID = @Master_ID AND PYRNTYPE > @PYRNTYPE OR SERIES = @SERIES AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND Master_ID > @Master_ID OR SERIES = @SERIES AND DOCTYPE = @DOCTYPE AND DOCNUMBR > @DOCNUMBR OR SERIES = @SERIES AND DOCTYPE > @DOCTYPE OR SERIES > @SERIES ) ORDER BY SERIES ASC, DOCTYPE ASC, DOCNUMBR ASC, Master_ID ASC, PYRNTYPE ASC END ELSE IF @SERIES_RS = @SERIES_RE BEGIN SELECT TOP 25  aaSubLedgerHdrID, SERIES, DOCTYPE, DOCNUMBR, Master_ID, PYRNTYPE, aaHdrErrors, DEX_ROW_ID FROM .AAG20000 WHERE SERIES = @SERIES_RS AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND DOCNUMBR BETWEEN @DOCNUMBR_RS AND @DOCNUMBR_RE AND Master_ID BETWEEN @Master_ID_RS AND @Master_ID_RE AND PYRNTYPE BETWEEN @PYRNTYPE_RS AND @PYRNTYPE_RE AND ( SERIES = @SERIES AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND Master_ID = @Master_ID AND PYRNTYPE > @PYRNTYPE OR SERIES = @SERIES AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND Master_ID > @Master_ID OR SERIES = @SERIES AND DOCTYPE = @DOCTYPE AND DOCNUMBR > @DOCNUMBR OR SERIES = @SERIES AND DOCTYPE > @DOCTYPE OR SERIES > @SERIES ) ORDER BY SERIES ASC, DOCTYPE ASC, DOCNUMBR ASC, Master_ID ASC, PYRNTYPE ASC END ELSE BEGIN SELECT TOP 25  aaSubLedgerHdrID, SERIES, DOCTYPE, DOCNUMBR, Master_ID, PYRNTYPE, aaHdrErrors, DEX_ROW_ID FROM .AAG20000 WHERE SERIES BETWEEN @SERIES_RS AND @SERIES_RE AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND DOCNUMBR BETWEEN @DOCNUMBR_RS AND @DOCNUMBR_RE AND Master_ID BETWEEN @Master_ID_RS AND @Master_ID_RE AND PYRNTYPE BETWEEN @PYRNTYPE_RS AND @PYRNTYPE_RE AND ( SERIES = @SERIES AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND Master_ID = @Master_ID AND PYRNTYPE > @PYRNTYPE OR SERIES = @SERIES AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND Master_ID > @Master_ID OR SERIES = @SERIES AND DOCTYPE = @DOCTYPE AND DOCNUMBR > @DOCNUMBR OR SERIES = @SERIES AND DOCTYPE > @DOCTYPE OR SERIES > @SERIES ) ORDER BY SERIES ASC, DOCTYPE ASC, DOCNUMBR ASC, Master_ID ASC, PYRNTYPE ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_AAG20000N_2] TO [DYNGRP]
GO
