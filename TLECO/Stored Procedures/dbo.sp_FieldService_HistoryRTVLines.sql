SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_FieldService_HistoryRTVLines] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @RTV_Number varchar(255), @RTV_Line varchar(255), @RTV_Type varchar(255), @RTV_Status varchar(255), @RTV_Return_Status varchar(255), @VRMA_document_ID varchar(255), @RMA_Number varchar(255), @Line_SEQ_Number varchar(255), @SVC_Process_SEQ_Number varchar(255), @Description varchar(255), @Reference varchar(255), @Reference2 varchar(255), @Item_Number varchar(255), @Item_Description varchar(255), @Item_Tracking_Option varchar(255), @Decimal_Places_QTYs varchar(255), @QTY varchar(255), @QTY_Shipped varchar(255), @QTY_To_Receive varchar(255), @QTY_Received varchar(255), @QTY_Canceled varchar(255), @U_Of_M varchar(255), @Vendor_ID varchar(255), @Vendor_Item_number varchar(255), @Return_Item_Number varchar(255), @Office_ID varchar(255), @Location_Code_Bad varchar(255), @Location_Code varchar(255), @Address_Code varchar(255), @Ship_Address_Name varchar(255), @Ship_Address_1 varchar(255), @Ship_Address_2 varchar(255), @Ship_Address_3 varchar(255), @Ship_City varchar(255), @Ship_State varchar(255), @Zip_Code varchar(255), @Ship_Country varchar(255), @Entry_Date varchar(255), @Entry_Time varchar(255), @Promised_Date varchar(255), @Promised_Time varchar(255), @Shipped_Date varchar(255), @Shipped_Time varchar(255), @Receipt_Date varchar(255), @Receipt_Time varchar(255), @Complete_Date varchar(255), @Complete_Time varchar(255), @Purchase_Order_Number varchar(255), @Purchase_Order_Line_SEQ varchar(255), @POP_Receipt_Number varchar(255), @Receipt_Line_Number varchar(255), @Transfer_Reference varchar(255), @Transfer_Line_Sequence varchar(255), @Service_Call_Number varchar(255), @Equipment_Line_Item_Sequence varchar(255), @Line_Item_Type varchar(255), @Line_Item_Sequence varchar(255), @Bill_of_Lading__OUT_ varchar(255), @Shipping_Method__OUT_ varchar(255), @Bill_of_Lading varchar(255), @Shipping_Method varchar(255), @Tracking_Number varchar(255), @Note_Index varchar(255), @Voucher_Number__WORK_ varchar(255), @Voucher_Number_Invoice varchar(255), @Voucher_Number_Reimbursement varchar(255), @Customer_Owned varchar(255), @User_Defined_1 varchar(255), @User_Defined_2 varchar(255), @User_Defined_3 varchar(255), @User_Defined_4 varchar(255), @User_Defined_5 varchar(255), @Part_Price varchar(255), @Part_Cost varchar(255), @Labor_Price varchar(255), @Labor_Cost varchar(255), @Expense_Price varchar(255), @Expense_Cost varchar(255), @Travel_Price varchar(255), @Travel_Cost varchar(255), @Originating_Part_Price varchar(255), @Originating_Part_Cost varchar(255), @Originating_Labor_Price varchar(255), @Originating_Labor_Cost varchar(255), @Originating_Expense_Price varchar(255), @Originating_Expense_Cost varchar(255), @Originating_Travel_Price varchar(255), @Originating_Travel_Cost varchar(255),  @DrillBack_Base_Url varchar(255), @DrillBack_Base_Url_For_FS varchar(255), @Item_Number_For_DrillBack varchar(255), @RTV_Number_For_DrillBack varchar(255), @Service_Call_Number_For_DrillBack varchar(255), @Vendor_ID_For_DrillBack varchar(255)  select @DrillBack_Base_Url = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),0) select @DrillBack_Base_Url_For_FS = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),949)  select @I_iDictID = 949 select @I_iMessageNumber = 30000 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @RTV_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 30001 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @RTV_Line output  select @I_iDictID = 949 select @I_iMessageNumber = 30002 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @RTV_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 30003 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @RTV_Status output  select @I_iDictID = 949 select @I_iMessageNumber = 30004 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @RTV_Return_Status output  select @I_iDictID = 949 select @I_iMessageNumber = 30005 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @VRMA_document_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 30006 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @RMA_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 30007 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Line_SEQ_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 30008 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Process_SEQ_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 30009 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Description output  select @I_iDictID = 949 select @I_iMessageNumber = 30010 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reference output  select @I_iDictID = 949 select @I_iMessageNumber = 30011 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reference2 output  select @I_iDictID = 949 select @I_iMessageNumber = 30012 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 30013 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Description output  select @I_iDictID = 949 select @I_iMessageNumber = 30014 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Tracking_Option output  select @I_iDictID = 949 select @I_iMessageNumber = 30015 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Decimal_Places_QTYs output  select @I_iDictID = 949 select @I_iMessageNumber = 30016 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY output  select @I_iDictID = 949 select @I_iMessageNumber = 30017 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY_Shipped output  select @I_iDictID = 949 select @I_iMessageNumber = 30018 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY_To_Receive output  select @I_iDictID = 949 select @I_iMessageNumber = 30019 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY_Received output  select @I_iDictID = 949 select @I_iMessageNumber = 30020 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY_Canceled output  select @I_iDictID = 949 select @I_iMessageNumber = 30021 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @U_Of_M output  select @I_iDictID = 949 select @I_iMessageNumber = 30022 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vendor_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 30023 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vendor_Item_number output  select @I_iDictID = 949 select @I_iMessageNumber = 30024 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Item_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 30025 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Office_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 30026 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Location_Code_Bad output  select @I_iDictID = 949 select @I_iMessageNumber = 30027 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Location_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 30028 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 30029 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ship_Address_Name output  select @I_iDictID = 949 select @I_iMessageNumber = 30030 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ship_Address_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 30031 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ship_Address_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 30032 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ship_Address_3 output  select @I_iDictID = 949 select @I_iMessageNumber = 30033 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ship_City output  select @I_iDictID = 949 select @I_iMessageNumber = 30034 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ship_State output  select @I_iDictID = 949 select @I_iMessageNumber = 30035 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Zip_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 30036 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ship_Country output  select @I_iDictID = 949 select @I_iMessageNumber = 30037 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Entry_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 30038 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Entry_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 30039 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Promised_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 30040 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Promised_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 30041 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Shipped_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 30042 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Shipped_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 30043 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receipt_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 30044 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receipt_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 30045 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Complete_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 30046 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Complete_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 30047 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purchase_Order_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 30048 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purchase_Order_Line_SEQ output  select @I_iDictID = 949 select @I_iMessageNumber = 30049 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @POP_Receipt_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 30050 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receipt_Line_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 30051 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Transfer_Reference output  select @I_iDictID = 949 select @I_iMessageNumber = 30052 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Transfer_Line_Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 30053 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Call_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 30054 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Equipment_Line_Item_Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 30055 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Line_Item_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 30056 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Line_Item_Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 30057 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Bill_of_Lading__OUT_ output  select @I_iDictID = 949 select @I_iMessageNumber = 30058 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Shipping_Method__OUT_ output  select @I_iDictID = 949 select @I_iMessageNumber = 30059 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Bill_of_Lading output  select @I_iDictID = 949 select @I_iMessageNumber = 30060 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Shipping_Method output  select @I_iDictID = 949 select @I_iMessageNumber = 30061 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tracking_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 30062 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Note_Index output  select @I_iDictID = 949 select @I_iMessageNumber = 30063 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Voucher_Number__WORK_ output  select @I_iDictID = 949 select @I_iMessageNumber = 30064 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Voucher_Number_Invoice output  select @I_iDictID = 949 select @I_iMessageNumber = 30065 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Voucher_Number_Reimbursement output  select @I_iDictID = 949 select @I_iMessageNumber = 30066 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_Owned output  select @I_iDictID = 949 select @I_iMessageNumber = 30067 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 30068 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 30069 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_3 output  select @I_iDictID = 949 select @I_iMessageNumber = 30070 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_4 output  select @I_iDictID = 949 select @I_iMessageNumber = 30071 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_5 output  select @I_iDictID = 949 select @I_iMessageNumber = 30072 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Part_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 30073 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Part_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 30074 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Labor_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 30075 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Labor_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 30076 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Expense_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 30077 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Expense_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 30078 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Travel_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 30079 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Travel_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 30080 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Part_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 30081 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Part_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 30082 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Labor_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 30083 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Labor_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 30084 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Expense_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 30085 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Expense_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 30086 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Travel_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 30087 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Travel_Cost output   select @I_iDictID = 949 select @I_iMessageNumber = 30022 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vendor_ID_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 30012 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 30000 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @RTV_Number_For_DrillBack output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[HistoryRTVLines]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[HistoryRTVLines] '  select @sqldefaultstring =   'CREATE VIEW HistoryRTVLines AS ' +   'select ' +   'rtrim([''SVC_RTV_Line_HIST''].[RTV_Number]) as ''' + @RTV_Number + ''', ' + '[''SVC_RTV_Line_HIST''].[RTV_Line] as ''' + @RTV_Line + ''', ' + 'rtrim([''SVC_RTV_Line_HIST''].[RTV_Type]) as ''' + @RTV_Type + ''', ' + '''' + @RTV_Status + ''' = dbo.FS_FUNC_RTV_Status([''SVC_RTV_Line_HIST''].[RTV_Status]), ' + 'rtrim([''SVC_RTV_Line_HIST''].[RTV_Return_Status]) as ''' + @RTV_Return_Status + ''', ' + 'rtrim([''SVC_RTV_Line_HIST''].[DSCRIPTN]) as ''' + @Description + ''', ' + 'rtrim([''SVC_RTV_Line_HIST''].[ITEMNMBR]) as ''' + @Item_Number + ''', ' + 'rtrim([''SVC_RTV_Line_HIST''].[ITEMDESC]) as ''' + @Item_Description + ''', ' + '[''SVC_RTV_Line_HIST''].[QUANTITY] as ''' + @QTY + ''', ' + '[''SVC_RTV_Line_HIST''].[QTYSHPPD] as ''' + @QTY_Shipped + ''', ' + '[''SVC_RTV_Line_HIST''].[QTYRECVD] as ''' + @QTY_Received + ''', ' + 'rtrim([''SVC_RTV_Line_HIST''].[UOFM]) as ''' + @U_Of_M + ''', ' + 'rtrim([''SVC_RTV_Line_HIST''].[VENDORID]) as ''' + @Vendor_ID + ''', ' + 'rtrim([''SVC_RTV_Line_HIST''].[VNDITNUM]) as ''' + @Vendor_Item_number + ''', ' + 'rtrim([''SVC_RTV_Line_HIST''].[Return_Item_Number]) as ''' + @Return_Item_Number + ''', ' + 'rtrim([''SVC_RTV_Line_HIST''].[LOCCODEB]) as ''' + @Location_Code_Bad + ''', ' + 'rtrim([''SVC_RTV_Line_HIST''].[LOCNCODE]) as ''' + @Location_Code + ''', ' + 'rtrim([''SVC_RTV_Line_HIST''].[ADRSCODE]) as ''' + @Address_Code + ''', ' + '[''SVC_RTV_Line_HIST''].[ENTDTE] as ''' + @Entry_Date + ''', ' + '[''SVC_RTV_Line_HIST''].[Shipped_Date] as ''' + @Shipped_Date + ''', ' + '[''SVC_RTV_Line_HIST''].[COMPDTE] as ''' + @Complete_Date + ''', '   select @sqlstring1 =   'rtrim([''SVC_RTV_Line_HIST''].[Bill_of_Lading]) as ''' + @Bill_of_Lading + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Bill_of_Lading_Out]) as ''' + @Bill_of_Lading__OUT_ + ''', ' +  '[''SVC_RTV_Line_HIST''].[COMPTME] as ''' + @Complete_Time + ''', ' +  '''' + @Customer_Owned + ''' = dbo.DYN_FUNC_Boolean_All([''SVC_RTV_Line_HIST''].[CUSTOWN]), ' +  '''' + @Decimal_Places_QTYs + ''' = dbo.DYN_FUNC_Decimal_Places_QTYS([''SVC_RTV_Line_HIST''].[DECPLQTY]), ' +  '[''SVC_RTV_Line_HIST''].[ENTTME] as ''' + @Entry_Time + ''', ' +  '[''SVC_RTV_Line_HIST''].[EQPLINE] as ''' + @Equipment_Line_Item_Sequence + ''', ' +  '[''SVC_RTV_Line_HIST''].[Expense_Cost] as ''' + @Expense_Cost + ''', ' +  '[''SVC_RTV_Line_HIST''].[Expense_Price] as ''' + @Expense_Price + ''', ' +  '''' + @Item_Tracking_Option + ''' = dbo.DYN_FUNC_Item_Tracking_Option([''SVC_RTV_Line_HIST''].[ITMTRKOP]), ' +  '[''SVC_RTV_Line_HIST''].[Labor_Cost] as ''' + @Labor_Cost + ''', ' +  '[''SVC_RTV_Line_HIST''].[Labor_Price] as ''' + @Labor_Price + ''', ' +  '[''SVC_RTV_Line_HIST''].[LNITMSEQ] as ''' + @Line_Item_Sequence + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[LINITMTYP]) as ''' + @Line_Item_Type + ''', ' +  '[''SVC_RTV_Line_HIST''].[LNSEQNBR] as ''' + @Line_SEQ_Number + ''', ' +  '[''SVC_RTV_Line_HIST''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[OFFID]) as ''' + @Office_ID + ''', ' +  '[''SVC_RTV_Line_HIST''].[Originating_Expense_Cost] as ''' + @Originating_Expense_Cost + ''', ' +  '[''SVC_RTV_Line_HIST''].[Originating_ExpensePrice] as ''' + @Originating_Expense_Price + ''', ' +  '[''SVC_RTV_Line_HIST''].[Originating_Labor_Cost] as ''' + @Originating_Labor_Cost + ''', ' +  '[''SVC_RTV_Line_HIST''].[Originating_Labor_Price] as ''' + @Originating_Labor_Price + ''', ' +  '[''SVC_RTV_Line_HIST''].[Originating_Part_Cost] as ''' + @Originating_Part_Cost + ''', ' +  '[''SVC_RTV_Line_HIST''].[Originating_Part_Price] as ''' + @Originating_Part_Price + ''', ' +  '[''SVC_RTV_Line_HIST''].[Originating_Travel_Cost] as ''' + @Originating_Travel_Cost + ''', ' +  '[''SVC_RTV_Line_HIST''].[Originating_Travel_Price] as ''' + @Originating_Travel_Price + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[POPRCTNM]) as ''' + @POP_Receipt_Number + ''', ' +  '[''SVC_RTV_Line_HIST''].[Part_Cost] as ''' + @Part_Cost + ''', ' +  '[''SVC_RTV_Line_HIST''].[Part_Price] as ''' + @Part_Price + ''', ' +  '[''SVC_RTV_Line_HIST''].[PRMDATE] as ''' + @Promised_Date + ''', ' +  '[''SVC_RTV_Line_HIST''].[Promised_Time] as ''' + @Promised_Time + ''', ' +  '[''SVC_RTV_Line_HIST''].[POLNSEQ] as ''' + @Purchase_Order_Line_SEQ + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[PONMBRSTR]) as ''' + @Purchase_Order_Number + ''', ' +  '[''SVC_RTV_Line_HIST''].[QTYCANCE] as ''' + @QTY_Canceled + ''', ' +  '[''SVC_RTV_Line_HIST''].[QTY_To_Receive] as ''' + @QTY_To_Receive + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[RETDOCID]) as ''' + @RMA_Number + ''', ' +  '[''SVC_RTV_Line_HIST''].[receiptdate] as ''' + @Receipt_Date + ''', ' +  '[''SVC_RTV_Line_HIST''].[RCPTLNNM] as ''' + @Receipt_Line_Number + ''', ' +  '[''SVC_RTV_Line_HIST''].[Receipt_Time] as ''' + @Receipt_Time + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[REFRENCE]) as ''' + @Reference + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Reference2]) as ''' + @Reference2 + ''', ' +  '[''SVC_RTV_Line_HIST''].[SVC_Process_SEQ_Number] as ''' + @SVC_Process_SEQ_Number + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[CALLNBR]) as ''' + @Service_Call_Number + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Ship_Address_1]) as ''' + @Ship_Address_1 + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Ship_Address_2]) as ''' + @Ship_Address_2 + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Ship_Address_3]) as ''' + @Ship_Address_3 + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Ship_Address_Name]) as ''' + @Ship_Address_Name + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Ship_City]) as ''' + @Ship_City + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Ship_Country]) as ''' + @Ship_Country + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Ship_State]) as ''' + @Ship_State + ''', ' +  '[''SVC_RTV_Line_HIST''].[Shipped_Time] as ''' + @Shipped_Time + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[SHIPMTHD]) as ''' + @Shipping_Method + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Shipping_Method_Out]) as ''' + @Shipping_Method__OUT_ + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Tracking_Number]) as ''' + @Tracking_Number + ''', ' +  '[''SVC_RTV_Line_HIST''].[TRANSLINESEQ] as ''' + @Transfer_Line_Sequence + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Transfer_Reference]) as ''' + @Transfer_Reference + ''', ' +  '[''SVC_RTV_Line_HIST''].[Travel_Cost] as ''' + @Travel_Cost + ''', ' +  '[''SVC_RTV_Line_HIST''].[Travel_Price] as ''' + @Travel_Price + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[USERDEF1]) as ''' + @User_Defined_1 + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[USERDEF2]) as ''' + @User_Defined_2 + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[USRDEF03]) as ''' + @User_Defined_3 + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[USRDEF04]) as ''' + @User_Defined_4 + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[USRDEF05]) as ''' + @User_Defined_5 + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[VRMA_Document_ID]) as ''' + @VRMA_document_ID + ''', '   select @sqlstring2 =   'rtrim([''SVC_RTV_Line_HIST''].[Voucher_Number_Invoice]) as ''' + @Voucher_Number_Invoice + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[Voucher_Number_Reimburse]) as ''' + @Voucher_Number_Reimbursement + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[VCHNUMWK]) as ''' + @Voucher_Number__WORK_ + ''', ' +  'rtrim([''SVC_RTV_Line_HIST''].[ZIPCODE]) as ''' + @Zip_Code + ''', '   select @sqlstring3 =  '''' + @Item_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppItemID(1,[''SVC_RTV_Line_HIST''].[ITEMNMBR],'''' ), '+ '''' + @RTV_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url_For_FS + ''' +dbo.dgppRTVNumber(1,[''SVC_RTV_Line_HIST''].[RTV_Number],[''SVC_RTV_Line_HIST''].[RTV_Type] ), '+ '''' + @Vendor_ID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppVendorID(1,[''SVC_RTV_Line_HIST''].[VENDORID] ) '  select @sqljoinstring =   'from [SVC35601] as [''SVC_RTV_Line_HIST''] with (NOLOCK) '   select @sqlaccessstring =   'GRANT SELECT ON [dbo].[HistoryRTVLines] TO [rpt_dispatcher]' + 'GRANT SELECT ON [dbo].[HistoryRTVLines] TO [rpt_executive]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_FieldService_HistoryRTVLines] TO [DYNGRP]
GO
