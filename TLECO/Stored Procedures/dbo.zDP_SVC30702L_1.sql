SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SVC30702L_1] (@ORDDOCID_RS char(15), @TRANSLINESEQ_RS int, @SLTSQNUM_RS int, @ORDDOCID_RE char(15), @TRANSLINESEQ_RE int, @SLTSQNUM_RE int) AS  set nocount on IF @ORDDOCID_RS IS NULL BEGIN SELECT TOP 25  ORDDOCID, TRANSLINESEQ, SRVRECTYPE, CALLNBR, EQPLINE, LINITMTYP, LNITMSEQ, QTYTYPE, SERLTNUM, SERLTQTY, SLTSQNUM, DATERECD, DTSEQNUM, UNITCOST, ITEMNMBR, TRXSORCE, POSTED, OVRSERLT, STATUS, FROMBIN, TOBIN, MFGDATE, EXPNDATE, DEX_ROW_ID FROM .SVC30702 ORDER BY ORDDOCID DESC, TRANSLINESEQ DESC, SLTSQNUM DESC END ELSE IF @ORDDOCID_RS = @ORDDOCID_RE BEGIN SELECT TOP 25  ORDDOCID, TRANSLINESEQ, SRVRECTYPE, CALLNBR, EQPLINE, LINITMTYP, LNITMSEQ, QTYTYPE, SERLTNUM, SERLTQTY, SLTSQNUM, DATERECD, DTSEQNUM, UNITCOST, ITEMNMBR, TRXSORCE, POSTED, OVRSERLT, STATUS, FROMBIN, TOBIN, MFGDATE, EXPNDATE, DEX_ROW_ID FROM .SVC30702 WHERE ORDDOCID = @ORDDOCID_RS AND TRANSLINESEQ BETWEEN @TRANSLINESEQ_RS AND @TRANSLINESEQ_RE AND SLTSQNUM BETWEEN @SLTSQNUM_RS AND @SLTSQNUM_RE ORDER BY ORDDOCID DESC, TRANSLINESEQ DESC, SLTSQNUM DESC END ELSE BEGIN SELECT TOP 25  ORDDOCID, TRANSLINESEQ, SRVRECTYPE, CALLNBR, EQPLINE, LINITMTYP, LNITMSEQ, QTYTYPE, SERLTNUM, SERLTQTY, SLTSQNUM, DATERECD, DTSEQNUM, UNITCOST, ITEMNMBR, TRXSORCE, POSTED, OVRSERLT, STATUS, FROMBIN, TOBIN, MFGDATE, EXPNDATE, DEX_ROW_ID FROM .SVC30702 WHERE ORDDOCID BETWEEN @ORDDOCID_RS AND @ORDDOCID_RE AND TRANSLINESEQ BETWEEN @TRANSLINESEQ_RS AND @TRANSLINESEQ_RE AND SLTSQNUM BETWEEN @SLTSQNUM_RS AND @SLTSQNUM_RE ORDER BY ORDDOCID DESC, TRANSLINESEQ DESC, SLTSQNUM DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SVC30702L_1] TO [DYNGRP]
GO
