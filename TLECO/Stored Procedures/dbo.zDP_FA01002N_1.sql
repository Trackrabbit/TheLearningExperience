SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_FA01002N_1] (@BS int, @PURGEDATE datetime, @PURGETIME datetime, @USERID char(15), @ASSETID char(15), @ASSETIDSUF smallint, @ASSETINDEX int, @PURGEDATE_RS datetime, @PURGETIME_RS datetime, @USERID_RS char(15), @ASSETID_RS char(15), @ASSETIDSUF_RS smallint, @ASSETINDEX_RS int, @PURGEDATE_RE datetime, @PURGETIME_RE datetime, @USERID_RE char(15), @ASSETID_RE char(15), @ASSETIDSUF_RE smallint, @ASSETINDEX_RE int) AS  set nocount on IF @PURGEDATE_RS IS NULL BEGIN SELECT TOP 25  PURGEDATE, PURGETIME, USERID, ASSETINDEX, ASSETID, ASSETIDSUF, ASSETDESC, ASSETSTATUS, ASSETSTATDT, DEX_ROW_ID FROM .FA01002 WHERE ( PURGEDATE = @PURGEDATE AND PURGETIME = @PURGETIME AND USERID = @USERID AND ASSETID = @ASSETID AND ASSETIDSUF = @ASSETIDSUF AND ASSETINDEX > @ASSETINDEX OR PURGEDATE = @PURGEDATE AND PURGETIME = @PURGETIME AND USERID = @USERID AND ASSETID = @ASSETID AND ASSETIDSUF > @ASSETIDSUF OR PURGEDATE = @PURGEDATE AND PURGETIME = @PURGETIME AND USERID = @USERID AND ASSETID > @ASSETID OR PURGEDATE = @PURGEDATE AND PURGETIME = @PURGETIME AND USERID > @USERID OR PURGEDATE = @PURGEDATE AND PURGETIME > @PURGETIME OR PURGEDATE > @PURGEDATE ) ORDER BY PURGEDATE ASC, PURGETIME ASC, USERID ASC, ASSETID ASC, ASSETIDSUF ASC, ASSETINDEX ASC END ELSE IF @PURGEDATE_RS = @PURGEDATE_RE BEGIN SELECT TOP 25  PURGEDATE, PURGETIME, USERID, ASSETINDEX, ASSETID, ASSETIDSUF, ASSETDESC, ASSETSTATUS, ASSETSTATDT, DEX_ROW_ID FROM .FA01002 WHERE PURGEDATE = @PURGEDATE_RS AND PURGETIME BETWEEN @PURGETIME_RS AND @PURGETIME_RE AND USERID BETWEEN @USERID_RS AND @USERID_RE AND ASSETID BETWEEN @ASSETID_RS AND @ASSETID_RE AND ASSETIDSUF BETWEEN @ASSETIDSUF_RS AND @ASSETIDSUF_RE AND ASSETINDEX BETWEEN @ASSETINDEX_RS AND @ASSETINDEX_RE AND ( PURGEDATE = @PURGEDATE AND PURGETIME = @PURGETIME AND USERID = @USERID AND ASSETID = @ASSETID AND ASSETIDSUF = @ASSETIDSUF AND ASSETINDEX > @ASSETINDEX OR PURGEDATE = @PURGEDATE AND PURGETIME = @PURGETIME AND USERID = @USERID AND ASSETID = @ASSETID AND ASSETIDSUF > @ASSETIDSUF OR PURGEDATE = @PURGEDATE AND PURGETIME = @PURGETIME AND USERID = @USERID AND ASSETID > @ASSETID OR PURGEDATE = @PURGEDATE AND PURGETIME = @PURGETIME AND USERID > @USERID OR PURGEDATE = @PURGEDATE AND PURGETIME > @PURGETIME OR PURGEDATE > @PURGEDATE ) ORDER BY PURGEDATE ASC, PURGETIME ASC, USERID ASC, ASSETID ASC, ASSETIDSUF ASC, ASSETINDEX ASC END ELSE BEGIN SELECT TOP 25  PURGEDATE, PURGETIME, USERID, ASSETINDEX, ASSETID, ASSETIDSUF, ASSETDESC, ASSETSTATUS, ASSETSTATDT, DEX_ROW_ID FROM .FA01002 WHERE PURGEDATE BETWEEN @PURGEDATE_RS AND @PURGEDATE_RE AND PURGETIME BETWEEN @PURGETIME_RS AND @PURGETIME_RE AND USERID BETWEEN @USERID_RS AND @USERID_RE AND ASSETID BETWEEN @ASSETID_RS AND @ASSETID_RE AND ASSETIDSUF BETWEEN @ASSETIDSUF_RS AND @ASSETIDSUF_RE AND ASSETINDEX BETWEEN @ASSETINDEX_RS AND @ASSETINDEX_RE AND ( PURGEDATE = @PURGEDATE AND PURGETIME = @PURGETIME AND USERID = @USERID AND ASSETID = @ASSETID AND ASSETIDSUF = @ASSETIDSUF AND ASSETINDEX > @ASSETINDEX OR PURGEDATE = @PURGEDATE AND PURGETIME = @PURGETIME AND USERID = @USERID AND ASSETID = @ASSETID AND ASSETIDSUF > @ASSETIDSUF OR PURGEDATE = @PURGEDATE AND PURGETIME = @PURGETIME AND USERID = @USERID AND ASSETID > @ASSETID OR PURGEDATE = @PURGEDATE AND PURGETIME = @PURGETIME AND USERID > @USERID OR PURGEDATE = @PURGEDATE AND PURGETIME > @PURGETIME OR PURGEDATE > @PURGEDATE ) ORDER BY PURGEDATE ASC, PURGETIME ASC, USERID ASC, ASSETID ASC, ASSETIDSUF ASC, ASSETINDEX ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_FA01002N_1] TO [DYNGRP]
GO
