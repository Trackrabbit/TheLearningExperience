SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_UPR10103N_2] (@BS int, @RPTNGYR smallint, @LASTNAME char(21), @FRSTNAME char(15), @MIDLNAME char(15), @DEX_ROW_ID int, @RPTNGYR_RS smallint, @LASTNAME_RS char(21), @FRSTNAME_RS char(15), @MIDLNAME_RS char(15), @RPTNGYR_RE smallint, @LASTNAME_RE char(21), @FRSTNAME_RE char(15), @MIDLNAME_RE char(15)) AS  set nocount on IF @RPTNGYR_RS IS NULL BEGIN SELECT TOP 25  RPTNGYR, LASTNAME, FRSTNAME, MIDLNAME, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, EMPLOYID, SOCSCNUM, DEPRTMNT, GROSDIST, TXBAMNDT, TAMD1099, TOTDSTCB, CAPTLGAIN, FEDITXWH, EMPLECTR, NTREALAP, DSTCODE1, DSTCODE2, DSTCODE3, IRASEPCB, OTAM1099, OTPC1099, TTLTDSTPC, STATWGS1, STATWGS2, STAINTX1, STAINTX2, STATECD1, STATECD2, ESTIDNR1, ESTIDBR2, LCLWGES1, LCLWGS2, LCLINTX1, LCLINTX2, LCLCODE1, LCLCODE2, Y1099RFC, EMPLSUFF, DEX_ROW_ID FROM .UPR10103 WHERE ( RPTNGYR = @RPTNGYR AND LASTNAME = @LASTNAME AND FRSTNAME = @FRSTNAME AND MIDLNAME = @MIDLNAME AND DEX_ROW_ID > @DEX_ROW_ID OR RPTNGYR = @RPTNGYR AND LASTNAME = @LASTNAME AND FRSTNAME = @FRSTNAME AND MIDLNAME > @MIDLNAME OR RPTNGYR = @RPTNGYR AND LASTNAME = @LASTNAME AND FRSTNAME > @FRSTNAME OR RPTNGYR = @RPTNGYR AND LASTNAME > @LASTNAME OR RPTNGYR > @RPTNGYR ) ORDER BY RPTNGYR ASC, LASTNAME ASC, FRSTNAME ASC, MIDLNAME ASC, DEX_ROW_ID ASC END ELSE IF @RPTNGYR_RS = @RPTNGYR_RE BEGIN SELECT TOP 25  RPTNGYR, LASTNAME, FRSTNAME, MIDLNAME, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, EMPLOYID, SOCSCNUM, DEPRTMNT, GROSDIST, TXBAMNDT, TAMD1099, TOTDSTCB, CAPTLGAIN, FEDITXWH, EMPLECTR, NTREALAP, DSTCODE1, DSTCODE2, DSTCODE3, IRASEPCB, OTAM1099, OTPC1099, TTLTDSTPC, STATWGS1, STATWGS2, STAINTX1, STAINTX2, STATECD1, STATECD2, ESTIDNR1, ESTIDBR2, LCLWGES1, LCLWGS2, LCLINTX1, LCLINTX2, LCLCODE1, LCLCODE2, Y1099RFC, EMPLSUFF, DEX_ROW_ID FROM .UPR10103 WHERE RPTNGYR = @RPTNGYR_RS AND LASTNAME BETWEEN @LASTNAME_RS AND @LASTNAME_RE AND FRSTNAME BETWEEN @FRSTNAME_RS AND @FRSTNAME_RE AND MIDLNAME BETWEEN @MIDLNAME_RS AND @MIDLNAME_RE AND ( RPTNGYR = @RPTNGYR AND LASTNAME = @LASTNAME AND FRSTNAME = @FRSTNAME AND MIDLNAME = @MIDLNAME AND DEX_ROW_ID > @DEX_ROW_ID OR RPTNGYR = @RPTNGYR AND LASTNAME = @LASTNAME AND FRSTNAME = @FRSTNAME AND MIDLNAME > @MIDLNAME OR RPTNGYR = @RPTNGYR AND LASTNAME = @LASTNAME AND FRSTNAME > @FRSTNAME OR RPTNGYR = @RPTNGYR AND LASTNAME > @LASTNAME OR RPTNGYR > @RPTNGYR ) ORDER BY RPTNGYR ASC, LASTNAME ASC, FRSTNAME ASC, MIDLNAME ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  RPTNGYR, LASTNAME, FRSTNAME, MIDLNAME, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, EMPLOYID, SOCSCNUM, DEPRTMNT, GROSDIST, TXBAMNDT, TAMD1099, TOTDSTCB, CAPTLGAIN, FEDITXWH, EMPLECTR, NTREALAP, DSTCODE1, DSTCODE2, DSTCODE3, IRASEPCB, OTAM1099, OTPC1099, TTLTDSTPC, STATWGS1, STATWGS2, STAINTX1, STAINTX2, STATECD1, STATECD2, ESTIDNR1, ESTIDBR2, LCLWGES1, LCLWGS2, LCLINTX1, LCLINTX2, LCLCODE1, LCLCODE2, Y1099RFC, EMPLSUFF, DEX_ROW_ID FROM .UPR10103 WHERE RPTNGYR BETWEEN @RPTNGYR_RS AND @RPTNGYR_RE AND LASTNAME BETWEEN @LASTNAME_RS AND @LASTNAME_RE AND FRSTNAME BETWEEN @FRSTNAME_RS AND @FRSTNAME_RE AND MIDLNAME BETWEEN @MIDLNAME_RS AND @MIDLNAME_RE AND ( RPTNGYR = @RPTNGYR AND LASTNAME = @LASTNAME AND FRSTNAME = @FRSTNAME AND MIDLNAME = @MIDLNAME AND DEX_ROW_ID > @DEX_ROW_ID OR RPTNGYR = @RPTNGYR AND LASTNAME = @LASTNAME AND FRSTNAME = @FRSTNAME AND MIDLNAME > @MIDLNAME OR RPTNGYR = @RPTNGYR AND LASTNAME = @LASTNAME AND FRSTNAME > @FRSTNAME OR RPTNGYR = @RPTNGYR AND LASTNAME > @LASTNAME OR RPTNGYR > @RPTNGYR ) ORDER BY RPTNGYR ASC, LASTNAME ASC, FRSTNAME ASC, MIDLNAME ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_UPR10103N_2] TO [DYNGRP]
GO
