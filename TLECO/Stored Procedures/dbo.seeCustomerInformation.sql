SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[seeCustomerInformation]   @CUSTNMBRSTRT char(15) = '',     @CUSTNMBREND char(15) = ''  as set nocount on If (@CUSTNMBRSTRT is NULL or @CUSTNMBRSTRT = '')  Begin  set @CUSTNMBRSTRT = ''  End  If (@CUSTNMBREND is NULL or @CUSTNMBREND = '')  Begin  set @CUSTNMBREND = 'þþþþþþþþþþþþþþþ'  End   If OBJECT_ID('tempdb..#CusEmail') IS NULL      Begin        CREATE TABLE [dbo].[#CusEmail] (   EmailCardID char(25),   SelectDocumentOptions char(50),   AllowMultipleAtt char(11),   EmailSetFileSize char(11),   EmailMaxFileSize numeric (19,5),   EmailDocumentID_SQ char(50),   EmailDocumentID_SO char(50),   EmailDocumentID_SFO char(50),   EmailDocumentID_SI char(50),   EmailDocumentID_SR char(50),   EmailDocumentID_RI char(50),   EmailDocumentID_RR char(50),   EmailDocumentID_RDM char(50),   EmailDocumentID_RCM char(50),   EmailDocumentID_RFC char(50),   EmailDocumentID_RSR char(50),   EmailDocumentID_RW char(50),   EmailMessageID_SQ char(25),   EmailMessageID_SO char(25),   EmailMessageID_SFO char(25),   EmailMessageID_SI char(25),   EmailMessageID_SR char(25),   EmailMessageID_RI char(25),   EmailMessageID_RR char(25),   EmailMessageID_RDM char(25),   EmailMessageID_RCM char(25),   EmailMessageID_RFC char(25),   EmailMessageID_RSR char(25),   EmailMessageID_RW char(25),   EmailDocumentFormat_SQ char(11),   EmailDocumentFormat_SO char(11),   EmailDocumentFormat_SFO char(11),   EmailDocumentFormat_SI char(11),   EmailDocumentFormat_SR char(11),   EmailDocumentFormat_RI char(11),   EmailDocumentFormat_RR char(11),   EmailDocumentFormat_RDM char(11),   EmailDocumentFormat_RCM char(11),   EmailDocumentFormat_RFC char(11),   EmailDocumentFormat_RSR char(11),   EmailDocumentFormat_RW char(11),   )  End DELETE #CusEmail INSERT INTO #CusEmail (EmailCardID, SelectDocumentOptions, AllowMultipleAtt, EmailSetFileSize, EmailMaxFileSize, EmailDocumentID_SQ, EmailDocumentID_SO,  EmailDocumentID_SFO, EmailDocumentID_SI, EmailDocumentID_SR, EmailDocumentID_RI, EmailDocumentID_RR, EmailDocumentID_RDM, EmailDocumentID_RCM,  EmailDocumentID_RFC, EmailDocumentID_RSR, EmailDocumentID_RW)  SELECT  EmailCardID,   case when EmailAllowEmbedding = 0 then 'Send Documents as Attachments' else 'Embed Document in Message Body' end,  case when AllowMultipleAtt = 0 then 'No' when AllowMultipleAtt = 1 then 'Yes' else 'None' end,  case when EmailSetFileSize = 0 then 'No' when EmailSetFileSize = 1 then 'Yes' else 'None' end,  EmailMaxFileSize,  'Sales Quote',  'Sales Order',  'Sales Fulfillment Order',  'Sales Invoice',  'Sales Return',  'Receivables Invoice',  'Receivables Return',  'Receivables Debit Memo',  'Receivables Credit Memo',  'Receivables Finance Charge',  'Receivables Service/Repairs',  'Receivables Warranty' FROM SY04904 WHERE EmailSeriesID = 3  and EmailCardID between @CUSTNMBRSTRT and @CUSTNMBREND  UPDATE a SET a.EmailMessageID_SQ = isnull((select EmailMessageID from SY04905 where MODULE1 = 11 and EmailDocumentID = 1 and EmailCardID = a.EmailCardID),''),  a.EmailMessageID_SO = isnull((select EmailMessageID from SY04905 where MODULE1 = 11 and EmailDocumentID = 2 and EmailCardID = a.EmailCardID),''),  a.EmailMessageID_SFO = isnull((select EmailMessageID from SY04905 where MODULE1 = 11 and EmailDocumentID = 6 and EmailCardID = a.EmailCardID),''),  a.EmailMessageID_SI = isnull((select EmailMessageID from SY04905 where MODULE1 = 11 and EmailDocumentID = 3 and EmailCardID = a.EmailCardID),''),  a.EmailMessageID_SR = isnull((select EmailMessageID from SY04905 where MODULE1 = 11 and EmailDocumentID = 4 and EmailCardID = a.EmailCardID),''),  a.EmailMessageID_RI = isnull((select EmailMessageID from SY04905 where MODULE1 = 9 and EmailDocumentID = 1 and EmailCardID = a.EmailCardID),''),  a.EmailMessageID_RR = isnull((select EmailMessageID from SY04905 where MODULE1 = 9 and EmailDocumentID = 8 and EmailCardID = a.EmailCardID),''),  a.EmailMessageID_RDM = isnull((select EmailMessageID from SY04905 where MODULE1 = 9 and EmailDocumentID = 3 and EmailCardID = a.EmailCardID),''),  a.EmailMessageID_RCM = isnull((select EmailMessageID from SY04905 where MODULE1 = 9 and EmailDocumentID = 7 and EmailCardID = a.EmailCardID),''),  a.EmailMessageID_RFC = isnull((select EmailMessageID from SY04905 where MODULE1 = 9 and EmailDocumentID = 4 and EmailCardID = a.EmailCardID),''),  a.EmailMessageID_RSR = isnull((select EmailMessageID from SY04905 where MODULE1 = 9 and EmailDocumentID = 5 and EmailCardID = a.EmailCardID),''),  a.EmailMessageID_RW = isnull((select EmailMessageID from SY04905 where MODULE1 = 9 and EmailDocumentID = 6 and EmailCardID = a.EmailCardID),''),  a.EmailDocumentFormat_SQ = isnull((select (case when EmailDocumentFormat = 1 then 'DOCX'           when EmailDocumentFormat = 2 then 'HTML'           when EmailDocumentFormat = 3 then 'PDF'           when EmailDocumentFormat = 4 then 'XPS' else '' end) from SY04905 where MODULE1 = 11 and EmailDocumentID = 1 and EmailCardID = a.EmailCardID),''),  a.EmailDocumentFormat_SO = isnull((select (case when EmailDocumentFormat = 1 then 'DOCX'           when EmailDocumentFormat = 2 then 'HTML'           when EmailDocumentFormat = 3 then 'PDF'           when EmailDocumentFormat = 4 then 'XPS' else '' end) from SY04905 where MODULE1 = 11 and EmailDocumentID = 2 and EmailCardID = a.EmailCardID),''), a.EmailDocumentFormat_SFO = isnull((select (case when EmailDocumentFormat = 1 then 'DOCX'           when EmailDocumentFormat = 2 then 'HTML'           when EmailDocumentFormat = 3 then 'PDF'           when EmailDocumentFormat = 4 then 'XPS' else '' end) from SY04905 where MODULE1 = 11 and EmailDocumentID = 6 and EmailCardID = a.EmailCardID),''), a.EmailDocumentFormat_SI = isnull((select (case when EmailDocumentFormat = 1 then 'DOCX'           when EmailDocumentFormat = 2 then 'HTML'           when EmailDocumentFormat = 3 then 'PDF'           when EmailDocumentFormat = 4 then 'XPS' else '' end) from SY04905 where MODULE1 = 11 and EmailDocumentID = 3 and EmailCardID = a.EmailCardID),''), a.EmailDocumentFormat_SR = isnull((select (case when EmailDocumentFormat = 1 then 'DOCX'           when EmailDocumentFormat = 2 then 'HTML'           when EmailDocumentFormat = 3 then 'PDF'           when EmailDocumentFormat = 4 then 'XPS' else '' end) from SY04905 where MODULE1 = 11 and EmailDocumentID = 4 and EmailCardID = a.EmailCardID),''),   a.EmailDocumentFormat_RI = isnull((select (case when EmailDocumentFormat = 1 then 'DOCX'   when EmailDocumentFormat = 2 then 'HTML'   when EmailDocumentFormat = 3 then 'PDF'   when EmailDocumentFormat = 4 then 'XPS' else '' end) from SY04905 where MODULE1 = 9 and EmailDocumentID = 1 and EmailCardID = a.EmailCardID),''),  a.EmailDocumentFormat_RR = isnull((select (case when EmailDocumentFormat = 1 then 'DOCX'   when EmailDocumentFormat = 2 then 'HTML'   when EmailDocumentFormat = 3 then 'PDF'   when EmailDocumentFormat = 4 then 'XPS' else '' end) from SY04905 where MODULE1 = 9 and EmailDocumentID = 8 and EmailCardID = a.EmailCardID),''),  a.EmailDocumentFormat_RDM = isnull((select (case when EmailDocumentFormat = 1 then 'DOCX'   when EmailDocumentFormat = 2 then 'HTML'   when EmailDocumentFormat = 3 then 'PDF'   when EmailDocumentFormat = 4 then 'XPS' else '' end) from SY04905 where MODULE1 = 9 and EmailDocumentID = 3 and EmailCardID = a.EmailCardID),''),  a.EmailDocumentFormat_RCM = isnull((select (case when EmailDocumentFormat = 1 then 'DOCX'   when EmailDocumentFormat = 2 then 'HTML'   when EmailDocumentFormat = 3 then 'PDF'   when EmailDocumentFormat = 4 then 'XPS' else '' end) from SY04905 where MODULE1 = 9 and EmailDocumentID = 7 and EmailCardID = a.EmailCardID),''),  a.EmailDocumentFormat_RFC = isnull((select (case when EmailDocumentFormat = 1 then 'DOCX'   when EmailDocumentFormat = 2 then 'HTML'   when EmailDocumentFormat = 3 then 'PDF'   when EmailDocumentFormat = 4 then 'XPS' else '' end) from SY04905 where MODULE1 = 9 and EmailDocumentID = 4 and EmailCardID = a.EmailCardID),''),  a.EmailDocumentFormat_RSR = isnull((select (case when EmailDocumentFormat = 1 then 'DOCX'   when EmailDocumentFormat = 2 then 'HTML'   when EmailDocumentFormat = 3 then 'PDF'   when EmailDocumentFormat = 4 then 'XPS' else '' end) from SY04905 where MODULE1 = 9 and EmailDocumentID = 5 and EmailCardID = a.EmailCardID),''),  a.EmailDocumentFormat_RW = isnull((select (case when EmailDocumentFormat = 1 then 'DOCX'   when EmailDocumentFormat = 2 then 'HTML'   when EmailDocumentFormat = 3 then 'PDF'   when EmailDocumentFormat = 4 then 'XPS' else '' end) from SY04905 where MODULE1 = 9 and EmailDocumentID = 6 and EmailCardID = a.EmailCardID),'')  FROM #CusEmail a  select (select USRDFPR1 from RM40101) as [User Defined 1 Setup],   (select USRDRPR2 from RM40101) as [User Defined 2 Setup],   dbo.seeEmail_RM00106(1,a.[Customer Number]) as [Email Statements To],   dbo.seeEmail_RM00106(2,a.[Customer Number]) as [Email Statements Cc],   dbo.seeEmail_RM00106(3,a.[Customer Number]) as [Email Statements Bc],   isnull(c.EmailToAddress,'') as [Email Address To],   isnull(c.EmailBccAddress,'') as [Email Address Bc],   isnull(c.EmailCcAddress,'') as [Email Address Cc],   'XXXX-XXXX-XXXX' +'-'+RIGHT(rtrim(b.CRCRDNUM),4) as CRCRDNUM,   b.USERLANG,   isnull(d.ACTNUMST,'') as [RMOvrpymtWrtoffAcctNumber],   a.[Customer Number],  a.[Customer Name],  a.[Address 1],  a.[Address 2],  a.[City],  a.[State],  a.[Zip],  a.[Phone 1],  a.[Aging Bucket1],  a.[Aging Bucket2],  a.[Aging Bucket3],  a.[Aging Bucket4],  a.[Aging Bucket5],  a.[Aging Bucket6],  a.[Aging Bucket7],  a.[Accounts Receivable Account Number],  a.[Address 3],  a.[Address Code],  a.[Average Days To Pay - Life],  a.[Average Days To Pay - Year],  a.[Average Days to Pay - LYR],  a.[Balance Type],  a.[Bank Branch],  a.[Bank Name],  a.[COGS Account Number],  a.[Cash Account Number],  a.[Checkbook ID],  a.[Comment1],  a.[Comment2],  a.[Contact Person],  a.[Corporate Customer Number],  a.[Country],  a.[Created Date],  a.[Credit Card Exp Date],  a.[Credit Card ID],  a.[Credit Limit Amount],  a.[Credit Limit Period],  a.[Credit Limit Period Amount],  a.[Credit Limit Type],  a.[Currency ID],  a.[Customer Balance],  a.[Customer Class],  a.[Customer Discount],  a.[Default Cash Account Type],  a.[Deposits Received],  a.[Discount Grace Period],  a.[Discounts Available Account Number],  a.[Discounts Taken Account Number],  a.[Document Format ID],  a.[Due Date Grace Period],  a.[Fax],  a.[Finance Charge Account Number],  a.[Finance Charge Amt Type],  a.[Finance Charge Dollar],  a.[Finance Charge ID],  a.[Finance Charge Percent],  a.[Finance Charges CYTD],  a.[Finance Charges LYR Calendar],  a.[First Invoice Date],  a.[Governmental Corporate ID],  a.[Governmental Individual ID],  a.[High Balance LTD],  a.[High Balance LYR],  a.[High Balance YTD],  a.[Hold],  a.[Inactive],  a.[Inventory Account Number],  a.[Keep Calendar History],  a.[Keep Distribution History],  a.[Keep Period History],  a.[Keep Trx History],  a.[Last Aged],  a.[Last Finance Charge Amount],  a.[Last NSF Check Date],  a.[Last Payment Amount],  a.[Last Payment Date],  a.[Last Statement Amount],  a.[Last Statement Date],  a.[Last Transaction Amount],  a.[Last Transaction Date],  a.[Max Writeoff Amount],  a.[Maximum Writeoff Type],  a.[Minimum Payment Dollar],  a.[Minimum Payment Percent],  a.[Minimum Payment Type],  a.[Modified Date],  a.[Non Current Scheduled Payments],  a.[Note Index],  a.[Number ADTP Documents - LYR],  a.[Number ADTP Documents - Life],  a.[Number ADTP Documents - Year],  a.[Number Of NSF Checks Life],  a.[Number Of NSF Checks YTD],  a.[On Order Amount],  a.[Order Fulfillment Shortage Default],  a.[Payment Terms ID],  a.[Phone 2],  a.[Phone 3],  a.[Post Results To],  a.[PriceLevel],  a.[Primary Billto Address Code],  a.[Primary Shipto Address Code],  a.[Priority],  a.[Rate Type ID],  a.[Retainage],  a.[Revalue Customer],  a.[Sales Account Number],  a.[Sales Order Returns Account Number],  a.[Sales Territory],  a.[Salesperson ID],  a.[Send Email Statements],  a.[Ship Complete Document],  a.[Shipping Method],  a.[Short Name],  a.[Statement Address Code],  a.[Statement Cycle],  a.[Statement Name],  a.[Tax Exempt 1],  a.[Tax Exempt 2],  a.[Tax Registration Number],  a.[Tax Schedule ID],  a.[Total # FC LTD],  a.[Total # FC LYR],  a.[Total # FC YTD],  a.[Total # Invoices LTD],  a.[Total # Invoices LYR],  a.[Total # Invoices YTD],  a.[Total Amount Of NSF Checks Life],  a.[Total Amount Of NSF Checks YTD],  a.[Total Bad Deb LYR],  a.[Total Bad Debt LTD],  a.[Total Bad Debt YTD],  a.[Total Cash Received LTD],  a.[Total Cash Received LYR],  a.[Total Cash Received YTD],  a.[Total Costs LTD],  a.[Total Costs LYR],  a.[Total Costs YTD],  a.[Total Discounts Available YTD],  a.[Total Discounts Taken LTD],  a.[Total Discounts Taken LYR],  a.[Total Discounts Taken YTD],  a.[Total Finance Charges LTD],  a.[Total Finance Charges LYR],  a.[Total Finance Charges YTD],  a.[Total Returns LTD],  a.[Total Returns LYR],  a.[Total Returns YTD],a.[Total Sales LTD],  a.[Total Sales LYR],  a.[Total Sales YTD],  a.[Total Waived FC LTD],  a.[Total Waived FC LYR],  a.[Total Waived FC YTD],  a.[Total Writeoffs LTD],  a.[Total Writeoffs LYR],  a.[Total Writeoffs YTD],  a.[UPS Zone],  a.[Unpaid Finance Charges YTD],  a.[Unposted Cash Amount],  a.[Unposted Other Cash Amount],  a.[Unposted Other Sales Amount],  a.[Unposted Sales Amount],  a.[User Defined 1],  a.[User Defined 2],  a.[Write Offs LIFE],  a.[Write Offs LYR],  a.[Write Offs YTD],  a.[Writeoff Account Number],   (select RMPERDSC from RM40201 where INDEX1 = 1) as [Bucket 1 Title],   (select RMPERDSC from RM40201 where INDEX1 = 2) as [Bucket 2 Title],   (select RMPERDSC from RM40201 where INDEX1 = 3) as [Bucket 3 Title],   (select RMPERDSC from RM40201 where INDEX1 = 4) as [Bucket 4 Title],   (select RMPERDSC from RM40201 where INDEX1 = 5) as [Bucket 5 Title],   (select RMPERDSC from RM40201 where INDEX1 = 6) as [Bucket 6 Title],   (select RMPERDSC from RM40201 where INDEX1 = 7) as [Bucket 7 Title],   (select RMPERDSC from RM40201 where INDEX1 = 101) as [Balance Forward Current Title],   (select RMPERDSC from RM40201 where INDEX1 = 102) as [Balance Forward Non-Current Title],   e.SelectDocumentOptions, e.AllowMultipleAtt, e.EmailSetFileSize, e.EmailMaxFileSize, e.EmailDocumentID_SQ, e.EmailDocumentID_SO, EmailDocumentID_SFO,   e.EmailDocumentID_SI, e.EmailDocumentID_SR, e.EmailDocumentID_RI, e.EmailDocumentID_RR, e.EmailDocumentID_RDM, e.EmailDocumentID_RCM, e.EmailDocumentID_RFC,   e.EmailDocumentID_RSR, e.EmailDocumentID_RW, e.EmailMessageID_SQ, e.EmailMessageID_SO, e.EmailMessageID_SFO, e.EmailMessageID_SI, e.EmailMessageID_SR,   e.EmailMessageID_RI, e.EmailMessageID_RR, e.EmailMessageID_RDM, e.EmailMessageID_RCM, e.EmailMessageID_RFC, e.EmailMessageID_RSR, e.EmailMessageID_RW,   e.EmailDocumentFormat_SQ, e.EmailDocumentFormat_SO, e.EmailDocumentFormat_SFO, e.EmailDocumentFormat_SI, e.EmailDocumentFormat_SR, e.EmailDocumentFormat_RI,   e.EmailDocumentFormat_RR, e.EmailDocumentFormat_RDM, e.EmailDocumentFormat_RCM, e.EmailDocumentFormat_RFC, e.EmailDocumentFormat_RSR, e.EmailDocumentFormat_RW  from Customers a  join RM00101 b on   a.[Customer Number] = b.CUSTNMBR  left join SY01200 c on   a.[Customer Number] = c.Master_ID and   a.[Address Code] = c.ADRSCODE  left join GL00105 d  on b.RMOvrpymtWrtoffAcctIdx=d.ACTINDX  left join #CusEmail e on   a.[Customer Number] = e.EmailCardID   where a.[Customer Number] between @CUSTNMBRSTRT and @CUSTNMBREND       
GO
GRANT EXECUTE ON  [dbo].[seeCustomerInformation] TO [DYNGRP]
GO
GRANT EXECUTE ON  [dbo].[seeCustomerInformation] TO [rpt_accounting manager]
GO
GRANT EXECUTE ON  [dbo].[seeCustomerInformation] TO [rpt_accounts receivable coordinator]
GO
GRANT EXECUTE ON  [dbo].[seeCustomerInformation] TO [rpt_certified accountant]
GO
GRANT EXECUTE ON  [dbo].[seeCustomerInformation] TO [rpt_collections manager]
GO
GRANT EXECUTE ON  [dbo].[seeCustomerInformation] TO [rpt_order processor]
GO
