SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[ivNumber_Inc_Dec]  @I_tInc_Dec tinyint  = NULL,  @IO_vDocNumber varchar(21) = NULL  output,  @O_iErrorState int  = NULL  output as   declare  @tCarry tinyint,  @tLoopCounter tinyint,  @tStringLength tinyint,  @cSOPNumChar char(1)  if  @IO_vDocNumber is NULL or  @I_tInc_Dec is NULL  begin  select @O_iErrorState = 21031  return end  select @O_iErrorState  = 0  select @tLoopCounter = 0,  @tCarry = 1,  @tStringLength = len(@IO_vDocNumber)   select  @cSOPNumChar = substring(@IO_vDocNumber,@tStringLength,1)   if  @IO_vDocNumber = '' or @cSOPNumChar < '0'  begin  select @IO_vDocNumber = ''  return end  while @cSOPNumChar <= '9' and @tCarry = 1 and @O_iErrorState = 0  begin   select @tCarry = 0  if @I_tInc_Dec = 1   begin  if     @cSOPNumChar = '0'   select @cSOPNumChar = '1'  else if @cSOPNumChar = '1'   select @cSOPNumChar = '2'  else if @cSOPNumChar = '2'   select @cSOPNumChar = '3'  else if @cSOPNumChar = '3'   select @cSOPNumChar = '4'  else if @cSOPNumChar = '4'   select @cSOPNumChar = '5'  else if @cSOPNumChar = '5'   select @cSOPNumChar = '6'  else if @cSOPNumChar = '6'   select @cSOPNumChar = '7'  else if @cSOPNumChar = '7'   select @cSOPNumChar = '8'  else if @cSOPNumChar = '8'   select @cSOPNumChar = '9'  else if @cSOPNumChar = '9'   begin  select @cSOPNumChar = '0'  select @tCarry = 1  end  end  else  begin  if     @cSOPNumChar = '0'   begin  select @cSOPNumChar = '9'  select @tCarry = 1  end  else if @cSOPNumChar = '1'   select @cSOPNumChar = '0'  else if @cSOPNumChar = '2'   select @cSOPNumChar = '1'  else if @cSOPNumChar = '3'   select @cSOPNumChar = '2'  else if @cSOPNumChar = '4'   select @cSOPNumChar = '3'  else if @cSOPNumChar = '5'   select @cSOPNumChar = '4'  else if @cSOPNumChar = '6'   select @cSOPNumChar = '5'  else if @cSOPNumChar = '7'   select @cSOPNumChar = '6'  else if @cSOPNumChar = '8'   select @cSOPNumChar = '7'  else if @cSOPNumChar = '9'   select @cSOPNumChar = '8'  end   if @tStringLength - @tLoopCounter > 0   begin  select @IO_vDocNumber = isnull(stuff(@IO_vDocNumber, @tStringLength - @tLoopCounter,   1, @cSOPNumChar),'')  end   select @tLoopCounter = @tLoopCounter + 1  select @cSOPNumChar = substring(@IO_vDocNumber, @tStringLength - @tLoopCounter, 1)  end  return    
GO
GRANT EXECUTE ON  [dbo].[ivNumber_Inc_Dec] TO [DYNGRP]
GO
