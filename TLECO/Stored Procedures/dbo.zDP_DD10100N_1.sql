SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_DD10100N_1] (@BS int, @USERID char(15), @EMPLOYID char(15), @USERID_RS char(15), @EMPLOYID_RS char(15), @USERID_RE char(15), @EMPLOYID_RE char(15)) AS  set nocount on IF @USERID_RS IS NULL BEGIN SELECT TOP 25  EMPLOYID, EMPLNAME, PRINTED, VOIDED, CHEKDATE, CHEKNMBR, PYADNMBR, SOCSCNUM, NTWPYRN, GRWGPRN, STTPYPRD, ENPAYPRD, INACTIVE, DDVOIDED, DDMASKDLR, DDSUPCHK, DDNBRACCTS, DDATRXCODE_1, DDATRXCODE_2, DDATRXCODE_3, DDATRXCODE_4, DDATRXCODE_5, DDATRXCODE_6, DDATRXCODE_7, DDATRXCODE_8, DDATRXCODE_9, DDATRXCODE_10, DDATRXCODE_11, DDATRXCODE_12, DDATRANSIT_1, DDATRANSIT_2, DDATRANSIT_3, DDATRANSIT_4, DDATRANSIT_5, DDATRANSIT_6, DDATRANSIT_7, DDATRANSIT_8, DDATRANSIT_9, DDATRANSIT_10, DDATRANSIT_11, DDATRANSIT_12, DDAACCOUNT_1, DDAACCOUNT_2, DDAACCOUNT_3, DDAACCOUNT_4, DDAACCOUNT_5, DDAACCOUNT_6, DDAACCOUNT_7, DDAACCOUNT_8, DDAACCOUNT_9, DDAACCOUNT_10, DDAACCOUNT_11, DDAACCOUNT_12, DDAAMOUNT_1, DDAAMOUNT_2, DDAAMOUNT_3, DDAAMOUNT_4, DDAAMOUNT_5, DDAAMOUNT_6, DDAAMOUNT_7, DDAAMOUNT_8, DDAAMOUNT_9, DDAAMOUNT_10, DDAAMOUNT_11, DDAAMOUNT_12, ERRDESCR, USERID, DEX_ROW_ID FROM .DD10100 WHERE ( USERID = @USERID AND EMPLOYID > @EMPLOYID OR USERID > @USERID ) ORDER BY USERID ASC, EMPLOYID ASC END ELSE IF @USERID_RS = @USERID_RE BEGIN SELECT TOP 25  EMPLOYID, EMPLNAME, PRINTED, VOIDED, CHEKDATE, CHEKNMBR, PYADNMBR, SOCSCNUM, NTWPYRN, GRWGPRN, STTPYPRD, ENPAYPRD, INACTIVE, DDVOIDED, DDMASKDLR, DDSUPCHK, DDNBRACCTS, DDATRXCODE_1, DDATRXCODE_2, DDATRXCODE_3, DDATRXCODE_4, DDATRXCODE_5, DDATRXCODE_6, DDATRXCODE_7, DDATRXCODE_8, DDATRXCODE_9, DDATRXCODE_10, DDATRXCODE_11, DDATRXCODE_12, DDATRANSIT_1, DDATRANSIT_2, DDATRANSIT_3, DDATRANSIT_4, DDATRANSIT_5, DDATRANSIT_6, DDATRANSIT_7, DDATRANSIT_8, DDATRANSIT_9, DDATRANSIT_10, DDATRANSIT_11, DDATRANSIT_12, DDAACCOUNT_1, DDAACCOUNT_2, DDAACCOUNT_3, DDAACCOUNT_4, DDAACCOUNT_5, DDAACCOUNT_6, DDAACCOUNT_7, DDAACCOUNT_8, DDAACCOUNT_9, DDAACCOUNT_10, DDAACCOUNT_11, DDAACCOUNT_12, DDAAMOUNT_1, DDAAMOUNT_2, DDAAMOUNT_3, DDAAMOUNT_4, DDAAMOUNT_5, DDAAMOUNT_6, DDAAMOUNT_7, DDAAMOUNT_8, DDAAMOUNT_9, DDAAMOUNT_10, DDAAMOUNT_11, DDAAMOUNT_12, ERRDESCR, USERID, DEX_ROW_ID FROM .DD10100 WHERE USERID = @USERID_RS AND EMPLOYID BETWEEN @EMPLOYID_RS AND @EMPLOYID_RE AND ( USERID = @USERID AND EMPLOYID > @EMPLOYID OR USERID > @USERID ) ORDER BY USERID ASC, EMPLOYID ASC END ELSE BEGIN SELECT TOP 25  EMPLOYID, EMPLNAME, PRINTED, VOIDED, CHEKDATE, CHEKNMBR, PYADNMBR, SOCSCNUM, NTWPYRN, GRWGPRN, STTPYPRD, ENPAYPRD, INACTIVE, DDVOIDED, DDMASKDLR, DDSUPCHK, DDNBRACCTS, DDATRXCODE_1, DDATRXCODE_2, DDATRXCODE_3, DDATRXCODE_4, DDATRXCODE_5, DDATRXCODE_6, DDATRXCODE_7, DDATRXCODE_8, DDATRXCODE_9, DDATRXCODE_10, DDATRXCODE_11, DDATRXCODE_12, DDATRANSIT_1, DDATRANSIT_2, DDATRANSIT_3, DDATRANSIT_4, DDATRANSIT_5, DDATRANSIT_6, DDATRANSIT_7, DDATRANSIT_8, DDATRANSIT_9, DDATRANSIT_10, DDATRANSIT_11, DDATRANSIT_12, DDAACCOUNT_1, DDAACCOUNT_2, DDAACCOUNT_3, DDAACCOUNT_4, DDAACCOUNT_5, DDAACCOUNT_6, DDAACCOUNT_7, DDAACCOUNT_8, DDAACCOUNT_9, DDAACCOUNT_10, DDAACCOUNT_11, DDAACCOUNT_12, DDAAMOUNT_1, DDAAMOUNT_2, DDAAMOUNT_3, DDAAMOUNT_4, DDAAMOUNT_5, DDAAMOUNT_6, DDAAMOUNT_7, DDAAMOUNT_8, DDAAMOUNT_9, DDAAMOUNT_10, DDAAMOUNT_11, DDAAMOUNT_12, ERRDESCR, USERID, DEX_ROW_ID FROM .DD10100 WHERE USERID BETWEEN @USERID_RS AND @USERID_RE AND EMPLOYID BETWEEN @EMPLOYID_RS AND @EMPLOYID_RE AND ( USERID = @USERID AND EMPLOYID > @EMPLOYID OR USERID > @USERID ) ORDER BY USERID ASC, EMPLOYID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_DD10100N_1] TO [DYNGRP]
GO
