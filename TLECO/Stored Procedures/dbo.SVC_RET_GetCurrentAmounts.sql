SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 Create Procedure [dbo].[SVC_RET_GetCurrentAmounts]  (  @CONSTS smallint,  @CONTNBR char(11),  @LNSEQNBR numeric(19,5),  @RETNAGAM numeric(19,5) OUTPUT,  @RTNBILLD numeric(19,5) OUTPUT,  @ORIGRETNAGAM numeric(19,5) OUTPUT,  @ORIGRTNBILLD numeric(19,5) OUTPUT,   @BLKTIM numeric(19,5) OUTPUT,  @VALTIM numeric(19,5) OUTPUT,  @NBRCAL integer OUTPUT,  @ACTCAL smallint OUTPUT,   @PRETAXTOT numeric(19,5) OUTPUT,  @ORIGPRETAXTOT numeric(19,5) OUTPUT,  @QTYSOLD numeric(19,5) OUTPUT,  @Count integer OUTPUT,  @SVC_Liability_Type integer OUTPUT  ) As set nocount on  declare @ReferenceType smallint select @RETNAGAM = 0,  @RTNBILLD = 0,  @ORIGRETNAGAM = 0,  @ORIGRTNBILLD = 0,  @BLKTIM = 0,  @VALTIM = 0,  @NBRCAL = 0,  @ACTCAL = 0,  @PRETAXTOT = 0,  @ORIGPRETAXTOT = 0,  @QTYSOLD = 0,  @Count = 0,  @SVC_Liability_Type  = 0 if exists(select * from sysobjects where name = 'SVC00601') begin  select @RETNAGAM = RETNAGAM,  @RTNBILLD = RTNBILLD,  @ORIGRTNBILLD = ORIGRTNBILLD,  @ORIGRETNAGAM = ORIGRETNAGAM,  @BLKTIM = BLKTIM,  @VALTIM = VALTIM,  @NBRCAL = NBRCAL,  @ACTCAL = ACTCAL,  @SVC_Liability_Type = SVC_Liability_Type   from SVC00601  where CONSTS = @CONSTS and CONTNBR = @CONTNBR and LNSEQNBR = @LNSEQNBR  select @PRETAXTOT = SUM(IsNull(PRETAXTOT,0)),  @ORIGPRETAXTOT = SUM(IsNull(ORIGPRETAXTOT,0)),  @Count = count(*)  from SVC00200  where CONSTS = @CONSTS and CONTNBR = @CONTNBR and SVC_Contract_Line_SEQ = @LNSEQNBR and SRVRECTYPE = 2  select @QTYSOLD = SUM(IsNull(SVC00203.QTYSOLD,0))  from SVC00200 inner join SVC00203  on (SVC00200.SRVRECTYPE = SVC00203.SRVRECTYPE and SVC00200.CALLNBR = SVC00203.CALLNBR)  where SVC00200.CONSTS = @CONSTS and SVC00200.CONTNBR = @CONTNBR and   SVC00200.SVC_Contract_Line_SEQ = @LNSEQNBR and SVC00200.SRVRECTYPE = 2  and SVC00203.LINITMTYP = 'L'  end return     
GO
GRANT EXECUTE ON  [dbo].[SVC_RET_GetCurrentAmounts] TO [DYNGRP]
GO
