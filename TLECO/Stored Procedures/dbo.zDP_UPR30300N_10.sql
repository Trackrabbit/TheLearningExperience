SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_UPR30300N_10] (@BS int, @AUCTRLCD char(13), @PYADNMBR int, @PYRLRTYP smallint, @TRXNUMBER int, @AUCTRLCD_RS char(13), @PYADNMBR_RS int, @PYRLRTYP_RS smallint, @TRXNUMBER_RS int, @AUCTRLCD_RE char(13), @PYADNMBR_RE int, @PYRLRTYP_RE smallint, @TRXNUMBER_RE int) AS  set nocount on IF @AUCTRLCD_RS IS NULL BEGIN SELECT TOP 25  CMRECNUM, AUCTRLCD, EMPLOYID, CHEKNMBR, PYADNMBR, TRXNUMBER, YEAR1, CHEKDATE, DEPRTMNT, PYRLRTYP, PAYROLCD, TRXSORCE, DOCTYPE, JOBTITLE, TRXBEGDT, TRXENDDT, UNTSTOPY, PAYRATE, UPRTRXAM, TIMETYPE_I, TIMEAVAILABLE, TipType, RECEIPTS, PAYADVNC, STATECD, LOCALTAX, WRKRCOMP, USWHPSTD, LSTDTEDT, LASTUSER, SHFTCODE, SHFTPREM, TXBLWAGS, DAYSWRDK, WKSWRKD, SUTASTAT, SBJTFUTA, BSDONRTE, EMPLCLAS, DEX_ROW_ID FROM .UPR30300 WHERE ( AUCTRLCD = @AUCTRLCD AND PYADNMBR = @PYADNMBR AND PYRLRTYP = @PYRLRTYP AND TRXNUMBER > @TRXNUMBER OR AUCTRLCD = @AUCTRLCD AND PYADNMBR = @PYADNMBR AND PYRLRTYP > @PYRLRTYP OR AUCTRLCD = @AUCTRLCD AND PYADNMBR > @PYADNMBR OR AUCTRLCD > @AUCTRLCD ) ORDER BY AUCTRLCD ASC, PYADNMBR ASC, PYRLRTYP ASC, TRXNUMBER ASC END ELSE IF @AUCTRLCD_RS = @AUCTRLCD_RE BEGIN SELECT TOP 25  CMRECNUM, AUCTRLCD, EMPLOYID, CHEKNMBR, PYADNMBR, TRXNUMBER, YEAR1, CHEKDATE, DEPRTMNT, PYRLRTYP, PAYROLCD, TRXSORCE, DOCTYPE, JOBTITLE, TRXBEGDT, TRXENDDT, UNTSTOPY, PAYRATE, UPRTRXAM, TIMETYPE_I, TIMEAVAILABLE, TipType, RECEIPTS, PAYADVNC, STATECD, LOCALTAX, WRKRCOMP, USWHPSTD, LSTDTEDT, LASTUSER, SHFTCODE, SHFTPREM, TXBLWAGS, DAYSWRDK, WKSWRKD, SUTASTAT, SBJTFUTA, BSDONRTE, EMPLCLAS, DEX_ROW_ID FROM .UPR30300 WHERE AUCTRLCD = @AUCTRLCD_RS AND PYADNMBR BETWEEN @PYADNMBR_RS AND @PYADNMBR_RE AND PYRLRTYP BETWEEN @PYRLRTYP_RS AND @PYRLRTYP_RE AND TRXNUMBER BETWEEN @TRXNUMBER_RS AND @TRXNUMBER_RE AND ( AUCTRLCD = @AUCTRLCD AND PYADNMBR = @PYADNMBR AND PYRLRTYP = @PYRLRTYP AND TRXNUMBER > @TRXNUMBER OR AUCTRLCD = @AUCTRLCD AND PYADNMBR = @PYADNMBR AND PYRLRTYP > @PYRLRTYP OR AUCTRLCD = @AUCTRLCD AND PYADNMBR > @PYADNMBR OR AUCTRLCD > @AUCTRLCD ) ORDER BY AUCTRLCD ASC, PYADNMBR ASC, PYRLRTYP ASC, TRXNUMBER ASC END ELSE BEGIN SELECT TOP 25  CMRECNUM, AUCTRLCD, EMPLOYID, CHEKNMBR, PYADNMBR, TRXNUMBER, YEAR1, CHEKDATE, DEPRTMNT, PYRLRTYP, PAYROLCD, TRXSORCE, DOCTYPE, JOBTITLE, TRXBEGDT, TRXENDDT, UNTSTOPY, PAYRATE, UPRTRXAM, TIMETYPE_I, TIMEAVAILABLE, TipType, RECEIPTS, PAYADVNC, STATECD, LOCALTAX, WRKRCOMP, USWHPSTD, LSTDTEDT, LASTUSER, SHFTCODE, SHFTPREM, TXBLWAGS, DAYSWRDK, WKSWRKD, SUTASTAT, SBJTFUTA, BSDONRTE, EMPLCLAS, DEX_ROW_ID FROM .UPR30300 WHERE AUCTRLCD BETWEEN @AUCTRLCD_RS AND @AUCTRLCD_RE AND PYADNMBR BETWEEN @PYADNMBR_RS AND @PYADNMBR_RE AND PYRLRTYP BETWEEN @PYRLRTYP_RS AND @PYRLRTYP_RE AND TRXNUMBER BETWEEN @TRXNUMBER_RS AND @TRXNUMBER_RE AND ( AUCTRLCD = @AUCTRLCD AND PYADNMBR = @PYADNMBR AND PYRLRTYP = @PYRLRTYP AND TRXNUMBER > @TRXNUMBER OR AUCTRLCD = @AUCTRLCD AND PYADNMBR = @PYADNMBR AND PYRLRTYP > @PYRLRTYP OR AUCTRLCD = @AUCTRLCD AND PYADNMBR > @PYADNMBR OR AUCTRLCD > @AUCTRLCD ) ORDER BY AUCTRLCD ASC, PYADNMBR ASC, PYRLRTYP ASC, TRXNUMBER ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_UPR30300N_10] TO [DYNGRP]
GO
