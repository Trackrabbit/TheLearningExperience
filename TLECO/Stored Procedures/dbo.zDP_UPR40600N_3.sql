SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_UPR40600N_3] (@BS int, @PAYTYPE smallint, @PAYRCORD char(7), @PAYTYPE_RS smallint, @PAYRCORD_RS char(7), @PAYTYPE_RE smallint, @PAYRCORD_RE char(7)) AS  set nocount on IF @PAYTYPE_RS IS NULL BEGIN SELECT TOP 25  PAYRCORD, DSCRIPTN, INACTIVE, PAYTYPE, BSPAYRCD, PAYRTAMT, PAYUNIT, PAYUNPER, PAYPEROD, PAYPRPRD, MXPYPPER, TipType, PAYADVNC, RPTASWGS, W2BXNMBR, W2BXLABL, TAXABLE, SBJTFDTX, SBJTSSEC, SBJTMCAR, SBJTSTTX, SBJTLTAX, SBJTFUTA, SBJTSUTA, FFEDTXRT, FLSTTXRT, ACRUVACN, ACRUSTIM, NOTEINDX, DATAENTDFLT, SHFTCODE, PAYFACTR, BSDONRTE, W2BXNMBR2, W2BXLABL2, W2BXNMBR3, W2BXLABL3, W2BXNMBR4, W2BXLABL4, DEX_ROW_ID FROM .UPR40600 WHERE ( PAYTYPE = @PAYTYPE AND PAYRCORD > @PAYRCORD OR PAYTYPE > @PAYTYPE ) ORDER BY PAYTYPE ASC, PAYRCORD ASC END ELSE IF @PAYTYPE_RS = @PAYTYPE_RE BEGIN SELECT TOP 25  PAYRCORD, DSCRIPTN, INACTIVE, PAYTYPE, BSPAYRCD, PAYRTAMT, PAYUNIT, PAYUNPER, PAYPEROD, PAYPRPRD, MXPYPPER, TipType, PAYADVNC, RPTASWGS, W2BXNMBR, W2BXLABL, TAXABLE, SBJTFDTX, SBJTSSEC, SBJTMCAR, SBJTSTTX, SBJTLTAX, SBJTFUTA, SBJTSUTA, FFEDTXRT, FLSTTXRT, ACRUVACN, ACRUSTIM, NOTEINDX, DATAENTDFLT, SHFTCODE, PAYFACTR, BSDONRTE, W2BXNMBR2, W2BXLABL2, W2BXNMBR3, W2BXLABL3, W2BXNMBR4, W2BXLABL4, DEX_ROW_ID FROM .UPR40600 WHERE PAYTYPE = @PAYTYPE_RS AND PAYRCORD BETWEEN @PAYRCORD_RS AND @PAYRCORD_RE AND ( PAYTYPE = @PAYTYPE AND PAYRCORD > @PAYRCORD OR PAYTYPE > @PAYTYPE ) ORDER BY PAYTYPE ASC, PAYRCORD ASC END ELSE BEGIN SELECT TOP 25  PAYRCORD, DSCRIPTN, INACTIVE, PAYTYPE, BSPAYRCD, PAYRTAMT, PAYUNIT, PAYUNPER, PAYPEROD, PAYPRPRD, MXPYPPER, TipType, PAYADVNC, RPTASWGS, W2BXNMBR, W2BXLABL, TAXABLE, SBJTFDTX, SBJTSSEC, SBJTMCAR, SBJTSTTX, SBJTLTAX, SBJTFUTA, SBJTSUTA, FFEDTXRT, FLSTTXRT, ACRUVACN, ACRUSTIM, NOTEINDX, DATAENTDFLT, SHFTCODE, PAYFACTR, BSDONRTE, W2BXNMBR2, W2BXLABL2, W2BXNMBR3, W2BXLABL3, W2BXNMBR4, W2BXLABL4, DEX_ROW_ID FROM .UPR40600 WHERE PAYTYPE BETWEEN @PAYTYPE_RS AND @PAYTYPE_RE AND PAYRCORD BETWEEN @PAYRCORD_RS AND @PAYRCORD_RE AND ( PAYTYPE = @PAYTYPE AND PAYRCORD > @PAYRCORD OR PAYTYPE > @PAYTYPE ) ORDER BY PAYTYPE ASC, PAYRCORD ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_UPR40600N_3] TO [DYNGRP]
GO
