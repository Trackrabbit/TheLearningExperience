SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IV40700N_2] (@BS int, @LOCNDSCR char(31), @DEX_ROW_ID int, @LOCNDSCR_RS char(31), @LOCNDSCR_RE char(31)) AS  set nocount on IF @LOCNDSCR_RS IS NULL BEGIN SELECT TOP 25  LOCNCODE, LOCNDSCR, NOTEINDX, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, COUNTRY, PHONE1, PHONE2, PHONE3, FAXNUMBR, Location_Segment, STAXSCHD, PCTAXSCH, INCLDDINPLNNNG, PORECEIPTBIN, PORETRNBIN, SOFULFILLMENTBIN, SORETURNBIN, BOMRCPTBIN, MATERIALISSUEBIN, MORECEIPTBIN, REPAIRISSUESBIN, WMSINT, PICKTICKETSITEOPT, BINBREAK, CCode, DECLID, INACTIVE, DEX_ROW_ID FROM .IV40700 WHERE ( LOCNDSCR = @LOCNDSCR AND DEX_ROW_ID > @DEX_ROW_ID OR LOCNDSCR > @LOCNDSCR ) ORDER BY LOCNDSCR ASC, DEX_ROW_ID ASC END ELSE IF @LOCNDSCR_RS = @LOCNDSCR_RE BEGIN SELECT TOP 25  LOCNCODE, LOCNDSCR, NOTEINDX, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, COUNTRY, PHONE1, PHONE2, PHONE3, FAXNUMBR, Location_Segment, STAXSCHD, PCTAXSCH, INCLDDINPLNNNG, PORECEIPTBIN, PORETRNBIN, SOFULFILLMENTBIN, SORETURNBIN, BOMRCPTBIN, MATERIALISSUEBIN, MORECEIPTBIN, REPAIRISSUESBIN, WMSINT, PICKTICKETSITEOPT, BINBREAK, CCode, DECLID, INACTIVE, DEX_ROW_ID FROM .IV40700 WHERE LOCNDSCR = @LOCNDSCR_RS AND ( LOCNDSCR = @LOCNDSCR AND DEX_ROW_ID > @DEX_ROW_ID OR LOCNDSCR > @LOCNDSCR ) ORDER BY LOCNDSCR ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  LOCNCODE, LOCNDSCR, NOTEINDX, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, COUNTRY, PHONE1, PHONE2, PHONE3, FAXNUMBR, Location_Segment, STAXSCHD, PCTAXSCH, INCLDDINPLNNNG, PORECEIPTBIN, PORETRNBIN, SOFULFILLMENTBIN, SORETURNBIN, BOMRCPTBIN, MATERIALISSUEBIN, MORECEIPTBIN, REPAIRISSUESBIN, WMSINT, PICKTICKETSITEOPT, BINBREAK, CCode, DECLID, INACTIVE, DEX_ROW_ID FROM .IV40700 WHERE LOCNDSCR BETWEEN @LOCNDSCR_RS AND @LOCNDSCR_RE AND ( LOCNDSCR = @LOCNDSCR AND DEX_ROW_ID > @DEX_ROW_ID OR LOCNDSCR > @LOCNDSCR ) ORDER BY LOCNDSCR ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IV40700N_2] TO [DYNGRP]
GO
