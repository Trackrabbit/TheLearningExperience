SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyBOM] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255) select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '' if (@I_vData = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..BM00101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..BM00101 ( [ITEMNMBR],[Bill_Status],[Status_Ord],[BM_Stock_Method],[Effective_Date],[Obsolete_Date], [UOFM],[NOTEINDX],[CREATDDT],[MODIFDT] ) select [ITEMNMBR],[Bill_Status],[Status_Ord],[BM_Stock_Method],[Effective_Date],[Obsolete_Date], [UOFM],[NOTEINDX],[CREATDDT],[MODIFDT] from ' + rtrim(@I_vFromCompany) + '..BM00101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..BM00111' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..BM00111 ( [ITEMNMBR],[Bill_Status],[Status_Ord],[ORD],[CMPTITNM],[Component_Status], [BM_Comp_State],[Cost_Type],[Design_Qty],[Scrap_Percentage],[Effective_Date],[Obsolete_Date], [UOFM],[NOTEINDX] ) select [ITEMNMBR],[Bill_Status],[Status_Ord],[ORD],[CMPTITNM],[Component_Status], [BM_Comp_State],[Cost_Type],[Design_Qty],[Scrap_Percentage],[Effective_Date],[Obsolete_Date], [UOFM],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..BM00111 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..BM40100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..BM40100 ( [SETUPKEY],[Default_Document_Date],[KPTRXHST],[TRX_ID],[AllowQtyOverride],[ALLOWSERLOTLINKING], [USRDFPR1],[USRDRPR2],[USRDRPR3],[USRDRPR4] ) select [SETUPKEY],[Default_Document_Date],[KPTRXHST],[TRX_ID],[AllowQtyOverride],[ALLOWSERLOTLINKING], [USRDFPR1],[USRDRPR2],[USRDRPR3],[USRDRPR4] from ' + rtrim(@I_vFromCompany) + '..BM40100 ' exec(@cStatement) end return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyBOM] TO [DYNGRP]
GO
