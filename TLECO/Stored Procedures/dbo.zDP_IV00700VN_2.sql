SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IV00700VN_2] (@BS int, @ORDRDATE datetime, @ORDDOCID char(15), @ORDRDATE_RS datetime, @ORDDOCID_RS char(15), @ORDRDATE_RE datetime, @ORDDOCID_RE char(15)) AS  set nocount on IF @ORDRDATE_RS IS NULL BEGIN SELECT TOP 25  ORDDOCID, ORDRDATE, PRMDATE, Status, SHIPMTHD, TRXLOCTN, VIALOCN, TRNSTLOC, CUSTNAME, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, COUNTRY, EMPLOYID, NOTEINDX, DEX_ROW_ID FROM .IV00700V WHERE ( ORDRDATE = @ORDRDATE AND ORDDOCID > @ORDDOCID OR ORDRDATE > @ORDRDATE ) ORDER BY ORDRDATE ASC, ORDDOCID ASC END ELSE IF @ORDRDATE_RS = @ORDRDATE_RE BEGIN SELECT TOP 25  ORDDOCID, ORDRDATE, PRMDATE, Status, SHIPMTHD, TRXLOCTN, VIALOCN, TRNSTLOC, CUSTNAME, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, COUNTRY, EMPLOYID, NOTEINDX, DEX_ROW_ID FROM .IV00700V WHERE ORDRDATE = @ORDRDATE_RS AND ORDDOCID BETWEEN @ORDDOCID_RS AND @ORDDOCID_RE AND ( ORDRDATE = @ORDRDATE AND ORDDOCID > @ORDDOCID OR ORDRDATE > @ORDRDATE ) ORDER BY ORDRDATE ASC, ORDDOCID ASC END ELSE BEGIN SELECT TOP 25  ORDDOCID, ORDRDATE, PRMDATE, Status, SHIPMTHD, TRXLOCTN, VIALOCN, TRNSTLOC, CUSTNAME, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, COUNTRY, EMPLOYID, NOTEINDX, DEX_ROW_ID FROM .IV00700V WHERE ORDRDATE BETWEEN @ORDRDATE_RS AND @ORDRDATE_RE AND ORDDOCID BETWEEN @ORDDOCID_RS AND @ORDDOCID_RE AND ( ORDRDATE = @ORDRDATE AND ORDDOCID > @ORDDOCID OR ORDRDATE > @ORDRDATE ) ORDER BY ORDRDATE ASC, ORDDOCID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IV00700VN_2] TO [DYNGRP]
GO
