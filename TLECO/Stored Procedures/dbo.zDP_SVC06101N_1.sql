SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SVC06101N_1] (@BS int, @WORECTYPE smallint, @WORKORDNUM char(11), @LINITMTYP char(3), @CMPNTSEQ int, @LNITMSEQ int, @WORECTYPE_RS smallint, @WORKORDNUM_RS char(11), @LINITMTYP_RS char(3), @CMPNTSEQ_RS int, @LNITMSEQ_RS int, @WORECTYPE_RE smallint, @WORKORDNUM_RE char(11), @LINITMTYP_RE char(3), @CMPNTSEQ_RE int, @LNITMSEQ_RE int) AS  set nocount on IF @WORECTYPE_RS IS NULL BEGIN SELECT TOP 25  WORECTYPE, WORKORDNUM, WOSTAT, LINITMTYP, LNITMSEQ, ITEMNMBR, ITEMUSETYPE, ITEMDESC, STATIONID, LOCNCODE, UOFM, TECHID, QTYORDER, ATYALLOC, QTYBACKO, QTYSOLD, UNITCOST, UNITPRCE, EXTDCOST, XTNDPRCE, STRTDATE, STRTTIME, ENDDATE, ENDTIME, TRANSTME, BILLABLTIM, NOTEINDX, SEQUENCE1, ORDDOCID, TRANSLINESEQ, PONMBRSTR, POLNSEQ, FUFILDAT, CMPNTSEQ, CMPITQTY, DEX_ROW_ID FROM .SVC06101 WHERE ( WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND LINITMTYP = @LINITMTYP AND CMPNTSEQ = @CMPNTSEQ AND LNITMSEQ > @LNITMSEQ OR WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND LINITMTYP = @LINITMTYP AND CMPNTSEQ > @CMPNTSEQ OR WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND LINITMTYP > @LINITMTYP OR WORECTYPE = @WORECTYPE AND WORKORDNUM > @WORKORDNUM OR WORECTYPE > @WORECTYPE ) ORDER BY WORECTYPE ASC, WORKORDNUM ASC, LINITMTYP ASC, CMPNTSEQ ASC, LNITMSEQ ASC END ELSE IF @WORECTYPE_RS = @WORECTYPE_RE BEGIN SELECT TOP 25  WORECTYPE, WORKORDNUM, WOSTAT, LINITMTYP, LNITMSEQ, ITEMNMBR, ITEMUSETYPE, ITEMDESC, STATIONID, LOCNCODE, UOFM, TECHID, QTYORDER, ATYALLOC, QTYBACKO, QTYSOLD, UNITCOST, UNITPRCE, EXTDCOST, XTNDPRCE, STRTDATE, STRTTIME, ENDDATE, ENDTIME, TRANSTME, BILLABLTIM, NOTEINDX, SEQUENCE1, ORDDOCID, TRANSLINESEQ, PONMBRSTR, POLNSEQ, FUFILDAT, CMPNTSEQ, CMPITQTY, DEX_ROW_ID FROM .SVC06101 WHERE WORECTYPE = @WORECTYPE_RS AND WORKORDNUM BETWEEN @WORKORDNUM_RS AND @WORKORDNUM_RE AND LINITMTYP BETWEEN @LINITMTYP_RS AND @LINITMTYP_RE AND CMPNTSEQ BETWEEN @CMPNTSEQ_RS AND @CMPNTSEQ_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE AND ( WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND LINITMTYP = @LINITMTYP AND CMPNTSEQ = @CMPNTSEQ AND LNITMSEQ > @LNITMSEQ OR WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND LINITMTYP = @LINITMTYP AND CMPNTSEQ > @CMPNTSEQ OR WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND LINITMTYP > @LINITMTYP OR WORECTYPE = @WORECTYPE AND WORKORDNUM > @WORKORDNUM OR WORECTYPE > @WORECTYPE ) ORDER BY WORECTYPE ASC, WORKORDNUM ASC, LINITMTYP ASC, CMPNTSEQ ASC, LNITMSEQ ASC END ELSE BEGIN SELECT TOP 25  WORECTYPE, WORKORDNUM, WOSTAT, LINITMTYP, LNITMSEQ, ITEMNMBR, ITEMUSETYPE, ITEMDESC, STATIONID, LOCNCODE, UOFM, TECHID, QTYORDER, ATYALLOC, QTYBACKO, QTYSOLD, UNITCOST, UNITPRCE, EXTDCOST, XTNDPRCE, STRTDATE, STRTTIME, ENDDATE, ENDTIME, TRANSTME, BILLABLTIM, NOTEINDX, SEQUENCE1, ORDDOCID, TRANSLINESEQ, PONMBRSTR, POLNSEQ, FUFILDAT, CMPNTSEQ, CMPITQTY, DEX_ROW_ID FROM .SVC06101 WHERE WORECTYPE BETWEEN @WORECTYPE_RS AND @WORECTYPE_RE AND WORKORDNUM BETWEEN @WORKORDNUM_RS AND @WORKORDNUM_RE AND LINITMTYP BETWEEN @LINITMTYP_RS AND @LINITMTYP_RE AND CMPNTSEQ BETWEEN @CMPNTSEQ_RS AND @CMPNTSEQ_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE AND ( WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND LINITMTYP = @LINITMTYP AND CMPNTSEQ = @CMPNTSEQ AND LNITMSEQ > @LNITMSEQ OR WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND LINITMTYP = @LINITMTYP AND CMPNTSEQ > @CMPNTSEQ OR WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND LINITMTYP > @LINITMTYP OR WORECTYPE = @WORECTYPE AND WORKORDNUM > @WORKORDNUM OR WORECTYPE > @WORECTYPE ) ORDER BY WORECTYPE ASC, WORKORDNUM ASC, LINITMTYP ASC, CMPNTSEQ ASC, LNITMSEQ ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SVC06101N_1] TO [DYNGRP]
GO
