SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SY01200N_2] (@BS int, @Messenger_Address char(201), @Master_Type char(3), @Master_ID char(31), @ADRSCODE char(15), @Messenger_Address_RS char(201), @Master_Type_RS char(3), @Master_ID_RS char(31), @ADRSCODE_RS char(15), @Messenger_Address_RE char(201), @Master_Type_RE char(3), @Master_ID_RE char(31), @ADRSCODE_RE char(15)) AS  set nocount on IF @Messenger_Address_RS IS NULL BEGIN SELECT TOP 25  Master_Type, Master_ID, ADRSCODE, INET1, INET2, INET3, INET4, INET5, INET6, INET7, INET8, Messenger_Address, DEX_ROW_TS, DEX_ROW_ID, INETINFO, EmailToAddress, EmailCcAddress, EmailBccAddress FROM .SY01200 WHERE ( Messenger_Address = @Messenger_Address AND Master_Type = @Master_Type AND Master_ID = @Master_ID AND ADRSCODE > @ADRSCODE OR Messenger_Address = @Messenger_Address AND Master_Type = @Master_Type AND Master_ID > @Master_ID OR Messenger_Address = @Messenger_Address AND Master_Type > @Master_Type OR Messenger_Address > @Messenger_Address ) ORDER BY Messenger_Address ASC, Master_Type ASC, Master_ID ASC, ADRSCODE ASC END ELSE IF @Messenger_Address_RS = @Messenger_Address_RE BEGIN SELECT TOP 25  Master_Type, Master_ID, ADRSCODE, INET1, INET2, INET3, INET4, INET5, INET6, INET7, INET8, Messenger_Address, DEX_ROW_TS, DEX_ROW_ID, INETINFO, EmailToAddress, EmailCcAddress, EmailBccAddress FROM .SY01200 WHERE Messenger_Address = @Messenger_Address_RS AND Master_Type BETWEEN @Master_Type_RS AND @Master_Type_RE AND Master_ID BETWEEN @Master_ID_RS AND @Master_ID_RE AND ADRSCODE BETWEEN @ADRSCODE_RS AND @ADRSCODE_RE AND ( Messenger_Address = @Messenger_Address AND Master_Type = @Master_Type AND Master_ID = @Master_ID AND ADRSCODE > @ADRSCODE OR Messenger_Address = @Messenger_Address AND Master_Type = @Master_Type AND Master_ID > @Master_ID OR Messenger_Address = @Messenger_Address AND Master_Type > @Master_Type OR Messenger_Address > @Messenger_Address ) ORDER BY Messenger_Address ASC, Master_Type ASC, Master_ID ASC, ADRSCODE ASC END ELSE BEGIN SELECT TOP 25  Master_Type, Master_ID, ADRSCODE, INET1, INET2, INET3, INET4, INET5, INET6, INET7, INET8, Messenger_Address, DEX_ROW_TS, DEX_ROW_ID, INETINFO, EmailToAddress, EmailCcAddress, EmailBccAddress FROM .SY01200 WHERE Messenger_Address BETWEEN @Messenger_Address_RS AND @Messenger_Address_RE AND Master_Type BETWEEN @Master_Type_RS AND @Master_Type_RE AND Master_ID BETWEEN @Master_ID_RS AND @Master_ID_RE AND ADRSCODE BETWEEN @ADRSCODE_RS AND @ADRSCODE_RE AND ( Messenger_Address = @Messenger_Address AND Master_Type = @Master_Type AND Master_ID = @Master_ID AND ADRSCODE > @ADRSCODE OR Messenger_Address = @Messenger_Address AND Master_Type = @Master_Type AND Master_ID > @Master_ID OR Messenger_Address = @Messenger_Address AND Master_Type > @Master_Type OR Messenger_Address > @Messenger_Address ) ORDER BY Messenger_Address ASC, Master_Type ASC, Master_ID ASC, ADRSCODE ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY01200N_2] TO [DYNGRP]
GO
