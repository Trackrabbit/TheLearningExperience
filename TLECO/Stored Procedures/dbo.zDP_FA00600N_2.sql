SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_FA00600N_2] (@BS int, @INSCLASSINDX int, @ASSETINDEX int, @INSCLASSINDX_RS int, @ASSETINDEX_RS int, @INSCLASSINDX_RE int, @ASSETINDEX_RE int) AS  set nocount on IF @INSCLASSINDX_RS IS NULL BEGIN SELECT TOP 25  ASSETINDEX, INSCLASSINDX, INSURANCEYEAR, INSURANCEVALUE, REPLACEMENTCOST, REPROCOST, DEPRREPROCOST, EXCLUSIONAMT, EXCLUSIONTYPE, NOTEINDX, LASTMNTDDATE, LASTMNTDTIME, LASTMNTDUSERID, DEX_ROW_ID FROM .FA00600 WHERE ( INSCLASSINDX = @INSCLASSINDX AND ASSETINDEX > @ASSETINDEX OR INSCLASSINDX > @INSCLASSINDX ) ORDER BY INSCLASSINDX ASC, ASSETINDEX ASC END ELSE IF @INSCLASSINDX_RS = @INSCLASSINDX_RE BEGIN SELECT TOP 25  ASSETINDEX, INSCLASSINDX, INSURANCEYEAR, INSURANCEVALUE, REPLACEMENTCOST, REPROCOST, DEPRREPROCOST, EXCLUSIONAMT, EXCLUSIONTYPE, NOTEINDX, LASTMNTDDATE, LASTMNTDTIME, LASTMNTDUSERID, DEX_ROW_ID FROM .FA00600 WHERE INSCLASSINDX = @INSCLASSINDX_RS AND ASSETINDEX BETWEEN @ASSETINDEX_RS AND @ASSETINDEX_RE AND ( INSCLASSINDX = @INSCLASSINDX AND ASSETINDEX > @ASSETINDEX OR INSCLASSINDX > @INSCLASSINDX ) ORDER BY INSCLASSINDX ASC, ASSETINDEX ASC END ELSE BEGIN SELECT TOP 25  ASSETINDEX, INSCLASSINDX, INSURANCEYEAR, INSURANCEVALUE, REPLACEMENTCOST, REPROCOST, DEPRREPROCOST, EXCLUSIONAMT, EXCLUSIONTYPE, NOTEINDX, LASTMNTDDATE, LASTMNTDTIME, LASTMNTDUSERID, DEX_ROW_ID FROM .FA00600 WHERE INSCLASSINDX BETWEEN @INSCLASSINDX_RS AND @INSCLASSINDX_RE AND ASSETINDEX BETWEEN @ASSETINDEX_RS AND @ASSETINDEX_RE AND ( INSCLASSINDX = @INSCLASSINDX AND ASSETINDEX > @ASSETINDEX OR INSCLASSINDX > @INSCLASSINDX ) ORDER BY INSCLASSINDX ASC, ASSETINDEX ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_FA00600N_2] TO [DYNGRP]
GO
