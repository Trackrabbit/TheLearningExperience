SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_CM00100N_3] (@BS int, @CMUSRDF1 char(21), @CHEKBKID char(15), @DEX_ROW_ID int, @CMUSRDF1_RS char(21), @CHEKBKID_RS char(15), @CMUSRDF1_RE char(21), @CHEKBKID_RE char(15)) AS  set nocount on IF @CMUSRDF1_RS IS NULL BEGIN SELECT TOP 25  CHEKBKID, DSCRIPTN, BANKID, CURNCYID, ACTINDX, BNKACTNM, NXTCHNUM, Next_Deposit_Number, INACTIVE, DYDEPCLR, XCDMCHPW, MXCHDLR, DUPCHNUM, OVCHNUM1, LOCATNID, NOTEINDX, CMUSRDF1, CMUSRDF2, Last_Reconciled_Date, Last_Reconciled_Balance, CURRBLNC, CREATDDT, MODIFDT, Recond, Reconcile_In_Progress, Deposit_In_Progress, CHBKPSWD, CURNCYPD, CRNCYRCD, ADPVADLR, ADPVAPWD, DYCHTCLR, CMPANYID, CHKBKTYP, DDACTNUM, DDINDNAM, DDTRANS, PaymentRateTypeID, DepositRateTypeID, CashInTransAcctIdx, DEX_ROW_ID FROM .CM00100 WHERE ( CMUSRDF1 = @CMUSRDF1 AND CHEKBKID = @CHEKBKID AND DEX_ROW_ID > @DEX_ROW_ID OR CMUSRDF1 = @CMUSRDF1 AND CHEKBKID > @CHEKBKID OR CMUSRDF1 > @CMUSRDF1 ) ORDER BY CMUSRDF1 ASC, CHEKBKID ASC, DEX_ROW_ID ASC END ELSE IF @CMUSRDF1_RS = @CMUSRDF1_RE BEGIN SELECT TOP 25  CHEKBKID, DSCRIPTN, BANKID, CURNCYID, ACTINDX, BNKACTNM, NXTCHNUM, Next_Deposit_Number, INACTIVE, DYDEPCLR, XCDMCHPW, MXCHDLR, DUPCHNUM, OVCHNUM1, LOCATNID, NOTEINDX, CMUSRDF1, CMUSRDF2, Last_Reconciled_Date, Last_Reconciled_Balance, CURRBLNC, CREATDDT, MODIFDT, Recond, Reconcile_In_Progress, Deposit_In_Progress, CHBKPSWD, CURNCYPD, CRNCYRCD, ADPVADLR, ADPVAPWD, DYCHTCLR, CMPANYID, CHKBKTYP, DDACTNUM, DDINDNAM, DDTRANS, PaymentRateTypeID, DepositRateTypeID, CashInTransAcctIdx, DEX_ROW_ID FROM .CM00100 WHERE CMUSRDF1 = @CMUSRDF1_RS AND CHEKBKID BETWEEN @CHEKBKID_RS AND @CHEKBKID_RE AND ( CMUSRDF1 = @CMUSRDF1 AND CHEKBKID = @CHEKBKID AND DEX_ROW_ID > @DEX_ROW_ID OR CMUSRDF1 = @CMUSRDF1 AND CHEKBKID > @CHEKBKID OR CMUSRDF1 > @CMUSRDF1 ) ORDER BY CMUSRDF1 ASC, CHEKBKID ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  CHEKBKID, DSCRIPTN, BANKID, CURNCYID, ACTINDX, BNKACTNM, NXTCHNUM, Next_Deposit_Number, INACTIVE, DYDEPCLR, XCDMCHPW, MXCHDLR, DUPCHNUM, OVCHNUM1, LOCATNID, NOTEINDX, CMUSRDF1, CMUSRDF2, Last_Reconciled_Date, Last_Reconciled_Balance, CURRBLNC, CREATDDT, MODIFDT, Recond, Reconcile_In_Progress, Deposit_In_Progress, CHBKPSWD, CURNCYPD, CRNCYRCD, ADPVADLR, ADPVAPWD, DYCHTCLR, CMPANYID, CHKBKTYP, DDACTNUM, DDINDNAM, DDTRANS, PaymentRateTypeID, DepositRateTypeID, CashInTransAcctIdx, DEX_ROW_ID FROM .CM00100 WHERE CMUSRDF1 BETWEEN @CMUSRDF1_RS AND @CMUSRDF1_RE AND CHEKBKID BETWEEN @CHEKBKID_RS AND @CHEKBKID_RE AND ( CMUSRDF1 = @CMUSRDF1 AND CHEKBKID = @CHEKBKID AND DEX_ROW_ID > @DEX_ROW_ID OR CMUSRDF1 = @CMUSRDF1 AND CHEKBKID > @CHEKBKID OR CMUSRDF1 > @CMUSRDF1 ) ORDER BY CMUSRDF1 ASC, CHEKBKID ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_CM00100N_3] TO [DYNGRP]
GO
