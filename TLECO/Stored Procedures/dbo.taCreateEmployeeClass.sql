SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[taCreateEmployeeClass] @I_vEMPLCLAS char(15),     @I_vDSCRIPTN char(30),     @I_vDEPRTMNT char(6)='',    @I_vJOBTITLE char(6)='',    @I_vSUTASTAT char(2)='',    @I_vWRKRCOMP char(6)='',    @I_vMINETPAY numeric(19,5)= 0,    @I_vWKHRPRYR smallint=2080,    @I_vWCACFPAY smallint=0,    @I_vAccountNumber char(75)='',    @I_vUSERDEF1 char(20)='',    @I_vUSERDEF2 char(20)='',    @I_vATACRVAC tinyint=0,     @I_vVACCRMTH smallint=0,    @I_vVACCRAMT numeric(19,5)=0,    @I_vVACAPRYR numeric(19,5)=0,    @I_vVACAVLBL numeric(19,5)=0,    @I_vWRNVCNFLSBLWZR tinyint=1,    @I_vATACRSTM tinyint=0,     @I_vSTMACMTH smallint=0,    @I_vSKTMACAM numeric(19,5)=0,    @I_vSKTMHPYR numeric(19,5)=0,    @I_vSIKTIMAV numeric(19,5)=0,    @I_vWRNSTFLSBLWZR tinyint=1,    @I_vDEFLTCLS tinyint=0,     @I_vCalc_Min_Wage_Bal tinyint=0,   @I_vEMPLOYMENTTYPE smallint=1,    @I_vDefaultFromClass tinyint = 1,   @I_vUpdateIfExists tinyint = 1,    @I_vRequesterTrx smallint = 0,    @I_vUSRDEFND1 char(50) = '',        @I_vUSRDEFND2 char(50) = '',        @I_vUSRDEFND3 char(50) = '',        @I_vUSRDEFND4 varchar(8000) = '',   @I_vUSRDEFND5 varchar(8000) = '',   @O_iErrorState int output,    @oErrString varchar(255) output     with encryption as  set transaction isolation level read uncommitted set nocount on  declare  @ACTINDX int,      @sCompanyID int,  @iStatus int,  @iCustomState int,  @iCustomErrString varchar(255),  @nNextNoteIndex numeric(19,5),    @iGetNextNoteIdxErrState int,    @iAddCodeErrState int,  @O_oErrorState int,  @iError int      select  @ACTINDX = 0,      @O_iErrorState = 0,     @sCompanyID = CMPANYID from DYNAMICS..SY01500 where INTERID = db_name()  if (@oErrString is NULL) begin  select @oErrString = '' end  exec @iStatus = taCreateEmployeeClassPre  @I_vEMPLCLAS output,  @I_vDSCRIPTN output,  @I_vDEPRTMNT output,  @I_vJOBTITLE output,  @I_vSUTASTAT output,  @I_vWRKRCOMP output,  @I_vMINETPAY output,  @I_vWKHRPRYR output,  @I_vWCACFPAY output,  @I_vAccountNumber output,  @I_vUSERDEF1 output,  @I_vUSERDEF2 output,  @I_vATACRVAC output,  @I_vVACCRMTH output,  @I_vVACCRAMT output,  @I_vVACAPRYR output,  @I_vVACAVLBL output,  @I_vWRNVCNFLSBLWZR output,  @I_vATACRSTM output,  @I_vSTMACMTH output,  @I_vSKTMACAM output,  @I_vSKTMHPYR output,  @I_vSIKTIMAV output,  @I_vWRNSTFLSBLWZR output,  @I_vDEFLTCLS output,  @I_vCalc_Min_Wage_Bal output,  @I_vEMPLOYMENTTYPE output,  @I_vDefaultFromClass output,  @I_vUpdateIfExists output,  @I_vRequesterTrx output,  @I_vUSRDEFND1 output,  @I_vUSRDEFND2 output,  @I_vUSRDEFND3 output,  @I_vUSRDEFND4 output,  @I_vUSRDEFND5 output,  @O_iErrorState = @iCustomState output,  @oErrString = @oErrString  output select @iError = @@error if @iStatus = 0 and @iError <> 0 begin  select @iStatus = @iError end if (@iStatus <> 0) or (@iCustomState <> 0) begin  select @O_iErrorState = 4591    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if (  @I_vEMPLCLAS is NULL or  @I_vDSCRIPTN is NULL or  @I_vDEPRTMNT is NULL or  @I_vJOBTITLE is NULL or  @I_vSUTASTAT is NULL or  @I_vWRKRCOMP is NULL or  @I_vMINETPAY is NULL or  @I_vWKHRPRYR is NULL or  @I_vWCACFPAY is NULL or  @I_vAccountNumber is NULL or  @I_vUSERDEF1 is NULL or  @I_vUSERDEF2 is NULL or  @I_vATACRVAC is NULL or  @I_vVACCRMTH is NULL or  @I_vVACCRAMT is NULL or  @I_vVACAPRYR is NULL or  @I_vVACAVLBL is NULL or  @I_vWRNVCNFLSBLWZR is NULL or  @I_vATACRSTM is NULL or  @I_vSTMACMTH is NULL or  @I_vSKTMACAM is NULL or  @I_vSKTMHPYR is NULL or  @I_vSIKTIMAV is NULL or  @I_vWRNSTFLSBLWZR is NULL or  @I_vDEFLTCLS is NULL or  @I_vCalc_Min_Wage_Bal is NULL or  @I_vEMPLOYMENTTYPE is NULL or  @I_vDefaultFromClass is NULL or  @I_vUpdateIfExists is NULL or  @I_vRequesterTrx is NULL or  @I_vUSRDEFND1 is NULL or  @I_vUSRDEFND2 is NULL or  @I_vUSRDEFND3 is NULL or  @I_vUSRDEFND4 is NULL or  @I_vUSRDEFND5 is NULL  ) begin  select @O_iErrorState = 4319    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  select @I_vEMPLCLAS = UPPER(@I_vEMPLCLAS),  @I_vDEPRTMNT = UPPER(@I_vDEPRTMNT),  @I_vJOBTITLE = UPPER(@I_vJOBTITLE),  @I_vSUTASTAT = UPPER(@I_vSUTASTAT),  @I_vWRKRCOMP = UPPER(@I_vWRKRCOMP)  if ( @I_vEMPLCLAS = '' ) begin  select @O_iErrorState = 4320    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vDSCRIPTN = '' ) begin  select @O_iErrorState = 4321    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vDEPRTMNT <> '' ) begin  if (not exists (select 1 from UPR40300 (nolock) where DEPRTMNT = @I_vDEPRTMNT ))  begin  select @O_iErrorState = 4322     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vJOBTITLE <> '' ) begin  if (not exists (select 1 from UPR40301 (nolock) where JOBTITLE = @I_vJOBTITLE ))  begin  select @O_iErrorState = 4323     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vSUTASTAT <> '' ) begin  if (not exists (select 1 from UPR41100 (nolock) where STATECD = @I_vSUTASTAT ))  begin  select @O_iErrorState = 4324     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vWRKRCOMP <> '' ) begin  if (not exists (select 1 from UPR40700 (nolock) where WRKRCOMP = @I_vWRKRCOMP ))  begin  select @O_iErrorState = 4325     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vMINETPAY < 0 ) begin  select @O_iErrorState = 4326     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vWKHRPRYR < 0 or @I_vWKHRPRYR > 9999 ) begin  select @O_iErrorState = 4327     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vWCACFPAY < 0 or @I_vWCACFPAY > 1 ) begin  select @O_iErrorState = 4328     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRVAC < 0 or @I_vATACRVAC > 1) begin  select @O_iErrorState = 4329     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vVACCRMTH < 0 or @I_vVACCRMTH > 1) begin  select @O_iErrorState = 4330     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vWRNVCNFLSBLWZR < 0 or @I_vWRNVCNFLSBLWZR > 1 ) begin  select @O_iErrorState = 4331     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRSTM < 0 or @I_vATACRSTM > 1) begin  select @O_iErrorState = 4332     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSTMACMTH < 0 or @I_vSTMACMTH > 1) begin  select @O_iErrorState = 4333     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vWRNSTFLSBLWZR < 0 or @I_vWRNSTFLSBLWZR > 1 ) begin  select @O_iErrorState = 4334     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vDefaultFromClass < 0 or @I_vDefaultFromClass > 1 )  begin  select @O_iErrorState = 4335     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if  ( @I_vAccountNumber <> '' ) begin  select @ACTINDX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vAccountNumber  if (@ACTINDX is null) or (@ACTINDX = 0)  begin  select @O_iErrorState = 4336     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if ( @I_vDEFLTCLS < 0 or @I_vDEFLTCLS > 1 ) begin  select @O_iErrorState = 4337     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vCalc_Min_Wage_Bal < 0 or @I_vCalc_Min_Wage_Bal > 1 ) begin  select @O_iErrorState = 4338     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vEMPLOYMENTTYPE < 1 or @I_vEMPLOYMENTTYPE > 5 ) begin  select @O_iErrorState = 4339     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  select  @I_vDEPRTMNT =  case  WHEN @I_vDEPRTMNT = '' and @I_vDefaultFromClass = 1  THEN DEPRTMNT  ELSE @I_vDEPRTMNT  end,  @I_vJOBTITLE =  case  WHEN @I_vJOBTITLE = '' and @I_vDefaultFromClass = 1  THEN JOBTITLE  ELSE @I_vJOBTITLE  end,  @I_vSUTASTAT =  case  WHEN @I_vSUTASTAT = '' and @I_vDefaultFromClass = 1  THEN SUTASTAT  ELSE @I_vSUTASTAT  end,   @I_vWRKRCOMP =  case  WHEN @I_vWRKRCOMP = '' and @I_vDefaultFromClass = 1  THEN WRKRCOMP  ELSE @I_vWRKRCOMP  end,  @I_vMINETPAY =  case  WHEN @I_vMINETPAY = 0 and @I_vDefaultFromClass = 1  THEN MINETPAY  WHEN @I_vMINETPAY = 0 and @I_vDefaultFromClass = 0  THEN 0  ELSE @I_vMINETPAY  end,  @I_vWKHRPRYR =  case  WHEN @I_vWKHRPRYR = 2080 and @I_vDefaultFromClass = 1  THEN WKHRPRYR  WHEN @I_vWKHRPRYR = 2080 and @I_vDefaultFromClass = 0  THEN 2080  ELSE @I_vWKHRPRYR  end,  @I_vUSERDEF1 =  case  WHEN @I_vUSERDEF1 = '' and @I_vDefaultFromClass = 1  THEN USERDEF1  ELSE @I_vUSERDEF1  end,  @I_vUSERDEF2 =  case  WHEN @I_vUSERDEF2 = '' and @I_vDefaultFromClass = 1  THEN USERDEF2  ELSE @I_vUSERDEF2  end,  @I_vATACRVAC =  case  WHEN @I_vATACRVAC = 0 and @I_vDefaultFromClass = 1  THEN ATACRVAC  WHEN @I_vATACRVAC = 0 and @I_vDefaultFromClass = 0  THEN 0  ELSE @I_vATACRVAC  end,  @I_vVACCRMTH =  case  WHEN @I_vVACCRMTH = 0 and @I_vDefaultFromClass = 1  THEN VACCRMTH  WHEN @I_vVACCRMTH = 0   THEN 0  ELSE @I_vVACCRMTH  end,  @I_vVACCRAMT =  case  WHEN @I_vVACCRAMT = 0 and @I_vDefaultFromClass = 1  THEN VACCRAMT  WHEN @I_vVACCRAMT = 0 and @I_vDefaultFromClass = 0  THEN VACCRAMT  WHEN @I_vATACRVAC = 0 or @I_vVACCRMTH = 0   THEN 0  ELSE @I_vVACCRAMT * 100  end,  @I_vVACAPRYR =  case  WHEN @I_vVACAPRYR = 0 and @I_vDefaultFromClass = 1  THEN VACAPRYR  WHEN @I_vVACAPRYR = 0 and @I_vDefaultFromClass = 0  THEN 0  WHEN @I_vATACRVAC = 0  THEN 0   ELSE @I_vVACAPRYR * 100  end,  @I_vVACAVLBL =  case  WHEN @I_vVACAVLBL = 0 and @I_vDefaultFromClass = 1  THEN VACAVLBL  WHEN @I_vVACAVLBL = 0 and @I_vDefaultFromClass = 0  THEN 0  ELSE @I_vVACAVLBL * 100  end,  @I_vWRNVCNFLSBLWZR =  case  WHEN @I_vWRNVCNFLSBLWZR = 1 and @I_vDefaultFromClass = 1  THEN WRNVCNFLSBLWZR  WHEN @I_vWRNVCNFLSBLWZR = 1 and @I_vDefaultFromClass = 0  THEN 1  ELSE @I_vWRNVCNFLSBLWZR  end,  @I_vATACRSTM =  case  WHEN @I_vATACRSTM = 0 and @I_vDefaultFromClass = 1  THEN ATACRSTM  WHEN @I_vATACRSTM = 0 and @I_vDefaultFromClass = 0  THEN 0  ELSE @I_vATACRSTM  end,  @I_vSKTMACAM =  case  WHEN @I_vSKTMACAM = 0 and @I_vDefaultFromClass = 1  THEN SKTMACAM  WHEN @I_vSKTMACAM = 0 and @I_vDefaultFromClass = 0  THEN 0  WHEN @I_vATACRSTM = 0   THEN 0  ELSE @I_vSKTMACAM * 100  end,  @I_vSKTMHPYR =  case  WHEN @I_vSKTMHPYR = 0 and @I_vDefaultFromClass = 1  THEN SKTMHPYR  WHEN @I_vSKTMHPYR = 0 and @I_vDefaultFromClass = 0  THEN 0  WHEN @I_vATACRSTM = 0   THEN 0  ELSE @I_vSKTMHPYR * 100  end,  @I_vSIKTIMAV =  case  WHEN @I_vSIKTIMAV = 0 and @I_vDefaultFromClass = 1  THEN SIKTIMAV  WHEN @I_vSIKTIMAV = 0 and @I_vDefaultFromClass = 0  THEN 0  ELSE @I_vSIKTIMAV * 100  end,  @I_vWRNSTFLSBLWZR =  case  WHEN @I_vWRNSTFLSBLWZR = 1 and @I_vDefaultFromClass = 1  THEN WRNSTFLSBLWZR  WHEN @I_vWRNSTFLSBLWZR = 1 and @I_vDefaultFromClass = 0  THEN 1  ELSE @I_vWRNSTFLSBLWZR  end,  @I_vCalc_Min_Wage_Bal =  case  WHEN @I_vCalc_Min_Wage_Bal = 0 and @I_vDefaultFromClass = 1  THEN Calc_Min_Wage_Bal  WHEN @I_vCalc_Min_Wage_Bal = 0 and @I_vDefaultFromClass = 0  THEN 0  ELSE @I_vCalc_Min_Wage_Bal  end,  @I_vEMPLOYMENTTYPE =  case  WHEN @I_vEMPLOYMENTTYPE = 1 and @I_vDefaultFromClass = 1  THEN EMPLOYMENTTYPE  WHEN @I_vEMPLOYMENTTYPE = 1 and @I_vDefaultFromClass = 0   THEN 1  ELSE @I_vEMPLOYMENTTYPE  end,  @ACTINDX =  case  WHEN @ACTINDX = 0 and @I_vDefaultFromClass = 1  THEN ACTINDX  ELSE @ACTINDX  end  from UPR41200 (nolock)  where DEFLTCLS = 1  if ( @I_vATACRVAC = 1 and @I_vVACCRMTH = 0 and @I_vDefaultFromClass = 1 ) begin  select @I_vVACCRAMT = 0 end  if ( @I_vATACRSTM = 1 and @I_vSTMACMTH = 0 and @I_vDefaultFromClass = 1 ) begin  select @I_vSKTMACAM = 0 end  if ( @I_vATACRVAC = 1 and @I_vVACCRMTH = 1 and @I_vDefaultFromClass = 1 ) begin  select @I_vVACAPRYR = 0 end  if ( @I_vATACRSTM = 1 and @I_vSTMACMTH = 1 and @I_vDefaultFromClass = 1 ) begin  select @I_vSKTMHPYR = 0 end  if ( @I_vATACRVAC = 0 and @I_vVACCRMTH <> 0 ) begin  select @O_iErrorState = 4340     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRVAC = 0 and @I_vVACCRAMT <> 0 ) begin  select @O_iErrorState = 4341     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRVAC = 0 and @I_vVACAPRYR <> 0 ) begin  select @O_iErrorState = 4342     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vVACCRMTH = 0 ) and ( @I_vVACCRAMT <> 0 ) begin  select @O_iErrorState = 4343     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRSTM = 0 and @I_vSTMACMTH <> 0 ) begin  select @O_iErrorState = 4344     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRSTM = 0 and @I_vSKTMHPYR <> 0 ) begin  select @O_iErrorState = 4345     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRSTM = 0 ) and ( @I_vSKTMHPYR <> 0 ) begin  select @O_iErrorState = 4346     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSTMACMTH = 0 ) and ( @I_vSKTMACAM <> 0 ) begin  select @O_iErrorState = 4347     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRVAC = 1 and @I_vVACCRMTH = 0 and @I_vVACCRAMT <> 0 ) begin  select @O_iErrorState = 4348     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRSTM = 1 and @I_vSTMACMTH = 0 and @I_vSKTMACAM <> 0 ) begin  select @O_iErrorState = 4349     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRVAC = 1 and @I_vVACCRMTH = 1 and @I_vVACAPRYR <> 0 ) begin  select @O_iErrorState = 4350     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRSTM = 1 and @I_vSTMACMTH = 1 and @I_vSKTMHPYR <> 0 ) begin  select @O_iErrorState = 4351     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vUpdateIfExists < 0 or @I_vUpdateIfExists > 1)  begin  select @O_iErrorState = 4352     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vRequesterTrx < 0 or @I_vRequesterTrx > 1)  begin  select @O_iErrorState = 4353     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if @O_iErrorState <> 0  return (@O_iErrorState)  exec @iStatus = DYNAMICS..tasmGetNextNoteIndex  @I_sCompanyID   = @sCompanyID,  @I_iSQLSessionID = 0,  @I_noteincrement  = 1,  @O_mNoteIndex   = @nNextNoteIndex output,  @O_iErrorState  = @iGetNextNoteIdxErrState output select @iError = @@error if ((@iStatus <> 0) or (@iGetNextNoteIdxErrState <> 0) or (@iError <> 0)) begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@iGetNextNoteIdxErrState))  select @O_iErrorState = 4354   exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if ( @I_vDEFLTCLS = 1 ) begin  if exists (select 1 from UPR41200 (nolock) where DEFLTCLS = 1 and EMPLCLAS <> @I_vEMPLCLAS )  begin  update UPR41200 set DEFLTCLS = 0 where DEFLTCLS = 1 and EMPLCLAS <> @I_vEMPLCLAS  if @@error <> 0   begin  select @O_iErrorState = 4355     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end  end end  if not exists( select 1 from UPR41200 (nolock) where EMPLCLAS = @I_vEMPLCLAS ) begin  insert UPR41200(  EMPLCLAS,  DSCRIPTN,  DEPRTMNT,  JOBTITLE,  SUTASTAT,  WRKRCOMP,  MINETPAY,  WKHRPRYR,  WCACFPAY,  ACTINDX,  USERDEF1,  USERDEF2,  ATACRVAC,  VACCRMTH,  VACCRAMT,  VACAPRYR,  VACAVLBL,  WRNVCNFLSBLWZR,  ATACRSTM,  STMACMTH,  SKTMACAM,  SKTMHPYR,  SIKTIMAV,  WRNSTFLSBLWZR,  DEFLTCLS,  Calc_Min_Wage_Bal,  EMPLOYMENTTYPE,  NOTEINDX  )  select  @I_vEMPLCLAS,    @I_vDSCRIPTN,    @I_vDEPRTMNT,    @I_vJOBTITLE,    @I_vSUTASTAT,    @I_vWRKRCOMP,    @I_vMINETPAY,    @I_vWKHRPRYR,    @I_vWCACFPAY,    @ACTINDX,    @I_vUSERDEF1,    @I_vUSERDEF2,    @I_vATACRVAC,    @I_vVACCRMTH,    @I_vVACCRAMT,    @I_vVACAPRYR,    @I_vVACAVLBL,    @I_vWRNVCNFLSBLWZR,   @I_vATACRSTM,    @I_vSTMACMTH,    @I_vSKTMACAM,    @I_vSKTMHPYR,    @I_vSIKTIMAV,    @I_vWRNSTFLSBLWZR,   @I_vDEFLTCLS,    @I_vCalc_Min_Wage_Bal,   @I_vEMPLOYMENTTYPE,   @nNextNoteIndex    if @@error <> 0  begin  select @O_iErrorState = 4356     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end else if ( @I_vUpdateIfExists = 1 ) begin  update UPR41200   set DSCRIPTN =  case  WHEN @I_vDSCRIPTN = ''  THEN DSCRIPTN  ELSE @I_vDSCRIPTN  end,  DEPRTMNT = @I_vDEPRTMNT,  JOBTITLE = @I_vJOBTITLE,  SUTASTAT = @I_vSUTASTAT,  WRKRCOMP = @I_vWRKRCOMP,  MINETPAY = @I_vMINETPAY,  WKHRPRYR = @I_vWKHRPRYR,  WCACFPAY = @I_vWCACFPAY,  ACTINDX = @ACTINDX,  USERDEF1 = @I_vUSERDEF1,  USERDEF2 = @I_vUSERDEF2,  ATACRVAC = @I_vATACRVAC,  VACCRMTH =  case  WHEN @I_vATACRVAC = 0  THEN 0   ELSE @I_vVACCRMTH  end,  VACCRAMT =  case  WHEN @I_vVACCRMTH = 0  THEN 0   ELSE @I_vVACCRAMT  end ,  VACAPRYR =  case  WHEN @I_vATACRVAC = 1 and @I_vVACCRMTH = 1  THEN 0   ELSE @I_vVACAPRYR  end,  VACAVLBL = @I_vVACAVLBL ,  WRNVCNFLSBLWZR = @I_vWRNVCNFLSBLWZR,  ATACRSTM = @I_vATACRSTM,  STMACMTH =  case  WHEN @I_vATACRSTM = 0  THEN 0   ELSE @I_vSTMACMTH  end,  SKTMACAM =  case  WHEN @I_vSTMACMTH = 0  THEN 0  else @I_vSKTMACAM  end,  SKTMHPYR =  case  WHEN @I_vATACRSTM = 1 and @I_vSTMACMTH = 1  THEN 0  ELSE @I_vSKTMHPYR  end,  SIKTIMAV = @I_vSIKTIMAV,  WRNSTFLSBLWZR = @I_vWRNSTFLSBLWZR,  DEFLTCLS = @I_vDEFLTCLS,  Calc_Min_Wage_Bal = @I_vCalc_Min_Wage_Bal,  EMPLOYMENTTYPE = @I_vEMPLOYMENTTYPE  where  EMPLCLAS = @I_vEMPLCLAS  if @@error <> 0  begin  select @O_iErrorState = 4357     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end  exec @iStatus = taCreateEmployeeClassPost  @I_vEMPLCLAS,  @I_vDSCRIPTN,  @I_vDEPRTMNT,  @I_vJOBTITLE,  @I_vSUTASTAT,  @I_vWRKRCOMP,  @I_vMINETPAY,  @I_vWKHRPRYR,  @I_vWCACFPAY,  @I_vAccountNumber,  @I_vUSERDEF1,  @I_vUSERDEF2,  @I_vATACRVAC,  @I_vVACCRMTH,  @I_vVACCRAMT,  @I_vVACAPRYR,  @I_vVACAVLBL,  @I_vWRNVCNFLSBLWZR,  @I_vATACRSTM,  @I_vSTMACMTH,  @I_vSKTMACAM,  @I_vSKTMHPYR,  @I_vSIKTIMAV,  @I_vWRNSTFLSBLWZR,  @I_vDEFLTCLS,  @I_vCalc_Min_Wage_Bal,  @I_vEMPLOYMENTTYPE,  @I_vDefaultFromClass,  @I_vUpdateIfExists,  @I_vRequesterTrx,  @I_vUSRDEFND1,  @I_vUSRDEFND2,  @I_vUSRDEFND3,  @I_vUSRDEFND4,  @I_vUSRDEFND5,  @O_iErrorState = @iCustomState output,  @oErrString = @oErrString  output select @iError = @@error if @iStatus = 0 and @iError <> 0 begin  select @iStatus = @iError end if (@iStatus <> 0) or (@iCustomState <> 0) begin  select @O_iErrorState = 4358     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  return (@O_iErrorState)   
GO
GRANT EXECUTE ON  [dbo].[taCreateEmployeeClass] TO [DYNGRP]
GO
