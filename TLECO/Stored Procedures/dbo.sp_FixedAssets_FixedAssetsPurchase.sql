SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_FixedAssets_FixedAssetsPurchase] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @Asset_ID varchar(255), @Suf varchar(255), @Description varchar(255), @Date varchar(255), @Acquisition_Cost varchar(255), @Vendor_ID varchar(255), @Asset_Description varchar(255), @Asset_Class_ID varchar(255), @Structure_ID varchar(255), @Location_ID varchar(255), @Physical_Location_ID varchar(255), @Master_Asset_ID varchar(255), @Asset_Type varchar(255), @Acquisition_Date varchar(255), @Acquisition_Cost__General_ varchar(255), @Asset_Label varchar(255), @Asset_Status varchar(255), @Property_Type varchar(255), @Asset_Quantity varchar(255), @Extended_Description varchar(255), @Short_Name varchar(255), @PIN varchar(255), @Verified_Date varchar(255), @Custodian varchar(255), @Manufacturer_Name varchar(255), @Serial_Number varchar(255), @Model_Number varchar(255), @Warranty_Date varchar(255), @Last_Maintenance_Date varchar(255), @Current_Maintenance_Amount varchar(255), @YTD_Maintenance_Amount varchar(255), @LTD_Maintenance_Amount varchar(255), @Date_Added varchar(255), @Last_Purchase_Line_Sequence varchar(255), @Note_Index varchar(255), @Originating_Acquisition_Cost varchar(255), @Currency_ID varchar(255), @Currency_Index varchar(255), @Exchange_Rate varchar(255), @Exchange_Date varchar(255), @Time varchar(255), @Exchange_Table_ID varchar(255), @Rate_Type_ID varchar(255), @Rate_Calculation_Method varchar(255), @Denomination_Exchange_Rate varchar(255), @MC_Transaction_State varchar(255), @Document_Number varchar(255), @TRX_Source varchar(255), @Voucher___Receipt_Number varchar(255), @Purchase_Order_Number varchar(255), @Last_Maintained_Date varchar(255), @Last_Maintained_Time varchar(255), @Last_Maintained_User_ID varchar(255), @Purchase_Line_Sequence varchar(255), @Asset_Index varchar(255), @AP_Post_Index varchar(255), @DrillBack_Base_Url varchar(255), @DrillBack_Base_Url_For_FA varchar(255), @Asset_Index_For_DrillBack varchar(255), @Vendor_ID_For_DrillBack varchar(255)  select @DrillBack_Base_Url = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),0) select @DrillBack_Base_Url_For_FA = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),309)  select @I_iDictID = 309 select @I_iMessageNumber = 2 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 3 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Suf output  select @I_iDictID = 309 select @I_iMessageNumber = 102 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Description output  select @I_iDictID = 309 select @I_iMessageNumber = 107 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Date output  select @I_iDictID = 309 select @I_iMessageNumber = 103 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Acquisition_Cost output  select @I_iDictID = 309 select @I_iMessageNumber = 105 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vendor_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 4 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Description output  select @I_iDictID = 309 select @I_iMessageNumber = 10 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Class_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 19 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Structure_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 15 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Location_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 14 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Physical_Location_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 12 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Master_Asset_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 33 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Type output  select @I_iDictID = 309 select @I_iMessageNumber = 6 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Acquisition_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 7 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Acquisition_Cost__General_ output  select @I_iDictID = 309 select @I_iMessageNumber = 16 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Label output  select @I_iDictID = 309 select @I_iMessageNumber = 34 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Status output  select @I_iDictID = 309 select @I_iMessageNumber = 35 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Property_Type output  select @I_iDictID = 309 select @I_iMessageNumber = 5 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Quantity output  select @I_iDictID = 309 select @I_iMessageNumber = 8 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Extended_Description output  select @I_iDictID = 309 select @I_iMessageNumber = 9 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Short_Name output  select @I_iDictID = 309 select @I_iMessageNumber = 17 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @PIN output  select @I_iDictID = 309 select @I_iMessageNumber = 18 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Verified_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 20 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Custodian output  select @I_iDictID = 309 select @I_iMessageNumber = 21 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Manufacturer_Name output  select @I_iDictID = 309 select @I_iMessageNumber = 42 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Serial_Number output  select @I_iDictID = 309 select @I_iMessageNumber = 43 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Model_Number output  select @I_iDictID = 309 select @I_iMessageNumber = 44 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Warranty_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 22 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Maintenance_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 37 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Current_Maintenance_Amount output  select @I_iDictID = 309 select @I_iMessageNumber = 38 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @YTD_Maintenance_Amount output  select @I_iDictID = 309 select @I_iMessageNumber = 39 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @LTD_Maintenance_Amount output  select @I_iDictID = 309 select @I_iMessageNumber = 23 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Date_Added output  select @I_iDictID = 309 select @I_iMessageNumber = 59 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Purchase_Line_Sequence output  select @I_iDictID = 309 select @I_iMessageNumber = 45 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Note_Index output  select @I_iDictID = 309 select @I_iMessageNumber = 104 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Acquisition_Cost output  select @I_iDictID = 309 select @I_iMessageNumber = 112 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Currency_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 113 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Currency_Index output  select @I_iDictID = 309 select @I_iMessageNumber = 115 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Rate output  select @I_iDictID = 309 select @I_iMessageNumber = 114 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 116 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Time output  select @I_iDictID = 309 select @I_iMessageNumber = 117 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Table_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 118 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Rate_Type_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 119 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Rate_Calculation_Method output  select @I_iDictID = 309 select @I_iMessageNumber = 120 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Denomination_Exchange_Rate output  select @I_iDictID = 309 select @I_iMessageNumber = 121 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @MC_Transaction_State output  select @I_iDictID = 309 select @I_iMessageNumber = 106 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Document_Number output  select @I_iDictID = 309 select @I_iMessageNumber = 108 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TRX_Source output  select @I_iDictID = 309 select @I_iMessageNumber = 109 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Voucher___Receipt_Number output  select @I_iDictID = 309 select @I_iMessageNumber = 110 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purchase_Order_Number output  select @I_iDictID = 309 select @I_iMessageNumber = 122 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Maintained_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 123 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Maintained_Time output  select @I_iDictID = 309 select @I_iMessageNumber = 124 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Maintained_User_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 101 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purchase_Line_Sequence output  select @I_iDictID = 309 select @I_iMessageNumber = 100 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Index output  select @I_iDictID = 309 select @I_iMessageNumber = 111 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @AP_Post_Index output   select @I_iDictID = 309 select @I_iMessageNumber = 100 select @I_iAliasMessageNumber = 22617 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Index_For_DrillBack output   select @I_iDictID = 309 select @I_iMessageNumber = 105 select @I_iAliasMessageNumber = 22617 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vendor_ID_For_DrillBack output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[FixedAssetsPurchase]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[FixedAssetsPurchase] '  select @sqldefaultstring =   'CREATE VIEW FixedAssetsPurchase AS ' +   'select ' +   'rtrim([''Asset General Information Master''].[ASSETID]) as ''' + @Asset_ID + ''', ' + '[''Asset General Information Master''].[ASSETIDSUF] as ''' + @Suf + ''', ' + 'rtrim([''Asset Purchase Master''].[PURCHDESC]) as ''' + @Description + ''', ' + '[''Asset Purchase Master''].[DOCDATE] as ''' + @Date + ''', ' + '[''Asset Purchase Master''].[Acquisition_Cost] as ''' + @Acquisition_Cost + ''', ' + 'rtrim([''Asset Purchase Master''].[VENDORID]) as ''' + @Vendor_ID + ''', '   select @sqlstring1 =   '[''Asset Purchase Master''].[FA_AP_Post_Index] as ''' + @AP_Post_Index + ''', ' +  '[''Asset Purchase Master''].[Acquisition_Cost] as ''' + @Acquisition_Cost__General_ + ''', ' +  '[''Asset General Information Master''].[ACQDATE] as ''' + @Acquisition_Date + ''', ' +  'rtrim([''Asset General Information Master''].[ASSETCLASSID]) as ''' + @Asset_Class_ID + ''', ' +  'rtrim([''Asset General Information Master''].[ASSETDESC]) as ''' + @Asset_Description + ''', ' +  '[''Asset Purchase Master''].[ASSETINDEX] as ''' + @Asset_Index + ''', ' +  'rtrim([''Asset General Information Master''].[Asset_Label]) as ''' + @Asset_Label + ''', ' +  '[''Asset General Information Master''].[ASSETQTY] as ''' + @Asset_Quantity + ''', ' +  '''' + @Asset_Status + ''' = dbo.FA_FUNC_Asset_Status([''Asset General Information Master''].[ASSETSTATUS]), ' +  '''' + @Asset_Type + ''' = dbo.FA_FUNC_Asset_Type([''Asset General Information Master''].[ASSETTYPE]), ' +  'rtrim([''Asset Purchase Master''].[CURNCYID]) as ''' + @Currency_ID + ''', ' +  '[''Asset Purchase Master''].[CURRNIDX] as ''' + @Currency_Index + ''', ' +  '[''Asset General Information Master''].[ASSETCURRMAINT] as ''' + @Current_Maintenance_Amount + ''', ' +  'rtrim([''Asset General Information Master''].[CUSTODIAN]) as ''' + @Custodian + ''', ' +  '[''Asset General Information Master''].[DATEADDED] as ''' + @Date_Added + ''', ' +  '[''Asset Purchase Master''].[DENXRATE] as ''' + @Denomination_Exchange_Rate + ''', ' +  'rtrim([''Asset Purchase Master''].[DOCNUMBR]) as ''' + @Document_Number + ''', ' +  '[''Asset Purchase Master''].[EXCHDATE] as ''' + @Exchange_Date + ''', ' +  '[''Asset Purchase Master''].[XCHGRATE] as ''' + @Exchange_Rate + ''', ' +  'rtrim([''Asset Purchase Master''].[EXGTBLID]) as ''' + @Exchange_Table_ID + ''', ' +  'rtrim([''Asset General Information Master''].[EXTASSETDESC]) as ''' + @Extended_Description + ''', ' +  '[''Asset General Information Master''].[ASSETLTDMAINT] as ''' + @LTD_Maintenance_Amount + ''', ' +  '[''Asset Purchase Master''].[LASTMNTDDATE] as ''' + @Last_Maintained_Date + ''', ' +  '[''Asset Purchase Master''].[LASTMNTDTIME] as ''' + @Last_Maintained_Time + ''', ' +  'rtrim([''Asset Purchase Master''].[LASTMNTDUSERID]) as ''' + @Last_Maintained_User_ID + ''', ' +  '[''Asset General Information Master''].[LASTMAINTDATE] as ''' + @Last_Maintenance_Date + ''', ' +  '[''Asset General Information Master''].[LASTPURCHLINESEQ] as ''' + @Last_Purchase_Line_Sequence + ''', ' +  'rtrim([''Asset General Information Master''].[LOCATNID]) as ''' + @Location_ID + ''', ' +  '[''Asset Purchase Master''].[MCTRXSTT] as ''' + @MC_Transaction_State + ''', ' +  'rtrim([''Asset General Information Master''].[MFGRNAME]) as ''' + @Manufacturer_Name + ''', ' +  'rtrim([''Asset General Information Master''].[Master_Asset_ID]) as ''' + @Master_Asset_ID + ''', ' +  'rtrim([''Asset General Information Master''].[MODELNUMBER]) as ''' + @Model_Number + ''', ' +  '[''Asset General Information Master''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  '[''Asset Purchase Master''].[Orig_Acquisition_Cost] as ''' + @Originating_Acquisition_Cost + ''', ' +  'rtrim([''Asset General Information Master''].[PIN]) as ''' + @PIN + ''', ' +  'rtrim([''Asset General Information Master''].[Physical_Location_ID]) as ''' + @Physical_Location_ID + ''', ' +  '''' + @Property_Type + ''' = dbo.FA_FUNC_Property_Type([''Asset General Information Master''].[PROPTYPE]), ' +  '[''Asset Purchase Master''].[PURCHLINESEQ] as ''' + @Purchase_Line_Sequence + ''', ' +  'rtrim([''Asset Purchase Master''].[PORDNMBR]) as ''' + @Purchase_Order_Number + ''', ' +  'rtrim([''Asset Purchase Master''].[RTCLCMTD]) as ''' + @Rate_Calculation_Method + ''', ' +  'rtrim([''Asset Purchase Master''].[RATETPID]) as ''' + @Rate_Type_ID + ''', ' +  'rtrim([''Asset General Information Master''].[SERLNMBR]) as ''' + @Serial_Number + ''', ' +  'rtrim([''Asset General Information Master''].[SHRTNAME]) as ''' + @Short_Name + ''', ' +  'rtrim([''Asset General Information Master''].[STRUCTUREID]) as ''' + @Structure_ID + ''', ' +  'rtrim([''Asset Purchase Master''].[TRXSORCE]) as ''' + @TRX_Source + ''', ' +  '[''Asset Purchase Master''].[TIME1] as ''' + @Time + ''', ' +  '[''Asset General Information Master''].[Verified_Date] as ''' + @Verified_Date + ''', ' +  'rtrim([''Asset Purchase Master''].[ORCTRNUM]) as ''' + @Voucher___Receipt_Number + ''', ' +  '[''Asset General Information Master''].[WARRENTYDATE] as ''' + @Warranty_Date + ''', ' +  '[''Asset General Information Master''].[ASSETYTDMAINT] as ''' + @YTD_Maintenance_Amount + ''', '   select @sqlstring2 =  '''' + @Asset_Index_For_DrillBack + ''' = ''' + @DrillBack_Base_Url_For_FA + ''' +dbo.dgppAssetIndex(1,[''Asset Purchase Master''].[ASSETINDEX] ), '+ '''' + @Vendor_ID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppVendorID(1,[''Asset Purchase Master''].[VENDORID] ) '  select @sqljoinstring =   'from [FA01400] as [''Asset Purchase Master''] with (NOLOCK) '   + 'left outer join [FA00100] as [''Asset General Information Master''] with (NOLOCK) on '   + '[''Asset Purchase Master''].[ASSETINDEX] = [''Asset General Information Master''].[ASSETINDEX] '   select @sqlaccessstring =   'GRANT SELECT ON [dbo].[FixedAssetsPurchase] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[FixedAssetsPurchase] TO [rpt_accounting manager]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_FixedAssets_FixedAssetsPurchase] TO [DYNGRP]
GO
