SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyPM] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255) select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '' if (@I_vData = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PM00100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PM00100 ( [VNDCLSID],[VNDCLDSC],[DEFLTCLS],[MXIAFVND],[MXINVAMT],[WRITEOFF], [CREDTLMT],[TEN99TYPE],[PTCSHACF],[MXWOFAMT],[MINORDER],[CRLMTDLR], [PYMNTPRI],[SHIPMTHD],[PYMTRMID],[MINPYTYP],[MINPYDLR],[MINPYPCT], [CURNCYID],[TAXSCHID],[KPCALHST],[KGLDSTHS],[KPERHIST],[KPTRXHST], [TRDDISCT],[USERDEF1],[USERDEF2],[PMAPINDX],[PMCSHIDX],[PMDAVIDX], [PMDTKIDX],[PMFINIDX],[PMMSCHIX],[PMFRTIDX],[PMTAXIDX],[PMWRTIDX], [PMPRCHIX],[PMRTNGIX],[PMTDSCIX],[ACPURIDX],[PURPVIDX],[CHEKBKID], [MODIFDT],[CREATDDT],[RATETPID],[Revalue_Vendor],[Post_Results_To],[FREEONBOARD], [DISGRPER],[DUEGRPER],[TaxInvRecvd],[CBVAT] ) select [VNDCLSID],[VNDCLDSC],[DEFLTCLS],[MXIAFVND],[MXINVAMT],[WRITEOFF], [CREDTLMT],[TEN99TYPE],[PTCSHACF],[MXWOFAMT],[MINORDER],[CRLMTDLR], [PYMNTPRI],[SHIPMTHD],[PYMTRMID],[MINPYTYP],[MINPYDLR],[MINPYPCT], [CURNCYID],[TAXSCHID],[KPCALHST],[KGLDSTHS],[KPERHIST],[KPTRXHST], [TRDDISCT],[USERDEF1],[USERDEF2],[PMAPINDX],[PMCSHIDX],[PMDAVIDX], [PMDTKIDX],[PMFINIDX],[PMMSCHIX],[PMFRTIDX],[PMTAXIDX],[PMWRTIDX], [PMPRCHIX],[PMRTNGIX],[PMTDSCIX],[ACPURIDX],[PURPVIDX],[CHEKBKID], [MODIFDT],[CREATDDT],[RATETPID],[Revalue_Vendor],[Post_Results_To],[FREEONBOARD], [DISGRPER],[DUEGRPER],[TaxInvRecvd],[CBVAT] from ' + rtrim(@I_vFromCompany) + '..PM00100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PM00101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PM00101 ( [VNDCLSID],[DISTTYPE],[SEQNUMBR],[ACTINDX],[Default_On_Trx] ) select [VNDCLSID],[DISTTYPE],[SEQNUMBR],[ACTINDX],[Default_On_Trx] from ' + rtrim(@I_vFromCompany) + '..PM00101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PM00200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PM00200 ( [VENDORID],[VENDNAME],[VNDCHKNM],[VENDSHNM],[VADDCDPR],[VADCDPAD], [VADCDSFR],[VADCDTRO],[VNDCLSID],[VNDCNTCT],[ADDRESS1],[ADDRESS2], [ADDRESS3],[CITY],[STATE],[ZIPCODE],[COUNTRY],[PHNUMBR1], [PHNUMBR2],[PHONE3],[FAXNUMBR],[UPSZONE],[SHIPMTHD],[TAXSCHID], [ACNMVNDR],[TXIDNMBR],[VENDSTTS],[CURNCYID],[TXRGNNUM],[PARVENID], [TRDDISCT],[TEN99TYPE],[TEN99BOXNUMBER],[MINORDER],[PYMTRMID],[MINPYTYP], [MINPYPCT],[MINPYDLR],[MXIAFVND],[MAXINDLR],[COMMENT1],[COMMENT2], [USERDEF1],[USERDEF2],[CRLMTDLR],[PYMNTPRI],[KPCALHST],[KGLDSTHS], [KPERHIST],[KPTRXHST],[HOLD],[PTCSHACF],[CREDTLMT],[WRITEOFF], [MXWOFAMT],[SBPPSDED],[PPSTAXRT],[DXVARNUM],[CRTCOMDT],[CRTEXPDT], [RTOBUTKN],[XPDTOBLG],[PRSPAYEE],[PMAPINDX],[PMCSHIDX],[PMDAVIDX], [PMDTKIDX],[PMFINIDX],[PMMSCHIX],[PMFRTIDX],[PMTAXIDX],[PMWRTIDX], [PMPRCHIX],[PMRTNGIX],[PMTDSCIX],[ACPURIDX],[PURPVIDX],[NOTEINDX], [CHEKBKID],[MODIFDT],[CREATDDT],[RATETPID],[Revalue_Vendor],[Post_Results_To], [FREEONBOARD],[GOVCRPID],[GOVINDID],[DISGRPER],[DUEGRPER],[DOCFMTID], [TaxInvRecvd],[USERLANG],[WithholdingType],[WithholdingFormType],[WithholdingEntityType],[TaxFileNumMode], [BRTHDATE],[LaborPmtType],[CCode],[DECLID],[CBVAT],[Workflow_Approval_Status], [Workflow_Priority],[VADCD1099] ) select [VENDORID],[VENDNAME],[VNDCHKNM],[VENDSHNM],[VADDCDPR],[VADCDPAD], [VADCDSFR],[VADCDTRO],[VNDCLSID],[VNDCNTCT],[ADDRESS1],[ADDRESS2], [ADDRESS3],[CITY],[STATE],[ZIPCODE],[COUNTRY],[PHNUMBR1], [PHNUMBR2],[PHONE3],[FAXNUMBR],[UPSZONE],[SHIPMTHD],[TAXSCHID], [ACNMVNDR],[TXIDNMBR],[VENDSTTS],[CURNCYID],[TXRGNNUM],[PARVENID], [TRDDISCT],[TEN99TYPE],[TEN99BOXNUMBER],[MINORDER],[PYMTRMID],[MINPYTYP], [MINPYPCT],[MINPYDLR],[MXIAFVND],[MAXINDLR],[COMMENT1],[COMMENT2], [USERDEF1],[USERDEF2],[CRLMTDLR],[PYMNTPRI],[KPCALHST],[KGLDSTHS], [KPERHIST],[KPTRXHST],[HOLD],[PTCSHACF],[CREDTLMT],[WRITEOFF], [MXWOFAMT],[SBPPSDED],[PPSTAXRT],[DXVARNUM],[CRTCOMDT],[CRTEXPDT], [RTOBUTKN],[XPDTOBLG],[PRSPAYEE],[PMAPINDX],[PMCSHIDX],[PMDAVIDX], [PMDTKIDX],[PMFINIDX],[PMMSCHIX],[PMFRTIDX],[PMTAXIDX],[PMWRTIDX], [PMPRCHIX],[PMRTNGIX],[PMTDSCIX],[ACPURIDX],[PURPVIDX],[NOTEINDX], [CHEKBKID],[MODIFDT],[CREATDDT],[RATETPID],[Revalue_Vendor],[Post_Results_To], [FREEONBOARD],[GOVCRPID],[GOVINDID],[DISGRPER],[DUEGRPER],[DOCFMTID], [TaxInvRecvd],[USERLANG],[WithholdingType],[WithholdingFormType],[WithholdingEntityType],[TaxFileNumMode], [BRTHDATE],[LaborPmtType],[CCode],[DECLID],[CBVAT],[Workflow_Approval_Status], [Workflow_Priority],[VADCD1099] from ' + rtrim(@I_vFromCompany) + '..PM00200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PM00203' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PM00203 ( [VENDORID],[DISTTYPE],[SEQNUMBR],[ACTINDX],[Default_On_Trx] ) select [VENDORID],[DISTTYPE],[SEQNUMBR],[ACTINDX],[Default_On_Trx] from ' + rtrim(@I_vFromCompany) + '..PM00203 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PM00300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PM00300 ( [VENDORID],[ADRSCODE],[VNDCNTCT],[ADDRESS1],[ADDRESS2],[ADDRESS3], [CITY],[STATE],[ZIPCODE],[COUNTRY],[UPSZONE],[PHNUMBR1], [PHNUMBR2],[PHONE3],[FAXNUMBR],[SHIPMTHD],[TAXSCHID],[EmailPOs], [POEmailRecipient],[EmailPOFormat],[FaxPOs],[POFaxNumber],[FaxPOFormat],[CCode], [DECLID],[DEX_ROW_TS] ) select [VENDORID],[ADRSCODE],[VNDCNTCT],[ADDRESS1],[ADDRESS2],[ADDRESS3], [CITY],[STATE],[ZIPCODE],[COUNTRY],[UPSZONE],[PHNUMBR1], [PHNUMBR2],[PHONE3],[FAXNUMBR],[SHIPMTHD],[TAXSCHID],[EmailPOs], [POEmailRecipient],[EmailPOFormat],[FaxPOs],[POFaxNumber],[FaxPOFormat],[CCode], [DECLID],[DEX_ROW_TS] from ' + rtrim(@I_vFromCompany) + '..PM00300 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PM40100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PM40100 ( [UNIQKEY],[ADUPINNM],[OVVCHNUM],[TRKDISAV],[PRTHATRB],[AGEBY], [APPLYBY],[RMVNDHPW],[RMVTRHPW],[XCDMINPW],[WROFPSWD],[NTVCHNUM], [PMNPYNBR],[NXTVNDID],[USRDFPR1],[USRDRPR2],[PMTRXDSC_1],[PMTRXDSC_2], [PMTRXDSC_3],[PMTRXDSC_4],[PMTRXDSC_5],[PMTRXDSC_6],[PMTRXDSC_7],[PMTRXDSC_8], [PMTRXABR_1],[PMTRXABR_2],[PMTRXABR_3],[PMTRXABR_4],[PMTRXABR_5],[PMTRXABR_6], [PMTRXABR_7],[PMTRXABR_8],[CHEKBKID],[PCHSCHID],[FRTSCHID],[MSCSCHID], [LSTYECAL],[LSTYEFSC],[Check_Format_Default],[Check_Stub_Default],[PRNTPRVSLYAPPLDDCS],[DelUPDoc], [PrntTaxDetDoc],[DateSensitivitySumView],[PRNTDCUR],[AGEUNAPPLDCR],[PMNXTSCHDNBR],[ExcludeExprdDiscntsPymnt] ) select [UNIQKEY],[ADUPINNM],[OVVCHNUM],[TRKDISAV],[PRTHATRB],[AGEBY], [APPLYBY],[RMVNDHPW],[RMVTRHPW],[XCDMINPW],[WROFPSWD],[NTVCHNUM], [PMNPYNBR],[NXTVNDID],[USRDFPR1],[USRDRPR2],[PMTRXDSC_1],[PMTRXDSC_2], [PMTRXDSC_3],[PMTRXDSC_4],[PMTRXDSC_5],[PMTRXDSC_6],[PMTRXDSC_7],[PMTRXDSC_8], [PMTRXABR_1],[PMTRXABR_2],[PMTRXABR_3],[PMTRXABR_4],[PMTRXABR_5],[PMTRXABR_6], [PMTRXABR_7],[PMTRXABR_8],[CHEKBKID],[PCHSCHID],[FRTSCHID],[MSCSCHID], [LSTYECAL],[LSTYEFSC],[Check_Format_Default],[Check_Stub_Default],[PRNTPRVSLYAPPLDDCS],[DelUPDoc], [PrntTaxDetDoc],[DateSensitivitySumView],[PRNTDCUR],[AGEUNAPPLDCR],[PMNXTSCHDNBR],[ExcludeExprdDiscntsPymnt] from ' + rtrim(@I_vFromCompany) + '..PM40100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PM40102' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PM40102 ( [DOCTYPE],[DOCABREV],[DOCTYNAM] ) select [DOCTYPE],[DOCABREV],[DOCTYNAM] from ' + rtrim(@I_vFromCompany) + '..PM40102 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PM40103' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PM40103 ( [DISTTYPE],[DSNMSHRT],[DSNMLONG] ) select [DISTTYPE],[DSNMSHRT],[DSNMLONG] from ' + rtrim(@I_vFromCompany) + '..PM40103 ' exec(@cStatement) end if (@I_vReportOptions = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PM70500' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PM70500 ( [RPTGRIND],[RTPACHIN],[RTGRSBIN],[ASKECHTM],[EXPTTYPE],[FILEXPNM], [IFFILXST],[FINRPTNM],[PRNTOFIL],[PRTOPRTR],[PRTOSCRN],[SORTBY], [SORTBY2],[HISTTYPE],[PYMNTDAT],[VOIDONLY],[EXCLVOID],[Include_Canceled], [DATEOVERDUE],[Days_Overdue],[POP_Date_Selection],[Include_Closed],[Include_Released],[AGEBY], [COMPTYPE],[STVNDRID],[STVNDNAM],[STVNDCLS],[STTSTATE],[STRTZPCD], [STRTPHON],[STRTUDEF],[STTCNTCT],[Start_PO_Date],[STTSHNAM],[STTLOCID], [Start_Promised_Date],[Start_Required_Date],[STVNSTUS],[STT1099T],[STPERIOD],[STRTYEAR], [STTABYTD],[STRTPRTY],[STTDUEDT],[STDISCDT],[ALORANGE],[STTACNCD], [STDOCNUM],[STTDOCDT],[STDOCTYP],[STVCHNUM],[STTITNUM],[STCHKNUM], [STTCHKDT],[STCHBKID],[STBCHSRC],[STBCHNUM],[STPSTDDT],[STCLSDSC], [ENDVNDID],[ENDVNDNM],[ENDVNCLS],[ENDSTATE],[ENDZIPCD],[ENPHONBR], [End_PO_Date],[ENUSRDEF],[ENDLOCID],[ENITMNBR],[End_Required_Date],[End_Promised_Date], [ENDVNDCT],[ENDSHNAM],[ENVNSTTS],[E1099TYP],[ENDPEROD],[ENDYEAR], [ENAMBYTD],[ENPRYRTY],[ENDDUEDT],[ENDISCDT],[ALORNGE2],[ENAUCNCD], [ENDOCNUM],[ENDDOCDT],[ENDOCTYP],[ENVCHNUM],[ENCHKNUM],[ENDCHKDT], [ENCHBKID],[ENBCHSRC],[ENDBNMBR],[ENPSTDDT],[ENCLDSCR],[AGNGDATE], [PBSDCDTK],[PBSDUDTK],[PBSDSDTK],[PBSCHDTK],[PBSPTDTK],[PBEDCDTK], [PBEDUDTK],[PBEDSDTK],[PBECHDTK],[PBEPDTKN],[PBCDTTKN],[DETLDRPT], [SINGACT]' select @cStatement2 = rtrim(@cStatement2)+rtrim(','+'[STTACNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement3 = rtrim(@cStatement3)+rtrim(','+'[EACCNBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement4 = ',[STRPONUM],[ENDPONUM],[EndPOPRcptNum],[StartPOPRcptNum],[STRCREAT], [STRCTDT],[ENRCTDT],[STRCTNUM],[ENRCTNBR],[ENDCREATE],[STRPOSTA], [ENDPOSTA],[INCRCPTS],[DISSRLOT],[STRXSRC],[ENTRXSRC],[CRBLNCCB], [FLLYPDCB],[ZROBALCB],[EXCLZBAL],[NOACTVCB],[Unposted_Applied_CR_Docs],[Multicurrency_Information], [Include_Distribution_Typ],[RPTXRATE],[RPRTCLMD],[PRTCURIN],[INCLFUNC],[STARTLINEORIGIN], [ENDLINEORIGIN],[STARTBUYERID],[ENDBUYERID],[INCLUDEHOLDPO],[INCLUDEHOLDPOONLY],[STARTRELEASEBYDATE], [ENDRELEASEBYDATE],[Include_New],[Include_Change_Order],[Include_Received],[SummaryYear],[DateSensitivitySumSelect], [StartProjNum],[EndProjNum],[StartCostCatID],[EndCostCatID],[IncludeApprovedPOsOnly],[MISC], [INTEREST],[DIVIDEND] ) select [RPTGRIND],[RTPACHIN],[RTGRSBIN],[ASKECHTM],[EXPTTYPE],[FILEXPNM], [IFFILXST],[FINRPTNM],[PRNTOFIL],[PRTOPRTR],[PRTOSCRN],[SORTBY], [SORTBY2],[HISTTYPE],[PYMNTDAT],[VOIDONLY],[EXCLVOID],[Include_Canceled], [DATEOVERDUE],[Days_Overdue],[POP_Date_Selection],[Include_Closed],[Include_Released],[AGEBY], [COMPTYPE],[STVNDRID],[STVNDNAM],[STVNDCLS],[STTSTATE],[STRTZPCD], [STRTPHON],[STRTUDEF],[STTCNTCT],[Start_PO_Date],[STTSHNAM],[STTLOCID], [Start_Promised_Date],[Start_Required_Date],[STVNSTUS],[STT1099T],[STPERIOD],[STRTYEAR], [STTABYTD],[STRTPRTY],[STTDUEDT],[STDISCDT],[ALORANGE],[STTACNCD], [STDOCNUM],[STTDOCDT],[STDOCTYP],[STVCHNUM],[STTITNUM],[STCHKNUM], [STTCHKDT],[STCHBKID],[STBCHSRC],[STBCHNUM],[STPSTDDT],[STCLSDSC], [ENDVNDID],[ENDVNDNM],[ENDVNCLS],[ENDSTATE],[ENDZIPCD],[ENPHONBR], [End_PO_Date],[ENUSRDEF],[ENDLOCID],[ENITMNBR],[End_Required_Date],[End_Promised_Date], [ENDVNDCT],[ENDSHNAM],[ENVNSTTS],[E1099TYP],[ENDPEROD],[ENDYEAR], [ENAMBYTD],[ENPRYRTY],[ENDDUEDT],[ENDISCDT],[ALORNGE2],[ENAUCNCD], [ENDOCNUM],[ENDDOCDT],[ENDOCTYP],[ENVCHNUM],[ENCHKNUM],[ENDCHKDT], [ENCHBKID],[ENBCHSRC],[ENDBNMBR],[ENPSTDDT],[ENCLDSCR],[AGNGDATE], [PBSDCDTK],[PBSDUDTK],[PBSDSDTK],[PBSCHDTK],[PBSPTDTK],[PBEDCDTK], [PBEDUDTK],[PBEDSDTK],[PBECHDTK],[PBEPDTKN],[PBCDTTKN],[DETLDRPT], [SINGACT]' select @cStatement5 = rtrim(@cStatement5)+rtrim(','+'[STTACNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement6 = rtrim(@cStatement6)+rtrim(','+'[EACCNBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement7 = ',[STRPONUM],[ENDPONUM],[EndPOPRcptNum],[StartPOPRcptNum],[STRCREAT], [STRCTDT],[ENRCTDT],[STRCTNUM],[ENRCTNBR],[ENDCREATE],[STRPOSTA], [ENDPOSTA],[INCRCPTS],[DISSRLOT],[STRXSRC],[ENTRXSRC],[CRBLNCCB], [FLLYPDCB],[ZROBALCB],[EXCLZBAL],[NOACTVCB],[Unposted_Applied_CR_Docs],[Multicurrency_Information], [Include_Distribution_Typ],[RPTXRATE],[RPRTCLMD],[PRTCURIN],[INCLFUNC],[STARTLINEORIGIN], [ENDLINEORIGIN],[STARTBUYERID],[ENDBUYERID],[INCLUDEHOLDPO],[INCLUDEHOLDPOONLY],[STARTRELEASEBYDATE], [ENDRELEASEBYDATE],[Include_New],[Include_Change_Order],[Include_Received],[SummaryYear],[DateSensitivitySumSelect], [StartProjNum],[EndProjNum],[StartCostCatID],[EndCostCatID],[IncludeApprovedPOsOnly],[MISC], [INTEREST],[DIVIDEND] from ' + rtrim(@I_vFromCompany) + '..PM70500 ' exec(@cStatement+@cStatement2+@cStatement3+@cStatement4+@cStatement5+@cStatement6+@cStatement7) end return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyPM] TO [DYNGRP]
GO
