SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_CFM00101N_2] (@BS int, @CHEKBKID char(15), @DEX_ROW_ID int, @CHEKBKID_RS char(15), @CHEKBKID_RE char(15)) AS  set nocount on IF @CHEKBKID_RS IS NULL BEGIN SELECT TOP 25  EBS_Forecast_ID, CHEKBKID, CFM_Exchange_Rate, CFM_Calc_Method, DEX_ROW_ID FROM .CFM00101 WHERE ( CHEKBKID = @CHEKBKID AND DEX_ROW_ID > @DEX_ROW_ID OR CHEKBKID > @CHEKBKID ) ORDER BY CHEKBKID ASC, DEX_ROW_ID ASC END ELSE IF @CHEKBKID_RS = @CHEKBKID_RE BEGIN SELECT TOP 25  EBS_Forecast_ID, CHEKBKID, CFM_Exchange_Rate, CFM_Calc_Method, DEX_ROW_ID FROM .CFM00101 WHERE CHEKBKID = @CHEKBKID_RS AND ( CHEKBKID = @CHEKBKID AND DEX_ROW_ID > @DEX_ROW_ID OR CHEKBKID > @CHEKBKID ) ORDER BY CHEKBKID ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  EBS_Forecast_ID, CHEKBKID, CFM_Exchange_Rate, CFM_Calc_Method, DEX_ROW_ID FROM .CFM00101 WHERE CHEKBKID BETWEEN @CHEKBKID_RS AND @CHEKBKID_RE AND ( CHEKBKID = @CHEKBKID AND DEX_ROW_ID > @DEX_ROW_ID OR CHEKBKID > @CHEKBKID ) ORDER BY CHEKBKID ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_CFM00101N_2] TO [DYNGRP]
GO
