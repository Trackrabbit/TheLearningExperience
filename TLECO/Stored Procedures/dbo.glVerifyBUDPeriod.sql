SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE procedure [dbo].[glVerifyBUDPeriod]  @I_iJournalEntry INT AS  BEGIN  DECLARE @PeriodID   SMALLINT,  @iStatus  INT   SELECT @iStatus = 0   SELECT @PeriodID = ISNULL(MAX(PERIODID),0) FROM GL12001 WHERE JRNENTRY = @I_iJournalEntry  IF @PeriodID <> 0 AND @PeriodID > (SELECT NUMOFPER FROM SY40101 WHERE YEAR1 = (SELECT TOP 1 YEAR1 FROM GL12001 WHERE JRNENTRY = @I_iJournalEntry))  BEGIN  SELECT @iStatus = 5  RETURN @iStatus  END  ELSE IF @PeriodID <> 0 AND @PeriodID < (SELECT NUMOFPER FROM SY40101 WHERE YEAR1 = (SELECT TOP 1 YEAR1 FROM GL12001 WHERE JRNENTRY = @I_iJournalEntry))  BEGIN  SELECT @iStatus = 6  RETURN @iStatus  END END   
GO
GRANT EXECUTE ON  [dbo].[glVerifyBUDPeriod] TO [DYNGRP]
GO
