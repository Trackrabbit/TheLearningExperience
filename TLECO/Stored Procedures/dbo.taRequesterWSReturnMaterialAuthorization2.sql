SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[taRequesterWSReturnMaterialAuthorization2] @I_vDOCTYPE varchar(50),@I_vOUTPUTTYPE int = 0,@I_vINDEX1TO varchar(75)='',@I_vINDEX2TO varchar(75)='',@I_vINDEX3TO varchar(75)='',@I_vINDEX4TO varchar(75)='',@I_vINDEX5TO varchar(75)='',@I_vINDEX6TO varchar(75)='',@I_vINDEX7TO varchar(75)='',@I_vINDEX8TO varchar(75)='',@I_vINDEX9TO varchar(75)='',@I_vINDEX10TO varchar(75)='',@I_vINDEX11TO varchar(75)='',@I_vINDEX12TO varchar(75)='',@I_vINDEX13TO varchar(75)='',@I_vINDEX14TO varchar(75)='',@I_vINDEX15TO varchar(75)='',@I_vINDEX1FROM varchar(75)='',@I_vINDEX2FROM varchar(75)='',@I_vINDEX3FROM varchar(75)='',@I_vINDEX4FROM varchar(75)='',@I_vINDEX5FROM varchar(75)='',@I_vINDEX6FROM varchar(75)='',@I_vINDEX7FROM varchar(75)='',@I_vINDEX8FROM varchar(75)='',@I_vINDEX9FROM varchar(75)='',@I_vINDEX10FROM varchar(75)='',@I_vINDEX11FROM varchar(75)='',@I_vINDEX12FROM varchar(75)='',@I_vINDEX13FROM varchar(75)='',@I_vINDEX14FROM varchar(75)='',@I_vINDEX15FROM varchar(75)='',@I_vFORLOAD int=0,@I_vFORLIST int=0,@I_vACTION  int=0,@I_vROWCOUNT int=0,@I_vREMOVE int=0,@I_vWhereClause varchar(1000)=''  with encryption AS  declare @WhereNotExistsStatement varchar(8000),@Orderbystatement varchar(8000),@statement01 varchar(4000),@WhereStatement varchar(8000),@InsertStatement varchar(8000),@InsertStatement2 varchar(8000),@ColumnName varchar(50), @x int, @IndexName varchar(50),@INDEXCNT int, @TABLENAME varchar(30),@TagNumber int,@TableCount int,@Y int,@fill char(1),@fill2 char(2),@delete varchar(1000),@dbname varchar(50)  select @fill = char(39),@fill2 = char(39)+char(39),@Orderbystatement=' order by ',@statement01 ='',@WhereStatement ='',@INDEXCNT = 0,@TABLENAME = '',@InsertStatement = '',@InsertStatement2 = '',@dbname = ''  set nocount on  select @dbname = db_name()  select * into #eConnect_Out from eConnect_Out (nolock) where DOCTYPE = 'BUILD' create table #Column(ColumnName varchar(50))  if (@I_vFORLIST =1) begin  select @I_vFORLOAD=0,@I_vACTION=0,@I_vREMOVE=0 end  if (@I_vFORLOAD = 1) or (@I_vFORLIST =1) begin  select @INDEXCNT=INDEXCNT,@TABLENAME=TABLENAME from eConnect_Out_Setup (nolock) where DOCTYPE = @I_vDOCTYPE and MAIN = 1   if (@I_vFORLOAD = 1) select @statement01 = 'insert into eConnect_Out(DATE1,TABLENAME,DEX_ROW_ID,DOCTYPE,INDEX1,INDEX2,INDEX3,INDEX4,INDEX5,INDEX6,INDEX7,INDEX8,INDEX9,INDEX10,INDEX11,INDEX12,INDEX13,INDEX14,INDEX15,ACTION,REPLICATE,DBNAME) select ' + char(10)  if (@I_vFORLIST =1) select @statement01 = 'insert into #eConnect_Out(DATE1,TABLENAME,DEX_ROW_ID,DOCTYPE,INDEX1,INDEX2,INDEX3,INDEX4,INDEX5,INDEX6,INDEX7,INDEX8,INDEX9,INDEX10,INDEX11,INDEX12,INDEX13,INDEX14,INDEX15,ACTION,REPLICATE,DBNAME) select ' + char(10)  if (@I_vROWCOUNT > 0)   begin  select @statement01 = @statement01 + ' TOP ' + str(@I_vROWCOUNT) + ' '  end   select @statement01 = @statement01 + @fill + @fill + ',' + @fill + @TABLENAME + @fill + ',DEX_ROW_ID,' + @fill + @I_vDOCTYPE + @fill + ',' + char(10)  select @x = 1  while (@x <= 15)  begin  if (@x <= @INDEXCNT)  begin  exec('insert into #Column select INDEX' + @x + ' from eConnect_Out_Setup (nolock) where DOCTYPE = ''' + @I_vDOCTYPE + ''' and MAIN = 1')  select @ColumnName = ColumnName from #Column  select @statement01 = @statement01 + rtrim(@ColumnName)  select @Orderbystatement = @Orderbystatement  + rtrim(@ColumnName)   truncate table #Column if ((@x = 1) and ((@I_vINDEX1FROM <> '') or (@I_vINDEX1TO <> '')))  begin   select @WhereStatement = @WhereStatement + ' where ' + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX1FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX1TO),'''','''''') + ''''   if (@I_vFORLIST <> 1)  begin  select @WhereNotExistsStatement = ' and not exists ( select 1 from eConnect_Out where INDEX1 = '+ '''' + @I_vINDEX1FROM + ''''   end  end  else  begin  if (@I_vFORLIST <> 1)  begin  select @WhereNotExistsStatement = @WhereNotExistsStatement + ' and INDEX'+ltrim(rtrim(str(@x)))+' = '+   case  when @x = 2 then @I_vINDEX2FROM  when @x = 3 then @I_vINDEX3FROM  when @x = 4 then @I_vINDEX4FROM  when @x = 5 then @I_vINDEX5FROM  when @x = 6 then @I_vINDEX6FROM  when @x = 7 then @I_vINDEX7FROM  when @x = 8 then @I_vINDEX8FROM  when @x = 9 then @I_vINDEX9FROM  when @x = 10 then @I_vINDEX10FROM  when @x = 11 then @I_vINDEX11FROM  when @x = 12 then @I_vINDEX12FROM  when @x = 13 then @I_vINDEX13FROM  when @x = 14 then @I_vINDEX14FROM  when @x = 15 then @I_vINDEX15FROM  end   end  end if ((@x = 2) and ((@I_vINDEX2FROM <> '') or (@I_vINDEX2TO <> '')))  begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX2FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX2TO),'''','''''') + ''''  end   if ((@x = 3) and ((@I_vINDEX3FROM <> '') or (@I_vINDEX3TO <> '')))   begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX3FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX3TO),'''','''''') + ''''  end   if ((@x = 4) and ((@I_vINDEX4FROM <> '') or (@I_vINDEX4TO <> '')))  begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX4FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX4TO),'''','''''') + ''''  end   if ((@x = 5) and ((@I_vINDEX5FROM <> '') or (@I_vINDEX5TO <> '')))  begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX5FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX5TO),'''','''''') + ''''  end   if ((@x = 6) and ((@I_vINDEX6FROM <> '') or (@I_vINDEX6TO <> '')))  begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX6FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX6TO),'''','''''') + ''''  end   if ((@x = 7) and ((@I_vINDEX7FROM <> '') or (@I_vINDEX7TO <> '')))  begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX7FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX7TO),'''','''''') + ''''  end   if ((@x = 8) and ((@I_vINDEX8FROM <> '') or (@I_vINDEX8TO <> '')))   begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX8FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX8TO),'''','''''') + ''''  end   if ((@x = 9) and ((@I_vINDEX9FROM <> '') or (@I_vINDEX9TO <> '')))  begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX9FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX9TO),'''','''''') + ''''  end   if ((@x = 10) and ((@I_vINDEX10FROM <> '') or (@I_vINDEX10TO <> '')))  begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX10FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX10TO),'''','''''') + ''''  end   if ((@x = 11) and ((@I_vINDEX11FROM <> '') or (@I_vINDEX11TO <> '')))  begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX11FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX11TO),'''','''''') + ''''  end   if ((@x = 12) and ((@I_vINDEX12FROM <> '') or (@I_vINDEX12TO <> '')))  begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX12FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX12TO),'''','''''') + ''''  end   if ((@x = 13) and ((@I_vINDEX13FROM <> '') or (@I_vINDEX13TO <> '')))  begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX13FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX13TO),'''','''''') + ''''  end   if ((@x = 14) and ((@I_vINDEX14FROM <> '') or (@I_vINDEX14TO <> '')))  begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX14FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX14TO),'''','''''') + ''''  end   if ((@x = 15) and ((@I_vINDEX15FROM <> '') or (@I_vINDEX15TO <> '')))  begin  if len(@WhereStatement) = 0 select @WhereStatement =+ ' where '  if len(@WhereStatement) > 20 select @WhereStatement = @WhereStatement + ' and '  select @WhereStatement = @WhereStatement + rtrim(@ColumnName) + ' between ''' + replace(rtrim(@I_vINDEX15FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX15TO),'''','''''') + ''''  end  end   else  select @statement01 = @statement01 + @fill2   select @statement01 = @statement01 + ',' + CHAR(10)  if (@x < @INDEXCNT)  begin  select @Orderbystatement = @Orderbystatement + ','  end  select @x = @x + 1  end   select @WhereNotExistsStatement = @WhereNotExistsStatement + ')'   if (@I_vWhereClause <> '') and (@WhereStatement <> '')   begin  select @I_vWhereClause = ' and ' + rtrim(@I_vWhereClause)  + CHAR(10)  end  else if (@I_vWhereClause <> '') and (@WhereStatement = '')   begin  select @I_vWhereClause = ' where ' + rtrim(@I_vWhereClause)  + CHAR(10)  end   if (@I_vFORLIST =1)  begin  select @statement01 = @statement01 + '0,0,' + @fill + @dbname + @fill + ' from ' + @TABLENAME + ' (nolock) '  end  else  select @statement01 = @statement01 + '1,0,' + @fill + @dbname + @fill + ' from ' + @TABLENAME + ' (nolock) '   exec (@statement01+@WhereStatement +@WhereNotExistsStatement+ @I_vWhereClause + @Orderbystatement) end else  if (@I_vFORLIST <>1) begin   select @INDEXCNT=INDEXCNT,@TABLENAME=TABLENAME from eConnect_Out_Setup (nolock) where DOCTYPE = @I_vDOCTYPE and MAIN = '1'   select @InsertStatement = 'insert into #eConnect_Out ( DATE1,TABLENAME,DEX_ROW_ID,DOCTYPE,' + CHAR(10)   if (@I_vROWCOUNT > 0)   begin  select @InsertStatement2 = @InsertStatement2 + ' TOP ' + str(@I_vROWCOUNT) + ' '  end   select @InsertStatement2 = @InsertStatement2 + ' DATE1,TABLENAME,DEX_ROW_ID,DOCTYPE,'   select @x = 1  while (@x <= 15)  begin  select @InsertStatement = @InsertStatement + 'INDEX' + ltrim(str(@x))  select @InsertStatement = @InsertStatement + ',' + CHAR(10)   if (@x <= @INDEXCNT)  begin  select @InsertStatement2 = @InsertStatement2 + 'INDEX' + ltrim(str(@x))  end  else  select @InsertStatement2 = @InsertStatement2 + ''''''   select @InsertStatement2 = @InsertStatement2 + ',' + CHAR(10)   select @x = @x + 1  end   select @InsertStatement = @InsertStatement + 'ACTION,REPLICATE,DBNAME)' + CHAR(10) + ' select '  select @InsertStatement2 = @InsertStatement2 + 'ACTION,REPLICATE,DBNAME' + CHAR(10)  select @InsertStatement2 = @InsertStatement2 + ' from eConnect_Out (nolock) where DOCTYPE = ''' + @I_vDOCTYPE +  ''''   if (@I_vACTION > 0)   begin  if (@I_vACTION = 4) or (@I_vACTION = 5)  begin  select @InsertStatement2 = @InsertStatement2 +  ' and ACTION between 1 and 2 '  end  else  begin  select @InsertStatement2 = @InsertStatement2 +  ' and ACTION = ' + ltrim(str(@I_vACTION))  end  end select @x = 1  while ((@x <= @INDEXCNT) and (@I_vINDEX1FROM <> ''))  begin  if ((@x = 1) and (@I_vINDEX1FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX1 between ''' + replace(rtrim(@I_vINDEX1FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX1TO),'''','''''') + ''''  if ((@x = 2) and (@I_vINDEX2FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX2 between ''' + replace(rtrim(@I_vINDEX2FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX2TO),'''','''''') + ''''  if ((@x = 3) and (@I_vINDEX3FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX3 between ''' + replace(rtrim(@I_vINDEX3FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX3TO),'''','''''') + ''''  if ((@x = 4) and (@I_vINDEX4FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX4 between ''' + replace(rtrim(@I_vINDEX4FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX4TO),'''','''''') + ''''  if ((@x = 5) and (@I_vINDEX5FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX5 between ''' + replace(rtrim(@I_vINDEX5FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX5TO),'''','''''') + ''''  if ((@x = 6) and (@I_vINDEX6FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX6 between ''' + replace(rtrim(@I_vINDEX6FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX6TO),'''','''''') + ''''  if ((@x = 7) and (@I_vINDEX7FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX7 between ''' + replace(rtrim(@I_vINDEX7FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX7TO),'''','''''') + ''''  if ((@x = 8) and (@I_vINDEX8FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX8 between ''' + replace(rtrim(@I_vINDEX8FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX8TO),'''','''''') + ''''  if ((@x = 9) and (@I_vINDEX9FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX9 between ''' + replace(rtrim(@I_vINDEX9FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX9TO),'''','''''') + ''''  if ((@x = 10) and (@I_vINDEX10FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX10 between ''' + replace(rtrim(@I_vINDEX10FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX10TO),'''','''''') + ''''  if ((@x = 11) and (@I_vINDEX11FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX11 between ''' + replace(rtrim(@I_vINDEX11FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX11TO),'''','''''') + ''''  if ((@x = 12) and (@I_vINDEX12FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX12 between ''' + replace(rtrim(@I_vINDEX12FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX12TO),'''','''''') + ''''  if ((@x = 13) and (@I_vINDEX13FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX13 between ''' + replace(rtrim(@I_vINDEX13FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX13TO),'''','''''') + ''''  if ((@x = 14) and (@I_vINDEX14FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX14 between ''' + replace(rtrim(@I_vINDEX14FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX14TO),'''','''''') + ''''  if ((@x = 15) and (@I_vINDEX15FROM <> ''))   select @InsertStatement2 = @InsertStatement2 + ' and INDEX15 between ''' + replace(rtrim(@I_vINDEX15FROM),'''','''''') + ''' and ''' + replace(rtrim(@I_vINDEX15TO),'''','''''') + ''''  select @x = @x + 1  end   exec (@InsertStatement+@InsertStatement2)   select @delete = 'delete a from #eConnect_Out a, tempdb.dbo.DEX_LOCK b (nolock) where a.DEX_ROW_ID = b.row_id and  b.table_path_name = ''' + db_name() + '.dbo.' + @TABLENAME + ''''  exec (@delete) end  if (@I_vREMOVE = 1) and (@I_vFORLIST = 0) begin  delete a from eConnect_Out a (updlock), #eConnect_Out b  where a.DOCTYPE = b.DOCTYPE and  a.INDEX1 = b.INDEX1 and  a.INDEX2 = b.INDEX2 and  a.INDEX3 = b.INDEX3 and  a.INDEX4 = b.INDEX4 and  a.INDEX5 = b.INDEX5 and  a.INDEX6 = b.INDEX6 and  a.INDEX7 = b.INDEX7 and  a.INDEX8 = b.INDEX8 and  a.INDEX9 = b.INDEX9 and  a.INDEX10 = b.INDEX10 and  a.INDEX11 = b.INDEX11 and  a.INDEX12 = b.INDEX12 and  a.INDEX13 = b.INDEX13 and  a.INDEX14 = b.INDEX14 and  a.INDEX15 = b.INDEX15 and  a.ACTION = b.ACTION end
SELECT 1 as Tag,NULL as Parent,
rtrim(eConnect.ACTION) as [eConnect!1!ACTION],rtrim(eConnect.DOCTYPE) as [eConnect!1!Requester_DOCTYPE],
rtrim(eConnect.DBNAME) as [eConnect!1!DBNAME],
rtrim(eConnect.TABLENAME) as [eConnect!1!TABLENAME],
eConnect.DATE1 as [eConnect!1!DATE1],
cast(eConnect.INDEX1 as [int]) as [eConnect!1!TrxState],
rtrim(cast(eConnect.INDEX2 as [char])) as [eConnect!1!RETDOCID],
cast(eConnect.INDEX3 as [smallint]) as [eConnect!1!Return_Record_Type],
NULL as [Rma!2!TrxState!element],
NULL as [Rma!2!RETDOCID!element],
NULL as [Rma!2!Return_Record_Type!element],
NULL as [Rma!2!RMA_Status!element],
NULL as [Rma!2!Received!element],
NULL as [Rma!2!RETORIG!element],
NULL as [Rma!2!RETREF!element],
NULL as [Rma!2!RETSTAT!element],
NULL as [Rma!2!RETTYPE!element],
NULL as [Rma!2!ENTDTE!element],
NULL as [Rma!2!ENTTME!element],
NULL as [Rma!2!ETADTE!element],
NULL as [Rma!2!ETATME!element],
NULL as [Rma!2!RETUDATE!element],
NULL as [Rma!2!Return_Time!element],
NULL as [Rma!2!COMPDTE!element],
NULL as [Rma!2!COMPTME!element],
NULL as [Rma!2!USERID!element],
NULL as [Rma!2!OFFID!element],
NULL as [Rma!2!RTRNNAME!element],
NULL as [Rma!2!RETADDR1!element],
NULL as [Rma!2!RETADDR2!element],
NULL as [Rma!2!RETADDR3!element],
NULL as [Rma!2!RTRNCITY!element],
NULL as [Rma!2!SVC_Return_State!element],
NULL as [Rma!2!RTRNZIP!element],
NULL as [Rma!2!Return_Country!element],
NULL as [Rma!2!LOCNCODE!element],
NULL as [Rma!2!CUSTNMBR!element],
NULL as [Rma!2!ADRSCODE!element],
NULL as [Rma!2!CUSTNAME!element],
NULL as [Rma!2!CONTACT!element],
NULL as [Rma!2!ADDRESS1!element],
NULL as [Rma!2!ADDRESS2!element],
NULL as [Rma!2!ADDRESS3!element],
NULL as [Rma!2!CITY!element],
NULL as [Rma!2!STATE!element],
NULL as [Rma!2!ZIPCODE!element],
NULL as [Rma!2!COUNTRY!element],
NULL as [Rma!2!TXTFIELD!element],
NULL as [Rma!2!Bill_of_Lading!element],
NULL as [Rma!2!SHIPMTHD!element],
NULL as [Rma!2!Bill_To_Customer!element],
NULL as [Rma!2!SVC_Bill_To_Address_Code!element],
NULL as [Rma!2!Commit_Date!element],
NULL as [Rma!2!Commit_Time!element],
NULL as [Rma!2!USERDEF1!element],
NULL as [Rma!2!USERDEF2!element],
NULL as [Rma!2!USRDEF03!element],
NULL as [Rma!2!USRDEF04!element],
NULL as [Rma!2!USRDEF05!element],
NULL as [Rma!2!CURNCYID!element],
NULL as [Rma!2!RATETPID!element],
NULL as [Rma!2!XCHGRATE!element],
NULL as [Rma!2!EXCHDATE!element],
NULL as [Rma!2!CSTPONBR!element],
NULL as [Rma!2!SVC_RMA_Reason_Code!element],
NULL as [Rma!2!SVC_RMA_Reason_Code_Desc!element],
NULL as [Rma!2!SVC_RMA_From_Service!element],
NULL as [Rma!2!SVC_FO_ID!element],
NULL as [RmaAudit!3!RETDOCID!element],
NULL as [RmaAudit!3!LNSEQNBR!element],
NULL as [RmaAudit!3!LNITMSEQ!element],
NULL as [RmaAudit!3!SVCFRMSTAT!element],
NULL as [RmaAudit!3!SVCTOSTAT!element],
NULL as [RmaAudit!3!DSCRPTION!element],
NULL as [RmaAudit!3!USERID!element],
NULL as [RmaAudit!3!CREATDDT!element],
NULL as [RmaAudit!3!CREATETIME!element],
NULL as [RmaLine!4!RETDOCID!element],
NULL as [RmaLine!4!LNSEQNBR!element],
NULL as [RmaLine!4!RETTYPE!element],
NULL as [RmaLine!4!RMA_Status!element],
NULL as [RmaLine!4!RETSTAT!element],
NULL as [RmaLine!4!Received!element],
NULL as [RmaLine!4!Traveler_Printed!element],
NULL as [RmaLine!4!SVC_Ready_To_Close!element],
NULL as [RmaLine!4!SVC_RMA_Reason_Code!element],
NULL as [RmaLine!4!SVC_RMA_Reason_Code_Desc!element],
NULL as [RmaLine!4!TXTFIELD!element],
NULL as [RmaLine!4!RETREF!element],
NULL as [RmaLine!4!SRVRECTYPE!element],
NULL as [RmaLine!4!CALLNBR!element],
NULL as [RmaLine!4!EQPLINE!element],
NULL as [RmaLine!4!LNITMSEQ!element],
NULL as [RmaLine!4!SVC_RMA_From_Service!element],
NULL as [RmaLine!4!SOPNUMBE!element],
NULL as [RmaLine!4!CMPNTSEQ!element],
NULL as [RmaLine!4!SOP_Line_Item_Sequence!element],
NULL as [RmaLine!4!ENTDTE!element],
NULL as [RmaLine!4!ENTTME!element],
NULL as [RmaLine!4!ETADTE!element],
NULL as [RmaLine!4!ETATME!element],
NULL as [RmaLine!4!Commit_Date!element],
NULL as [RmaLine!4!Commit_Time!element],
NULL as [RmaLine!4!RETUDATE!element],
NULL as [RmaLine!4!Return_Time!element],
NULL as [RmaLine!4!COMPDTE!element],
NULL as [RmaLine!4!COMPTME!element],
NULL as [RmaLine!4!PRMDATE!element],
NULL as [RmaLine!4!REFRENCE!element],
NULL as [RmaLine!4!USERID!element],
NULL as [RmaLine!4!OFFID!element],
NULL as [RmaLine!4!LOCNCODE!element],
NULL as [RmaLine!4!RTRNNAME!element],
NULL as [RmaLine!4!RETADDR1!element],
NULL as [RmaLine!4!RETADDR2!element],
NULL as [RmaLine!4!RETADDR3!element],
NULL as [RmaLine!4!RTRNCITY!element],
NULL as [RmaLine!4!SVC_Return_State!element],
NULL as [RmaLine!4!RTRNZIP!element],
NULL as [RmaLine!4!Return_Country!element],
NULL as [RmaLine!4!CUSTNAME!element],
NULL as [RmaLine!4!ADRSCODE!element],
NULL as [RmaLine!4!CONTACT!element],
NULL as [RmaLine!4!ADDRESS1!element],
NULL as [RmaLine!4!ADDRESS2!element],
NULL as [RmaLine!4!ADDRESS3!element],
NULL as [RmaLine!4!CITY!element],
NULL as [RmaLine!4!STATE!element],
NULL as [RmaLine!4!ZIPCODE!element],
NULL as [RmaLine!4!COUNTRY!element],
NULL as [RmaLine!4!CSTPONBR!element],
NULL as [RmaLine!4!QUANTITY!element],
NULL as [RmaLine!4!DECPLQTY!element],
NULL as [RmaLine!4!UOFM!element],
NULL as [RmaLine!4!ITEMNMBR!element],
NULL as [RmaLine!4!ITEMDESC!element],
NULL as [RmaLine!4!UNITCOST!element],
NULL as [RmaLine!4!ORUNTCST!element],
NULL as [RmaLine!4!EXTDCOST!element],
NULL as [RmaLine!4!OREXTCST!element],
NULL as [RmaLine!4!UNITPRCE!element],
NULL as [RmaLine!4!ORUNTPRC!element],
NULL as [RmaLine!4!XTNDPRCE!element],
NULL as [RmaLine!4!OXTNDPRC!element],
NULL as [RmaLine!4!CUSTOWN!element],
NULL as [RmaLine!4!FACTSEAL!element],
NULL as [RmaLine!4!ORDDOCID!element],
NULL as [RmaLine!4!TRANSLINESEQ!element],
NULL as [RmaLine!4!STATUS!element],
NULL as [RmaLine!4!Flat_Rate_Repair_Price!element],
NULL as [RmaLine!4!Orig_Flat_RepairPrice!element],
NULL as [RmaLine!4!Repair_Price!element],
NULL as [RmaLine!4!Originating_Repair_Price!element],
NULL as [RmaLine!4!NTE_Price!element],
NULL as [RmaLine!4!Originating_NTE_Price!element],
NULL as [RmaLine!4!Repair_Cost!element],
NULL as [RmaLine!4!Originating_Repair_Cost!element],
NULL as [RmaLine!4!Bill_of_Lading!element],
NULL as [RmaLine!4!SHIPMTHD!element],
NULL as [RmaLine!4!Credit_SOP_Type!element],
NULL as [RmaLine!4!Credit_SOP_Number!element],
NULL as [RmaLine!4!Credit_SOP_Line_Item_Seq!element],
NULL as [RmaLine!4!Replace_SOP_Type!element],
NULL as [RmaLine!4!Replace_SOP_Number!element],
NULL as [RmaLine!4!Replace_SOP_Line_Item_Se!element],
NULL as [RmaLine!4!Location_Code_Replacemen!element],
NULL as [RmaLine!4!Replace_Item_Number!element],
NULL as [RmaLine!4!Replace_U_Of_M!element],
NULL as [RmaLine!4!Replace_Price_Level!element],
NULL as [RmaLine!4!Replace_QTY!element],
NULL as [RmaLine!4!Replace_Cost!element],
NULL as [RmaLine!4!Originating_Replace_Cost!element],
NULL as [RmaLine!4!Replace_Price!element],
NULL as [RmaLine!4!Originating_Replace_Pric!element],
NULL as [RmaLine!4!SOP_Number_Invoice!element],
NULL as [RmaLine!4!Item_Number_Invoice!element],
NULL as [RmaLine!4!USERDEF1!element],
NULL as [RmaLine!4!USERDEF2!element],
NULL as [RmaLine!4!USRDEF03!element],
NULL as [RmaLine!4!USRDEF04!element],
NULL as [RmaLine!4!USRDEF05!element],
NULL as [RmaLine!4!Return_Item_Number!element],
NULL as [RmaLine!4!Return_Item_Description!element],
NULL as [RmaLine!4!Return_Location_Code!element],
NULL as [RmaLine!4!Return_QTY!element],
NULL as [RmaLine!4!Return_U_Of_M!element],
NULL as [RmaLine!4!RETCOST!element],
NULL as [RmaLine!4!Originating_Return_Cost!element],
NULL as [RmaLine!4!SVC_Extended_Return_Cost!element],
NULL as [RmaLine!4!SVC_Orig_Ext_Return_Cost!element],
NULL as [RmaLine!4!SVC_Return_Price_Level!element],
NULL as [RmaLine!4!SVC_Return_Price!element],
NULL as [RmaLine!4!Originating_Return_Price!element],
NULL as [RmaLine!4!SVC_Extended_Return_Pric!element],
NULL as [RmaLine!4!SVC_Orig_Ext_Return_Pric!element],
NULL as [RmaLine!4!SVC_FO_ID!element],
NULL as [RmaLine!4!SVC_SCM_Complete!element],
NULL as [RmaLineDistribution!5!Return_Record_Type!element],
NULL as [RmaLineDistribution!5!RETDOCID!element],
NULL as [RmaLineDistribution!5!LNSEQNBR!element],
NULL as [RmaLineDistribution!5!LINITMTYP!element],
NULL as [RmaLineDistribution!5!SEQNUMBR!element],
NULL as [RmaLineDistribution!5!SVC_Distribution_Type!element],
NULL as [RmaLineDistribution!5!DistRef!element],
NULL as [RmaLineDistribution!5!ACTNUMST!element],
NULL as [RmaLineDistribution!5!DEBITAMT!element],
NULL as [RmaLineDistribution!5!ORDBTAMT!element],
NULL as [RmaLineDistribution!5!CRDTAMNT!element],
NULL as [RmaLineDistribution!5!ORCRDAMT!element],
NULL as [RmaLineDistribution!5!POSTED!element],
NULL as [RmaLineDistribution!5!POSTEDDT!element],
NULL as [RmaLineSerial!6!RETDOCID!element],
NULL as [RmaLineSerial!6!LNSEQNBR!element],
NULL as [RmaLineSerial!6!QTYTYPE!element],
NULL as [RmaLineSerial!6!Return_Serial_Number!element],
NULL as [RmaLineSerial!6!Return_Equipment_ID!element],
NULL as [RmaLineSerial!6!SLTSQNUM!element],
NULL as [RmaLineSerial!6!BIN!element],
NULL as [RmaLineSerial!6!RETCOST!element],
NULL as [RmaLineSerial!6!SVC_Original_Serial!element],
NULL as [RmaLineSerial!6!DATERECD!element],
NULL as [RmaLineSerial!6!DTSEQNUM!element],
NULL as [RmaLineSerial!6!TRXSORCE!element],
NULL as [RmaLineSerial!6!MARKED!element],
NULL as [RmaLineSerial!6!POSTED!element],
NULL as [RmaLineLot!7!RETDOCID!element],
NULL as [RmaLineLot!7!LNSEQNBR!element],
NULL as [RmaLineLot!7!QTYTYPE!element],
NULL as [RmaLineLot!7!SERLTQTY!element],
NULL as [RmaLineLot!7!Return_Lot_Number!element],
NULL as [RmaLineLot!7!SLTSQNUM!element],
NULL as [RmaLineLot!7!BIN!element],
NULL as [RmaLineLot!7!RETCOST!element],
NULL as [RmaLineLot!7!SVC_Original_Lot!element],
NULL as [RmaLineLot!7!DATERECD!element],
NULL as [RmaLineLot!7!DTSEQNUM!element],
NULL as [RmaLineLot!7!TRXSORCE!element],
NULL as [RmaLineLot!7!MARKED!element],
NULL as [RmaLineLot!7!POSTED!element],
NULL as [RmaLineLot!7!MFGDATE!element],
NULL as [RmaLineLot!7!EXPNDATE!element] FROM [#eConnect_Out] [eConnect] (nolock) 
 UNION ALL Select 2,1,eConnect.ACTION,eConnect.DOCTYPE,
eConnect.DBNAME,
eConnect.TABLENAME,
eConnect.DATE1,
eConnect.INDEX1,
eConnect.INDEX2,
eConnect.INDEX3,
LTRIM(RTRIM([Rma].TrxState)),
LTRIM(RTRIM([Rma].RETDOCID)),
LTRIM(RTRIM([Rma].Return_Record_Type)),
RTRIM([Rma].RMA_Status),RTRIM([Rma].Received),RTRIM([Rma].RETORIG),RTRIM([Rma].RETREF),RTRIM([Rma].RETSTAT),RTRIM([Rma].RETTYPE),[Rma].ENTDTE,[Rma].ENTTME,[Rma].ETADTE,[Rma].ETATME,[Rma].RETUDATE,[Rma].Return_Time,[Rma].COMPDTE,[Rma].COMPTME,RTRIM([Rma].USERID),RTRIM([Rma].OFFID),RTRIM([Rma].RTRNNAME),RTRIM([Rma].RETADDR1),RTRIM([Rma].RETADDR2),RTRIM([Rma].RETADDR3),RTRIM([Rma].RTRNCITY),RTRIM([Rma].SVC_Return_State),RTRIM([Rma].RTRNZIP),RTRIM([Rma].Return_Country),RTRIM([Rma].LOCNCODE),RTRIM([Rma].CUSTNMBR),RTRIM([Rma].ADRSCODE),RTRIM([Rma].CUSTNAME),RTRIM([Rma].CONTACT),RTRIM([Rma].ADDRESS1),RTRIM([Rma].ADDRESS2),RTRIM([Rma].ADDRESS3),RTRIM([Rma].CITY),RTRIM([Rma].STATE),RTRIM([Rma].ZIPCODE),RTRIM([Rma].COUNTRY),[Rma].TXTFIELD,RTRIM([Rma].Bill_of_Lading),RTRIM([Rma].SHIPMTHD),RTRIM([Rma].Bill_To_Customer),RTRIM([Rma].SVC_Bill_To_Address_Code),[Rma].Commit_Date,[Rma].Commit_Time,RTRIM([Rma].USERDEF1),RTRIM([Rma].USERDEF2),RTRIM([Rma].USRDEF03),RTRIM([Rma].USRDEF04),RTRIM([Rma].USRDEF05),RTRIM([Rma].CURNCYID),RTRIM([Rma].RATETPID),RTRIM([Rma].XCHGRATE),[Rma].EXCHDATE,RTRIM([Rma].CSTPONBR),RTRIM([Rma].SVC_RMA_Reason_Code),RTRIM([Rma].SVC_RMA_Reason_Code_Desc),RTRIM([Rma].SVC_RMA_From_Service),RTRIM([Rma].SVC_FO_ID),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL FROM [#eConnect_Out] [eConnect] (nolock) 
 left outer join [ReqRmaHeader] [Rma] (nolock) on [Rma].RETDOCID = eConnect.INDEX2 and [Rma].Return_Record_Type = eConnect.INDEX3 UNION ALL Select 3,2,eConnect.ACTION,eConnect.DOCTYPE,
eConnect.DBNAME,
eConnect.TABLENAME,
eConnect.DATE1,
eConnect.INDEX1,
eConnect.INDEX2,
eConnect.INDEX3,
LTRIM(RTRIM(Rma.TrxState)),
LTRIM(RTRIM(Rma.RETDOCID)),
LTRIM(RTRIM(Rma.Return_Record_Type)),
NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,RTRIM([RmaAudit].RETDOCID),RTRIM([RmaAudit].LNSEQNBR),RTRIM([RmaAudit].LNITMSEQ),RTRIM([RmaAudit].SVCFRMSTAT),RTRIM([RmaAudit].SVCTOSTAT),RTRIM([RmaAudit].DSCRPTION),RTRIM([RmaAudit].USERID),[RmaAudit].CREATDDT,[RmaAudit].CREATETIME,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL FROM [#eConnect_Out] [eConnect] (nolock) 
 left outer join [ReqRmaHeader] [Rma] (nolock) on [Rma].RETDOCID = eConnect.INDEX2 and [Rma].Return_Record_Type = eConnect.INDEX3 left outer join [ReqRmaAudit] [RmaAudit] (nolock) on RmaAudit.RETDOCID = Rma.RETDOCID UNION ALL Select 4,2,eConnect.ACTION,eConnect.DOCTYPE,
eConnect.DBNAME,
eConnect.TABLENAME,
eConnect.DATE1,
eConnect.INDEX1,
eConnect.INDEX2,
eConnect.INDEX3,
LTRIM(RTRIM(Rma.TrxState)),
LTRIM(RTRIM(Rma.RETDOCID)),
LTRIM(RTRIM(Rma.Return_Record_Type)),
NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,LTRIM(RTRIM([RmaLine].RETDOCID)),
LTRIM(RTRIM([RmaLine].LNSEQNBR)),
RTRIM([RmaLine].RETTYPE),RTRIM([RmaLine].RMA_Status),RTRIM([RmaLine].RETSTAT),RTRIM([RmaLine].Received),RTRIM([RmaLine].Traveler_Printed),RTRIM([RmaLine].SVC_Ready_To_Close),RTRIM([RmaLine].SVC_RMA_Reason_Code),RTRIM([RmaLine].SVC_RMA_Reason_Code_Desc),[RmaLine].TXTFIELD,RTRIM([RmaLine].RETREF),RTRIM([RmaLine].SRVRECTYPE),RTRIM([RmaLine].CALLNBR),RTRIM([RmaLine].EQPLINE),RTRIM([RmaLine].LNITMSEQ),RTRIM([RmaLine].SVC_RMA_From_Service),RTRIM([RmaLine].SOPNUMBE),RTRIM([RmaLine].CMPNTSEQ),RTRIM([RmaLine].SOP_Line_Item_Sequence),[RmaLine].ENTDTE,[RmaLine].ENTTME,[RmaLine].ETADTE,[RmaLine].ETATME,[RmaLine].Commit_Date,[RmaLine].Commit_Time,[RmaLine].RETUDATE,[RmaLine].Return_Time,[RmaLine].COMPDTE,[RmaLine].COMPTME,[RmaLine].PRMDATE,RTRIM([RmaLine].REFRENCE),RTRIM([RmaLine].USERID),RTRIM([RmaLine].OFFID),RTRIM([RmaLine].LOCNCODE),RTRIM([RmaLine].RTRNNAME),RTRIM([RmaLine].RETADDR1),RTRIM([RmaLine].RETADDR2),RTRIM([RmaLine].RETADDR3),RTRIM([RmaLine].RTRNCITY),RTRIM([RmaLine].SVC_Return_State),RTRIM([RmaLine].RTRNZIP),RTRIM([RmaLine].Return_Country),RTRIM([RmaLine].CUSTNAME),RTRIM([RmaLine].ADRSCODE),RTRIM([RmaLine].CONTACT),RTRIM([RmaLine].ADDRESS1),RTRIM([RmaLine].ADDRESS2),RTRIM([RmaLine].ADDRESS3),RTRIM([RmaLine].CITY),RTRIM([RmaLine].STATE),RTRIM([RmaLine].ZIPCODE),RTRIM([RmaLine].COUNTRY),RTRIM([RmaLine].CSTPONBR),RTRIM([RmaLine].QUANTITY),RTRIM([RmaLine].DECPLQTY),RTRIM([RmaLine].UOFM),RTRIM([RmaLine].ITEMNMBR),RTRIM([RmaLine].ITEMDESC),RTRIM([RmaLine].UNITCOST),RTRIM([RmaLine].ORUNTCST),RTRIM([RmaLine].EXTDCOST),RTRIM([RmaLine].OREXTCST),RTRIM([RmaLine].UNITPRCE),RTRIM([RmaLine].ORUNTPRC),RTRIM([RmaLine].XTNDPRCE),RTRIM([RmaLine].OXTNDPRC),RTRIM([RmaLine].CUSTOWN),RTRIM([RmaLine].FACTSEAL),RTRIM([RmaLine].ORDDOCID),RTRIM([RmaLine].TRANSLINESEQ),RTRIM([RmaLine].STATUS),RTRIM([RmaLine].Flat_Rate_Repair_Price),RTRIM([RmaLine].Orig_Flat_RepairPrice),RTRIM([RmaLine].Repair_Price),RTRIM([RmaLine].Originating_Repair_Price),RTRIM([RmaLine].NTE_Price),RTRIM([RmaLine].Originating_NTE_Price),RTRIM([RmaLine].Repair_Cost),RTRIM([RmaLine].Originating_Repair_Cost),RTRIM([RmaLine].Bill_of_Lading),RTRIM([RmaLine].SHIPMTHD),RTRIM([RmaLine].Credit_SOP_Type),RTRIM([RmaLine].Credit_SOP_Number),RTRIM([RmaLine].Credit_SOP_Line_Item_Seq),RTRIM([RmaLine].Replace_SOP_Type),RTRIM([RmaLine].Replace_SOP_Number),RTRIM([RmaLine].Replace_SOP_Line_Item_Se),RTRIM([RmaLine].Location_Code_Replacemen),RTRIM([RmaLine].Replace_Item_Number),RTRIM([RmaLine].Replace_U_Of_M),RTRIM([RmaLine].Replace_Price_Level),RTRIM([RmaLine].Replace_QTY),RTRIM([RmaLine].Replace_Cost),RTRIM([RmaLine].Originating_Replace_Cost),RTRIM([RmaLine].Replace_Price),RTRIM([RmaLine].Originating_Replace_Pric),RTRIM([RmaLine].SOP_Number_Invoice),RTRIM([RmaLine].Item_Number_Invoice),RTRIM([RmaLine].USERDEF1),RTRIM([RmaLine].USERDEF2),RTRIM([RmaLine].USRDEF03),RTRIM([RmaLine].USRDEF04),RTRIM([RmaLine].USRDEF05),RTRIM([RmaLine].Return_Item_Number),RTRIM([RmaLine].Return_Item_Description),RTRIM([RmaLine].Return_Location_Code),RTRIM([RmaLine].Return_QTY),RTRIM([RmaLine].Return_U_Of_M),RTRIM([RmaLine].RETCOST),RTRIM([RmaLine].Originating_Return_Cost),RTRIM([RmaLine].SVC_Extended_Return_Cost),RTRIM([RmaLine].SVC_Orig_Ext_Return_Cost),RTRIM([RmaLine].SVC_Return_Price_Level),RTRIM([RmaLine].SVC_Return_Price),RTRIM([RmaLine].Originating_Return_Price),RTRIM([RmaLine].SVC_Extended_Return_Pric),RTRIM([RmaLine].SVC_Orig_Ext_Return_Pric),RTRIM([RmaLine].SVC_FO_ID),RTRIM([RmaLine].SVC_SCM_Complete),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL FROM [#eConnect_Out] [eConnect] (nolock) 
 left outer join [ReqRmaHeader] [Rma] (nolock) on [Rma].RETDOCID = eConnect.INDEX2 and [Rma].Return_Record_Type = eConnect.INDEX3 left outer join [ReqRmaLine] [RmaLine] (nolock) on RmaLine.RETDOCID = Rma.RETDOCID UNION ALL Select 5,4,eConnect.ACTION,eConnect.DOCTYPE,
eConnect.DBNAME,
eConnect.TABLENAME,
eConnect.DATE1,
eConnect.INDEX1,
eConnect.INDEX2,
eConnect.INDEX3,
LTRIM(RTRIM(Rma.TrxState)),
LTRIM(RTRIM(Rma.RETDOCID)),
LTRIM(RTRIM(Rma.Return_Record_Type)),
NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,LTRIM(RTRIM(RmaLine.RETDOCID)),
LTRIM(RTRIM(RmaLine.LNSEQNBR)),
NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,RTRIM([RmaLineDistribution].Return_Record_Type),RTRIM([RmaLineDistribution].RETDOCID),RTRIM([RmaLineDistribution].LNSEQNBR),RTRIM([RmaLineDistribution].LINITMTYP),RTRIM([RmaLineDistribution].SEQNUMBR),RTRIM([RmaLineDistribution].SVC_Distribution_Type),RTRIM([RmaLineDistribution].DistRef),RTRIM([RmaLineDistribution].ACTNUMST),RTRIM([RmaLineDistribution].DEBITAMT),RTRIM([RmaLineDistribution].ORDBTAMT),RTRIM([RmaLineDistribution].CRDTAMNT),RTRIM([RmaLineDistribution].ORCRDAMT),RTRIM([RmaLineDistribution].POSTED),[RmaLineDistribution].POSTEDDT,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL FROM [#eConnect_Out] [eConnect] (nolock) 
 left outer join [ReqRmaHeader] [Rma] (nolock) on [Rma].RETDOCID = eConnect.INDEX2 and [Rma].Return_Record_Type = eConnect.INDEX3 left outer join [ReqRmaLine] [RmaLine] (nolock) on RmaLine.RETDOCID = Rma.RETDOCID left outer join [ReqRmaLineDistributions] [RmaLineDistribution] (nolock) on RmaLineDistribution.RETDOCID = RmaLine.RETDOCID and RmaLineDistribution.LNSEQNBR = RmaLine.LNSEQNBR UNION ALL Select 6,4,eConnect.ACTION,eConnect.DOCTYPE,
eConnect.DBNAME,
eConnect.TABLENAME,
eConnect.DATE1,
eConnect.INDEX1,
eConnect.INDEX2,
eConnect.INDEX3,
LTRIM(RTRIM(Rma.TrxState)),
LTRIM(RTRIM(Rma.RETDOCID)),
LTRIM(RTRIM(Rma.Return_Record_Type)),
NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,LTRIM(RTRIM(RmaLine.RETDOCID)),
LTRIM(RTRIM(RmaLine.LNSEQNBR)),
NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,RTRIM([RmaLineSerial].RETDOCID),RTRIM([RmaLineSerial].LNSEQNBR),RTRIM([RmaLineSerial].QTYTYPE),RTRIM([RmaLineSerial].Return_Serial_Number),RTRIM([RmaLineSerial].Return_Equipment_ID),RTRIM([RmaLineSerial].SLTSQNUM),RTRIM([RmaLineSerial].BIN),RTRIM([RmaLineSerial].RETCOST),RTRIM([RmaLineSerial].SVC_Original_Serial),[RmaLineSerial].DATERECD,RTRIM([RmaLineSerial].DTSEQNUM),RTRIM([RmaLineSerial].TRXSORCE),RTRIM([RmaLineSerial].MARKED),RTRIM([RmaLineSerial].POSTED),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL FROM [#eConnect_Out] [eConnect] (nolock) 
 left outer join [ReqRmaHeader] [Rma] (nolock) on [Rma].RETDOCID = eConnect.INDEX2 and [Rma].Return_Record_Type = eConnect.INDEX3 left outer join [ReqRmaLine] [RmaLine] (nolock) on RmaLine.RETDOCID = Rma.RETDOCID left outer join [ReqRmaLineSerial] [RmaLineSerial] (nolock) on RmaLineSerial.RETDOCID = RmaLine.RETDOCID and RmaLineSerial.LNSEQNBR = RmaLine.LNSEQNBR UNION ALL Select 7,4,eConnect.ACTION,eConnect.DOCTYPE,
eConnect.DBNAME,
eConnect.TABLENAME,
eConnect.DATE1,
eConnect.INDEX1,
eConnect.INDEX2,
eConnect.INDEX3,
LTRIM(RTRIM(Rma.TrxState)),
LTRIM(RTRIM(Rma.RETDOCID)),
LTRIM(RTRIM(Rma.Return_Record_Type)),
NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,LTRIM(RTRIM(RmaLine.RETDOCID)),
LTRIM(RTRIM(RmaLine.LNSEQNBR)),
NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,RTRIM([RmaLineLot].RETDOCID),RTRIM([RmaLineLot].LNSEQNBR),RTRIM([RmaLineLot].QTYTYPE),RTRIM([RmaLineLot].SERLTQTY),RTRIM([RmaLineLot].Return_Lot_Number),RTRIM([RmaLineLot].SLTSQNUM),RTRIM([RmaLineLot].BIN),RTRIM([RmaLineLot].RETCOST),RTRIM([RmaLineLot].SVC_Original_Lot),[RmaLineLot].DATERECD,RTRIM([RmaLineLot].DTSEQNUM),RTRIM([RmaLineLot].TRXSORCE),RTRIM([RmaLineLot].MARKED),RTRIM([RmaLineLot].POSTED),[RmaLineLot].MFGDATE,[RmaLineLot].EXPNDATE FROM [#eConnect_Out] [eConnect] (nolock) 
 left outer join [ReqRmaHeader] [Rma] (nolock) on [Rma].RETDOCID = eConnect.INDEX2 and [Rma].Return_Record_Type = eConnect.INDEX3 left outer join [ReqRmaLine] [RmaLine] (nolock) on RmaLine.RETDOCID = Rma.RETDOCID left outer join [ReqRmaLineLot] [RmaLineLot] (nolock) on RmaLineLot.RETDOCID = RmaLine.RETDOCID and RmaLineLot.LNSEQNBR = RmaLine.LNSEQNBR Order by  [eConnect!1!TrxState],  [eConnect!1!RETDOCID],  [eConnect!1!Return_Record_Type],  [Rma!2!TrxState!element], [Rma!2!RETDOCID!element], [Rma!2!Return_Record_Type!element], [RmaLine!4!RETDOCID!element], [RmaLine!4!LNSEQNBR!element],Tag,Parent FOR XML EXPLICIT, BINARY BASE64
GO
GRANT EXECUTE ON  [dbo].[taRequesterWSReturnMaterialAuthorization2] TO [DYNGRP]
GO
