SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_WFI10005N_2] (@BS int, @Workflow_User char(85), @WorkflowStepInstanceID char(37), @UsersListGuid char(37), @DEX_ROW_ID int, @Workflow_User_RS char(85), @WorkflowStepInstanceID_RS char(37), @UsersListGuid_RS char(37), @Workflow_User_RE char(85), @WorkflowStepInstanceID_RE char(37), @UsersListGuid_RE char(37)) AS  set nocount on IF @Workflow_User_RS IS NULL BEGIN SELECT TOP 25  Workflow_User, WorkflowStepInstanceID, UsersListGuid, WorkflowTaskAssignedTo, EMail, ADDisplayName, DEX_ROW_ID FROM .WFI10005 WHERE ( Workflow_User = @Workflow_User AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND UsersListGuid = @UsersListGuid AND DEX_ROW_ID > @DEX_ROW_ID OR Workflow_User = @Workflow_User AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND UsersListGuid > @UsersListGuid OR Workflow_User = @Workflow_User AND WorkflowStepInstanceID > @WorkflowStepInstanceID OR Workflow_User > @Workflow_User ) ORDER BY Workflow_User ASC, WorkflowStepInstanceID ASC, UsersListGuid ASC, DEX_ROW_ID ASC END ELSE IF @Workflow_User_RS = @Workflow_User_RE BEGIN SELECT TOP 25  Workflow_User, WorkflowStepInstanceID, UsersListGuid, WorkflowTaskAssignedTo, EMail, ADDisplayName, DEX_ROW_ID FROM .WFI10005 WHERE Workflow_User = @Workflow_User_RS AND WorkflowStepInstanceID BETWEEN @WorkflowStepInstanceID_RS AND @WorkflowStepInstanceID_RE AND UsersListGuid BETWEEN @UsersListGuid_RS AND @UsersListGuid_RE AND ( Workflow_User = @Workflow_User AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND UsersListGuid = @UsersListGuid AND DEX_ROW_ID > @DEX_ROW_ID OR Workflow_User = @Workflow_User AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND UsersListGuid > @UsersListGuid OR Workflow_User = @Workflow_User AND WorkflowStepInstanceID > @WorkflowStepInstanceID OR Workflow_User > @Workflow_User ) ORDER BY Workflow_User ASC, WorkflowStepInstanceID ASC, UsersListGuid ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  Workflow_User, WorkflowStepInstanceID, UsersListGuid, WorkflowTaskAssignedTo, EMail, ADDisplayName, DEX_ROW_ID FROM .WFI10005 WHERE Workflow_User BETWEEN @Workflow_User_RS AND @Workflow_User_RE AND WorkflowStepInstanceID BETWEEN @WorkflowStepInstanceID_RS AND @WorkflowStepInstanceID_RE AND UsersListGuid BETWEEN @UsersListGuid_RS AND @UsersListGuid_RE AND ( Workflow_User = @Workflow_User AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND UsersListGuid = @UsersListGuid AND DEX_ROW_ID > @DEX_ROW_ID OR Workflow_User = @Workflow_User AND WorkflowStepInstanceID = @WorkflowStepInstanceID AND UsersListGuid > @UsersListGuid OR Workflow_User = @Workflow_User AND WorkflowStepInstanceID > @WorkflowStepInstanceID OR Workflow_User > @Workflow_User ) ORDER BY Workflow_User ASC, WorkflowStepInstanceID ASC, UsersListGuid ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_WFI10005N_2] TO [DYNGRP]
GO
