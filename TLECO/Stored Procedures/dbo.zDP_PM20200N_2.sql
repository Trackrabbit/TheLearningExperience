SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_PM20200N_2] (@BS int, @KEYSOURC char(41), @VCHRNMBR char(21), @DOCTYPE smallint, @APTVCHNM char(21), @APTODCTY smallint, @DISTTYPE smallint, @DSTINDX int, @PSTGSTUS smallint, @DEX_ROW_ID int, @KEYSOURC_RS char(41), @VCHRNMBR_RS char(21), @DOCTYPE_RS smallint, @APTVCHNM_RS char(21), @APTODCTY_RS smallint, @DISTTYPE_RS smallint, @DSTINDX_RS int, @PSTGSTUS_RS smallint, @KEYSOURC_RE char(41), @VCHRNMBR_RE char(21), @DOCTYPE_RE smallint, @APTVCHNM_RE char(21), @APTODCTY_RE smallint, @DISTTYPE_RE smallint, @DSTINDX_RE int, @PSTGSTUS_RE smallint) AS  set nocount on IF @KEYSOURC_RS IS NULL BEGIN SELECT TOP 25  KEYSOURC, VCHRNMBR, DOCTYPE, DSTSQNUM, CRDTAMNT, DEBITAMT, DSTINDX, DISTTYPE, APTVCHNM, APTODCTY, CHANGED, USERID, PSTGSTUS, GLPOSTDT, CURNCYID, CURRNIDX, ORCRDAMT, ORDBTAMT, DEX_ROW_ID FROM .PM20200 WHERE ( KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY = @APTODCTY AND DISTTYPE = @DISTTYPE AND DSTINDX = @DSTINDX AND PSTGSTUS = @PSTGSTUS AND DEX_ROW_ID > @DEX_ROW_ID OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY = @APTODCTY AND DISTTYPE = @DISTTYPE AND DSTINDX = @DSTINDX AND PSTGSTUS > @PSTGSTUS OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY = @APTODCTY AND DISTTYPE = @DISTTYPE AND DSTINDX > @DSTINDX OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY = @APTODCTY AND DISTTYPE > @DISTTYPE OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY > @APTODCTY OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM > @APTVCHNM OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE > @DOCTYPE OR KEYSOURC = @KEYSOURC AND VCHRNMBR > @VCHRNMBR OR KEYSOURC > @KEYSOURC ) ORDER BY KEYSOURC ASC, VCHRNMBR ASC, DOCTYPE ASC, APTVCHNM ASC, APTODCTY ASC, DISTTYPE ASC, DSTINDX ASC, PSTGSTUS ASC, DEX_ROW_ID ASC END ELSE IF @KEYSOURC_RS = @KEYSOURC_RE BEGIN SELECT TOP 25  KEYSOURC, VCHRNMBR, DOCTYPE, DSTSQNUM, CRDTAMNT, DEBITAMT, DSTINDX, DISTTYPE, APTVCHNM, APTODCTY, CHANGED, USERID, PSTGSTUS, GLPOSTDT, CURNCYID, CURRNIDX, ORCRDAMT, ORDBTAMT, DEX_ROW_ID FROM .PM20200 WHERE KEYSOURC = @KEYSOURC_RS AND VCHRNMBR BETWEEN @VCHRNMBR_RS AND @VCHRNMBR_RE AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND APTVCHNM BETWEEN @APTVCHNM_RS AND @APTVCHNM_RE AND APTODCTY BETWEEN @APTODCTY_RS AND @APTODCTY_RE AND DISTTYPE BETWEEN @DISTTYPE_RS AND @DISTTYPE_RE AND DSTINDX BETWEEN @DSTINDX_RS AND @DSTINDX_RE AND PSTGSTUS BETWEEN @PSTGSTUS_RS AND @PSTGSTUS_RE AND ( KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY = @APTODCTY AND DISTTYPE = @DISTTYPE AND DSTINDX = @DSTINDX AND PSTGSTUS = @PSTGSTUS AND DEX_ROW_ID > @DEX_ROW_ID OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY = @APTODCTY AND DISTTYPE = @DISTTYPE AND DSTINDX = @DSTINDX AND PSTGSTUS > @PSTGSTUS OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY = @APTODCTY AND DISTTYPE = @DISTTYPE AND DSTINDX > @DSTINDX OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY = @APTODCTY AND DISTTYPE > @DISTTYPE OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY > @APTODCTY OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM > @APTVCHNM OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE > @DOCTYPE OR KEYSOURC = @KEYSOURC AND VCHRNMBR > @VCHRNMBR OR KEYSOURC > @KEYSOURC ) ORDER BY KEYSOURC ASC, VCHRNMBR ASC, DOCTYPE ASC, APTVCHNM ASC, APTODCTY ASC, DISTTYPE ASC, DSTINDX ASC, PSTGSTUS ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  KEYSOURC, VCHRNMBR, DOCTYPE, DSTSQNUM, CRDTAMNT, DEBITAMT, DSTINDX, DISTTYPE, APTVCHNM, APTODCTY, CHANGED, USERID, PSTGSTUS, GLPOSTDT, CURNCYID, CURRNIDX, ORCRDAMT, ORDBTAMT, DEX_ROW_ID FROM .PM20200 WHERE KEYSOURC BETWEEN @KEYSOURC_RS AND @KEYSOURC_RE AND VCHRNMBR BETWEEN @VCHRNMBR_RS AND @VCHRNMBR_RE AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND APTVCHNM BETWEEN @APTVCHNM_RS AND @APTVCHNM_RE AND APTODCTY BETWEEN @APTODCTY_RS AND @APTODCTY_RE AND DISTTYPE BETWEEN @DISTTYPE_RS AND @DISTTYPE_RE AND DSTINDX BETWEEN @DSTINDX_RS AND @DSTINDX_RE AND PSTGSTUS BETWEEN @PSTGSTUS_RS AND @PSTGSTUS_RE AND ( KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY = @APTODCTY AND DISTTYPE = @DISTTYPE AND DSTINDX = @DSTINDX AND PSTGSTUS = @PSTGSTUS AND DEX_ROW_ID > @DEX_ROW_ID OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY = @APTODCTY AND DISTTYPE = @DISTTYPE AND DSTINDX = @DSTINDX AND PSTGSTUS > @PSTGSTUS OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY = @APTODCTY AND DISTTYPE = @DISTTYPE AND DSTINDX > @DSTINDX OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY = @APTODCTY AND DISTTYPE > @DISTTYPE OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM = @APTVCHNM AND APTODCTY > @APTODCTY OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE = @DOCTYPE AND APTVCHNM > @APTVCHNM OR KEYSOURC = @KEYSOURC AND VCHRNMBR = @VCHRNMBR AND DOCTYPE > @DOCTYPE OR KEYSOURC = @KEYSOURC AND VCHRNMBR > @VCHRNMBR OR KEYSOURC > @KEYSOURC ) ORDER BY KEYSOURC ASC, VCHRNMBR ASC, DOCTYPE ASC, APTVCHNM ASC, APTODCTY ASC, DISTTYPE ASC, DSTINDX ASC, PSTGSTUS ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_PM20200N_2] TO [DYNGRP]
GO
