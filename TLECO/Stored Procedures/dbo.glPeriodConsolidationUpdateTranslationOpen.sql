SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[glPeriodConsolidationUpdateTranslationOpen]  @I_sYear smallint = NULL,  @I_dPeriodZeroDate datetime = NULL,  @I_iJournal_EntryBase int   = NULL,  @I_iJournal_EntryIFRS int   = NULL,  @I_iJournal_EntryLOCAL int   = NULL,  @I_cNext_Trx_Source char(13) = NULL,  @O_SQL_Error_State int   = NULL output  as  declare  @cBFSource varchar(255),  @cDBName char(5),  @iStatus int,  @iError int  if  @I_sYear is NULL or  @I_dPeriodZeroDate is NULL or  @I_iJournal_EntryBase is NULL or  @I_iJournal_EntryIFRS is NULL or  @I_iJournal_EntryLOCAL is NULL or  @I_cNext_Trx_Source is NULL  begin  select @O_SQL_Error_State = 20856  return  end   select @iStatus = 0,   @iError = 0 select @cDBName = db_name()  exec    @iStatus = DYNAMICS.dbo.smGetMsgString 12029, @cDBName, @cBFSource output, @O_SQL_Error_State output  select @iError = @@error if @iStatus = 0 and @iError <> 0  select @iStatus = @iError  if ( (@iStatus <> 0) or (@O_SQL_Error_State <> 0) )  return (@iStatus)  update GL20001 set Identity_Column = isnull(GL20000.DEX_ROW_ID, 0),  Original_Exchange_Rate = GL20000.XCHGRATE from GL20000 where GL20001.OPENYEAR = @I_sYear  and (GL20001.JRNENTRY = @I_iJournal_EntryBase or GL20001.JRNENTRY = @I_iJournal_EntryIFRS or GL20001.JRNENTRY = @I_iJournal_EntryLOCAL)  and GL20001.TRXDATE = @I_dPeriodZeroDate  and GL20001.SOURCDOC = @cBFSource  and GL20001.TRXSORCE = @I_cNext_Trx_Source  and GL20001.OPENYEAR = GL20000.OPENYEAR  and GL20001.ACTINDX = GL20000.ACTINDX  and GL20001.Ledger_ID = GL20000.Ledger_ID  and GL20001.CURNCYID = GL20000.CURNCYID   and GL20001.JRNENTRY = GL20000.JRNENTRY  and GL20001.TRXDATE = GL20000.TRXDATE  and GL20001.SEQNUMBR = GL20000.SEQNUMBR  return (@iStatus)   
GO
GRANT EXECUTE ON  [dbo].[glPeriodConsolidationUpdateTranslationOpen] TO [DYNGRP]
GO
