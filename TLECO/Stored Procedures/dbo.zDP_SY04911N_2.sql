SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SY04911N_2] (@BS int, @DICTRYID smallint, @MODULE1 smallint, @USERID char(15), @Identity_Column int, @DICTRYID_RS smallint, @MODULE1_RS smallint, @USERID_RS char(15), @Identity_Column_RS int, @DICTRYID_RE smallint, @MODULE1_RE smallint, @USERID_RE char(15), @Identity_Column_RE int) AS  set nocount on IF @DICTRYID_RS IS NULL BEGIN SELECT TOP 25  Identity_Column, USERID, MODULE1, DOCTYPE, EmailMessageFrom, EmailSubject, AllowMultipleAtt, DICTRYID, EmailMessageID, Master_ID, DEX_ROW_ID, EmailToAddress, EmailCcAddress, EmailBccAddress, EmailReplyToAddress, EmailBody FROM .SY04911 WHERE ( DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND USERID = @USERID AND Identity_Column > @Identity_Column OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND USERID > @USERID OR DICTRYID = @DICTRYID AND MODULE1 > @MODULE1 OR DICTRYID > @DICTRYID ) ORDER BY DICTRYID ASC, MODULE1 ASC, USERID ASC, Identity_Column ASC END ELSE IF @DICTRYID_RS = @DICTRYID_RE BEGIN SELECT TOP 25  Identity_Column, USERID, MODULE1, DOCTYPE, EmailMessageFrom, EmailSubject, AllowMultipleAtt, DICTRYID, EmailMessageID, Master_ID, DEX_ROW_ID, EmailToAddress, EmailCcAddress, EmailBccAddress, EmailReplyToAddress, EmailBody FROM .SY04911 WHERE DICTRYID = @DICTRYID_RS AND MODULE1 BETWEEN @MODULE1_RS AND @MODULE1_RE AND USERID BETWEEN @USERID_RS AND @USERID_RE AND Identity_Column BETWEEN @Identity_Column_RS AND @Identity_Column_RE AND ( DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND USERID = @USERID AND Identity_Column > @Identity_Column OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND USERID > @USERID OR DICTRYID = @DICTRYID AND MODULE1 > @MODULE1 OR DICTRYID > @DICTRYID ) ORDER BY DICTRYID ASC, MODULE1 ASC, USERID ASC, Identity_Column ASC END ELSE BEGIN SELECT TOP 25  Identity_Column, USERID, MODULE1, DOCTYPE, EmailMessageFrom, EmailSubject, AllowMultipleAtt, DICTRYID, EmailMessageID, Master_ID, DEX_ROW_ID, EmailToAddress, EmailCcAddress, EmailBccAddress, EmailReplyToAddress, EmailBody FROM .SY04911 WHERE DICTRYID BETWEEN @DICTRYID_RS AND @DICTRYID_RE AND MODULE1 BETWEEN @MODULE1_RS AND @MODULE1_RE AND USERID BETWEEN @USERID_RS AND @USERID_RE AND Identity_Column BETWEEN @Identity_Column_RS AND @Identity_Column_RE AND ( DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND USERID = @USERID AND Identity_Column > @Identity_Column OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND USERID > @USERID OR DICTRYID = @DICTRYID AND MODULE1 > @MODULE1 OR DICTRYID > @DICTRYID ) ORDER BY DICTRYID ASC, MODULE1 ASC, USERID ASC, Identity_Column ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY04911N_2] TO [DYNGRP]
GO
