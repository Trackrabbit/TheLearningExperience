SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE  procedure [dbo].[uprLoadTempDeptSummaryTable]  @IN_TempTableName varchar(255),  @IN_sYear smallint,  @IN_eYear smallint,  @IN_sDept char(6),  @IN_eDept char(6),  @IN_sPosition char(6),  @IN_ePosition char(6),  @IN_sEmpID char(15),  @IN_eEmpID char(15),  @IN_sEmpClassID char(15),  @IN_eEmpClassID char(15),  @IN_sDate datetime,  @IN_eDate datetime,  @IN_RangeSelect smallint,  @IN_ReportType smallint as  DECLARE @SQLString varchar(1000)  SET @SQLString = @SQLString + 'INSERT INTO ' + @IN_TempTableName SET @SQLString = @SQLString + ' SELECT UPR30300.DEPRTMNT, ''1990-01-01 00:00:00.000'', SUM(UPRTRXAM) , 0.0 , 0.0 ' SET @SQLString = @SQLString + 'FROM dbo.UPR30300 JOIN dbo.UPR00100 ' SET @SQLString = @SQLString + ' ON UPR30300.EMPLOYID = UPR00100.EMPLOYID ' SET @SQLString = @SQLString + 'WHERE PYRLRTYP = 1 AND '  IF @IN_RangeSelect= 1   Set @SQLString = @SQLString + '(UPR00100.EMPLOYID >= ''' + @IN_sEmpID + ''' AND UPR00100.EMPLOYID <= ''' + @IN_eEmpID + ''') AND '  IF @IN_RangeSelect= 2   Set @SQLString = @SQLString + '(UPR00100.EMPLCLAS >= ''' + @IN_sEmpClassID + ''' AND UPR00100.EMPLCLAS <= ''' + @IN_eEmpClassID + ''') AND '  IF @IN_RangeSelect= 3   Set @SQLString = @SQLString + '(UPR00100.DEPRTMNT >= ''' + @IN_sDept + ''' AND UPR00100.DEPRTMNT <= ''' + @IN_eDept + ''') AND '  IF @IN_RangeSelect= 4   Set @SQLString = @SQLString + '(UPR00100.JOBTITLE >= ''' + @IN_sPosition + ''' AND UPR00100.JOBTITLE <= ''' + @IN_ePosition + ''') AND '  SET @SQLString = @SQLString + '(UPR30300.CHEKDATE BETWEEN ''' + CONVERT(varchar(10), @IN_sDate, 110) + ''' AND ''' + CONVERT(varchar(10), @IN_eDate, 110) + ''') AND ' SET @SQLString = @SQLString + '(UPR30300.YEAR1 >= ' + CAST(@IN_sYear AS CHAR(4)) + ' AND UPR30300.YEAR1 <= ' + CAST(@IN_eYear AS CHAR(4)) + ') AND ' SET @SQLString = @SQLString + '  PAYADVNC = 0.00 ' SET @SQLString = @SQLString + 'GROUP BY UPR30300.DEPRTMNT'  EXEC(@SQLString)  return(@@ERROR)   
GO
GRANT EXECUTE ON  [dbo].[uprLoadTempDeptSummaryTable] TO [DYNGRP]
GO
