SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 CREATE procedure [dbo].[SVC_Inc_Update_Cont_HDR](@CONSTS smallint,  @CONTNBR char(11),  @Customer char(15),  @Address char(15),   @Old_BLOCKTIME numeric(19,2),  @Old_TIMEVALUE numeric(19,2),  @Old_ACTUALCALLS numeric(19,2),  @Old_VALUECALLS numeric(19,2),  @Old_MAXCALLS numeric(19,2),  @Old_CTOTAL numeric(19,2),  @Old_CTOTALUNIT numeric(19,2),  @Old_CINVAMT numeric(19,2),  @Old_CAMTTOINVOICE numeric(19,2),  @Old_CDiscount numeric(19,2),  @Old_ORIGTIMEVALUE numeric(19,2),  @Old_ORIGVALUECALLS numeric(19,2),  @Old_ORIGCTOTAL numeric(19,2),  @Old_ORIGCTOTALUNIT numeric(19,2),  @Old_ORIGCINVAMT numeric(19,2),  @Old_ORIGCAMTTOINVOICE numeric(19,2),  @Old_ORIGCDiscount numeric(19,2),   @New_BLOCKTIME numeric(19,2),  @New_TIMEVALUE numeric(19,2),  @New_ACTUALCALLS numeric(19,2),  @New_VALUECALLS numeric(19,2),  @New_MAXCALLS numeric(19,2),  @New_CTOTAL numeric(19,2),  @New_CTOTALUNIT numeric(19,2),  @New_CINVAMT numeric(19,2),  @New_CAMTTOINVOICE numeric(19,2),  @New_CDiscount numeric(19,2),  @New_ORIGTIMEVALUE numeric(19,2),  @New_ORIGVALUECALLS numeric(19,2),  @New_ORIGCTOTAL numeric(19,2),  @New_ORIGCTOTALUNIT numeric(19,2),  @New_ORIGCINVAMT numeric(19,2),  @New_ORIGCAMTTOINVOICE numeric(19,2),  @New_ORIGCDiscount numeric(19,2)  ) as  select @Old_BLOCKTIME = isnull(@Old_BLOCKTIME,0),  @Old_TIMEVALUE = isnull(@Old_TIMEVALUE,0),  @Old_ACTUALCALLS = isnull(@Old_ACTUALCALLS,0),  @Old_VALUECALLS = isnull(@Old_VALUECALLS,0),  @Old_MAXCALLS = isnull(@Old_MAXCALLS,0),  @Old_CTOTAL = isnull(@Old_CTOTAL,0),  @Old_CTOTALUNIT = isnull(@Old_CTOTALUNIT,0),  @Old_CINVAMT = isnull(@Old_CINVAMT,0),  @Old_CAMTTOINVOICE = isnull(@Old_CAMTTOINVOICE,0),  @Old_CDiscount = isnull(@Old_CDiscount,0),  @Old_ORIGTIMEVALUE= isnull(@Old_ORIGTIMEVALUE ,0),  @Old_ORIGVALUECALLS = isnull(@Old_ORIGVALUECALLS,0),  @Old_ORIGCTOTAL = isnull(@Old_ORIGCTOTAL,0),  @Old_ORIGCTOTALUNIT = isnull(@Old_ORIGCTOTALUNIT ,0),  @Old_ORIGCINVAMT = isnull(@Old_ORIGCINVAMT,0),  @Old_ORIGCAMTTOINVOICE = isnull(@Old_ORIGCAMTTOINVOICE,0),  @Old_ORIGCDiscount = isnull(@Old_ORIGCDiscount,0)  select @New_BLOCKTIME = isnull(@New_BLOCKTIME,0),  @New_TIMEVALUE = isnull(@New_TIMEVALUE,0),  @New_ACTUALCALLS = isnull(@New_ACTUALCALLS,0),  @New_VALUECALLS = isnull(@New_VALUECALLS,0),  @New_MAXCALLS = isnull(@New_MAXCALLS,0),  @New_CTOTAL = isnull(@New_CTOTAL,0),  @New_CTOTALUNIT = isnull(@New_CTOTALUNIT,0),  @New_CINVAMT = isnull(@New_CINVAMT,0),  @New_CAMTTOINVOICE = isnull(@New_CAMTTOINVOICE,0),  @New_CDiscount = isnull(@New_CDiscount,0),  @New_ORIGTIMEVALUE = isnull(@New_ORIGTIMEVALUE,0),  @New_ORIGVALUECALLS = isnull(@New_ORIGVALUECALLS,0),  @New_ORIGCTOTAL = isnull(@New_ORIGCTOTAL,0),  @New_ORIGCTOTALUNIT = isnull(@New_ORIGCTOTALUNIT,0),  @New_ORIGCINVAMT = isnull(@New_ORIGCINVAMT,0),  @New_ORIGCAMTTOINVOICE = isnull(@New_ORIGCAMTTOINVOICE,0),  @New_ORIGCDiscount = isnull(@New_ORIGCDiscount,0)  update SVC00600 with (ROWLOCK) set BLKTIM = BLKTIM - @Old_BLOCKTIME + @New_BLOCKTIME ,  VALTIM = VALTIM - @Old_TIMEVALUE + @New_TIMEVALUE ,  ACTCAL = ACTCAL - @Old_ACTUALCALLS + @New_ACTUALCALLS ,  TOTVALCAL = TOTVALCAL - @Old_VALUECALLS + @New_VALUECALLS ,  NBRCAL = NBRCAL - @Old_MAXCALLS + @New_MAXCALLS,   Total_Unit = Total_Unit -  @Old_CTOTALUNIT + @New_CTOTALUNIT,  Invoiced_Amount = Invoiced_Amount - @Old_CINVAMT + @New_CINVAMT,  ORDDLRAT = ORDDLRAT - @Old_ORIGCDiscount + @New_ORIGCDiscount,  DSCDLRAM = DSCDLRAM - @Old_CDiscount + @New_CDiscount,  TOTAL = TOTAL - @Old_CTOTAL + @New_CTOTAL,  ORIGTOTAL = ORIGTOTAL - @Old_ORIGCTOTAL + @New_ORIGCTOTAL,     ORIGVALTIM = ORIGVALTIM - @Old_ORIGTIMEVALUE + @New_ORIGTIMEVALUE ,  ORIGTOTVALCAL = ORIGTOTVALCAL - @Old_ORIGVALUECALLS + @New_ORIGVALUECALLS ,  Originating_Total_Unit = Originating_Total_Unit -  @Old_ORIGCTOTALUNIT + @New_ORIGCTOTALUNIT,  Orig_Invoiced_Amount = Orig_Invoiced_Amount - @Old_CINVAMT + @New_ORIGCINVAMT where CONSTS = @CONSTS and  CONTNBR = @CONTNBR update SVC00608 with (ROWLOCK) set BLKTIM = BLKTIM - @Old_BLOCKTIME + @New_BLOCKTIME ,  VALTIM = VALTIM - @Old_TIMEVALUE + @New_TIMEVALUE ,  ACTCAL = ACTCAL - @Old_ACTUALCALLS + @New_ACTUALCALLS ,  TOTVALCAL = TOTVALCAL - @Old_VALUECALLS + @New_VALUECALLS ,  NBRCAL = NBRCAL - @Old_MAXCALLS + @New_MAXCALLS,   TOTAL = TOTAL - @Old_CTOTAL + @New_CTOTAL,  Total_Unit = Total_Unit -  @Old_CTOTALUNIT + @New_CTOTALUNIT,  Invoiced_Amount = Invoiced_Amount - @Old_CINVAMT + @New_CINVAMT,  Amount_To_Invoice = Amount_To_Invoice - @Old_CAMTTOINVOICE + @New_CAMTTOINVOICE ,  Orig_Amount_To_Invoice = Orig_Amount_To_Invoice - @Old_ORIGCAMTTOINVOICE + @New_ORIGCAMTTOINVOICE ,  ORIGVALTIM = ORIGVALTIM - @Old_ORIGTIMEVALUE + @New_ORIGTIMEVALUE ,  ORIGTOTVALCAL = ORIGTOTVALCAL - @Old_ORIGVALUECALLS + @New_ORIGVALUECALLS ,  ORIGTOTAL = ORIGTOTAL - @Old_ORIGCTOTAL + @New_ORIGCTOTAL,  Originating_Total_Unit = Originating_Total_Unit -  @Old_ORIGCTOTALUNIT + @New_ORIGCTOTALUNIT,  Orig_Invoiced_Amount = Orig_Invoiced_Amount - @Old_CINVAMT + @New_ORIGCINVAMT where CONSTS = @CONSTS and  CONTNBR = @CONTNBR and  CUSTNMBR = @Customer and  ADRSCODE = @Address    
GO
GRANT EXECUTE ON  [dbo].[SVC_Inc_Update_Cont_HDR] TO [DYNGRP]
GO
