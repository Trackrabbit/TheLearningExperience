SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_FixedAssets_FixedAssetsBooks] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @Asset_ID varchar(255), @Suf varchar(255), @Asset_Description varchar(255), @Asset_Index varchar(255), @Asset_Class_ID varchar(255), @Structure_ID varchar(255), @Location_ID varchar(255), @Physical_Location_ID varchar(255), @Master_Asset_ID varchar(255), @Asset_Type varchar(255), @Book_ID varchar(255), @Book_Index varchar(255), @Place_in_Service_Date varchar(255), @Delete_Date varchar(255), @Depreciation_Begin_Date varchar(255), @Fully_Depreciated_Flag varchar(255), @Fully_Depreciated_Date varchar(255), @Orig_Life_Years___Days varchar(255), @Original_Life_Years varchar(255), @Original_Life_Days varchar(255), @Rem_Life_Years___Days varchar(255), @Remaining_Life_Years varchar(255), @Remaining_Life_Days varchar(255), @Depreciated_to_Date varchar(255), @Last_Recalc_Date varchar(255), @Last_Recalc_Date_Fiscal_Year varchar(255), @Begin_Year_Cost varchar(255), @Begin_Salvage varchar(255), @Begin_Reserve varchar(255), @Cost_Basis varchar(255), @Salvage_Value varchar(255), @Depreciation_Method varchar(255), @Averaging_Convention varchar(255), @Switchover varchar(255), @Switch_From_1_Method varchar(255), @Switch_From_1_Amount varchar(255), @Switch_From_1_Date varchar(255), @Daily_Depreciation_Rate varchar(255), @Periodic_Depreciation_Rate varchar(255), @Yearly_Depreciation_Rate varchar(255), @Save_Daily_Depreciation_Rate varchar(255), @Save_Periodic_Depreciation_Rate varchar(255), @Save_Yearly_Depreciation_Rate varchar(255), @Amortization_Code varchar(255), @Amortization_Amount varchar(255), @Current_Run_Depreciation_Amount varchar(255), @Previous_Run_Depreciation_Amount varchar(255), @YTD_Depreciation_Amount varchar(255), @LTD_Depreciation_Amount varchar(255), @Net_Book_Value varchar(255), @Luxury_Automobile_Indicator varchar(255), @Prorated_Retirement_Date varchar(255), @Depreciated_to_Date_Before_Retire varchar(255), @Recognized_Gain_Loss varchar(255), @Non_Recognized_Gain_Loss varchar(255), @Straight_Line_Depr_at_Retirement varchar(255), @Cost_Before_Retire_or_Delete varchar(255), @Initial_Allowance_Percentage varchar(255), @Initial_Allowance_Amount varchar(255), @Date_Added varchar(255), @Note_Index varchar(255), @Last_Maintained_Date varchar(255), @Last_Maintained_Time varchar(255), @Last_Maintained_User_ID varchar(255), @Special_Depreciation_Allowance varchar(255), @Special_Depreciation_Allowance_Percentage varchar(255), @Special_Depreciation_Allowance_Amount varchar(255), @DrillBack_Base_Url varchar(255), @DrillBack_Base_Url_For_FA varchar(255), @Asset_Index_For_DrillBack varchar(255)  select @DrillBack_Base_Url = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),0) select @DrillBack_Base_Url_For_FA = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),309)  select @I_iDictID = 309 select @I_iMessageNumber = 2 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 3 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Suf output  select @I_iDictID = 309 select @I_iMessageNumber = 4 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Description output  select @I_iDictID = 309 select @I_iMessageNumber = 30 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Index output  select @I_iDictID = 309 select @I_iMessageNumber = 10 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Class_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 19 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Structure_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 15 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Location_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 14 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Physical_Location_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 12 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Master_Asset_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 33 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Type output  select @I_iDictID = 309 select @I_iMessageNumber = 254 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Book_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 201 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Book_Index output  select @I_iDictID = 309 select @I_iMessageNumber = 202 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Place_in_Service_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 203 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Delete_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 204 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Depreciation_Begin_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 205 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Fully_Depreciated_Flag output  select @I_iDictID = 309 select @I_iMessageNumber = 206 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Fully_Depreciated_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 257 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Orig_Life_Years___Days output  select @I_iDictID = 309 select @I_iMessageNumber = 207 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Original_Life_Years output  select @I_iDictID = 309 select @I_iMessageNumber = 208 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Original_Life_Days output  select @I_iDictID = 309 select @I_iMessageNumber = 258 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Rem_Life_Years___Days output  select @I_iDictID = 309 select @I_iMessageNumber = 209 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Remaining_Life_Years output  select @I_iDictID = 309 select @I_iMessageNumber = 210 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Remaining_Life_Days output  select @I_iDictID = 309 select @I_iMessageNumber = 211 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Depreciated_to_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 212 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Recalc_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 213 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Recalc_Date_Fiscal_Year output  select @I_iDictID = 309 select @I_iMessageNumber = 214 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Begin_Year_Cost output  select @I_iDictID = 309 select @I_iMessageNumber = 215 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Begin_Salvage output  select @I_iDictID = 309 select @I_iMessageNumber = 216 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Begin_Reserve output  select @I_iDictID = 309 select @I_iMessageNumber = 217 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Cost_Basis output  select @I_iDictID = 309 select @I_iMessageNumber = 218 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Salvage_Value output  select @I_iDictID = 309 select @I_iMessageNumber = 219 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Depreciation_Method output  select @I_iDictID = 309 select @I_iMessageNumber = 220 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Averaging_Convention output  select @I_iDictID = 309 select @I_iMessageNumber = 221 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Switchover output  select @I_iDictID = 309 select @I_iMessageNumber = 222 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Switch_From_1_Method output  select @I_iDictID = 309 select @I_iMessageNumber = 223 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Switch_From_1_Amount output  select @I_iDictID = 309 select @I_iMessageNumber = 224 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Switch_From_1_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 225 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Daily_Depreciation_Rate output  select @I_iDictID = 309 select @I_iMessageNumber = 226 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Periodic_Depreciation_Rate output  select @I_iDictID = 309 select @I_iMessageNumber = 227 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Yearly_Depreciation_Rate output  select @I_iDictID = 309 select @I_iMessageNumber = 228 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Save_Daily_Depreciation_Rate output  select @I_iDictID = 309 select @I_iMessageNumber = 229 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Save_Periodic_Depreciation_Rate output  select @I_iDictID = 309 select @I_iMessageNumber = 230 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Save_Yearly_Depreciation_Rate output  select @I_iDictID = 309 select @I_iMessageNumber = 231 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Amortization_Code output  select @I_iDictID = 309 select @I_iMessageNumber = 232 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Amortization_Amount output  select @I_iDictID = 309 select @I_iMessageNumber = 233 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Current_Run_Depreciation_Amount output  select @I_iDictID = 309 select @I_iMessageNumber = 234 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Previous_Run_Depreciation_Amount output  select @I_iDictID = 309 select @I_iMessageNumber = 235 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @YTD_Depreciation_Amount output  select @I_iDictID = 309 select @I_iMessageNumber = 236 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @LTD_Depreciation_Amount output  select @I_iDictID = 309 select @I_iMessageNumber = 237 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Net_Book_Value output  select @I_iDictID = 309 select @I_iMessageNumber = 238 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Luxury_Automobile_Indicator output  select @I_iDictID = 309 select @I_iMessageNumber = 239 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Prorated_Retirement_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 240 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Depreciated_to_Date_Before_Retire output  select @I_iDictID = 309 select @I_iMessageNumber = 241 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Recognized_Gain_Loss output  select @I_iDictID = 309 select @I_iMessageNumber = 242 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Non_Recognized_Gain_Loss output  select @I_iDictID = 309 select @I_iMessageNumber = 243 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Straight_Line_Depr_at_Retirement output  select @I_iDictID = 309 select @I_iMessageNumber = 244 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Cost_Before_Retire_or_Delete output  select @I_iDictID = 309 select @I_iMessageNumber = 245 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Initial_Allowance_Percentage output  select @I_iDictID = 309 select @I_iMessageNumber = 246 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Initial_Allowance_Amount output  select @I_iDictID = 309 select @I_iMessageNumber = 248 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Date_Added output  select @I_iDictID = 309 select @I_iMessageNumber = 247 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Note_Index output  select @I_iDictID = 309 select @I_iMessageNumber = 249 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Maintained_Date output  select @I_iDictID = 309 select @I_iMessageNumber = 250 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Maintained_Time output  select @I_iDictID = 309 select @I_iMessageNumber = 251 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Maintained_User_ID output  select @I_iDictID = 309 select @I_iMessageNumber = 259 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Special_Depreciation_Allowance output  select @I_iDictID = 309 select @I_iMessageNumber = 260 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Special_Depreciation_Allowance_Percentage output  select @I_iDictID = 309 select @I_iMessageNumber = 261 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Special_Depreciation_Allowance_Amount output   select @I_iDictID = 309 select @I_iMessageNumber = 30 select @I_iAliasMessageNumber = 22617 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Asset_Index_For_DrillBack output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[FixedAssetsBooks]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[FixedAssetsBooks] '  select @sqldefaultstring =   'CREATE VIEW FixedAssetsBooks AS ' +   'select ' +   'rtrim([''Asset General Information Master''].[ASSETID]) as ''' + @Asset_ID + ''', ' + '[''Asset General Information Master''].[ASSETIDSUF] as ''' + @Suf + ''', ' + 'rtrim([''Asset General Information Master''].[ASSETDESC]) as ''' + @Asset_Description + ''', ' + 'rtrim([''Book Setup''].[BOOKID]) as ''' + @Book_ID + ''', ' + '[''Asset Book Master''].[PLINSERVDATE] as ''' + @Place_in_Service_Date + ''', ' + '[''Asset Book Master''].[NETBOOKVALUE] as ''' + @Net_Book_Value + ''', '   select @sqlstring1 =   '[''Asset Book Master''].[AMORTIZATIONAMOUNT] as ''' + @Amortization_Amount + ''', ' +  '''' + @Amortization_Code + ''' = dbo.FA_FUNC_Amortization_Code([''Asset Book Master''].[AMORTIZATIONCODE]), ' +  'rtrim([''Asset General Information Master''].[ASSETCLASSID]) as ''' + @Asset_Class_ID + ''', ' +  '[''Asset Book Master''].[ASSETINDEX] as ''' + @Asset_Index + ''', ' +  '''' + @Asset_Type + ''' = dbo.FA_FUNC_Asset_Type([''Asset General Information Master''].[ASSETTYPE]), ' +  '''' + @Averaging_Convention + ''' = dbo.FA_FUNC_Averaging_Convention([''Asset Book Master''].[AVERAGINGCONV]), ' +  '[''Asset Book Master''].[BEGINRESERVE] as ''' + @Begin_Reserve + ''', ' +  '[''Asset Book Master''].[BAGINSALVAGE] as ''' + @Begin_Salvage + ''', ' +  '[''Asset Book Master''].[BEGINYEARCOST] as ''' + @Begin_Year_Cost + ''', ' +  '[''Asset Book Master''].[BOOKINDX] as ''' + @Book_Index + ''', ' +  '[''Asset Book Master''].[COSTBASIS] as ''' + @Cost_Basis + ''', ' +  '[''Asset Book Master''].[COSTBFRETORDEL] as ''' + @Cost_Before_Retire_or_Delete + ''', ' +  '[''Asset Book Master''].[CURRUNDEPRAMT] as ''' + @Current_Run_Depreciation_Amount + ''', ' +  '[''Asset Book Master''].[DLYDEPRRATE] as ''' + @Daily_Depreciation_Rate + ''', ' +  '[''Asset Book Master''].[DATEADDED] as ''' + @Date_Added + ''', ' +  '[''Asset Book Master''].[DELETEDATE] as ''' + @Delete_Date + ''', ' +  '[''Asset Book Master''].[DEPRTODATE] as ''' + @Depreciated_to_Date + ''', ' +  '[''Asset Book Master''].[DEPRTODATEBFRET] as ''' + @Depreciated_to_Date_Before_Retire + ''', ' +  '[''Asset Book Master''].[DEPRBEGDATE] as ''' + @Depreciation_Begin_Date + ''', ' +  '''' + @Depreciation_Method + ''' = dbo.FA_FUNC_Depreciation_Method([''Asset Book Master''].[DEPRECIATIONMETHOD]), ' +  '[''Asset Book Master''].[FULLYDEPRDATE] as ''' + @Fully_Depreciated_Date + ''', ' +  'rtrim([''Asset Book Master''].[FULLYDEPRFLAG]) as ''' + @Fully_Depreciated_Flag + ''', ' +  '[''Asset Book Master''].[Initial_Allowance_Amount] as ''' + @Initial_Allowance_Amount + ''', ' +  '[''Asset Book Master''].[Initial_Allowance_Perc]/100.00 as ''' + @Initial_Allowance_Percentage + ''', ' +  '[''Asset Book Master''].[LTDDEPRAMT] as ''' + @LTD_Depreciation_Amount + ''', ' +  '[''Asset Book Master''].[LASTMNTDDATE] as ''' + @Last_Maintained_Date + ''', ' +  '[''Asset Book Master''].[LASTMNTDTIME] as ''' + @Last_Maintained_Time + ''', ' +  'rtrim([''Asset Book Master''].[LASTMNTDUSERID]) as ''' + @Last_Maintained_User_ID + ''', ' +  '[''Asset Book Master''].[LASTRECALCDATE] as ''' + @Last_Recalc_Date + ''', ' +  '[''Asset Book Master''].[LASTRECALCDATEFISYR] as ''' + @Last_Recalc_Date_Fiscal_Year + ''', ' +  'rtrim([''Asset General Information Master''].[LOCATNID]) as ''' + @Location_ID + ''', ' +  '''' + @Luxury_Automobile_Indicator + ''' = dbo.FA_FUNC_Luxury_Automobile_Indicator([''Asset Book Master''].[LUXAUTOIND]), ' +  'rtrim([''Asset General Information Master''].[Master_Asset_ID]) as ''' + @Master_Asset_ID + ''', ' +  '[''Asset Book Master''].[NONRECGAINLOSS] as ''' + @Non_Recognized_Gain_Loss + ''', ' +  '[''Asset Book Master''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  'rtrim([''Asset Book Master''].[ORIGINALLIFEYEARS]) +  '' - '' + rtrim([''Asset Book Master''].[ORIGINALLIFEDAYS]) as ''' + @Orig_Life_Years___Days + ''', ' +  '[''Asset Book Master''].[ORIGINALLIFEDAYS] as ''' + @Original_Life_Days + ''', ' +  '[''Asset Book Master''].[ORIGINALLIFEYEARS] as ''' + @Original_Life_Years + ''', ' +  '[''Asset Book Master''].[PERDEPRRATE] as ''' + @Periodic_Depreciation_Rate + ''', ' +  'rtrim([''Asset General Information Master''].[Physical_Location_ID]) as ''' + @Physical_Location_ID + ''', ' +  '[''Asset Book Master''].[PREVRUNDEPRAMT] as ''' + @Previous_Run_Depreciation_Amount + ''', ' +  '[''Asset Book Master''].[PRORATEDRETDATE] as ''' + @Prorated_Retirement_Date + ''', ' +  '[''Asset Book Master''].[RECGAINLOSS] as ''' + @Recognized_Gain_Loss + ''', ' +  'rtrim([''Asset Book Master''].[REMAININGLIFEYEARS]) +  '' - '' + rtrim([''Asset Book Master''].[REMAININGLIFEDAYS]) as ''' + @Rem_Life_Years___Days + ''', ' +  '[''Asset Book Master''].[REMAININGLIFEDAYS] as ''' + @Remaining_Life_Days + ''', ' +  '[''Asset Book Master''].[REMAININGLIFEYEARS] as ''' + @Remaining_Life_Years + ''', ' +  '[''Asset Book Master''].[SALVAGEVALUE] as ''' + @Salvage_Value + ''', ' +  '[''Asset Book Master''].[SAVEDLYDEPRRATE] as ''' + @Save_Daily_Depreciation_Rate + ''', ' +  '[''Asset Book Master''].[SAVEPERDEPRRATE] as ''' + @Save_Periodic_Depreciation_Rate + ''', ' +  '[''Asset Book Master''].[SAVEYRLYDEPRRATE] as ''' + @Save_Yearly_Depreciation_Rate + ''', ' +  '''' + @Special_Depreciation_Allowance + ''' = dbo.DYN_FUNC_Boolean_All([''Asset Book Master''].[SPECDEPRALLOW]-1), ' +  '[''Asset Book Master''].[SPECDEPRALLOWAMT] as ''' + @Special_Depreciation_Allowance_Amount + ''', ' +  '[''Asset Book Master''].[SPECDEPRALLOWPCT]/100.00 as ''' + @Special_Depreciation_Allowance_Percentage + ''', ' +  '[''Asset Book Master''].[STLINEDEPRATRET] as ''' + @Straight_Line_Depr_at_Retirement + ''', ' +  'rtrim([''Asset General Information Master''].[STRUCTUREID]) as ''' + @Structure_ID + ''', ' +  '[''Asset Book Master''].[SWITCHFM1AMOUNT] as ''' + @Switch_From_1_Amount + ''', ' +  '[''Asset Book Master''].[SWITCHFM1DATE] as ''' + @Switch_From_1_Date + ''', ' +  '''' + @Switch_From_1_Method + ''' = dbo.FA_FUNC_Switch_From_1_Method([''Asset Book Master''].[SWITCHFM1METHOD]), ' +  '''' + @Switchover + ''' = dbo.FA_FUNC_Switchover([''Asset Book Master''].[SWITCHOVER]), ' +  '[''Asset Book Master''].[YTDDEPRAMT] as ''' + @YTD_Depreciation_Amount + ''', ' +  '[''Asset Book Master''].[YRLYDEPRRATE] as ''' + @Yearly_Depreciation_Rate + ''', '   select @sqlstring2 =  '''' + @Asset_Index_For_DrillBack + ''' = ''' + @DrillBack_Base_Url_For_FA + ''' +dbo.dgppAssetIndex(1,[''Asset Book Master''].[ASSETINDEX] ) '  select @sqljoinstring =   'from [FA00200] as [''Asset Book Master''] with (NOLOCK) '   + 'left outer join [FA00100] as [''Asset General Information Master''] with (NOLOCK) on '   + '[''Asset Book Master''].[ASSETINDEX] = [''Asset General Information Master''].[ASSETINDEX] '   + 'left outer join [FA40200] as [''Book Setup''] with (NOLOCK) on '   + '[''Asset Book Master''].[BOOKINDX] = [''Book Setup''].[BOOKINDX] '   select @sqlaccessstring =   'GRANT SELECT ON [dbo].[FixedAssetsBooks] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[FixedAssetsBooks] TO [rpt_accounting manager]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_FixedAssets_FixedAssetsBooks] TO [DYNGRP]
GO
