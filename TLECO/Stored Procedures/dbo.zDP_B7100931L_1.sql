SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE PROC [dbo].[zDP_B7100931L_1] (@BSSI_Or_Company_ID_RS char(5), @CURNCYID_RS char(15), @INTERID_RS char(5), @ACTNUMST_RS char(129), @USERID_RS char(15), @BSSI_Or_Company_ID_RE char(5), @CURNCYID_RE char(15), @INTERID_RE char(5), @ACTNUMST_RE char(129), @USERID_RE char(15)) AS /* 12.00.0270.000 */ set nocount on IF @BSSI_Or_Company_ID_RS IS NULL BEGIN SELECT TOP 25  BSSI_Or_Company_ID, ACTNUMST, INTERID, BSSI_DefAccountNumberStr, DOCAMNT, USERID, BSSI_ScheduleBasedOnDate, BSSI_DeferralStartDate, BSSI_DeferralEndDate, BSSI_Recog_Frequency, BSSI_RecogAcctNumberStri, EXCHDATE, CURNCYID, BSSI_Recog_TemplateID, DEX_ROW_ID FROM .B7100931 ORDER BY BSSI_Or_Company_ID DESC, CURNCYID DESC, INTERID DESC, ACTNUMST DESC, USERID DESC, DEX_ROW_ID DESC END ELSE IF @BSSI_Or_Company_ID_RS = @BSSI_Or_Company_ID_RE BEGIN SELECT TOP 25  BSSI_Or_Company_ID, ACTNUMST, INTERID, BSSI_DefAccountNumberStr, DOCAMNT, USERID, BSSI_ScheduleBasedOnDate, BSSI_DeferralStartDate, BSSI_DeferralEndDate, BSSI_Recog_Frequency, BSSI_RecogAcctNumberStri, EXCHDATE, CURNCYID, BSSI_Recog_TemplateID, DEX_ROW_ID FROM .B7100931 WHERE BSSI_Or_Company_ID = @BSSI_Or_Company_ID_RS AND CURNCYID BETWEEN @CURNCYID_RS AND @CURNCYID_RE AND INTERID BETWEEN @INTERID_RS AND @INTERID_RE AND ACTNUMST BETWEEN @ACTNUMST_RS AND @ACTNUMST_RE AND USERID BETWEEN @USERID_RS AND @USERID_RE ORDER BY BSSI_Or_Company_ID DESC, CURNCYID DESC, INTERID DESC, ACTNUMST DESC, USERID DESC, DEX_ROW_ID DESC END ELSE BEGIN SELECT TOP 25  BSSI_Or_Company_ID, ACTNUMST, INTERID, BSSI_DefAccountNumberStr, DOCAMNT, USERID, BSSI_ScheduleBasedOnDate, BSSI_DeferralStartDate, BSSI_DeferralEndDate, BSSI_Recog_Frequency, BSSI_RecogAcctNumberStri, EXCHDATE, CURNCYID, BSSI_Recog_TemplateID, DEX_ROW_ID FROM .B7100931 WHERE BSSI_Or_Company_ID BETWEEN @BSSI_Or_Company_ID_RS AND @BSSI_Or_Company_ID_RE AND CURNCYID BETWEEN @CURNCYID_RS AND @CURNCYID_RE AND INTERID BETWEEN @INTERID_RS AND @INTERID_RE AND ACTNUMST BETWEEN @ACTNUMST_RS AND @ACTNUMST_RE AND USERID BETWEEN @USERID_RS AND @USERID_RE ORDER BY BSSI_Or_Company_ID DESC, CURNCYID DESC, INTERID DESC, ACTNUMST DESC, USERID DESC, DEX_ROW_ID DESC END set nocount off 
GO
GRANT EXECUTE ON  [dbo].[zDP_B7100931L_1] TO [DYNGRP]
GO
