SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_VAT10001F_3] (@ECFLAG_RS tinyint, @CCode_RS char(7), @ECFLAG_RE tinyint, @CCode_RE char(7)) AS  set nocount on IF @ECFLAG_RS IS NULL BEGIN SELECT TOP 25  CCode, CCodeDesc, ECFLAG, ISOCode, NOTEINDX, DEX_ROW_ID FROM .VAT10001 ORDER BY ECFLAG ASC, CCode ASC END ELSE IF @ECFLAG_RS = @ECFLAG_RE BEGIN SELECT TOP 25  CCode, CCodeDesc, ECFLAG, ISOCode, NOTEINDX, DEX_ROW_ID FROM .VAT10001 WHERE ECFLAG = @ECFLAG_RS AND CCode BETWEEN @CCode_RS AND @CCode_RE ORDER BY ECFLAG ASC, CCode ASC END ELSE BEGIN SELECT TOP 25  CCode, CCodeDesc, ECFLAG, ISOCode, NOTEINDX, DEX_ROW_ID FROM .VAT10001 WHERE ECFLAG BETWEEN @ECFLAG_RS AND @ECFLAG_RE AND CCode BETWEEN @CCode_RS AND @CCode_RE ORDER BY ECFLAG ASC, CCode ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_VAT10001F_3] TO [DYNGRP]
GO
