SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[seeVendorInformation]   @VENDORIDSTRT char(15) = '',     @VENDORIDEND char(15) = ''  as set nocount on If (@VENDORIDSTRT is NULL or @VENDORIDSTRT = '')  Begin   set @VENDORIDSTRT = ''  End  If (@VENDORIDEND is NULL or @VENDORIDEND = '')  Begin   set @VENDORIDEND = 'þþþþþþþþþþþþþþþ'  End   If OBJECT_ID('tempdb..#VenEmail') IS NULL      Begin        CREATE TABLE [dbo].[#VenEmail] (   EmailCardID char(25),   SelectDocumentOptions char(50),   AllowMultipleAtt char(11),   EmailSetFileSize char(11),   EmailMaxFileSize numeric (19,5),   POSendFormsAsEmail char (31),   RemSendFormsAsEmail char (31),   EmailMessageIDPO char (25),   EmailMessageIDREM char (25),   EmailDocumentFormatPO char(21),   EmailDocumentFormatREM char (21))  End DELETE #VenEmail  INSERT INTO #VenEmail (EmailCardID, SelectDocumentOptions, AllowMultipleAtt, EmailSetFileSize, EmailMaxFileSize)  SELECT  EmailCardID,   case when EmailAllowEmbedding = 0 then 'Send Documents as Attachments' else 'Embed Document in Message Body' end,  case when AllowMultipleAtt = 0 then 'No' when AllowMultipleAtt = 1 then 'Yes' else 'None' end,  case when EmailSetFileSize = 0 then 'No' when EmailSetFileSize = 1 then 'Yes' else 'None' end,  EmailMaxFileSize FROM SY04904 WHERE EmailSeriesID = 4 and  EmailCardID between @VENDORIDSTRT and @VENDORIDEND UPDATE a  SET a.POSendFormsAsEmail = 'Purchase Order',      a.EmailMessageIDPO = b.EmailMessageID,      a.EmailDocumentFormatPO = (case when b.EmailDocumentFormat = 1 then 'DOCX'           when b.EmailDocumentFormat = 2 then 'HTML'           when b.EmailDocumentFormat = 3 then 'PDF'           when b.EmailDocumentFormat = 4 then 'XPS' else '' end) FROM #VenEmail a join SY04905 b on   a.EmailCardID = b.EmailCardID WHERE b.MODULE1 = 12 and   b.EmailSeriesID = 4 UPDATE a  SET a.RemSendFormsAsEmail = 'Vendor Remittance',      a.EmailMessageIDREM = b.EmailMessageID,      a.EmailDocumentFormatREM = (case when b.EmailDocumentFormat = 1 then 'DOCX'           when b.EmailDocumentFormat = 2 then 'HTML'           when b.EmailDocumentFormat = 3 then 'PDF'           when b.EmailDocumentFormat = 4 then 'XPS' else '' end) FROM #VenEmail a  join SY04905 b on   a.EmailCardID = b.EmailCardID  WHERE b.MODULE1 = 19 and   b.EmailSeriesID = 4   select  a.[Vendor ID], a.[Vendor Name], a.[Address 1], a.[Address 2], a.[City], a.[State], a.[Zip Code], a.[Phone Number 1], a.[1099 Amount LIFE], a.[1099 Amount LYR], a.[1099 Amount YTD], a.[1099 Type], a.[Account Number With Vendor], a.[Accounts Payable Account Number], a.[Accrued Purchases Account Number], a.[Address 3], a.[Amount Billed LIFE], a.[Amount Billed LYR], a.[Amount Billed YTD], a.[Amount Paid LIFE], a.[Amount Paid LYR], a.[Amount Paid YTD], a.[Average Days To Pay - Life], a.[Average Days To Pay - Year], a.[Cash Account Number], a.[Certificate Commencing Date], a.[Certificate Expiration Date], a.[Checkbook ID], a.[Comment1], a.[Comment2], a.[Country], a.[Created Date], a.[Credit Limit], a.[Credit Limit Dollar], a.[Currency ID], a.[Current Balance], a.[Current Unapplied Payment Balance], a.[Customer Number], a.[Days Checks To Clear], a.[Deduction Exemption/Variation Number], a.[Discount Available Account Number], a.[Discount Available LIFE], a.[Discount Available LYR], a.[Discount Available YTD], a.[Discount Grace Period], a.[Discount Lost LIFE], a.[Discount Lost LYR], a.[Discount Lost YTD], a.[Discount Taken Account Number], a.[Discount Taken LIFE], a.[Discount Taken LYR], a.[Discount Taken YTD], a.[Document Format ID], a.[Due Date Grace Period], a.[Expiration Date Obligation], a.[Fax Number], a.[Finance Charge Account Number], a.[Finance Charge LIFE], a.[Finance Charge LYR], a.[Finance Charge YTD], a.[First Purchase Date], a.[Free On Board], a.[Freight Account Number], a.[Governmental Corporate ID], a.[Governmental Individual ID], a.[Highest Balance], a.[Hold], a.[Keep Calendar History], a.[Keep GL Dist History], a.[Keep Period History], a.[Keep Trx History], a.[Last Check Amount], a.[Last Check Date], a.[Last Check Number], a.[Last Invoice Amount], a.[Last Invoice Number], a.[Last Purchase Date], a.[Maximum Invoice Amount For Vendors], a.[Maximum Invoice Dollar], a.[Maximum Write Off Amount], a.[Minimum Order], a.[Minimum Payment Dollar], a.[Minimum Payment Percent], a.[Minimum Payment Type], a.[Misc Charges Account Number], a.[Modified Date], a.[Note Index], a.[Number of Finance Charges LIFE], a.[Number of Finance Charges LYR], a.[Number of Finance Charges YTD], a.[Number of Invoices LIFE], a.[Number of Invoices LYR], a.[Number of Invoices YTD], a.[Number of Paid Invoices LIFE], a.[Number of Paid Invoices YTD], a.[On Order Amount], a.[PPS Tax Rate], a.[Parent Vendor ID], a.[Payment Priority], a.[Payment Terms ID], a.[Phone 3], a.[Phone Number 2], a.[Post Results To], a.[Post To Cash Account From], a.[Prescribed Payee], a.[Purchase Price Variance Account Number], a.[Purchases Account Number], a.[Rate Type ID], a.[Reporting Obligation Undertaken], a.[Retainage Account Number], a.[Retainage Owed], a.[Returns LIFE], a.[Returns LYR], a.[Returns YTD], a.[Revalue Vendor], a.[Shipping Method], a.[Subject To PPS Deductions], a.[Tax Account Number], a.[Tax ID Number], a.[Tax Invoice Received], a.[Tax Registration Number], a.[Tax Schedule ID], a.[Trade Discount], a.[Trade Discount Account Number], a.[Trade Discounts Taken LIFE], a.[Trade Discounts Taken LYR], a.[Trade Discounts Taken YTD], a.[UPS Zone], a.[Unpaid Finance Charges], a.[User Defined 1], a.[User Defined 2], a.[Vendor Address Code - Primary], a.[Vendor Address Code - Purchase Address], a.[Vendor Address Code - Remit To], a.[Vendor Address Code - Ship From], a.[Vendor Check Name], a.[Vendor Class ID], a.[Vendor Contact], a.[Vendor Short Name], a.[Vendor Status], a.[Withholding LIFE], a.[Withholding LYR], a.[Withholding YTD], a.[Write Offs Account Number], a.[Write Offs LIFE], a.[Write Offs LYR], a.[Write Offs YTD], a.[Writeoff], a.[1099 Box],  (select USERLANG from PM00200 where VENDORID = a.[Vendor ID]) as [Language],   isnull(b.EmailToAddress,'') as EmailToAddress,   isnull(b.EmailCcAddress,'') as EmailCcAddress,   isnull(b.EmailBccAddress,'') as EmailBccAddress,   c.SelectDocumentOptions,   c.AllowMultipleAtt,   c.EmailSetFileSize,   c.EmailMaxFileSize,   c.POSendFormsAsEmail,   c.RemSendFormsAsEmail,   c.EmailMessageIDPO,   c.EmailMessageIDREM,   c.EmailDocumentFormatPO,   c.EmailDocumentFormatREM,   isnull(d.[Cash Account],'') as [Cash Account From Checkbook]  from Vendors a  left join SY01200 b on   a.[Vendor ID] = b.Master_ID and   a.[Vendor Address Code - Primary] = b.ADRSCODE  left join #VenEmail c on   a.[Vendor ID] = c.EmailCardID  left join (select a.CHEKBKID, rtrim(b.ACTNUMST) as [Cash Account] from CM00100 a join (select * from GL00105) b on a.ACTINDX = b.ACTINDX) d on   a.[Checkbook ID] = d.CHEKBKID  where a.[Vendor ID] between @VENDORIDSTRT and @VENDORIDEND   
GO
GRANT EXECUTE ON  [dbo].[seeVendorInformation] TO [DYNGRP]
GO
GRANT EXECUTE ON  [dbo].[seeVendorInformation] TO [rpt_accounting manager]
GO
GRANT EXECUTE ON  [dbo].[seeVendorInformation] TO [rpt_accounts payable coordinator]
GO
GRANT EXECUTE ON  [dbo].[seeVendorInformation] TO [rpt_bookkeeper]
GO
GRANT EXECUTE ON  [dbo].[seeVendorInformation] TO [rpt_certified accountant]
GO
GRANT EXECUTE ON  [dbo].[seeVendorInformation] TO [rpt_executive]
GO
GRANT EXECUTE ON  [dbo].[seeVendorInformation] TO [rpt_purchasing manager]
GO
