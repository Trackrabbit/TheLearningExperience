SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE PROC [dbo].[zDP_B0510050UN_15] (@BS int, @VENDORID char(15), @MJW_Investment_Number char(21), @VENDORID_RS char(15), @MJW_Investment_Number_RS char(21), @VENDORID_RE char(15), @MJW_Investment_Number_RE char(21)) AS /* 12.00.0270.000 */ set nocount on IF @VENDORID_RS IS NULL BEGIN SELECT TOP 25  MJW_Investment_Number, MJW_Source, BSSI_Investment_Ref, MJW_Offering_ID, MJW_Series_ID, MJW_Accept_Date, MJW_Admit_Date, IMS_Commission_Paid_Date, VENDORID, MJW_Owner_Type_Code, MJW_Certificate_Number, MJW_Cancellation_Date, MJW_Closing_Date, MJW_Death_Date, BSSI_InvestPercent, MJW_Units_Purchased, MJW_Unit_Price, MJW_Units_Sold, MJW_Original_Capital, MJW_Return_Capital, MJW_Transfer_Date, MJW_Transfer_Number, MJW_Redemption_Number, SLPRSNID, IMS_Broker_ID, IMS_With_Holding_Account_1, IMS_With_Holding_Account_2, IMS_With_Holding_Account_3, IMS_With_Holding_Account_4, MJW_Adjusted_Capital, BSSI_Reinvest_CB, BSSI_Facility_ID, NOTEINDX, CURNCYID, CURRNIDX, BSSI_InvestCategoryID, BSSI_InvestmentType, BSSI_InvestBearing, BSSI_AccrualsAcctIdx, REALGAIN, REALLOSS, UNRLGAIN, UNRLLOSS, OFFINDX, BSSI_LastRevaluationAmou, SCHEDULE_INT_TYPE1, SCHEDULE_NUMBER, REC_ACCT_IDX, INT_INCOME_ACCT_IDX, ORIG_DOC_NUMBER, REC_OFFSET_ACCT_IDX, PAY_ACCT_IDX, PAY_OFFSET_ACCT_IDX, INT_EXP_ACCT_IDX, RMDNUMWK, VCHNUMWK, BSSI_IntrIncAccrAcctIdx, BSSI_IntrExpAccrAcctIdx, BSSI_AccrdIntrIncAcctIdx, BSSI_AccrdIntrExpAcctIdx, BSSI_Investor_AP_Number, BSSI_Investor_AR_Number, BSSI_InvestOrFund, DEX_ROW_ID FROM .B0510050 WHERE ( VENDORID = @VENDORID AND MJW_Investment_Number > @MJW_Investment_Number OR VENDORID > @VENDORID ) ORDER BY VENDORID ASC, MJW_Investment_Number ASC, DEX_ROW_ID ASC END ELSE IF @VENDORID_RS = @VENDORID_RE BEGIN SELECT TOP 25  MJW_Investment_Number, MJW_Source, BSSI_Investment_Ref, MJW_Offering_ID, MJW_Series_ID, MJW_Accept_Date, MJW_Admit_Date, IMS_Commission_Paid_Date, VENDORID, MJW_Owner_Type_Code, MJW_Certificate_Number, MJW_Cancellation_Date, MJW_Closing_Date, MJW_Death_Date, BSSI_InvestPercent, MJW_Units_Purchased, MJW_Unit_Price, MJW_Units_Sold, MJW_Original_Capital, MJW_Return_Capital, MJW_Transfer_Date, MJW_Transfer_Number, MJW_Redemption_Number, SLPRSNID, IMS_Broker_ID, IMS_With_Holding_Account_1, IMS_With_Holding_Account_2, IMS_With_Holding_Account_3, IMS_With_Holding_Account_4, MJW_Adjusted_Capital, BSSI_Reinvest_CB, BSSI_Facility_ID, NOTEINDX, CURNCYID, CURRNIDX, BSSI_InvestCategoryID, BSSI_InvestmentType, BSSI_InvestBearing, BSSI_AccrualsAcctIdx, REALGAIN, REALLOSS, UNRLGAIN, UNRLLOSS, OFFINDX, BSSI_LastRevaluationAmou, SCHEDULE_INT_TYPE1, SCHEDULE_NUMBER, REC_ACCT_IDX, INT_INCOME_ACCT_IDX, ORIG_DOC_NUMBER, REC_OFFSET_ACCT_IDX, PAY_ACCT_IDX, PAY_OFFSET_ACCT_IDX, INT_EXP_ACCT_IDX, RMDNUMWK, VCHNUMWK, BSSI_IntrIncAccrAcctIdx, BSSI_IntrExpAccrAcctIdx, BSSI_AccrdIntrIncAcctIdx, BSSI_AccrdIntrExpAcctIdx, BSSI_Investor_AP_Number, BSSI_Investor_AR_Number, BSSI_InvestOrFund, DEX_ROW_ID FROM .B0510050 WHERE VENDORID = @VENDORID_RS AND MJW_Investment_Number BETWEEN @MJW_Investment_Number_RS AND @MJW_Investment_Number_RE AND ( VENDORID = @VENDORID AND MJW_Investment_Number > @MJW_Investment_Number OR VENDORID > @VENDORID ) ORDER BY VENDORID ASC, MJW_Investment_Number ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  MJW_Investment_Number, MJW_Source, BSSI_Investment_Ref, MJW_Offering_ID, MJW_Series_ID, MJW_Accept_Date, MJW_Admit_Date, IMS_Commission_Paid_Date, VENDORID, MJW_Owner_Type_Code, MJW_Certificate_Number, MJW_Cancellation_Date, MJW_Closing_Date, MJW_Death_Date, BSSI_InvestPercent, MJW_Units_Purchased, MJW_Unit_Price, MJW_Units_Sold, MJW_Original_Capital, MJW_Return_Capital, MJW_Transfer_Date, MJW_Transfer_Number, MJW_Redemption_Number, SLPRSNID, IMS_Broker_ID, IMS_With_Holding_Account_1, IMS_With_Holding_Account_2, IMS_With_Holding_Account_3, IMS_With_Holding_Account_4, MJW_Adjusted_Capital, BSSI_Reinvest_CB, BSSI_Facility_ID, NOTEINDX, CURNCYID, CURRNIDX, BSSI_InvestCategoryID, BSSI_InvestmentType, BSSI_InvestBearing, BSSI_AccrualsAcctIdx, REALGAIN, REALLOSS, UNRLGAIN, UNRLLOSS, OFFINDX, BSSI_LastRevaluationAmou, SCHEDULE_INT_TYPE1, SCHEDULE_NUMBER, REC_ACCT_IDX, INT_INCOME_ACCT_IDX, ORIG_DOC_NUMBER, REC_OFFSET_ACCT_IDX, PAY_ACCT_IDX, PAY_OFFSET_ACCT_IDX, INT_EXP_ACCT_IDX, RMDNUMWK, VCHNUMWK, BSSI_IntrIncAccrAcctIdx, BSSI_IntrExpAccrAcctIdx, BSSI_AccrdIntrIncAcctIdx, BSSI_AccrdIntrExpAcctIdx, BSSI_Investor_AP_Number, BSSI_Investor_AR_Number, BSSI_InvestOrFund, DEX_ROW_ID FROM .B0510050 WHERE VENDORID BETWEEN @VENDORID_RS AND @VENDORID_RE AND MJW_Investment_Number BETWEEN @MJW_Investment_Number_RS AND @MJW_Investment_Number_RE AND ( VENDORID = @VENDORID AND MJW_Investment_Number > @MJW_Investment_Number OR VENDORID > @VENDORID ) ORDER BY VENDORID ASC, MJW_Investment_Number ASC, DEX_ROW_ID ASC END set nocount off 
GO
GRANT EXECUTE ON  [dbo].[zDP_B0510050UN_15] TO [DYNGRP]
GO
