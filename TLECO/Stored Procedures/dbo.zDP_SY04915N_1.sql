SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SY04915N_1] (@BS int, @DICTRYID smallint, @MODULE1 smallint, @DOCTYPE smallint, @DOCNUMBR char(21), @SEQNUMBR int, @USERID char(15), @DATE1 datetime, @TIME1 datetime, @DICTRYID_RS smallint, @MODULE1_RS smallint, @DOCTYPE_RS smallint, @DOCNUMBR_RS char(21), @SEQNUMBR_RS int, @USERID_RS char(15), @DATE1_RS datetime, @TIME1_RS datetime, @DICTRYID_RE smallint, @MODULE1_RE smallint, @DOCTYPE_RE smallint, @DOCNUMBR_RE char(21), @SEQNUMBR_RE int, @USERID_RE char(15), @DATE1_RE datetime, @TIME1_RE datetime) AS  set nocount on IF @DICTRYID_RS IS NULL BEGIN SELECT TOP 25  USERID, MODULE1, DOCTYPE, DOCNUMBR, DATE1, TIME1, EmailMessageFrom, EmailSubject, Master_ID, DICTRYID, SEQNUMBR, EmailFromAddress, EmailMessageID, DOCDATE, DEX_ROW_ID, EmailReplyToAddress, EmailToAddress, EmailCcAddress, EmailBccAddress, EmailBody FROM .SY04915 WHERE ( DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND SEQNUMBR = @SEQNUMBR AND USERID = @USERID AND DATE1 = @DATE1 AND TIME1 > @TIME1 OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND SEQNUMBR = @SEQNUMBR AND USERID = @USERID AND DATE1 > @DATE1 OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND SEQNUMBR = @SEQNUMBR AND USERID > @USERID OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND SEQNUMBR > @SEQNUMBR OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR > @DOCNUMBR OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE > @DOCTYPE OR DICTRYID = @DICTRYID AND MODULE1 > @MODULE1 OR DICTRYID > @DICTRYID ) ORDER BY DICTRYID ASC, MODULE1 ASC, DOCTYPE ASC, DOCNUMBR ASC, SEQNUMBR ASC, USERID ASC, DATE1 ASC, TIME1 ASC END ELSE IF @DICTRYID_RS = @DICTRYID_RE BEGIN SELECT TOP 25  USERID, MODULE1, DOCTYPE, DOCNUMBR, DATE1, TIME1, EmailMessageFrom, EmailSubject, Master_ID, DICTRYID, SEQNUMBR, EmailFromAddress, EmailMessageID, DOCDATE, DEX_ROW_ID, EmailReplyToAddress, EmailToAddress, EmailCcAddress, EmailBccAddress, EmailBody FROM .SY04915 WHERE DICTRYID = @DICTRYID_RS AND MODULE1 BETWEEN @MODULE1_RS AND @MODULE1_RE AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND DOCNUMBR BETWEEN @DOCNUMBR_RS AND @DOCNUMBR_RE AND SEQNUMBR BETWEEN @SEQNUMBR_RS AND @SEQNUMBR_RE AND USERID BETWEEN @USERID_RS AND @USERID_RE AND DATE1 BETWEEN @DATE1_RS AND @DATE1_RE AND TIME1 BETWEEN @TIME1_RS AND @TIME1_RE AND ( DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND SEQNUMBR = @SEQNUMBR AND USERID = @USERID AND DATE1 = @DATE1 AND TIME1 > @TIME1 OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND SEQNUMBR = @SEQNUMBR AND USERID = @USERID AND DATE1 > @DATE1 OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND SEQNUMBR = @SEQNUMBR AND USERID > @USERID OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND SEQNUMBR > @SEQNUMBR OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR > @DOCNUMBR OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE > @DOCTYPE OR DICTRYID = @DICTRYID AND MODULE1 > @MODULE1 OR DICTRYID > @DICTRYID ) ORDER BY DICTRYID ASC, MODULE1 ASC, DOCTYPE ASC, DOCNUMBR ASC, SEQNUMBR ASC, USERID ASC, DATE1 ASC, TIME1 ASC END ELSE BEGIN SELECT TOP 25  USERID, MODULE1, DOCTYPE, DOCNUMBR, DATE1, TIME1, EmailMessageFrom, EmailSubject, Master_ID, DICTRYID, SEQNUMBR, EmailFromAddress, EmailMessageID, DOCDATE, DEX_ROW_ID, EmailReplyToAddress, EmailToAddress, EmailCcAddress, EmailBccAddress, EmailBody FROM .SY04915 WHERE DICTRYID BETWEEN @DICTRYID_RS AND @DICTRYID_RE AND MODULE1 BETWEEN @MODULE1_RS AND @MODULE1_RE AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND DOCNUMBR BETWEEN @DOCNUMBR_RS AND @DOCNUMBR_RE AND SEQNUMBR BETWEEN @SEQNUMBR_RS AND @SEQNUMBR_RE AND USERID BETWEEN @USERID_RS AND @USERID_RE AND DATE1 BETWEEN @DATE1_RS AND @DATE1_RE AND TIME1 BETWEEN @TIME1_RS AND @TIME1_RE AND ( DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND SEQNUMBR = @SEQNUMBR AND USERID = @USERID AND DATE1 = @DATE1 AND TIME1 > @TIME1 OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND SEQNUMBR = @SEQNUMBR AND USERID = @USERID AND DATE1 > @DATE1 OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND SEQNUMBR = @SEQNUMBR AND USERID > @USERID OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR = @DOCNUMBR AND SEQNUMBR > @SEQNUMBR OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR > @DOCNUMBR OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE > @DOCTYPE OR DICTRYID = @DICTRYID AND MODULE1 > @MODULE1 OR DICTRYID > @DICTRYID ) ORDER BY DICTRYID ASC, MODULE1 ASC, DOCTYPE ASC, DOCNUMBR ASC, SEQNUMBR ASC, USERID ASC, DATE1 ASC, TIME1 ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY04915N_1] TO [DYNGRP]
GO
