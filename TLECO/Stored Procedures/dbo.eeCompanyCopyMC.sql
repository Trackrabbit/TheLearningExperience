SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyMC] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255) select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '' if (@I_vData = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..MC00200' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..MC00200 ( [ACTINDX],[CURNCYID],[REVALUE],[REVLUHOW],[Post_Results_To],[CurrencyTranslationType] ) select [ACTINDX],[CURNCYID],[REVALUE],[REVLUHOW],[Post_Results_To],[CurrencyTranslationType] from ' + rtrim(@I_vFromCompany) + '..MC00200 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..MC00201' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..MC00201 ( [CURNCYID],[CURRNIDX],[ACTINDX],[OPENYEAR],[PERIODID],[Ledger_ID], [FUNCTAMT],[ORIGAMT] ) select [CURNCYID],[CURRNIDX],[ACTINDX],[OPENYEAR],[PERIODID],[Ledger_ID], [FUNCTAMT],[ORIGAMT] from ' + rtrim(@I_vFromCompany) + '..MC00201 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..MC40000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..MC40000 ( [FUNLCURR],[FUNCRIDX],[RPTGCURR],[RPTCRIDX],[RPTXRATE],[RPRTCLMD], [ALOWNWRT],[ANWRTPWD],[ALWMODRT],[MODRTPWD],[ALOVEXRT],[OVXRTPWD], [AOVRTVAR],[OVRTVPWD],[AOVRPTRT],[OVRPRPWD],[AVGEXRAT],[DEFFINTP], [DEFSLSTP],[DEFPURTP],[MNSUMHST],[LSTREVAL],[LSTPRVAL],[LSTSRVAL], [LSTTRXRV],[LSTSUMRV],[AVGCLMD] ) select [FUNLCURR],[FUNCRIDX],[RPTGCURR],[RPTCRIDX],[RPTXRATE],[RPRTCLMD], [ALOWNWRT],[ANWRTPWD],[ALWMODRT],[MODRTPWD],[ALOVEXRT],[OVXRTPWD], [AOVRTVAR],[OVRTVPWD],[AOVRPTRT],[OVRPRPWD],[AVGEXRAT],[DEFFINTP], [DEFSLSTP],[DEFPURTP],[MNSUMHST],[LSTREVAL],[LSTPRVAL],[LSTSRVAL], [LSTTRXRV],[LSTSUMRV],[AVGCLMD] from ' + rtrim(@I_vFromCompany) + '..MC40000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..MC40100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..MC40100 ( [RATETPID] ) select [RATETPID] from ' + rtrim(@I_vFromCompany) + '..MC40100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..MC40201' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..MC40201 ( [CURNCYID],[REALGAIN],[REALLOSS],[UNRLGAIN],[UNRLLOSS],[FINOFFST], [PUROFFST],[SLSOFFST],[RNDWTOFF],[RNDDIFF] ) select [CURNCYID],[REALGAIN],[REALLOSS],[UNRLGAIN],[UNRLLOSS],[FINOFFST], [PUROFFST],[SLSOFFST],[RNDWTOFF],[RNDDIFF] from ' + rtrim(@I_vFromCompany) + '..MC40201 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..MC40301' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..MC40301 ( [CURNCYID],[RATETPID],[EXGTBLID],[DFLTRATE],[REALGAIN],[REALLOSS], [UNRLGAIN],[UNRLLOSS],[FINOFFST],[PUROFFST],[SLSOFFST],[RNDWTOFF], [RNDDIFF],[Base_Exchange_Rate_On] ) select [CURNCYID],[RATETPID],[EXGTBLID],[DFLTRATE],[REALGAIN],[REALLOSS], [UNRLGAIN],[UNRLLOSS],[FINOFFST],[PUROFFST],[SLSOFFST],[RNDWTOFF], [RNDDIFF],[Base_Exchange_Rate_On] from ' + rtrim(@I_vFromCompany) + '..MC40301 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..MC40500' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..MC40500 ( [USERID],[SERIES],[TRXSOURC],[VIEWTYPE] ) select [USERID],[SERIES],[TRXSOURC],[VIEWTYPE] from ' + rtrim(@I_vFromCompany) + '..MC40500 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..MC60400' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..MC60400 ( [DENOMCURR],[ENABLED],[USERID],[REALGAIN],[REALLOSS],[PSTGDATE] ) select [DENOMCURR],[ENABLED],[USERID],[REALGAIN],[REALLOSS],[PSTGDATE] from ' + rtrim(@I_vFromCompany) + '..MC60400 ' exec(@cStatement) end return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyMC] TO [DYNGRP]
GO
