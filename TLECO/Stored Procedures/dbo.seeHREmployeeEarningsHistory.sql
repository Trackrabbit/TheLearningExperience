SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[seeHREmployeeEarningsHistory]( @Inactive int, @Department char(7), @Division char(7), @Position char(7), @Employee char(15) ) as IF @Inactive = 1  BEGIN  SELECT        UPR00100.LASTNAME, UPR00100.FRSTNAME, HRPSLH01.EMPLOYID, HRPSLH01.PAYRCORD   AS PAYCODE, HRPSLH01.EFFECTIVEDATE_I, HRPSLH01.PAYRTAMT, HRPSLH01.PAYUNIT,   HRPSLH01.ANNUALSALARY_I, HRPSLH01.PAYPRPRD AS PAY_PER_PERIOD,HRPSLH01.CHANGEREASON_I,   HRPSLH01.PAYPEROD AS PAY_PERIOD_TYPE, UPR00100.INACTIVE, HRPSLH01_1.ANNUALSALARY_I AS PREVANNUALSALARY  FROM    HRPSLH01 INNER JOIN UPR00100  ON     HRPSLH01.EMPLOYID = UPR00100.EMPLOYID LEFT OUTER JOIN  HRPSLH01 AS HRPSLH01_1  ON     HRPSLH01.EMPLOYID = HRPSLH01_1.EMPLOYID   AND HRPSLH01.PAYRCORD = HRPSLH01_1.PAYRCORD   AND HRPSLH01.SEQNUMBR - 1 = HRPSLH01_1.SEQNUMBR  WHERE         (@Department = '*All' or UPR00100.DEPRTMNT in (@Department)  )  and (@Employee = '*All' or UPR00100.EMPLOYID in (@Employee) )  and (@Position = '*All' or UPR00100.JOBTITLE in (@Position)  )  and (@Division = '*All' or UPR00100.DIVISIONCODE_I in (@Division)  )  END ELSE SELECT   UPR00100.LASTNAME, UPR00100.FRSTNAME, HRPSLH01.EMPLOYID, HRPSLH01.PAYRCORD AS PAYCODE,   HRPSLH01.EFFECTIVEDATE_I, HRPSLH01.PAYRTAMT, HRPSLH01.PAYUNIT, HRPSLH01.ANNUALSALARY_I,   HRPSLH01.PAYPRPRD AS PAY_PER_PERIOD, HRPSLH01.CHANGEREASON_I, HRPSLH01.PAYPEROD AS PAY_PERIOD_TYPE,   UPR00100.INACTIVE, HRPSLH01_1.ANNUALSALARY_I AS PREVANNUALSALARY   FROM   HRPSLH01 INNER JOIN UPR00100  ON    HRPSLH01.EMPLOYID = UPR00100.EMPLOYID LEFT OUTER JOIN  HRPSLH01 AS HRPSLH01_1  ON    HRPSLH01.EMPLOYID = HRPSLH01_1.EMPLOYID   AND HRPSLH01.PAYRCORD = HRPSLH01_1.PAYRCORD   AND HRPSLH01.SEQNUMBR - 1 = HRPSLH01_1.SEQNUMBR  WHERE   UPR00100.INACTIVE <> 1   AND (@Department = '*All' or UPR00100.DEPRTMNT in (@Department)  )  and (@Employee = '*All' or UPR00100.EMPLOYID in (@Employee) )  and (@Position = '*All' or UPR00100.JOBTITLE in (@Position)  )  and (@Division = '*All' or UPR00100.DIVISIONCODE_I in (@Division)  )   
GO
GRANT EXECUTE ON  [dbo].[seeHREmployeeEarningsHistory] TO [DYNGRP]
GO
GRANT EXECUTE ON  [dbo].[seeHREmployeeEarningsHistory] TO [rpt_executive]
GO
GRANT EXECUTE ON  [dbo].[seeHREmployeeEarningsHistory] TO [rpt_human resource administrator]
GO
GRANT EXECUTE ON  [dbo].[seeHREmployeeEarningsHistory] TO [rpt_power user]
GO
