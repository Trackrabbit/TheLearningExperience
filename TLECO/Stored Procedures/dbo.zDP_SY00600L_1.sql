SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SY00600L_1] (@CMPANYID_RS smallint, @LOCATNID_RS char(15), @CMPANYID_RE smallint, @LOCATNID_RE char(15)) AS  set nocount on IF @CMPANYID_RS IS NULL BEGIN SELECT TOP 25  CMPANYID, LOCATNID, LOCATNNM, ADRSCODE, ADRCNTCT, ADDRESS1, ADDRESS2, ADDRESS3, CITY, COUNTY, STATE, ZIPCODE, COUNTRY, PHONE1, PHONE2, PHONE3, FAXNUMBR, CHANGEBY_I, CHANGEDATE_I, NOTEINDX, CCode, DEX_ROW_ID FROM .SY00600 ORDER BY CMPANYID DESC, LOCATNID DESC END ELSE IF @CMPANYID_RS = @CMPANYID_RE BEGIN SELECT TOP 25  CMPANYID, LOCATNID, LOCATNNM, ADRSCODE, ADRCNTCT, ADDRESS1, ADDRESS2, ADDRESS3, CITY, COUNTY, STATE, ZIPCODE, COUNTRY, PHONE1, PHONE2, PHONE3, FAXNUMBR, CHANGEBY_I, CHANGEDATE_I, NOTEINDX, CCode, DEX_ROW_ID FROM .SY00600 WHERE CMPANYID = @CMPANYID_RS AND LOCATNID BETWEEN @LOCATNID_RS AND @LOCATNID_RE ORDER BY CMPANYID DESC, LOCATNID DESC END ELSE BEGIN SELECT TOP 25  CMPANYID, LOCATNID, LOCATNNM, ADRSCODE, ADRCNTCT, ADDRESS1, ADDRESS2, ADDRESS3, CITY, COUNTY, STATE, ZIPCODE, COUNTRY, PHONE1, PHONE2, PHONE3, FAXNUMBR, CHANGEBY_I, CHANGEDATE_I, NOTEINDX, CCode, DEX_ROW_ID FROM .SY00600 WHERE CMPANYID BETWEEN @CMPANYID_RS AND @CMPANYID_RE AND LOCATNID BETWEEN @LOCATNID_RS AND @LOCATNID_RE ORDER BY CMPANYID DESC, LOCATNID DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY00600L_1] TO [DYNGRP]
GO
