SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 Create Procedure [dbo].[SVC_Create_Inv_Requirement]  ( @SourceType smallint,  @RecType smallint,  @CallNumber char(11),  @EquipLine int,  @LineSeq int,  @LineType char(3),  @CMPNTSEQ int = 0,  @User_ID char(15)  ) As declare @OfficeID char(11) declare @MinDate datetime declare @InvLineType char(3),  @StationID char(10)  exec smGetMinDate @MinDate output   if @SourceType = 1  BEGIN  select @OfficeID = OFFID from SVC00200 where SRVRECTYPE = @RecType and CALLNBR = @CallNumber  select @InvLineType = 'P'  if @LineType = 'P' select @InvLineType = ''  else select @InvLineType = @LineType   if @LineType = 'N'  select @LineType = 'P'   if not exists(select * from SVC00710 where SRCDOCNUM = @CallNumber and SRCDOCTYP = @SourceType and LNITMSEQ = @LineSeq and CMPNTSEQ = @CMPNTSEQ  and LINITMTYP = @InvLineType)  insert into SVC00710  select CALLNBR,  @SourceType,  ITEMNMBR,   LNITMSEQ,   ITEMDESC,   LOCNCODE,   QTYORDER,  case @InvLineType  when ''  then TRNSFLOC  else LOCNCODE end,   TECHID,   case @InvLineType  when 'N'  then QTYORDER  else QTYBACKO end,   UOFM,   ATYALLOC,   case @InvLineType   when 'N'  then QTYORDER  else QTYSOLD end,  '',  @OfficeID,  0,   SVC_Disable_XFR_Grouping,   @User_ID,  0,   '',   '',  '',SVC_Address_Option, SVC_Misc_Address_Code,  @MinDate,1,  @InvLineType,  @CMPNTSEQ  from SVC00203  where SRVRECTYPE = @RecType and  CALLNBR = @CallNumber and  EQPLINE = @EquipLine and  LNITMSEQ = @LineSeq and  LINITMTYP = @LineType and  CMPNTSEQ = @CMPNTSEQ  END else  BEGIN  select @OfficeID = OFFID, @StationID = STATIONID from SVC06100 where WORECTYPE = @RecType and  WORKORDNUM = @CallNumber  insert into SVC00710  select WORKORDNUM,  @SourceType,  ITEMNMBR,   LNITMSEQ,   ITEMDESC,   LOCNCODE,   QTYORDER,   '',   TECHID,   case @InvLineType  when 'N'  then QTYORDER  else QTYBACKO end,   UOFM,   ATYALLOC,   0.0,   @StationID,  @OfficeID,  0,   0,   @User_ID,  0,   '',   '',   '',0,'',@MinDate,0,   '', @CMPNTSEQ  from SVC06101  where WORECTYPE = @RecType and  WORKORDNUM = @CallNumber and  LNITMSEQ = @LineSeq and  LINITMTYP = @LineType and  CMPNTSEQ = @CMPNTSEQ  END return    
GO
GRANT EXECUTE ON  [dbo].[SVC_Create_Inv_Requirement] TO [DYNGRP]
GO
