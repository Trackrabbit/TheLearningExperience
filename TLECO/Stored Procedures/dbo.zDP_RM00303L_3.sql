SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_RM00303L_3] (@SLTERDSC_RS char(31), @SALSTERR_RS char(15), @SLTERDSC_RE char(31), @SALSTERR_RE char(15)) AS  set nocount on IF @SLTERDSC_RS IS NULL BEGIN SELECT TOP 25  SALSTERR, SLTERDSC, INACTIVE, SLPRSNID, STMGRFNM, STMGRMNM, STMGRLNM, COUNTRY, COSTTODT, TTLCOMTD, TTLCOMLY, NCOMSLYR, COMSLLYR, CSTLSTYR, COMSLTDT, NCOMSLTD, KPCALHST, KPERHIST, NOTEINDX, MODIFDT, CREATDDT, DEX_ROW_TS, DEX_ROW_ID FROM .RM00303 ORDER BY SLTERDSC DESC, SALSTERR DESC END ELSE IF @SLTERDSC_RS = @SLTERDSC_RE BEGIN SELECT TOP 25  SALSTERR, SLTERDSC, INACTIVE, SLPRSNID, STMGRFNM, STMGRMNM, STMGRLNM, COUNTRY, COSTTODT, TTLCOMTD, TTLCOMLY, NCOMSLYR, COMSLLYR, CSTLSTYR, COMSLTDT, NCOMSLTD, KPCALHST, KPERHIST, NOTEINDX, MODIFDT, CREATDDT, DEX_ROW_TS, DEX_ROW_ID FROM .RM00303 WHERE SLTERDSC = @SLTERDSC_RS AND SALSTERR BETWEEN @SALSTERR_RS AND @SALSTERR_RE ORDER BY SLTERDSC DESC, SALSTERR DESC END ELSE BEGIN SELECT TOP 25  SALSTERR, SLTERDSC, INACTIVE, SLPRSNID, STMGRFNM, STMGRMNM, STMGRLNM, COUNTRY, COSTTODT, TTLCOMTD, TTLCOMLY, NCOMSLYR, COMSLLYR, CSTLSTYR, COMSLTDT, NCOMSLTD, KPCALHST, KPERHIST, NOTEINDX, MODIFDT, CREATDDT, DEX_ROW_TS, DEX_ROW_ID FROM .RM00303 WHERE SLTERDSC BETWEEN @SLTERDSC_RS AND @SLTERDSC_RE AND SALSTERR BETWEEN @SALSTERR_RS AND @SALSTERR_RE ORDER BY SLTERDSC DESC, SALSTERR DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_RM00303L_3] TO [DYNGRP]
GO
