SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[seeUPREmployeesDetail]  @EmployeeID varchar(50) = null,  @StartDateFrom datetime = null,  @StartDateTo datetime = null,  @DateInactiveFrom datetime = null,  @DateInactiveTo datetime = null,  @Department varchar(50) = null,  @Inactive varchar(50) = 'No' as  if @StartDateFrom is null and @StartDateTo is null  and @DateInactiveFrom is null and @DateInactiveTo is null begin  if @EmployeeID is null   if @Department is null    select *      from Employees     where [Inactive] = @Inactive   else    select *      from Employees     where [Department] = @Department      and [Inactive] = @Inactive  else   if @Department is null    Select *     from Employees     where [Employee ID] = @EmployeeID      and [Inactive] = @Inactive   else    Select *     from Employees     where [Employee ID] = @EmployeeID      and [Department] = @Department      and [Inactive] = @Inactive end  if @StartDateFrom is not null and @StartDateTo is not null  and @DateInactiveFrom is null and @DateInactiveTo is null begin  if @EmployeeID is null   if @Department is null    select *      from Employees     where ([Start Date] >= @StartDateFrom and [Start Date] <= @StartDateTo)      and [Inactive] = @Inactive   else    select *      from Employees     where [Department] = @Department      and ([Start Date] >= @StartDateFrom and [Start Date] <= @StartDateTo)      and [Inactive] = @Inactive  else   if @Department is null    Select *     from Employees     where [Employee ID] = @EmployeeID      and ([Start Date] >= @StartDateFrom and [Start Date] <= @StartDateTo)      and [Inactive] = @Inactive   else    Select *     from Employees     where [Employee ID] = @EmployeeID      and ([Start Date] >= @StartDateFrom and [Start Date] <= @StartDateTo)      and [Department] = @Department      and [Inactive] = @Inactive end  if @StartDateFrom is null and @StartDateTo is null  and @DateInactiveFrom is not null and @DateInactiveTo is not null begin  if @EmployeeID is null   if @Department is null    select *      from Employees     where ([Date Employee Inactivated] >= @DateInactiveFrom and [Date Employee Inactivated] <= @DateInactiveTo)      and [Inactive] = @Inactive   else    select *      from Employees     where [Department] = @Department      and ([Date Employee Inactivated] >= @DateInactiveFrom and [Date Employee Inactivated] <= @DateInactiveTo)      and [Inactive] = @Inactive  else   if @Department is null    Select *     from Employees     where [Employee ID] = @EmployeeID      and ([Date Employee Inactivated] >= @DateInactiveFrom and [Date Employee Inactivated] <= @DateInactiveTo)      and [Inactive] = @Inactive   else    Select *     from Employees     where [Employee ID] = @EmployeeID      and ([Date Employee Inactivated] >= @DateInactiveFrom and [Date Employee Inactivated] <= @DateInactiveTo)      and [Department] = @Department      and [Inactive] = @Inactive end  if @StartDateFrom is not null and @StartDateTo is not null  and @DateInactiveFrom is not null and @DateInactiveTo is not null begin  if @EmployeeID is null   if @Department is null    select *      from Employees     where ([Date Employee Inactivated] >= @DateInactiveFrom and [Date Employee Inactivated] <= @DateInactiveTo)      and ([Start Date] >= @StartDateFrom and [Start Date] <= @StartDateTo)      and [Inactive] = @Inactive   else    select *      from Employees     where [Department] = @Department      and ([Date Employee Inactivated] >= @DateInactiveFrom and [Date Employee Inactivated] <= @DateInactiveTo)      and ([Start Date] >= @StartDateFrom and [Start Date] <= @StartDateTo)      and [Inactive] = @Inactive  else   if @Department is null    Select *     from Employees     where [Employee ID] = @EmployeeID      and ([Date Employee Inactivated] >= @DateInactiveFrom and [Date Employee Inactivated] <= @DateInactiveTo)      and ([Start Date] >= @StartDateFrom and [Start Date] <= @StartDateTo)      and [Inactive] = @Inactive   else    Select *     from Employees     where [Employee ID] = @EmployeeID      and ([Date Employee Inactivated] >= @DateInactiveFrom and [Date Employee Inactivated] <= @DateInactiveTo)      and ([Start Date] >= @StartDateFrom and [Start Date] <= @StartDateTo)      and [Department] = @Department      and [Inactive] = @Inactive end          
GO
GRANT EXECUTE ON  [dbo].[seeUPREmployeesDetail] TO [DYNGRP]
GO
GRANT EXECUTE ON  [dbo].[seeUPREmployeesDetail] TO [rpt_executive]
GO
GRANT EXECUTE ON  [dbo].[seeUPREmployeesDetail] TO [rpt_human resource administrator]
GO
GRANT EXECUTE ON  [dbo].[seeUPREmployeesDetail] TO [rpt_payroll]
GO
