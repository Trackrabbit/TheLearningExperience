SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_UPR30601F_2] (@FRSTNAME_RS char(15), @LASTNAME_RS char(21), @EMPLOYID_RS char(15), @FRSTNAME_RE char(15), @LASTNAME_RE char(21), @EMPLOYID_RE char(15)) AS  set nocount on IF @FRSTNAME_RS IS NULL BEGIN SELECT TOP 25  EMPLOYID, FRSTNAME, MIDLNAME, LASTNAME, EMPLSUFF, NICKNAME, SOCSCNUM, STRTDATE, BRTHDATE, GENDER, ETHNORGN, MARITALSTATUS, SPOUSE, PHONE1, PHONE2, PHONE3, FAX, INET1, Messenger_Address, ADRSCODE, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, COUNTY, COUNTRY, DEX_ROW_ID, EmailToAddress FROM .UPR30601 ORDER BY FRSTNAME ASC, LASTNAME ASC, EMPLOYID ASC END ELSE IF @FRSTNAME_RS = @FRSTNAME_RE BEGIN SELECT TOP 25  EMPLOYID, FRSTNAME, MIDLNAME, LASTNAME, EMPLSUFF, NICKNAME, SOCSCNUM, STRTDATE, BRTHDATE, GENDER, ETHNORGN, MARITALSTATUS, SPOUSE, PHONE1, PHONE2, PHONE3, FAX, INET1, Messenger_Address, ADRSCODE, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, COUNTY, COUNTRY, DEX_ROW_ID, EmailToAddress FROM .UPR30601 WHERE FRSTNAME = @FRSTNAME_RS AND LASTNAME BETWEEN @LASTNAME_RS AND @LASTNAME_RE AND EMPLOYID BETWEEN @EMPLOYID_RS AND @EMPLOYID_RE ORDER BY FRSTNAME ASC, LASTNAME ASC, EMPLOYID ASC END ELSE BEGIN SELECT TOP 25  EMPLOYID, FRSTNAME, MIDLNAME, LASTNAME, EMPLSUFF, NICKNAME, SOCSCNUM, STRTDATE, BRTHDATE, GENDER, ETHNORGN, MARITALSTATUS, SPOUSE, PHONE1, PHONE2, PHONE3, FAX, INET1, Messenger_Address, ADRSCODE, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, COUNTY, COUNTRY, DEX_ROW_ID, EmailToAddress FROM .UPR30601 WHERE FRSTNAME BETWEEN @FRSTNAME_RS AND @FRSTNAME_RE AND LASTNAME BETWEEN @LASTNAME_RS AND @LASTNAME_RE AND EMPLOYID BETWEEN @EMPLOYID_RS AND @EMPLOYID_RE ORDER BY FRSTNAME ASC, LASTNAME ASC, EMPLOYID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_UPR30601F_2] TO [DYNGRP]
GO
