SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_FieldService_Equipment] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @Equipment_ID varchar(255), @Serial_Number varchar(255), @Item_Number varchar(255), @Reference varchar(255), @Version varchar(255), @Equipment_Status varchar(255), @Install_Date varchar(255), @Customer_ID varchar(255), @Address_Code varchar(255), @Address_1 varchar(255), @Address_2 varchar(255), @City varchar(255), @State varchar(255), @Zip varchar(255), @Country varchar(255), @Contact_Person varchar(255), @Last_PM_Date varchar(255), @Last_Service_Date varchar(255), @Tech_ID varchar(255), @Tech_ID2 varchar(255), @Office_ID varchar(255), @Service_Area varchar(255), @TimeZone varchar(255), @Warranty_Code varchar(255), @Warranty_End varchar(255), @Warranty_Start varchar(255), @Seller_Warranty_Code varchar(255), @Seller_Warranty_End varchar(255), @Seller_Warranty_Start varchar(255), @Note_Index varchar(255), @MTTR varchar(255), @MTBF varchar(255), @MTBI varchar(255), @Last_Calc_Date varchar(255), @Meters varchar(255), @Dailys varchar(255), @MTBFs varchar(255), @Meter_Deltas varchar(255), @SVC_PM_Month varchar(255), @SVC_PM_Day varchar(255), @Vendor_ID varchar(255), @Address_3 varchar(255), @User_Defined_1 varchar(255), @User_Defined_2 varchar(255), @User_Defined_3 varchar(255), @User_Defined_4 varchar(255), @User_Defined_5 varchar(255), @SVC_Serial_ID varchar(255), @QTY varchar(255), @SVC_Asset_Tag varchar(255), @Shipped_Date varchar(255), @SVC_Register_Date varchar(255), @Customer_Name varchar(255),  @DrillBack_Base_Url varchar(255), @DrillBack_Base_Url_For_FS varchar(255), @Customer_ID_For_DrillBack varchar(255), @Equipment_ID_For_DrillBack varchar(255), @Item_Number_For_DrillBack varchar(255), @Vendor_ID_For_DrillBack varchar(255)  select @DrillBack_Base_Url = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),0) select @DrillBack_Base_Url_For_FS = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),949)  select @I_iDictID = 949 select @I_iMessageNumber = 26200 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Equipment_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26201 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Serial_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 26202 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 26203 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reference output  select @I_iDictID = 949 select @I_iMessageNumber = 26204 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Version output  select @I_iDictID = 949 select @I_iMessageNumber = 26205 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Equipment_Status output  select @I_iDictID = 949 select @I_iMessageNumber = 26206 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Install_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26207 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26208 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 26209 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 26210 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 26211 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @City output  select @I_iDictID = 949 select @I_iMessageNumber = 26212 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @State output  select @I_iDictID = 949 select @I_iMessageNumber = 26213 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Zip output  select @I_iDictID = 949 select @I_iMessageNumber = 26214 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Country output  select @I_iDictID = 949 select @I_iMessageNumber = 26215 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Contact_Person output  select @I_iDictID = 949 select @I_iMessageNumber = 26216 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_PM_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26217 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Service_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26218 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tech_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26219 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tech_ID2 output  select @I_iDictID = 949 select @I_iMessageNumber = 26220 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Office_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26221 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Area output  select @I_iDictID = 949 select @I_iMessageNumber = 26222 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TimeZone output  select @I_iDictID = 949 select @I_iMessageNumber = 26223 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Warranty_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 26224 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Warranty_End output  select @I_iDictID = 949 select @I_iMessageNumber = 26225 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Warranty_Start output  select @I_iDictID = 949 select @I_iMessageNumber = 26226 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Seller_Warranty_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 26227 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Seller_Warranty_End output  select @I_iDictID = 949 select @I_iMessageNumber = 26228 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Seller_Warranty_Start output  select @I_iDictID = 949 select @I_iMessageNumber = 26229 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Note_Index output  select @I_iDictID = 949 select @I_iMessageNumber = 26230 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @MTTR output  select @I_iDictID = 949 select @I_iMessageNumber = 26231 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @MTBF output  select @I_iDictID = 949 select @I_iMessageNumber = 26232 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @MTBI output  select @I_iDictID = 949 select @I_iMessageNumber = 26233 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Calc_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26234 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Meters output  select @I_iDictID = 949 select @I_iMessageNumber = 26235 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Dailys output  select @I_iDictID = 949 select @I_iMessageNumber = 26236 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @MTBFs output  select @I_iDictID = 949 select @I_iMessageNumber = 26237 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Meter_Deltas output  select @I_iDictID = 949 select @I_iMessageNumber = 26238 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_PM_Month output  select @I_iDictID = 949 select @I_iMessageNumber = 26239 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_PM_Day output  select @I_iDictID = 949 select @I_iMessageNumber = 26240 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vendor_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26241 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_3 output  select @I_iDictID = 949 select @I_iMessageNumber = 26242 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 26243 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 26244 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_3 output  select @I_iDictID = 949 select @I_iMessageNumber = 26245 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_4 output  select @I_iDictID = 949 select @I_iMessageNumber = 26246 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_5 output  select @I_iDictID = 949 select @I_iMessageNumber = 26247 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Serial_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26248 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY output  select @I_iDictID = 949 select @I_iMessageNumber = 26249 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Asset_Tag output  select @I_iDictID = 949 select @I_iMessageNumber = 26250 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Shipped_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26251 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Register_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26380 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_Name output   select @I_iDictID = 949 select @I_iMessageNumber = 26207 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_ID_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 26240 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vendor_ID_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 26202 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 26200 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Equipment_ID_For_DrillBack output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[Equipment]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[Equipment] '  select @sqldefaultstring =   'CREATE VIEW Equipment AS ' +   'select ' +   '[''Serial Master''].[EQUIPID] as ''' + @Equipment_ID + ''', ' + 'rtrim([''Serial Master''].[SERLNMBR]) as ''' + @Serial_Number + ''', ' + 'rtrim([''Serial Master''].[ITEMNMBR]) as ''' + @Item_Number + ''', ' + 'rtrim([''Serial Master''].[SRLSTAT]) as ''' + @Equipment_Status + ''', ' + '[''Serial Master''].[INSTDTE] as ''' + @Install_Date + ''', ' + 'rtrim([''RM Customer MSTR''].[CUSTNMBR]) as ''' + @Customer_ID + ''', ' + 'rtrim([''Serial Master''].[ADRSCODE]) as ''' + @Address_Code + ''', ' + 'rtrim([''Serial Master''].[SVC_Serial_ID]) as ''' + @SVC_Serial_ID + ''', ' + '[''Serial Master''].[QUANTITY] as ''' + @QTY + ''', ' + 'rtrim([''Serial Master''].[SVC_Asset_Tag]) as ''' + @SVC_Asset_Tag + ''', ' + '[''Serial Master''].[Shipped_Date] as ''' + @Shipped_Date + ''', '   select @sqlstring1 =   'rtrim([''Serial Master''].[ADDRESS1]) as ''' + @Address_1 + ''', ' +  'rtrim([''Serial Master''].[ADDRESS2]) as ''' + @Address_2 + ''', ' +  'rtrim([''Serial Master''].[ADDRESS3]) as ''' + @Address_3 + ''', ' +  'rtrim([''Serial Master''].[CITY]) as ''' + @City + ''', ' +  'rtrim([''Serial Master''].[CNTCPRSN]) as ''' + @Contact_Person + ''', ' +  'rtrim([''Serial Master''].[COUNTRY]) as ''' + @Country + ''', ' +  'rtrim([''RM Customer MSTR''].[CUSTNAME]) as ''' + @Customer_Name + ''', ' +  '[''Serial Master''].[Dailys_1] as ''' + @Dailys + ''', ' +  '[''Serial Master''].[Last_Calc_Date] as ''' + @Last_Calc_Date + ''', ' +  '[''Serial Master''].[LSTPMDTE] as ''' + @Last_PM_Date + ''', ' +  '[''Serial Master''].[LSTSRVDTE] as ''' + @Last_Service_Date + ''', ' +  '[''Serial Master''].[MTBF] as ''' + @MTBF + ''', ' +  '[''Serial Master''].[MTBFs_1] as ''' + @MTBFs + ''', ' +  '[''Serial Master''].[MTBI] as ''' + @MTBI + ''', ' +  '[''Serial Master''].[MTTR] as ''' + @MTTR + ''', ' +  '[''Serial Master''].[Meter_Deltas_1] as ''' + @Meter_Deltas + ''', ' +  '[''Serial Master''].[Meters_1] as ''' + @Meters + ''', ' +  '[''Serial Master''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  'rtrim([''Serial Master''].[OFFID]) as ''' + @Office_ID + ''', ' +  'rtrim([''Serial Master''].[REFRENCE]) as ''' + @Reference + ''', ' +  '[''Serial Master''].[SVC_PM_Day] as ''' + @SVC_PM_Day + ''', ' +  '''' + @SVC_PM_Month + ''' = dbo.FS_FUNC_SVC_PM_Month([''Serial Master''].[SVC_PM_Date]), ' +  '[''Serial Master''].[SVC_Register_Date] as ''' + @SVC_Register_Date + ''', ' +  'rtrim([''Serial Master''].[SLRWARR]) as ''' + @Seller_Warranty_Code + ''', ' +  '[''Serial Master''].[SLRWEND] as ''' + @Seller_Warranty_End + ''', ' +  '[''Serial Master''].[SLRWSTART] as ''' + @Seller_Warranty_Start + ''', ' +  'rtrim([''Serial Master''].[SVCAREA]) as ''' + @Service_Area + ''', ' +  'rtrim([''Serial Master''].[STATE]) as ''' + @State + ''', ' +  'rtrim([''Serial Master''].[TECHID]) as ''' + @Tech_ID + ''', ' +  'rtrim([''Serial Master''].[TECHID2]) as ''' + @Tech_ID2 + ''', ' +  'rtrim([''Serial Master''].[TIMEZONE]) as ''' + @TimeZone + ''', ' +  'rtrim([''Serial Master''].[USERDEF1]) as ''' + @User_Defined_1 + ''', ' +  'rtrim([''Serial Master''].[USERDEF2]) as ''' + @User_Defined_2 + ''', ' +  'rtrim([''Serial Master''].[USRDEF03]) as ''' + @User_Defined_3 + ''', ' +  'rtrim([''Serial Master''].[USRDEF04]) as ''' + @User_Defined_4 + ''', ' +  'rtrim([''Serial Master''].[USRDEF05]) as ''' + @User_Defined_5 + ''', ' +  'rtrim([''Serial Master''].[VENDORID]) as ''' + @Vendor_ID + ''', ' +  'rtrim([''Serial Master''].[Version]) as ''' + @Version + ''', ' +  'rtrim([''Serial Master''].[WARRCDE]) as ''' + @Warranty_Code + ''', ' +  '[''Serial Master''].[WARREND] as ''' + @Warranty_End + ''', ' +  '[''Serial Master''].[WARRSTART] as ''' + @Warranty_Start + ''', ' +  'rtrim([''Serial Master''].[ZIP]) as ''' + @Zip + ''', '   select @sqlstring2 =  '''' + @Customer_ID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppCustomerID(1,[''RM Customer MSTR''].[CUSTNMBR] ), '+ '''' + @Equipment_ID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url_For_FS + ''' +dbo.dgppEquipmentID(1,[''Serial Master''].[EQUIPID] ), '+ '''' + @Item_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppItemID(1,[''Serial Master''].[ITEMNMBR],'''' ), '+ '''' + @Vendor_ID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppVendorID(1,[''Serial Master''].[VENDORID] ) '  select @sqljoinstring =   'from [SVC00300] as [''Serial Master''] with (NOLOCK) '   + 'left outer join [RM00101] as [''RM Customer MSTR''] with (NOLOCK) on '   + '[''Serial Master''].[CUSTNMBR] = [''RM Customer MSTR''].[CUSTNMBR] '   select @sqlaccessstring =   'GRANT SELECT ON [dbo].[Equipment] TO [rpt_dispatcher]' + 'GRANT SELECT ON [dbo].[Equipment] TO [rpt_customer service rep]' + 'GRANT SELECT ON [dbo].[Equipment] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[Equipment] TO [rpt_project manager]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_FieldService_Equipment] TO [DYNGRP]
GO
