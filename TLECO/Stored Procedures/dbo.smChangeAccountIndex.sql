SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[smChangeAccountIndex] @I_intStartAcct char(15), @I_intEndAcct 	char(15), @I_intACTINDX1 	int, @I_intACTINDX2 	int, @O_iErrorState 	int = NULL  output with encryption as set transaction isolation level read uncommitted set nocount on declare  @iStatus 	int, @iError 	int,  @tTransaction	tinyint, @tLoop		tinyint select @O_iErrorState = 0 if @@trancount = 0    begin select @tTransaction = 1 begin transaction end while ( @tLoop is NULL ) begin select @tLoop = 1 if exists (select * from sysobjects where id = object_id('dbo.glpAccountMasterDeleteTrigger')) alter table GL00100 disable trigger glpAccountMasterDeleteTrigger if @@error <> 0 begin select @O_iErrorState = 1  break end if exists (select * from sysobjects where id = object_id('dbo.glpAccountMasterUpdateTrigger')) alter table GL00100 disable trigger glpAccountMasterUpdateTrigger if @@error <> 0 begin select @O_iErrorState = 2  break end if exists (select * from sysobjects where id = object_id('dbo.FRx_Chart_Delete')) alter table GL00100 disable trigger FRx_Chart_Delete if @@error <> 0 begin select @O_iErrorState = 3  break end if exists (select * from sysobjects where id = object_id('dbo.FRx_Chart_Update')) alter table GL00100 disable trigger FRx_Chart_Update if @@error <> 0 begin select @O_iErrorState = 4  break end if exists (select * from sysobjects where id = object_id('dbo.FRx_Chart_Insert')) alter table GL00100 disable trigger FRx_Chart_Insert if @@error <> 0 begin select @O_iErrorState = 5  break end if exists (select * from sysobjects where id = object_id('dbo.taAccountInsert')) alter table GL00100 disable trigger taAccountInsert if @@error <> 0 begin select @O_iErrorState = 6  break end if exists (select * from sysobjects where id = object_id('dbo.taAccountIndexInsert')) alter table GL00105 disable trigger taAccountIndexInsert if @@error <> 0 begin select @O_iErrorState = 7  break end if exists (select * from sysobjects where id = object_id('dbo.taCustomerInsert')) alter table RM00101 disable trigger taCustomerInsert if @@error <> 0 begin select @O_iErrorState = 8  break end if exists (select * from sysobjects where id = object_id('dbo.taVendorInsert')) alter table PM00200 disable trigger taVendorInsert if @@error <> 0 begin select @O_iErrorState = 9  break end if exists (select * from sysobjects where id = object_id('dbo.glFilter1InsertTrigger')) alter table GL00100F1 disable trigger glFilter1InsertTrigger if @@error <> 0 begin select @O_iErrorState = 132  break end if exists (select * from sysobjects where id = object_id('dbo.glFilter1UpdateTrigger')) alter table GL00100F1 disable trigger glFilter1UpdateTrigger if @@error <> 0 begin select @O_iErrorState = 133  break end if exists (select * from sysobjects where id = object_id('dbo.glFilter2InsertTrigger')) alter table GL00100F2 disable trigger glFilter2InsertTrigger if @@error <> 0 begin select @O_iErrorState = 134  break end if exists (select * from sysobjects where id = object_id('dbo.glFilter2UpdateTrigger')) alter table GL00100F2 disable trigger glFilter2UpdateTrigger if @@error <> 0 begin select @O_iErrorState = 135  break end if exists (select * from sysobjects where id = object_id('dbo.glFilter3InsertTrigger')) alter table GL00100F3 disable trigger glFilter3InsertTrigger if @@error <> 0 begin select @O_iErrorState = 136  break end if exists (select * from sysobjects where id = object_id('dbo.glFilter3UpdateTrigger')) alter table GL00100F3 disable trigger glFilter3UpdateTrigger if @@error <> 0 begin select @O_iErrorState = 137  break end if exists (select * from sysobjects where id = object_id('dbo.glFilter4InsertTrigger')) alter table GL00100F4 disable trigger glFilter4InsertTrigger if @@error <> 0 begin select @O_iErrorState = 138  break end if exists (select * from sysobjects where id = object_id('dbo.glFilter4UpdateTrigger')) alter table GL00100F4 disable trigger glFilter4UpdateTrigger if @@error <> 0 begin select @O_iErrorState = 139  break end if exists (select * from sysobjects where id = object_id('dbo.FRx_Chart_Insert')) alter table GL00100 disable trigger FRx_Chart_Insert if @@error <> 0 begin select @O_iErrorState = 140  break end if exists (select * from sysobjects where id = object_id('dbo.FRx_Chart_Update')) alter table GL00100 disable trigger FRx_Chart_Update if @@error <> 0 begin select @O_iErrorState = 141  break end if exists (select * from sysobjects where id = object_id('dbo.FRx_Chart_Delete')) alter table GL00100 disable trigger FRx_Chart_Delete if @@error <> 0 begin select @O_iErrorState = 142  break end if exists (select * from sysobjects where id = object_id('dbo.mfg_update_location_update')) alter table IV00101 disable trigger mfg_update_location_update if @@error <> 0 begin select @O_iErrorState = 159  break end exec @iStatus = taAccountIndexCombiner @I_intStartAcct, @I_intEndAcct, @I_intACTINDX1, @I_intACTINDX2, @O_iErrorState output select @iError = @@error if @iStatus = 0 and @iError <> 0 select @iStatus = @iError if (@iStatus <> 0) or (@O_iErrorState <> 0) begin select @O_iErrorState = 65 break end end  if exists (select * from sysobjects where id = object_id('dbo.glpAccountMasterDeleteTrigger')) alter table GL00100 enable trigger glpAccountMasterDeleteTrigger if @@error <> 0 begin select @O_iErrorState = 73  end if exists (select * from sysobjects where id = object_id('dbo.glpAccountMasterUpdateTrigger')) alter table GL00100 enable trigger glpAccountMasterUpdateTrigger if @@error <> 0 begin select @O_iErrorState = 74  end if exists (select * from sysobjects where id = object_id('dbo.FRX_Chart_Delete')) alter table GL00100 enable trigger FRX_Chart_Delete if @@error <> 0 begin select @O_iErrorState = 75  end if exists (select * from sysobjects where id = object_id('dbo.FRX_Chart_Insert')) alter table GL00100 enable trigger FRX_Chart_Insert if @@error <> 0 begin select @O_iErrorState = 76  end if exists (select * from sysobjects where id = object_id('dbo.FRX_Chart_Update')) alter table GL00100 enable trigger FRX_Chart_Update if @@error <> 0 begin select @O_iErrorState = 77  end if exists (select * from sysobjects where id = object_id('dbo.taAccountInsert')) alter table GL00100 enable trigger taAccountInsert if @@error <> 0 begin select @O_iErrorState = 78  end if exists (select * from sysobjects where id = object_id('dbo.taAccountIndexInsert')) alter table GL00105 enable trigger taAccountIndexInsert if @@error <> 0 begin select @O_iErrorState = 79  end if exists (select * from sysobjects where id = object_id('dbo.taCustomerInsert')) alter table RM00101 enable trigger taCustomerInsert if @@error <> 0 begin select @O_iErrorState = 80  end if exists (select * from sysobjects where id = object_id('dbo.taVendorInsert')) alter table PM00200 enable trigger taVendorInsert if @@error <> 0 begin select @O_iErrorState = 81  end if exists (select * from sysobjects where id = object_id('dbo.glFilter1InsertTrigger')) alter table GL00100F1 enable trigger glFilter1InsertTrigger if @@error <> 0 begin select @O_iErrorState = 140  end if exists (select * from sysobjects where id = object_id('dbo.glFilter1UpdateTrigger')) alter table GL00100F1 enable trigger glFilter1UpdateTrigger if @@error <> 0 begin select @O_iErrorState = 141  end if exists (select * from sysobjects where id = object_id('dbo.glFilter2InsertTrigger')) alter table GL00100F2 enable trigger glFilter2InsertTrigger if @@error <> 0 begin select @O_iErrorState = 142  end if exists (select * from sysobjects where id = object_id('dbo.glFilter2UpdateTrigger')) alter table GL00100F2 enable trigger glFilter2UpdateTrigger if @@error <> 0 begin select @O_iErrorState = 143  end if exists (select * from sysobjects where id = object_id('dbo.glFilter3InsertTrigger')) alter table GL00100F3 enable trigger glFilter3InsertTrigger if @@error <> 0 begin select @O_iErrorState = 144  end if exists (select * from sysobjects where id = object_id('dbo.glFilter3UpdateTrigger')) alter table GL00100F3 enable trigger glFilter3UpdateTrigger if @@error <> 0 begin select @O_iErrorState = 145  end if exists (select * from sysobjects where id = object_id('dbo.glFilter4InsertTrigger')) alter table GL00100F4 enable trigger glFilter4InsertTrigger if @@error <> 0 begin select @O_iErrorState = 146  end if exists (select * from sysobjects where id = object_id('dbo.glFilter4UpdateTrigger')) alter table GL00100F4 enable trigger glFilter4UpdateTrigger if @@error <> 0 begin select @O_iErrorState = 147  end if exists (select * from sysobjects where id = object_id('dbo.FRx_Chart_Insert')) alter table GL00100 enable trigger FRx_Chart_Insert if @@error <> 0 begin select @O_iErrorState = 148  end if exists (select * from sysobjects where id = object_id('dbo.FRx_Chart_Update')) alter table GL00100 enable trigger FRx_Chart_Update if @@error <> 0 begin select @O_iErrorState = 149  end if exists (select * from sysobjects where id = object_id('dbo.FRx_Chart_Delete')) alter table GL00100 enable trigger FRx_Chart_Delete if @@error <> 0 begin select @O_iErrorState = 150  end if exists (select * from sysobjects where id = object_id('dbo.mfg_update_location_update')) alter table IV00101 enable trigger mfg_update_location_update if @@error <> 0 begin select @O_iErrorState = 160  end if @O_iErrorState <> 0 begin if @tTransaction = 1 rollback transaction end else if @tTransaction = 1 begin commit transaction end return  
GO
GRANT EXECUTE ON  [dbo].[smChangeAccountIndex] TO [DYNGRP]
GO
