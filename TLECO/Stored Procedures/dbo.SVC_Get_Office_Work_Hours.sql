SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 Create Procedure [dbo].[SVC_Get_Office_Work_Hours]  (@OfficeID char(11),  @InDate datetime,  @Avail smallint OUTPUT,  @STARTTIME datetime OUTPUT,  @ENDTIME datetime OUTPUT) As declare @Day smallint select @Day = DATEPART(dw,@InDate) select @Avail = case @Day  WHEN 2 THEN WORKDYS_1  WHEN 3 THEN WORKDYS_2  WHEN 4 THEN WORKDYS_3  WHEN 5 THEN WORKDYS_4  WHEN 6 THEN WORKDYS_5  WHEN 7 THEN WORKDYS_6  WHEN 1 THEN WORKDYS_7  END from SVC00902  WHERE OFFID = @OfficeID if @Avail <> 0  BEGIN  select @STARTTIME = case @Day  WHEN 2 THEN WORKSTRT_1  WHEN 3 THEN WORKSTRT_2  WHEN 4 THEN WORKSTRT_3  WHEN 5 THEN WORKSTRT_4  WHEN 6 THEN WORKSTRT_5  WHEN 7 THEN WORKSTRT_6  WHEN 1 THEN WORKSTRT_7  END,  @ENDTIME = case @Day  WHEN 2 THEN WORKEND_1  WHEN 3 THEN WORKEND_2  WHEN 4 THEN WORKEND_3  WHEN 5 THEN WORKEND_4  WHEN 6 THEN WORKEND_5  WHEN 7 THEN WORKEND_6  WHEN 1 THEN WORKEND_7  END  from SVC00902   WHERE OFFID = @OfficeID  select @STARTTIME = CONVERT(varchar(20),@InDate,102) + ' ' +   CONVERT(varchar(20),@STARTTIME,108),  @ENDTIME = CONVERT(varchar(20),@InDate,102) + ' ' +   CONVERT(varchar(20),@ENDTIME,108) END ELSE  select @STARTTIME = @InDate,  @ENDTIME = @InDate return (0)    
GO
GRANT EXECUTE ON  [dbo].[SVC_Get_Office_Work_Hours] TO [DYNGRP]
GO
