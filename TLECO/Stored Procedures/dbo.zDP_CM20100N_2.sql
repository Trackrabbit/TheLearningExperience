SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_CM20100N_2] (@BS int, @AUDITTRAIL char(13), @CHEKBKID char(15), @CMTrxType smallint, @CMTrxNum char(21), @DEX_ROW_ID int, @AUDITTRAIL_RS char(13), @CHEKBKID_RS char(15), @CMTrxType_RS smallint, @CMTrxNum_RS char(21), @AUDITTRAIL_RE char(13), @CHEKBKID_RE char(15), @CMTrxType_RE smallint, @CMTrxNum_RE char(21)) AS  set nocount on IF @AUDITTRAIL_RS IS NULL BEGIN SELECT TOP 25  CMDNUMWK, RecNumControl, VOIDED, CNTRLTYP, AUDITTRAIL, CHEKBKID, CMTrxType, CMTrxNum, CMERRMSG, DEX_ROW_ID FROM .CM20100 WHERE ( AUDITTRAIL = @AUDITTRAIL AND CHEKBKID = @CHEKBKID AND CMTrxType = @CMTrxType AND CMTrxNum = @CMTrxNum AND DEX_ROW_ID > @DEX_ROW_ID OR AUDITTRAIL = @AUDITTRAIL AND CHEKBKID = @CHEKBKID AND CMTrxType = @CMTrxType AND CMTrxNum > @CMTrxNum OR AUDITTRAIL = @AUDITTRAIL AND CHEKBKID = @CHEKBKID AND CMTrxType > @CMTrxType OR AUDITTRAIL = @AUDITTRAIL AND CHEKBKID > @CHEKBKID OR AUDITTRAIL > @AUDITTRAIL ) ORDER BY AUDITTRAIL ASC, CHEKBKID ASC, CMTrxType ASC, CMTrxNum ASC, DEX_ROW_ID ASC END ELSE IF @AUDITTRAIL_RS = @AUDITTRAIL_RE BEGIN SELECT TOP 25  CMDNUMWK, RecNumControl, VOIDED, CNTRLTYP, AUDITTRAIL, CHEKBKID, CMTrxType, CMTrxNum, CMERRMSG, DEX_ROW_ID FROM .CM20100 WHERE AUDITTRAIL = @AUDITTRAIL_RS AND CHEKBKID BETWEEN @CHEKBKID_RS AND @CHEKBKID_RE AND CMTrxType BETWEEN @CMTrxType_RS AND @CMTrxType_RE AND CMTrxNum BETWEEN @CMTrxNum_RS AND @CMTrxNum_RE AND ( AUDITTRAIL = @AUDITTRAIL AND CHEKBKID = @CHEKBKID AND CMTrxType = @CMTrxType AND CMTrxNum = @CMTrxNum AND DEX_ROW_ID > @DEX_ROW_ID OR AUDITTRAIL = @AUDITTRAIL AND CHEKBKID = @CHEKBKID AND CMTrxType = @CMTrxType AND CMTrxNum > @CMTrxNum OR AUDITTRAIL = @AUDITTRAIL AND CHEKBKID = @CHEKBKID AND CMTrxType > @CMTrxType OR AUDITTRAIL = @AUDITTRAIL AND CHEKBKID > @CHEKBKID OR AUDITTRAIL > @AUDITTRAIL ) ORDER BY AUDITTRAIL ASC, CHEKBKID ASC, CMTrxType ASC, CMTrxNum ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  CMDNUMWK, RecNumControl, VOIDED, CNTRLTYP, AUDITTRAIL, CHEKBKID, CMTrxType, CMTrxNum, CMERRMSG, DEX_ROW_ID FROM .CM20100 WHERE AUDITTRAIL BETWEEN @AUDITTRAIL_RS AND @AUDITTRAIL_RE AND CHEKBKID BETWEEN @CHEKBKID_RS AND @CHEKBKID_RE AND CMTrxType BETWEEN @CMTrxType_RS AND @CMTrxType_RE AND CMTrxNum BETWEEN @CMTrxNum_RS AND @CMTrxNum_RE AND ( AUDITTRAIL = @AUDITTRAIL AND CHEKBKID = @CHEKBKID AND CMTrxType = @CMTrxType AND CMTrxNum = @CMTrxNum AND DEX_ROW_ID > @DEX_ROW_ID OR AUDITTRAIL = @AUDITTRAIL AND CHEKBKID = @CHEKBKID AND CMTrxType = @CMTrxType AND CMTrxNum > @CMTrxNum OR AUDITTRAIL = @AUDITTRAIL AND CHEKBKID = @CHEKBKID AND CMTrxType > @CMTrxType OR AUDITTRAIL = @AUDITTRAIL AND CHEKBKID > @CHEKBKID OR AUDITTRAIL > @AUDITTRAIL ) ORDER BY AUDITTRAIL ASC, CHEKBKID ASC, CMTrxType ASC, CMTrxNum ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_CM20100N_2] TO [DYNGRP]
GO
