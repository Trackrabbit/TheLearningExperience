SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[seeHistReceivednotInvoiced] @PONumber_RS varchar(17), @PONumber_RE varchar(17), @VendorID_RS varchar (15), @VendorID_RE varchar (15), @PurchasingTransactionDate tinyint, @CutoffDate datetime, @IncludeFunctionalCurrency tinyint, @SortBy tinyint, @IncludeLandedCosts tinyint  as declare @TotNotInv numeric(19,2),@TotNotInvLessRet numeric(19,2),@TotalRNILandedCost numeric(19,2) set nocount on  if exists (select * from dbo.sysobjects where id = object_id(N'[##temp_HistreceivedNotinvoicedPostDt]') and OBJECTPROPERTY(id, N'IsUserTable') = 1) drop table [##temp_HistreceivedNotinvoicedPostDt] if exists (select * from dbo.sysobjects where id = object_id(N'[##temp_HistreceivedNotinvoicedTrxtDt]') and OBJECTPROPERTY(id, N'IsUserTable') = 1) drop table [##temp_HistreceivedNotinvoicedTrxtDt] if exists (select * from dbo.sysobjects where id = object_id(N'[##temp_NotinvoicedAmtPostDt]') and OBJECTPROPERTY(id, N'IsUserTable') = 1) drop table [##temp_NotinvoicedAmtPostDt] if exists (select * from dbo.sysobjects where id = object_id(N'[##temp_TotNotinvoicedAmtPostDt]') and OBJECTPROPERTY(id, N'IsUserTable') = 1) drop table [##temp_TotNotinvoicedAmtPostDt] if exists (select * from dbo.sysobjects where id = object_id(N'[##temp_NotinvoicedAmtTrxDt]') and OBJECTPROPERTY(id, N'IsUserTable') = 1) drop table [##temp_NotinvoicedAmtTrxDt] if exists (select * from dbo.sysobjects where id = object_id(N'[##temp_TotNotinvoicedAmtTrxDt]') and OBJECTPROPERTY(id, N'IsUserTable') = 1) drop table [##temp_TotNotinvoicedAmtTrxDt] if exists (select * from dbo.sysobjects where id = object_id(N'[##temp_landedcosttotalsTrx]') and OBJECTPROPERTY(id, N'IsUserTable') = 1) drop table [##temp_landedcosttotalsTrx] if exists (select * from dbo.sysobjects where id = object_id(N'[##temp_landedcosttotalsPostDt]') and OBJECTPROPERTY(id, N'IsUserTable') = 1) drop table [##temp_landedcosttotalsPostDt]  If @PONumber_RE = ''  Begin  set @PONumber_RE = 'þþþþþþþþþþþþþþþ'  End  If @VendorID_RE = ''  Begin  set @VendorID_RE = 'þþþþþþþþþþþþþþþ'  End  if @PurchasingTransactionDate = 1 begin  if @IncludeLandedCosts = 1  Begin  select c.PONUMBER_1, sum(c.[Total Cost]) as [Total Landed Cost]  into ##temp_landedcosttotalsPostDt  from  (select isnull((select distinct a.PONUMBER from POP10500 a where a.POPRCTNM = b.POPRCTNM and a.RCPTLNNM = b.RCPTLNNM and a.PONUMBER <> ''),'') as PONUMBER_1,   a.VENDORID,   b.Total_Landed_Cost_Amount as [Total Cost]  from POP10500 a  join POP30700 b  on a.POPRCTNM = b.POPRCTNM  and a.RCPTLNNM = b.RCPTLNNM  and a.POLNENUM = b.LCLINENUMBER  join POP30300 d  on a.POPRCTNM = d.POPRCTNM  where   d.VENDORID between @VendorID_RS and @VendorID_RE and  d.GLPOSTDT <= @CutoffDate and  a.PONUMBER >= @PONumber_RS and a.PONUMBER<= @PONumber_RE and a.PONUMBER = '') c  group by c.PONUMBER_1  End  select   r.PONUMBER as [PO Number],  r.POLNENUM,  r.POPRCTNM as [POPRCTNM],  r.RCPTLNNM as [POPRCTLNNM],  r.APPYTYPE as [APPYTYPE],  r.POPTYPE as [POPTYPE],  r.CURNCYID as [Currency ID],  r.VENDORID as [Vendor ID],  p.VENDNAME as [Vendor Name],  p.DOCDATE as [Document Date],  r.ITEMNMBR as [Item Number],  i.ITEMDESC as [Item Description],  pol.QTYORDER as [Qty Ordered],  pol.UOFM as [UOM Ordered],   case when (@IncludeFunctionalCurrency = 0) then pol.UNITCOST  else case when (pol.XCHGRATE = 0) then pol.UNITCOST  else (case when (pol.RATECALC = 1) then (pol.UNITCOST/pol.XCHGRATE) else  pol.UNITCOST*pol.XCHGRATE   end) end end   as [PO Unit Cost],  r.POPRCTNM as [Receipt Number],  P3.receiptdate as [Date Received],  P3.GLPOSTDT as [Date Received Parameter],  r.TRXLOCTN as [Site ID],  r.UOFM as [Shipment UOM],  r.QTYSHPPD AS [Qty Shipped],  r.QTYINVCD as [Qty Invoiced],  r.QTYRESERVED as [Qty Returned],  r.QTYRESERVED as [Qty Inv Returned],  r.QTYREJ as QTYREJ,  case when (@IncludeFunctionalCurrency = 0) then r.ORCPTCOST  else case when (r.XCHGRATE = 0) then r.ORCPTCOST  else (case when (r.RATECALC = 1) then (r.ORCPTCOST/r.XCHGRATE) else  r.ORCPTCOST*r.XCHGRATE   end) end end   as [Unitcost],  u.UMDPQTYS -1 as [UOM Decimals],P3.REPLACEGOODS,P3.INVOICEEXPECTED   into ##temp_HistreceivedNotinvoicedPostDt   from POP10500 r   left join POP10100 p on   r.PONUMBER = p.PONUMBER   left JOIN POP10110 pol on   p.PONUMBER = pol.PONUMBER and  r.POLNENUM = pol.ORD   left join POP30300 P3 on   r.POPRCTNM = P3.POPRCTNM  left join IV00101 i on   pol.ITEMNMBR = i.ITEMNMBR  left join IV40201 u on   i.UOMSCHDL = u.UOMSCHDL   where r.VENDORID between @VendorID_RS and @VendorID_RE  and  r.PONUMBER >= @PONumber_RS and r.PONUMBER <=@PONumber_RE and  P3.GLPOSTDT <= @CutoffDate and  p.POTYPE <> 2 and   p.POSTATUS not in (5,6) and  pol.POLNESTA not in (5,6) and r.Status <>0 and r.POLNENUM<> ''   group by r.PONUMBER,r.POLNENUM, r.POPRCTNM, r.RCPTLNNM,r.APPYTYPE ,r.POPTYPE , r.CURNCYID, r.VENDORID, p.VENDNAME,  p.DOCDATE,r.Status,r.ITEMNMBR,i.ITEMDESC ,pol.QTYORDER,pol.UOFM,pol.UNITCOST,pol.XCHGRATE, pol.RATECALC,  r.ORCPTCOST,r.XCHGRATE,r.RATECALC,r.UOFM,P3.receiptdate,P3.GLPOSTDT,r.TRXLOCTN,r.QTYSHPPD,r.QTYINVCD,  r.QTYRESERVED,r.QTYINVRESERVE,r.QTYREJ,u.UMDPQTYS, P3.REPLACEGOODS,P3.INVOICEEXPECTED  union  select   '******' as [PO Number],  r.POLNENUM,  r.POPRCTNM as [POPRCTNM],  r.RCPTLNNM as [POPRCTLNNM],  r.APPYTYPE as [APPYTYPE],  r.POPTYPE as [POPTYPE],  r.CURNCYID as [Currency ID],  r.VENDORID as [Vendor ID],  p.VENDNAME as [Vendor Name],  '' as [Document Date],  r.ITEMNMBR as [Item Number],  i.ITEMDESC as [Item Description],  0 as [Qty Ordered],  '' as [UOM Ordered],   0 as [PO Unit Cost],  r.POPRCTNM as [Receipt Number],  P3.receiptdate as [Date Received],  P3.GLPOSTDT as [Date Received Parameter],  r.TRXLOCTN as [Site ID],  r.UOFM as [Shipment UOM],  r.QTYSHPPD AS [Qty Shipped],  r.QTYINVCD as [Qty Invoiced],  r.QTYRESERVED as [Qty Returned],  r.QTYRESERVED as [Qty Inv Returned],  r.QTYREJ as QTYREJ,  case when (@IncludeFunctionalCurrency = 0) then r.ORCPTCOST  else case when (r.XCHGRATE = 0) then r.ORCPTCOST  else (case when (r.RATECALC = 1) then (r.ORCPTCOST/r.XCHGRATE) else  r.ORCPTCOST*r.XCHGRATE  end) end end   as [Unitcost],  u.UMDPQTYS -1  as [UOM Decimals],P3.REPLACEGOODS,P3.INVOICEEXPECTED   from POP10500 r   left join   PM00200 p on  r.VENDORID = p.VENDORID   left join IV00101 i on r.ITEMNMBR = i.ITEMNMBR  left join IV40201 u on i.UOMSCHDL = u.UOMSCHDL  left join POP30300 P3 on r.POPRCTNM = P3.POPRCTNM   where r.Status <>0  and r.PONUMBER='' and r.VENDORID between @VendorID_RS and @VendorID_RE and  P3.GLPOSTDT <= @CutoffDate and  r.PONUMBER >= @PONumber_RS and r.PONUMBER <=@PONumber_RE  group by r.PONUMBER,  r.POLNENUM,  r.POPRCTNM,  r.RCPTLNNM,  r.APPYTYPE,  r.POPTYPE,  r.CURNCYID,  r.VENDORID,  p.VENDNAME,  r.Status,  r.POPRCTNM ,  P3.receiptdate,  P3.GLPOSTDT,  r.TRXLOCTN,  r.UOFM,  r.QTYSHPPD,  r.QTYINVCD,  r.QTYRESERVED,  r.QTYINVRESERVE,  r.QTYREJ,  r.ITEMNMBR,  i.ITEMDESC ,  r.ORCPTCOST,  r.XCHGRATE,  r.RATECALC,  u.UMDPQTYS, P3.REPLACEGOODS,P3.INVOICEEXPECTED  update ##temp_HistreceivedNotinvoicedPostDt set [Qty Returned] = 0,  [Qty Inv Returned] = 0 where [APPYTYPE] = 1  update ##temp_HistreceivedNotinvoicedPostDt set [Qty Inv Returned] = 0 where POPTYPE = 4 and INVOICEEXPECTED = 1  update ##temp_HistreceivedNotinvoicedPostDt set [Qty Invoiced] = [Qty Returned] where POPTYPE = 4 and INVOICEEXPECTED = 0 and REPLACEGOODS = 0  update ##temp_HistreceivedNotinvoicedPostDt set [Qty Invoiced] = [Qty Returned] where POPTYPE = 4 and INVOICEEXPECTED = 0 and REPLACEGOODS = 1 end else begin   if @IncludeLandedCosts = 1  Begin  select c.PONUMBER_1, sum(c.[Total Cost]) as [Total Landed Cost]  into ##temp_landedcosttotalsTrx  from  (select isnull((select distinct a.PONUMBER from POP10500 a where a.POPRCTNM = b.POPRCTNM and a.RCPTLNNM = b.RCPTLNNM and a.PONUMBER <> ''),'') as PONUMBER_1,   a.VENDORID,   b.Total_Landed_Cost_Amount as [Total Cost]  from POP10500 a  join POP30700 b  on a.POPRCTNM = b.POPRCTNM  and a.RCPTLNNM = b.RCPTLNNM  and a.POLNENUM = b.LCLINENUMBER  join POP30300 d  on a.POPRCTNM = d.POPRCTNM  where  d.VENDORID between @VendorID_RS and @VendorID_RE and  d.receiptdate <= @CutoffDate and  a.PONUMBER between @PONumber_RS and @PONumber_RE and a.PONUMBER = '') c  group by c.PONUMBER_1  End  select   r.PONUMBER as [PO Number],  r.POLNENUM,  r.POPRCTNM as [POPRCTNM],  r.RCPTLNNM as [POPRCTLNNM],  r.APPYTYPE as [APPYTYPE],  r.POPTYPE as [POPTYPE],  r.CURNCYID as [Currency ID],  r.VENDORID as [Vendor ID],  p.VENDNAME as [Vendor Name],  p.DOCDATE as [Document Date],  r.ITEMNMBR as [Item Number],  i.ITEMDESC as [Item Description],  pol.QTYORDER as [Qty Ordered],  pol.UOFM as [UOM Ordered],   case when (@IncludeFunctionalCurrency = 0) then pol.UNITCOST  else case when (pol.XCHGRATE = 0) then pol.UNITCOST  else (case when (pol.RATECALC = 1) then (pol.UNITCOST/pol.XCHGRATE) else  pol.UNITCOST*pol.XCHGRATE   end) end end   as [PO Unit Cost],  r.POPRCTNM as [Receipt Number],  P3.receiptdate as [Date Received],  P3.GLPOSTDT as [Date Received Parameter],  r.TRXLOCTN as [Site ID],  r.UOFM as [Shipment UOM],  r.QTYSHPPD AS [Qty Shipped],  r.QTYINVCD as [Qty Invoiced],  r.QTYRESERVED as [Qty Returned],  r.QTYRESERVED as [Qty Inv Returned],  r.QTYREJ as QTYREJ,  case when (@IncludeFunctionalCurrency = 0) then r.ORCPTCOST  else case when (r.XCHGRATE = 0) then r.ORCPTCOST  else (case when (r.RATECALC = 1) then (r.ORCPTCOST/r.XCHGRATE) else  r.ORCPTCOST*r.XCHGRATE   end) end end   as [Unitcost],  u.UMDPQTYS -1 as [UOM Decimals],P3.REPLACEGOODS,P3.INVOICEEXPECTED   into ##temp_HistreceivedNotinvoicedTrxtDt   from POP10500 r   left join POP10100 p on   r.PONUMBER = p.PONUMBER   left JOIN POP10110 pol on   p.PONUMBER = pol.PONUMBER and  r.POLNENUM = pol.ORD   left join POP30300 P3 on   r.POPRCTNM = P3.POPRCTNM  left join IV00101 i on   pol.ITEMNMBR = i.ITEMNMBR  left join IV40201 u on   i.UOMSCHDL = u.UOMSCHDL   where r.VENDORID between @VendorID_RS and @VendorID_RE and  P3.receiptdate <= @CutoffDate and  r.PONUMBER >= @PONumber_RS and r.PONUMBER <=@PONumber_RE and  p.POTYPE <> 2 and   p.POSTATUS not in (5,6) and  pol.POLNESTA not in (5,6) and r.Status <>0 and r.POLNENUM<> ''   group by r.PONUMBER,r.POLNENUM, r.POPRCTNM, r.RCPTLNNM,r.APPYTYPE ,r.POPTYPE , r.CURNCYID, r.VENDORID, p.VENDNAME,  p.DOCDATE,r.Status,r.ITEMNMBR,i.ITEMDESC ,pol.QTYORDER,pol.UOFM,pol.UNITCOST,pol.XCHGRATE, pol.RATECALC,  r.ORCPTCOST,r.XCHGRATE,r.RATECALC,r.UOFM,P3.receiptdate,P3.GLPOSTDT,r.TRXLOCTN,r.QTYSHPPD,r.QTYINVCD,  r.QTYRESERVED,r.QTYINVRESERVE,r.QTYREJ,u.UMDPQTYS, P3.REPLACEGOODS,P3.INVOICEEXPECTED   union  select   '******' as [PO Number],  r.POLNENUM,  r.POPRCTNM as [POPRCTNM],  r.RCPTLNNM as [POPRCTLNNM],  r.APPYTYPE as [APPYTYPE],  r.POPTYPE as [POPTYPE],  r.CURNCYID as [Currency ID],  r.VENDORID as [Vendor ID],  p.VENDNAME as [Vendor Name],  '' as [Document Date],  r.ITEMNMBR as [Item Number],  i.ITEMDESC as [Item Description],  0 as [Qty Ordered],  '' as [UOM Ordered],   0 as [PO Unit Cost],  r.POPRCTNM as [Receipt Number],  P3.receiptdate as [Date Received],  P3.GLPOSTDT as [Date Received Parameter],  r.TRXLOCTN as [Site ID],  r.UOFM as [Shipment UOM],  r.QTYSHPPD AS [Qty Shipped],  r.QTYINVCD as [Qty Invoiced],  r.QTYRESERVED as [Qty Returned],  r.QTYRESERVED as [Qty Inv Returned],  r.QTYREJ as QTYREJ,  case when (@IncludeFunctionalCurrency = 0) then r.ORCPTCOST  else case when (r.XCHGRATE = 0) then r.ORCPTCOST  else (case when (r.RATECALC = 1) then (r.ORCPTCOST/r.XCHGRATE) else  r.ORCPTCOST*r.XCHGRATE  end) end end   as [Unitcost],  u.UMDPQTYS -1  as [UOM Decimals],P3.REPLACEGOODS,P3.INVOICEEXPECTED   from POP10500 r   left join   PM00200 p on  r.VENDORID = p.VENDORID   left join IV00101 i on r.ITEMNMBR = i.ITEMNMBR  left join IV40201 u on i.UOMSCHDL = u.UOMSCHDL  left join POP30300 P3 on r.POPRCTNM = P3.POPRCTNM   where r.Status <>0  and r.PONUMBER='' and r.VENDORID between @VendorID_RS and @VendorID_RE and  P3.receiptdate <= @CutoffDate and  r.PONUMBER >= @PONumber_RS and r.PONUMBER <=@PONumber_RE  group by r.PONUMBER,  r.POLNENUM,  r.POPRCTNM,  r.RCPTLNNM,  r.APPYTYPE,  r.POPTYPE,  r.CURNCYID,  r.VENDORID,  p.VENDNAME,  r.Status,  r.POPRCTNM ,  P3.receiptdate,  P3.GLPOSTDT,  r.TRXLOCTN,  r.UOFM,  r.QTYSHPPD,  r.QTYINVCD,  r.QTYRESERVED,  r.QTYINVRESERVE,  r.QTYREJ,  r.ITEMNMBR,  i.ITEMDESC ,  r.ORCPTCOST,  r.XCHGRATE,  r.RATECALC,  u.UMDPQTYS, P3.REPLACEGOODS,P3.INVOICEEXPECTED   update ##temp_HistreceivedNotinvoicedTrxtDt set [Qty Returned] = 0,  [Qty Inv Returned] = 0 where [APPYTYPE] = 1  update ##temp_HistreceivedNotinvoicedTrxtDt set [Qty Inv Returned] = 0 where POPTYPE = 4 and INVOICEEXPECTED = 1  update ##temp_HistreceivedNotinvoicedTrxtDt set [Qty Invoiced] = [Qty Returned] where POPTYPE = 4 and INVOICEEXPECTED = 0 and REPLACEGOODS = 0  update ##temp_HistreceivedNotinvoicedTrxtDt set [Qty Invoiced] = [Qty Returned] where POPTYPE = 4 and INVOICEEXPECTED = 0 and REPLACEGOODS = 1 end  if @PurchasingTransactionDate = 1  begin   select [PO Number] as PONUM,[POLNENUM],[Unitcost],((SUM([Qty Shipped]) - SUM([Qty Invoiced])) * [Unitcost]) as NotInv, ((SUM([Qty Shipped]) - SUM([Qty Invoiced]) - (SUM([Qty Returned]) - SUM([Qty Inv Returned]))) * [Unitcost]) as NotInvLessRet INTO ##temp_NotinvoicedAmtPostDt from ##temp_HistreceivedNotinvoicedPostDt group by [PO Number],[POLNENUM],[Unitcost]  select PONUM as PONUM ,sum(NotInv) as NotInv,sum(NotInvLessRet) as NotInvLessRet INTO ##temp_TotNotinvoicedAmtPostDt  from ##temp_NotinvoicedAmtPostDt group by PONUM  select @TotNotInv = sum(NotInv), @TotNotInvLessRet = SUM(NotInvLessRet) from ##temp_TotNotinvoicedAmtPostDt  if @IncludeLandedCosts = 1  select  @TotalRNILandedCost =  SUM([Total Landed Cost])  from ##temp_landedcosttotalsPostDt   else  select  @TotalRNILandedCost = 0  SELECT NotInv,NotInvLessRet,@TotNotInv as TotNotInv,@TotNotInvLessRet as TotNotInvLessRet,@TotalRNILandedCost as TotalRNILandedCost ,  [PO Number],  [Currency ID],  [APPYTYPE],  [POPTYPE],  Convert(char(10),[Document Date],101) as [Document Date],  [Vendor ID],  [Vendor Name],  [Item Number],  [Item Description],  [Qty Ordered],  [UOM Ordered],   [PO Unit Cost],  [Receipt Number],  [POPRCTLNNM],  Convert(char(10),[Date Received],101) as [Date Received],  [Date Received Parameter],  [Site ID],  [Shipment UOM],  [Qty Shipped],  [Qty Invoiced],  [Qty Returned],  [Qty Inv Returned],  QTYREJ,  [Unitcost],  [UOM Decimals],[REPLACEGOODS],[INVOICEEXPECTED]  from ##temp_HistreceivedNotinvoicedPostDt LEFT JOIN ##temp_TotNotinvoicedAmtPostDt on [PO Number] = PONUM  where ([Qty Shipped] > 0 or [Qty Invoiced]> 0 or [Qty Returned]> 0 or [Qty Inv Returned]> 0) and (NotInv > 0 OR NotInvLessRet > 0) order by case @SortBy when 1 then [PO Number] when 2 then [Vendor ID] end ,[Receipt Number],APPYTYPE, POPTYPE  end else  begin  select [PO Number] as PONUM,[POLNENUM],[Unitcost],((SUM([Qty Shipped]) - SUM([Qty Invoiced])) * [Unitcost]) as NotInv, ((SUM([Qty Shipped]) - SUM([Qty Invoiced]) - (SUM([Qty Returned]) - SUM([Qty Inv Returned]))) * [Unitcost]) as NotInvLessRet INTO ##temp_NotinvoicedAmtTrxDt from ##temp_HistreceivedNotinvoicedTrxtDt group by [PO Number],[POLNENUM],[Unitcost]  select PONUM as PONUM ,sum(NotInv) as NotInv,sum(NotInvLessRet) as NotInvLessRet INTO ##temp_TotNotinvoicedAmtTrxDt  from ##temp_NotinvoicedAmtTrxDt group by PONUM  select @TotNotInv = sum(NotInv), @TotNotInvLessRet = SUM(NotInvLessRet) from ##temp_TotNotinvoicedAmtTrxDt  if @IncludeLandedCosts = 1  select @TotalRNILandedCost = SUM([Total Landed Cost])  from ##temp_landedcosttotalsTrx   else  select @TotalRNILandedCost = 0  SELECT NotInv,NotInvLessRet,@TotNotInv as TotNotInv,@TotNotInvLessRet as TotNotInvLessRet,@TotalRNILandedCost as TotalRNILandedCost ,  [PO Number],  [Currency ID],  [APPYTYPE],  [POPTYPE],  Convert(char(10),[Document Date],101) as [Document Date],  [Vendor ID],  [Vendor Name],  [Item Number],  [Item Description],  [Qty Ordered],  [UOM Ordered],   [PO Unit Cost],  [Receipt Number],  [POPRCTLNNM],  Convert(char(10),[Date Received],101) as [Date Received],  [Date Received Parameter],  [Site ID],  [Shipment UOM],  [Qty Shipped],  [Qty Invoiced],  [Qty Returned],  [Qty Inv Returned],  QTYREJ,  [Unitcost],  [UOM Decimals],[REPLACEGOODS],[INVOICEEXPECTED]  from ##temp_HistreceivedNotinvoicedTrxtDt LEFT JOIN ##temp_TotNotinvoicedAmtTrxDt on [PO Number] =  PONUM  where ([Qty Shipped] > 0 or [Qty Invoiced]> 0 or [Qty Returned]> 0 or [Qty Inv Returned]> 0) and (NotInv > 0 OR NotInvLessRet > 0) order by case @SortBy when 1 then [PO Number] when 2 then [Vendor ID] end ,[Receipt Number],APPYTYPE, POPTYPE  end    
GO
GRANT EXECUTE ON  [dbo].[seeHistReceivednotInvoiced] TO [DYNGRP]
GO
GRANT EXECUTE ON  [dbo].[seeHistReceivednotInvoiced] TO [rpt_power user]
GO
GRANT EXECUTE ON  [dbo].[seeHistReceivednotInvoiced] TO [rpt_purchasing agent]
GO
GRANT EXECUTE ON  [dbo].[seeHistReceivednotInvoiced] TO [rpt_purchasing manager]
GO
