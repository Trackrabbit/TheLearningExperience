SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[seeuprSRSLoadTempXCmpyPayrollSummary]   @IN_CompanyID char(5),   @IN_sDept char(6),   @IN_eDept char(6),   @IN_sPosition char(6),   @IN_ePosition char(6),   @IN_sEmpID char(15),   @IN_eEmpID char(15),   @IN_sEmpClassID char(15),   @IN_eEmpClassID char(15),   @IN_sDate datetime,   @IN_eDate datetime,   @IN_RangeSelect smallint,   @IN_ReportType smallint   AS  declare @IN_CompanyName char(50), @IN_TRXNumber char(50), @IN_TRXDescription char(50), @IN_sYear int, @IN_eYear int declare @sPosition char(6), @ePosition char(6)  CREATE TABLE [dbo].[#uprXCoEm](  [CMPNYNAM] [char](65) NOT NULL,  [PYRLRTYP] [smallint] NOT NULL,  [PAYROLCD] [char](7) NOT NULL,  [EMPLOYID] [char](15) NOT NULL,  [LASTNAME] [char](21) NOT NULL,  [FRSTNAME] [char](15) NOT NULL,  [MIDLNAME] [char](15) NOT NULL,  [PYRLDSCR] [char](33) NOT NULL,  [MTDTXBWG] [numeric](19, 5) NOT NULL,  [MNTHHRS] [numeric](19, 5) NOT NULL,  [MNTHSWGS] [numeric](19, 5) NOT NULL,  [MNTHSTTL] [numeric](19, 5) NOT NULL,  [FLAG] [char](1) NOT NULL,  [MONTHTAX] [numeric](19, 5) NOT NULL,  [QTDHOURS] [numeric](19, 5) NOT NULL,  [QTDWAGES] [numeric](19, 5) NOT NULL,  [QTDTXWGS] [numeric](19, 5) NOT NULL,  [QTDTAX] [numeric](19, 5) NOT NULL,  [QTDTOTAL] [numeric](19, 5) NOT NULL,  [YTDHOURS] [int] NOT NULL,  [YTDWAGES] [numeric](19, 5) NOT NULL,  [YTDTXWGS] [numeric](19, 5) NOT NULL,  [YTDTAX] [numeric](19, 5) NOT NULL,  [YTDTOTAL] [numeric](19, 5) NOT NULL,  [DEX_ROW_ID] [int] IDENTITY(1,1) NOT NULL ) ON [PRIMARY]  CREATE UNIQUE NONCLUSTERED INDEX [PK#uprXCoEm] ON [dbo].[#uprXCoEm] (  [CMPNYNAM] ASC,  [PYRLRTYP] ASC,  [PAYROLCD] ASC ) ON [PRIMARY]  select @IN_CompanyName = CMPNYNAM from DYNAMICS..SY01500 where INTERID = @IN_CompanyID select @IN_TRXNumber = 1 select @IN_sYear = datepart(yyyy,@IN_sDate) select @IN_eYear = datepart(yyyy,@IN_eDate) if( @IN_sPosition > @IN_ePosition) begin  select @sPosition = @IN_ePosition  select @ePosition = @IN_sPosition end else begin  select @sPosition = @IN_sPosition  select @ePosition = @IN_ePosition end  while @IN_TRXNumber <= 26 begin   if @IN_TRXNumber = 1 begin select @IN_TRXDescription = 'Gross Wages' end  if @IN_TRXNumber = 2 begin select @IN_TRXDescription = 'Federal Wages' end  if @IN_TRXNumber = 3 begin select @IN_TRXDescription = 'Advanced EIC Payments' end  if @IN_TRXNumber = 4 begin select @IN_TRXDescription = 'Federal Taxes Withheld' end  if @IN_TRXNumber = 5 begin select @IN_TRXDescription = 'FICA Soc Sec Wages' end  if @IN_TRXNumber = 6 begin select @IN_TRXDescription = 'FICA Soc Sec Withheld' end  if @IN_TRXNumber = 7 begin select @IN_TRXDescription = 'FICA Medicare Wages' end  if @IN_TRXNumber = 8 begin select @IN_TRXDescription = 'FICA Medicare Withheld' end  if @IN_TRXNumber = 9 begin select @IN_TRXDescription = 'Net Wages' end  if @IN_TRXNumber = 10 begin select @IN_TRXDescription = 'Charged Tips' end  if @IN_TRXNumber = 11 begin select @IN_TRXDescription = 'Reported Tips' end  if @IN_TRXNumber = 12 begin select @IN_TRXDescription = 'Federal Tax/Tips Withheld' end  if @IN_TRXNumber = 13 begin select @IN_TRXDescription = 'FICA Soc Sec Tips' end  if @IN_TRXNumber = 14 begin select @IN_TRXDescription = 'FICA Soc Sec Tax/Tips Withheld' end  if @IN_TRXNumber = 15 begin select @IN_TRXDescription = 'Uncollected FICA Soc Sec Tax' end  if @IN_TRXNumber = 16 begin select @IN_TRXDescription = 'FICA Medicare Tips' end  if @IN_TRXNumber = 17 begin select @IN_TRXDescription = 'FICA Medicare Tax/Tips Withheld' end  if @IN_TRXNumber = 18 begin select @IN_TRXDescription = 'Uncollected FICA Medicare Tax' end  if @IN_TRXNumber = 19 begin select @IN_TRXDescription = 'Charged Receipts' end  if @IN_TRXNumber = 20 begin select @IN_TRXDescription = 'Reported Receipts' end  if @IN_TRXNumber = 21 begin select @IN_TRXDescription = 'Allocated Tips' end  if @IN_TRXNumber = 22 begin select @IN_TRXDescription = 'Federal Tips' end  if @IN_TRXNumber = 23 begin select @IN_TRXDescription = 'Employer FICA Soc Sec Tax' end  if @IN_TRXNumber = 24 begin select @IN_TRXDescription = 'EFIC Soc Sec Tax on Tips' end  if @IN_TRXNumber = 25 begin select @IN_TRXDescription = 'Employer FICA Medicare Tax' end  if @IN_TRXNumber = 26 begin select @IN_TRXDescription = 'EFIC Medicare Tax on Tips' end  exec uprLoadTempXCmpyPayrollSummary   '#uprXCoEm',   @IN_CompanyName,   @IN_CompanyID,   @IN_TRXNumber,   @IN_TRXDescription,   @IN_sYear,   @IN_eYear,   @IN_sDept,   @IN_eDept,   @sPosition,   @ePosition,   @IN_sEmpID,   @IN_eEmpID,   @IN_sEmpClassID,   @IN_eEmpClassID,   @IN_sDate,   @IN_eDate,   @IN_RangeSelect,   @IN_ReportType   select @IN_TRXNumber = @IN_TRXNumber + 1  end  select * from #uprXCoEm   
GO
GRANT EXECUTE ON  [dbo].[seeuprSRSLoadTempXCmpyPayrollSummary] TO [DYNGRP]
GO
GRANT EXECUTE ON  [dbo].[seeuprSRSLoadTempXCmpyPayrollSummary] TO [rpt_payroll]
GO
GRANT EXECUTE ON  [dbo].[seeuprSRSLoadTempXCmpyPayrollSummary] TO [rpt_power user]
GO
