SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_VAT10302F_1] (@SERIES_RS smallint, @DOCTYPE_RS smallint, @DOCNUMBR_RS char(21), @SQNCLINE_RS numeric(19,5), @SERIES_RE smallint, @DOCTYPE_RE smallint, @DOCNUMBR_RE char(21), @SQNCLINE_RE numeric(19,5)) AS  set nocount on IF @SERIES_RS IS NULL BEGIN SELECT TOP 25  SERIES, DOCTYPE, DOCNUMBR, SQNCLINE, CUSTNMBR, CCode, TXRGNNUM, TCC, NUMASS, QUANTITY, LMASS, TMCODE, TRANSNATURE, SUPPUNITS, TRADREF, GOODSVALUE, TAXAMNT, NOTEINDX, DOCDATE, Tax_Date, Reference_Date, POSTED, VOIDSTTS, ORGDSVAL, ORTAXAMT, CURRNIDX, ITEMNMBR, ITEMDESC, PRT, RGN, CNTRYORGN, PRCDRRGM, INCTRMS, STTSTCLVL, ORGNTNGSTTSTCLVL, Included_On_Return, INTRSTTRTRNID, DECLID, LOCNCODE, ARRDISP, PERIOD, AUDITTRAIL, DEX_ROW_ID FROM .VAT10302 ORDER BY SERIES ASC, DOCTYPE ASC, DOCNUMBR ASC, SQNCLINE ASC END ELSE IF @SERIES_RS = @SERIES_RE BEGIN SELECT TOP 25  SERIES, DOCTYPE, DOCNUMBR, SQNCLINE, CUSTNMBR, CCode, TXRGNNUM, TCC, NUMASS, QUANTITY, LMASS, TMCODE, TRANSNATURE, SUPPUNITS, TRADREF, GOODSVALUE, TAXAMNT, NOTEINDX, DOCDATE, Tax_Date, Reference_Date, POSTED, VOIDSTTS, ORGDSVAL, ORTAXAMT, CURRNIDX, ITEMNMBR, ITEMDESC, PRT, RGN, CNTRYORGN, PRCDRRGM, INCTRMS, STTSTCLVL, ORGNTNGSTTSTCLVL, Included_On_Return, INTRSTTRTRNID, DECLID, LOCNCODE, ARRDISP, PERIOD, AUDITTRAIL, DEX_ROW_ID FROM .VAT10302 WHERE SERIES = @SERIES_RS AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND DOCNUMBR BETWEEN @DOCNUMBR_RS AND @DOCNUMBR_RE AND SQNCLINE BETWEEN @SQNCLINE_RS AND @SQNCLINE_RE ORDER BY SERIES ASC, DOCTYPE ASC, DOCNUMBR ASC, SQNCLINE ASC END ELSE BEGIN SELECT TOP 25  SERIES, DOCTYPE, DOCNUMBR, SQNCLINE, CUSTNMBR, CCode, TXRGNNUM, TCC, NUMASS, QUANTITY, LMASS, TMCODE, TRANSNATURE, SUPPUNITS, TRADREF, GOODSVALUE, TAXAMNT, NOTEINDX, DOCDATE, Tax_Date, Reference_Date, POSTED, VOIDSTTS, ORGDSVAL, ORTAXAMT, CURRNIDX, ITEMNMBR, ITEMDESC, PRT, RGN, CNTRYORGN, PRCDRRGM, INCTRMS, STTSTCLVL, ORGNTNGSTTSTCLVL, Included_On_Return, INTRSTTRTRNID, DECLID, LOCNCODE, ARRDISP, PERIOD, AUDITTRAIL, DEX_ROW_ID FROM .VAT10302 WHERE SERIES BETWEEN @SERIES_RS AND @SERIES_RE AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND DOCNUMBR BETWEEN @DOCNUMBR_RS AND @DOCNUMBR_RE AND SQNCLINE BETWEEN @SQNCLINE_RS AND @SQNCLINE_RE ORDER BY SERIES ASC, DOCTYPE ASC, DOCNUMBR ASC, SQNCLINE ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_VAT10302F_1] TO [DYNGRP]
GO
