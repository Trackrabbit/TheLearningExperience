SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_Dynamics_ReceivingsLineItems] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @POP_Receipt_Number varchar(255), @POP_Type varchar(255), @Receipt_Line_Number varchar(255), @PO_Number varchar(255), @Item_Number varchar(255), @Item_Description varchar(255), @QTY_Shipped varchar(255), @QTY_Invoiced varchar(255), @QTY_Rejected varchar(255), @Landed_Cost_Group_ID varchar(255), @Landed_Cost varchar(255), @Receipt_Return_Number varchar(255), @Invoice_Return_Number varchar(255), @Total_Landed_Cost varchar(255), @QTY_Reserved varchar(255), @QTY_Invoice_Reserve varchar(255), @Vendor_Item_Description varchar(255), @U_Of_M_QTY_In_Base varchar(255), @Actual_Ship_Date varchar(255), @Comment_ID varchar(255), @Inventory_Index varchar(255), @U_Of_M varchar(255), @Unit_Cost varchar(255), @Extended_Cost varchar(255), @Location_Code varchar(255), @Non_IV varchar(255), @Decimal_Places_Currency varchar(255), @Decimal_Places_QTYS varchar(255), @Item_Tracking_Option varchar(255), @TRX_Source varchar(255), @Job_Number varchar(255), @Cost_Code varchar(255), @Cost_Code_Type varchar(255), @Currency_Index varchar(255), @Originating_Unit_Cost varchar(255), @Originating_Extended_Cost varchar(255), @Originating_Decimal_Places_Currency varchar(255), @BOL_PRO_Number varchar(255), @Capital_Item varchar(255), @Product_Indicator varchar(255), @Purchase_IV_Item_Taxable varchar(255), @Purchase_Item_Tax_Schedule_ID varchar(255), @Purchase_Site_Tax_Schedule_ID varchar(255), @Based_On_Invoice_Total varchar(255), @Tax_Amount varchar(255), @Originating_Tax_Amount varchar(255), @Purchase_Price_Variance_Index varchar(255), @Posting_Status varchar(255), @Vendor_Document_Number varchar(255), @Receipt_Date varchar(255), @GL_Posting_Date varchar(255), @Batch_Source varchar(255), @Batch_Number varchar(255), @Vendor_ID varchar(255), @Vendor_Name varchar(255), @Posted_Date varchar(255), @Posted_User_ID varchar(255), @User_To_Enter varchar(255), @Created_Date varchar(255), @Modified_Date varchar(255), @Tax_Date varchar(255), @Currency_ID varchar(255), @Exchange_Rate varchar(255), @Rate_Calc_Method varchar(255), @Denomination_Exchange_Rate varchar(255), @QTY_Matched varchar(255), @Project_Number varchar(255), @Cost_Category_ID varchar(255), @PO_Line_Number varchar(255), @DrillBack_Base_Url varchar(255), @Vendor_ID_For_DrillBack varchar(255), @Item_Number_For_DrillBack varchar(255), @PO_Number_For_DrillBack varchar(255)  select @DrillBack_Base_Url = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),0)  select @I_iDictID = 1493 select @I_iMessageNumber = 29550 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @POP_Receipt_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 29381 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @POP_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 29551 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receipt_Line_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 29552 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @PO_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 29553 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 29554 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Description output  select @I_iDictID = 1493 select @I_iMessageNumber = 29600 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY_Shipped output  select @I_iDictID = 1493 select @I_iMessageNumber = 29601 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY_Invoiced output  select @I_iDictID = 1493 select @I_iMessageNumber = 29602 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY_Rejected output  select @I_iDictID = 1493 select @I_iMessageNumber = 29604 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Landed_Cost_Group_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 29605 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Landed_Cost output  select @I_iDictID = 1493 select @I_iMessageNumber = 29606 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receipt_Return_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 29607 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Invoice_Return_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 29609 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Total_Landed_Cost output  select @I_iDictID = 1493 select @I_iMessageNumber = 29610 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY_Reserved output  select @I_iDictID = 1493 select @I_iMessageNumber = 29611 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY_Invoice_Reserve output  select @I_iDictID = 1493 select @I_iMessageNumber = 29556 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vendor_Item_Description output  select @I_iDictID = 1493 select @I_iMessageNumber = 29557 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @U_Of_M_QTY_In_Base output  select @I_iDictID = 1493 select @I_iMessageNumber = 29558 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Actual_Ship_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 29559 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Comment_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 29560 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Index output  select @I_iDictID = 1493 select @I_iMessageNumber = 29561 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @U_Of_M output  select @I_iDictID = 1493 select @I_iMessageNumber = 29562 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Unit_Cost output  select @I_iDictID = 1493 select @I_iMessageNumber = 29563 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Extended_Cost output  select @I_iDictID = 1493 select @I_iMessageNumber = 29564 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Location_Code output  select @I_iDictID = 1493 select @I_iMessageNumber = 29565 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Non_IV output  select @I_iDictID = 1493 select @I_iMessageNumber = 29566 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Decimal_Places_Currency output  select @I_iDictID = 1493 select @I_iMessageNumber = 29567 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Decimal_Places_QTYS output  select @I_iDictID = 1493 select @I_iMessageNumber = 29568 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Tracking_Option output  select @I_iDictID = 1493 select @I_iMessageNumber = 29569 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TRX_Source output  select @I_iDictID = 1493 select @I_iMessageNumber = 29570 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Job_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 29571 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Cost_Code output  select @I_iDictID = 1493 select @I_iMessageNumber = 29572 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Cost_Code_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 29574 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Currency_Index output  select @I_iDictID = 1493 select @I_iMessageNumber = 29578 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Unit_Cost output  select @I_iDictID = 1493 select @I_iMessageNumber = 29579 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Extended_Cost output  select @I_iDictID = 1493 select @I_iMessageNumber = 29580 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Decimal_Places_Currency output  select @I_iDictID = 1493 select @I_iMessageNumber = 29581 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @BOL_PRO_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 29582 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Capital_Item output  select @I_iDictID = 1493 select @I_iMessageNumber = 29583 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Product_Indicator output  select @I_iDictID = 1493 select @I_iMessageNumber = 29584 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purchase_IV_Item_Taxable output  select @I_iDictID = 1493 select @I_iMessageNumber = 29585 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purchase_Item_Tax_Schedule_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 29586 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purchase_Site_Tax_Schedule_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 29587 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Based_On_Invoice_Total output  select @I_iDictID = 1493 select @I_iMessageNumber = 29588 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tax_Amount output  select @I_iDictID = 1493 select @I_iMessageNumber = 29589 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Tax_Amount output  select @I_iDictID = 1493 select @I_iMessageNumber = 29593 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purchase_Price_Variance_Index output  select @I_iDictID = 1493 select @I_iMessageNumber = 29594 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Posting_Status output  select @I_iDictID = 1493 select @I_iMessageNumber = 29382 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vendor_Document_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 29383 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Receipt_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 29384 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @GL_Posting_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 29386 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Batch_Source output  select @I_iDictID = 1493 select @I_iMessageNumber = 29387 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Batch_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 29388 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vendor_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 29389 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vendor_Name output  select @I_iDictID = 1493 select @I_iMessageNumber = 29408 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Posted_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 29409 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Posted_User_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 29410 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_To_Enter output  select @I_iDictID = 1493 select @I_iMessageNumber = 29411 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Created_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 29412 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Modified_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 29415 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tax_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 29416 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Currency_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 29420 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Rate output  select @I_iDictID = 1493 select @I_iMessageNumber = 29423 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Rate_Calc_Method output  select @I_iDictID = 1493 select @I_iMessageNumber = 29424 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Denomination_Exchange_Rate output  select @I_iDictID = 1493 select @I_iMessageNumber = 29596 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY_Matched output  select @I_iDictID = 1493 select @I_iMessageNumber = 29597 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Project_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 29598 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Cost_Category_ID output  select @I_iDictID = 0 select @I_iMessageNumber = 22055 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @PO_Line_Number output   select @I_iDictID = 1493 select @I_iMessageNumber = 29388 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vendor_ID_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 29553 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 29552 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @PO_Number_For_DrillBack output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[ReceivingsLineItems]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[ReceivingsLineItems] '  select @sqldefaultstring =   'CREATE VIEW ReceivingsLineItems AS ' +   'select ' +   'rtrim([''Purchasing Receipt Line''].[POPRCTNM]) as ''' + @POP_Receipt_Number + ''', ' + '''' + @POP_Type + ''' = dbo.DYN_FUNC_POP_Type([''Purchasing Receipt Work''].[POPTYPE]), ' + 'rtrim([''Purchasing Receipt Line''].[ITEMNMBR]) as ''' + @Item_Number + ''', ' + 'rtrim([''Purchasing Receipt Line''].[ITEMDESC]) as ''' + @Item_Description + ''', ' + '[''Purchasing Receipt Line Quantities''].[QTYSHPPD] as ''' + @QTY_Shipped + ''', ' + '[''Purchasing Receipt Line Quantities''].[QTYINVCD] as ''' + @QTY_Invoiced + ''', ' + '[''Purchasing Receipt Line''].[UNITCOST] as ''' + @Unit_Cost + ''', ' + '[''Purchasing Receipt Line''].[EXTDCOST] as ''' + @Extended_Cost + ''', ' + 'rtrim([''Purchasing Receipt Work''].[VENDORID]) as ''' + @Vendor_ID + ''', ' + 'rtrim([''Purchasing Receipt Work''].[VENDNAME]) as ''' + @Vendor_Name + ''', '   select @sqlstring1 =   '[''Purchasing Receipt Line''].[ACTLSHIP] as ''' + @Actual_Ship_Date + ''', ' +  'rtrim([''Purchasing Receipt Line''].[BOLPRONUMBER]) as ''' + @BOL_PRO_Number + ''', ' +  '''' + @Based_On_Invoice_Total + ''' = dbo.DYN_FUNC_Boolean_All([''Purchasing Receipt Line''].[BSIVCTTL]), ' +  'rtrim([''Purchasing Receipt Work''].[BACHNUMB]) as ''' + @Batch_Number + ''', ' +  'rtrim([''Purchasing Receipt Work''].[BCHSOURC]) as ''' + @Batch_Source + ''', ' +  '''' + @Capital_Item + ''' = dbo.DYN_FUNC_Boolean_All([''Purchasing Receipt Line''].[Capital_Item]), ' +  'rtrim([''Purchasing Receipt Line''].[COMMNTID]) as ''' + @Comment_ID + ''', ' +  'rtrim([''Purchasing Receipt Line''].[CostCatID]) as ''' + @Cost_Category_ID + ''', ' +  'rtrim([''Purchasing Receipt Line''].[COSTCODE]) as ''' + @Cost_Code + ''', ' +  '[''Purchasing Receipt Line''].[COSTTYPE] as ''' + @Cost_Code_Type + ''', ' +  '[''Purchasing Receipt Work''].[CREATDDT] as ''' + @Created_Date + ''', ' +  'rtrim([''Purchasing Receipt Work''].[CURNCYID]) as ''' + @Currency_ID + ''', ' +  '[''Purchasing Receipt Line''].[CURRNIDX] as ''' + @Currency_Index + ''', ' +  '''' + @Decimal_Places_Currency + ''' = dbo.DYN_FUNC_Decimal_Places_Currency([''Purchasing Receipt Line''].[DECPLCUR]), ' +  '''' + @Decimal_Places_QTYS + ''' = dbo.DYN_FUNC_Decimal_Places_QTYS([''Purchasing Receipt Line''].[DECPLQTY]), ' +  '[''Purchasing Receipt Line''].[DENXRATE] as ''' + @Denomination_Exchange_Rate + ''', ' +  '[''Purchasing Receipt Work''].[XCHGRATE] as ''' + @Exchange_Rate + ''', ' +  '[''Purchasing Receipt Work''].[GLPOSTDT] as ''' + @GL_Posting_Date + ''', ' +  '[''Purchasing Receipt Line''].[INVINDX] as ''' + @Inventory_Index + ''', ' +  'rtrim([''Purchasing Receipt Line''].[INVRETNUM]) as ''' + @Invoice_Return_Number + ''', ' +  '''' + @Item_Tracking_Option + ''' = dbo.DYN_FUNC_Item_Tracking_Option([''Purchasing Receipt Line''].[ITMTRKOP]), ' +  'rtrim([''Purchasing Receipt Line''].[JOBNUMBR]) as ''' + @Job_Number + ''', ' +  '''' + @Landed_Cost + ''' = dbo.DYN_FUNC_Boolean_All([''Purchasing Receipt Line''].[Landed_Cost]), ' +  'rtrim([''Purchasing Receipt Line''].[Landed_Cost_Group_ID]) as ''' + @Landed_Cost_Group_ID + ''', ' +  'rtrim([''Purchasing Receipt Line''].[LOCNCODE]) as ''' + @Location_Code + ''', ' +  '[''Purchasing Receipt Work''].[MODIFDT] as ''' + @Modified_Date + ''', ' +  '[''Purchasing Receipt Line''].[NONINVEN] as ''' + @Non_IV + ''', ' +  '''' + @Originating_Decimal_Places_Currency + ''' = dbo.DYN_FUNC_Decimal_Places_Currency([''Purchasing Receipt Line''].[ODECPLCU]), ' +  '[''Purchasing Receipt Line''].[OREXTCST] as ''' + @Originating_Extended_Cost + ''', ' +  '[''Purchasing Receipt Line''].[ORTAXAMT] as ''' + @Originating_Tax_Amount + ''', ' +  '[''Purchasing Receipt Line''].[ORUNTCST] as ''' + @Originating_Unit_Cost + ''', ' +  'rtrim([''Purchasing Receipt Line''].[PONUMBER]) as ''' + @PO_Number + ''', ' +  '[''Purchasing Receipt Work''].[POSTEDDT] as ''' + @Posted_Date + ''', ' +  'rtrim([''Purchasing Receipt Work''].[PTDUSRID]) as ''' + @Posted_User_ID + ''', ' +  '''' + @Posting_Status + ''' = dbo.DYN_FUNC_Posting_Status_POP_Receipt_Lines(1), ' +  '[''Purchasing Receipt Line''].[Product_Indicator] as ''' + @Product_Indicator + ''', ' +  'rtrim([''Purchasing Receipt Line''].[ProjNum]) as ''' + @Project_Number + ''', ' +  '[''Purchasing Receipt Line''].[Purchase_IV_Item_Taxable] as ''' + @Purchase_IV_Item_Taxable + ''', ' +  'rtrim([''Purchasing Receipt Line''].[Purchase_Item_Tax_Schedu]) as ''' + @Purchase_Item_Tax_Schedule_ID + ''', ' +  '[''Purchasing Receipt Line''].[PURPVIDX] as ''' + @Purchase_Price_Variance_Index + ''', ' +  'rtrim([''Purchasing Receipt Line''].[Purchase_Site_Tax_Schedu]) as ''' + @Purchase_Site_Tax_Schedule_ID + ''', ' +  '[''Purchasing Receipt Line Quantities''].[QTYINVRESERVE] as ''' + @QTY_Invoice_Reserve + ''', ' +  '[''Purchasing Receipt Line Quantities''].[QTYMATCH] as ''' + @QTY_Matched + ''', ' +  '[''Purchasing Receipt Line Quantities''].[QTYREJ] as ''' + @QTY_Rejected + ''', ' +  '[''Purchasing Receipt Line Quantities''].[QTYRESERVED] as ''' + @QTY_Reserved + ''', ' +  '''' + @Rate_Calc_Method + ''' = dbo.DYN_FUNC_Rate_Calc_Method_POP_Receipts([''Purchasing Receipt Work''].[RATECALC]), ' +  '[''Purchasing Receipt Work''].[receiptdate] as ''' + @Receipt_Date + ''', ' +  '[''Purchasing Receipt Line''].[RCPTLNNM] as ''' + @Receipt_Line_Number + ''', ' +  'rtrim([''Purchasing Receipt Line''].[RCPTRETNUM]) as ''' + @Receipt_Return_Number + ''', ' +  'rtrim([''Purchasing Receipt Work''].[TRXSORCE]) as ''' + @TRX_Source + ''', ' +  '[''Purchasing Receipt Line''].[TAXAMNT] as ''' + @Tax_Amount + ''', ' +  '[''Purchasing Receipt Work''].[Tax_Date] as ''' + @Tax_Date + ''', ' +  '[''Purchasing Receipt Work''].[Total_Landed_Cost_Amount] as ''' + @Total_Landed_Cost + ''', ' +  'rtrim([''Purchasing Receipt Line''].[UOFM]) as ''' + @U_Of_M + ''', ' +  '[''Purchasing Receipt Line''].[UMQTYINB] as ''' + @U_Of_M_QTY_In_Base + ''', ' +  'rtrim([''Purchasing Receipt Work''].[USER2ENT]) as ''' + @User_To_Enter + ''', ' +  'rtrim([''Purchasing Receipt Work''].[VNDDOCNM]) as ''' + @Vendor_Document_Number + ''', ' +  'rtrim([''Purchasing Receipt Line''].[VNDITDSC]) as ''' + @Vendor_Item_Description + ''', ' + '[''Purchasing Receipt Line Quantities Table''].[POLNENUM] as ''' + @PO_Line_Number + ''', '  select @sqlstring2 = '''' + @Item_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppItemID(1,[''Purchasing Receipt Line''].[ITEMNMBR],[''Purchasing Receipt Line''].[LOCNCODE] ), '+ '''' + @PO_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url +   ''' +dbo.dgppPurchaseOrder(1,2,1,[''Purchasing Receipt Work''].[POPTYPE],0, [''Purchasing Receipt Work''].[VENDORID],[''Purchasing Receipt Line''].[PONUMBER], '''',[''Purchasing Receipt Line''].[POPRCTNM],[''Purchasing Receipt Line''].[POPRCTNM],'''','''' ), '+ '''' + @Vendor_ID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppVendorID(1,[''Purchasing Receipt Work''].[VENDORID] ) '  select @sqlstring3 =   'from [POP10310] as [''Purchasing Receipt Line''] with (NOLOCK) '   + 'left outer join [POP10300] as [''Purchasing Receipt Work''] with (NOLOCK) on '   + '[''Purchasing Receipt Line''].[POPRCTNM] = [''Purchasing Receipt Work''].[POPRCTNM] '   + 'left outer join [ASIV0001] as [''Purchasing Receipt Line Quantities''] with (NOLOCK) on '   + '[''Purchasing Receipt Line''].[POPRCTNM] = [''Purchasing Receipt Line Quantities''].[POPRCTNM] '   + ' and [''Purchasing Receipt Line''].[RCPTLNNM] = [''Purchasing Receipt Line Quantities''].[RCPTLNNM] '   + 'left outer join [POP10500] as [''Purchasing Receipt Line Quantities Table''] with (NOLOCK) on '   + '[''Purchasing Receipt Line''].[POPRCTNM] = [''Purchasing Receipt Line Quantities Table''].[POPRCTNM] '   + ' and [''Purchasing Receipt Line''].[RCPTLNNM] = [''Purchasing Receipt Line Quantities Table''].[RCPTLNNM] '   + 'left outer join [IV00101] as [''Item Master''] with (NOLOCK) on '   + '[''Purchasing Receipt Line''].[ITEMNMBR] = [''Item Master''].[ITEMNMBR] '   select @sqlstring4 =   'union all ' +  'select ' +   'rtrim([''Purchasing Receipt Line History''].[POPRCTNM]) as ''' + @POP_Receipt_Number + ''', ' + '''' + @POP_Type + ''' = dbo.DYN_FUNC_POP_Type([''Purchasing Receipt History''].[POPTYPE]), ' + 'rtrim([''Purchasing Receipt Line History''].[ITEMNMBR]) as ''' + @Item_Number + ''', ' + 'rtrim([''Purchasing Receipt Line History''].[ITEMDESC]) as ''' + @Item_Description + ''', ' + '[''Purchasing Receipt Line Quantities''].[QTYSHPPD] as ''' + @QTY_Shipped + ''', ' + '[''Purchasing Receipt Line Quantities''].[QTYINVCD] as ''' + @QTY_Invoiced + ''', ' + '[''Purchasing Receipt Line History''].[UNITCOST] as ''' + @Unit_Cost + ''', ' + '[''Purchasing Receipt Line History''].[EXTDCOST] as ''' + @Extended_Cost + ''', ' + 'rtrim([''Purchasing Receipt History''].[VENDORID]) as ''' + @Vendor_ID + ''', ' + 'rtrim([''Purchasing Receipt History''].[VENDNAME]) as ''' + @Vendor_Name + ''', '   select @sqlstring5 =   '[''Purchasing Receipt Line History''].[ACTLSHIP] as ''' + @Actual_Ship_Date + ''', ' +  'rtrim([''Purchasing Receipt Line History''].[BOLPRONUMBER]) as ''' + @BOL_PRO_Number + ''', ' +  '''' + @Based_On_Invoice_Total + ''' = dbo.DYN_FUNC_Boolean_All([''Purchasing Receipt Line History''].[BSIVCTTL]), ' +  'rtrim([''Purchasing Receipt History''].[BACHNUMB]) as ''' + @Batch_Number + ''', ' +  'rtrim([''Purchasing Receipt History''].[BCHSOURC]) as ''' + @Batch_Source + ''', ' +  '''' + @Capital_Item + ''' = dbo.DYN_FUNC_Boolean_All([''Purchasing Receipt Line History''].[Capital_Item]), ' +  'rtrim([''Purchasing Receipt Line History''].[COMMNTID]) as ''' + @Comment_ID + ''', ' +  'rtrim([''Purchasing Receipt Line History''].[CostCatID]) as ''' + @Cost_Category_ID + ''', ' +  'rtrim([''Purchasing Receipt Line History''].[COSTCODE]) as ''' + @Cost_Code + ''', ' +  '[''Purchasing Receipt Line History''].[COSTTYPE] as ''' + @Cost_Code_Type + ''', ' +  '[''Purchasing Receipt History''].[CREATDDT] as ''' + @Created_Date + ''', ' +  'rtrim([''Purchasing Receipt History''].[CURNCYID]) as ''' + @Currency_ID + ''', ' +  '[''Purchasing Receipt Line History''].[CURRNIDX] as ''' + @Currency_Index + ''', ' +  '''' + @Decimal_Places_Currency + ''' = dbo.DYN_FUNC_Decimal_Places_Currency([''Purchasing Receipt Line History''].[DECPLCUR]), ' +  '''' + @Decimal_Places_QTYS + ''' = dbo.DYN_FUNC_Decimal_Places_QTYS([''Purchasing Receipt Line History''].[DECPLQTY]), ' +  'NULL  as ''' + @Denomination_Exchange_Rate + ''', ' +  '[''Purchasing Receipt History''].[XCHGRATE] as ''' + @Exchange_Rate + ''', ' +  '[''Purchasing Receipt History''].[GLPOSTDT] as ''' + @GL_Posting_Date + ''', ' +  '[''Purchasing Receipt Line History''].[INVINDX] as ''' + @Inventory_Index + ''', ' +  'rtrim([''Purchasing Receipt Line History''].[INVRETNUM]) as ''' + @Invoice_Return_Number + ''', ' +  '''' + @Item_Tracking_Option + ''' = dbo.DYN_FUNC_Item_Tracking_Option([''Purchasing Receipt Line History''].[ITMTRKOP]), ' +  'rtrim([''Purchasing Receipt Line History''].[JOBNUMBR]) as ''' + @Job_Number + ''', ' +  '''' + @Landed_Cost + ''' = dbo.DYN_FUNC_Boolean_All([''Purchasing Receipt Line History''].[Landed_Cost]), ' +  'rtrim([''Purchasing Receipt Line History''].[Landed_Cost_Group_ID]) as ''' + @Landed_Cost_Group_ID + ''', ' +  'rtrim([''Purchasing Receipt Line History''].[LOCNCODE]) as ''' + @Location_Code + ''', ' +  '[''Purchasing Receipt History''].[MODIFDT] as ''' + @Modified_Date + ''', ' +  '[''Purchasing Receipt Line History''].[NONINVEN] as ''' + @Non_IV + ''', ' +  '''' + @Originating_Decimal_Places_Currency + ''' = dbo.DYN_FUNC_Decimal_Places_Currency([''Purchasing Receipt Line History''].[ODECPLCU]), ' +  '[''Purchasing Receipt Line History''].[OREXTCST] as ''' + @Originating_Extended_Cost + ''', ' +  '[''Purchasing Receipt Line History''].[ORTAXAMT] as ''' + @Originating_Tax_Amount + ''', ' +  '[''Purchasing Receipt Line History''].[ORUNTCST] as ''' + @Originating_Unit_Cost + ''', ' +  'rtrim([''Purchasing Receipt Line History''].[PONUMBER]) as ''' + @PO_Number + ''', ' +  '[''Purchasing Receipt History''].[POSTEDDT] as ''' + @Posted_Date + ''', ' +  'rtrim([''Purchasing Receipt History''].[PTDUSRID]) as ''' + @Posted_User_ID + ''', ' +  '''' + @Posting_Status + ''' = dbo.DYN_FUNC_Posting_Status_POP_Receipt_Lines(2), ' +  '[''Purchasing Receipt Line History''].[Product_Indicator] as ''' + @Product_Indicator + ''', ' +  'rtrim([''Purchasing Receipt Line History''].[ProjNum]) as ''' + @Project_Number + ''', ' +  '[''Purchasing Receipt Line History''].[Purchase_IV_Item_Taxable] as ''' + @Purchase_IV_Item_Taxable + ''', ' +  'rtrim([''Purchasing Receipt Line History''].[Purchase_Item_Tax_Schedu]) as ''' + @Purchase_Item_Tax_Schedule_ID + ''', ' +  '[''Purchasing Receipt Line History''].[PURPVIDX] as ''' + @Purchase_Price_Variance_Index + ''', ' +  'rtrim([''Purchasing Receipt Line History''].[Purchase_Site_Tax_Schedu]) as ''' + @Purchase_Site_Tax_Schedule_ID + ''', ' +  '[''Purchasing Receipt Line Quantities''].[QTYINVRESERVE] as ''' + @QTY_Invoice_Reserve + ''', ' +  '[''Purchasing Receipt Line Quantities''].[QTYMATCH] as ''' + @QTY_Matched + ''', ' +  '[''Purchasing Receipt Line Quantities''].[QTYREJ] as ''' + @QTY_Rejected + ''', ' +  '[''Purchasing Receipt Line Quantities''].[QTYRESERVED] as ''' + @QTY_Reserved + ''', ' +  '''' + @Rate_Calc_Method + ''' = dbo.DYN_FUNC_Rate_Calc_Method_POP_Receipts([''Purchasing Receipt History''].[RATECALC]), ' +  '[''Purchasing Receipt History''].[receiptdate] as ''' + @Receipt_Date + ''', ' +  '[''Purchasing Receipt Line History''].[RCPTLNNM] as ''' + @Receipt_Line_Number + ''', ' +  'rtrim([''Purchasing Receipt Line History''].[RCPTRETNUM]) as ''' + @Receipt_Return_Number + ''', ' +  'rtrim([''Purchasing Receipt History''].[TRXSORCE]) as ''' + @TRX_Source + ''', ' +  '[''Purchasing Receipt Line History''].[TAXAMNT] as ''' + @Tax_Amount + ''', ' +  '[''Purchasing Receipt History''].[Tax_Date] as ''' + @Tax_Date + ''', ' +  '[''Purchasing Receipt History''].[Total_Landed_Cost_Amount] as ''' + @Total_Landed_Cost + ''', ' +  'rtrim([''Purchasing Receipt Line History''].[UOFM]) as ''' + @U_Of_M + ''', ' +  '[''Purchasing Receipt Line History''].[UMQTYINB] as ''' + @U_Of_M_QTY_In_Base + ''', ' +  'rtrim([''Purchasing Receipt History''].[USER2ENT]) as ''' + @User_To_Enter + ''', ' +  'rtrim([''Purchasing Receipt History''].[VNDDOCNM]) as ''' + @Vendor_Document_Number + ''', ' +  'rtrim([''Purchasing Receipt Line History''].[VNDITDSC]) as ''' + @Vendor_Item_Description + ''', ' + '[''Purchasing Receipt Line Quantities Table''].[POLNENUM] as ''' + @PO_Line_Number + ''', '  select @sqlstring6 = '''' + @Item_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppItemID(1,[''Purchasing Receipt Line History''].[ITEMNMBR],[''Purchasing Receipt Line History''].[LOCNCODE] ), '+ '''' + @PO_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url +   ''' +dbo.dgppPurchaseOrder(1,2,3,[''Purchasing Receipt History''].[POPTYPE],0, [''Purchasing Receipt History''].[VENDORID],[''Purchasing Receipt Line History''].[PONUMBER], '''',[''Purchasing Receipt Line History''].[POPRCTNM],[''Purchasing Receipt Line History''].[POPRCTNM],'''','''' ), '+ '''' + @Vendor_ID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppVendorID(1,[''Purchasing Receipt History''].[VENDORID] ) '  select @sqljoinstring =   'from [POP30310] as [''Purchasing Receipt Line History''] with (NOLOCK) '   + 'left outer join [POP30300] as [''Purchasing Receipt History''] with (NOLOCK) on '   + '[''Purchasing Receipt Line History''].[POPRCTNM] = [''Purchasing Receipt History''].[POPRCTNM] '   + 'left outer join [ASIV0001] as [''Purchasing Receipt Line Quantities''] with (NOLOCK) on '   + '[''Purchasing Receipt Line History''].[POPRCTNM] = [''Purchasing Receipt Line Quantities''].[POPRCTNM] '   + ' and [''Purchasing Receipt Line History''].[RCPTLNNM] = [''Purchasing Receipt Line Quantities''].[RCPTLNNM] '   + 'left outer join [POP10500] as [''Purchasing Receipt Line Quantities Table''] with (NOLOCK) on '   + '[''Purchasing Receipt Line History''].[POPRCTNM] = [''Purchasing Receipt Line Quantities Table''].[POPRCTNM] '   + ' and [''Purchasing Receipt Line History''].[RCPTLNNM] = [''Purchasing Receipt Line Quantities Table''].[RCPTLNNM] '   + 'left outer join [IV00101] as [''Item Master''] with (NOLOCK) on '   + '[''Purchasing Receipt Line History''].[ITEMNMBR] = [''Item Master''].[ITEMNMBR] '   select @sqlaccessstring =   'GRANT SELECT ON [dbo].[ReceivingsLineItems] TO [rpt_purchasing agent]' + 'GRANT SELECT ON [dbo].[ReceivingsLineItems] TO [rpt_purchasing manager]' + 'GRANT SELECT ON [dbo].[ReceivingsLineItems] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[ReceivingsLineItems] TO [rpt_shipping and receiving]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_Dynamics_ReceivingsLineItems] TO [DYNGRP]
GO
