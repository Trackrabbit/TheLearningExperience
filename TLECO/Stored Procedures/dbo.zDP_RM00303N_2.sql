SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_RM00303N_2] (@BS int, @STMGRLNM char(21), @STMGRFNM char(15), @STMGRMNM char(15), @SALSTERR char(15), @STMGRLNM_RS char(21), @STMGRFNM_RS char(15), @STMGRMNM_RS char(15), @SALSTERR_RS char(15), @STMGRLNM_RE char(21), @STMGRFNM_RE char(15), @STMGRMNM_RE char(15), @SALSTERR_RE char(15)) AS  set nocount on IF @STMGRLNM_RS IS NULL BEGIN SELECT TOP 25  SALSTERR, SLTERDSC, INACTIVE, SLPRSNID, STMGRFNM, STMGRMNM, STMGRLNM, COUNTRY, COSTTODT, TTLCOMTD, TTLCOMLY, NCOMSLYR, COMSLLYR, CSTLSTYR, COMSLTDT, NCOMSLTD, KPCALHST, KPERHIST, NOTEINDX, MODIFDT, CREATDDT, DEX_ROW_TS, DEX_ROW_ID FROM .RM00303 WHERE ( STMGRLNM = @STMGRLNM AND STMGRFNM = @STMGRFNM AND STMGRMNM = @STMGRMNM AND SALSTERR > @SALSTERR OR STMGRLNM = @STMGRLNM AND STMGRFNM = @STMGRFNM AND STMGRMNM > @STMGRMNM OR STMGRLNM = @STMGRLNM AND STMGRFNM > @STMGRFNM OR STMGRLNM > @STMGRLNM ) ORDER BY STMGRLNM ASC, STMGRFNM ASC, STMGRMNM ASC, SALSTERR ASC END ELSE IF @STMGRLNM_RS = @STMGRLNM_RE BEGIN SELECT TOP 25  SALSTERR, SLTERDSC, INACTIVE, SLPRSNID, STMGRFNM, STMGRMNM, STMGRLNM, COUNTRY, COSTTODT, TTLCOMTD, TTLCOMLY, NCOMSLYR, COMSLLYR, CSTLSTYR, COMSLTDT, NCOMSLTD, KPCALHST, KPERHIST, NOTEINDX, MODIFDT, CREATDDT, DEX_ROW_TS, DEX_ROW_ID FROM .RM00303 WHERE STMGRLNM = @STMGRLNM_RS AND STMGRFNM BETWEEN @STMGRFNM_RS AND @STMGRFNM_RE AND STMGRMNM BETWEEN @STMGRMNM_RS AND @STMGRMNM_RE AND SALSTERR BETWEEN @SALSTERR_RS AND @SALSTERR_RE AND ( STMGRLNM = @STMGRLNM AND STMGRFNM = @STMGRFNM AND STMGRMNM = @STMGRMNM AND SALSTERR > @SALSTERR OR STMGRLNM = @STMGRLNM AND STMGRFNM = @STMGRFNM AND STMGRMNM > @STMGRMNM OR STMGRLNM = @STMGRLNM AND STMGRFNM > @STMGRFNM OR STMGRLNM > @STMGRLNM ) ORDER BY STMGRLNM ASC, STMGRFNM ASC, STMGRMNM ASC, SALSTERR ASC END ELSE BEGIN SELECT TOP 25  SALSTERR, SLTERDSC, INACTIVE, SLPRSNID, STMGRFNM, STMGRMNM, STMGRLNM, COUNTRY, COSTTODT, TTLCOMTD, TTLCOMLY, NCOMSLYR, COMSLLYR, CSTLSTYR, COMSLTDT, NCOMSLTD, KPCALHST, KPERHIST, NOTEINDX, MODIFDT, CREATDDT, DEX_ROW_TS, DEX_ROW_ID FROM .RM00303 WHERE STMGRLNM BETWEEN @STMGRLNM_RS AND @STMGRLNM_RE AND STMGRFNM BETWEEN @STMGRFNM_RS AND @STMGRFNM_RE AND STMGRMNM BETWEEN @STMGRMNM_RS AND @STMGRMNM_RE AND SALSTERR BETWEEN @SALSTERR_RS AND @SALSTERR_RE AND ( STMGRLNM = @STMGRLNM AND STMGRFNM = @STMGRFNM AND STMGRMNM = @STMGRMNM AND SALSTERR > @SALSTERR OR STMGRLNM = @STMGRLNM AND STMGRFNM = @STMGRFNM AND STMGRMNM > @STMGRMNM OR STMGRLNM = @STMGRLNM AND STMGRFNM > @STMGRFNM OR STMGRLNM > @STMGRLNM ) ORDER BY STMGRLNM ASC, STMGRFNM ASC, STMGRMNM ASC, SALSTERR ASC END set nocount off  
GO
GRANT EXECUTE ON  [dbo].[zDP_RM00303N_2] TO [DYNGRP]
GO
