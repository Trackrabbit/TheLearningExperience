SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_CM20100L_3] (@AUDITTRAIL_RS char(13), @RecNumControl_RS numeric(19,5), @AUDITTRAIL_RE char(13), @RecNumControl_RE numeric(19,5)) AS  set nocount on IF @AUDITTRAIL_RS IS NULL BEGIN SELECT TOP 25  CMDNUMWK, RecNumControl, VOIDED, CNTRLTYP, AUDITTRAIL, CHEKBKID, CMTrxType, CMTrxNum, CMERRMSG, DEX_ROW_ID FROM .CM20100 ORDER BY AUDITTRAIL DESC, RecNumControl DESC END ELSE IF @AUDITTRAIL_RS = @AUDITTRAIL_RE BEGIN SELECT TOP 25  CMDNUMWK, RecNumControl, VOIDED, CNTRLTYP, AUDITTRAIL, CHEKBKID, CMTrxType, CMTrxNum, CMERRMSG, DEX_ROW_ID FROM .CM20100 WHERE AUDITTRAIL = @AUDITTRAIL_RS AND RecNumControl BETWEEN @RecNumControl_RS AND @RecNumControl_RE ORDER BY AUDITTRAIL DESC, RecNumControl DESC END ELSE BEGIN SELECT TOP 25  CMDNUMWK, RecNumControl, VOIDED, CNTRLTYP, AUDITTRAIL, CHEKBKID, CMTrxType, CMTrxNum, CMERRMSG, DEX_ROW_ID FROM .CM20100 WHERE AUDITTRAIL BETWEEN @AUDITTRAIL_RS AND @AUDITTRAIL_RE AND RecNumControl BETWEEN @RecNumControl_RS AND @RecNumControl_RE ORDER BY AUDITTRAIL DESC, RecNumControl DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_CM20100L_3] TO [DYNGRP]
GO
