SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 Create Procedure [dbo].[SVC_ISC_MetersListByAddress] (   @CUSTNMBR char(15),  @ADRSCODE char(15) ) As SELECT   dbo.SVC00300.EQUIPID,   dbo.SVC00300.SERLNMBR,   dbo.SVC00300.ITEMNMBR,   MAX(dbo.SVC00301.LSTDTEDT) AS LASTENTRY,   MAX(dbo.SVC00301.Meters_1) AS LASTMETER1,   MAX(dbo.SVC00301.Meters_2) AS LASTMETER2,  MAX(dbo.SVC00301.Meters_3) AS LASTMETER3,  MAX(dbo.SVC00301.Meters_4) AS LASTMETER4,  MAX(dbo.SVC00301.Meters_5) AS LASTMETER5  FROM dbo.SVC00301 LEFT OUTER JOIN  SVC00951 ON (SVC00301.ITEMNMBR = SVC00951.ITEMNMBR) RIGHT OUTER JOIN  dbo.SVC00300 ON dbo.SVC00301.EQUIPID = dbo.SVC00300.EQUIPID  WHERE SVC00951.METERED = 1  GROUP BY dbo.SVC00300.EQUIPID, dbo.SVC00300.SERLNMBR, dbo.SVC00300.ITEMNMBR, dbo.SVC00300.CUSTNMBR,dbo.SVC00300.ADRSCODE HAVING (dbo.SVC00300.CUSTNMBR = @CUSTNMBR and dbo.SVC00300.ADRSCODE = @ADRSCODE) ORDER BY dbo.SVC00300.SERLNMBR,  MAX(dbo.SVC00301.LSTDTEDT) DESC  return     
GO
GRANT EXECUTE ON  [dbo].[SVC_ISC_MetersListByAddress] TO [DYNGRP]
GO
