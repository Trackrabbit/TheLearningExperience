SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_AAG20001N_5] (@BS int, @aaSubLedgerHdrID int, @ACCTTYPE smallint, @aaSubLedgerDistID int, @DEX_ROW_ID int, @aaSubLedgerHdrID_RS int, @ACCTTYPE_RS smallint, @aaSubLedgerDistID_RS int, @aaSubLedgerHdrID_RE int, @ACCTTYPE_RE smallint, @aaSubLedgerDistID_RE int) AS  set nocount on IF @aaSubLedgerHdrID_RS IS NULL BEGIN SELECT TOP 25  aaSubLedgerHdrID, aaSubLedgerDistID, INTERID, CorrespondingUnit, ACTINDX, DISTTYPE, ACCTTYPE, aaBrowseType, DECPLACS, DEBITAMT, CRDTAMNT, ORDBTAMT, ORCRDAMT, CURNCYID, CURRNIDX, RATETPID, EXGTBLID, XCHGRATE, EXCHDATE, TIME1, RTCLCMTD, DENXRATE, MCTRXSTT, SEQNUMBR, GLPOSTDT, aaCustID, aaVendID, aaSiteID, aaItemID, EMPLOYID, aaAssetID, aaBookID, aaCopyStatus, aaWinWasOpen, POSTED, HISTORY, aaDistErrors, APTVCHNM, APTODCTY, aaFutureDist, aaOffsetAcct, ITEMNMBR, TRXLOCTN, BINNMBR, TRNSTLOC, TRXQTY, PYRLRTYP, TRXNUMBER, aaChangeDate, aaChangeTime, DEX_ROW_ID FROM .AAG20001 WHERE ( aaSubLedgerHdrID = @aaSubLedgerHdrID AND ACCTTYPE = @ACCTTYPE AND aaSubLedgerDistID = @aaSubLedgerDistID AND DEX_ROW_ID > @DEX_ROW_ID OR aaSubLedgerHdrID = @aaSubLedgerHdrID AND ACCTTYPE = @ACCTTYPE AND aaSubLedgerDistID > @aaSubLedgerDistID OR aaSubLedgerHdrID = @aaSubLedgerHdrID AND ACCTTYPE > @ACCTTYPE OR aaSubLedgerHdrID > @aaSubLedgerHdrID ) ORDER BY aaSubLedgerHdrID ASC, ACCTTYPE ASC, aaSubLedgerDistID ASC, DEX_ROW_ID ASC END ELSE IF @aaSubLedgerHdrID_RS = @aaSubLedgerHdrID_RE BEGIN SELECT TOP 25  aaSubLedgerHdrID, aaSubLedgerDistID, INTERID, CorrespondingUnit, ACTINDX, DISTTYPE, ACCTTYPE, aaBrowseType, DECPLACS, DEBITAMT, CRDTAMNT, ORDBTAMT, ORCRDAMT, CURNCYID, CURRNIDX, RATETPID, EXGTBLID, XCHGRATE, EXCHDATE, TIME1, RTCLCMTD, DENXRATE, MCTRXSTT, SEQNUMBR, GLPOSTDT, aaCustID, aaVendID, aaSiteID, aaItemID, EMPLOYID, aaAssetID, aaBookID, aaCopyStatus, aaWinWasOpen, POSTED, HISTORY, aaDistErrors, APTVCHNM, APTODCTY, aaFutureDist, aaOffsetAcct, ITEMNMBR, TRXLOCTN, BINNMBR, TRNSTLOC, TRXQTY, PYRLRTYP, TRXNUMBER, aaChangeDate, aaChangeTime, DEX_ROW_ID FROM .AAG20001 WHERE aaSubLedgerHdrID = @aaSubLedgerHdrID_RS AND ACCTTYPE BETWEEN @ACCTTYPE_RS AND @ACCTTYPE_RE AND aaSubLedgerDistID BETWEEN @aaSubLedgerDistID_RS AND @aaSubLedgerDistID_RE AND ( aaSubLedgerHdrID = @aaSubLedgerHdrID AND ACCTTYPE = @ACCTTYPE AND aaSubLedgerDistID = @aaSubLedgerDistID AND DEX_ROW_ID > @DEX_ROW_ID OR aaSubLedgerHdrID = @aaSubLedgerHdrID AND ACCTTYPE = @ACCTTYPE AND aaSubLedgerDistID > @aaSubLedgerDistID OR aaSubLedgerHdrID = @aaSubLedgerHdrID AND ACCTTYPE > @ACCTTYPE OR aaSubLedgerHdrID > @aaSubLedgerHdrID ) ORDER BY aaSubLedgerHdrID ASC, ACCTTYPE ASC, aaSubLedgerDistID ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  aaSubLedgerHdrID, aaSubLedgerDistID, INTERID, CorrespondingUnit, ACTINDX, DISTTYPE, ACCTTYPE, aaBrowseType, DECPLACS, DEBITAMT, CRDTAMNT, ORDBTAMT, ORCRDAMT, CURNCYID, CURRNIDX, RATETPID, EXGTBLID, XCHGRATE, EXCHDATE, TIME1, RTCLCMTD, DENXRATE, MCTRXSTT, SEQNUMBR, GLPOSTDT, aaCustID, aaVendID, aaSiteID, aaItemID, EMPLOYID, aaAssetID, aaBookID, aaCopyStatus, aaWinWasOpen, POSTED, HISTORY, aaDistErrors, APTVCHNM, APTODCTY, aaFutureDist, aaOffsetAcct, ITEMNMBR, TRXLOCTN, BINNMBR, TRNSTLOC, TRXQTY, PYRLRTYP, TRXNUMBER, aaChangeDate, aaChangeTime, DEX_ROW_ID FROM .AAG20001 WHERE aaSubLedgerHdrID BETWEEN @aaSubLedgerHdrID_RS AND @aaSubLedgerHdrID_RE AND ACCTTYPE BETWEEN @ACCTTYPE_RS AND @ACCTTYPE_RE AND aaSubLedgerDistID BETWEEN @aaSubLedgerDistID_RS AND @aaSubLedgerDistID_RE AND ( aaSubLedgerHdrID = @aaSubLedgerHdrID AND ACCTTYPE = @ACCTTYPE AND aaSubLedgerDistID = @aaSubLedgerDistID AND DEX_ROW_ID > @DEX_ROW_ID OR aaSubLedgerHdrID = @aaSubLedgerHdrID AND ACCTTYPE = @ACCTTYPE AND aaSubLedgerDistID > @aaSubLedgerDistID OR aaSubLedgerHdrID = @aaSubLedgerHdrID AND ACCTTYPE > @ACCTTYPE OR aaSubLedgerHdrID > @aaSubLedgerHdrID ) ORDER BY aaSubLedgerHdrID ASC, ACCTTYPE ASC, aaSubLedgerDistID ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_AAG20001N_5] TO [DYNGRP]
GO
