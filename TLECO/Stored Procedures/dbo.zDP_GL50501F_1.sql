SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_GL50501F_1] (@TRXDATE_RS datetime, @JRNENTRY_RS int, @ACTINDX_RS int, @DEBITAMT_RS numeric(19,5), @CRDTAMNT_RS numeric(19,5), @TRXDATE_RE datetime, @JRNENTRY_RE int, @ACTINDX_RE int, @DEBITAMT_RE numeric(19,5), @CRDTAMNT_RE numeric(19,5)) AS  set nocount on IF @TRXDATE_RS IS NULL BEGIN SELECT TOP 25  TRXDATE, JRNENTRY, ORTRXSRC, ORCTRNUM, ACTINDX, DEBITAMT, CRDTAMNT, ACCTAMNT, DEX_ROW_ID FROM .GL50501 ORDER BY TRXDATE ASC, JRNENTRY ASC, ACTINDX ASC, DEBITAMT ASC, CRDTAMNT ASC, DEX_ROW_ID ASC END ELSE IF @TRXDATE_RS = @TRXDATE_RE BEGIN SELECT TOP 25  TRXDATE, JRNENTRY, ORTRXSRC, ORCTRNUM, ACTINDX, DEBITAMT, CRDTAMNT, ACCTAMNT, DEX_ROW_ID FROM .GL50501 WHERE TRXDATE = @TRXDATE_RS AND JRNENTRY BETWEEN @JRNENTRY_RS AND @JRNENTRY_RE AND ACTINDX BETWEEN @ACTINDX_RS AND @ACTINDX_RE AND DEBITAMT BETWEEN @DEBITAMT_RS AND @DEBITAMT_RE AND CRDTAMNT BETWEEN @CRDTAMNT_RS AND @CRDTAMNT_RE ORDER BY TRXDATE ASC, JRNENTRY ASC, ACTINDX ASC, DEBITAMT ASC, CRDTAMNT ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  TRXDATE, JRNENTRY, ORTRXSRC, ORCTRNUM, ACTINDX, DEBITAMT, CRDTAMNT, ACCTAMNT, DEX_ROW_ID FROM .GL50501 WHERE TRXDATE BETWEEN @TRXDATE_RS AND @TRXDATE_RE AND JRNENTRY BETWEEN @JRNENTRY_RS AND @JRNENTRY_RE AND ACTINDX BETWEEN @ACTINDX_RS AND @ACTINDX_RE AND DEBITAMT BETWEEN @DEBITAMT_RS AND @DEBITAMT_RE AND CRDTAMNT BETWEEN @CRDTAMNT_RS AND @CRDTAMNT_RE ORDER BY TRXDATE ASC, JRNENTRY ASC, ACTINDX ASC, DEBITAMT ASC, CRDTAMNT ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_GL50501F_1] TO [DYNGRP]
GO
