SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IF000003N_1] (@BS int, @USERID char(15), @BACHNUMB char(15), @BCHSOURC char(15), @JRNENTRY int, @ACTINDX int, @ORCTRNUM char(21), @USERID_RS char(15), @BACHNUMB_RS char(15), @BCHSOURC_RS char(15), @JRNENTRY_RS int, @ACTINDX_RS int, @ORCTRNUM_RS char(21), @USERID_RE char(15), @BACHNUMB_RE char(15), @BCHSOURC_RE char(15), @JRNENTRY_RE int, @ACTINDX_RE int, @ORCTRNUM_RE char(21)) AS  set nocount on IF @USERID_RS IS NULL BEGIN SELECT TOP 25  USERID, BACHNUMB, BCHSOURC, JRNENTRY, ACTINDX, TRXAMNT, ORIGAMT, XCHGRATE, DSCRIPTN, ORCTRNUM, ORDOCNUM, ORMSTRID, ORMSTRNM, ORTRXTYP, ORTRXDESC, OrigSeqNum, DEX_ROW_ID FROM .IF000003 WHERE ( USERID = @USERID AND BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND JRNENTRY = @JRNENTRY AND ACTINDX = @ACTINDX AND ORCTRNUM > @ORCTRNUM OR USERID = @USERID AND BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND JRNENTRY = @JRNENTRY AND ACTINDX > @ACTINDX OR USERID = @USERID AND BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND JRNENTRY > @JRNENTRY OR USERID = @USERID AND BACHNUMB = @BACHNUMB AND BCHSOURC > @BCHSOURC OR USERID = @USERID AND BACHNUMB > @BACHNUMB OR USERID > @USERID ) ORDER BY USERID ASC, BACHNUMB ASC, BCHSOURC ASC, JRNENTRY ASC, ACTINDX ASC, ORCTRNUM ASC END ELSE IF @USERID_RS = @USERID_RE BEGIN SELECT TOP 25  USERID, BACHNUMB, BCHSOURC, JRNENTRY, ACTINDX, TRXAMNT, ORIGAMT, XCHGRATE, DSCRIPTN, ORCTRNUM, ORDOCNUM, ORMSTRID, ORMSTRNM, ORTRXTYP, ORTRXDESC, OrigSeqNum, DEX_ROW_ID FROM .IF000003 WHERE USERID = @USERID_RS AND BACHNUMB BETWEEN @BACHNUMB_RS AND @BACHNUMB_RE AND BCHSOURC BETWEEN @BCHSOURC_RS AND @BCHSOURC_RE AND JRNENTRY BETWEEN @JRNENTRY_RS AND @JRNENTRY_RE AND ACTINDX BETWEEN @ACTINDX_RS AND @ACTINDX_RE AND ORCTRNUM BETWEEN @ORCTRNUM_RS AND @ORCTRNUM_RE AND ( USERID = @USERID AND BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND JRNENTRY = @JRNENTRY AND ACTINDX = @ACTINDX AND ORCTRNUM > @ORCTRNUM OR USERID = @USERID AND BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND JRNENTRY = @JRNENTRY AND ACTINDX > @ACTINDX OR USERID = @USERID AND BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND JRNENTRY > @JRNENTRY OR USERID = @USERID AND BACHNUMB = @BACHNUMB AND BCHSOURC > @BCHSOURC OR USERID = @USERID AND BACHNUMB > @BACHNUMB OR USERID > @USERID ) ORDER BY USERID ASC, BACHNUMB ASC, BCHSOURC ASC, JRNENTRY ASC, ACTINDX ASC, ORCTRNUM ASC END ELSE BEGIN SELECT TOP 25  USERID, BACHNUMB, BCHSOURC, JRNENTRY, ACTINDX, TRXAMNT, ORIGAMT, XCHGRATE, DSCRIPTN, ORCTRNUM, ORDOCNUM, ORMSTRID, ORMSTRNM, ORTRXTYP, ORTRXDESC, OrigSeqNum, DEX_ROW_ID FROM .IF000003 WHERE USERID BETWEEN @USERID_RS AND @USERID_RE AND BACHNUMB BETWEEN @BACHNUMB_RS AND @BACHNUMB_RE AND BCHSOURC BETWEEN @BCHSOURC_RS AND @BCHSOURC_RE AND JRNENTRY BETWEEN @JRNENTRY_RS AND @JRNENTRY_RE AND ACTINDX BETWEEN @ACTINDX_RS AND @ACTINDX_RE AND ORCTRNUM BETWEEN @ORCTRNUM_RS AND @ORCTRNUM_RE AND ( USERID = @USERID AND BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND JRNENTRY = @JRNENTRY AND ACTINDX = @ACTINDX AND ORCTRNUM > @ORCTRNUM OR USERID = @USERID AND BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND JRNENTRY = @JRNENTRY AND ACTINDX > @ACTINDX OR USERID = @USERID AND BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND JRNENTRY > @JRNENTRY OR USERID = @USERID AND BACHNUMB = @BACHNUMB AND BCHSOURC > @BCHSOURC OR USERID = @USERID AND BACHNUMB > @BACHNUMB OR USERID > @USERID ) ORDER BY USERID ASC, BACHNUMB ASC, BCHSOURC ASC, JRNENTRY ASC, ACTINDX ASC, ORCTRNUM ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IF000003N_1] TO [DYNGRP]
GO
