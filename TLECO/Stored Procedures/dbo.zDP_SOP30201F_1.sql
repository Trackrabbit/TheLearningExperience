SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SOP30201F_1] (@TRXSORCE_RS char(13), @SOPTYPE_RS smallint, @SOPNUMBE_RS char(21), @LNITMSEQ_RS int, @TRXSORCE_RE char(13), @SOPTYPE_RE smallint, @SOPNUMBE_RE char(21), @LNITMSEQ_RE int) AS  set nocount on IF @TRXSORCE_RS IS NULL BEGIN SELECT TOP 25  SOPTYPE, SOPNUMBE, LNITMSEQ, CUSTNMBR, CUSTNAME, DOCDATE, DOCNUMBR, RMDTYPAL, PYMTTYPE, AMNTPAID, OAMTPAID, CHEKBKID, CHEKNMBR, CARDNAME, RCTNCCRD, EXPNDATE, AUTHCODE, PYMNTDAT, GLPOSTDT, CASHINDEX, DEPINDEX, DELETE1, CURNCYID, CURRNIDX, XCHGRATE, DENXRATE, RATETPID, RTCLCMTD, EXGTBLID, EXCHDATE, MCTRXSTT, TIME1, TRXSORCE, DEX_ROW_ID FROM .SOP30201 ORDER BY TRXSORCE ASC, SOPTYPE ASC, SOPNUMBE ASC, LNITMSEQ ASC END ELSE IF @TRXSORCE_RS = @TRXSORCE_RE BEGIN SELECT TOP 25  SOPTYPE, SOPNUMBE, LNITMSEQ, CUSTNMBR, CUSTNAME, DOCDATE, DOCNUMBR, RMDTYPAL, PYMTTYPE, AMNTPAID, OAMTPAID, CHEKBKID, CHEKNMBR, CARDNAME, RCTNCCRD, EXPNDATE, AUTHCODE, PYMNTDAT, GLPOSTDT, CASHINDEX, DEPINDEX, DELETE1, CURNCYID, CURRNIDX, XCHGRATE, DENXRATE, RATETPID, RTCLCMTD, EXGTBLID, EXCHDATE, MCTRXSTT, TIME1, TRXSORCE, DEX_ROW_ID FROM .SOP30201 WHERE TRXSORCE = @TRXSORCE_RS AND SOPTYPE BETWEEN @SOPTYPE_RS AND @SOPTYPE_RE AND SOPNUMBE BETWEEN @SOPNUMBE_RS AND @SOPNUMBE_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE ORDER BY TRXSORCE ASC, SOPTYPE ASC, SOPNUMBE ASC, LNITMSEQ ASC END ELSE BEGIN SELECT TOP 25  SOPTYPE, SOPNUMBE, LNITMSEQ, CUSTNMBR, CUSTNAME, DOCDATE, DOCNUMBR, RMDTYPAL, PYMTTYPE, AMNTPAID, OAMTPAID, CHEKBKID, CHEKNMBR, CARDNAME, RCTNCCRD, EXPNDATE, AUTHCODE, PYMNTDAT, GLPOSTDT, CASHINDEX, DEPINDEX, DELETE1, CURNCYID, CURRNIDX, XCHGRATE, DENXRATE, RATETPID, RTCLCMTD, EXGTBLID, EXCHDATE, MCTRXSTT, TIME1, TRXSORCE, DEX_ROW_ID FROM .SOP30201 WHERE TRXSORCE BETWEEN @TRXSORCE_RS AND @TRXSORCE_RE AND SOPTYPE BETWEEN @SOPTYPE_RS AND @SOPTYPE_RE AND SOPNUMBE BETWEEN @SOPNUMBE_RS AND @SOPNUMBE_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE ORDER BY TRXSORCE ASC, SOPTYPE ASC, SOPNUMBE ASC, LNITMSEQ ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SOP30201F_1] TO [DYNGRP]
GO
