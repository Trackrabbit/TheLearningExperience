SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SVC00675L_2] (@MKDTOPST_RS tinyint, @CMXFRNUM_RS char(21), @MKDTOPST_RE tinyint, @CMXFRNUM_RE char(21)) AS  set nocount on IF @MKDTOPST_RS IS NULL BEGIN SELECT TOP 25  CONSTS, CONTNBR, LNSEQNBR, CNTTYPE, STRTDATE, ENDDATE, ITEMNMBR, SERLNMBR, EQUIPID, DSCRIPTN, QUANTITY, Effective_Date, CMXFRNUM, To_Customer_Number, ADRSCODE, PRICSHED, CNTPRCOVR, TOTAL, SVC_Monthly_Price, DEDCAMNT_1, DEDCAMNT_2, DEDCAMNT_3, DEDCAMNT_4, DEDCAMNT_5, RETNAGAM, RTNBILLD, NBRCAL, ACTCAL, BLKTIM, VALTIM, MKDTOPST, POSTDATE, DEX_ROW_ID FROM .SVC00675 ORDER BY MKDTOPST DESC, CMXFRNUM DESC, DEX_ROW_ID DESC END ELSE IF @MKDTOPST_RS = @MKDTOPST_RE BEGIN SELECT TOP 25  CONSTS, CONTNBR, LNSEQNBR, CNTTYPE, STRTDATE, ENDDATE, ITEMNMBR, SERLNMBR, EQUIPID, DSCRIPTN, QUANTITY, Effective_Date, CMXFRNUM, To_Customer_Number, ADRSCODE, PRICSHED, CNTPRCOVR, TOTAL, SVC_Monthly_Price, DEDCAMNT_1, DEDCAMNT_2, DEDCAMNT_3, DEDCAMNT_4, DEDCAMNT_5, RETNAGAM, RTNBILLD, NBRCAL, ACTCAL, BLKTIM, VALTIM, MKDTOPST, POSTDATE, DEX_ROW_ID FROM .SVC00675 WHERE MKDTOPST = @MKDTOPST_RS AND CMXFRNUM BETWEEN @CMXFRNUM_RS AND @CMXFRNUM_RE ORDER BY MKDTOPST DESC, CMXFRNUM DESC, DEX_ROW_ID DESC END ELSE BEGIN SELECT TOP 25  CONSTS, CONTNBR, LNSEQNBR, CNTTYPE, STRTDATE, ENDDATE, ITEMNMBR, SERLNMBR, EQUIPID, DSCRIPTN, QUANTITY, Effective_Date, CMXFRNUM, To_Customer_Number, ADRSCODE, PRICSHED, CNTPRCOVR, TOTAL, SVC_Monthly_Price, DEDCAMNT_1, DEDCAMNT_2, DEDCAMNT_3, DEDCAMNT_4, DEDCAMNT_5, RETNAGAM, RTNBILLD, NBRCAL, ACTCAL, BLKTIM, VALTIM, MKDTOPST, POSTDATE, DEX_ROW_ID FROM .SVC00675 WHERE MKDTOPST BETWEEN @MKDTOPST_RS AND @MKDTOPST_RE AND CMXFRNUM BETWEEN @CMXFRNUM_RS AND @CMXFRNUM_RE ORDER BY MKDTOPST DESC, CMXFRNUM DESC, DEX_ROW_ID DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SVC00675L_2] TO [DYNGRP]
GO
