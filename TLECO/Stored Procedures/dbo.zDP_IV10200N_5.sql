SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IV10200N_5] (@BS int, @PCHSRCTY smallint, @ITEMNMBR char(31), @QTYTYPE smallint, @TRXLOCTN char(11), @DATERECD datetime, @RCTSEQNM int, @PCHSRCTY_RS smallint, @ITEMNMBR_RS char(31), @QTYTYPE_RS smallint, @TRXLOCTN_RS char(11), @DATERECD_RS datetime, @RCTSEQNM_RS int, @PCHSRCTY_RE smallint, @ITEMNMBR_RE char(31), @QTYTYPE_RE smallint, @TRXLOCTN_RE char(11), @DATERECD_RE datetime, @RCTSEQNM_RE int) AS  set nocount on IF @PCHSRCTY_RS IS NULL BEGIN SELECT TOP 25  ITEMNMBR, TRXLOCTN, DATERECD, RCTSEQNM, RCPTSOLD, QTYRECVD, QTYSOLD, QTYCOMTD, QTYRESERVED, FLRPLNDT, PCHSRCTY, RCPTNMBR, VENDORID, PORDNMBR, UNITCOST, QTYTYPE, Landed_Cost, NEGQTYSOPINV, VCTNMTHD, ADJUNITCOST, QTYONHND, DEX_ROW_ID FROM .IV10200 WHERE ( PCHSRCTY = @PCHSRCTY AND ITEMNMBR = @ITEMNMBR AND QTYTYPE = @QTYTYPE AND TRXLOCTN = @TRXLOCTN AND DATERECD = @DATERECD AND RCTSEQNM > @RCTSEQNM OR PCHSRCTY = @PCHSRCTY AND ITEMNMBR = @ITEMNMBR AND QTYTYPE = @QTYTYPE AND TRXLOCTN = @TRXLOCTN AND DATERECD > @DATERECD OR PCHSRCTY = @PCHSRCTY AND ITEMNMBR = @ITEMNMBR AND QTYTYPE = @QTYTYPE AND TRXLOCTN > @TRXLOCTN OR PCHSRCTY = @PCHSRCTY AND ITEMNMBR = @ITEMNMBR AND QTYTYPE > @QTYTYPE OR PCHSRCTY = @PCHSRCTY AND ITEMNMBR > @ITEMNMBR OR PCHSRCTY > @PCHSRCTY ) ORDER BY PCHSRCTY ASC, ITEMNMBR ASC, QTYTYPE ASC, TRXLOCTN ASC, DATERECD ASC, RCTSEQNM ASC END ELSE IF @PCHSRCTY_RS = @PCHSRCTY_RE BEGIN SELECT TOP 25  ITEMNMBR, TRXLOCTN, DATERECD, RCTSEQNM, RCPTSOLD, QTYRECVD, QTYSOLD, QTYCOMTD, QTYRESERVED, FLRPLNDT, PCHSRCTY, RCPTNMBR, VENDORID, PORDNMBR, UNITCOST, QTYTYPE, Landed_Cost, NEGQTYSOPINV, VCTNMTHD, ADJUNITCOST, QTYONHND, DEX_ROW_ID FROM .IV10200 WHERE PCHSRCTY = @PCHSRCTY_RS AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND QTYTYPE BETWEEN @QTYTYPE_RS AND @QTYTYPE_RE AND TRXLOCTN BETWEEN @TRXLOCTN_RS AND @TRXLOCTN_RE AND DATERECD BETWEEN @DATERECD_RS AND @DATERECD_RE AND RCTSEQNM BETWEEN @RCTSEQNM_RS AND @RCTSEQNM_RE AND ( PCHSRCTY = @PCHSRCTY AND ITEMNMBR = @ITEMNMBR AND QTYTYPE = @QTYTYPE AND TRXLOCTN = @TRXLOCTN AND DATERECD = @DATERECD AND RCTSEQNM > @RCTSEQNM OR PCHSRCTY = @PCHSRCTY AND ITEMNMBR = @ITEMNMBR AND QTYTYPE = @QTYTYPE AND TRXLOCTN = @TRXLOCTN AND DATERECD > @DATERECD OR PCHSRCTY = @PCHSRCTY AND ITEMNMBR = @ITEMNMBR AND QTYTYPE = @QTYTYPE AND TRXLOCTN > @TRXLOCTN OR PCHSRCTY = @PCHSRCTY AND ITEMNMBR = @ITEMNMBR AND QTYTYPE > @QTYTYPE OR PCHSRCTY = @PCHSRCTY AND ITEMNMBR > @ITEMNMBR OR PCHSRCTY > @PCHSRCTY ) ORDER BY PCHSRCTY ASC, ITEMNMBR ASC, QTYTYPE ASC, TRXLOCTN ASC, DATERECD ASC, RCTSEQNM ASC END ELSE BEGIN SELECT TOP 25  ITEMNMBR, TRXLOCTN, DATERECD, RCTSEQNM, RCPTSOLD, QTYRECVD, QTYSOLD, QTYCOMTD, QTYRESERVED, FLRPLNDT, PCHSRCTY, RCPTNMBR, VENDORID, PORDNMBR, UNITCOST, QTYTYPE, Landed_Cost, NEGQTYSOPINV, VCTNMTHD, ADJUNITCOST, QTYONHND, DEX_ROW_ID FROM .IV10200 WHERE PCHSRCTY BETWEEN @PCHSRCTY_RS AND @PCHSRCTY_RE AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND QTYTYPE BETWEEN @QTYTYPE_RS AND @QTYTYPE_RE AND TRXLOCTN BETWEEN @TRXLOCTN_RS AND @TRXLOCTN_RE AND DATERECD BETWEEN @DATERECD_RS AND @DATERECD_RE AND RCTSEQNM BETWEEN @RCTSEQNM_RS AND @RCTSEQNM_RE AND ( PCHSRCTY = @PCHSRCTY AND ITEMNMBR = @ITEMNMBR AND QTYTYPE = @QTYTYPE AND TRXLOCTN = @TRXLOCTN AND DATERECD = @DATERECD AND RCTSEQNM > @RCTSEQNM OR PCHSRCTY = @PCHSRCTY AND ITEMNMBR = @ITEMNMBR AND QTYTYPE = @QTYTYPE AND TRXLOCTN = @TRXLOCTN AND DATERECD > @DATERECD OR PCHSRCTY = @PCHSRCTY AND ITEMNMBR = @ITEMNMBR AND QTYTYPE = @QTYTYPE AND TRXLOCTN > @TRXLOCTN OR PCHSRCTY = @PCHSRCTY AND ITEMNMBR = @ITEMNMBR AND QTYTYPE > @QTYTYPE OR PCHSRCTY = @PCHSRCTY AND ITEMNMBR > @ITEMNMBR OR PCHSRCTY > @PCHSRCTY ) ORDER BY PCHSRCTY ASC, ITEMNMBR ASC, QTYTYPE ASC, TRXLOCTN ASC, DATERECD ASC, RCTSEQNM ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IV10200N_5] TO [DYNGRP]
GO
