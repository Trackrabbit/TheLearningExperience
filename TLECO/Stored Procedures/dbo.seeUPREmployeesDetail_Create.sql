SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[seeUPREmployeesDetail_Create] @iLanguageID int   as   set nocount on   declare @sqldropstring varchar(400),   @sqlstring1 varchar(8000),   @sqlstring2 varchar(8000),   @sqlstring3 varchar(8000),   @sqlstring4 varchar(8000),   @sqlstring5 varchar(8000),   @sqlstring6 varchar(8000),   @sqlstring7 varchar(8000),   @sqlstring8 varchar(8000),   @sqlstring9 varchar(8000),   @sqlstring10 varchar(8000),   @sqljoinstring varchar(8000),   @sqlaccessstring varchar(2000),   @tNumberSegments int,   @tSegment int,   @I_iDictID int,   @I_iLangID int,   @I_iMessageNumber int,   @I_iAliasMessageNumber int,   @I_iIntegerValue int,  @Inactive varchar(255), @Department varchar(255), @Employee_ID varchar(255), @Start_Date varchar(255), @Date_Employee_Inactivated varchar(255)  select @I_iDictID = 1493 select @I_iMessageNumber = 22402 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgStringForProcs  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inactive output   select @I_iDictID = 1493 select @I_iMessageNumber = 22420 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgStringForProcs  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Department output   select @I_iDictID = 1493 select @I_iMessageNumber = 22400 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgStringForProcs  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Employee_ID output   select @I_iDictID = 1493 select @I_iMessageNumber = 22425 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgStringForProcs  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Start_Date output   select @I_iDictID = 1493 select @I_iMessageNumber = 22426 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgStringForProcs  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Date_Employee_Inactivated output    select @sqldropstring =   'IF EXISTS (SELECT * FROM   sys.objects WHERE  object_id = OBJECT_ID(N''[dbo].[seeUPREmployeesDetail]'') AND type in ( N''P'', N''PC'' ))  ' +   '  DROP PROCEDURE [dbo].[seeUPREmployeesDetail]  '   select @sqlstring1 =   'create procedure dbo.seeUPREmployeesDetail '+   ' @EmployeeID varchar(50) = null, '+   ' @StartDateFrom datetime = null, '+   ' @StartDateTo datetime = null, '+   ' @DateInactiveFrom datetime = null, '+   ' @DateInactiveTo datetime = null, '+   ' @Department varchar(50) = null, '+   ' @Inactive varchar(50) = ''No'' '+   'as '+   ' '+   'if @StartDateFrom is null and @StartDateTo is null '+   ' and @DateInactiveFrom is null and @DateInactiveTo is null '+   'begin '+   ' if @EmployeeID is null '+   '  if @Department is null '+   '   select *  '+   '    from Employees '+   '    where ['+@Inactive+'] = @Inactive '+   '  else '+   '   select *  '+   '    from Employees '+   '    where ['+@Department+'] = @Department '+   '     and ['+@Inactive+'] = @Inactive '+   ' else '+   '  if @Department is null '+   '   Select * '+   '    from Employees '+   '    where ['+@Employee_ID+'] = @EmployeeID '+   '     and ['+@Inactive+'] = @Inactive '+   '  else '+   '   Select * '+   '    from Employees '+   '    where ['+@Employee_ID+'] = @EmployeeID '+   '     and ['+@Department+'] = @Department '+   '     and ['+@Inactive+'] = @Inactive '+   'end '+   ' '+   'if @StartDateFrom is not null and @StartDateTo is not null '+   ' and @DateInactiveFrom is null and @DateInactiveTo is null '+   'begin '+   ' if @EmployeeID is null '+   '  if @Department is null '+   '   select *  '+   '    from Employees '+   '    where (['+@Start_Date+'] >= @StartDateFrom and ['+@Start_Date+'] <= @StartDateTo) '+   '     and ['+@Inactive+'] = @Inactive '+   '  else '+   '   select *  '+   '    from Employees '+   '    where ['+@Department+'] = @Department '+   '     and (['+@Start_Date+'] >= @StartDateFrom and ['+@Start_Date+'] <= @StartDateTo) '+   '     and ['+@Inactive+'] = @Inactive '+   ' else '+   '  if @Department is null '+   '   Select * '+   '    from Employees '+   '    where ['+@Employee_ID+'] = @EmployeeID '+   '     and (['+@Start_Date+'] >= @StartDateFrom and ['+@Start_Date+'] <= @StartDateTo) '+   '     and ['+@Inactive+'] = @Inactive '+   '  else '+   '   Select * '+   '    from Employees '+   '    where ['+@Employee_ID+'] = @EmployeeID '+   '     and (['+@Start_Date+'] >= @StartDateFrom and ['+@Start_Date+'] <= @StartDateTo) '+   '     and ['+@Department+'] = @Department '+   '     and ['+@Inactive+'] = @Inactive '+   'end '+   ' '+   'if @StartDateFrom is null and @StartDateTo is null '+   ' and @DateInactiveFrom is not null and @DateInactiveTo is not null '+   'begin '+   ' if @EmployeeID is null '+   '  if @Department is null '+   '   select *  '+   '    from Employees '+   '    where (['+@Date_Employee_Inactivated+'] >= @DateInactiveFrom and ['+@Date_Employee_Inactivated+'] <= @DateInactiveTo) '+   '     and ['+@Inactive+'] = @Inactive '+   '  else '+   '   select *  '+   '    from Employees '+   '    where ['+@Department+'] = @Department '+   '     and (['+@Date_Employee_Inactivated+'] >= @DateInactiveFrom and ['+@Date_Employee_Inactivated+'] <= @DateInactiveTo) '+   '     and ['+@Inactive+'] = @Inactive '+   ' else '+   '  if @Department is null '+   '   Select * '+   '    from Employees '+   '    where ['+@Employee_ID+'] = @EmployeeID '+   '     and (['+@Date_Employee_Inactivated+'] >= @DateInactiveFrom and ['+@Date_Employee_Inactivated+'] <= @DateInactiveTo) '+   '     and ['+@Inactive+'] = @Inactive '+   '  else '+   '   Select * '+   '    from Employees '+   '    where ['+@Employee_ID+'] = @EmployeeID '+   '     and (['+@Date_Employee_Inactivated+'] >= @DateInactiveFrom and ['+@Date_Employee_Inactivated+'] <= @DateInactiveTo) '+   '     and ['+@Department+'] = @Department '+   '     and ['+@Inactive+'] = @Inactive '+   'end '+   ' '+   'if @StartDateFrom is not null and @StartDateTo is not null '+   ' and @DateInactiveFrom is not null and @DateInactiveTo is not null '+   'begin '+   ' if @EmployeeID is null '+   '  if @Department is null '+   '   select *  '+   '    from Employees '+   '    where (['+@Date_Employee_Inactivated+'] >= @DateInactiveFrom and ['+@Date_Employee_Inactivated+'] <= @DateInactiveTo) '+   '     and (['+@Start_Date+'] >= @StartDateFrom and ['+@Start_Date+'] <= @StartDateTo) '+   '     and ['+@Inactive+'] = @Inactive '+   '  else '+   '   select *  '+   '    from Employees '+   '    where ['+@Department+'] = @Department '+   '     and (['+@Date_Employee_Inactivated+'] >= @DateInactiveFrom and ['+@Date_Employee_Inactivated+'] <= @DateInactiveTo) '+   '     and (['+@Start_Date+'] >= @StartDateFrom and ['+@Start_Date+'] <= @StartDateTo) '+   '     and ['+@Inactive+'] = @Inactive '+   ' else '+   '  if @Department is null '+   '   Select * '+   '    from Employees '+   '    where ['+@Employee_ID+'] = @EmployeeID '+   '     and (['+@Date_Employee_Inactivated+'] >= @DateInactiveFrom and ['+@Date_Employee_Inactivated+'] <= @DateInactiveTo) '+   '     and (['+@Start_Date+'] >= @StartDateFrom and ['+@Start_Date+'] <= @StartDateTo) '+   '     and ['+@Inactive+'] = @Inactive '+   '  else '+   '   Select * '+   '    from Employees '+   '    where ['+@Employee_ID+'] = @EmployeeID '+   '     and (['+@Date_Employee_Inactivated+'] >= @DateInactiveFrom and ['+@Date_Employee_Inactivated+'] <= @DateInactiveTo) '+   '     and (['+@Start_Date+'] >= @StartDateFrom and ['+@Start_Date+'] <= @StartDateTo) '+   '     and ['+@Department+'] = @Department '+   '     and ['+@Inactive+'] = @Inactive ' +  'end '   select @sqlaccessstring =   'GRANT execute ON [dbo].[seeUPREmployeesDetail] TO [rpt_payroll],[rpt_human resource administrator],[rpt_executive] '   exec (@sqldropstring)   exec (@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10)   exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[seeUPREmployeesDetail_Create] TO [DYNGRP]
GO
