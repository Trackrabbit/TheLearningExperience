SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE procedure [dbo].[SVC_Mail_parse_for_keywords](  @Data varchar(255),  @CUSTOMER varchar(255) output,  @PASSWORD varchar(21) output,  @KEYWORDS varchar(255) output,  @SERIAL varchar(255) output,  @DESCR varchar(255) output,  @CUSTREF varchar(255) output,  @EMAIL varchar(255) output,  @CONTACT varchar(255) output,  @PHONE varchar(20) output  ) as declare @CR char(1) declare @LF char(1) declare @Line varchar(255) declare @EOL int declare @LeftSide varchar(255) declare @RightSide varchar(255) declare @Pattern varchar(255) set nocount on select @CUSTOMER = null,  @PASSWORD = null,  @KEYWORDS = null,  @SERIAL = null,  @DESCR  = null,  @CUSTREF = null,  @EMAIL = null,  @CONTACT = null,  @PHONE = null select @CR = char(13) select @LF = char(10) select @Pattern = '%['+@CR+@LF+']%' while LEN(@Data) > 0  begin  while patindex(@Pattern,@Data) = 1  begin  select @Data = substring(@Data,2,LEN(@Data) -1)  end  select @EOL = patindex(@Pattern, @Data)  if @EOL = 0  begin  select @EOL = LEN(@Data)  end  if @EOL > 0  select @Line = substring(@Data,1,@EOL - 1)  select @Data = substring(@Data,@EOL + 1, LEN(@Data) - @EOL)  exec SVC_util_parsestring @Line,':',@LeftSide output, @RightSide output  if upper(@LeftSide) = 'CUSTOMER' select @CUSTOMER = @RightSide  if upper(@LeftSide) = 'PASSWORD' select @PASSWORD = @RightSide  if upper(@LeftSide) = 'KEYWORDS' select @KEYWORDS = @RightSide  if upper(@LeftSide) = 'SERIAL' select @SERIAL = @RightSide  if upper(@LeftSide) = 'DESCR' select @DESCR = @RightSide  if upper(@LeftSide) = 'CUSTREF' select @CUSTREF = @RightSide  if upper(@LeftSide) = 'EMAIL' select @EMAIL = @RightSide  if upper(@LeftSide) = 'CONTACT' select @CONTACT = @RightSide  if upper(@LeftSide) = 'PHONE' select @PHONE = @RightSide  end  return    
GO
GRANT EXECUTE ON  [dbo].[SVC_Mail_parse_for_keywords] TO [DYNGRP]
GO
