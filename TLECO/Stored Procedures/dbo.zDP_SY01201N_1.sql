SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SY01201N_1] (@BS int, @CUSTOMLINKPRMPT smallint, @CUSTOMLINKLBL char(51), @CUSTOMLINKFIELDVAL char(15), @CUSTOMLINKPRMPT_RS smallint, @CUSTOMLINKLBL_RS char(51), @CUSTOMLINKFIELDVAL_RS char(15), @CUSTOMLINKPRMPT_RE smallint, @CUSTOMLINKLBL_RE char(51), @CUSTOMLINKFIELDVAL_RE char(15)) AS  set nocount on IF @CUSTOMLINKPRMPT_RS IS NULL BEGIN SELECT TOP 25  CUSTOMLINKPRMPT, CUSTOMLINKLBL, CUSTOMLINKFIELDVAL, CUSTOMLINKINETADDR, CUSTOMLINKADDRTYPE, CUSTOMLINKADDRFIELD, DEX_ROW_ID FROM .SY01201 WHERE ( CUSTOMLINKPRMPT = @CUSTOMLINKPRMPT AND CUSTOMLINKLBL = @CUSTOMLINKLBL AND CUSTOMLINKFIELDVAL > @CUSTOMLINKFIELDVAL OR CUSTOMLINKPRMPT = @CUSTOMLINKPRMPT AND CUSTOMLINKLBL > @CUSTOMLINKLBL OR CUSTOMLINKPRMPT > @CUSTOMLINKPRMPT ) ORDER BY CUSTOMLINKPRMPT ASC, CUSTOMLINKLBL ASC, CUSTOMLINKFIELDVAL ASC END ELSE IF @CUSTOMLINKPRMPT_RS = @CUSTOMLINKPRMPT_RE BEGIN SELECT TOP 25  CUSTOMLINKPRMPT, CUSTOMLINKLBL, CUSTOMLINKFIELDVAL, CUSTOMLINKINETADDR, CUSTOMLINKADDRTYPE, CUSTOMLINKADDRFIELD, DEX_ROW_ID FROM .SY01201 WHERE CUSTOMLINKPRMPT = @CUSTOMLINKPRMPT_RS AND CUSTOMLINKLBL BETWEEN @CUSTOMLINKLBL_RS AND @CUSTOMLINKLBL_RE AND CUSTOMLINKFIELDVAL BETWEEN @CUSTOMLINKFIELDVAL_RS AND @CUSTOMLINKFIELDVAL_RE AND ( CUSTOMLINKPRMPT = @CUSTOMLINKPRMPT AND CUSTOMLINKLBL = @CUSTOMLINKLBL AND CUSTOMLINKFIELDVAL > @CUSTOMLINKFIELDVAL OR CUSTOMLINKPRMPT = @CUSTOMLINKPRMPT AND CUSTOMLINKLBL > @CUSTOMLINKLBL OR CUSTOMLINKPRMPT > @CUSTOMLINKPRMPT ) ORDER BY CUSTOMLINKPRMPT ASC, CUSTOMLINKLBL ASC, CUSTOMLINKFIELDVAL ASC END ELSE BEGIN SELECT TOP 25  CUSTOMLINKPRMPT, CUSTOMLINKLBL, CUSTOMLINKFIELDVAL, CUSTOMLINKINETADDR, CUSTOMLINKADDRTYPE, CUSTOMLINKADDRFIELD, DEX_ROW_ID FROM .SY01201 WHERE CUSTOMLINKPRMPT BETWEEN @CUSTOMLINKPRMPT_RS AND @CUSTOMLINKPRMPT_RE AND CUSTOMLINKLBL BETWEEN @CUSTOMLINKLBL_RS AND @CUSTOMLINKLBL_RE AND CUSTOMLINKFIELDVAL BETWEEN @CUSTOMLINKFIELDVAL_RS AND @CUSTOMLINKFIELDVAL_RE AND ( CUSTOMLINKPRMPT = @CUSTOMLINKPRMPT AND CUSTOMLINKLBL = @CUSTOMLINKLBL AND CUSTOMLINKFIELDVAL > @CUSTOMLINKFIELDVAL OR CUSTOMLINKPRMPT = @CUSTOMLINKPRMPT AND CUSTOMLINKLBL > @CUSTOMLINKLBL OR CUSTOMLINKPRMPT > @CUSTOMLINKPRMPT ) ORDER BY CUSTOMLINKPRMPT ASC, CUSTOMLINKLBL ASC, CUSTOMLINKFIELDVAL ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY01201N_1] TO [DYNGRP]
GO
