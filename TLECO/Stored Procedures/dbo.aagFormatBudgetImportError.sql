SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[aagFormatBudgetImportError] (  @sError1 VARCHAR(150) ,  @sError2 VARCHAR(150) ,  @sError3 VARCHAR(150) ,  @sError4 VARCHAR(150) ,   @sError5 VARCHAR(150) ,   @sError6 VARCHAR(150)  ) AS BEGIN  DECLARE @USERID  VARCHAR(51)  DECLARE @WINTYPE INTEGER  DECLARE @CMPANYID  INTEGER  DECLARE @aaBudgetTreeID INTEGER  DECLARE @aaBudgetID INTEGER  DECLARE @aaTrxDimCodeDescr VARCHAR(256)   SELECT @USERID  = SYSTEM_USER  SELECT @WINTYPE = 1   SELECT @CMPANYID = dbo.aagGetCompanyID()  SELECT @aaBudgetID = aaBudgetID FROM AAG00906 WHERE   USERID = @USERID AND CMPANYID = @CMPANYID AND WINTYPE = @WINTYPE  SELECT @aaBudgetTreeID = aaBudgetTreeID FROM AAG00903  WHERE aaBudgetID = @aaBudgetID  DECLARE @TempString VARCHAR(100)  DECLARE @aaCodeSequence INTEGER  DECLARE @ACCNUMSTR VARCHAR(100)  DECLARE @ActErrCount INTEGER  UPDATE AAG2000E SET ERRDESCR = @sError1 WHERE aaSubLedgerHdrID = -1 AND AADOCVAL = 1  SELECT @aaCodeSequence = aaSubLedgerDistID FROM  AAG2000E WHERE aaSubLedgerHdrID = -1 AND AADOCVAL = 2   SELECT  @aaTrxDimCodeDescr = aaTrxDimCodeDescr FROM AAG00902 A INNER JOIN AAG00401 B ON   A.aaTrxDimCodeID = B.aaTrxDimCodeID   WHERE   A.aaBudgetTreeID = @aaBudgetTreeID AND A.aaCodeSequence = @aaCodeSequence  SET @sError2 = REPLACE(@sError2, '%', @aaTrxDimCodeDescr)  UPDATE AAG2000E SET ERRDESCR = @sError2 WHERE aaSubLedgerHdrID = -1 AND AADOCVAL = 2  UPDATE AAG2000E SET ERRDESCR = REPLACE(@sError3,'%',aaTrxDimCode) WHERE aaSubLedgerHdrID = -1 AND AADOCVAL = 3  SELECT @ActErrCount = COUNT(DISTINCT aaSubLedgerDistID) from AAG2000E WHERE   aaSubLedgerHdrID = -1 AND  AADOCVAL = 4  DELETE FROM AAG2000E WHERE aaSubLedgerHdrID = -1 AND AADOCVAL = 4  IF @ActErrCount <> 0   INSERT INTO  AAG2000E (aaSubLedgerHdrID, aaTrxDimCode, aaSubLedgerDistID, AADOCVAL )   VALUES (-1,'0',@ActErrCount,4)  SELECT @aaCodeSequence = aaSubLedgerDistID FROM  AAG2000E WHERE aaSubLedgerHdrID = -1 AND AADOCVAL = 4   SET @sError4 = REPLACE(@sError4,'%',CONVERT(VARCHAR,@aaCodeSequence))  UPDATE AAG2000E SET ERRDESCR = @sError4 WHERE aaSubLedgerHdrID = -1 AND AADOCVAL = 4  UPDATE AAG2000E SET ERRDESCR = @sError5 WHERE aaSubLedgerHdrID = -1 AND AADOCVAL = 5  UPDATE AAG2000E SET ERRDESCR = @sError6 WHERE aaSubLedgerHdrID = -1 AND AADOCVAL = 6 END    
GO
GRANT EXECUTE ON  [dbo].[aagFormatBudgetImportError] TO [DYNGRP]
GO
