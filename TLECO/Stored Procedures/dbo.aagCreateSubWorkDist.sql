SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[aagCreateSubWorkDist]  @aaSubLedgerHdrID    int output,    @aaSubWorkDistID int = 0,  @DOCTYPE smallint,  @DOCNUMBR char(20),   @MasterID char(30),      @iTableID int,   @SERIES int,      @CompanyID   smallint,    @BalAmt numeric(19,5), @CURNCYID char(15), @CURRNIDX smallint, @RATETPID char(15), @EXGTBLID char(15), @XCHGRATE numeric(19,7), @EXCHDATE datetime, @TIME1 datetime,  @RTCLCMTD smallint, @DENXRATE numeric(19,7), @MCTRXSTT smallint, @DECPLACS   smallint, @SqlSessionID int, @INTERID char(5) , @Post int, @OFFINDX int, @TRXSORCE char(13), @O_iErrorState   int = 0 output,   @oErrString   varchar(255) output   with encryption as  set transaction isolation level read uncommitted set nocount on  begin   declare   @Status  smallint,  @iStatus int,  @iError int,  @O_oErrorState int,  @O_iErrorStateDist int,  @O_iErrorStringDist varchar(255)   Select   @Status = 0,  @iStatus = 0,  @iError = 0,  @O_oErrorState = 0,  @O_iErrorStateDist = 0,  @O_iErrorStringDist = ''   Select @CompanyID = CMPANYID from DYNAMICS..SY01500 c (nolock) where c.INTERID = db_name()  exec aagSubWorkHdrUpdate   @DOCTYPE,  @DOCNUMBR,  @MasterID,   @iTableID,  @SERIES,  @CompanyID,  @aaSubLedgerHdrID output  select @iError = @@error  if @iError <> 0 or @iStatus <> 0  begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@oErrString))  select @O_iErrorState = 8169    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  exec @iStatus = aagSubWorkDistUpdate   @aaSubLedgerHdrID,   @aaSubWorkDistID,   @DOCTYPE,  @DOCNUMBR,  @MasterID,  @iTableID,  @SERIES,  @CURNCYID,  @CURRNIDX,   @RATETPID,  @EXGTBLID,  @XCHGRATE,  @EXCHDATE,  @TIME1,  @RTCLCMTD,  @DENXRATE,  @MCTRXSTT,  @DECPLACS,  @BalAmt,  @CompanyID,  @SqlSessionID,  @INTERID,  @Post,  @OFFINDX,  @TRXSORCE,  @O_iErrorStateDist output,  @O_iErrorStringDist output   select @iError = @@error  if @iError <> 0 or @iStatus <> 0 or @O_iErrorStateDist <> 0  begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@O_iErrorStringDist))  select @O_iErrorState = 9449    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end    
GO
GRANT EXECUTE ON  [dbo].[aagCreateSubWorkDist] TO [DYNGRP]
GO
