SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[seeStateWageHourReport]    @IN_sEmpID char(15),   @IN_eEmpID char(15),   @IN_sChkDt datetime,   @IN_eChkDt datetime,   @IN_sStateCd char(2),   @IN_eStateCd char(2)   AS  SELECT   CASE UPR30300.PAYROLCD WHEN NULL THEN UPR00700.STATECD ELSE UPR30300.PAYROLCD END AS [State], UPR00700.EMPLOYID AS [Employee_ID],  RTRIM(UPR00100.LASTNAME)+', '+RTRIM(UPR00100.FRSTNAME)+' '+RTRIM(UPR00100.MIDLNAME) AS [Name], UPR00100.SOCSCNUM AS [Social_Security_Number], ISNULL(sum(UPR30300.TXBLWAGS),0)AS [Taxable_Wages], ISNULL(sum(UPR30300.UPRTRXAM),0) AS [Tax_Withholding]  FROM UPR00700  LEFT JOIN UPR30300 ON UPR30300.PAYROLCD = UPR00700.STATECD   AND UPR30300.EMPLOYID = UPR00700.EMPLOYID  LEFT JOIN UPR00100 ON UPR00100.EMPLOYID=UPR00700.EMPLOYID   WHERE  ISNULL(UPR30300.CHEKDATE,@IN_sChkDt) BETWEEN  @IN_sChkDt AND  @IN_eChkDt AND UPR00700.STATECD BETWEEN @IN_sStateCd AND @IN_eStateCd AND  UPR00700.EMPLOYID BETWEEN @IN_sEmpID AND @IN_eEmpID AND UPR00700.STATECD <> ''   GROUP BY  UPR30300.PAYROLCD, UPR00700.EMPLOYID, UPR00700.STATECD, UPR30300.EMPLOYID, UPR00100.LASTNAME, UPR00100.FRSTNAME, UPR00100.MIDLNAME, UPR00100.SOCSCNUM   
GO
GRANT EXECUTE ON  [dbo].[seeStateWageHourReport] TO [DYNGRP]
GO
GRANT EXECUTE ON  [dbo].[seeStateWageHourReport] TO [rpt_payroll]
GO
GRANT EXECUTE ON  [dbo].[seeStateWageHourReport] TO [rpt_power user]
GO
