SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[smBindTableDefaults] @I_sAction smallint = NULL, @O_iErrorState int = NULL output  as  declare  @vcObject varchar(255),  @iCount int,  @tTransaction tinyint,  @tLoop tinyint  if @I_sAction is NULL begin  select @O_iErrorState = 20758  return end  if @@trancount <> 0 begin  select @O_iErrorState = 20749  return end  select @O_iErrorState = 0   create table #defaults (  vcObject  varchar(255) not null)  while (@tLoop is NULL) begin  select @tLoop = 1   if @I_sAction = 0 or  @I_sAction = 1   begin  insert into #defaults (  vcObject)  select  object_name(c.id) + '.' + c.name   from   dbo.syscolumns c,  dbo.sysobjects  o  where   c.id = o.id  and c.type = 61   and o.type = 'U'  and  o.uid  = 1  and  c.name not like 'padding_to_fill%'  and  c.name not like 'DEX_ROW_ID'  and  c.id in (select id from syscolumns where name like 'DEX_ROW_ID')  and  c.cdefault= 0  and COLUMNPROPERTY(c.id, c.name, 'IsIdentity') = 0   select @iCount = @@rowcount   set rowcount 1   while @iCount > 0   begin  select  @vcObject = vcObject  from  #defaults   exec sp_bindefault GPS_DATE, @vcObject   delete #defaults  select @iCount = @iCount - 1  end   set rowcount 0   select @iCount = count(vcObject)  from #defaults   if @iCount <> 0  begin  select @O_iErrorState = 20751  break  end  end   if @I_sAction = 0 or  @I_sAction = 2  begin  insert into #defaults (  vcObject)  select  object_name(c.id) + '.' + c.name   from   dbo.syscolumns c,  dbo.sysobjects  o  where   c.id = o.id  and c.type = 47    and o.type = 'U'  and o.uid  = 1  and  c.name not like 'padding_to_fill%'  and  c.name not like 'DEX_ROW_ID'  and  c.id in (select id from syscolumns where name like 'DEX_ROW_ID')  and  c.cdefault= 0  and COLUMNPROPERTY(c.id, c.name, 'IsIdentity') = 0   select @iCount = @@rowcount   set rowcount 1   while @iCount > 0   begin  select  @vcObject = vcObject  from  #defaults   exec sp_bindefault GPS_CHAR, @vcObject   delete #defaults  select @iCount = @iCount - 1  end   set rowcount 0   select @iCount = count(vcObject)  from #defaults   if @iCount <> 0  begin  select @O_iErrorState = 20750  break  end  end   if @I_sAction = 0 or  @I_sAction = 3  begin  insert into #defaults (  vcObject)  select  object_name(c.id) + '.' + c.name   from   dbo.syscolumns c,  dbo.sysobjects  o  where   c.id = o.id  and o.type = 'U'  and (c.type = 45    or c.type = 48    or c.type = 52    or  c.type = 56)    and o.uid  = 1  and  c.name not like 'padding_to_fill%'  and  c.name not like 'DEX_ROW_ID'  and  c.id in (select id from syscolumns where name like 'DEX_ROW_ID')  and  c.cdefault= 0  and COLUMNPROPERTY(c.id, c.name, 'IsIdentity') = 0   select @iCount = @@rowcount   set rowcount 1   while @iCount > 0   begin  select  @vcObject = vcObject  from  #defaults   exec sp_bindefault GPS_INT, @vcObject   delete #defaults  select @iCount = @iCount - 1  end   set rowcount 0   select @iCount = count(vcObject)  from #defaults   if @iCount <> 0  begin  select @O_iErrorState = 20752  break  end  end   if @I_sAction = 0 or  @I_sAction = 4   begin  insert into #defaults (  vcObject)  select  object_name(c.id) + '.' + c.name   from   dbo.syscolumns c,  dbo.sysobjects  o  where   c.id = o.id  and (c.type = 60 or c.type = 63)   and o.type = 'U'  and o.uid  = 1  and  c.name not like 'padding_to_fill%'  and  c.name not like 'DEX_ROW_ID'  and  c.id in (select id from syscolumns where name like 'DEX_ROW_ID')  and  c.cdefault= 0  and COLUMNPROPERTY(c.id, c.name, 'IsIdentity') = 0   select @iCount = @@rowcount   set rowcount 1   while @iCount > 0   begin  select  @vcObject = vcObject  from  #defaults   exec sp_bindefault GPS_MONEY, @vcObject   delete #defaults  select @iCount = @iCount - 1  end   set rowcount 0   select @iCount = count(vcObject)  from #defaults   if @iCount <> 0  begin  select @O_iErrorState = 20753  break  end  end   if @I_sAction = 5   begin   insert into #defaults (  vcObject)  select  object_name(c.id) + '.' + c.name   from   dbo.syscolumns c,  dbo.sysobjects  o  where   c.id = o.id  and c.type = 61   and o.type = 'U'  and  (o.name = 'GL00100'  or o.name = 'GL00105'  or o.name = 'MC10000'  or o.name = 'GL10110'  or o.name = 'GL10111'  or o.name = 'GL11000'  or o.name = 'GL70500'  or o.name = 'GL70501'  or o.name = 'PM70500'  or o.name = 'RM00700'  or o.name = 'IV30500'  or o.name = 'IV70500'  or o.name = 'IV30300'  or o.name = 'IV10001'  or o.name = 'UPR70500'  or o.name = 'AF40104'  or o.name = 'AF40201'  or o.name = 'AF50300'  or o.name = 'AF00100'  or o.name = 'AF40106'  or o.name = 'AF40103'  or o.name = 'AF40105'  or o.name = 'DTA00700'  or o.name = 'GL00201'  or o.name = 'LK000003'  or o.name = 'LK000103'  or o.name = 'LK4000'  or o.name = 'SE00400'  or o.name = 'SE000401'  or o.name = 'SE810000'  or o.name = 'SE90001')  and o.uid  = 1  and  c.name not like 'padding_to_fill%'  and  c.name not like 'DEX_ROW_ID'  and  c.id in (select id from syscolumns where name like 'DEX_ROW_ID')  and  c.cdefault= 0  and COLUMNPROPERTY(c.id, c.name, 'IsIdentity') = 0   select @iCount = @@rowcount   set rowcount 1  while @iCount > 0   begin  select  @vcObject = vcObject  from  #defaults   exec sp_bindefault GPS_DATE, @vcObject   delete #defaults  select @iCount = @iCount - 1  end   set rowcount 0   if @iCount <> 0  begin  select @O_iErrorState = 20754  break  end   insert into #defaults (  vcObject)  select  object_name(c.id) + '.' + c.name   from   dbo.syscolumns c,  dbo.sysobjects  o  where   c.id = o.id  and c.type = 47   and o.type = 'U'  and  (o.name = 'GL00100'  or o.name = 'GL00100F1'  or o.name = 'GL00100F2'  or o.name = 'GL00100F3'  or o.name = 'GL00100F4'  or o.name = 'GL00105'  or o.name = 'MC10000'  or o.name = 'GL10110'  or o.name = 'GL10111'  or o.name = 'GL11000'  or o.name = 'GL70500'  or o.name = 'GL70501'  or o.name = 'PM70500'  or o.name = 'RM00700'  or o.name = 'IV30500'  or o.name = 'IV70500'  or o.name = 'IV30300'  or o.name = 'IV10001'  or o.name = 'UPR70500'  or o.name = 'AF40104'  or o.name = 'AF40201'  or o.name = 'AF50300'  or o.name = 'AF00100'  or o.name = 'AF40106'  or o.name = 'AF40103'  or o.name = 'AF40105'  or o.name = 'DTA00700'  or o.name = 'GL00201'  or o.name = 'LK000003'  or o.name = 'LK000103'  or o.name = 'LK4000'  or o.name = 'SE00400'  or o.name = 'SE000401'  or o.name = 'SE810000'  or o.name = 'SE90001')  and o.uid  = 1  and  c.name not like 'padding_to_fill%'  and  c.name not like 'DEX_ROW_ID'  and  c.id in (select id from syscolumns where name like 'DEX_ROW_ID')  and  c.cdefault= 0  and COLUMNPROPERTY(c.id, c.name, 'IsIdentity') = 0   select @iCount = @@rowcount   set rowcount 1  while @iCount > 0   begin  select  @vcObject = vcObject  from  #defaults   exec sp_bindefault GPS_CHAR, @vcObject   delete #defaults  select @iCount = @iCount - 1  end   set rowcount 0   if @iCount <> 0  begin  select @O_iErrorState = 20755  break  end   insert into #defaults (  vcObject)  select  object_name(c.id) + '.' + c.name   from   dbo.syscolumns c,  dbo.sysobjects  o  where   c.id = o.id  and (c.type = 45   or c.type = 48   or c.type = 52   or c.type = 56)   and o.type = 'U'  and  (o.name = 'GL00100'  or o.name = 'GL00100F1'  or o.name = 'GL00100F2'  or o.name = 'GL00100F3'  or o.name = 'GL00100F4'  or o.name = 'GL00105'  or o.name = 'MC10000'  or o.name = 'GL10110'  or o.name = 'GL10111'  or o.name = 'GL11000'  or o.name = 'GL70500'  or o.name = 'GL70501'  or o.name = 'PM70500'  or o.name = 'RM00700'  or o.name = 'IV30500'  or o.name = 'IV70500'  or o.name = 'IV30300'  or o.name = 'IV10001'  or o.name = 'UPR70500'  or o.name = 'AF40104'  or o.name = 'AF40201'  or o.name = 'AF50300'  or o.name = 'AF00100'  or o.name = 'AF40106'  or o.name = 'AF40103'  or o.name = 'AF40105'  or o.name = 'DTA00700'  or o.name = 'GL00201'  or o.name = 'LK000003'  or o.name = 'LK000103'  or o.name = 'LK4000'  or o.name = 'SE00400'  or o.name = 'SE000401'  or o.name = 'SE810000'  or o.name = 'SE90001')  and o.uid  = 1  and  c.name not like 'padding_to_fill%'  and  c.name not like 'DEX_ROW_ID'  and  c.id in (select id from syscolumns where name like 'DEX_ROW_ID')  and  c.cdefault= 0  and COLUMNPROPERTY(c.id, c.name, 'IsIdentity') = 0   select @iCount = @@rowcount   set rowcount 1   while @iCount > 0   begin  select  @vcObject = vcObject  from  #defaults   exec sp_bindefault GPS_INT, @vcObject   delete #defaults  select @iCount = @iCount - 1  end   set rowcount 0   if @iCount <> 0  begin  select @O_iErrorState = 20756  break  end   insert into #defaults (  vcObject)  select  object_name(c.id) + '.' + c.name   from   dbo.syscolumns c,  dbo.sysobjects  o  where   c.id = o.id  and (c.type = 60 or c.type = 63)   and o.type = 'U'  and  (o.name = 'GL00100'  or o.name = 'GL00105'  or o.name = 'MC10000'  or o.name = 'GL10110'  or o.name = 'GL10111'  or o.name = 'GL11000'  or o.name = 'GL70500'  or o.name = 'GL70501'  or o.name = 'PM70500'  or o.name = 'RM00700'  or o.name = 'IV30500'  or o.name = 'IV70500'  or o.name = 'IV30300'  or o.name = 'IV10001'  or o.name = 'UPR70500'  or o.name = 'AF40104'  or o.name = 'AF40201'  or o.name = 'AF50300'  or o.name = 'AF00100'  or o.name = 'AF40106'  or o.name = 'AF40103'  or o.name = 'AF40105'  or o.name = 'DTA00700'  or o.name = 'GL00201'  or o.name = 'LK000003'  or o.name = 'LK000103'  or o.name = 'LK4000'  or o.name = 'SE00400'  or o.name = 'SE000401'  or o.name = 'SE810000'  or o.name = 'SE90001')  and o.uid  = 1  and  c.name not like 'padding_to_fill%'  and  c.name not like 'DEX_ROW_ID'  and  c.id in (select id from syscolumns where name like 'DEX_ROW_ID')  and  c.cdefault= 0  and COLUMNPROPERTY(c.id, c.name, 'IsIdentity') = 0   select @iCount = @@rowcount   set rowcount 1  while @iCount > 0   begin  select  @vcObject = vcObject  from  #defaults   exec sp_bindefault GPS_MONEY, @vcObject   delete #defaults  select @iCount = @iCount - 1  end   set rowcount 0  if @iCount <> 0  begin  select @O_iErrorState = 20757  break  end  end end   return    
GO
GRANT EXECUTE ON  [dbo].[smBindTableDefaults] TO [DYNGRP]
GO
