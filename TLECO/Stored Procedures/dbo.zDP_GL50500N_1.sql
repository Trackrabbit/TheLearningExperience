SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_GL50500N_1] (@BS int, @USERID char(15), @ORD int, @SGMNTID char(67), @Ledger_ID smallint, @CURNCYID char(15), @TranslationCurrencyID char(15), @USERID_RS char(15), @ORD_RS int, @SGMNTID_RS char(67), @Ledger_ID_RS smallint, @CURNCYID_RS char(15), @TranslationCurrencyID_RS char(15), @USERID_RE char(15), @ORD_RE int, @SGMNTID_RE char(67), @Ledger_ID_RE smallint, @CURNCYID_RE char(15), @TranslationCurrencyID_RE char(15)) AS  set nocount on IF @USERID_RS IS NULL BEGIN SELECT TOP 25  USERID, ORD, SGMNTID, Ledger_ID, CURNCYID, TranslationCurrencyID, CURRNIDX, DECPLCUR, RATETPID, EXGTBLID, XCHGRATE, RTCLCMTD, DENXRATE, MCTRXSTT, CurrencyTranslationType, REARNAMT, ORIGAMT, Translation_Amount, RERINDX, DEX_ROW_ID FROM .GL50500 WHERE ( USERID = @USERID AND ORD = @ORD AND SGMNTID = @SGMNTID AND Ledger_ID = @Ledger_ID AND CURNCYID = @CURNCYID AND TranslationCurrencyID > @TranslationCurrencyID OR USERID = @USERID AND ORD = @ORD AND SGMNTID = @SGMNTID AND Ledger_ID = @Ledger_ID AND CURNCYID > @CURNCYID OR USERID = @USERID AND ORD = @ORD AND SGMNTID = @SGMNTID AND Ledger_ID > @Ledger_ID OR USERID = @USERID AND ORD = @ORD AND SGMNTID > @SGMNTID OR USERID = @USERID AND ORD > @ORD OR USERID > @USERID ) ORDER BY USERID ASC, ORD ASC, SGMNTID ASC, Ledger_ID ASC, CURNCYID ASC, TranslationCurrencyID ASC END ELSE IF @USERID_RS = @USERID_RE BEGIN SELECT TOP 25  USERID, ORD, SGMNTID, Ledger_ID, CURNCYID, TranslationCurrencyID, CURRNIDX, DECPLCUR, RATETPID, EXGTBLID, XCHGRATE, RTCLCMTD, DENXRATE, MCTRXSTT, CurrencyTranslationType, REARNAMT, ORIGAMT, Translation_Amount, RERINDX, DEX_ROW_ID FROM .GL50500 WHERE USERID = @USERID_RS AND ORD BETWEEN @ORD_RS AND @ORD_RE AND SGMNTID BETWEEN @SGMNTID_RS AND @SGMNTID_RE AND Ledger_ID BETWEEN @Ledger_ID_RS AND @Ledger_ID_RE AND CURNCYID BETWEEN @CURNCYID_RS AND @CURNCYID_RE AND TranslationCurrencyID BETWEEN @TranslationCurrencyID_RS AND @TranslationCurrencyID_RE AND ( USERID = @USERID AND ORD = @ORD AND SGMNTID = @SGMNTID AND Ledger_ID = @Ledger_ID AND CURNCYID = @CURNCYID AND TranslationCurrencyID > @TranslationCurrencyID OR USERID = @USERID AND ORD = @ORD AND SGMNTID = @SGMNTID AND Ledger_ID = @Ledger_ID AND CURNCYID > @CURNCYID OR USERID = @USERID AND ORD = @ORD AND SGMNTID = @SGMNTID AND Ledger_ID > @Ledger_ID OR USERID = @USERID AND ORD = @ORD AND SGMNTID > @SGMNTID OR USERID = @USERID AND ORD > @ORD OR USERID > @USERID ) ORDER BY USERID ASC, ORD ASC, SGMNTID ASC, Ledger_ID ASC, CURNCYID ASC, TranslationCurrencyID ASC END ELSE BEGIN SELECT TOP 25  USERID, ORD, SGMNTID, Ledger_ID, CURNCYID, TranslationCurrencyID, CURRNIDX, DECPLCUR, RATETPID, EXGTBLID, XCHGRATE, RTCLCMTD, DENXRATE, MCTRXSTT, CurrencyTranslationType, REARNAMT, ORIGAMT, Translation_Amount, RERINDX, DEX_ROW_ID FROM .GL50500 WHERE USERID BETWEEN @USERID_RS AND @USERID_RE AND ORD BETWEEN @ORD_RS AND @ORD_RE AND SGMNTID BETWEEN @SGMNTID_RS AND @SGMNTID_RE AND Ledger_ID BETWEEN @Ledger_ID_RS AND @Ledger_ID_RE AND CURNCYID BETWEEN @CURNCYID_RS AND @CURNCYID_RE AND TranslationCurrencyID BETWEEN @TranslationCurrencyID_RS AND @TranslationCurrencyID_RE AND ( USERID = @USERID AND ORD = @ORD AND SGMNTID = @SGMNTID AND Ledger_ID = @Ledger_ID AND CURNCYID = @CURNCYID AND TranslationCurrencyID > @TranslationCurrencyID OR USERID = @USERID AND ORD = @ORD AND SGMNTID = @SGMNTID AND Ledger_ID = @Ledger_ID AND CURNCYID > @CURNCYID OR USERID = @USERID AND ORD = @ORD AND SGMNTID = @SGMNTID AND Ledger_ID > @Ledger_ID OR USERID = @USERID AND ORD = @ORD AND SGMNTID > @SGMNTID OR USERID = @USERID AND ORD > @ORD OR USERID > @USERID ) ORDER BY USERID ASC, ORD ASC, SGMNTID ASC, Ledger_ID ASC, CURNCYID ASC, TranslationCurrencyID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_GL50500N_1] TO [DYNGRP]
GO
