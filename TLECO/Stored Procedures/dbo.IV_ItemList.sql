SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[IV_ItemList]  @I_vTableName varchar(27) = NULL,  @O_iErrorState      int         = NULL output  as  declare @iStatus int,  @iError int  select @iStatus = 0  if( @I_vTableName is NULL ) begin  select          @O_iErrorState = 21022  return end  exec  ('insert '+ @I_vTableName   + ' ([ITEMNMBR],[ITMCLSCD],[ITEMDESC],[ITEMTYPE],[DECPLQTY],[BASEUOFM],[ITMSHNAM],[ITMGEDSC],[LOCNCODE],'  + ' [QTYAVAIL],[USCATVLS_1],[USCATVLS_2],[USCATVLS_3],[USCATVLS_4],[USCATVLS_5],[USCATVLS_6],[ATYALLOC],'  + ' [QTYONHND],[QTYONORD],[InfoValue],[MKTOPROC],[INACTIVE])'  + ' select IV00101.ITEMNMBR,IV00101.ITMCLSCD,IV00101.ITEMDESC,IV00101.ITEMTYPE,IV00101.DECPLQTY,IV40201.BASEUOFM,'  + ' IV00101.ITMSHNAM, IV00101.ITMGEDSC,IV00101.LOCNCODE,'  + ' (ISNULL(IV00102.QTYONHND,0.00000) - ISNULL(IV00102.ATYALLOC,0.00000)) - ISNULL(IV00102.QTYCOMTD,0.00000), '  + ' IV00101.USCATVLS_1,IV00101.USCATVLS_2,IV00101.USCATVLS_3,IV00101.USCATVLS_4,IV00101.USCATVLS_5,IV00101.USCATVLS_6,'  + ' IV00102.ATYALLOC, IV00102.QTYONHND, IV00102.QTYONORD,'  + ' 0 as InfoValue,0 as MKTOPROC, IV00101.[INACTIVE]'  + ' FROM IV00101 LEFT OUTER JOIN IV00102 ON IV00101.ITEMNMBR = IV00102.ITEMNMBR AND IV00101.MSTRCDTY = IV00102.RCRDTYPE '  + ' LEFT OUTER JOIN IV40201 ON IV00101.UOMSCHDL = IV40201.UOMSCHDL'  )   select @iError = @@error if @iError <> 0  return (@iError)  return(@iStatus)    
GO
GRANT EXECUTE ON  [dbo].[IV_ItemList] TO [DYNGRP]
GO
