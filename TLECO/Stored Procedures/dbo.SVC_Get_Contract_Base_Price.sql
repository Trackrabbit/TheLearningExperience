SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[SVC_Get_Contract_Base_Price]  @PRICSHED char(11) OUTPUT,  @ITMCLSCD char(11) OUTPUT,  @ITEMNMBR char(31) OUTPUT,  @CUSTCLAS char(15) OUTPUT,  @CUSTNMBR char(15) OUTPUT,  @UNITCOST numeric(19,5)  OUTPUT,  @UNITPRICE numeric(19,5) OUTPUT AS SELECT  @UNITCOST = IsNull(SVC00654.UNITCOST,0),  @UNITPRICE = IsNull(SVC00654.UNITPRCE,0) FROM  SVC00654 WITH (NOLOCK) WHERE  SVC00654.PRICSHED = @PRICSHED  AND SVC00654.ITMCLSCD = ''  AND SVC00654.ITEMNMBR = @ITEMNMBR  AND SVC00654.CUSTCLAS = ''  AND SVC00654.CUSTNMBR = @CUSTNMBR if @@rowcount = 0 BEGIN  SELECT  @UNITCOST = IsNull(SVC00654.UNITCOST,0),  @UNITPRICE = IsNull(SVC00654.UNITPRCE,0)  FROM  SVC00654 WITH (NOLOCK)  WHERE  SVC00654.PRICSHED = @PRICSHED  AND SVC00654.ITMCLSCD = @ITMCLSCD  AND SVC00654.ITEMNMBR = ''  AND SVC00654.CUSTCLAS = ''  AND SVC00654.CUSTNMBR = @CUSTNMBR  if @@rowcount = 0  BEGIN  SELECT  @UNITCOST = IsNull(SVC00654.UNITCOST,0),  @UNITPRICE = IsNull(SVC00654.UNITPRCE,0)  FROM  SVC00654 WITH (NOLOCK)  WHERE  SVC00654.PRICSHED = @PRICSHED  AND SVC00654.ITMCLSCD = ''  AND SVC00654.ITEMNMBR = @ITEMNMBR  AND SVC00654.CUSTCLAS = @CUSTCLAS  AND SVC00654.CUSTNMBR = ''  if @@rowcount = 0  BEGIN  SELECT  @UNITCOST = IsNull(SVC00654.UNITCOST,0),  @UNITPRICE = IsNull(SVC00654.UNITPRCE,0)  FROM  SVC00654 WITH (NOLOCK)  WHERE  SVC00654.PRICSHED = @PRICSHED  AND SVC00654.ITMCLSCD = @ITMCLSCD  AND SVC00654.ITEMNMBR = ''  AND SVC00654.CUSTCLAS = @CUSTCLAS  AND SVC00654.CUSTNMBR = ''  if @@rowcount = 0  BEGIN  SELECT  @UNITCOST = IsNull(SVC00654.UNITCOST,0),  @UNITPRICE = IsNull(SVC00654.UNITPRCE,0)  FROM  SVC00654 WITH (NOLOCK)  WHERE  SVC00654.PRICSHED = @PRICSHED  AND SVC00654.ITMCLSCD = ''  AND SVC00654.ITEMNMBR = ''  AND SVC00654.CUSTCLAS = ''  AND SVC00654.CUSTNMBR = @CUSTNMBR  if @@rowcount = 0  BEGIN  SELECT  @UNITCOST = IsNull(SVC00654.UNITCOST,0),  @UNITPRICE = IsNull(SVC00654.UNITPRCE,0)  FROM  SVC00654 WITH (NOLOCK)  WHERE  SVC00654.PRICSHED = @PRICSHED  AND SVC00654.ITMCLSCD = ''  AND SVC00654.ITEMNMBR = ''  AND SVC00654.CUSTCLAS = @CUSTCLAS  AND SVC00654.CUSTNMBR = ''  if @@rowcount = 0  BEGIN  SELECT  @UNITCOST = IsNull(SVC00654.UNITCOST,0),  @UNITPRICE = IsNull(SVC00654.UNITPRCE,0)  FROM  SVC00654 WITH (NOLOCK)  WHERE  SVC00654.PRICSHED = @PRICSHED  AND SVC00654.ITMCLSCD = ''  AND SVC00654.ITEMNMBR = @ITEMNMBR  AND SVC00654.CUSTCLAS = ''  AND SVC00654.CUSTNMBR = ''  if @@rowcount = 0  BEGIN  SELECT  @UNITCOST = IsNull(SVC00654.UNITCOST,0),  @UNITPRICE = IsNull(SVC00654.UNITPRCE,0)  FROM  SVC00654 WITH (NOLOCK)  WHERE  SVC00654.PRICSHED = @PRICSHED  AND SVC00654.ITMCLSCD = @ITMCLSCD  AND SVC00654.ITEMNMBR = ''  AND SVC00654.CUSTCLAS = ''  AND SVC00654.CUSTNMBR = ''  if @@rowcount = 0  BEGIN  select @ITMCLSCD = '',  @ITEMNMBR = '',  @CUSTCLAS = '',  @CUSTNMBR = '',  @UNITCOST = 0,  @UNITPRICE = 0  return 99 END  ELSE  BEGIN   select @ITEMNMBR = '',  @CUSTCLAS = '',  @CUSTNMBR = ''   return 8   END  END  ELSE  BEGIN  select @ITMCLSCD = '',  @CUSTCLAS = '',  @CUSTNMBR = ''   return 7   END  END  ELSE  BEGIN   select @ITMCLSCD = '',  @ITEMNMBR = '',  @CUSTNMBR = ''   return 6   END  END  ELSE  BEGIN   select @ITMCLSCD = '',  @ITEMNMBR = '',  @CUSTCLAS = ''  return 5   END  END  ELSE  BEGIN   select @ITEMNMBR = '',  @CUSTNMBR = ''  return 4   END  END  ELSE  BEGIN   select @ITMCLSCD = '',  @CUSTNMBR = ''  return 3   END  END  ELSE  BEGIN   select @ITEMNMBR = '',  @CUSTCLAS = ''  return 2   END END ELSE  BEGIN   select @ITMCLSCD = '',  @CUSTCLAS = ''  return 1  END    
GO
GRANT EXECUTE ON  [dbo].[SVC_Get_Contract_Base_Price] TO [DYNGRP]
GO
