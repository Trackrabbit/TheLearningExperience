SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create PROCEDURE [dbo].[SVC_Update_Contract_Billing]  ( @CONSTS smallint,  @CONTNBR char(11),  @Line numeric(19,5) ) AS declare @BILLNGTH smallint declare @BILPRD smallint declare @BILONDY smallint declare @BILCYC smallint declare @BILEND datetime, @LineBILEND datetime declare @ContSTRT datetime, @LineContSTRT datetime declare @ContEND datetime declare @BILSTRT datetime, @LineBILSTRT datetime, @HDRBILSTRT datetime declare @PREPAID tinyint declare @SVC_Liability_Type integer declare @SmoothInvoice tinyint  select @BILLNGTH = S.BILLNGTH,  @BILPRD = S.BILPRD,  @BILONDY = S.BILONDY,  @BILCYC = S.BILCYC,  @BILEND = S.BILEND,  @HDRBILSTRT = S.BILSTRT,  @ContSTRT = S.STRTDATE,  @ContEND = S.ENDDATE,  @PREPAID = S.PREPAID,  @SVC_Liability_Type = S.SVC_Liability_Type,  @SmoothInvoice = S.SmoothInvoiceCalc from   SVC00600 S WITH (nolock) where  S.CONSTS = @CONSTS and  S.CONTNBR = @CONTNBR   select @LineBILSTRT = BILSTRT, @LineBILEND = BILEND, @LineContSTRT= STRTDATE from SVC00601 where  CONSTS = @CONSTS and CONTNBR = @CONTNBR and LNSEQNBR = @Line   if @LineBILSTRT  <> @HDRBILSTRT and @LineContSTRT <> @ContSTRT  select @BILSTRT = @LineContSTRT  else  select @BILSTRT = @HDRBILSTRT if @BILSTRT < @HDRBILSTRT  select @BILSTRT = @HDRBILSTRT if @LineBILEND <> @BILEND   select @BILEND =  @LineBILEND  update SVC00601 with (rowlock)  set  SVC00601.BILCYC = @BILCYC,  SVC00601.BILPRD = @BILPRD,  SVC00601.BILONDY = @BILONDY,  SVC00601.BILLNGTH = @BILLNGTH,  SVC00601.BILEND = @BILEND,  SVC00601.BILSTRT = @BILSTRT,  SVC00601.PREPAID = @PREPAID,  SVC00601.SVC_Liability_Type = @SVC_Liability_Type where  SVC00601.CONSTS = @CONSTS and  SVC00601.CONTNBR = @CONTNBR and LNSEQNBR = @Line and  SVC00601.BILSTAT = 0 and  SVC00601.Contract_Line_Status <> 'C'     
GO
GRANT EXECUTE ON  [dbo].[SVC_Update_Contract_Billing] TO [DYNGRP]
GO
