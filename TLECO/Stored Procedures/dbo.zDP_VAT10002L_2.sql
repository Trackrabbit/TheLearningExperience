SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_VAT10002L_2] (@TMCODEDESC_RS char(31), @TMCODE_RS char(7), @TMCODEDESC_RE char(31), @TMCODE_RE char(7)) AS  set nocount on IF @TMCODEDESC_RS IS NULL BEGIN SELECT TOP 25  TMCODE, TMCODEDESC, NOTEINDX, DEX_ROW_ID FROM .VAT10002 ORDER BY TMCODEDESC DESC, TMCODE DESC, DEX_ROW_ID DESC END ELSE IF @TMCODEDESC_RS = @TMCODEDESC_RE BEGIN SELECT TOP 25  TMCODE, TMCODEDESC, NOTEINDX, DEX_ROW_ID FROM .VAT10002 WHERE TMCODEDESC = @TMCODEDESC_RS AND TMCODE BETWEEN @TMCODE_RS AND @TMCODE_RE ORDER BY TMCODEDESC DESC, TMCODE DESC, DEX_ROW_ID DESC END ELSE BEGIN SELECT TOP 25  TMCODE, TMCODEDESC, NOTEINDX, DEX_ROW_ID FROM .VAT10002 WHERE TMCODEDESC BETWEEN @TMCODEDESC_RS AND @TMCODEDESC_RE AND TMCODE BETWEEN @TMCODE_RS AND @TMCODE_RE ORDER BY TMCODEDESC DESC, TMCODE DESC, DEX_ROW_ID DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_VAT10002L_2] TO [DYNGRP]
GO
