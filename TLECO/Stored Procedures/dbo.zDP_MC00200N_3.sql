SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_MC00200N_3] (@BS int, @REVALUE tinyint, @ACTINDX int, @DEX_ROW_ID int, @REVALUE_RS tinyint, @ACTINDX_RS int, @REVALUE_RE tinyint, @ACTINDX_RE int) AS  set nocount on IF @REVALUE_RS IS NULL BEGIN SELECT TOP 25  ACTINDX, CURNCYID, REVALUE, REVLUHOW, Post_Results_To, CurrencyTranslationType, DEX_ROW_TS, DEX_ROW_ID FROM .MC00200 WHERE ( REVALUE = @REVALUE AND ACTINDX = @ACTINDX AND DEX_ROW_ID > @DEX_ROW_ID OR REVALUE = @REVALUE AND ACTINDX > @ACTINDX OR REVALUE > @REVALUE ) ORDER BY REVALUE ASC, ACTINDX ASC, DEX_ROW_ID ASC END ELSE IF @REVALUE_RS = @REVALUE_RE BEGIN SELECT TOP 25  ACTINDX, CURNCYID, REVALUE, REVLUHOW, Post_Results_To, CurrencyTranslationType, DEX_ROW_TS, DEX_ROW_ID FROM .MC00200 WHERE REVALUE = @REVALUE_RS AND ACTINDX BETWEEN @ACTINDX_RS AND @ACTINDX_RE AND ( REVALUE = @REVALUE AND ACTINDX = @ACTINDX AND DEX_ROW_ID > @DEX_ROW_ID OR REVALUE = @REVALUE AND ACTINDX > @ACTINDX OR REVALUE > @REVALUE ) ORDER BY REVALUE ASC, ACTINDX ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  ACTINDX, CURNCYID, REVALUE, REVLUHOW, Post_Results_To, CurrencyTranslationType, DEX_ROW_TS, DEX_ROW_ID FROM .MC00200 WHERE REVALUE BETWEEN @REVALUE_RS AND @REVALUE_RE AND ACTINDX BETWEEN @ACTINDX_RS AND @ACTINDX_RE AND ( REVALUE = @REVALUE AND ACTINDX = @ACTINDX AND DEX_ROW_ID > @DEX_ROW_ID OR REVALUE = @REVALUE AND ACTINDX > @ACTINDX OR REVALUE > @REVALUE ) ORDER BY REVALUE ASC, ACTINDX ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_MC00200N_3] TO [DYNGRP]
GO
