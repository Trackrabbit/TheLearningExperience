SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_AAG00904N_1] (@BS int, @aaBudgetID int, @aaCodeSequence int, @PERIODDT datetime, @aaFiscalPeriod smallint, @aaActualPriliminary int, @aaBudgetID_RS int, @aaCodeSequence_RS int, @PERIODDT_RS datetime, @aaFiscalPeriod_RS smallint, @aaActualPriliminary_RS int, @aaBudgetID_RE int, @aaCodeSequence_RE int, @PERIODDT_RE datetime, @aaFiscalPeriod_RE smallint, @aaActualPriliminary_RE int) AS  set nocount on IF @aaBudgetID_RS IS NULL BEGIN SELECT TOP 25  aaBudgetID, aaCodeSequence, PERIODDT, aaFiscalPeriod, aaActualPriliminary, Balance, QUANTITY, YEAR1, DEX_ROW_TS, DEX_ROW_ID FROM .AAG00904 WHERE ( aaBudgetID = @aaBudgetID AND aaCodeSequence = @aaCodeSequence AND PERIODDT = @PERIODDT AND aaFiscalPeriod = @aaFiscalPeriod AND aaActualPriliminary > @aaActualPriliminary OR aaBudgetID = @aaBudgetID AND aaCodeSequence = @aaCodeSequence AND PERIODDT = @PERIODDT AND aaFiscalPeriod > @aaFiscalPeriod OR aaBudgetID = @aaBudgetID AND aaCodeSequence = @aaCodeSequence AND PERIODDT > @PERIODDT OR aaBudgetID = @aaBudgetID AND aaCodeSequence > @aaCodeSequence OR aaBudgetID > @aaBudgetID ) ORDER BY aaBudgetID ASC, aaCodeSequence ASC, PERIODDT ASC, aaFiscalPeriod ASC, aaActualPriliminary ASC END ELSE IF @aaBudgetID_RS = @aaBudgetID_RE BEGIN SELECT TOP 25  aaBudgetID, aaCodeSequence, PERIODDT, aaFiscalPeriod, aaActualPriliminary, Balance, QUANTITY, YEAR1, DEX_ROW_TS, DEX_ROW_ID FROM .AAG00904 WHERE aaBudgetID = @aaBudgetID_RS AND aaCodeSequence BETWEEN @aaCodeSequence_RS AND @aaCodeSequence_RE AND PERIODDT BETWEEN @PERIODDT_RS AND @PERIODDT_RE AND aaFiscalPeriod BETWEEN @aaFiscalPeriod_RS AND @aaFiscalPeriod_RE AND aaActualPriliminary BETWEEN @aaActualPriliminary_RS AND @aaActualPriliminary_RE AND ( aaBudgetID = @aaBudgetID AND aaCodeSequence = @aaCodeSequence AND PERIODDT = @PERIODDT AND aaFiscalPeriod = @aaFiscalPeriod AND aaActualPriliminary > @aaActualPriliminary OR aaBudgetID = @aaBudgetID AND aaCodeSequence = @aaCodeSequence AND PERIODDT = @PERIODDT AND aaFiscalPeriod > @aaFiscalPeriod OR aaBudgetID = @aaBudgetID AND aaCodeSequence = @aaCodeSequence AND PERIODDT > @PERIODDT OR aaBudgetID = @aaBudgetID AND aaCodeSequence > @aaCodeSequence OR aaBudgetID > @aaBudgetID ) ORDER BY aaBudgetID ASC, aaCodeSequence ASC, PERIODDT ASC, aaFiscalPeriod ASC, aaActualPriliminary ASC END ELSE BEGIN SELECT TOP 25  aaBudgetID, aaCodeSequence, PERIODDT, aaFiscalPeriod, aaActualPriliminary, Balance, QUANTITY, YEAR1, DEX_ROW_TS, DEX_ROW_ID FROM .AAG00904 WHERE aaBudgetID BETWEEN @aaBudgetID_RS AND @aaBudgetID_RE AND aaCodeSequence BETWEEN @aaCodeSequence_RS AND @aaCodeSequence_RE AND PERIODDT BETWEEN @PERIODDT_RS AND @PERIODDT_RE AND aaFiscalPeriod BETWEEN @aaFiscalPeriod_RS AND @aaFiscalPeriod_RE AND aaActualPriliminary BETWEEN @aaActualPriliminary_RS AND @aaActualPriliminary_RE AND ( aaBudgetID = @aaBudgetID AND aaCodeSequence = @aaCodeSequence AND PERIODDT = @PERIODDT AND aaFiscalPeriod = @aaFiscalPeriod AND aaActualPriliminary > @aaActualPriliminary OR aaBudgetID = @aaBudgetID AND aaCodeSequence = @aaCodeSequence AND PERIODDT = @PERIODDT AND aaFiscalPeriod > @aaFiscalPeriod OR aaBudgetID = @aaBudgetID AND aaCodeSequence = @aaCodeSequence AND PERIODDT > @PERIODDT OR aaBudgetID = @aaBudgetID AND aaCodeSequence > @aaCodeSequence OR aaBudgetID > @aaBudgetID ) ORDER BY aaBudgetID ASC, aaCodeSequence ASC, PERIODDT ASC, aaFiscalPeriod ASC, aaActualPriliminary ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_AAG00904N_1] TO [DYNGRP]
GO
