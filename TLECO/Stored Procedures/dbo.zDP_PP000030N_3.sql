SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_PP000030N_3] (@BS int, @PP_Profile_Name char(21), @USERID char(15), @DEX_ROW_ID int, @PP_Profile_Name_RS char(21), @USERID_RS char(15), @PP_Profile_Name_RE char(21), @USERID_RE char(15)) AS  set nocount on IF @PP_Profile_Name_RS IS NULL BEGIN SELECT TOP 25  PP_User_Security_Type, USERID, PP_Profile_Name, PP_User_Access, PP_Edit_Profile_Original, PP_Edit_Profile_Offset_A, PP_Edit_Profile_Deferred, PP_Edit_Profile_CI_Accou, PP_Edit_Profile_Transfer, PP_Edit_Profile_Start_Da, PP_Edit_Profile_Calculat, PP_Edit_Profile_Periods, PP_Edit_Profile_Miscella, PP_Edit_Debit_Credit, PP_Module, DEX_ROW_ID FROM .PP000030 WHERE ( PP_Profile_Name = @PP_Profile_Name AND USERID = @USERID AND DEX_ROW_ID > @DEX_ROW_ID OR PP_Profile_Name = @PP_Profile_Name AND USERID > @USERID OR PP_Profile_Name > @PP_Profile_Name ) ORDER BY PP_Profile_Name ASC, USERID ASC, DEX_ROW_ID ASC END ELSE IF @PP_Profile_Name_RS = @PP_Profile_Name_RE BEGIN SELECT TOP 25  PP_User_Security_Type, USERID, PP_Profile_Name, PP_User_Access, PP_Edit_Profile_Original, PP_Edit_Profile_Offset_A, PP_Edit_Profile_Deferred, PP_Edit_Profile_CI_Accou, PP_Edit_Profile_Transfer, PP_Edit_Profile_Start_Da, PP_Edit_Profile_Calculat, PP_Edit_Profile_Periods, PP_Edit_Profile_Miscella, PP_Edit_Debit_Credit, PP_Module, DEX_ROW_ID FROM .PP000030 WHERE PP_Profile_Name = @PP_Profile_Name_RS AND USERID BETWEEN @USERID_RS AND @USERID_RE AND ( PP_Profile_Name = @PP_Profile_Name AND USERID = @USERID AND DEX_ROW_ID > @DEX_ROW_ID OR PP_Profile_Name = @PP_Profile_Name AND USERID > @USERID OR PP_Profile_Name > @PP_Profile_Name ) ORDER BY PP_Profile_Name ASC, USERID ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  PP_User_Security_Type, USERID, PP_Profile_Name, PP_User_Access, PP_Edit_Profile_Original, PP_Edit_Profile_Offset_A, PP_Edit_Profile_Deferred, PP_Edit_Profile_CI_Accou, PP_Edit_Profile_Transfer, PP_Edit_Profile_Start_Da, PP_Edit_Profile_Calculat, PP_Edit_Profile_Periods, PP_Edit_Profile_Miscella, PP_Edit_Debit_Credit, PP_Module, DEX_ROW_ID FROM .PP000030 WHERE PP_Profile_Name BETWEEN @PP_Profile_Name_RS AND @PP_Profile_Name_RE AND USERID BETWEEN @USERID_RS AND @USERID_RE AND ( PP_Profile_Name = @PP_Profile_Name AND USERID = @USERID AND DEX_ROW_ID > @DEX_ROW_ID OR PP_Profile_Name = @PP_Profile_Name AND USERID > @USERID OR PP_Profile_Name > @PP_Profile_Name ) ORDER BY PP_Profile_Name ASC, USERID ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_PP000030N_3] TO [DYNGRP]
GO
