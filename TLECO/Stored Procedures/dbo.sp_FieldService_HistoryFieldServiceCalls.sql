SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_FieldService_HistoryFieldServiceCalls] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @Service_Call_Number varchar(255), @Service_Record_Type varchar(255), @Service_Call_Status varchar(255), @Service_Type varchar(255), @Service_Description varchar(255), @PriorityLevel varchar(255), @Customer_ID varchar(255), @Customer_Reference varchar(255), @Address_Code varchar(255), @Name varchar(255), @Address_1 varchar(255), @Address_2 varchar(255), @City varchar(255), @State varchar(255), @Zip varchar(255), @Contact_Person varchar(255), @Phone_1 varchar(255), @Office_ID varchar(255), @Service_Area varchar(255), @Tech_ID varchar(255), @TimeZone varchar(255), @Entry_Date varchar(255), @Entry_Time varchar(255), @Notify_Date varchar(255), @Notify_Time varchar(255), @ETA_Date varchar(255), @ETA_Time varchar(255), @Dispatch_Date varchar(255), @Dispatch_Time varchar(255), @Arrival_Date varchar(255), @Arrival_Time varchar(255), @Complete_Date varchar(255), @Complete_Time varchar(255), @Response_Date varchar(255), @Response_Time varchar(255), @Price_Level varchar(255), @Payment_Terms_ID varchar(255), @Salesperson_ID varchar(255), @Labor_Sub_Total_Price varchar(255), @Labor_Pct varchar(255), @Labor_Sub_Total_Cost varchar(255), @Part_Sub_Total_Price varchar(255), @Part_Pct varchar(255), @Part_Sub_Total_Cost varchar(255), @Misc_Sub_Total_Price varchar(255), @Misc_Pct varchar(255), @Misc_Sub_Total_Cost varchar(255), @Tax_Schedule_ID varchar(255), @Tax_Exempt_1 varchar(255), @Tax_Exempt_2 varchar(255), @PreTax_Total varchar(255), @Tax_Amount varchar(255), @Total varchar(255), @Invoiced_Amount varchar(255), @Meter_1 varchar(255), @Meter_2 varchar(255), @Meter_3 varchar(255), @Purchase_Order_Number varchar(255), @Note_Index varchar(255), @Notify_Flag varchar(255), @User_Defined_1 varchar(255), @User_Defined_2 varchar(255), @User_Defined_3 varchar(255), @User_Defined_4 varchar(255), @User_Defined_5 varchar(255), @Master_Service_Record_Type varchar(255), @Master_Service_Call_Number varchar(255), @Escalation_Date varchar(255), @Escalation_Time varchar(255), @Escalation_Level varchar(255), @Split_Terms_Code varchar(255), @Callback varchar(255), @Project_ID varchar(255), @ProjectRef1 varchar(255), @Contract_Record_Type varchar(255), @Contract_Number varchar(255), @SVC_Contract_Line_SEQ_Number varchar(255), @ETTR varchar(255), @SVC_On_Hold varchar(255), @Print_to_Web varchar(255), @Meters varchar(255), @Meter_Internal_Uses varchar(255), @Bill_To_Customer_ID varchar(255), @Currency_ID varchar(255), @SVC_Bill_To_Address_Code varchar(255), @Currency_Index varchar(255), @Rate_Type_ID varchar(255), @Exchange_Table_ID varchar(255), @Exchange_Rate varchar(255), @Exchange_Date varchar(255), @Decimal_Places varchar(255), @Time varchar(255), @Rate_Calc_Method varchar(255), @View_Mode varchar(255), @IS_MC_Trx varchar(255), @Expiration_Date varchar(255), @Denomination_Exchange_Rate varchar(255), @MC_Transaction_State varchar(255), @Originating_Misc_Sub_Total_Cost varchar(255), @Originating_Misc_Sub_Total_Price varchar(255), @Originating_Labor_Sub_Total_Cost varchar(255), @Originating_Labor_Sub_Total_Price varchar(255), @Originating_Part_Sub_Total_Cost varchar(255), @Originating_Part_Sub_Total_Price varchar(255), @Originating_PreTax_Total varchar(255), @Originating_Tax_Amount varchar(255), @Originating_Service_Total varchar(255), @Originating_Invoiced_Amount varchar(255), @Address_3 varchar(255), @Country varchar(255), @SVC_Pre600 varchar(255), @SVC_FO_ID varchar(255), @Replaces varchar(255), @Item_Number varchar(255), @Equipment_Serial_Number varchar(255), @Bill_To_Customer_Name varchar(255),  @DrillBack_Base_Url varchar(255), @DrillBack_Base_Url_For_FS varchar(255), @Service_Call_Number_For_DrillBack varchar(255), @Customer_ID_For_DrillBack varchar(255), @Item_Number_For_DrillBack varchar(255), @Salesperson_ID_For_DrillBack varchar(255)  select @DrillBack_Base_Url = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),0) select @DrillBack_Base_Url_For_FS = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),949)  select @I_iDictID = 949 select @I_iMessageNumber = 26000 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Call_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 26001 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Record_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 26002 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Call_Status output  select @I_iDictID = 949 select @I_iMessageNumber = 26003 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 26004 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Description output  select @I_iDictID = 949 select @I_iMessageNumber = 26005 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @PriorityLevel output  select @I_iDictID = 949 select @I_iMessageNumber = 26006 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26007 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_Reference output  select @I_iDictID = 949 select @I_iMessageNumber = 26008 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 26009 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Name output  select @I_iDictID = 949 select @I_iMessageNumber = 26010 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 26011 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 26012 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @City output  select @I_iDictID = 949 select @I_iMessageNumber = 26013 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @State output  select @I_iDictID = 949 select @I_iMessageNumber = 26014 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Zip output  select @I_iDictID = 949 select @I_iMessageNumber = 26015 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Contact_Person output  select @I_iDictID = 949 select @I_iMessageNumber = 26016 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Phone_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 26017 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Office_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26018 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Area output  select @I_iDictID = 949 select @I_iMessageNumber = 26019 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tech_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26020 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TimeZone output  select @I_iDictID = 949 select @I_iMessageNumber = 26021 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Entry_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26022 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Entry_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 26023 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Notify_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26024 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Notify_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 26025 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ETA_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26026 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ETA_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 26027 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Dispatch_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26028 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Dispatch_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 26029 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Arrival_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26030 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Arrival_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 26031 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Complete_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26032 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Complete_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 26033 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Response_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26034 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Response_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 26035 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Price_Level output  select @I_iDictID = 949 select @I_iMessageNumber = 26036 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Payment_Terms_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26037 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Salesperson_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26038 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Labor_Sub_Total_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 26039 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Labor_Pct output  select @I_iDictID = 949 select @I_iMessageNumber = 26040 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Labor_Sub_Total_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 26041 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Part_Sub_Total_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 26042 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Part_Pct output  select @I_iDictID = 949 select @I_iMessageNumber = 26043 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Part_Sub_Total_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 26044 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Misc_Sub_Total_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 26045 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Misc_Pct output  select @I_iDictID = 949 select @I_iMessageNumber = 26046 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Misc_Sub_Total_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 26047 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tax_Schedule_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26048 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tax_Exempt_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 26049 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tax_Exempt_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 26050 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @PreTax_Total output  select @I_iDictID = 949 select @I_iMessageNumber = 26051 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tax_Amount output  select @I_iDictID = 949 select @I_iMessageNumber = 26052 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Total output  select @I_iDictID = 949 select @I_iMessageNumber = 26053 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Invoiced_Amount output  select @I_iDictID = 949 select @I_iMessageNumber = 26054 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Meter_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 26055 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Meter_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 26056 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Meter_3 output  select @I_iDictID = 949 select @I_iMessageNumber = 26057 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purchase_Order_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 26058 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Note_Index output  select @I_iDictID = 949 select @I_iMessageNumber = 26059 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Notify_Flag output  select @I_iDictID = 949 select @I_iMessageNumber = 26060 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 26061 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 26062 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_3 output  select @I_iDictID = 949 select @I_iMessageNumber = 26063 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_4 output  select @I_iDictID = 949 select @I_iMessageNumber = 26064 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_5 output  select @I_iDictID = 949 select @I_iMessageNumber = 26065 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Master_Service_Record_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 26066 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Master_Service_Call_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 26067 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Escalation_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26068 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Escalation_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 26069 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Escalation_Level output  select @I_iDictID = 949 select @I_iMessageNumber = 26070 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Split_Terms_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 26071 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Callback output  select @I_iDictID = 949 select @I_iMessageNumber = 26072 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Project_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26073 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ProjectRef1 output  select @I_iDictID = 949 select @I_iMessageNumber = 26074 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Contract_Record_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 26075 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Contract_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 26076 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Contract_Line_SEQ_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 26077 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ETTR output  select @I_iDictID = 949 select @I_iMessageNumber = 26078 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_On_Hold output  select @I_iDictID = 949 select @I_iMessageNumber = 26079 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Print_to_Web output  select @I_iDictID = 949 select @I_iMessageNumber = 26080 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Meters output  select @I_iDictID = 949 select @I_iMessageNumber = 26081 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Meter_Internal_Uses output  select @I_iDictID = 949 select @I_iMessageNumber = 26082 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Bill_To_Customer_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26083 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Currency_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26084 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Bill_To_Address_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 26085 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Currency_Index output  select @I_iDictID = 949 select @I_iMessageNumber = 26086 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Rate_Type_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26087 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Table_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26088 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Rate output  select @I_iDictID = 949 select @I_iMessageNumber = 26089 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Exchange_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26090 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Decimal_Places output  select @I_iDictID = 949 select @I_iMessageNumber = 26091 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Time output  select @I_iDictID = 949 select @I_iMessageNumber = 26092 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Rate_Calc_Method output  select @I_iDictID = 949 select @I_iMessageNumber = 26093 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @View_Mode output  select @I_iDictID = 949 select @I_iMessageNumber = 26094 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @IS_MC_Trx output  select @I_iDictID = 949 select @I_iMessageNumber = 26095 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Expiration_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 26096 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Denomination_Exchange_Rate output  select @I_iDictID = 949 select @I_iMessageNumber = 26097 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @MC_Transaction_State output  select @I_iDictID = 949 select @I_iMessageNumber = 26098 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Misc_Sub_Total_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 26099 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Misc_Sub_Total_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 26100 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Labor_Sub_Total_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 26101 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Labor_Sub_Total_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 26102 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Part_Sub_Total_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 26103 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Part_Sub_Total_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 26104 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_PreTax_Total output  select @I_iDictID = 949 select @I_iMessageNumber = 26105 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Tax_Amount output  select @I_iDictID = 949 select @I_iMessageNumber = 26106 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Service_Total output  select @I_iDictID = 949 select @I_iMessageNumber = 26107 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Invoiced_Amount output  select @I_iDictID = 949 select @I_iMessageNumber = 26108 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_3 output  select @I_iDictID = 949 select @I_iMessageNumber = 26109 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Country output  select @I_iDictID = 949 select @I_iMessageNumber = 26110 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Pre600 output  select @I_iDictID = 949 select @I_iMessageNumber = 26111 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_FO_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 26112 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Replaces output  select @I_iDictID = 949 select @I_iMessageNumber = 26180 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 26181 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Equipment_Serial_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 26182 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Bill_To_Customer_Name output   select @I_iDictID = 949 select @I_iMessageNumber = 26000 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Call_Number_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 26006 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_ID_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 26037 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Salesperson_ID_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 26180 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number_For_DrillBack output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[HistoryFieldServiceCalls]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[HistoryFieldServiceCalls] '  select @sqldefaultstring =   'CREATE VIEW HistoryFieldServiceCalls AS ' +   'select ' +   'rtrim([''Service Call Master History''].[CALLNBR]) as ''' + @Service_Call_Number + ''', ' + '''' + @Service_Record_Type + ''' = dbo.FS_FUNC_Service_Record_Type([''Service Call Master History''].[SRVRECTYPE]), ' + 'rtrim([''Service Call Master History''].[SRVSTAT]) as ''' + @Service_Call_Status + ''', ' + 'rtrim([''Service Call Master History''].[SRVTYPE]) as ''' + @Service_Type + ''', ' + 'rtrim([''Service Call Master History''].[SVCDESCR]) as ''' + @Service_Description + ''', ' + '[''Service Call Master History''].[priorityLevel] as ''' + @PriorityLevel + ''', ' + 'rtrim([''RM Customer MSTR''].[CUSTNMBR]) as ''' + @Customer_ID + ''', ' + 'rtrim([''Service Call Master History''].[Customer_Reference]) as ''' + @Customer_Reference + ''', ' + 'rtrim([''Service Call Master History''].[ADRSCODE]) as ''' + @Address_Code + ''', ' + 'rtrim([''RM Customer MSTR''].[CUSTNAME]) as ''' + @Name + ''', ' + 'rtrim([''Service Call Master History''].[OFFID]) as ''' + @Office_ID + ''', ' + 'rtrim([''Service Call Master History''].[SVCAREA]) as ''' + @Service_Area + ''', ' + 'rtrim([''Service Call Master History''].[TECHID]) as ''' + @Tech_ID + ''', ' + '[''Service Call Master History''].[ENTDTE] as ''' + @Entry_Date + ''', ' + '[''Service Call Master History''].[TOTAL] as ''' + @Total + ''', '   select @sqlstring1 =   'rtrim([''Service Call Master History''].[ADDRESS1]) as ''' + @Address_1 + ''', ' +  'rtrim([''Service Call Master History''].[ADDRESS2]) as ''' + @Address_2 + ''', ' +  'rtrim([''Service Call Master History''].[ADDRESS3]) as ''' + @Address_3 + ''', ' +  '[''Service Call Master History''].[ARRIVDTE] as ''' + @Arrival_Date + ''', ' +  '[''Service Call Master History''].[ARRIVTME] as ''' + @Arrival_Time + ''', ' +  'rtrim([''RM Customer MSTR2''].[CUSTNMBR]) as ''' + @Bill_To_Customer_ID + ''', ' +  'rtrim([''RM Customer MSTR2''].[CUSTNAME]) as ''' + @Bill_To_Customer_Name + ''', ' +  '''' + @Callback + ''' = dbo.DYN_FUNC_Boolean_All([''Service Call Master History''].[Callback]), ' +  'rtrim([''Service Call Master History''].[CITY]) as ''' + @City + ''', ' +  '[''Service Call Master History''].[COMPDTE] as ''' + @Complete_Date + ''', ' +  '[''Service Call Master History''].[COMPTME] as ''' + @Complete_Time + ''', ' +  'rtrim([''Service Call Master History''].[CNTCPRSN]) as ''' + @Contact_Person + ''', ' +  'rtrim([''Service Call Master History''].[CONTNBR]) as ''' + @Contract_Number + ''', ' +  '''' + @Contract_Record_Type + ''' = dbo.FS_FUNC_Contract_Record_Type([''Service Call Master History''].[CONSTS]), ' +  'rtrim([''Service Call Master History''].[COUNTRY]) as ''' + @Country + ''', ' +  'rtrim([''Service Call Master History''].[CURNCYID]) as ''' + @Currency_ID + ''', ' +  '[''Service Call Master History''].[CURRNIDX] as ''' + @Currency_Index + ''', ' +  '''' + @Decimal_Places + ''' = dbo.DYN_FUNC_Decimal_Places_QTYS([''Service Call Master History''].[DECPLACS]), ' +  '[''Service Call Master History''].[DENXRATE] as ''' + @Denomination_Exchange_Rate + ''', ' +  '[''Service Call Master History''].[DISPDTE] as ''' + @Dispatch_Date + ''', ' +  '[''Service Call Master History''].[DISPTME] as ''' + @Dispatch_Time + ''', ' +  '[''Service Call Master History''].[ETADTE] as ''' + @ETA_Date + ''', ' +  '[''Service Call Master History''].[ETATME] as ''' + @ETA_Time + ''', ' +  '[''Service Call Master History''].[ETTR] as ''' + @ETTR + ''', ' +  '[''Service Call Master History''].[ENTTME] as ''' + @Entry_Time + ''', ' +  'rtrim([''Serial Master''].[SERLNMBR]) as ''' + @Equipment_Serial_Number + ''', ' +  '[''Service Call Master History''].[ESCDATE] as ''' + @Escalation_Date + ''', ' +  '[''Service Call Master History''].[Escalation_Level] as ''' + @Escalation_Level + ''', ' +  '[''Service Call Master History''].[ESCTIME] as ''' + @Escalation_Time + ''', ' +  '[''Service Call Master History''].[EXCHDATE] as ''' + @Exchange_Date + ''', ' +  '[''Service Call Master History''].[XCHGRATE] as ''' + @Exchange_Rate + ''', ' +  'rtrim([''Service Call Master History''].[EXGTBLID]) as ''' + @Exchange_Table_ID + ''', ' +  '[''Service Call Master History''].[EXPNDATE] as ''' + @Expiration_Date + ''', ' +  '[''Service Call Master History''].[ISMCTRX] as ''' + @IS_MC_Trx + ''', ' +  '[''Service Call Master History''].[Invoiced_Amount] as ''' + @Invoiced_Amount + ''', ' +  'rtrim([''Service Call Equipment History''].[ITEMNMBR]) as ''' + @Item_Number + ''', ' +  '[''Service Call Master History''].[LABPCT] as ''' + @Labor_Pct + ''', ' +  '[''Service Call Master History''].[LABSTOTCST] as ''' + @Labor_Sub_Total_Cost + ''', ' +  '[''Service Call Master History''].[LABSTOTPRC] as ''' + @Labor_Sub_Total_Price + ''', ' +  '[''Service Call Master History''].[MCTRXSTT] as ''' + @MC_Transaction_State + ''', ' +  'rtrim([''Service Call Master History''].[MSTRCALLNBR]) as ''' + @Master_Service_Call_Number + ''', ' +  '''' + @Master_Service_Record_Type + ''' = dbo.FS_FUNC_Master_Service_Record_Type([''Service Call Master History''].[MSTRRECTYPE]), ' +  '[''Service Call Master History''].[METER1] as ''' + @Meter_1 + ''', ' +  '[''Service Call Master History''].[METER2] as ''' + @Meter_2 + ''', ' +  '[''Service Call Master History''].[METER3] as ''' + @Meter_3 + ''', ' +  '[''Service Call Master History''].[Meter_Internal_Uses_1] as ''' + @Meter_Internal_Uses + ''', ' +  '[''Service Call Master History''].[Meters_1] as ''' + @Meters + ''', ' +  '[''Service Call Master History''].[MISCPCT] as ''' + @Misc_Pct + ''', ' +  '[''Service Call Master History''].[MISSTOTCST] as ''' + @Misc_Sub_Total_Cost + ''', ' +  '[''Service Call Master History''].[MSCSTOTPRC] as ''' + @Misc_Sub_Total_Price + ''', ' +  '[''Service Call Master History''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  '[''Service Call Master History''].[Notify_Date] as ''' + @Notify_Date + ''', ' +  '''' + @Notify_Flag + ''' = dbo.DYN_FUNC_Boolean_All([''Service Call Master History''].[NOTFYFLAG]), ' +  '[''Service Call Master History''].[Notify_Time] as ''' + @Notify_Time + ''', ' +  '[''Service Call Master History''].[Orig_Invoiced_Amount] as ''' + @Originating_Invoiced_Amount + ''', ' +  '[''Service Call Master History''].[ORIGLABSUBTOTCOST] as ''' + @Originating_Labor_Sub_Total_Cost + ''', ' +  '[''Service Call Master History''].[ORIGLABSTOTPRC] as ''' + @Originating_Labor_Sub_Total_Price + ''', ' +  '[''Service Call Master History''].[ORIGMISSTOTCST] as ''' + @Originating_Misc_Sub_Total_Cost + ''', ' +  '[''Service Call Master History''].[ORIGMSCSTOTPRC] as ''' + @Originating_Misc_Sub_Total_Price + ''', ' +  '[''Service Call Master History''].[ORIGPARSTOTCST] as ''' + @Originating_Part_Sub_Total_Cost + ''', ' +  '[''Service Call Master History''].[ORIGPARSTOTPRC] as ''' + @Originating_Part_Sub_Total_Price + ''', ' +  '[''Service Call Master History''].[ORIGPRETAXTOT] as ''' + @Originating_PreTax_Total + ''', '   select @sqlstring2 =   '[''Service Call Master History''].[ORIGTOTAL] as ''' + @Originating_Service_Total + ''', ' +  '[''Service Call Master History''].[ORTAXAMT] as ''' + @Originating_Tax_Amount + ''', ' +  '[''Service Call Master History''].[PARTPCT] as ''' + @Part_Pct + ''', ' +  '[''Service Call Master History''].[PARSTOTCST] as ''' + @Part_Sub_Total_Cost + ''', ' +  '[''Service Call Master History''].[PARSTOTPRC] as ''' + @Part_Sub_Total_Price + ''', ' +  'rtrim([''Service Call Master History''].[PYMTRMID]) as ''' + @Payment_Terms_ID + ''', ' +  'rtrim([''Service Call Master History''].[PHONE1]) as ''' + @Phone_1 + ''', ' +  '[''Service Call Master History''].[PRETAXTOT] as ''' + @PreTax_Total + ''', ' +  'rtrim([''Service Call Master History''].[PRICELVL]) as ''' + @Price_Level + ''', ' +  '''' + @Print_to_Web + ''' = dbo.DYN_FUNC_Boolean_All([''Service Call Master History''].[Print_to_Web]), ' +  'rtrim([''Service Call Master History''].[ProjectRef1_1]) as ''' + @ProjectRef1 + ''', ' +  'rtrim([''Service Call Master History''].[PROJCTID]) as ''' + @Project_ID + ''', ' +  'rtrim([''Service Call Master History''].[PORDNMBR]) as ''' + @Purchase_Order_Number + ''', ' +  '[''Service Call Master History''].[RATECALC] as ''' + @Rate_Calc_Method + ''', ' +  'rtrim([''Service Call Master History''].[RATETPID]) as ''' + @Rate_Type_ID + ''', ' +  'rtrim([''Service Call Master History''].[Replaces_1]) as ''' + @Replaces + ''', ' +  '[''Service Call Master History''].[Response_Date] as ''' + @Response_Date + ''', ' +  '[''Service Call Master History''].[Response_Time] as ''' + @Response_Time + ''', ' +  'rtrim([''Service Call Master History''].[SVC_Bill_To_Address_Code]) as ''' + @SVC_Bill_To_Address_Code + ''', ' +  '[''Service Call Master History''].[SVC_Contract_Line_SEQ] as ''' + @SVC_Contract_Line_SEQ_Number + ''', ' +  'rtrim([''Service Call Master History''].[SVC_FO_ID]) as ''' + @SVC_FO_ID + ''', ' +  '''' + @SVC_On_Hold + ''' = dbo.DYN_FUNC_Boolean_All([''Service Call Master History''].[SVC_On_Hold]), ' +  '''' + @SVC_Pre600 + ''' = dbo.DYN_FUNC_Boolean_All([''Service Call Master History''].[SVC_Pre600]), ' +  'rtrim([''Service Call Master History''].[SLPRSNID]) as ''' + @Salesperson_ID + ''', ' +  'rtrim([''Service Call Master History''].[SPLTTERMS]) as ''' + @Split_Terms_Code + ''', ' +  'rtrim([''Service Call Master History''].[STATE]) as ''' + @State + ''', ' +  '[''Service Call Master History''].[TAXAMNT] as ''' + @Tax_Amount + ''', ' +  'rtrim([''Service Call Master History''].[TAXEXMT1]) as ''' + @Tax_Exempt_1 + ''', ' +  'rtrim([''Service Call Master History''].[TAXEXMT2]) as ''' + @Tax_Exempt_2 + ''', ' +  'rtrim([''Service Call Master History''].[TAXSCHID]) as ''' + @Tax_Schedule_ID + ''', ' +  '[''Service Call Master History''].[TIME1] as ''' + @Time + ''', ' +  'rtrim([''Service Call Master History''].[TIMEZONE]) as ''' + @TimeZone + ''', ' +  'rtrim([''Service Call Master History''].[USERDEF1]) as ''' + @User_Defined_1 + ''', ' +  'rtrim([''Service Call Master History''].[USERDEF2]) as ''' + @User_Defined_2 + ''', ' +  'rtrim([''Service Call Master History''].[USRDEF03]) as ''' + @User_Defined_3 + ''', ' +  'rtrim([''Service Call Master History''].[USRDEF04]) as ''' + @User_Defined_4 + ''', ' +  'rtrim([''Service Call Master History''].[USRDEF05]) as ''' + @User_Defined_5 + ''', ' +  '[''Service Call Master History''].[VIEWMODE] as ''' + @View_Mode + ''', ' +  'rtrim([''Service Call Master History''].[ZIP]) as ''' + @Zip + ''', '   select @sqlstring3 =  '''' + @Customer_ID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppCustomerID(1,[''RM Customer MSTR''].[CUSTNMBR] ), '+ '''' + @Item_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppItemID(1,[''Service Call Equipment History''].[ITEMNMBR],'''' ), '+ '''' + @Salesperson_ID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppSalespersonID(1,[''Service Call Master History''].[SLPRSNID],2 ), '+ '''' + @Service_Call_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url_For_FS + ''' +dbo.dgppServiceRecordType(1,[''Service Call Master History''].[CALLNBR],[''Service Call Master History''].[SRVRECTYPE] ) '  select @sqljoinstring =   'from [SVC30200] as [''Service Call Master History''] with (NOLOCK) '   + 'left outer join [RM00101] as [''RM Customer MSTR''] with (NOLOCK) on '   + '[''Service Call Master History''].[CUSTNMBR] = [''RM Customer MSTR''].[CUSTNMBR] '   + 'left outer join [SVC30202] as [''Service Call Equipment History''] with (NOLOCK) on '   + '[''Service Call Master History''].[SRVRECTYPE] = [''Service Call Equipment History''].[SRVRECTYPE] '   + ' and [''Service Call Master History''].[CALLNBR] = [''Service Call Equipment History''].[CALLNBR] '   + 'left outer join [RM00101] as [''RM Customer MSTR2''] with (NOLOCK) on '   + '[''Service Call Master History''].[Bill_To_Customer] = [''RM Customer MSTR2''].[CUSTNMBR] '   + 'left outer join [SVC00300] as [''Serial Master''] with (NOLOCK) on '   + '[''Service Call Equipment History''].[EQUIPID] = [''Serial Master''].[EQUIPID] '   select @sqlaccessstring =   'GRANT SELECT ON [dbo].[HistoryFieldServiceCalls] TO [rpt_dispatcher]' + 'GRANT SELECT ON [dbo].[HistoryFieldServiceCalls] TO [rpt_customer service rep]' + 'GRANT SELECT ON [dbo].[HistoryFieldServiceCalls] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[HistoryFieldServiceCalls] TO [rpt_project manager]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_FieldService_HistoryFieldServiceCalls] TO [DYNGRP]
GO
