SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE Procedure [dbo].[SVC_GeneratePMEditList]  (  @BeginCustomer char(15),  @EndCustomer char(15),  @BeginItem char(31),  @EndItem char(31),  @BeginSerial char(21),  @EndSerial char(21),  @BeginSchedule char(9),  @EndSchedule char(9),  @CheckDate datetime,  @CurrentDate datetime,  @TempTable varchar(255)  ) As declare @EquipID int,  @ScheduleID char(9),  @PMDetailID char(9),  @Frequency smallint,  @ServiceType char(11),  @CheckInterval numeric(19,5),  @PMType smallint,  @EquipPMDate datetime,  @MeterType smallint declare @ContractOnly tinyint  select @ContractOnly =  svcContractPMOnly  from SVC00998 if @ContractOnly = 0  begin  exec SVC_CreatePMWorkTable  @BeginCustomer ,  @EndCustomer , @BeginItem , @EndItem ,@BeginSerial,  @EndSerial , @BeginSchedule ,@EndSchedule,@CurrentDate, @CheckDate    end exec SVC_CreateContractPMWorkTable  @BeginCustomer ,  @EndCustomer , @BeginItem , @EndItem , @BeginSerial, @EndSerial ,@BeginSchedule ,@EndSchedule, @CheckDate   declare PMEdit_cursor INSENSITIVE CURSOR for   SELECT   SVC00350.EQUIPID,  SVC00350.SVC_PM_Annual_Date,   SVC00350.SCHEDID,   SVC00350.PMDTLID,   SVC00350.FREQOFPM,  SVC00350.SRVTYPE,  SVC00350.QUANTITY,  SVC00350.SVC_PM_Type,  SVC00350.SVC_Meter_Type  FROM SVC00350  ORDER BY SVC00350.EQUIPID, SVC00350.SCHEDID, SVC00350.PMDTLID  set nocount on  OPEN PMEdit_cursor  FETCH NEXT FROM PMEdit_cursor INTO @EquipID,@EquipPMDate,@ScheduleID,   @PMDetailID,@Frequency,@ServiceType,  @CheckInterval,@PMType,@MeterType WHILE (@@FETCH_STATUS = 0)  BEGIN   exec SVC_Do_PM_Event @EquipID,@PMDetailID,@ScheduleID,@Frequency,@CheckInterval,@CheckDate,  @CurrentDate,@EquipPMDate,@PMType,@MeterType,@ServiceType   FETCH NEXT FROM PMEdit_cursor INTO @EquipID,@EquipPMDate,@ScheduleID,   @PMDetailID,@Frequency,@ServiceType,  @CheckInterval,@PMType,@MeterType  END  DEALLOCATE PMEdit_cursor delete from SVC00350    
GO
GRANT EXECUTE ON  [dbo].[SVC_GeneratePMEditList] TO [DYNGRP]
GO
