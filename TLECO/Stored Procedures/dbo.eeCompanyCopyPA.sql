SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyPA] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255), @DestCMPANYID smallint, @SourcCMPANYID smallint, @DestCMPNYNAM varchar(65) select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '', @DestCMPANYID = 0, @SourcCMPANYID = 0, @DestCMPNYNAM = '' select @DestCMPANYID = CMPANYID, @DestCMPNYNAM = CMPNYNAM from DYNAMICS..SY01500 where INTERID = @I_vToCompany select @SourcCMPANYID = CMPANYID from DYNAMICS..SY01500 where INTERID = @I_vFromCompany if (@I_vData = 1) begin delete DYNAMICS..PDK40001 where CMPANYID = @DestCMPANYID insert into DYNAMICS..PDK40001 ( [USERID],[PASSWORD],[USRCLASS],[CMPNYNAM],[CMPANYID],[EMPLOYID], [PDK_User_Type],[CARDNAME],[MANAGER],[SUPERVISOR],[MDFRDENT],[PRTOPRTR], [PRTOSCRN],[Import_Access],[Modifier_Access],[Report_Writer_Access],[Zoom_Fields_Font_Color],[Zoom_Fields_Font_Style], [Editable_Fields_Backgrou],[Editable_Fields_Font_Col],[PDK_Edit_Fields_Pattern],[Editable_Fields_Pattern_],[Scrolling_Fields_Backgro],[Scrolling_Fields_Font_Co], [PDK_Scrol_Fields_Pattern],[Scrolling_Fields_PatCor],[Required_Fields_Font_Col],[Required_Fields_Font_Sty],[SHRQFLDS],[Internet_Browser], [Internet_Type],[Internet_Address],[Internet_Address_Name],[HSCRLARW],[PAfileemplreim],[PAALLWCHGBLLTYPEEE], [PAALLWCHGBLLTYPETS],[PAALLDEEEEv20],[PAADETSv20],[PAAllowChangeDepartment],[PAChangeJobTitle],[PAAllow_ChangePaycode], [PDK_Administrator_EE],[PDK_Administrator_TS],[PDK_Mgr_Approve_TS],[PDK_Mgr_Approve_EE],[PDK_Sup_Approve_TS],[PDK_Sup_Approve_EE], [PDK_EitherOr_OK_EE],[PDK_EitherOr_OK_TS],[PDKBATCHTS],[PDKBATCHEE],[PAAssign_LookupTS],[PAAssign_LookupEE], [PDK_MC_Synchronize],[PDKTimesheetEntryForm],[PAExpenseType],[PAPaymentMethod],[UseEETemplate],[UseTSTemplate], [AutoFillTS],[AutoFillEE],[PALLWNONEPROJTS],[PALLOWNONEPROJEE],[PAAllowEditsTS],[PAAllowEditsEE], [PAAllowAddsTS],[PAAllowAddsEE] ) select [USERID],[PASSWORD],[USRCLASS],@DestCMPNYNAM,@DestCMPANYID,[EMPLOYID], [PDK_User_Type],[CARDNAME],[MANAGER],[SUPERVISOR],[MDFRDENT],[PRTOPRTR], [PRTOSCRN],[Import_Access],[Modifier_Access],[Report_Writer_Access],[Zoom_Fields_Font_Color],[Zoom_Fields_Font_Style], [Editable_Fields_Backgrou],[Editable_Fields_Font_Col],[PDK_Edit_Fields_Pattern],[Editable_Fields_Pattern_],[Scrolling_Fields_Backgro],[Scrolling_Fields_Font_Co], [PDK_Scrol_Fields_Pattern],[Scrolling_Fields_PatCor],[Required_Fields_Font_Col],[Required_Fields_Font_Sty],[SHRQFLDS],[Internet_Browser], [Internet_Type],[Internet_Address],[Internet_Address_Name],[HSCRLARW],[PAfileemplreim],[PAALLWCHGBLLTYPEEE], [PAALLWCHGBLLTYPETS],[PAALLDEEEEv20],[PAADETSv20],[PAAllowChangeDepartment],[PAChangeJobTitle],[PAAllow_ChangePaycode], [PDK_Administrator_EE],[PDK_Administrator_TS],[PDK_Mgr_Approve_TS],[PDK_Mgr_Approve_EE],[PDK_Sup_Approve_TS],[PDK_Sup_Approve_EE], [PDK_EitherOr_OK_EE],[PDK_EitherOr_OK_TS],[PDKBATCHTS],[PDKBATCHEE],[PAAssign_LookupTS],[PAAssign_LookupEE], [PDK_MC_Synchronize],[PDKTimesheetEntryForm],[PAExpenseType],[PAPaymentMethod],[UseEETemplate],[UseTSTemplate], [AutoFillTS],[AutoFillEE],[PALLWNONEPROJTS],[PALLOWNONEPROJEE],[PAAllowEditsTS],[PAAllowEditsEE], [PAAllowAddsTS],[PAAllowAddsEE] from DYNAMICS..PDK40001 where CMPANYID = @SourcCMPANYID delete DYNAMICS..PDK90100 where CMPANYID = @DestCMPANYID insert into DYNAMICS..PDK90100 ( [USERID],[CMPANYID],[DICTID],[ResType],[ResID],[ALIAS], [Item_Name],[SERIES] ) select [USERID],@DestCMPANYID,[DICTID],[ResType],[ResID],[ALIAS], [Item_Name],[SERIES] from DYNAMICS..PDK90100 select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..GST00111' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..GST00111 ( [VNDCLSID],[TaxInvRecvd],[WithholdingType] ) select [VNDCLSID],[TaxInvRecvd],[WithholdingType] from ' + rtrim(@I_vFromCompany) + '..GST00111 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00401' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00401 ( [PAFeeID],[PAFeeName],[PAFeeType],[PAFrequency],[PAPercent_Cost],[PAPercent_Revenue], [PA_Retention_Percent],[PAFeeToUse],[PAFeeAmount],[PASales_Tax_Options],[PAbilltaxscheduleid],[PAtotcbts], [PAtotcbEL],[PAtotcbML],[PAtotcbvi],[PAtotcber],[PAtotcbinv],[STRTDATE], [ENDDATE],[PARenew],[PARenewal_Date],[PANOTEINDEX],[PA_Renew_Day],[PA_Renew_Month], [PAUD1],[PAUD2] ) select [PAFeeID],[PAFeeName],[PAFeeType],[PAFrequency],[PAPercent_Cost],[PAPercent_Revenue], [PA_Retention_Percent],[PAFeeToUse],[PAFeeAmount],[PASales_Tax_Options],[PAbilltaxscheduleid],[PAtotcbts], [PAtotcbEL],[PAtotcbML],[PAtotcbvi],[PAtotcber],[PAtotcbinv],[STRTDATE], [ENDDATE],[PARenew],[PARenewal_Date],[PANOTEINDEX],[PA_Renew_Day],[PA_Renew_Month], [PAUD1],[PAUD2] from ' + rtrim(@I_vFromCompany) + '..PA00401 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00402' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00402 ( [PAPROJNUMBER],[PAFeeID],[PAFeeType],[PAFeeAmount],[PAUBeginDate],[PAUEndDate], [PAUnposted_Fee_Amount],[PAUnposted_Tax_Amount],[PAUNPOSTBIEEAMOUNT],[PAUNPEIEBAMOUNT],[PAUnpostedRecogRevN],[PA_Unposted_Billed_Reten], [PAUnpostDiscDolAmtN],[PAUnpostBillN],[PAPosted_Fee_Amount],[PAPosted_Tax_Amount],[PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT], [PAPostRecogRevN],[PA_Actual_Billed_Retenti],[PAPostedDiscDolAmtN],[PAPostedBillingsN],[PAACTUALBEGDATE],[PA_Actual_End_Date], [PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PA_Earnings],[PA_Cost_of_Earnings],[WROFAMNT],[ActualWriteOffAmount], [DISTKNAM],[ActualDiscTakenAmount],[PAtaxpaidamt],[PAPostedTaxPaidN],[PAPOSTRETAMT],[PAUNPOSTRETAMT], [PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt],[PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PAPosted_Earnings],[PAActualCostofEarnings], [PA_MC_Fee_Amount],[PA_MC_Unposted_Fee_Amt],[PA_MC_Unposted_Tax_Amt],[PA_MC_Unposted_Discount],[PAMCUnpostBillN],[PA_MC_Actual_Fee_Amount], [PA_MC_Actual_Tax_Amount],[PA_MC_Actual_Discount],[PAMCActualBillings] ) select [PAPROJNUMBER],[PAFeeID],[PAFeeType],[PAFeeAmount],[PAUBeginDate],[PAUEndDate], [PAUnposted_Fee_Amount],[PAUnposted_Tax_Amount],[PAUNPOSTBIEEAMOUNT],[PAUNPEIEBAMOUNT],[PAUnpostedRecogRevN],[PA_Unposted_Billed_Reten], [PAUnpostDiscDolAmtN],[PAUnpostBillN],[PAPosted_Fee_Amount],[PAPosted_Tax_Amount],[PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT], [PAPostRecogRevN],[PA_Actual_Billed_Retenti],[PAPostedDiscDolAmtN],[PAPostedBillingsN],[PAACTUALBEGDATE],[PA_Actual_End_Date], [PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PA_Earnings],[PA_Cost_of_Earnings],[WROFAMNT],[ActualWriteOffAmount], [DISTKNAM],[ActualDiscTakenAmount],[PAtaxpaidamt],[PAPostedTaxPaidN],[PAPOSTRETAMT],[PAUNPOSTRETAMT], [PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt],[PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PAPosted_Earnings],[PAActualCostofEarnings], [PA_MC_Fee_Amount],[PA_MC_Unposted_Fee_Amt],[PA_MC_Unposted_Tax_Amt],[PA_MC_Unposted_Discount],[PAMCUnpostBillN],[PA_MC_Actual_Fee_Amount], [PA_MC_Actual_Tax_Amount],[PA_MC_Actual_Discount],[PAMCActualBillings] from ' + rtrim(@I_vFromCompany) + '..PA00402 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00501' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00501 ( [CUSTNMBR],[PAcustalias],[PAcloseProjcosts],[PAclosetobillings],[PABILLFORMAT],[PAUD1], [PAUD2],[PABQuantity],[PABTotalCost],[PABBillings],[PABProfit],[PABTaxPaidAmt], [PABTaxChargedAmt],[PABaselineOvhdCost],[PAFQuantity],[PAFTotalCost],[PAFBillings],[PAFProfit], [PAFTaxPaidAmt],[PAFTaxChargedAmt],[PAForecastOvhdCost],[PAProject_Amount],[PAUnpostedQty],[PAUnpostedTotalCostN], [PAUnposted_Overhead],[PAUnpostedProfitN],[PAUnposted_Tax_Amount],[PAUnpostAccrRevN],[PAUnpostedCommitedQty],[PAUnpostedCommitedCost], [PAUnpostedCommitedTaxAmt],[PAUnpostedRecogRevN],[PAUnposted_Project_Fee],[PAUnposted_Retainer_Fee],[PAUnposted_Service_Fee],[PAUNPOSTRETAMT], [PA_Unposted_Billed_Reten],[PAUNPOSTBIEEAMOUNT],[PAUNPEIEBAMOUNT],[PAPostedQty],[PAPostedTotalCostN],[PAPosted_Overhead], [PAPostedProfitN],[PAPosted_Tax_Amount],[PAPosted_Accr_RevN],[PA_Actual_Billed_Retenti],[PAPostedCommitedQty],[PAPostedCommitedCost], [PAPostedCommitedTaxAmt],[PAPostRecogRevN],[PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPosted_Service_Fee],[PAPOSTRETAMT], [PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PAWrite_UpDown_Amount],[PABilled_QtyN],[PABilled_Cost],[PABilled_Accrued_Revenu], [PACostPcntCompleted],[PAQuantityPcntCompleted],[PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PA_Earnings],[PA_Cost_of_Earnings], [PAUnpostBillN],[PAUnpostDiscDolAmtN],[PAUnposted_Sales_Tax_Am],[PAPostedBillingsN],[PAPostedDiscDolAmtN],[PAPosted_Sales_Tax_Amou], [PAService_Fee_Amount],[PARetainer_Fee_Amount],[PAProject_Fee_Amount],[PARetentionFeeAmount],[PABCWPAMT],[PABCWSAMT], [PAACWPAMT],[PAApproved_Accrued_Reve],[PAApproved_Cost],[PAApproved_Quantity],[WROFAMNT],[ActualWriteOffAmount], [DISTKNAM],[ActualDiscTakenAmount],[PACommitted_Costs],[PACommitted_Qty],[PAPOCost],[PAPOQty], [PAPOPostedCost],[PAPOPostedQty],[PAtaxpaidamt],[PAPostedTaxPaidN],[PApretainage],[PAunpretainage], [PA_Actual_Freight_Amount],[PA_Unposted_Freight_Amou],[PA_Actual_Misc_Amount],[PA_Unposted_Misc_Amount],[PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt], [PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PANOPENDCO],[PANUMCO],[PACOBASEPROJAMT],[PACOBSLNFEEPROJAMT], [PAUNPRRTOTPROJAMT],[PAUNABSTOTBILL],[PAUNPBSTOTCST],[PAUNPBSLTOTPROF],[PAUNPBSTOTQTY],[PAUNAPFRTOTBILL], [PAUNAPPFRTOTCST],[PAUNFRCTOTPROF],[PAUNPFRTOTQTY],[PATOTCHGORDAMT],[PAPosted_Earnings],[PAActualCostofEarnings], [PAUnpostedLossAmount],[PAActualLossAmount],[PAFQLaborOnly],[PAAQLaborOnly] ) select [CUSTNMBR],[PAcustalias],[PAcloseProjcosts],[PAclosetobillings],[PABILLFORMAT],[PAUD1], [PAUD2],[PABQuantity],[PABTotalCost],[PABBillings],[PABProfit],[PABTaxPaidAmt], [PABTaxChargedAmt],[PABaselineOvhdCost],[PAFQuantity],[PAFTotalCost],[PAFBillings],[PAFProfit], [PAFTaxPaidAmt],[PAFTaxChargedAmt],[PAForecastOvhdCost],[PAProject_Amount],[PAUnpostedQty],[PAUnpostedTotalCostN], [PAUnposted_Overhead],[PAUnpostedProfitN],[PAUnposted_Tax_Amount],[PAUnpostAccrRevN],[PAUnpostedCommitedQty],[PAUnpostedCommitedCost], [PAUnpostedCommitedTaxAmt],[PAUnpostedRecogRevN],[PAUnposted_Project_Fee],[PAUnposted_Retainer_Fee],[PAUnposted_Service_Fee],[PAUNPOSTRETAMT], [PA_Unposted_Billed_Reten],[PAUNPOSTBIEEAMOUNT],[PAUNPEIEBAMOUNT],[PAPostedQty],[PAPostedTotalCostN],[PAPosted_Overhead], [PAPostedProfitN],[PAPosted_Tax_Amount],[PAPosted_Accr_RevN],[PA_Actual_Billed_Retenti],[PAPostedCommitedQty],[PAPostedCommitedCost], [PAPostedCommitedTaxAmt],[PAPostRecogRevN],[PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPosted_Service_Fee],[PAPOSTRETAMT], [PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PAWrite_UpDown_Amount],[PABilled_QtyN],[PABilled_Cost],[PABilled_Accrued_Revenu], [PACostPcntCompleted],[PAQuantityPcntCompleted],[PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PA_Earnings],[PA_Cost_of_Earnings], [PAUnpostBillN],[PAUnpostDiscDolAmtN],[PAUnposted_Sales_Tax_Am],[PAPostedBillingsN],[PAPostedDiscDolAmtN],[PAPosted_Sales_Tax_Amou], [PAService_Fee_Amount],[PARetainer_Fee_Amount],[PAProject_Fee_Amount],[PARetentionFeeAmount],[PABCWPAMT],[PABCWSAMT], [PAACWPAMT],[PAApproved_Accrued_Reve],[PAApproved_Cost],[PAApproved_Quantity],[WROFAMNT],[ActualWriteOffAmount], [DISTKNAM],[ActualDiscTakenAmount],[PACommitted_Costs],[PACommitted_Qty],[PAPOCost],[PAPOQty], [PAPOPostedCost],[PAPOPostedQty],[PAtaxpaidamt],[PAPostedTaxPaidN],[PApretainage],[PAunpretainage], [PA_Actual_Freight_Amount],[PA_Unposted_Freight_Amou],[PA_Actual_Misc_Amount],[PA_Unposted_Misc_Amount],[PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt], [PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PANOPENDCO],[PANUMCO],[PACOBASEPROJAMT],[PACOBSLNFEEPROJAMT], [PAUNPRRTOTPROJAMT],[PAUNABSTOTBILL],[PAUNPBSTOTCST],[PAUNPBSLTOTPROF],[PAUNPBSTOTQTY],[PAUNAPFRTOTBILL], [PAUNAPPFRTOTCST],[PAUNFRCTOTPROF],[PAUNPFRTOTQTY],[PATOTCHGORDAMT],[PAPosted_Earnings],[PAActualCostofEarnings], [PAUnpostedLossAmount],[PAActualLossAmount],[PAFQLaborOnly],[PAAQLaborOnly] from ' + rtrim(@I_vFromCompany) + '..PA00501 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00502' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00502 ( [PAPROJNUMBER],[CUSTNMBR],[PAUNPOSTRETAMT],[PAPOSTRETAMT],[PAUnposted_Retainer_Fee],[PAPosted_Retainer_Fee], [ACCTAMNT] ) select [PAPROJNUMBER],[CUSTNMBR],[PAUNPOSTRETAMT],[PAPOSTRETAMT],[PAUnposted_Retainer_Fee],[PAPosted_Retainer_Fee], [ACCTAMNT] from ' + rtrim(@I_vFromCompany) + '..PA00502 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00503' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00503 ( [PAPROJNUMBER],[CUSTNMBR],[PAUNPOSTRETAMT],[PAPOSTRETAMT],[PAUnposted_Retainer_Fee],[PAPosted_Retainer_Fee], [PA_Unposted_Billed_Reten],[PA_Actual_Billed_Retenti],[ACCTAMNT] ) select [PAPROJNUMBER],[CUSTNMBR],[PAUNPOSTRETAMT],[PAPOSTRETAMT],[PAUnposted_Retainer_Fee],[PAPosted_Retainer_Fee], [PA_Unposted_Billed_Reten],[PA_Actual_Billed_Retenti],[ACCTAMNT] from ' + rtrim(@I_vFromCompany) + '..PA00503 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00504' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00504 ( [CUSTNMBR],[PAcustalias] ) select [CUSTNMBR],[PAcustalias] from ' + rtrim(@I_vFromCompany) + '..PA00504 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00511' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00511 ( [CUSTNMBR],[YEAR1],[PERIODID],[PABQuantity],[PABProfit],[PABBillings], [PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PAFQuantity],[PAFProfit],[PAFBillings], [PAFTaxPaidAmt],[PAFTaxChargedAmt],[PAForecastOvhdCost],[PA_Earnings],[PA_Cost_of_Earnings],[PAUnpostedQty], [PAPostedQty],[PAUnpostedProfitN],[PAPostedProfitN],[PAUnpostAccrRevN],[PAPosted_Accr_RevN],[PAUnpostedTotalCostN], [PAPostedTotalCostN],[PAUnposted_Overhead],[PAPosted_Overhead],[PAUnpostBillN],[PAPostedBillingsN],[PAUnposted_Fee_Amount], [PAPosted_Fee_Amount],[PAUnpostedRecogRevN],[PAPostRecogRevN],[PAUNPEIEBAMOUNT],[PAPOSEIEBAMOUNT],[PAUNPOSTBIEEAMOUNT], [PAPOSBIEEAMOUNT],[PAWrite_UpDown_Amount],[PAUnposted_Retainer_Fee],[PA_Unposted_Billed_Reten],[PAUNPOSTRETAMT],[PAUnposted_Service_Fee], [PAUnposted_Project_Fee],[PA_Actual_Billed_Retenti],[PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPOSTRETAMT],[PAPosted_Service_Fee], [PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PAFeeAmount],[WROFAMNT],[ActualWriteOffAmount],[DISTKNAM], [ActualDiscTakenAmount],[PABTotalCost],[PAFTotalCost],[PAUnposted_Sales_Tax_Am],[PAPosted_Sales_Tax_Amou],[PACostPcntCompleted], [PAQuantityPcntCompleted],[PACommitted_Costs],[PACommitted_Qty],[PAPOPostedCost],[PAPOPostedQty],[PAPOCost], [PAPOQty],[PAUnposted_Tax_Amount],[PAPosted_Tax_Amount],[PAtaxpaidamt],[PAPostedTaxPaidN],[PAPostedDiscDolAmtN], [PAUnpostDiscDolAmtN],[PABilled_Accrued_Revenu],[PABilled_QtyN],[PAApproved_Accrued_Reve],[PAApproved_Quantity],[PApretainage], [PAunpretainage],[PA_Actual_Freight_Amount],[PA_Unposted_Freight_Amou],[PA_Actual_Misc_Amount],[PA_Unposted_Misc_Amount],[PA_Write_Off_Tax_Amount], [PAActualWOTaxAmt],[PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PAPosted_Earnings],[PAActualCostofEarnings],[PAUnpostedLossAmount], [PAActualLossAmount],[PAFQLaborOnly],[PAAQLaborOnly] ) select [CUSTNMBR],[YEAR1],[PERIODID],[PABQuantity],[PABProfit],[PABBillings], [PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PAFQuantity],[PAFProfit],[PAFBillings], [PAFTaxPaidAmt],[PAFTaxChargedAmt],[PAForecastOvhdCost],[PA_Earnings],[PA_Cost_of_Earnings],[PAUnpostedQty], [PAPostedQty],[PAUnpostedProfitN],[PAPostedProfitN],[PAUnpostAccrRevN],[PAPosted_Accr_RevN],[PAUnpostedTotalCostN], [PAPostedTotalCostN],[PAUnposted_Overhead],[PAPosted_Overhead],[PAUnpostBillN],[PAPostedBillingsN],[PAUnposted_Fee_Amount], [PAPosted_Fee_Amount],[PAUnpostedRecogRevN],[PAPostRecogRevN],[PAUNPEIEBAMOUNT],[PAPOSEIEBAMOUNT],[PAUNPOSTBIEEAMOUNT], [PAPOSBIEEAMOUNT],[PAWrite_UpDown_Amount],[PAUnposted_Retainer_Fee],[PA_Unposted_Billed_Reten],[PAUNPOSTRETAMT],[PAUnposted_Service_Fee], [PAUnposted_Project_Fee],[PA_Actual_Billed_Retenti],[PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPOSTRETAMT],[PAPosted_Service_Fee], [PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PAFeeAmount],[WROFAMNT],[ActualWriteOffAmount],[DISTKNAM], [ActualDiscTakenAmount],[PABTotalCost],[PAFTotalCost],[PAUnposted_Sales_Tax_Am],[PAPosted_Sales_Tax_Amou],[PACostPcntCompleted], [PAQuantityPcntCompleted],[PACommitted_Costs],[PACommitted_Qty],[PAPOPostedCost],[PAPOPostedQty],[PAPOCost], [PAPOQty],[PAUnposted_Tax_Amount],[PAPosted_Tax_Amount],[PAtaxpaidamt],[PAPostedTaxPaidN],[PAPostedDiscDolAmtN], [PAUnpostDiscDolAmtN],[PABilled_Accrued_Revenu],[PABilled_QtyN],[PAApproved_Accrued_Reve],[PAApproved_Quantity],[PApretainage], [PAunpretainage],[PA_Actual_Freight_Amount],[PA_Unposted_Freight_Amou],[PA_Actual_Misc_Amount],[PA_Unposted_Misc_Amount],[PA_Write_Off_Tax_Amount], [PAActualWOTaxAmt],[PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PAPosted_Earnings],[PAActualCostofEarnings],[PAUnpostedLossAmount], [PAActualLossAmount],[PAFQLaborOnly],[PAAQLaborOnly] from ' + rtrim(@I_vFromCompany) + '..PA00511 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00512' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00512 ( [CUSTNMBR],[YEAR1],[PERIODID],[PATOTCHGORDAMT],[PACOBASEPROJAMT],[PACOBSLNFEEPROJAMT] ) select [CUSTNMBR],[YEAR1],[PERIODID],[PATOTCHGORDAMT],[PACOBASEPROJAMT],[PACOBSLNFEEPROJAMT] from ' + rtrim(@I_vFromCompany) + '..PA00512 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00601' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00601 ( [EMPLOYID],[PAfileemplreim],[PANOTA1099VENDOR],[PApmcb],[PAbmcb],[PAEmployee_Type], [PA_Employed_By],[PAPayCode],[CURNCYID],[CURRNIDX],[RATETPID],[EXGTBLID], [XCHGRATE],[EXCHDATE],[TIME1],[RTCLCMTD],[DENXRATE],[MCTRXSTT], [PAUnit_of_Measure],[PAUNITCOST],[PATMProfitType],[PATMProfitAmount],[PA_Orig_Profit_AmtTM],[PATMProfitPercent], [PAProfit_Type__CP],[PAProfitAmountCP],[PAProfitPercentCP],[PAFFProfitType],[PAFFProfitAmount],[PAFFProfitPercent], [VENDORID],[PAOverheadRateMethod],[PAOvhdAmtPerUnit],[PAOverheaPercentage],[PAUD1],[PAUD2], [PA_Allow_Vendor_For_PO] ) select [EMPLOYID],[PAfileemplreim],[PANOTA1099VENDOR],[PApmcb],[PAbmcb],[PAEmployee_Type], [PA_Employed_By],[PAPayCode],[CURNCYID],[CURRNIDX],[RATETPID],[EXGTBLID], [XCHGRATE],[EXCHDATE],[TIME1],[RTCLCMTD],[DENXRATE],[MCTRXSTT], [PAUnit_of_Measure],[PAUNITCOST],[PATMProfitType],[PATMProfitAmount],[PA_Orig_Profit_AmtTM],[PATMProfitPercent], [PAProfit_Type__CP],[PAProfitAmountCP],[PAProfitPercentCP],[PAFFProfitType],[PAFFProfitAmount],[PAFFProfitPercent], [VENDORID],[PAOverheadRateMethod],[PAOvhdAmtPerUnit],[PAOverheaPercentage],[PAUD1],[PAUD2], [PA_Allow_Vendor_For_PO] from ' + rtrim(@I_vFromCompany) + '..PA00601 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00701' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00701 ( [PAEQUIPTID],[PAEQNME],[PAEQUIPTCLSID],[PAinactive],[PAUnit_of_Measure],[PAUNITCOST], [PATMProfitType],[PATMProfitAmount],[PATMProfitPercent],[PAProfit_Type__CP],[PAProfitAmountCP],[PAProfitPercentCP], [PAFFProfitType],[PAFFProfitAmount],[PAFFProfitPercent],[PAUD1],[PAUD2],[PANOTEINDEX] ) select [PAEQUIPTID],[PAEQNME],[PAEQUIPTCLSID],[PAinactive],[PAUnit_of_Measure],[PAUNITCOST], [PATMProfitType],[PATMProfitAmount],[PATMProfitPercent],[PAProfit_Type__CP],[PAProfitAmountCP],[PAProfitPercentCP], [PAFFProfitType],[PAFFProfitAmount],[PAFFProfitPercent],[PAUD1],[PAUD2],[PANOTEINDEX] from ' + rtrim(@I_vFromCompany) + '..PA00701 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00801' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00801 ( [PSMISCID],[PAMISCEN],[PAMISCCID],[PAinactive],[PAUnit_of_Measure],[PAUNITCOST], [PATMProfitType],[PATMProfitAmount],[PATMProfitPercent],[PAProfit_Type__CP],[PAProfitAmountCP],[PAProfitPercentCP], [PAFFProfitType],[PAFFProfitAmount],[PAFFProfitPercent],[PAUD1],[PAUD2],[PANOTEINDEX] ) select [PSMISCID],[PAMISCEN],[PAMISCCID],[PAinactive],[PAUnit_of_Measure],[PAUNITCOST], [PATMProfitType],[PATMProfitAmount],[PATMProfitPercent],[PAProfit_Type__CP],[PAProfitAmountCP],[PAProfitPercentCP], [PAFFProfitType],[PAFFProfitAmount],[PAFFProfitPercent],[PAUD1],[PAUD2],[PANOTEINDEX] from ' + rtrim(@I_vFromCompany) + '..PA00801 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00901' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00901 ( [VENDORID],[PAfromemployee],[PAddlDefpoformatouse],[PAUnit_of_Measure],[PAUNITCOST],[PATMProfitType], [PATMProfitAmount],[PATMProfitPercent],[PAFFProfitType],[PAProfit_Type__CP],[PAProfitAmountCP],[PAProfitPercentCP], [PAFFProfitAmount],[PAFFProfitPercent],[PAUD1],[PAUD2],[PA_Allow_Vendor_For_PO] ) select [VENDORID],[PAfromemployee],[PAddlDefpoformatouse],[PAUnit_of_Measure],[PAUNITCOST],[PATMProfitType], [PATMProfitAmount],[PATMProfitPercent],[PAFFProfitType],[PAProfit_Type__CP],[PAProfitAmountCP],[PAProfitPercentCP], [PAFFProfitAmount],[PAFFProfitPercent],[PAUD1],[PAUD2],[PA_Allow_Vendor_For_PO] from ' + rtrim(@I_vFromCompany) + '..PA00901 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01001' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01001 ( [PACOSTCATID],[PACOSTCATNME],[PACOSTCATCLASID],[PAinactive],[PATU],[PAIV_Item_Checkbox], [PAUnit_of_Measure],[UOMSCHDL],[DECPLQTY],[PAUNITCOST],[PAPay_Code_Hourly],[PAPay_Code_Salary], [PATMProfitType],[PATMProfitAmount],[PA_Orig_Profit_AmtTM],[PATMProfitPercent],[PAProfit_Type__CP],[PAProfitAmountCP], [PAProfitPercentCP],[PAFFProfitType],[PAFFProfitAmount],[PAFFProfitPercent],[DECPLCUR],[PAcostaxscheduleid], [PAPurchase_Tax_Options],[PAbilltaxscheduleid],[PASales_Tax_Options],[PAUD1],[PAUD2],[PAbillnoteidx], [PAOverheadRateMethod],[PAOvhdAmtPerUnit],[PAOverheaPercentage],[PANOTEINDEX],[CURNCYID],[CURRNIDX], [RATETPID],[EXGTBLID],[EXCHDATE],[XCHGRATE],[TIME1],[RTCLCMTD], [DENXRATE],[MCTRXSTT] ) select [PACOSTCATID],[PACOSTCATNME],[PACOSTCATCLASID],[PAinactive],[PATU],[PAIV_Item_Checkbox], [PAUnit_of_Measure],[UOMSCHDL],[DECPLQTY],[PAUNITCOST],[PAPay_Code_Hourly],[PAPay_Code_Salary], [PATMProfitType],[PATMProfitAmount],[PA_Orig_Profit_AmtTM],[PATMProfitPercent],[PAProfit_Type__CP],[PAProfitAmountCP], [PAProfitPercentCP],[PAFFProfitType],[PAFFProfitAmount],[PAFFProfitPercent],[DECPLCUR],[PAcostaxscheduleid], [PAPurchase_Tax_Options],[PAbilltaxscheduleid],[PASales_Tax_Options],[PAUD1],[PAUD2],[PAbillnoteidx], [PAOverheadRateMethod],[PAOvhdAmtPerUnit],[PAOverheaPercentage],[PANOTEINDEX],[CURNCYID],[CURRNIDX], [RATETPID],[EXGTBLID],[EXCHDATE],[XCHGRATE],[TIME1],[RTCLCMTD], [DENXRATE],[MCTRXSTT] from ' + rtrim(@I_vFromCompany) + '..PA01001 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01101 ( [CUSTNMBR],[PAcontid],[PALONGID_1],[PALONGID_2],[PALONGID_3],[PALONGID_4], [PALONGID_5],[PAcontname],[PACONTNUMBER],[PAcontclassid],[PAProjectType],[PAAcctgMethod], [PASTAT],[CURRNIDX],[PApurordnum],[PABBeginDate],[PABEndDate],[PAFBeginDate], [PAFEndDate],[PAACTUALBEGDATE],[PA_Actual_End_Date],[PAcloseProjcosts],[PAclosetobillings],[PAContMgrID], [PABusMgrID],[LOCATNID],[SLPRSNID],[SALSTERR],[COMPRCNT],[COMAPPTO], [PABILLFORMAT],[ADRSCODE],[CNTCPRSN],[PRBTADCD],[PAUD1_Cont],[PAUD2_Cont], [PASegmentCB],[PAbillnoteidx],[PAbillnoteidxts],[PAELbillniteidx],[PAbillnoteidxML],[PAbillnoteidxvi], [PAbillnoteidxee],[PAbillnoteidxinv],[PAbillnoteidxfee],[PABQuantity],[PABTotalCost],[PABBillings], [PABProfit],[PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PAFQuantity],[PAFTotalCost], [PAFBillings],[PAFProfit],[PAFTaxPaidAmt],[PAFTaxChargedAmt],[PAForecastOvhdCost],[PAProject_Amount], [PAUnpostedQty],[PAUnpostedTotalCostN],[PAUnposted_Overhead],[PAUnpostedProfitN],[PAUnposted_Tax_Amount],[PAUnpostAccrRevN], [PAUnpostedCommitedQty],[PAUnpostedCommitedCost],[PAUnpostedCommitedTaxAmt],[PAUnpostedRecogRevN],[PAUnposted_Project_Fee],[PAUnposted_Retainer_Fee], [PAUnposted_Service_Fee],[PAUNPOSTRETAMT],[PAUNPOSTBIEEAMOUNT],[PAUNPEIEBAMOUNT],[PA_Unposted_Billed_Reten],[PAPostedQty], [PAPostedTotalCostN],[PAPosted_Overhead],[PAPostedProfitN],[PAPosted_Tax_Amount],[PAPosted_Accr_RevN],[PAPostedCommitedQty], [PAPostedCommitedCost],[PAPostedCommitedTaxAmt],[PAPostRecogRevN],[PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPosted_Service_Fee], [PAPOSTRETAMT],[PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PA_Actual_Billed_Retenti],[PAWrite_UpDown_Amount],[PABilled_QtyN], [PABilled_Cost],[PABilled_Accrued_Revenu],[PACostPcntCompleted],[PAQuantityPcntCompleted],[PA_Receipts_Amount],[PA_Actual_Receipts_Amoun], [PA_Earnings],[PA_Cost_of_Earnings],[PAUnpostBillN],[PAUnpostDiscDolAmtN],[PAUnposted_Sales_Tax_Am],[PAPostedBillingsN], [PAPostedDiscDolAmtN],[PAPosted_Sales_Tax_Amou],[PAService_Fee_Amount],[PARetainer_Fee_Amount],[PAProject_Fee_Amount],[PARetentionFeeAmount], [DSCPCTAM],[PABCWPAMT],[PABCWSAMT],[PAACWPAMT],[NOTEINDX],[PAApproved_Accrued_Reve], [PAApproved_Cost],[PAApproved_Quantity],[WROFAMNT],[ActualWriteOffAmount],[DISTKNAM],[ActualDiscTakenAmount], [PACommitted_Costs],[PACommitted_Qty],[PAPOCost],[PAPOQty],[PAPOPostedCost],[PAPOPostedQty], [PAtaxpaidamt],[PAPostedTaxPaidN],[PApretainage],[PAunpretainage],[PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt], [PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PA_RestrictCustomerList],[PAPosted_Earnings],[PAActualCostofEarnings],[PAUnpostedLossAmount], [PAActualLossAmount],[PAFQLaborOnly],[PAAQLaborOnly],[PAMCCURNCYID],[PAMCProjectAmount],[PAMCUnpostBillN], [PAMCUnpostedSalesTax],[PAMCUnpostedDiscount],[PAMCActualBillings],[PAMCActualSalesTaxAmt],[PAMCActualDiscountAmt],[PAMCBBillings], [PAMCFBillings],[PA_MC_Project_Fee_Amount],[PA_MC_Retainer_Fee_Amt],[PA_MC_Service_Fee_Amount],[PA_MC_UnpostedProjectFee],[PA_MC_Unposted_Retainer], [PA_MC_UnpostedServiceFee],[PA_MC_Actual_Project_Fee],[PA_MC_Actual_RetainerFee],[PA_MC_Actual_Service_Fee] ) select [CUSTNMBR],[PAcontid],[PALONGID_1],[PALONGID_2],[PALONGID_3],[PALONGID_4], [PALONGID_5],[PAcontname],[PACONTNUMBER],[PAcontclassid],[PAProjectType],[PAAcctgMethod], [PASTAT],[CURRNIDX],[PApurordnum],[PABBeginDate],[PABEndDate],[PAFBeginDate], [PAFEndDate],[PAACTUALBEGDATE],[PA_Actual_End_Date],[PAcloseProjcosts],[PAclosetobillings],[PAContMgrID], [PABusMgrID],[LOCATNID],[SLPRSNID],[SALSTERR],[COMPRCNT],[COMAPPTO], [PABILLFORMAT],[ADRSCODE],[CNTCPRSN],[PRBTADCD],[PAUD1_Cont],[PAUD2_Cont], [PASegmentCB],[PAbillnoteidx],[PAbillnoteidxts],[PAELbillniteidx],[PAbillnoteidxML],[PAbillnoteidxvi], [PAbillnoteidxee],[PAbillnoteidxinv],[PAbillnoteidxfee],[PABQuantity],[PABTotalCost],[PABBillings], [PABProfit],[PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PAFQuantity],[PAFTotalCost], [PAFBillings],[PAFProfit],[PAFTaxPaidAmt],[PAFTaxChargedAmt],[PAForecastOvhdCost],[PAProject_Amount], [PAUnpostedQty],[PAUnpostedTotalCostN],[PAUnposted_Overhead],[PAUnpostedProfitN],[PAUnposted_Tax_Amount],[PAUnpostAccrRevN], [PAUnpostedCommitedQty],[PAUnpostedCommitedCost],[PAUnpostedCommitedTaxAmt],[PAUnpostedRecogRevN],[PAUnposted_Project_Fee],[PAUnposted_Retainer_Fee], [PAUnposted_Service_Fee],[PAUNPOSTRETAMT],[PAUNPOSTBIEEAMOUNT],[PAUNPEIEBAMOUNT],[PA_Unposted_Billed_Reten],[PAPostedQty], [PAPostedTotalCostN],[PAPosted_Overhead],[PAPostedProfitN],[PAPosted_Tax_Amount],[PAPosted_Accr_RevN],[PAPostedCommitedQty], [PAPostedCommitedCost],[PAPostedCommitedTaxAmt],[PAPostRecogRevN],[PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPosted_Service_Fee], [PAPOSTRETAMT],[PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PA_Actual_Billed_Retenti],[PAWrite_UpDown_Amount],[PABilled_QtyN], [PABilled_Cost],[PABilled_Accrued_Revenu],[PACostPcntCompleted],[PAQuantityPcntCompleted],[PA_Receipts_Amount],[PA_Actual_Receipts_Amoun], [PA_Earnings],[PA_Cost_of_Earnings],[PAUnpostBillN],[PAUnpostDiscDolAmtN],[PAUnposted_Sales_Tax_Am],[PAPostedBillingsN], [PAPostedDiscDolAmtN],[PAPosted_Sales_Tax_Amou],[PAService_Fee_Amount],[PARetainer_Fee_Amount],[PAProject_Fee_Amount],[PARetentionFeeAmount], [DSCPCTAM],[PABCWPAMT],[PABCWSAMT],[PAACWPAMT],[NOTEINDX],[PAApproved_Accrued_Reve], [PAApproved_Cost],[PAApproved_Quantity],[WROFAMNT],[ActualWriteOffAmount],[DISTKNAM],[ActualDiscTakenAmount], [PACommitted_Costs],[PACommitted_Qty],[PAPOCost],[PAPOQty],[PAPOPostedCost],[PAPOPostedQty], [PAtaxpaidamt],[PAPostedTaxPaidN],[PApretainage],[PAunpretainage],[PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt], [PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PA_RestrictCustomerList],[PAPosted_Earnings],[PAActualCostofEarnings],[PAUnpostedLossAmount], [PAActualLossAmount],[PAFQLaborOnly],[PAAQLaborOnly],[PAMCCURNCYID],[PAMCProjectAmount],[PAMCUnpostBillN], [PAMCUnpostedSalesTax],[PAMCUnpostedDiscount],[PAMCActualBillings],[PAMCActualSalesTaxAmt],[PAMCActualDiscountAmt],[PAMCBBillings], [PAMCFBillings],[PA_MC_Project_Fee_Amount],[PA_MC_Retainer_Fee_Amt],[PA_MC_Service_Fee_Amount],[PA_MC_UnpostedProjectFee],[PA_MC_Unposted_Retainer], [PA_MC_UnpostedServiceFee],[PA_MC_Actual_Project_Fee],[PA_MC_Actual_RetainerFee],[PA_MC_Actual_Service_Fee] from ' + rtrim(@I_vFromCompany) + '..PA01101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01111' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01111 ( [PACONTNUMBER],[CUSTNMBR] ) select [PACONTNUMBER],[CUSTNMBR] from ' + rtrim(@I_vFromCompany) + '..PA01111 ' exec(@cStatement) exec @iStatus = eeCompanyCopyPA2 @I_vFromCompany,			 @I_vToCompany,				 @I_vData,					 @I_vReportOptions,			 @O_iErrorState output		 if ((@iStatus <> 0) or (@O_iErrorState <> 0)) begin select @O_iErrorState = 1  return (@O_iErrorState) end end return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyPA] TO [DYNGRP]
GO
