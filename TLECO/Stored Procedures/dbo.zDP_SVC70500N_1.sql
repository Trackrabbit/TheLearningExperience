SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SVC70500N_1] (@BS int, @RPTGRIND smallint, @RTPACHIN smallint, @RTGRSBIN numeric(19,5), @RPTGRIND_RS smallint, @RTPACHIN_RS smallint, @RTGRSBIN_RS numeric(19,5), @RPTGRIND_RE smallint, @RTPACHIN_RE smallint, @RTGRSBIN_RE numeric(19,5)) AS  set nocount on IF @RPTGRIND_RS IS NULL BEGIN SELECT TOP 25  PRTBYSIT, PRNTOPTN, STTGNDSC, ENGENDSC, ENUSRCAT_1, ENUSRCAT_2, ENUSRCAT_3, ENUSRCAT_4, ENUSRCAT_5, ENUSRCAT_6, STRTUCAT_1, STRTUCAT_2, STRTUCAT_3, STRTUCAT_4, STRTUCAT_5, STRTUCAT_6, CALLNBST, CALLNMEN, CONTNBRS, CONTNBRE, SRLNBRST, SRLNBREN, PMDTLIDS, PMDTLIDE, STCUSTID, ENCUSTID, STTECHID, ENTECHID, STOFFID, ENOFFID, SVCOPT1, ENDSVCO1, STSVCOP1, ENSVCOP2, STSVCOPT3, ENSVCOP3, STSVCOP4, ENSVCOP4, STSVCOP5, ENSVCOP5, STSVCOP6, ENSVCOP6, STSVCOP7, ENSVCOP7, STSVCOP8, ENSVCOP8, STSVCOP9, ENSVCOP9, STSVCO10, ENSVCO10, STTITNUM, ENITMNBR, SRVRECTYPE, CONSTS, PRVDRINF, PRTDSCNT, PRTSVCHS, SVCRPTNM, PRNTNOTS, PRNTTYPE, ASKECHTM, INCLGNDS, PRNTOFIL, PRTOPRTR, PRTOSCRN, IFFILXST, FILEXPNM, EXPTTYPE, RPTGRIND, STTCLASS, ENDCLASS, STRTDSCR, ENDDESCR, STTSCHED, ENSCHDUL, STTLOCCD, ENLOCNCD, STTLOTTY, ENLOTTYP, STRTNGDT, ENDINGDT, ENDTKNDT, STTOKNDT, STRCTNUM, ENRCTNBR, RTPACHIN, RTGRSBIN, SORTBY, PRTSRLOT, INZROQTY, PRTITQTY, STTBINUM, ENBINNBR, STDOCNUM, ENDOCNUM, STDOCTYP, ENDOCTYP, STTMODUL, ENDMODUL, STRXSRC, ENTRXSRC, STBCHSRC, ENBCHSRC, STBCHNUM, ENDBNMBR, STVNDRID, ENDVNDID, INQTYREQ, INZRORLV, CALSGQTY, RCPTOPTS, VENDROPT, SEGSRTBY, SEGMNTRG, Start_PriceLevel, End_PriceLevel, Start_RMA_Number, End_RMA_Number, Start_Required_Date, End_Required_Date, SVC_Print_Open, INCMCINF, PRTCURIN, DEX_ROW_ID FROM .SVC70500 WHERE ( RPTGRIND = @RPTGRIND AND RTPACHIN = @RTPACHIN AND RTGRSBIN > @RTGRSBIN OR RPTGRIND = @RPTGRIND AND RTPACHIN > @RTPACHIN OR RPTGRIND > @RPTGRIND ) ORDER BY RPTGRIND ASC, RTPACHIN ASC, RTGRSBIN ASC END ELSE IF @RPTGRIND_RS = @RPTGRIND_RE BEGIN SELECT TOP 25  PRTBYSIT, PRNTOPTN, STTGNDSC, ENGENDSC, ENUSRCAT_1, ENUSRCAT_2, ENUSRCAT_3, ENUSRCAT_4, ENUSRCAT_5, ENUSRCAT_6, STRTUCAT_1, STRTUCAT_2, STRTUCAT_3, STRTUCAT_4, STRTUCAT_5, STRTUCAT_6, CALLNBST, CALLNMEN, CONTNBRS, CONTNBRE, SRLNBRST, SRLNBREN, PMDTLIDS, PMDTLIDE, STCUSTID, ENCUSTID, STTECHID, ENTECHID, STOFFID, ENOFFID, SVCOPT1, ENDSVCO1, STSVCOP1, ENSVCOP2, STSVCOPT3, ENSVCOP3, STSVCOP4, ENSVCOP4, STSVCOP5, ENSVCOP5, STSVCOP6, ENSVCOP6, STSVCOP7, ENSVCOP7, STSVCOP8, ENSVCOP8, STSVCOP9, ENSVCOP9, STSVCO10, ENSVCO10, STTITNUM, ENITMNBR, SRVRECTYPE, CONSTS, PRVDRINF, PRTDSCNT, PRTSVCHS, SVCRPTNM, PRNTNOTS, PRNTTYPE, ASKECHTM, INCLGNDS, PRNTOFIL, PRTOPRTR, PRTOSCRN, IFFILXST, FILEXPNM, EXPTTYPE, RPTGRIND, STTCLASS, ENDCLASS, STRTDSCR, ENDDESCR, STTSCHED, ENSCHDUL, STTLOCCD, ENLOCNCD, STTLOTTY, ENLOTTYP, STRTNGDT, ENDINGDT, ENDTKNDT, STTOKNDT, STRCTNUM, ENRCTNBR, RTPACHIN, RTGRSBIN, SORTBY, PRTSRLOT, INZROQTY, PRTITQTY, STTBINUM, ENBINNBR, STDOCNUM, ENDOCNUM, STDOCTYP, ENDOCTYP, STTMODUL, ENDMODUL, STRXSRC, ENTRXSRC, STBCHSRC, ENBCHSRC, STBCHNUM, ENDBNMBR, STVNDRID, ENDVNDID, INQTYREQ, INZRORLV, CALSGQTY, RCPTOPTS, VENDROPT, SEGSRTBY, SEGMNTRG, Start_PriceLevel, End_PriceLevel, Start_RMA_Number, End_RMA_Number, Start_Required_Date, End_Required_Date, SVC_Print_Open, INCMCINF, PRTCURIN, DEX_ROW_ID FROM .SVC70500 WHERE RPTGRIND = @RPTGRIND_RS AND RTPACHIN BETWEEN @RTPACHIN_RS AND @RTPACHIN_RE AND RTGRSBIN BETWEEN @RTGRSBIN_RS AND @RTGRSBIN_RE AND ( RPTGRIND = @RPTGRIND AND RTPACHIN = @RTPACHIN AND RTGRSBIN > @RTGRSBIN OR RPTGRIND = @RPTGRIND AND RTPACHIN > @RTPACHIN OR RPTGRIND > @RPTGRIND ) ORDER BY RPTGRIND ASC, RTPACHIN ASC, RTGRSBIN ASC END ELSE BEGIN SELECT TOP 25  PRTBYSIT, PRNTOPTN, STTGNDSC, ENGENDSC, ENUSRCAT_1, ENUSRCAT_2, ENUSRCAT_3, ENUSRCAT_4, ENUSRCAT_5, ENUSRCAT_6, STRTUCAT_1, STRTUCAT_2, STRTUCAT_3, STRTUCAT_4, STRTUCAT_5, STRTUCAT_6, CALLNBST, CALLNMEN, CONTNBRS, CONTNBRE, SRLNBRST, SRLNBREN, PMDTLIDS, PMDTLIDE, STCUSTID, ENCUSTID, STTECHID, ENTECHID, STOFFID, ENOFFID, SVCOPT1, ENDSVCO1, STSVCOP1, ENSVCOP2, STSVCOPT3, ENSVCOP3, STSVCOP4, ENSVCOP4, STSVCOP5, ENSVCOP5, STSVCOP6, ENSVCOP6, STSVCOP7, ENSVCOP7, STSVCOP8, ENSVCOP8, STSVCOP9, ENSVCOP9, STSVCO10, ENSVCO10, STTITNUM, ENITMNBR, SRVRECTYPE, CONSTS, PRVDRINF, PRTDSCNT, PRTSVCHS, SVCRPTNM, PRNTNOTS, PRNTTYPE, ASKECHTM, INCLGNDS, PRNTOFIL, PRTOPRTR, PRTOSCRN, IFFILXST, FILEXPNM, EXPTTYPE, RPTGRIND, STTCLASS, ENDCLASS, STRTDSCR, ENDDESCR, STTSCHED, ENSCHDUL, STTLOCCD, ENLOCNCD, STTLOTTY, ENLOTTYP, STRTNGDT, ENDINGDT, ENDTKNDT, STTOKNDT, STRCTNUM, ENRCTNBR, RTPACHIN, RTGRSBIN, SORTBY, PRTSRLOT, INZROQTY, PRTITQTY, STTBINUM, ENBINNBR, STDOCNUM, ENDOCNUM, STDOCTYP, ENDOCTYP, STTMODUL, ENDMODUL, STRXSRC, ENTRXSRC, STBCHSRC, ENBCHSRC, STBCHNUM, ENDBNMBR, STVNDRID, ENDVNDID, INQTYREQ, INZRORLV, CALSGQTY, RCPTOPTS, VENDROPT, SEGSRTBY, SEGMNTRG, Start_PriceLevel, End_PriceLevel, Start_RMA_Number, End_RMA_Number, Start_Required_Date, End_Required_Date, SVC_Print_Open, INCMCINF, PRTCURIN, DEX_ROW_ID FROM .SVC70500 WHERE RPTGRIND BETWEEN @RPTGRIND_RS AND @RPTGRIND_RE AND RTPACHIN BETWEEN @RTPACHIN_RS AND @RTPACHIN_RE AND RTGRSBIN BETWEEN @RTGRSBIN_RS AND @RTGRSBIN_RE AND ( RPTGRIND = @RPTGRIND AND RTPACHIN = @RTPACHIN AND RTGRSBIN > @RTGRSBIN OR RPTGRIND = @RPTGRIND AND RTPACHIN > @RTPACHIN OR RPTGRIND > @RPTGRIND ) ORDER BY RPTGRIND ASC, RTPACHIN ASC, RTGRSBIN ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SVC70500N_1] TO [DYNGRP]
GO
