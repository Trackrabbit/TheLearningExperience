SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyExPr] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255) select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '' if (@I_vData = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV10400' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV10400 ( [PRCGRPID],[ITEMNMBR],[SEQNUMBR] ) select [PRCGRPID],[ITEMNMBR],[SEQNUMBR] from ' + rtrim(@I_vFromCompany) + '..IV10400 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV10401' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV10401 ( [PRCSHID],[SEQNUMBR],[EPITMTYP],[ITEMNMBR],[BRKPTPRC],[ACTIVE], [BASEUOFM],[PRODTCOD],[PROMOTYP],[PROMOLVL] ) select [PRCSHID],[SEQNUMBR],[EPITMTYP],[ITEMNMBR],[BRKPTPRC],[ACTIVE], [BASEUOFM],[PRODTCOD],[PROMOTYP],[PROMOLVL] from ' + rtrim(@I_vFromCompany) + '..IV10401 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV10402' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV10402 ( [PRCSHID],[EPITMTYP],[ITEMNMBR],[UOFM],[QTYFROM],[QTYTO], [PSITMVAL],[EQUOMQTY],[QTYBSUOM],[SEQNUMBR] ) select [PRCSHID],[EPITMTYP],[ITEMNMBR],[UOFM],[QTYFROM],[QTYTO], [PSITMVAL],[EQUOMQTY],[QTYBSUOM],[SEQNUMBR] from ' + rtrim(@I_vFromCompany) + '..IV10402 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV10403' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV10403 ( [PRCSHID],[EPITMTYP],[ITEMNMBR],[UOFM],[FREEITEM],[FREEUOFM], [MAXQTYFR],[QTYFROM],[QTYTO] ) select [PRCSHID],[EPITMTYP],[ITEMNMBR],[UOFM],[FREEITEM],[FREEUOFM], [MAXQTYFR],[QTYFROM],[QTYTO] from ' + rtrim(@I_vFromCompany) + '..IV10403 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM00500' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM00500 ( [PRCSHID],[PRODTCOD],[LINKCODE],[SEQNUMBR],[PSSEQNUM] ) select [PRCSHID],[PRODTCOD],[LINKCODE],[SEQNUMBR],[PSSEQNUM] from ' + rtrim(@I_vFromCompany) + '..RM00500 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP10108' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP10108 ( [PRCGRPID],[DESCEXPR],[DECPLCUR],[DECPLQTY],[UOMSCHDL],[NOTEINDX] ) select [PRCGRPID],[DESCEXPR],[DECPLCUR],[DECPLQTY],[UOMSCHDL],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..SOP10108 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP10109' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP10109 ( [PRCBKID],[DESCEXPR],[ISBASE],[NOTEINDX] ) select [PRCBKID],[DESCEXPR],[ISBASE],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..SOP10109 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP10110' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP10110 ( [PRCSHID],[DESCEXPR],[NTPRONLY],[ACTIVE],[STRTDATE],[ENDDATE], [NOTEINDX],[PROMO],[CURNCYID] ) select [PRCSHID],[DESCEXPR],[NTPRONLY],[ACTIVE],[STRTDATE],[ENDDATE], [NOTEINDX],[PROMO],[CURNCYID] from ' + rtrim(@I_vFromCompany) + '..SOP10110 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP10205' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP10205 ( [PRCBKID],[PRODTCOD],[LINKCODE],[SEQNUMBR] ) select [PRCBKID],[PRODTCOD],[LINKCODE],[SEQNUMBR] from ' + rtrim(@I_vFromCompany) + '..SOP10205 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..SOP40709' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..SOP40709 ( [PRCGRPID],[CURNCYID],[DECPLCUR] ) select [PRCGRPID],[CURNCYID],[DECPLCUR] from ' + rtrim(@I_vFromCompany) + '..SOP40709 ' exec(@cStatement) end return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyExPr] TO [DYNGRP]
GO
