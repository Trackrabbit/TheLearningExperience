SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SY04910N_1] (@BS int, @DICTRYID smallint, @MODULE1 smallint, @DOCTYPE smallint, @DOCNUMBR char(21), @DICTRYID_RS smallint, @MODULE1_RS smallint, @DOCTYPE_RS smallint, @DOCNUMBR_RS char(21), @DICTRYID_RE smallint, @MODULE1_RE smallint, @DOCTYPE_RE smallint, @DOCNUMBR_RE char(21)) AS  set nocount on IF @DICTRYID_RS IS NULL BEGIN SELECT TOP 25  MODULE1, DOCTYPE, DOCNUMBR, Master_ID, ADRSCODE, EmailMessageID, EmailSubject, EmailMessageFrom, DICTRYID, DEX_ROW_ID, EmailToAddress, EmailCcAddress, EmailBccAddress, EmailBody, EmailReplyToAddress FROM .SY04910 WHERE ( DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR > @DOCNUMBR OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE > @DOCTYPE OR DICTRYID = @DICTRYID AND MODULE1 > @MODULE1 OR DICTRYID > @DICTRYID ) ORDER BY DICTRYID ASC, MODULE1 ASC, DOCTYPE ASC, DOCNUMBR ASC END ELSE IF @DICTRYID_RS = @DICTRYID_RE BEGIN SELECT TOP 25  MODULE1, DOCTYPE, DOCNUMBR, Master_ID, ADRSCODE, EmailMessageID, EmailSubject, EmailMessageFrom, DICTRYID, DEX_ROW_ID, EmailToAddress, EmailCcAddress, EmailBccAddress, EmailBody, EmailReplyToAddress FROM .SY04910 WHERE DICTRYID = @DICTRYID_RS AND MODULE1 BETWEEN @MODULE1_RS AND @MODULE1_RE AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND DOCNUMBR BETWEEN @DOCNUMBR_RS AND @DOCNUMBR_RE AND ( DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR > @DOCNUMBR OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE > @DOCTYPE OR DICTRYID = @DICTRYID AND MODULE1 > @MODULE1 OR DICTRYID > @DICTRYID ) ORDER BY DICTRYID ASC, MODULE1 ASC, DOCTYPE ASC, DOCNUMBR ASC END ELSE BEGIN SELECT TOP 25  MODULE1, DOCTYPE, DOCNUMBR, Master_ID, ADRSCODE, EmailMessageID, EmailSubject, EmailMessageFrom, DICTRYID, DEX_ROW_ID, EmailToAddress, EmailCcAddress, EmailBccAddress, EmailBody, EmailReplyToAddress FROM .SY04910 WHERE DICTRYID BETWEEN @DICTRYID_RS AND @DICTRYID_RE AND MODULE1 BETWEEN @MODULE1_RS AND @MODULE1_RE AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND DOCNUMBR BETWEEN @DOCNUMBR_RS AND @DOCNUMBR_RE AND ( DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE = @DOCTYPE AND DOCNUMBR > @DOCNUMBR OR DICTRYID = @DICTRYID AND MODULE1 = @MODULE1 AND DOCTYPE > @DOCTYPE OR DICTRYID = @DICTRYID AND MODULE1 > @MODULE1 OR DICTRYID > @DICTRYID ) ORDER BY DICTRYID ASC, MODULE1 ASC, DOCTYPE ASC, DOCNUMBR ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY04910N_1] TO [DYNGRP]
GO
