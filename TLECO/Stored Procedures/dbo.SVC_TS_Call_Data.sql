SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[SVC_TS_Call_Data] (@CALLNBR char(11)) AS select distinct  IsNull(RTRIM(SVC00200.TECHID),'') 'TECHID', IsNull(SVC00100.NAME,'') 'NAME', SVC00200.CALLNBR, SVC00200.OFFID, SVC00200.SVCAREA,  SVC00200.SRVSTAT,  SVC00200.SRVTYPE, SVC00200.priorityLevel,  SVC00200.SVCDESCR, SVC00200.CUSTNMBR,  SVC00200.ADRSCODE,  SVC00200.CONTNBR, SVC00200.SVC_Contract_Line_SEQ, SVC00200.CNTCPRSN 'CONTACT',  SVC00200.ETADTE 'ETADATE', SVC00200.ETATME 'ETATIME', SVC00200.Response_Date as 'RESPONSEDATE',  CONVERT(char(5),SVC00200.Response_Time,108) 'RESPONSETIME',  SVC00200.ENTDTE as 'ENTDATE',  CONVERT(char(5),SVC00200.ENTTME,108) 'ENTTIME', SVC00200.ETTR, RM00101.CUSTNAME, IsNull(SVC00907.DSCRIPTN,'Not Defined') 'PROBLEM' ,  CONVERT(numeric(19,2),DATEDIFF(ss,GETDATE(),  case   when (CONVERT(char(10),SVC00200.Response_Date,101)  = '01/01/1900')  THEN GETDATE()   ELSE SVC00200.Response_Date  + ' ' + CONVERT(char(5),SVC00200.Response_Time,108)   end))/  IsNull(NullIf(CONVERT(numeric(19,2),DATEDIFF(ss,( SVC00200.ENTDTE  + ' ' + CONVERT(char(5),SVC00200.ENTTME,108)),   case   when (CONVERT(char(10),SVC00200.Response_Date,101) = '01/01/1900')   THEN GETDATE()   ELSE  SVC00200.Response_Date + ' ' + CONVERT(char(5),SVC00200.Response_Time,108)   end)),0),1)  'RESPONSE'  , IsNull(SVC00201.ITEMNMBR,'') 'ITEMNMBR', SVC00200.ADDRESS1, SVC00200.ADDRESS2, SVC00200.CITY, SVC00200.STATE, SVC00200.ZIP, SVC00200.PHONE1, IsNull(SVC00300.SERLNMBR,'') 'SERLNMBR', IsNull(IV00101.ITEMDESC,'') 'ITEMDESC' from SVC00200 INNER JOIN   RM00101 ON (SVC00200.CUSTNMBR = RM00101.CUSTNMBR) LEFT OUTER JOIN  SVC00201 ON (SVC00200.SRVRECTYPE = SVC00201.SRVRECTYPE and SVC00200.CALLNBR = SVC00201.CALLNBR) LEFT OUTER JOIN  SVC00300 ON (SVC00201.EQUIPID = SVC00300.EQUIPID) LEFT OUTER JOIN  IV00101 ON (SVC00201.ITEMNMBR = IV00101.ITEMNMBR) LEFT OUTER JOIN  SVC00907 ON (SVC00201.PROBCDE = SVC00907.PROBCDE) LEFT OUTER JOIN  SVC00100 ON (SVC00200.TECHID = SVC00100.TECHID) where SVC00200.SRVRECTYPE = 2 and  SVC00200.CALLNBR = @CALLNBR   
GO
GRANT EXECUTE ON  [dbo].[SVC_TS_Call_Data] TO [DYNGRP]
GO
