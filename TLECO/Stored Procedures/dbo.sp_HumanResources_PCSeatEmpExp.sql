SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_HumanResources_PCSeatEmpExp] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(1000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,   @Plan_Code varchar(255), @Plan_Code_Description varchar(255), @Position_Code varchar(255), @Position_Code_Description varchar(255), @Department varchar(255), @Department_Description  varchar(255),  @Seats_Start_Date varchar(255), @Seats_End_Date varchar(255), @Seat varchar(255), @Seat_Description varchar(255), @Temporary_Seat varchar(255), @Employee_ID varchar(255), @Employee_Name varchar(255),  @ER_Expense_Date varchar(255), @Wage_Expense varchar(255), @Benefit_Expense varchar(255), @Tax_Expense varchar(255)  select @I_iDictID = 0 select @I_iMessageNumber = 22114 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Plan_Code output   select @I_iDictID = 0 select @I_iMessageNumber = 22090 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Plan_Code_Description output   select @I_iDictID = 414 select @I_iMessageNumber = 26120 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Position_Code output   select @I_iDictID = 0 select @I_iMessageNumber = 22093 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Position_Code_Description output   select @I_iDictID = 414 select @I_iMessageNumber = 26675 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Department output   select @I_iDictID = 0 select @I_iMessageNumber = 22069 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Department_Description output   select @I_iDictID = 0 select @I_iMessageNumber = 22192 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Seat output   select @I_iDictID = 0 select @I_iMessageNumber = 22193 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Seat_Description output   select @I_iDictID = 0 select @I_iMessageNumber = 22217 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Temporary_Seat output   select @I_iDictID = 1493 select @I_iMessageNumber = 23502 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Employee_ID output   select @I_iDictID = 0 select @I_iMessageNumber = 22051 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Employee_Name output   select @I_iDictID = 0 select @I_iMessageNumber = 22198 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Seats_Start_Date output   select @I_iDictID = 0 select @I_iMessageNumber = 22199 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Seats_End_Date output   select @I_iDictID = 0 select @I_iMessageNumber = 22218 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ER_Expense_Date output   select @I_iDictID = 0 select @I_iMessageNumber = 22219 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Wage_Expense output   select @I_iDictID = 0 select @I_iMessageNumber = 22220 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Benefit_Expense output   select @I_iDictID = 0 select @I_iMessageNumber = 22221 select @I_iAliasMessageNumber = 0  exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tax_Expense output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[PC_Seat_Employer_Exp]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[PC_Seat_Employer_Exp] '  select @sqldefaultstring =   'CREATE VIEW PC_Seat_Employer_Exp AS ' +   'select ' +  'rtrim([''A''].[PlanCode]) as ''' + @Plan_Code + ''', ' +  'rtrim([''A''].[PlanDesc]) as ''' + @Plan_Code_Description + ''', ' + 'rtrim([''A''].[Position]) as ''' + @Position_Code + ''', ' + 'rtrim([''A''].[PosDescription]) as ''' + @Position_Code_Description + ''', ' + 'rtrim([''A''].[Department]) as ''' + @Department + ''', ' + 'rtrim([''A''].[DepDescription]) as ''' + @Department_Description + ''', ' + 'rtrim(cast(datepart(mm,[''A''].[StartDate]) as varchar(2))) + ''/'' +  rtrim(cast(datepart(dd,[''A''].[StartDate]) as varchar(2))) + ''/'' +  rtrim(cast(datepart(yy,[''A''].[StartDate]) as varchar(4))) as ''' + @Seats_Start_Date + ''', ' +  'rtrim(cast(datepart(mm,[''A''].[EndDate]) as varchar(2))) + ''/'' +   rtrim(cast(datepart(dd,[''A''].[EndDate]) as varchar(2))) + ''/'' +   rtrim(cast(datepart(yy,[''A''].[EndDate]) as varchar(4))) as ''' + @Seats_End_Date + ''', ' +  '[''A''].[SeatNumber] as ''' + @Seat + ''', ' +  'rtrim([''A''].[SeatDesc]) as ''' + @Seat_Description + ''', ' +  '[''A''].[TempSeat] as ''' + @Temporary_Seat + ''', ' +  'rtrim([''A''].[EmployeeID]) as ''' + @Employee_ID + ''', ' +  'rtrim([''A''].[EmployeeName]) as ''' + @Employee_Name + ''', ' +  'rtrim(cast(datepart(mm,[''A''].[Date]) as varchar(2))) + ''/'' +  rtrim(cast(datepart(dd,[''A''].[Date]) as varchar(2))) + ''/'' +    rtrim(cast(datepart(yy,[''A''].[Date]) as varchar(4))) as ''' + @ER_Expense_Date + ''', ' +  '[''A''].[WageAmount] as ''' + @Wage_Expense + ''', ' +  '[''A''].[BenefitsAmount] as ''' + @Benefit_Expense + ''', ' +  '[''A''].[TaxAmount] as ''' + @Tax_Expense + ''' ' +  ' FROM PC_EmployerCostDaily(''*CURRENT'',0) as [''A''] '  select @sqlaccessstring =   'GRANT SELECT ON [dbo].[PC_Seat_Employer_Exp] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[PC_Seat_Employer_Exp] TO [rpt_human resource administrator]'   exec (@sqldropstring)   exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+'  '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+'  '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)   exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_HumanResources_PCSeatEmpExp] TO [DYNGRP]
GO
