SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_ME123503F_2] (@PP_Number_RS char(21), @MEUPDT_RS datetime, @MEUPTIM_RS datetime, @PP_Number_RE char(21), @MEUPDT_RE datetime, @MEUPTIM_RE datetime) AS  set nocount on IF @PP_Number_RS IS NULL BEGIN SELECT TOP 25  MEUPLDID, MEUPDT, MEUPTIM, MKLSSTDD, MELDTDT, MENUMUPLDS, PP_Number, ME_Number_of_Checks, ME_Number_of_Voids, ME_Checks_Amount, ME_Voids_Amount, ME_Confirmation_Number, DEX_ROW_ID FROM .ME123503 ORDER BY PP_Number ASC, MEUPDT DESC, MEUPTIM DESC END ELSE IF @PP_Number_RS = @PP_Number_RE BEGIN SELECT TOP 25  MEUPLDID, MEUPDT, MEUPTIM, MKLSSTDD, MELDTDT, MENUMUPLDS, PP_Number, ME_Number_of_Checks, ME_Number_of_Voids, ME_Checks_Amount, ME_Voids_Amount, ME_Confirmation_Number, DEX_ROW_ID FROM .ME123503 WHERE PP_Number = @PP_Number_RS AND MEUPDT BETWEEN @MEUPDT_RE AND @MEUPDT_RS AND MEUPTIM BETWEEN @MEUPTIM_RE AND @MEUPTIM_RS ORDER BY PP_Number ASC, MEUPDT DESC, MEUPTIM DESC END ELSE BEGIN SELECT TOP 25  MEUPLDID, MEUPDT, MEUPTIM, MKLSSTDD, MELDTDT, MENUMUPLDS, PP_Number, ME_Number_of_Checks, ME_Number_of_Voids, ME_Checks_Amount, ME_Voids_Amount, ME_Confirmation_Number, DEX_ROW_ID FROM .ME123503 WHERE PP_Number BETWEEN @PP_Number_RS AND @PP_Number_RE AND MEUPDT BETWEEN @MEUPDT_RE AND @MEUPDT_RS AND MEUPTIM BETWEEN @MEUPTIM_RE AND @MEUPTIM_RS ORDER BY PP_Number ASC, MEUPDT DESC, MEUPTIM DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_ME123503F_2] TO [DYNGRP]
GO
