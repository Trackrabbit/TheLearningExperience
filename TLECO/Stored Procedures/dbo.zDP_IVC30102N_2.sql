SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IVC30102N_2] (@BS int, @DOCTYPE smallint, @INVCNMBR char(21), @LNITMSEQ int, @CMPNTSEQ int, @BRKFLD1 smallint, @BRKFLD2 smallint, @BRKFLD3 smallint, @DOCTYPE_RS smallint, @INVCNMBR_RS char(21), @LNITMSEQ_RS int, @CMPNTSEQ_RS int, @BRKFLD1_RS smallint, @BRKFLD2_RS smallint, @BRKFLD3_RS smallint, @DOCTYPE_RE smallint, @INVCNMBR_RE char(21), @LNITMSEQ_RE int, @CMPNTSEQ_RE int, @BRKFLD1_RE smallint, @BRKFLD2_RE smallint, @BRKFLD3_RE smallint) AS  set nocount on IF @DOCTYPE_RS IS NULL BEGIN SELECT TOP 25  DOCTYPE, INVCNMBR, LNITMSEQ, CMPNTSEQ, NONINVEN, ITEMNMBR, DECPLCUR, DECPLQTY, ITMTSHID, IVITMTXB, QUANTITY, QTYINSVC, QTYINUSE, QTYDMGED, QTYRTRND, QTYONHND, EXTQTYSEL, UOFM, QTYBSUOM, UNITCOST, EXTDCOST, ATYALLOC, LOCNCODE, MRKDNTYP, MRKDNAMT, MRKDNPCT, PRCLEVEL, XTNDPRCE, UNITPRCE, TAXAMNT, BKTSLSAM, TXBTXAMT, SLPRSNID, SALSTERR, DSCRIPTN, ITEMDESC, EXPTSHIP, ACTLSHIP, ReqShipDate, COMDLRAM, CMPSERNM, COMMNTID, BRKFLD1, BRKFLD2, BRKFLD3, TRXSORCE, PRSTADCD, SHIPMTHD, ISLINEINTRA, DEX_ROW_ID FROM .IVC30102 WHERE ( DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND BRKFLD1 = @BRKFLD1 AND BRKFLD2 = @BRKFLD2 AND BRKFLD3 > @BRKFLD3 OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND BRKFLD1 = @BRKFLD1 AND BRKFLD2 > @BRKFLD2 OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND BRKFLD1 > @BRKFLD1 OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ > @CMPNTSEQ OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ > @LNITMSEQ OR DOCTYPE = @DOCTYPE AND INVCNMBR > @INVCNMBR OR DOCTYPE > @DOCTYPE ) ORDER BY DOCTYPE ASC, INVCNMBR ASC, LNITMSEQ ASC, CMPNTSEQ ASC, BRKFLD1 ASC, BRKFLD2 ASC, BRKFLD3 ASC END ELSE IF @DOCTYPE_RS = @DOCTYPE_RE BEGIN SELECT TOP 25  DOCTYPE, INVCNMBR, LNITMSEQ, CMPNTSEQ, NONINVEN, ITEMNMBR, DECPLCUR, DECPLQTY, ITMTSHID, IVITMTXB, QUANTITY, QTYINSVC, QTYINUSE, QTYDMGED, QTYRTRND, QTYONHND, EXTQTYSEL, UOFM, QTYBSUOM, UNITCOST, EXTDCOST, ATYALLOC, LOCNCODE, MRKDNTYP, MRKDNAMT, MRKDNPCT, PRCLEVEL, XTNDPRCE, UNITPRCE, TAXAMNT, BKTSLSAM, TXBTXAMT, SLPRSNID, SALSTERR, DSCRIPTN, ITEMDESC, EXPTSHIP, ACTLSHIP, ReqShipDate, COMDLRAM, CMPSERNM, COMMNTID, BRKFLD1, BRKFLD2, BRKFLD3, TRXSORCE, PRSTADCD, SHIPMTHD, ISLINEINTRA, DEX_ROW_ID FROM .IVC30102 WHERE DOCTYPE = @DOCTYPE_RS AND INVCNMBR BETWEEN @INVCNMBR_RS AND @INVCNMBR_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE AND CMPNTSEQ BETWEEN @CMPNTSEQ_RS AND @CMPNTSEQ_RE AND BRKFLD1 BETWEEN @BRKFLD1_RS AND @BRKFLD1_RE AND BRKFLD2 BETWEEN @BRKFLD2_RS AND @BRKFLD2_RE AND BRKFLD3 BETWEEN @BRKFLD3_RS AND @BRKFLD3_RE AND ( DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND BRKFLD1 = @BRKFLD1 AND BRKFLD2 = @BRKFLD2 AND BRKFLD3 > @BRKFLD3 OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND BRKFLD1 = @BRKFLD1 AND BRKFLD2 > @BRKFLD2 OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND BRKFLD1 > @BRKFLD1 OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ > @CMPNTSEQ OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ > @LNITMSEQ OR DOCTYPE = @DOCTYPE AND INVCNMBR > @INVCNMBR OR DOCTYPE > @DOCTYPE ) ORDER BY DOCTYPE ASC, INVCNMBR ASC, LNITMSEQ ASC, CMPNTSEQ ASC, BRKFLD1 ASC, BRKFLD2 ASC, BRKFLD3 ASC END ELSE BEGIN SELECT TOP 25  DOCTYPE, INVCNMBR, LNITMSEQ, CMPNTSEQ, NONINVEN, ITEMNMBR, DECPLCUR, DECPLQTY, ITMTSHID, IVITMTXB, QUANTITY, QTYINSVC, QTYINUSE, QTYDMGED, QTYRTRND, QTYONHND, EXTQTYSEL, UOFM, QTYBSUOM, UNITCOST, EXTDCOST, ATYALLOC, LOCNCODE, MRKDNTYP, MRKDNAMT, MRKDNPCT, PRCLEVEL, XTNDPRCE, UNITPRCE, TAXAMNT, BKTSLSAM, TXBTXAMT, SLPRSNID, SALSTERR, DSCRIPTN, ITEMDESC, EXPTSHIP, ACTLSHIP, ReqShipDate, COMDLRAM, CMPSERNM, COMMNTID, BRKFLD1, BRKFLD2, BRKFLD3, TRXSORCE, PRSTADCD, SHIPMTHD, ISLINEINTRA, DEX_ROW_ID FROM .IVC30102 WHERE DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND INVCNMBR BETWEEN @INVCNMBR_RS AND @INVCNMBR_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE AND CMPNTSEQ BETWEEN @CMPNTSEQ_RS AND @CMPNTSEQ_RE AND BRKFLD1 BETWEEN @BRKFLD1_RS AND @BRKFLD1_RE AND BRKFLD2 BETWEEN @BRKFLD2_RS AND @BRKFLD2_RE AND BRKFLD3 BETWEEN @BRKFLD3_RS AND @BRKFLD3_RE AND ( DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND BRKFLD1 = @BRKFLD1 AND BRKFLD2 = @BRKFLD2 AND BRKFLD3 > @BRKFLD3 OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND BRKFLD1 = @BRKFLD1 AND BRKFLD2 > @BRKFLD2 OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ = @CMPNTSEQ AND BRKFLD1 > @BRKFLD1 OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ = @LNITMSEQ AND CMPNTSEQ > @CMPNTSEQ OR DOCTYPE = @DOCTYPE AND INVCNMBR = @INVCNMBR AND LNITMSEQ > @LNITMSEQ OR DOCTYPE = @DOCTYPE AND INVCNMBR > @INVCNMBR OR DOCTYPE > @DOCTYPE ) ORDER BY DOCTYPE ASC, INVCNMBR ASC, LNITMSEQ ASC, CMPNTSEQ ASC, BRKFLD1 ASC, BRKFLD2 ASC, BRKFLD3 ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IVC30102N_2] TO [DYNGRP]
GO
