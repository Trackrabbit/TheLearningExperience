SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_DTA10100F_4] (@DTASERIES_RS smallint, @DTA_GL_Reference_RS char(25), @ACTINDX_RS int, @DTAREF_RS char(25), @SEQNUMBR_RS int, @GROUPID_RS char(15), @DTASERIES_RE smallint, @DTA_GL_Reference_RE char(25), @ACTINDX_RE int, @DTAREF_RE char(25), @SEQNUMBR_RE int, @GROUPID_RE char(15)) AS  set nocount on IF @DTASERIES_RS IS NULL BEGIN SELECT TOP 25  DTASERIES, DTAREF, ACTINDX, SEQNUMBR, GROUPID, DTA_GL_Reference, DOCNUMBR, RMDTYPAL, GROUPAMT, JRNENTRY, TRXDATE, PSTGSTUS, DEX_ROW_ID FROM .DTA10100 ORDER BY DTASERIES ASC, DTA_GL_Reference ASC, ACTINDX ASC, DTAREF ASC, SEQNUMBR ASC, GROUPID ASC END ELSE IF @DTASERIES_RS = @DTASERIES_RE BEGIN SELECT TOP 25  DTASERIES, DTAREF, ACTINDX, SEQNUMBR, GROUPID, DTA_GL_Reference, DOCNUMBR, RMDTYPAL, GROUPAMT, JRNENTRY, TRXDATE, PSTGSTUS, DEX_ROW_ID FROM .DTA10100 WHERE DTASERIES = @DTASERIES_RS AND DTA_GL_Reference BETWEEN @DTA_GL_Reference_RS AND @DTA_GL_Reference_RE AND ACTINDX BETWEEN @ACTINDX_RS AND @ACTINDX_RE AND DTAREF BETWEEN @DTAREF_RS AND @DTAREF_RE AND SEQNUMBR BETWEEN @SEQNUMBR_RS AND @SEQNUMBR_RE AND GROUPID BETWEEN @GROUPID_RS AND @GROUPID_RE ORDER BY DTASERIES ASC, DTA_GL_Reference ASC, ACTINDX ASC, DTAREF ASC, SEQNUMBR ASC, GROUPID ASC END ELSE BEGIN SELECT TOP 25  DTASERIES, DTAREF, ACTINDX, SEQNUMBR, GROUPID, DTA_GL_Reference, DOCNUMBR, RMDTYPAL, GROUPAMT, JRNENTRY, TRXDATE, PSTGSTUS, DEX_ROW_ID FROM .DTA10100 WHERE DTASERIES BETWEEN @DTASERIES_RS AND @DTASERIES_RE AND DTA_GL_Reference BETWEEN @DTA_GL_Reference_RS AND @DTA_GL_Reference_RE AND ACTINDX BETWEEN @ACTINDX_RS AND @ACTINDX_RE AND DTAREF BETWEEN @DTAREF_RS AND @DTAREF_RE AND SEQNUMBR BETWEEN @SEQNUMBR_RS AND @SEQNUMBR_RE AND GROUPID BETWEEN @GROUPID_RS AND @GROUPID_RE ORDER BY DTASERIES ASC, DTA_GL_Reference ASC, ACTINDX ASC, DTAREF ASC, SEQNUMBR ASC, GROUPID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_DTA10100F_4] TO [DYNGRP]
GO
