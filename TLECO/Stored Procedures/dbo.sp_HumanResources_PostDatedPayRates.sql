SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_HumanResources_PostDatedPayRates] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(1000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @Employee_ID varchar(255), @First_Name varchar(255), @Last_Name varchar(255), @Middle_Name varchar(255), @Pay_Record varchar(255), @Effective_Date varchar(255), @Current_Pay_Rate varchar(255), @New_Pay_Rate varchar(255), @Reason_for_Change varchar(255), @Division_Code varchar(255), @Department varchar(255), @Job_Title varchar(255), @Location_ID varchar(255), @Start_Date varchar(255), @Ben_Adj_Date varchar(255), @Primary_Pay_Record varchar(255), @Union_Code varchar(255), @Seniority_Date varchar(255), @Pay_Step_Table_ID varchar(255), @Pay_Step_Table_Description varchar(255), @Base_Step_Increases_On varchar(255), @Step_Effective_Date varchar(255), @Pay_Step varchar(255), @Unit_of_Pay varchar(255) select @I_iDictID = 414 select @I_iMessageNumber = 26600 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Employee_ID output  select @I_iDictID = 414 select @I_iMessageNumber = 26601 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @First_Name output select @I_iDictID = 414 select @I_iMessageNumber = 26602 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Name output  select @I_iDictID = 414 select @I_iMessageNumber = 26667 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Middle_Name output  select @I_iDictID = 414 select @I_iMessageNumber = 22669 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Pay_Record output  select @I_iDictID = 414 select @I_iMessageNumber = 22102 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Effective_Date output  select @I_iDictID = 414 select @I_iMessageNumber = 26745 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Current_Pay_Rate output  select @I_iDictID = 414 select @I_iMessageNumber = 26746 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @New_Pay_Rate output  select @I_iDictID = 414 select @I_iMessageNumber = 26747 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reason_for_Change output  select @I_iDictID = 414 select @I_iMessageNumber = 26674 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Division_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26675 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Department output  select @I_iDictID = 414 select @I_iMessageNumber = 26676 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Job_Title output  select @I_iDictID = 414 select @I_iMessageNumber = 26678 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Location_ID output  select @I_iDictID = 414 select @I_iMessageNumber = 26682 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Start_Date output  select @I_iDictID = 414 select @I_iMessageNumber = 26704 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ben_Adj_Date output  select @I_iDictID = 414 select @I_iMessageNumber = 26725 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Primary_Pay_Record output  select @I_iDictID = 414 select @I_iMessageNumber = 26791 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Union_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26748 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Seniority_Date output  select @I_iDictID = 414 select @I_iMessageNumber = 26749 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Pay_Step_Table_ID output  select @I_iDictID = 414 select @I_iMessageNumber = 26395 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Pay_Step_Table_Description output  select @I_iDictID = 414 select @I_iMessageNumber = 26396 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Base_Step_Increases_On output  select @I_iDictID = 414 select @I_iMessageNumber = 26397 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Step_Effective_Date output  select @I_iDictID = 414 select @I_iMessageNumber = 26398 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Pay_Step output  select @I_iDictID = 414 select @I_iMessageNumber = 26399 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Unit_of_Pay output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[PostDatedPayRates]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[PostDatedPayRates] '  select @sqldefaultstring =   'CREATE VIEW PostDatedPayRates AS ' +   'select ' +   'rtrim([''Payroll Post Dated Pay Code Master''].[EMPLOYID]) as ''' + @Employee_ID + ''', ' + 'rtrim([''Payroll Master''].[FRSTNAME]) as ''' + @First_Name + ''', ' + 'rtrim([''Payroll Master''].[LASTNAME]) as ''' + @Last_Name + ''', ' + 'rtrim([''Payroll Master''].[MIDLNAME]) as ''' + @Middle_Name + ''', ' + 'rtrim([''Payroll Pay Code Master''].[PAYRCORD]) as ''' + @Pay_Record + ''', ' + '[''Payroll Post Dated Pay Code Master''].[Effective_Date] as ''' + @Effective_Date + ''', ' + '[''Payroll Pay Code Master''].[PAYRTAMT] as ''' + @Current_Pay_Rate + ''', ' + '[''Payroll Post Dated Pay Code Master''].[PAYRTAMT] as ''' + @New_Pay_Rate + ''', ' + 'rtrim([''Payroll Post Dated Pay Code Master''].[CHANGEREASON_I]) as ''' + @Reason_for_Change + ''', '   select @sqlstring1 =   '''' + @Base_Step_Increases_On + ''' = dbo.HR_FUNC_Base_Step_Increases_On([''Payroll Pay Code Master''].[Base_Step_Increased_On]), ' +  '[''Payroll Master''].[BENADJDATE] as ''' + @Ben_Adj_Date + ''', ' +  'rtrim([''Payroll Master''].[DEPRTMNT]) as ''' + @Department + ''', ' +  'rtrim([''Payroll Master''].[DIVISIONCODE_I]) as ''' + @Division_Code + ''', ' +  'rtrim([''Payroll Master''].[JOBTITLE]) as ''' + @Job_Title + ''', ' +  'rtrim([''Payroll Master''].[LOCATNID]) as ''' + @Location_ID + ''', ' +  'rtrim([''Pay Step Table Header''].[Pay_Step_Table_Desc]) as ''' + @Pay_Step_Table_Description + ''', ' +  'rtrim([''Payroll Post Dated Pay Code Master''].[PYSTPTBLID]) as ''' + @Pay_Step_Table_ID + ''', ' +  'rtrim([''Payroll Master''].[Primary_Pay_Record]) as ''' + @Primary_Pay_Record + ''', ' +  '[''HR_Union''].[SENIORITYDATE_I] as ''' + @Seniority_Date + ''', ' +  '[''Payroll Master''].[STRTDATE] as ''' + @Start_Date + ''', ' +  '[''Payroll Pay Code Master''].[Step_Effective_Date] as ''' + @Step_Effective_Date + ''', ' +  'rtrim([''HR_Union''].[UNIONNAME_I]) as ''' + @Union_Code + ''', ' +  '''' + @Unit_of_Pay + ''' = dbo.HR_FUNC_Unit_of_Pay([''Pay Step Table Header''].[Pay_Step_Unit_Of_Pay]) '   select @sqljoinstring =   'from [UPR00402] as [''Payroll Post Dated Pay Code Master''] with (NOLOCK) '   + 'left outer join [UPR00100] as [''Payroll Master''] with (NOLOCK) on '   + '[''Payroll Post Dated Pay Code Master''].[EMPLOYID] = [''Payroll Master''].[EMPLOYID] '   + 'left outer join [UPR00400] as [''Payroll Pay Code Master''] with (NOLOCK) on '   + '[''Payroll Post Dated Pay Code Master''].[EMPLOYID] = [''Payroll Pay Code Master''].[EMPLOYID] '   + ' and [''Payroll Post Dated Pay Code Master''].[PAYRCORD] = [''Payroll Pay Code Master''].[PAYRCORD] '   + 'left outer join [HR2UNI01] as [''HR_Union''] with (NOLOCK) on '   + '[''Payroll Post Dated Pay Code Master''].[EMPLOYID] = [''HR_Union''].[EMPID_I] '   + 'left outer join [HRPS0400] as [''Pay Step Table Header''] with (NOLOCK) on '   + '[''Payroll Post Dated Pay Code Master''].[PYSTPTBLID] = [''Pay Step Table Header''].[PYSTPTBLID] '   select @sqlaccessstring =   'GRANT SELECT ON [dbo].[PostDatedPayRates] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[PostDatedPayRates] TO [rpt_human resource administrator]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_HumanResources_PostDatedPayRates] TO [DYNGRP]
GO
