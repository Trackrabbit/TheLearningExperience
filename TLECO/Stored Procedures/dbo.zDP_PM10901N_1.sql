SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_PM10901N_1] (@BS int, @USERID char(15), @TIME1 datetime, @VENDORID char(15), @DOCTYPE smallint, @VCHRNMBR char(21), @DEYDESCR char(31), @USERID_RS char(15), @TIME1_RS datetime, @VENDORID_RS char(15), @DOCTYPE_RS smallint, @VCHRNMBR_RS char(21), @DEYDESCR_RS char(31), @USERID_RE char(15), @TIME1_RE datetime, @VENDORID_RE char(15), @DOCTYPE_RE smallint, @VCHRNMBR_RE char(21), @DEYDESCR_RE char(31)) AS  set nocount on IF @USERID_RS IS NULL BEGIN SELECT TOP 25  USERID, TIME1, VENDORID, DOCTYPE, VCHRNMBR, PMVDMSGS, DOCDATE, DOCNUMBR, DOCAMNT, CURTRXAM, DISTKNAM, DISCAMNT, DISCDATE, TRXSORCE, TEN99AMNT, WROFAMNT, DISAMTAV, PRCHAMNT, TRDISAMT, MSCCHAMT, FRTAMNT, TAXAMNT, TTLPYMTS, CHEKBKID, PSTGDATE, CURNCYID, DEYDESCR, VOIDDATE, VADCDTRO, DEX_ROW_ID FROM .PM10901 WHERE ( USERID = @USERID AND TIME1 = @TIME1 AND VENDORID = @VENDORID AND DOCTYPE = @DOCTYPE AND VCHRNMBR = @VCHRNMBR AND DEYDESCR > @DEYDESCR OR USERID = @USERID AND TIME1 = @TIME1 AND VENDORID = @VENDORID AND DOCTYPE = @DOCTYPE AND VCHRNMBR > @VCHRNMBR OR USERID = @USERID AND TIME1 = @TIME1 AND VENDORID = @VENDORID AND DOCTYPE > @DOCTYPE OR USERID = @USERID AND TIME1 = @TIME1 AND VENDORID > @VENDORID OR USERID = @USERID AND TIME1 > @TIME1 OR USERID > @USERID ) ORDER BY USERID ASC, TIME1 ASC, VENDORID ASC, DOCTYPE ASC, VCHRNMBR ASC, DEYDESCR ASC END ELSE IF @USERID_RS = @USERID_RE BEGIN SELECT TOP 25  USERID, TIME1, VENDORID, DOCTYPE, VCHRNMBR, PMVDMSGS, DOCDATE, DOCNUMBR, DOCAMNT, CURTRXAM, DISTKNAM, DISCAMNT, DISCDATE, TRXSORCE, TEN99AMNT, WROFAMNT, DISAMTAV, PRCHAMNT, TRDISAMT, MSCCHAMT, FRTAMNT, TAXAMNT, TTLPYMTS, CHEKBKID, PSTGDATE, CURNCYID, DEYDESCR, VOIDDATE, VADCDTRO, DEX_ROW_ID FROM .PM10901 WHERE USERID = @USERID_RS AND TIME1 BETWEEN @TIME1_RS AND @TIME1_RE AND VENDORID BETWEEN @VENDORID_RS AND @VENDORID_RE AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND VCHRNMBR BETWEEN @VCHRNMBR_RS AND @VCHRNMBR_RE AND DEYDESCR BETWEEN @DEYDESCR_RS AND @DEYDESCR_RE AND ( USERID = @USERID AND TIME1 = @TIME1 AND VENDORID = @VENDORID AND DOCTYPE = @DOCTYPE AND VCHRNMBR = @VCHRNMBR AND DEYDESCR > @DEYDESCR OR USERID = @USERID AND TIME1 = @TIME1 AND VENDORID = @VENDORID AND DOCTYPE = @DOCTYPE AND VCHRNMBR > @VCHRNMBR OR USERID = @USERID AND TIME1 = @TIME1 AND VENDORID = @VENDORID AND DOCTYPE > @DOCTYPE OR USERID = @USERID AND TIME1 = @TIME1 AND VENDORID > @VENDORID OR USERID = @USERID AND TIME1 > @TIME1 OR USERID > @USERID ) ORDER BY USERID ASC, TIME1 ASC, VENDORID ASC, DOCTYPE ASC, VCHRNMBR ASC, DEYDESCR ASC END ELSE BEGIN SELECT TOP 25  USERID, TIME1, VENDORID, DOCTYPE, VCHRNMBR, PMVDMSGS, DOCDATE, DOCNUMBR, DOCAMNT, CURTRXAM, DISTKNAM, DISCAMNT, DISCDATE, TRXSORCE, TEN99AMNT, WROFAMNT, DISAMTAV, PRCHAMNT, TRDISAMT, MSCCHAMT, FRTAMNT, TAXAMNT, TTLPYMTS, CHEKBKID, PSTGDATE, CURNCYID, DEYDESCR, VOIDDATE, VADCDTRO, DEX_ROW_ID FROM .PM10901 WHERE USERID BETWEEN @USERID_RS AND @USERID_RE AND TIME1 BETWEEN @TIME1_RS AND @TIME1_RE AND VENDORID BETWEEN @VENDORID_RS AND @VENDORID_RE AND DOCTYPE BETWEEN @DOCTYPE_RS AND @DOCTYPE_RE AND VCHRNMBR BETWEEN @VCHRNMBR_RS AND @VCHRNMBR_RE AND DEYDESCR BETWEEN @DEYDESCR_RS AND @DEYDESCR_RE AND ( USERID = @USERID AND TIME1 = @TIME1 AND VENDORID = @VENDORID AND DOCTYPE = @DOCTYPE AND VCHRNMBR = @VCHRNMBR AND DEYDESCR > @DEYDESCR OR USERID = @USERID AND TIME1 = @TIME1 AND VENDORID = @VENDORID AND DOCTYPE = @DOCTYPE AND VCHRNMBR > @VCHRNMBR OR USERID = @USERID AND TIME1 = @TIME1 AND VENDORID = @VENDORID AND DOCTYPE > @DOCTYPE OR USERID = @USERID AND TIME1 = @TIME1 AND VENDORID > @VENDORID OR USERID = @USERID AND TIME1 > @TIME1 OR USERID > @USERID ) ORDER BY USERID ASC, TIME1 ASC, VENDORID ASC, DOCTYPE ASC, VCHRNMBR ASC, DEYDESCR ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_PM10901N_1] TO [DYNGRP]
GO
