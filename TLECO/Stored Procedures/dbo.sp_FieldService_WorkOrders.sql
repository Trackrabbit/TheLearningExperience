SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_FieldService_WorkOrders] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @Work_Order_Record_Type varchar(255), @Work_Order_Number varchar(255), @Work_Order_Status varchar(255), @Work_Order_Type varchar(255), @SVC_Depot_Priority varchar(255), @Parent_Work_Order_Record_Type varchar(255), @Parent_Work_Order_Number varchar(255), @Origin varchar(255), @Reference varchar(255), @TimeZone varchar(255), @Entry_Date varchar(255), @Entry_Time varchar(255), @ETA_Date varchar(255), @ETA_Time varchar(255), @EComp_Date varchar(255), @EComp_Time varchar(255), @Return_Date varchar(255), @Return_Time varchar(255), @Complete_Date varchar(255), @Complete_Time varchar(255), @Bin varchar(255), @User_ID varchar(255), @Office_ID varchar(255), @Customer_ID varchar(255), @Address_Code varchar(255), @Address_1 varchar(255), @Address_2 varchar(255), @City varchar(255), @State varchar(255), @Zip_Code varchar(255), @Return_Document_ID varchar(255), @Line_SEQ_Number varchar(255), @Service_Record_Type varchar(255), @Service_Call_Number varchar(255), @Service_Line_Item_Sequence varchar(255), @Inbound_Item_Number varchar(255), @Inbound_Serial_Number varchar(255), @Inbound_Equipment_ID varchar(255), @Outbound_Item_Number varchar(255), @Outbound_Serial_Number varchar(255), @Outbound_Equipment_ID varchar(255), @QTY varchar(255), @Depot_Station_ID varchar(255), @Route_ID varchar(255), @Sequence varchar(255), @Location_Code varchar(255), @Inbound_Analysis_Code varchar(255), @Outbound_Analysis_Code varchar(255), @Customer_Owned varchar(255), @Order_Document_ID varchar(255), @Transfer_Line_Item_Sequence varchar(255), @Note_Index varchar(255), @Factory_Sealed varchar(255), @Labor_Sub_Total_Cost varchar(255), @Part_Sub_Total_Cost varchar(255), @Total_Labor_Hours varchar(255), @Price_Level varchar(255), @Number_of_Reschedules varchar(255), @Commit_Date varchar(255), @Commit_Time varchar(255), @User_Defined_1 varchar(255), @User_Defined_2 varchar(255), @User_Defined_3 varchar(255), @User_Defined_4 varchar(255), @User_Defined_5 varchar(255), @Address_3 varchar(255), @Country varchar(255), @SVC_RMA_Reason_Code varchar(255), @SVC_RMA_Reason_Code_Desc varchar(255), @SVC_Process_SEQ_Number varchar(255), @ varchar(255),  @DrillBack_Base_Url varchar(255), @DrillBack_Base_Url_For_FS varchar(255), @Service_Call_Number_For_DrillBack varchar(255), @Customer_ID_For_DrillBack varchar(255), @Work_Order_Number_For_DrillBack varchar(255)  select @DrillBack_Base_Url = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),0) select @DrillBack_Base_Url_For_FS = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),949)  select @I_iDictID = 949 select @I_iMessageNumber = 27200 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Work_Order_Record_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 27201 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Work_Order_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27202 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Work_Order_Status output  select @I_iDictID = 949 select @I_iMessageNumber = 27203 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Work_Order_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 27204 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Depot_Priority output  select @I_iDictID = 949 select @I_iMessageNumber = 27205 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Parent_Work_Order_Record_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 27206 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Parent_Work_Order_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27207 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Origin output  select @I_iDictID = 949 select @I_iMessageNumber = 27208 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reference output  select @I_iDictID = 949 select @I_iMessageNumber = 27209 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TimeZone output  select @I_iDictID = 949 select @I_iMessageNumber = 27210 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Entry_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 27211 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Entry_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 27212 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ETA_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 27213 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ETA_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 27214 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @EComp_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 27215 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @EComp_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 27216 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 27217 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 27218 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Complete_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 27219 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Complete_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 27220 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Bin output  select @I_iDictID = 949 select @I_iMessageNumber = 27221 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27222 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Office_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27223 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27224 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27225 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 27226 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 27227 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @City output  select @I_iDictID = 949 select @I_iMessageNumber = 27228 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @State output  select @I_iDictID = 949 select @I_iMessageNumber = 27229 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Zip_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27230 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Document_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27231 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Line_SEQ_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27232 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Record_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 27233 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Call_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27234 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Line_Item_Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 27235 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inbound_Item_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27236 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inbound_Serial_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27237 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inbound_Equipment_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27238 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Outbound_Item_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27239 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Outbound_Serial_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27240 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Outbound_Equipment_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27241 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY output  select @I_iDictID = 949 select @I_iMessageNumber = 27242 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Depot_Station_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27243 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Route_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27244 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 27245 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Location_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27246 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inbound_Analysis_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27247 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Outbound_Analysis_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27248 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_Owned output  select @I_iDictID = 949 select @I_iMessageNumber = 27249 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Order_Document_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27250 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Transfer_Line_Item_Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 27251 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Note_Index output  select @I_iDictID = 949 select @I_iMessageNumber = 27252 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Factory_Sealed output  select @I_iDictID = 949 select @I_iMessageNumber = 27253 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Labor_Sub_Total_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27254 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Part_Sub_Total_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27255 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Total_Labor_Hours output  select @I_iDictID = 949 select @I_iMessageNumber = 27256 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Price_Level output  select @I_iDictID = 949 select @I_iMessageNumber = 27257 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Number_of_Reschedules output  select @I_iDictID = 949 select @I_iMessageNumber = 27258 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Commit_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 27259 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Commit_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 27260 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 27261 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 27262 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_3 output  select @I_iDictID = 949 select @I_iMessageNumber = 27263 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_4 output  select @I_iDictID = 949 select @I_iMessageNumber = 27264 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_5 output  select @I_iDictID = 949 select @I_iMessageNumber = 27265 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_3 output  select @I_iDictID = 949 select @I_iMessageNumber = 27266 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Country output  select @I_iDictID = 949 select @I_iMessageNumber = 27267 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_RMA_Reason_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27268 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_RMA_Reason_Code_Desc output  select @I_iDictID = 949 select @I_iMessageNumber = 27269 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Process_SEQ_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27380 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ output   select @I_iDictID = 949 select @I_iMessageNumber = 27233 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Call_Number_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 27223 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_ID_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 27201 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Work_Order_Number_For_DrillBack output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[WorkOrders]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[WorkOrders] '  select @sqldefaultstring =   'CREATE VIEW WorkOrders AS ' +   'select ' +   '''' + @Work_Order_Record_Type + ''' = dbo.FS_FUNC_Work_Order_Record_Type([''Depot Master''].[WORECTYPE]), ' + 'rtrim([''Depot Master''].[WORKORDNUM]) as ''' + @Work_Order_Number + ''', ' + 'rtrim([''Depot Master''].[WOTYPE]) as ''' + @Work_Order_Type + ''', ' + '[''Depot Master''].[SVC_Depot_Priority] as ''' + @SVC_Depot_Priority + ''', ' + '[''Depot Master''].[ENTDTE] as ''' + @Entry_Date + ''', ' + '[''Depot Master''].[ECOMPDT] as ''' + @EComp_Date + ''', ' + '[''Depot Master''].[EComp_Time] as ''' + @EComp_Time + ''', ' + '[''Depot Master''].[RETUDATE] as ''' + @Return_Date + ''', ' + '[''Depot Master''].[COMPDTE] as ''' + @Complete_Date + ''', ' + 'rtrim([''Depot Master''].[OFFID]) as ''' + @Office_ID + ''', ' + 'rtrim([''RM Customer MSTR''].[CUSTNMBR]) as ''' + @Customer_ID + ''', ' + 'rtrim([''Depot Master''].[ADRSCODE]) as ''' + @Address_Code + ''', ' + 'rtrim([''Depot Master''].[IBITEMNUM]) as ''' + @Inbound_Item_Number + ''', ' + 'rtrim([''Depot Master''].[IBSERIAL]) as ''' + @Inbound_Serial_Number + ''', ' + '[''Depot Master''].[IBEQUIPID] as ''' + @Inbound_Equipment_ID + ''', ' + '[''Depot Master''].[QUANTITY] as ''' + @QTY + ''', ' + 'rtrim([''Depot Master''].[STATIONID]) as ''' + @Depot_Station_ID + ''', ' + 'rtrim([''Depot Master''].[LOCNCODE]) as ''' + @Location_Code + ''', ' + '[''Depot Master''].[LABSTOTCST] as ''' + @Labor_Sub_Total_Cost + ''', ' + '[''Depot Master''].[PARSTOTCST] as ''' + @Part_Sub_Total_Cost + ''', ' + '[''Depot Master''].[TOTLABHRS] as ''' + @Total_Labor_Hours + ''', ' + '[''Depot Master''].[Commit_Date] as ''' + @Commit_Date + ''', '   select @sqlstring1 =   'rtrim([''Depot Master''].[ADDRESS1]) as ''' + @Address_1 + ''', ' +  'rtrim([''Depot Master''].[ADDRESS2]) as ''' + @Address_2 + ''', ' +  'rtrim([''Depot Master''].[ADDRESS3]) as ''' + @Address_3 + ''', ' +  'rtrim([''Depot Master''].[BIN]) as ''' + @Bin + ''', ' +  'rtrim([''Depot Master''].[CITY]) as ''' + @City + ''', ' +  '[''Depot Master''].[Commit_Time] as ''' + @Commit_Time + ''', ' +  '[''Depot Master''].[COMPTME] as ''' + @Complete_Time + ''', ' +  'rtrim([''Depot Master''].[COUNTRY]) as ''' + @Country + ''', ' +  '''' + @Customer_Owned + ''' = dbo.DYN_FUNC_Boolean_All([''Depot Master''].[CUSTOWN]), ' +  '[''Depot Master''].[ETADTE] as ''' + @ETA_Date + ''', ' +  '[''Depot Master''].[ETATME] as ''' + @ETA_Time + ''', ' +  '[''Depot Master''].[ENTTME] as ''' + @Entry_Time + ''', ' +  '''' + @Factory_Sealed + ''' = dbo.DYN_FUNC_Boolean_All([''Depot Master''].[FACTSEAL]), ' +  'rtrim([''Depot Master''].[IBANALCODE]) as ''' + @Inbound_Analysis_Code + ''', ' +  'rtrim([''Depot Master''].[LNSEQNBR]) as ''' + @Line_SEQ_Number + ''', ' +  '[''Depot Master''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  '[''Depot Master''].[NUMRESCHED] as ''' + @Number_of_Reschedules + ''', ' +  'rtrim([''Depot Master''].[ORDDOCID]) as ''' + @Order_Document_ID + ''', ' +  '''' + @Origin + ''' = dbo.FS_FUNC_Origin([''Depot Master''].[ORIGIN]), ' +  'rtrim([''Depot Master''].[OBANALCODE]) as ''' + @Outbound_Analysis_Code + ''', ' +  '[''Depot Master''].[OBEQUIPID] as ''' + @Outbound_Equipment_ID + ''', ' +  'rtrim([''Depot Master''].[OBITEMNUM]) as ''' + @Outbound_Item_Number + ''', ' +  'rtrim([''Depot Master''].[OBSERIAL]) as ''' + @Outbound_Serial_Number + ''', ' +  'rtrim([''Depot Master''].[PARWONUM]) as ''' + @Parent_Work_Order_Number + ''', ' +  '[''Depot Master''].[PARWORECTYPE] as ''' + @Parent_Work_Order_Record_Type + ''', ' +  'rtrim([''Depot Master''].[PRICELVL]) as ''' + @Price_Level + ''', ' +  'rtrim([''Depot Master''].[REFRENCE]) as ''' + @Reference + ''', ' +  'rtrim([''Depot Master''].[RETDOCID]) as ''' + @Return_Document_ID + ''', ' +  '[''Depot Master''].[Return_Time] as ''' + @Return_Time + ''', ' +  'rtrim([''Depot Master''].[ROUTEID]) as ''' + @Route_ID + ''', ' +  '[''Depot Master''].[SVC_Process_SEQ_Number] as ''' + @SVC_Process_SEQ_Number + ''', ' +  'rtrim([''Depot Master''].[SVC_RMA_Reason_Code]) as ''' + @SVC_RMA_Reason_Code + ''', ' +  'rtrim([''Depot Master''].[SVC_RMA_Reason_Code_Desc]) as ''' + @SVC_RMA_Reason_Code_Desc + ''', ' +  '[''Depot Master''].[SEQUENCE1] as ''' + @Sequence + ''', ' +  'rtrim([''Depot Master''].[CALLNBR]) as ''' + @Service_Call_Number + ''', ' +  '[''Depot Master''].[SERVLITEMSEQ] as ''' + @Service_Line_Item_Sequence + ''', ' +  '''' + @Service_Record_Type + ''' = dbo.FS_FUNC_Service_Record_Type([''Depot Master''].[SRVRECTYPE]), ' +  'rtrim([''Depot Master''].[STATE]) as ''' + @State + ''', ' +  'rtrim([''Depot Master''].[TIMEZONE]) as ''' + @TimeZone + ''', ' +  '[''Depot Master''].[TRANSLINESEQ] as ''' + @Transfer_Line_Item_Sequence + ''', ' +  'rtrim([''Depot Master''].[USERDEF1]) as ''' + @User_Defined_1 + ''', ' +  'rtrim([''Depot Master''].[USERDEF2]) as ''' + @User_Defined_2 + ''', ' +  'rtrim([''Depot Master''].[USRDEF03]) as ''' + @User_Defined_3 + ''', ' +  'rtrim([''Depot Master''].[USRDEF04]) as ''' + @User_Defined_4 + ''', ' +  'rtrim([''Depot Master''].[USRDEF05]) as ''' + @User_Defined_5 + ''', ' +  'rtrim([''Depot Master''].[USERID]) as ''' + @User_ID + ''', ' +  'rtrim([''Depot Master''].[WOSTAT]) as ''' + @Work_Order_Status + ''', ' +  'rtrim([''Depot Master''].[ZIPCODE]) as ''' + @Zip_Code + ''', '   select @sqlstring2 =  '''' + @Customer_ID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppCustomerID(1,[''RM Customer MSTR''].[CUSTNMBR] ), '+ '''' + @Service_Call_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url_For_FS + ''' +dbo.dgppServiceRecordType(1,[''Depot Master''].[CALLNBR],[''Depot Master''].[SRVRECTYPE] ), '+ '''' + @Work_Order_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url_For_FS + ''' +dbo.dgppWorkOrderNumber(1,[''Depot Master''].[WORKORDNUM],[''Depot Master''].[WORECTYPE] ) '  select @sqljoinstring =   'from [SVC06100] as [''Depot Master''] with (NOLOCK) '   + 'left outer join [RM00101] as [''RM Customer MSTR''] with (NOLOCK) on '   + '[''Depot Master''].[CUSTNMBR] = [''RM Customer MSTR''].[CUSTNMBR] '   select @sqlaccessstring =   'GRANT SELECT ON [dbo].[WorkOrders] TO [rpt_dispatcher]' + 'GRANT SELECT ON [dbo].[WorkOrders] TO [rpt_customer service rep]' + 'GRANT SELECT ON [dbo].[WorkOrders] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[WorkOrders] TO [rpt_project manager]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_FieldService_WorkOrders] TO [DYNGRP]
GO
