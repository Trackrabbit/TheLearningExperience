SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 Create  procedure [dbo].[aagGetCustVendID] @iSeries INT, @iDocType INT, @iDocNum VARCHAR(30), @icSource CHAR(30),  @oCustVendID VARCHAR(30) OUT As  Begin  If @iSeries =3   Begin  If @icSource <> '' and upper(@icSource) <> 'NSF'   Select @oCustVendID =CUSTNMBR from RM20101 Where RMDTYPAL =@iDocType and DOCNUMBR =@iDocNum   Else If @iDocType = 9   Select @oCustVendID =CUSTNMBR from RM10201 Where RMDTYPAL =@iDocType and DOCNUMBR =@iDocNum   Else If exists(Select CUSTNMBR from RM10301 Where RMDTYPAL =@iDocType and DOCNUMBR =@iDocNum)  Select @oCustVendID =CUSTNMBR from RM10301 Where RMDTYPAL =@iDocType and DOCNUMBR =@iDocNum   Else If exists(Select CUSTNMBR from RM20101 Where RMDTYPAL =@iDocType and DOCNUMBR =@iDocNum)  Select @oCustVendID =CUSTNMBR from RM20101 Where RMDTYPAL =@iDocType and DOCNUMBR =@iDocNum   Else If exists(Select CUSTNMBR from RM30101 Where RMDTYPAL =@iDocType and DOCNUMBR =@iDocNum)  Select @oCustVendID =CUSTNMBR from RM30101 Where RMDTYPAL =@iDocType and DOCNUMBR =@iDocNum  End  Else If @iSeries =11   Select @oCustVendID =CUSTNMBR from SOP10100 Where SOPTYPE =@iDocType and SOPNUMBE =@iDocNum  Else If @iSeries =4   Begin  If @iDocType = 0 or @icSource <>''   If exists(Select VENDORID from PM10000 Where VCHNUMWK =@iDocNum)  Select @oCustVendID =VENDORID from PM10000 Where VCHNUMWK =@iDocNum  Else If exists(Select VENDORID from PM20000 Where VCHRNMBR =@iDocNum)  Select @oCustVendID =VENDORID from PM20000 Where VCHRNMBR =@iDocNum  Else   Select @oCustVendID = ''  Else   If exists(Select VENDORID from PM10400 Where PMNTNMBR =@iDocNum)  Select @oCustVendID =VENDORID from PM10400 Where PMNTNMBR =@iDocNum  Else If exists(Select VENDORID from PM10300 Where PMNTNMBR =@iDocNum)  Select @oCustVendID =VENDORID from PM10300 Where PMNTNMBR =@iDocNum  Else  Select @oCustVendID = ''  End  Else If @iSeries =12   Select @oCustVendID =VENDORID from POP10300 Where POPTYPE =@iDocType and POPRCTNM =@iDocNum End    
GO
GRANT EXECUTE ON  [dbo].[aagGetCustVendID] TO [DYNGRP]
GO
