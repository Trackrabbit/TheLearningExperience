SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[eConnectOut]  @I_vDOCTYPE varchar(50),   @I_vOUTPUTTYPE int = 0,   @I_vINDEX1TO varchar(75)='',   @I_vINDEX2TO varchar(75)='',   @I_vINDEX3TO varchar(75)='',   @I_vINDEX4TO varchar(75)='',   @I_vINDEX5TO varchar(75)='',   @I_vINDEX6TO varchar(75)='',  @I_vINDEX7TO varchar(75)='',   @I_vINDEX8TO varchar(75)='',   @I_vINDEX9TO varchar(75)='',   @I_vINDEX10TO varchar(75)='',   @I_vINDEX11TO varchar(75)='',   @I_vINDEX12TO varchar(75)='',  @I_vINDEX13TO varchar(75)='',   @I_vINDEX14TO varchar(75)='',   @I_vINDEX15TO varchar(75)='',   @I_vINDEX1FROM varchar(75)='',   @I_vINDEX2FROM varchar(75)='',   @I_vINDEX3FROM varchar(75)='',   @I_vINDEX4FROM varchar(75)='',   @I_vINDEX5FROM varchar(75)='',   @I_vINDEX6FROM varchar(75)='',   @I_vINDEX7FROM varchar(75)='',   @I_vINDEX8FROM varchar(75)='',   @I_vINDEX9FROM varchar(75)='',   @I_vINDEX10FROM varchar(75)='',  @I_vINDEX11FROM varchar(75)='',  @I_vINDEX12FROM varchar(75)='',  @I_vINDEX13FROM varchar(75)='',  @I_vINDEX14FROM varchar(75)='',  @I_vINDEX15FROM varchar(75)='',  @I_vFORLOAD int=0,   @I_vFORLIST int=0,         @I_vACTION  int=0,   @I_vROWCOUNT int=0,   @I_vREMOVE int=0,   @I_vDATE1 datetime = '',  @I_vWhereClause varchar(1000)='',  @O_iErrorState int = NULL  output  with encryption as  set transaction isolation level read uncommitted  SET NOCOUNT ON  declare @proc char(50),  @actionbegin int,  @actionend int  select @O_iErrorState = 1,  @proc = '',  @actionbegin = 0,  @actionend = 0  if not exists(select 1 from eConnect_Out_Setup a (nolock) where a.DOCTYPE = @I_vDOCTYPE and MAIN = 1) begin  return end  if ((@I_vOUTPUTTYPE<0) or (@I_vOUTPUTTYPE>3)) begin  select @O_iErrorState = 1  return end  if (@I_vACTION = 0) begin  select @actionend = 4 end else if (@I_vACTION = 4) or (@I_vACTION = 5) begin  select @actionbegin=1, @actionend=2   end else begin  select @actionbegin=@I_vACTION, @actionend=@I_vACTION end  if (@I_vOUTPUTTYPE = 3)  begin  if (@I_vREMOVE = 1)  begin  if (@I_vDATE1 != '')  delete a from eConnect_Out a (updlock)  where a.DOCTYPE = @I_vDOCTYPE and  a.INDEX1 between @I_vINDEX1TO and @I_vINDEX1FROM and  a.INDEX2 between @I_vINDEX2TO and @I_vINDEX2FROM and  a.INDEX3 between @I_vINDEX3TO and @I_vINDEX3FROM and  a.INDEX4 between @I_vINDEX4TO and @I_vINDEX4FROM and  a.INDEX5 between @I_vINDEX5TO and @I_vINDEX5FROM and  a.INDEX6 between @I_vINDEX6TO and @I_vINDEX6FROM and  a.INDEX7 between @I_vINDEX7TO and @I_vINDEX7FROM and  a.INDEX8 between @I_vINDEX8TO and @I_vINDEX8FROM and  a.INDEX9 between @I_vINDEX9TO and @I_vINDEX9FROM and  a.INDEX10 between @I_vINDEX10TO and @I_vINDEX10FROM and  a.INDEX11 between @I_vINDEX11TO and @I_vINDEX11FROM and  a.INDEX12 between @I_vINDEX12TO and @I_vINDEX12FROM and  a.INDEX13 between @I_vINDEX13TO and @I_vINDEX13FROM and  a.INDEX14 between @I_vINDEX14TO and @I_vINDEX14FROM and  a.INDEX15 between @I_vINDEX15TO and @I_vINDEX15FROM and  a.ACTION between @actionbegin and @actionend and  a.DATE1 <= @I_vDATE1  else  begin  delete a from eConnect_Out a (updlock)  where a.DOCTYPE = @I_vDOCTYPE and  a.INDEX1 between @I_vINDEX1TO and @I_vINDEX1FROM and  a.INDEX2 between @I_vINDEX2TO and @I_vINDEX2FROM and  a.INDEX3 between @I_vINDEX3TO and @I_vINDEX3FROM and  a.INDEX4 between @I_vINDEX4TO and @I_vINDEX4FROM and  a.INDEX5 between @I_vINDEX5TO and @I_vINDEX5FROM and  a.INDEX6 between @I_vINDEX6TO and @I_vINDEX6FROM and  a.INDEX7 between @I_vINDEX7TO and @I_vINDEX7FROM and  a.INDEX8 between @I_vINDEX8TO and @I_vINDEX8FROM and  a.INDEX9 between @I_vINDEX9TO and @I_vINDEX9FROM and  a.INDEX10 between @I_vINDEX10TO and @I_vINDEX10FROM and  a.INDEX11 between @I_vINDEX11TO and @I_vINDEX11FROM and  a.INDEX12 between @I_vINDEX12TO and @I_vINDEX12FROM and  a.INDEX13 between @I_vINDEX13TO and @I_vINDEX13FROM and  a.INDEX14 between @I_vINDEX14TO and @I_vINDEX14FROM and  a.INDEX15 between @I_vINDEX15TO and @I_vINDEX15FROM and  a.ACTION between @actionbegin and @actionend  end  end  select @O_iErrorState = 0  return end  set @proc = 'dbo.taRequester' + rtrim(@I_vDOCTYPE) + ltrim(str(@I_vOUTPUTTYPE))  if exists (select 1 from dbo.sysobjects (nolock) where id = Object_id(rtrim(@proc)) and type = 'P') begin  exec @proc     @I_vDOCTYPE,  @I_vOUTPUTTYPE,  @I_vINDEX1TO,  @I_vINDEX2TO,  @I_vINDEX3TO,  @I_vINDEX4TO,  @I_vINDEX5TO,  @I_vINDEX6TO,  @I_vINDEX7TO,  @I_vINDEX8TO,  @I_vINDEX9TO,  @I_vINDEX10TO,  @I_vINDEX11TO,  @I_vINDEX12TO,  @I_vINDEX13TO,  @I_vINDEX14TO,  @I_vINDEX15TO,  @I_vINDEX1FROM,  @I_vINDEX2FROM,  @I_vINDEX3FROM,  @I_vINDEX4FROM,  @I_vINDEX5FROM,  @I_vINDEX6FROM,  @I_vINDEX7FROM,  @I_vINDEX8FROM,  @I_vINDEX9FROM,  @I_vINDEX10FROM,  @I_vINDEX11FROM,  @I_vINDEX12FROM,  @I_vINDEX13FROM,  @I_vINDEX14FROM,  @I_vINDEX15FROM,  @I_vFORLOAD,  @I_vFORLIST,  @I_vACTION,  @I_vROWCOUNT,  @I_vREMOVE,  @I_vWhereClause end else begin  exec eConnectOutCreateProc  @I_vDOCTYPE,  @I_vOUTPUTTYPE,  @I_vINDEX1TO,  @I_vINDEX2TO,  @I_vINDEX3TO,  @I_vINDEX4TO,  @I_vINDEX5TO,  @I_vINDEX6TO,  @I_vINDEX7TO,  @I_vINDEX8TO,  @I_vINDEX9TO,  @I_vINDEX10TO,  @I_vINDEX11TO,  @I_vINDEX12TO,  @I_vINDEX13TO,  @I_vINDEX14TO,  @I_vINDEX15TO,  @I_vINDEX1FROM,  @I_vINDEX2FROM,  @I_vINDEX3FROM,  @I_vINDEX4FROM,  @I_vINDEX5FROM,  @I_vINDEX6FROM,  @I_vINDEX7FROM,  @I_vINDEX8FROM,  @I_vINDEX9FROM,  @I_vINDEX10FROM,  @I_vINDEX11FROM,  @I_vINDEX12FROM,  @I_vINDEX13FROM,  @I_vINDEX14FROM,  @I_vINDEX15FROM,  @I_vFORLOAD,  @I_vFORLIST,  @I_vACTION,  @I_vROWCOUNT,  @I_vREMOVE,  @O_iErrorState  output   exec ('GRANT  EXECUTE  ON ' + @proc + ' TO DYNGRP')  exec @proc     @I_vDOCTYPE,  @I_vOUTPUTTYPE,  @I_vINDEX1TO,  @I_vINDEX2TO,  @I_vINDEX3TO,  @I_vINDEX4TO,  @I_vINDEX5TO,  @I_vINDEX6TO,  @I_vINDEX7TO,  @I_vINDEX8TO,  @I_vINDEX9TO,  @I_vINDEX10TO,  @I_vINDEX11TO,  @I_vINDEX12TO,  @I_vINDEX13TO,  @I_vINDEX14TO,  @I_vINDEX15TO,  @I_vINDEX1FROM,  @I_vINDEX2FROM,  @I_vINDEX3FROM,  @I_vINDEX4FROM,  @I_vINDEX5FROM,  @I_vINDEX6FROM,  @I_vINDEX7FROM,  @I_vINDEX8FROM,  @I_vINDEX9FROM,  @I_vINDEX10FROM,  @I_vINDEX11FROM,  @I_vINDEX12FROM,  @I_vINDEX13FROM,  @I_vINDEX14FROM,  @I_vINDEX15FROM,  @I_vFORLOAD,  @I_vFORLIST,  @I_vACTION,  @I_vROWCOUNT,  @I_vREMOVE,  @I_vWhereClause end  select @O_iErrorState = 0 return    
GO
GRANT EXECUTE ON  [dbo].[eConnectOut] TO [DYNGRP]
GO
