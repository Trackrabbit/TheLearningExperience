SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SVC30203N_5] (@BS int, @TECHID char(11), @SRVRECTYPE smallint, @STRTDATE datetime, @STRTTIME datetime, @ENDDATE datetime, @ENDTME datetime, @LNITMSEQ int, @DEX_ROW_ID int, @TECHID_RS char(11), @SRVRECTYPE_RS smallint, @STRTDATE_RS datetime, @STRTTIME_RS datetime, @ENDDATE_RS datetime, @ENDTME_RS datetime, @LNITMSEQ_RS int, @TECHID_RE char(11), @SRVRECTYPE_RE smallint, @STRTDATE_RE datetime, @STRTTIME_RE datetime, @ENDDATE_RE datetime, @ENDTME_RE datetime, @LNITMSEQ_RE int) AS  set nocount on IF @TECHID_RS IS NULL BEGIN SELECT TOP 25  SRVRECTYPE, CALLNBR, EQPLINE, LNITMSEQ, LINITMTYP, SRVSTAT, TECHID, ITEMNMBR, ITEMUSETYPE, ITEMDESC, LOCNCODE, UOFM, QTYORDER, ATYALLOC, QTYBACKO, QTYSOLD, UNITCOST, UNITPRCE, EXTDCOST, XTNDPRCE, NOTEINDX, STRTDATE, STRTTIME, ENDDATE, ENDTME, TRANSTME, BILLABLTIM, TRNSFLOC, TRNSFQTY, TRNFLAG, ORDDOCID, TRANSLINESEQ, LABPCT, PARTPCT, MISCPCT, FUFILDAT, PONMBRSTR, POLNSEQ, On_Return, RETDOCID, LNSEQNBR, Miles_Start, Miles_End, Miles_Used, PRICELVL, SVC_Address_Option, SVC_Misc_Address_Code, SVC_Disable_XFR_Grouping, Work_Type, ORUNTCST, ORUNTPRC, OREXTCST, OXTNDPRC, TAXAMNT, ORTAXAMT, SVC_FO_ID, svcCreateVoucher, VCHRNMBR, CMPNTSEQ, CMPITQTY, DEX_ROW_ID FROM .SVC30203 WHERE ( TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME = @STRTTIME AND ENDDATE = @ENDDATE AND ENDTME = @ENDTME AND LNITMSEQ = @LNITMSEQ AND DEX_ROW_ID > @DEX_ROW_ID OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME = @STRTTIME AND ENDDATE = @ENDDATE AND ENDTME = @ENDTME AND LNITMSEQ > @LNITMSEQ OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME = @STRTTIME AND ENDDATE = @ENDDATE AND ENDTME > @ENDTME OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME = @STRTTIME AND ENDDATE > @ENDDATE OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME > @STRTTIME OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE > @STRTDATE OR TECHID = @TECHID AND SRVRECTYPE > @SRVRECTYPE OR TECHID > @TECHID ) ORDER BY TECHID ASC, SRVRECTYPE ASC, STRTDATE ASC, STRTTIME ASC, ENDDATE ASC, ENDTME ASC, LNITMSEQ ASC, DEX_ROW_ID ASC END ELSE IF @TECHID_RS = @TECHID_RE BEGIN SELECT TOP 25  SRVRECTYPE, CALLNBR, EQPLINE, LNITMSEQ, LINITMTYP, SRVSTAT, TECHID, ITEMNMBR, ITEMUSETYPE, ITEMDESC, LOCNCODE, UOFM, QTYORDER, ATYALLOC, QTYBACKO, QTYSOLD, UNITCOST, UNITPRCE, EXTDCOST, XTNDPRCE, NOTEINDX, STRTDATE, STRTTIME, ENDDATE, ENDTME, TRANSTME, BILLABLTIM, TRNSFLOC, TRNSFQTY, TRNFLAG, ORDDOCID, TRANSLINESEQ, LABPCT, PARTPCT, MISCPCT, FUFILDAT, PONMBRSTR, POLNSEQ, On_Return, RETDOCID, LNSEQNBR, Miles_Start, Miles_End, Miles_Used, PRICELVL, SVC_Address_Option, SVC_Misc_Address_Code, SVC_Disable_XFR_Grouping, Work_Type, ORUNTCST, ORUNTPRC, OREXTCST, OXTNDPRC, TAXAMNT, ORTAXAMT, SVC_FO_ID, svcCreateVoucher, VCHRNMBR, CMPNTSEQ, CMPITQTY, DEX_ROW_ID FROM .SVC30203 WHERE TECHID = @TECHID_RS AND SRVRECTYPE BETWEEN @SRVRECTYPE_RS AND @SRVRECTYPE_RE AND STRTDATE BETWEEN @STRTDATE_RS AND @STRTDATE_RE AND STRTTIME BETWEEN @STRTTIME_RS AND @STRTTIME_RE AND ENDDATE BETWEEN @ENDDATE_RS AND @ENDDATE_RE AND ENDTME BETWEEN @ENDTME_RS AND @ENDTME_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE AND ( TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME = @STRTTIME AND ENDDATE = @ENDDATE AND ENDTME = @ENDTME AND LNITMSEQ = @LNITMSEQ AND DEX_ROW_ID > @DEX_ROW_ID OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME = @STRTTIME AND ENDDATE = @ENDDATE AND ENDTME = @ENDTME AND LNITMSEQ > @LNITMSEQ OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME = @STRTTIME AND ENDDATE = @ENDDATE AND ENDTME > @ENDTME OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME = @STRTTIME AND ENDDATE > @ENDDATE OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME > @STRTTIME OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE > @STRTDATE OR TECHID = @TECHID AND SRVRECTYPE > @SRVRECTYPE OR TECHID > @TECHID ) ORDER BY TECHID ASC, SRVRECTYPE ASC, STRTDATE ASC, STRTTIME ASC, ENDDATE ASC, ENDTME ASC, LNITMSEQ ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  SRVRECTYPE, CALLNBR, EQPLINE, LNITMSEQ, LINITMTYP, SRVSTAT, TECHID, ITEMNMBR, ITEMUSETYPE, ITEMDESC, LOCNCODE, UOFM, QTYORDER, ATYALLOC, QTYBACKO, QTYSOLD, UNITCOST, UNITPRCE, EXTDCOST, XTNDPRCE, NOTEINDX, STRTDATE, STRTTIME, ENDDATE, ENDTME, TRANSTME, BILLABLTIM, TRNSFLOC, TRNSFQTY, TRNFLAG, ORDDOCID, TRANSLINESEQ, LABPCT, PARTPCT, MISCPCT, FUFILDAT, PONMBRSTR, POLNSEQ, On_Return, RETDOCID, LNSEQNBR, Miles_Start, Miles_End, Miles_Used, PRICELVL, SVC_Address_Option, SVC_Misc_Address_Code, SVC_Disable_XFR_Grouping, Work_Type, ORUNTCST, ORUNTPRC, OREXTCST, OXTNDPRC, TAXAMNT, ORTAXAMT, SVC_FO_ID, svcCreateVoucher, VCHRNMBR, CMPNTSEQ, CMPITQTY, DEX_ROW_ID FROM .SVC30203 WHERE TECHID BETWEEN @TECHID_RS AND @TECHID_RE AND SRVRECTYPE BETWEEN @SRVRECTYPE_RS AND @SRVRECTYPE_RE AND STRTDATE BETWEEN @STRTDATE_RS AND @STRTDATE_RE AND STRTTIME BETWEEN @STRTTIME_RS AND @STRTTIME_RE AND ENDDATE BETWEEN @ENDDATE_RS AND @ENDDATE_RE AND ENDTME BETWEEN @ENDTME_RS AND @ENDTME_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE AND ( TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME = @STRTTIME AND ENDDATE = @ENDDATE AND ENDTME = @ENDTME AND LNITMSEQ = @LNITMSEQ AND DEX_ROW_ID > @DEX_ROW_ID OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME = @STRTTIME AND ENDDATE = @ENDDATE AND ENDTME = @ENDTME AND LNITMSEQ > @LNITMSEQ OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME = @STRTTIME AND ENDDATE = @ENDDATE AND ENDTME > @ENDTME OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME = @STRTTIME AND ENDDATE > @ENDDATE OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE = @STRTDATE AND STRTTIME > @STRTTIME OR TECHID = @TECHID AND SRVRECTYPE = @SRVRECTYPE AND STRTDATE > @STRTDATE OR TECHID = @TECHID AND SRVRECTYPE > @SRVRECTYPE OR TECHID > @TECHID ) ORDER BY TECHID ASC, SRVRECTYPE ASC, STRTDATE ASC, STRTTIME ASC, ENDDATE ASC, ENDTME ASC, LNITMSEQ ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SVC30203N_5] TO [DYNGRP]
GO
