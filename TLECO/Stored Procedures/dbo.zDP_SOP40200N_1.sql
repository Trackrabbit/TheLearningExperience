SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SOP40200N_1] (@BS int, @SOPTYPE smallint, @DOCID char(15), @SOPTYPE_RS smallint, @DOCID_RS char(15), @SOPTYPE_RE smallint, @DOCID_RE char(15)) AS  set nocount on IF @SOPTYPE_RS IS NULL BEGIN SELECT TOP 25  DOCID, NOTEINDX, SOPTYPE, SETUPKEY, DOCTYABR, SOPNUMBE, COMMNTID, DOCUFORM, DAYTOEXP, ALLREPEA, ALLOCABY, USEPROSP, USNXTINV, USPFULPR, QUOTOINV, QUOTOORD, INVTOBAC, BACTOINV, BACTOORD, ORDTOBAC, ORDTOORD, USDOCID1, USDOCID2, QTYDEFAU, SOPALLOW_1, SOPALLOW_2, SOPALLOW_3, SOPALLOW_4, SOPALLOW_5, SOPALLOW_6, SOPALLOW_7, SOPALLOW_8, SOPALLOW_9, SOPALLOW_10, SOPPSSWD_1, SOPPSSWD_2, SOPPSSWD_3, SOPPSSWD_4, SOPPSSWD_5, SOPPSSWD_6, SOPPSSWD_7, SOPPSSWD_8, SOPPSSWD_9, SOPPSSWD_10, SOPSEQNC_1, SOPSEQNC_2, SOPSEQNC_3, SOPSEQNC_4, SOPSEQNC_5, SOPSEQNC_6, SOPSEQNC_7, SOPSEQNC_8, USER2ENT, CREATDDT, MODIFDT, SHPPGDOC, CORRCTN, SIMPLIFD, ALLBACKODPRT, XORDINVC, USDOCID3, WORKFLOWENABLED, UPDTONPRINT, CREDITLIMITHOLDID, UPDTACTUALSHPDT, WORKFLOWHOLDID, OVERRIDEIVCBILLQTY, ENABLEBACKORDER, ENABLECANCELED, SOPSTATUSACTIVE_1, SOPSTATUSACTIVE_2, SOPSTATUSACTIVE_3, SOPSTATUSACTIVE_4, SOPSTATUSACTIVE_5, SOPSTATUSACTIVE_6, SOPSTATUSACTIVE_7, SOPSTATUSACTIVE_8, SOPSTATUSACTIVE_9, DEX_ROW_ID FROM .SOP40200 WHERE ( SOPTYPE = @SOPTYPE AND DOCID > @DOCID OR SOPTYPE > @SOPTYPE ) ORDER BY SOPTYPE ASC, DOCID ASC END ELSE IF @SOPTYPE_RS = @SOPTYPE_RE BEGIN SELECT TOP 25  DOCID, NOTEINDX, SOPTYPE, SETUPKEY, DOCTYABR, SOPNUMBE, COMMNTID, DOCUFORM, DAYTOEXP, ALLREPEA, ALLOCABY, USEPROSP, USNXTINV, USPFULPR, QUOTOINV, QUOTOORD, INVTOBAC, BACTOINV, BACTOORD, ORDTOBAC, ORDTOORD, USDOCID1, USDOCID2, QTYDEFAU, SOPALLOW_1, SOPALLOW_2, SOPALLOW_3, SOPALLOW_4, SOPALLOW_5, SOPALLOW_6, SOPALLOW_7, SOPALLOW_8, SOPALLOW_9, SOPALLOW_10, SOPPSSWD_1, SOPPSSWD_2, SOPPSSWD_3, SOPPSSWD_4, SOPPSSWD_5, SOPPSSWD_6, SOPPSSWD_7, SOPPSSWD_8, SOPPSSWD_9, SOPPSSWD_10, SOPSEQNC_1, SOPSEQNC_2, SOPSEQNC_3, SOPSEQNC_4, SOPSEQNC_5, SOPSEQNC_6, SOPSEQNC_7, SOPSEQNC_8, USER2ENT, CREATDDT, MODIFDT, SHPPGDOC, CORRCTN, SIMPLIFD, ALLBACKODPRT, XORDINVC, USDOCID3, WORKFLOWENABLED, UPDTONPRINT, CREDITLIMITHOLDID, UPDTACTUALSHPDT, WORKFLOWHOLDID, OVERRIDEIVCBILLQTY, ENABLEBACKORDER, ENABLECANCELED, SOPSTATUSACTIVE_1, SOPSTATUSACTIVE_2, SOPSTATUSACTIVE_3, SOPSTATUSACTIVE_4, SOPSTATUSACTIVE_5, SOPSTATUSACTIVE_6, SOPSTATUSACTIVE_7, SOPSTATUSACTIVE_8, SOPSTATUSACTIVE_9, DEX_ROW_ID FROM .SOP40200 WHERE SOPTYPE = @SOPTYPE_RS AND DOCID BETWEEN @DOCID_RS AND @DOCID_RE AND ( SOPTYPE = @SOPTYPE AND DOCID > @DOCID OR SOPTYPE > @SOPTYPE ) ORDER BY SOPTYPE ASC, DOCID ASC END ELSE BEGIN SELECT TOP 25  DOCID, NOTEINDX, SOPTYPE, SETUPKEY, DOCTYABR, SOPNUMBE, COMMNTID, DOCUFORM, DAYTOEXP, ALLREPEA, ALLOCABY, USEPROSP, USNXTINV, USPFULPR, QUOTOINV, QUOTOORD, INVTOBAC, BACTOINV, BACTOORD, ORDTOBAC, ORDTOORD, USDOCID1, USDOCID2, QTYDEFAU, SOPALLOW_1, SOPALLOW_2, SOPALLOW_3, SOPALLOW_4, SOPALLOW_5, SOPALLOW_6, SOPALLOW_7, SOPALLOW_8, SOPALLOW_9, SOPALLOW_10, SOPPSSWD_1, SOPPSSWD_2, SOPPSSWD_3, SOPPSSWD_4, SOPPSSWD_5, SOPPSSWD_6, SOPPSSWD_7, SOPPSSWD_8, SOPPSSWD_9, SOPPSSWD_10, SOPSEQNC_1, SOPSEQNC_2, SOPSEQNC_3, SOPSEQNC_4, SOPSEQNC_5, SOPSEQNC_6, SOPSEQNC_7, SOPSEQNC_8, USER2ENT, CREATDDT, MODIFDT, SHPPGDOC, CORRCTN, SIMPLIFD, ALLBACKODPRT, XORDINVC, USDOCID3, WORKFLOWENABLED, UPDTONPRINT, CREDITLIMITHOLDID, UPDTACTUALSHPDT, WORKFLOWHOLDID, OVERRIDEIVCBILLQTY, ENABLEBACKORDER, ENABLECANCELED, SOPSTATUSACTIVE_1, SOPSTATUSACTIVE_2, SOPSTATUSACTIVE_3, SOPSTATUSACTIVE_4, SOPSTATUSACTIVE_5, SOPSTATUSACTIVE_6, SOPSTATUSACTIVE_7, SOPSTATUSACTIVE_8, SOPSTATUSACTIVE_9, DEX_ROW_ID FROM .SOP40200 WHERE SOPTYPE BETWEEN @SOPTYPE_RS AND @SOPTYPE_RE AND DOCID BETWEEN @DOCID_RS AND @DOCID_RE AND ( SOPTYPE = @SOPTYPE AND DOCID > @DOCID OR SOPTYPE > @SOPTYPE ) ORDER BY SOPTYPE ASC, DOCID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SOP40200N_1] TO [DYNGRP]
GO
