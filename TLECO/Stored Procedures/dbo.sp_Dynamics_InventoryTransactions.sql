SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_Dynamics_InventoryTransactions] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqlstring11 varchar(8000),  @sqlstring12 varchar(8000),  @sqlstring13 varchar(8000),  @sqlstring14 varchar(8000),  @sqlstring15 varchar(8000),  @sqlstring16 varchar(8000),  @sqlstring17 varchar(8000),  @sqlstring18 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @Document_Number varchar(255), @Document_Type varchar(255), @Item_Number varchar(255), @Line_SEQ_Number varchar(255), @U_Of_M varchar(255), @QTY_In_Base_U_Of_M varchar(255), @TRX_QTY varchar(255), @Unit_Cost varchar(255), @Extended_Cost varchar(255), @TRX_Location varchar(255), @Transfer_To_Location varchar(255), @Transfer_From_QTY_Type varchar(255), @Transfer_To_QTY_Type varchar(255), @Inventory_Account_Number varchar(255), @Inventory_Offset_Account_Number varchar(255), @TRX_Source varchar(255), @Document_Date varchar(255), @History_Module varchar(255), @Customer_Number varchar(255), @Document_Status varchar(255), @Batch_Number varchar(255), @Batch_Source varchar(255), @Recurring_Document_Number varchar(255), @Modified_User_ID varchar(255), @Posted_Date varchar(255), @Posted_User_ID varchar(255), @GL_Posting_Date varchar(255), @Posting_Status varchar(255), @TRX_QTY_Total varchar(255), @Note_Index varchar(255), @Item_Description varchar(255), @Item_Short_Name varchar(255), @Item_Type varchar(255), @Item_Generic_Description varchar(255), @Standard_Cost varchar(255), @Current_Cost varchar(255), @Item_Shipping_Weight varchar(255), @Decimal_Places_QTYS varchar(255), @Decimal_Places_Currency varchar(255), @Item_Tax_Schedule_ID varchar(255), @Tax_Options varchar(255), @Inventory_Account_Number_from_Item_Master varchar(255), @Inventory_Offset_Account_Number_from_Item_Master varchar(255), @COGS_Account_Number varchar(255), @Sales_Account_Number varchar(255), @Sales_Discounts_Account_Number varchar(255), @Sales_Returns_Account_Number varchar(255), @In_Use_Account_Number varchar(255), @In_Service_Account_Number varchar(255), @Damaged_Account_Number varchar(255), @Variances_Account_Number varchar(255), @Drop_Ship_Account_Number varchar(255), @Purchase_Price_Variance_Account_Number varchar(255), @Inventory_Returns_Account_Number varchar(255), @Assembly_Variance_Account_Number varchar(255), @Item_Class_Code varchar(255), @Item_Tracking_Option varchar(255), @Lot_Type varchar(255), @Keep_Period_History varchar(255), @Keep_Trx_History varchar(255), @Keep_Calendar_History varchar(255), @Keep_Distribution_History varchar(255), @Allow_Back_Orders varchar(255), @Valuation_Method varchar(255), @U_Of_M_Schedule varchar(255), @Alternate_Item_1 varchar(255), @Alternate_Item_2 varchar(255), @User_Category_Value_1 varchar(255), @User_Category_Value_2 varchar(255), @User_Category_Value_3 varchar(255), @User_Category_Value_4 varchar(255), @User_Category_Value_5 varchar(255), @User_Category_Value_6 varchar(255), @Master_Record_Type varchar(255), @Modified_Date varchar(255), @Created_Date varchar(255), @Warranty_Days varchar(255), @PriceLevel varchar(255), @ABC_Code varchar(255), @COGS_Inflation_Account_Number varchar(255), @COGS_Monetary_Correction_Account_Number varchar(255), @Inventory_Inflation_Account_Number varchar(255), @Inventory_Monetary_Correction_Account_Number varchar(255), @Item_Code varchar(255), @Kit_COGS_Account_Source varchar(255), @Last_Generated_Serial_Number varchar(255), @Price_Group varchar(255), @Price_Method varchar(255), @Purch_Inflation_Account_Number varchar(255), @Purch_Monetary_Correction_Account_Number varchar(255), @Purchasing_U_Of_M varchar(255), @Selling_U_Of_M varchar(255), @Tax_Commodity_Code varchar(255), @Unrealized_Purchase_Price_Variance_Account_Number varchar(255), @Location_Code varchar(255), @Usage_Type varchar(255), @Source_Reference_Number varchar(255), @Source_Indicator varchar(255), @DrillBack_Base_Url varchar(255), @Item_Number_For_DrillBack varchar(255), @Assembly_Variance_Account_Number_For_DrillBack varchar(255), @COGS_Account_Number_For_DrillBack varchar(255), @COGS_Inflation_Account_Number_For_DrillBack varchar(255), @COGS_Monetary_Correction_Account_Number_For_DrillBack varchar(255), @Damaged_Account_Number_For_DrillBack varchar(255), @Drop_Ship_Account_Number_For_DrillBack varchar(255), @In_Service_Account_Number_For_DrillBack varchar(255), @In_Use_Account_Number_For_DrillBack varchar(255), @Inventory_Account_Number_For_DrillBack varchar(255), @Inventory_Inflation_Account_Number_For_DrillBack varchar(255), @Inventory_Monetary_Correction_Account_Number_For_DrillBack varchar(255), @Inventory_Offset_Account_Number_For_DrillBack varchar(255), @Inventory_Returns_Account_Number_For_DrillBack varchar(255), @Purch_Inflation_Account_Number_For_DrillBack varchar(255), @Purch_Monetary_Correction_Account_Number_For_DrillBack varchar(255), @Purchase_Price_Variance_Account_Number_For_DrillBack varchar(255), @Sales_Account_Number_For_DrillBack varchar(255), @Sales_Discounts_Account_Number_For_DrillBack varchar(255), @Sales_Returns_Account_Number_For_DrillBack varchar(255), @Unrealized_Purchase_Price_Variance_Account_Number_For_DrillBack varchar(255), @Variances_Account_Number_For_DrillBack varchar(255), @Document_Number_For_DrillBack varchar(255)  select @DrillBack_Base_Url = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),0)  select @I_iDictID = 1493 select @I_iMessageNumber = 26500 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Document_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26501 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Document_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 26502 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26503 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Line_SEQ_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26504 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @U_Of_M output  select @I_iDictID = 1493 select @I_iMessageNumber = 26505 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY_In_Base_U_Of_M output  select @I_iDictID = 1493 select @I_iMessageNumber = 26506 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TRX_QTY output  select @I_iDictID = 1493 select @I_iMessageNumber = 26507 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Unit_Cost output  select @I_iDictID = 1493 select @I_iMessageNumber = 26508 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Extended_Cost output  select @I_iDictID = 1493 select @I_iMessageNumber = 26509 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TRX_Location output  select @I_iDictID = 1493 select @I_iMessageNumber = 26510 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Transfer_To_Location output  select @I_iDictID = 1493 select @I_iMessageNumber = 26511 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Transfer_From_QTY_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 26512 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Transfer_To_QTY_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 26513 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26514 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Offset_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26516 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TRX_Source output  select @I_iDictID = 1493 select @I_iMessageNumber = 26517 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Document_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26518 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @History_Module output  select @I_iDictID = 1493 select @I_iMessageNumber = 26519 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26520 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Document_Status output  select @I_iDictID = 1493 select @I_iMessageNumber = 26523 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Batch_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26524 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Batch_Source output  select @I_iDictID = 1493 select @I_iMessageNumber = 26525 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Recurring_Document_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26526 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Modified_User_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 26527 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Posted_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26528 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Posted_User_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 26529 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @GL_Posting_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 26530 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Posting_Status output  select @I_iDictID = 1493 select @I_iMessageNumber = 26531 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @TRX_QTY_Total output  select @I_iDictID = 1493 select @I_iMessageNumber = 26533 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Note_Index output  select @I_iDictID = 1493 select @I_iMessageNumber = 23101 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Description output  select @I_iDictID = 1493 select @I_iMessageNumber = 23103 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Short_Name output  select @I_iDictID = 1493 select @I_iMessageNumber = 23104 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 23105 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Generic_Description output  select @I_iDictID = 1493 select @I_iMessageNumber = 23106 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Standard_Cost output  select @I_iDictID = 1493 select @I_iMessageNumber = 23107 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Current_Cost output  select @I_iDictID = 1493 select @I_iMessageNumber = 23109 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Shipping_Weight output  select @I_iDictID = 1493 select @I_iMessageNumber = 23110 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Decimal_Places_QTYS output  select @I_iDictID = 1493 select @I_iMessageNumber = 23111 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Decimal_Places_Currency output  select @I_iDictID = 1493 select @I_iMessageNumber = 23112 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Tax_Schedule_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 23113 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tax_Options output  select @I_iDictID = 1493 select @I_iMessageNumber = 23115 select @I_iAliasMessageNumber = 22478 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Account_Number_from_Item_Master output  select @I_iDictID = 1493 select @I_iMessageNumber = 24159 select @I_iAliasMessageNumber = 22478 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Offset_Account_Number_from_Item_Master output  select @I_iDictID = 1493 select @I_iMessageNumber = 23117 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @COGS_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23118 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Sales_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23119 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Sales_Discounts_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23120 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Sales_Returns_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23121 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @In_Use_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23122 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @In_Service_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23123 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Damaged_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23124 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Variances_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23125 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Drop_Ship_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23126 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purchase_Price_Variance_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23127 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Returns_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23128 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Assembly_Variance_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23129 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Class_Code output  select @I_iDictID = 1493 select @I_iMessageNumber = 23130 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Tracking_Option output  select @I_iDictID = 1493 select @I_iMessageNumber = 23131 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Lot_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 23132 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Keep_Period_History output  select @I_iDictID = 1493 select @I_iMessageNumber = 23133 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Keep_Trx_History output  select @I_iDictID = 1493 select @I_iMessageNumber = 23134 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Keep_Calendar_History output  select @I_iDictID = 1493 select @I_iMessageNumber = 23135 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Keep_Distribution_History output  select @I_iDictID = 1493 select @I_iMessageNumber = 23136 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Allow_Back_Orders output  select @I_iDictID = 1493 select @I_iMessageNumber = 23137 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Valuation_Method output  select @I_iDictID = 1493 select @I_iMessageNumber = 23138 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @U_Of_M_Schedule output  select @I_iDictID = 1493 select @I_iMessageNumber = 23140 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Alternate_Item_1 output  select @I_iDictID = 1493 select @I_iMessageNumber = 23141 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Alternate_Item_2 output  select @I_iDictID = 1493 select @I_iMessageNumber = 23142 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Category_Value_1 output  select @I_iDictID = 1493 select @I_iMessageNumber = 23143 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Category_Value_2 output  select @I_iDictID = 1493 select @I_iMessageNumber = 23144 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Category_Value_3 output  select @I_iDictID = 1493 select @I_iMessageNumber = 23145 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Category_Value_4 output  select @I_iDictID = 1493 select @I_iMessageNumber = 23146 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Category_Value_5 output  select @I_iDictID = 1493 select @I_iMessageNumber = 23147 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Category_Value_6 output  select @I_iDictID = 1493 select @I_iMessageNumber = 23148 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Master_Record_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 23149 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Modified_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 23150 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Created_Date output  select @I_iDictID = 1493 select @I_iMessageNumber = 23151 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Warranty_Days output  select @I_iDictID = 1493 select @I_iMessageNumber = 23152 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @PriceLevel output  select @I_iDictID = 1493 select @I_iMessageNumber = 23153 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ABC_Code output  select @I_iDictID = 1493 select @I_iMessageNumber = 23154 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @COGS_Inflation_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23155 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @COGS_Monetary_Correction_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23156 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Inflation_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23157 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Monetary_Correction_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23158 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Code output  select @I_iDictID = 1493 select @I_iMessageNumber = 23159 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Kit_COGS_Account_Source output  select @I_iDictID = 1493 select @I_iMessageNumber = 23160 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Generated_Serial_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23161 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Price_Group output  select @I_iDictID = 1493 select @I_iMessageNumber = 23162 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Price_Method output  select @I_iDictID = 1493 select @I_iMessageNumber = 23163 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purch_Inflation_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23164 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purch_Monetary_Correction_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23165 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purchasing_U_Of_M output  select @I_iDictID = 1493 select @I_iMessageNumber = 23166 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Selling_U_Of_M output  select @I_iDictID = 1493 select @I_iMessageNumber = 23167 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Tax_Commodity_Code output  select @I_iDictID = 1493 select @I_iMessageNumber = 23168 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Unrealized_Purchase_Price_Variance_Account_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 23169 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Location_Code output  select @I_iDictID = 1493 select @I_iMessageNumber = 26534 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Usage_Type output  select @I_iDictID = 1493 select @I_iMessageNumber = 26535 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Source_Reference_Number output  select @I_iDictID = 1493 select @I_iMessageNumber = 26536 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Source_Indicator output   select @I_iDictID = 1493 select @I_iMessageNumber = 26502 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23128 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Assembly_Variance_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23117 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @COGS_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23154 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @COGS_Inflation_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23155 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @COGS_Monetary_Correction_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23123 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Damaged_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23125 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Drop_Ship_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23122 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @In_Service_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23121 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @In_Use_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 26513 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23156 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Inflation_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23157 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Monetary_Correction_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 26514 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Offset_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23127 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inventory_Returns_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23163 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purch_Inflation_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23164 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purch_Monetary_Correction_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23126 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Purchase_Price_Variance_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23118 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Sales_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23119 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Sales_Discounts_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23120 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Sales_Returns_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23168 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Unrealized_Purchase_Price_Variance_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 23124 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Variances_Account_Number_For_DrillBack output   select @I_iDictID = 1493 select @I_iMessageNumber = 26500 select @I_iAliasMessageNumber = 22214 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Document_Number_For_DrillBack output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[InventoryTransactions]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[InventoryTransactions] '  select @sqldefaultstring =   'CREATE VIEW InventoryTransactions AS ' +   'select ' +   'rtrim([''Inventory Transaction Amounts Work''].[IVDOCNBR]) as ''' + @Document_Number + ''', ' + '''' + @Document_Type + ''' = dbo.DYN_FUNC_Document_Type_IV_Trx([''Inventory Transaction Amounts Work''].[IVDOCTYP]), ' + 'rtrim([''Inventory Transaction Amounts Work''].[ITEMNMBR]) as ''' + @Item_Number + ''', ' + 'rtrim([''Inventory Transaction Amounts Work''].[UOFM]) as ''' + @U_Of_M + ''', ' + '[''Inventory Transaction Amounts Work''].[TRXQTY] as ''' + @TRX_QTY + ''', ' + '[''Inventory Transaction Amounts Work''].[UNITCOST] as ''' + @Unit_Cost + ''', ' + '[''Inventory Transaction Amounts Work''].[EXTDCOST] as ''' + @Extended_Cost + ''', ' + 'rtrim([''Inventory Transaction Amounts Work''].[TRXLOCTN]) as ''' + @TRX_Location + ''', ' + '[''Inventory Transaction Work''].[DOCDATE] as ''' + @Document_Date + ''', ' + '''' + @Document_Status + ''' = dbo.DYN_FUNC_Document_Status_IV_Trx(1), '   select @sqlstring1 =   '''' + @ABC_Code + ''' = dbo.DYN_FUNC_ABC_Code([''Item Master''].[ABCCODE]), ' +  '''' + @Allow_Back_Orders + ''' = dbo.DYN_FUNC_Boolean_All([''Item Master''].[ALWBKORD]), ' +  'rtrim([''Item Master''].[ALTITEM1]) as ''' + @Alternate_Item_1 + ''', ' +  'rtrim([''Item Master''].[ALTITEM2]) as ''' + @Alternate_Item_2 + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[ASMVRIDX]) as ''' + @Assembly_Variance_Account_Number + ''', ' +  'rtrim([''Inventory Transaction Work''].[BACHNUMB]) as ''' + @Batch_Number + ''', ' +  'rtrim([''Inventory Transaction Work''].[BCHSOURC]) as ''' + @Batch_Source + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVCOGSIX]) as ''' + @COGS_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[CGSINFLX]) as ''' + @COGS_Inflation_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[CGSMCIDX]) as ''' + @COGS_Monetary_Correction_Account_Number + ''', ' +  '[''Item Master''].[CREATDDT] as ''' + @Created_Date + ''', ' +  '[''Item Master''].[CURRCOST] as ''' + @Current_Cost + ''', ' +  'NULL  as ''' + @Customer_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVDMGIDX]) as ''' + @Damaged_Account_Number + ''', ' +  '''' + @Decimal_Places_Currency + ''' = dbo.DYN_FUNC_Decimal_Places_Currency([''Item Master''].[DECPLCUR]), ' +  '''' + @Decimal_Places_QTYS + ''' = dbo.DYN_FUNC_Decimal_Places_QTYS([''Item Master''].[DECPLQTY]), ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[DPSHPIDX]) as ''' + @Drop_Ship_Account_Number + ''', ' +  '[''Inventory Transaction Work''].[GLPOSTDT] as ''' + @GL_Posting_Date + ''', ' +  'NULL  as ''' + @History_Module + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVINSVIX]) as ''' + @In_Service_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVINUSIX]) as ''' + @In_Use_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Inventory Transaction Amounts Work''].[IVIVINDX]) as ''' + @Inventory_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVIVINDX]) as ''' + @Inventory_Account_Number_from_Item_Master + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVINFIDX]) as ''' + @Inventory_Inflation_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[INVMCIDX]) as ''' + @Inventory_Monetary_Correction_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Inventory Transaction Amounts Work''].[IVIVOFIX]) as ''' + @Inventory_Offset_Account_Number + ''', ' +  'NULL  as ''' + @Inventory_Offset_Account_Number_from_Item_Master + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVRETIDX]) as ''' + @Inventory_Returns_Account_Number + ''', ' +  'rtrim([''Item Master''].[ITMCLSCD]) as ''' + @Item_Class_Code + ''', ' +  'rtrim([''Item Master''].[ITEMCODE]) as ''' + @Item_Code + ''', ' +  'rtrim([''Item Master''].[ITEMDESC]) as ''' + @Item_Description + ''', ' +  'rtrim([''Item Master''].[ITMGEDSC]) as ''' + @Item_Generic_Description + ''', ' +  '[''Item Master''].[ITEMSHWT]/100.00 as ''' + @Item_Shipping_Weight + ''', ' +  'rtrim([''Item Master''].[ITMSHNAM]) as ''' + @Item_Short_Name + ''', ' +  'rtrim([''Item Master''].[ITMTSHID]) as ''' + @Item_Tax_Schedule_ID + ''', ' +  '''' + @Item_Tracking_Option + ''' = dbo.DYN_FUNC_Item_Tracking_Option([''Item Master''].[ITMTRKOP]), ' +  '''' + @Item_Type + ''' = dbo.DYN_FUNC_Item_Type([''Item Master''].[ITEMTYPE]), ' +  '''' + @Keep_Calendar_History + ''' = dbo.DYN_FUNC_Boolean_All([''Item Master''].[KPCALHST]), ' +  '''' + @Keep_Distribution_History + ''' = dbo.DYN_FUNC_Boolean_All([''Item Master''].[KPDSTHST]), ' +  '''' + @Keep_Period_History + ''' = dbo.DYN_FUNC_Boolean_All([''Item Master''].[KPERHIST]), ' +  '''' + @Keep_Trx_History + ''' = dbo.DYN_FUNC_Boolean_All([''Item Master''].[KPTRXHST]), ' +  '''' + @Kit_COGS_Account_Source + ''' = dbo.DYN_FUNC_Kit_COGS_Account_Source([''Item Master''].[KTACCTSR]), ' +  'rtrim([''Item Master''].[LASTGENSN]) as ''' + @Last_Generated_Serial_Number + ''', ' +  '[''Inventory Transaction Amounts Work''].[LNSEQNBR] as ''' + @Line_SEQ_Number + ''', ' +  'rtrim([''Item Master''].[LOCNCODE]) as ''' + @Location_Code + ''', ' +  'rtrim([''Item Master''].[LOTTYPE]) as ''' + @Lot_Type + ''', ' +  '[''Item Master''].[MSTRCDTY] as ''' + @Master_Record_Type + ''', ' +  '[''Item Master''].[MODIFDT] as ''' + @Modified_Date + ''', ' +  'rtrim([''Inventory Transaction Work''].[MDFUSRID]) as ''' + @Modified_User_ID + ''', ' +  '[''Inventory Transaction Work''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  '[''Inventory Transaction Work''].[POSTEDDT] as ''' + @Posted_Date + ''', ' +  'rtrim([''Inventory Transaction Work''].[PTDUSRID]) as ''' + @Posted_User_ID + ''', '   select @sqlstring2 =   '[''Inventory Transaction Work''].[PSTGSTUS] as ''' + @Posting_Status + ''', ' +  'rtrim([''Item Master''].[PRCLEVEL]) as ''' + @PriceLevel + ''', ' +  'rtrim([''Item Master''].[PriceGroup]) as ''' + @Price_Group + ''', ' +  '''' + @Price_Method + ''' = dbo.DYN_FUNC_Price_Method([''Item Master''].[PRICMTHD]), ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[PINFLIDX]) as ''' + @Purch_Inflation_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[PURMCIDX]) as ''' + @Purch_Monetary_Correction_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[PURPVIDX]) as ''' + @Purchase_Price_Variance_Account_Number + ''', ' +  'rtrim([''Item Master''].[PRCHSUOM]) as ''' + @Purchasing_U_Of_M + ''', ' +  '[''Inventory Transaction Amounts Work''].[QTYBSUOM] as ''' + @QTY_In_Base_U_Of_M + ''', ' +  'rtrim([''Inventory Transaction Work''].[RCDOCNUM]) as ''' + @Recurring_Document_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVSLSIDX]) as ''' + @Sales_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVSLDSIX]) as ''' + @Sales_Discounts_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVSLRNIX]) as ''' + @Sales_Returns_Account_Number + ''', ' +  'rtrim([''Item Master''].[SELNGUOM]) as ''' + @Selling_U_Of_M + ''', ' +  '''' + @Source_Indicator + ''' = dbo.DYN_FUNC_Source_Indicator([''Inventory Transaction Work''].[SOURCEINDICATOR]), ' +  'rtrim([''Inventory Transaction Work''].[SRCRFRNCNMBR]) as ''' + @Source_Reference_Number + ''', ' +  '[''Item Master''].[STNDCOST] as ''' + @Standard_Cost + ''', ' +  '[''Inventory Transaction Work''].[TRXQTYTL] as ''' + @TRX_QTY_Total + ''', ' +  'NULL  as ''' + @TRX_Source + ''', ' +  'rtrim([''Item Master''].[TCC]) as ''' + @Tax_Commodity_Code + ''', ' +  '''' + @Tax_Options + ''' = dbo.DYN_FUNC_Tax_Options([''Item Master''].[TAXOPTNS]), ' +  '''' + @Transfer_From_QTY_Type + ''' = dbo.DYN_FUNC_Transfer_From_QTY_Type([''Inventory Transaction Amounts Work''].[TRFQTYTY]), ' +  'rtrim([''Inventory Transaction Amounts Work''].[TRNSTLOC]) as ''' + @Transfer_To_Location + ''', ' +  '''' + @Transfer_To_QTY_Type + ''' = dbo.DYN_FUNC_Transfer_To_QTY_Type([''Inventory Transaction Amounts Work''].[TRTQTYTY]), ' +  'rtrim([''Item Master''].[UOMSCHDL]) as ''' + @U_Of_M_Schedule + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[UPPVIDX]) as ''' + @Unrealized_Purchase_Price_Variance_Account_Number + ''', ' +  '[''Inventory Transaction Amounts Work''].[USAGETYPE] as ''' + @Usage_Type + ''', ' +  'rtrim([''Item Master''].[USCATVLS_1]) as ''' + @User_Category_Value_1 + ''', ' +  'rtrim([''Item Master''].[USCATVLS_2]) as ''' + @User_Category_Value_2 + ''', ' +  'rtrim([''Item Master''].[USCATVLS_3]) as ''' + @User_Category_Value_3 + ''', ' +  'rtrim([''Item Master''].[USCATVLS_4]) as ''' + @User_Category_Value_4 + ''', ' +  'rtrim([''Item Master''].[USCATVLS_5]) as ''' + @User_Category_Value_5 + ''', ' +  'rtrim([''Item Master''].[USCATVLS_6]) as ''' + @User_Category_Value_6 + ''', ' +  '''' + @Valuation_Method + ''' = dbo.DYN_FUNC_Valuation_Method([''Item Master''].[VCTNMTHD]), ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVVARIDX]) as ''' + @Variances_Account_Number + ''', ' +  '[''Item Master''].[WRNTYDYS] as ''' + @Warranty_Days + ''', '   select @sqlstring3 =  '''' + @Assembly_Variance_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[ASMVRIDX] ), '+ '''' + @COGS_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVCOGSIX] ), '+ '''' + @COGS_Inflation_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[CGSINFLX] ), '+ '''' + @COGS_Monetary_Correction_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[CGSMCIDX] ), '  select @sqlstring4 =  '''' + @Damaged_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVDMGIDX] ), '+ '''' + @Document_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppItemTransactionNumber(1,[''Inventory Transaction Amounts Work''].[ITEMNMBR],[''Inventory Transaction Amounts Work''].[IVDOCTYP],[''Inventory Transaction Amounts Work''].[IVDOCNBR],1 ), '+ '''' + @Drop_Ship_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[DPSHPIDX] ), '+ '''' + @In_Service_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVINSVIX] ), '  select @sqlstring5 =  '''' + @In_Use_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVINUSIX] ), '+ '''' + @Inventory_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Inventory Transaction Amounts Work''].[IVIVINDX] ), '+ '''' + @Inventory_Inflation_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVINFIDX] ), '+ '''' + @Inventory_Monetary_Correction_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[INVMCIDX] ), '  select @sqlstring6 =  '''' + @Inventory_Offset_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Inventory Transaction Amounts Work''].[IVIVOFIX] ), '+ '''' + @Inventory_Returns_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVRETIDX] ), '+ '''' + @Item_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppItemID(1,[''Inventory Transaction Amounts Work''].[ITEMNMBR],[''Item Master''].[LOCNCODE] ), '+ '''' + @Purch_Inflation_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[PINFLIDX] ), '  select @sqlstring7 =  '''' + @Purch_Monetary_Correction_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[PURMCIDX] ), '+ '''' + @Purchase_Price_Variance_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[PURPVIDX] ), '+ '''' + @Sales_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVSLSIDX] ), '+ '''' + @Sales_Discounts_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVSLDSIX] ), '  select @sqlstring8 =  '''' + @Sales_Returns_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVSLRNIX] ), '+ '''' + @Unrealized_Purchase_Price_Variance_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[UPPVIDX] ), '+ '''' + @Variances_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVVARIDX] ) '  select @sqlstring9 =   'from [IV10001] as [''Inventory Transaction Amounts Work''] with (NOLOCK) '   + 'left outer join [IV10000] as [''Inventory Transaction Work''] with (NOLOCK) on '   + '[''Inventory Transaction Amounts Work''].[IVDOCTYP] = [''Inventory Transaction Work''].[IVDOCTYP] '   + ' and [''Inventory Transaction Amounts Work''].[IVDOCNBR] = [''Inventory Transaction Work''].[IVDOCNBR] '   + 'left outer join [IV00101] as [''Item Master''] with (NOLOCK) on '   + '[''Inventory Transaction Amounts Work''].[ITEMNMBR] = [''Item Master''].[ITEMNMBR] '   select @sqlstring10 =   'union all ' +   'select ' +   'rtrim([''Inventory Transaction Amounts History''].[DOCNUMBR]) as ''' + @Document_Number + ''', ' + '''' + @Document_Type + ''' = dbo.DYN_FUNC_Document_Type_IV_Trx([''Inventory Transaction Amounts History''].[DOCTYPE]), ' + 'rtrim([''Inventory Transaction Amounts History''].[ITEMNMBR]) as ''' + @Item_Number + ''', ' + 'rtrim([''Inventory Transaction Amounts History''].[UOFM]) as ''' + @U_Of_M + ''', ' + '[''Inventory Transaction Amounts History''].[TRXQTY] as ''' + @TRX_QTY + ''', ' + '[''Inventory Transaction Amounts History''].[UNITCOST] as ''' + @Unit_Cost + ''', ' + '[''Inventory Transaction Amounts History''].[EXTDCOST] as ''' + @Extended_Cost + ''', ' + 'rtrim([''Inventory Transaction Amounts History''].[TRXLOCTN]) as ''' + @TRX_Location + ''', ' + '[''Inventory Transaction Amounts History''].[DOCDATE] as ''' + @Document_Date + ''', ' + '''' + @Document_Status + ''' = dbo.DYN_FUNC_Document_Status_IV_Trx(2), '   select @sqlstring11 =   '''' + @ABC_Code + ''' = dbo.DYN_FUNC_ABC_Code([''Item Master''].[ABCCODE]), ' +  '''' + @Allow_Back_Orders + ''' = dbo.DYN_FUNC_Boolean_All([''Item Master''].[ALWBKORD]), ' +  'rtrim([''Item Master''].[ALTITEM1]) as ''' + @Alternate_Item_1 + ''', ' +  'rtrim([''Item Master''].[ALTITEM2]) as ''' + @Alternate_Item_2 + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[ASMVRIDX]) as ''' + @Assembly_Variance_Account_Number + ''', ' +  'rtrim([''Inventory Transaction History''].[BACHNUMB]) as ''' + @Batch_Number + ''', ' +  'rtrim([''Inventory Transaction History''].[BCHSOURC]) as ''' + @Batch_Source + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVCOGSIX]) as ''' + @COGS_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[CGSINFLX]) as ''' + @COGS_Inflation_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[CGSMCIDX]) as ''' + @COGS_Monetary_Correction_Account_Number + ''', ' +  '[''Item Master''].[CREATDDT] as ''' + @Created_Date + ''', ' +  '[''Item Master''].[CURRCOST] as ''' + @Current_Cost + ''', ' +  'NULL  as ''' + @Customer_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVDMGIDX]) as ''' + @Damaged_Account_Number + ''', ' +  '''' + @Decimal_Places_Currency + ''' = dbo.DYN_FUNC_Decimal_Places_Currency([''Item Master''].[DECPLCUR]), ' +  '''' + @Decimal_Places_QTYS + ''' = dbo.DYN_FUNC_Decimal_Places_QTYS([''Item Master''].[DECPLQTY]), ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[DPSHPIDX]) as ''' + @Drop_Ship_Account_Number + ''', ' +  '[''Inventory Transaction History''].[GLPOSTDT] as ''' + @GL_Posting_Date + ''', ' +  'rtrim([''Inventory Transaction Amounts History''].[HSTMODUL]) as ''' + @History_Module + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVINSVIX]) as ''' + @In_Service_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVINUSIX]) as ''' + @In_Use_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Inventory Transaction Amounts History''].[IVIVINDX]) as ''' + @Inventory_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVIVINDX]) as ''' + @Inventory_Account_Number_from_Item_Master + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVINFIDX]) as ''' + @Inventory_Inflation_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[INVMCIDX]) as ''' + @Inventory_Monetary_Correction_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Inventory Transaction Amounts History''].[IVIVOFIX]) as ''' + @Inventory_Offset_Account_Number + ''', ' +  'NULL  as ''' + @Inventory_Offset_Account_Number_from_Item_Master + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVRETIDX]) as ''' + @Inventory_Returns_Account_Number + ''', ' +  'rtrim([''Item Master''].[ITMCLSCD]) as ''' + @Item_Class_Code + ''', ' +  'rtrim([''Item Master''].[ITEMCODE]) as ''' + @Item_Code + ''', ' +  'rtrim([''Item Master''].[ITEMDESC]) as ''' + @Item_Description + ''', ' +  'rtrim([''Item Master''].[ITMGEDSC]) as ''' + @Item_Generic_Description + ''', ' +  '[''Item Master''].[ITEMSHWT]/100.00 as ''' + @Item_Shipping_Weight + ''', ' +  'rtrim([''Item Master''].[ITMSHNAM]) as ''' + @Item_Short_Name + ''', ' +  'rtrim([''Item Master''].[ITMTSHID]) as ''' + @Item_Tax_Schedule_ID + ''', ' +  '''' + @Item_Tracking_Option + ''' = dbo.DYN_FUNC_Item_Tracking_Option([''Item Master''].[ITMTRKOP]), ' +  '''' + @Item_Type + ''' = dbo.DYN_FUNC_Item_Type([''Item Master''].[ITEMTYPE]), ' +  '''' + @Keep_Calendar_History + ''' = dbo.DYN_FUNC_Boolean_All([''Item Master''].[KPCALHST]), ' +  '''' + @Keep_Distribution_History + ''' = dbo.DYN_FUNC_Boolean_All([''Item Master''].[KPDSTHST]), ' +  '''' + @Keep_Period_History + ''' = dbo.DYN_FUNC_Boolean_All([''Item Master''].[KPERHIST]), ' +  '''' + @Keep_Trx_History + ''' = dbo.DYN_FUNC_Boolean_All([''Item Master''].[KPTRXHST]), ' +  '''' + @Kit_COGS_Account_Source + ''' = dbo.DYN_FUNC_Kit_COGS_Account_Source([''Item Master''].[KTACCTSR]), ' +  'rtrim([''Item Master''].[LASTGENSN]) as ''' + @Last_Generated_Serial_Number + ''', ' +  '[''Inventory Transaction Amounts History''].[LNSEQNBR] as ''' + @Line_SEQ_Number + ''', ' +  'rtrim([''Item Master''].[LOCNCODE]) as ''' + @Location_Code + ''', ' +  'rtrim([''Item Master''].[LOTTYPE]) as ''' + @Lot_Type + ''', ' +  '[''Item Master''].[MSTRCDTY] as ''' + @Master_Record_Type + ''', ' +  '[''Item Master''].[MODIFDT] as ''' + @Modified_Date + ''', ' +  'NULL  as ''' + @Modified_User_ID + ''', ' +  '[''Inventory Transaction History''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  'NULL  as ''' + @Posted_Date + ''', ' +  'NULL  as ''' + @Posted_User_ID + ''', ' +  'NULL  as ''' + @Posting_Status + ''', ' +  'rtrim([''Item Master''].[PRCLEVEL]) as ''' + @PriceLevel + ''', '   select @sqlstring12 =   'rtrim([''Item Master''].[PriceGroup]) as ''' + @Price_Group + ''', ' +  '''' + @Price_Method + ''' = dbo.DYN_FUNC_Price_Method([''Item Master''].[PRICMTHD]), ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[PINFLIDX]) as ''' + @Purch_Inflation_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[PURMCIDX]) as ''' + @Purch_Monetary_Correction_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[PURPVIDX]) as ''' + @Purchase_Price_Variance_Account_Number + ''', ' +  'rtrim([''Item Master''].[PRCHSUOM]) as ''' + @Purchasing_U_Of_M + ''', ' +  '[''Inventory Transaction Amounts History''].[QTYBSUOM] as ''' + @QTY_In_Base_U_Of_M + ''', ' +  'NULL  as ''' + @Recurring_Document_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVSLSIDX]) as ''' + @Sales_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVSLDSIX]) as ''' + @Sales_Discounts_Account_Number + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVSLRNIX]) as ''' + @Sales_Returns_Account_Number + ''', ' +  'rtrim([''Item Master''].[SELNGUOM]) as ''' + @Selling_U_Of_M + ''', ' +  '''' + @Source_Indicator + ''' = dbo.DYN_FUNC_Source_Indicator([''Inventory Transaction History''].[SOURCEINDICATOR]), ' +  'rtrim([''Inventory Transaction History''].[SRCRFRNCNMBR]) as ''' + @Source_Reference_Number + ''', ' +  '[''Item Master''].[STNDCOST] as ''' + @Standard_Cost + ''', ' +  'NULL  as ''' + @TRX_QTY_Total + ''', ' +  'NULL  as ''' + @TRX_Source + ''', ' +  'rtrim([''Item Master''].[TCC]) as ''' + @Tax_Commodity_Code + ''', ' +  '''' + @Tax_Options + ''' = dbo.DYN_FUNC_Tax_Options([''Item Master''].[TAXOPTNS]), ' +  '''' + @Transfer_From_QTY_Type + ''' = dbo.DYN_FUNC_Transfer_From_QTY_Type([''Inventory Transaction Amounts History''].[TRFQTYTY]), ' +  'rtrim([''Inventory Transaction Amounts History''].[TRNSTLOC]) as ''' + @Transfer_To_Location + ''', ' +  '''' + @Transfer_To_QTY_Type + ''' = dbo.DYN_FUNC_Transfer_To_QTY_Type([''Inventory Transaction Amounts History''].[TRTQTYTY]), ' +  'rtrim([''Item Master''].[UOMSCHDL]) as ''' + @U_Of_M_Schedule + ''', ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[UPPVIDX]) as ''' + @Unrealized_Purchase_Price_Variance_Account_Number + ''', ' +  'NULL  as ''' + @Usage_Type + ''', ' +  'rtrim([''Item Master''].[USCATVLS_1]) as ''' + @User_Category_Value_1 + ''', ' +  'rtrim([''Item Master''].[USCATVLS_2]) as ''' + @User_Category_Value_2 + ''', ' +  'rtrim([''Item Master''].[USCATVLS_3]) as ''' + @User_Category_Value_3 + ''', ' +  'rtrim([''Item Master''].[USCATVLS_4]) as ''' + @User_Category_Value_4 + ''', ' +  'rtrim([''Item Master''].[USCATVLS_5]) as ''' + @User_Category_Value_5 + ''', ' +  'rtrim([''Item Master''].[USCATVLS_6]) as ''' + @User_Category_Value_6 + ''', ' +  '''' + @Valuation_Method + ''' = dbo.DYN_FUNC_Valuation_Method([''Item Master''].[VCTNMTHD]), ' +  '(select rtrim([ACTNUMST]) from [GL00105] as [''Account Index Master''] where [''Account Index Master''].[ACTINDX] = [''Item Master''].[IVVARIDX]) as ''' + @Variances_Account_Number + ''', ' +  '[''Item Master''].[WRNTYDYS] as ''' + @Warranty_Days + ''', '   select @sqlstring13 =  '''' + @Assembly_Variance_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[ASMVRIDX] ), '+ '''' + @COGS_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVCOGSIX] ), '+ '''' + @COGS_Inflation_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[CGSINFLX] ), '+ '''' + @COGS_Monetary_Correction_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[CGSMCIDX] ), '  select @sqlstring14 =  '''' + @Damaged_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVDMGIDX] ), '+ '''' + @Document_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppItemTransactionNumber(1,[''Inventory Transaction Amounts History''].[ITEMNMBR],[''Inventory Transaction Amounts History''].[DOCTYPE],[''Inventory Transaction Amounts History''].[DOCNUMBR],3 ), '+ '''' + @Drop_Ship_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[DPSHPIDX] ), '+ '''' + @In_Service_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVINSVIX] ), '  select @sqlstring15 =  '''' + @In_Use_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVINUSIX] ), '+ '''' + @Inventory_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Inventory Transaction Amounts History''].[IVIVINDX] ), '+ '''' + @Inventory_Inflation_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVINFIDX] ), '+ '''' + @Inventory_Monetary_Correction_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[INVMCIDX] ), '  select @sqlstring16 =  '''' + @Inventory_Offset_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Inventory Transaction Amounts History''].[IVIVOFIX] ), '+ '''' + @Inventory_Returns_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVRETIDX] ), '+ '''' + @Item_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppItemID(1,[''Inventory Transaction Amounts History''].[ITEMNMBR],[''Item Master''].[LOCNCODE] ), '+ '''' + @Purch_Inflation_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[PINFLIDX] ), '  select @sqlstring17 =  '''' + @Purch_Monetary_Correction_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[PURMCIDX] ), '+ '''' + @Purchase_Price_Variance_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[PURPVIDX] ), '+ '''' + @Sales_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVSLSIDX] ), '+ '''' + @Sales_Discounts_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVSLDSIX] ), '  select @sqlstring18 =  '''' + @Sales_Returns_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVSLRNIX] ), '+ '''' + @Unrealized_Purchase_Price_Variance_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[UPPVIDX] ), '+ '''' + @Variances_Account_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppAccountIndex(1,[''Item Master''].[IVVARIDX] ) '  select @sqljoinstring =   'from [IV30300] as [''Inventory Transaction Amounts History''] with (NOLOCK) '   + 'left outer join [IV30200] as [''Inventory Transaction History''] with (NOLOCK) on '   + '[''Inventory Transaction Amounts History''].[DOCTYPE] = [''Inventory Transaction History''].[IVDOCTYP] '   + ' and [''Inventory Transaction Amounts History''].[DOCNUMBR] = [''Inventory Transaction History''].[DOCNUMBR] '   + 'left outer join [IV00101] as [''Item Master''] with (NOLOCK) on '   + '[''Inventory Transaction Amounts History''].[ITEMNMBR] = [''Item Master''].[ITEMNMBR] '   select @sqlaccessstring =   'GRANT SELECT ON [dbo].[InventoryTransactions] TO [rpt_warehouse manager]' + 'GRANT SELECT ON [dbo].[InventoryTransactions] TO [rpt_materials manager]' + 'GRANT SELECT ON [dbo].[InventoryTransactions] TO [rpt_operations manager]' + 'GRANT SELECT ON [dbo].[InventoryTransactions] TO [rpt_production manager]' + 'GRANT SELECT ON [dbo].[InventoryTransactions] TO [rpt_purchasing agent]' + 'GRANT SELECT ON [dbo].[InventoryTransactions] TO [rpt_order processor]' + 'GRANT SELECT ON [dbo].[InventoryTransactions] TO [rpt_customer service rep]' + 'GRANT SELECT ON [dbo].[InventoryTransactions] TO [rpt_shipping and receiving]' + 'GRANT SELECT ON [dbo].[InventoryTransactions] TO [rpt_sales manager]' + 'GRANT SELECT ON [dbo].[InventoryTransactions] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[InventoryTransactions] TO [rpt_purchasing manager]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+  @sqlstring9+' '+@sqlstring10+' '+@sqlstring11+' '+@sqlstring12+' '+@sqlstring13+' '+@sqlstring14+' '+@sqlstring15+' '+@sqlstring16+' '+  @sqlstring17+' '+@sqlstring18+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_Dynamics_InventoryTransactions] TO [DYNGRP]
GO
