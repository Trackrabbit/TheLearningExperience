SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_UPR41700N_2] (@BS int, @SUPERVISOR char(31), @SUPERVISORCODE_I char(7), @SUPERVISOR_RS char(31), @SUPERVISORCODE_I_RS char(7), @SUPERVISOR_RE char(31), @SUPERVISORCODE_I_RE char(7)) AS  set nocount on IF @SUPERVISOR_RS IS NULL BEGIN SELECT TOP 25  SUPERVISORCODE_I, SUPERVISOR, EMPLOYID, NOTEINDX, CHANGEBY_I, CHANGEDATE_I, DEX_ROW_ID FROM .UPR41700 WHERE ( SUPERVISOR = @SUPERVISOR AND SUPERVISORCODE_I > @SUPERVISORCODE_I OR SUPERVISOR > @SUPERVISOR ) ORDER BY SUPERVISOR ASC, SUPERVISORCODE_I ASC END ELSE IF @SUPERVISOR_RS = @SUPERVISOR_RE BEGIN SELECT TOP 25  SUPERVISORCODE_I, SUPERVISOR, EMPLOYID, NOTEINDX, CHANGEBY_I, CHANGEDATE_I, DEX_ROW_ID FROM .UPR41700 WHERE SUPERVISOR = @SUPERVISOR_RS AND SUPERVISORCODE_I BETWEEN @SUPERVISORCODE_I_RS AND @SUPERVISORCODE_I_RE AND ( SUPERVISOR = @SUPERVISOR AND SUPERVISORCODE_I > @SUPERVISORCODE_I OR SUPERVISOR > @SUPERVISOR ) ORDER BY SUPERVISOR ASC, SUPERVISORCODE_I ASC END ELSE BEGIN SELECT TOP 25  SUPERVISORCODE_I, SUPERVISOR, EMPLOYID, NOTEINDX, CHANGEBY_I, CHANGEDATE_I, DEX_ROW_ID FROM .UPR41700 WHERE SUPERVISOR BETWEEN @SUPERVISOR_RS AND @SUPERVISOR_RE AND SUPERVISORCODE_I BETWEEN @SUPERVISORCODE_I_RS AND @SUPERVISORCODE_I_RE AND ( SUPERVISOR = @SUPERVISOR AND SUPERVISORCODE_I > @SUPERVISORCODE_I OR SUPERVISOR > @SUPERVISOR ) ORDER BY SUPERVISOR ASC, SUPERVISORCODE_I ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_UPR41700N_2] TO [DYNGRP]
GO
