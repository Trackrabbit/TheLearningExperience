SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE PROC [dbo].[zDP_MS273527L_1] (@CUSTNMBR_RS char(15), @MSO_CardNumberPABP_RS char(165), @MSO_CardExpDate_RS char(5), @CUSTNMBR_RE char(15), @MSO_CardNumberPABP_RE char(165), @MSO_CardExpDate_RE char(5)) AS /* 12.00.0311.000 */ set nocount on IF @CUSTNMBR_RS IS NULL BEGIN SELECT TOP 25  CUSTNMBR, MSO_CardName, MSO_CardNumberPABP, MSO_CardExpDate, MSO_CardType, MSO_Issue_Number, MSO_Start_Date, ADRSCODE, FRSTNAME, MIDLNAME, LASTNAME, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, COUNTRY, ZIPCODE, EMail, PHONNAME, MSO_DESC_PABP, MSO_DESC1_PABP, MSO_DESC2_PABP, MSO_DESC3_PABP, MSO_DESC4_PABP, MSO_COMMENT1, MSO_COMMENT2, MSO_COMMENT3, MSO_COMMENT4, MSO_COMMENT5, MSO_Check_Number, MSO_ABA, MSO_AcctType, MSO_Default_ACH, MSO_DLicense, MSO_ACCT, MSO_BankName, MSO_DateOfBirth, MSO_SSN, DEX_ROW_ID FROM .MS273527 ORDER BY CUSTNMBR DESC, MSO_CardNumberPABP DESC, MSO_CardExpDate DESC END ELSE IF @CUSTNMBR_RS = @CUSTNMBR_RE BEGIN SELECT TOP 25  CUSTNMBR, MSO_CardName, MSO_CardNumberPABP, MSO_CardExpDate, MSO_CardType, MSO_Issue_Number, MSO_Start_Date, ADRSCODE, FRSTNAME, MIDLNAME, LASTNAME, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, COUNTRY, ZIPCODE, EMail, PHONNAME, MSO_DESC_PABP, MSO_DESC1_PABP, MSO_DESC2_PABP, MSO_DESC3_PABP, MSO_DESC4_PABP, MSO_COMMENT1, MSO_COMMENT2, MSO_COMMENT3, MSO_COMMENT4, MSO_COMMENT5, MSO_Check_Number, MSO_ABA, MSO_AcctType, MSO_Default_ACH, MSO_DLicense, MSO_ACCT, MSO_BankName, MSO_DateOfBirth, MSO_SSN, DEX_ROW_ID FROM .MS273527 WHERE CUSTNMBR = @CUSTNMBR_RS AND MSO_CardNumberPABP BETWEEN @MSO_CardNumberPABP_RS AND @MSO_CardNumberPABP_RE AND MSO_CardExpDate BETWEEN @MSO_CardExpDate_RS AND @MSO_CardExpDate_RE ORDER BY CUSTNMBR DESC, MSO_CardNumberPABP DESC, MSO_CardExpDate DESC END ELSE BEGIN SELECT TOP 25  CUSTNMBR, MSO_CardName, MSO_CardNumberPABP, MSO_CardExpDate, MSO_CardType, MSO_Issue_Number, MSO_Start_Date, ADRSCODE, FRSTNAME, MIDLNAME, LASTNAME, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, COUNTRY, ZIPCODE, EMail, PHONNAME, MSO_DESC_PABP, MSO_DESC1_PABP, MSO_DESC2_PABP, MSO_DESC3_PABP, MSO_DESC4_PABP, MSO_COMMENT1, MSO_COMMENT2, MSO_COMMENT3, MSO_COMMENT4, MSO_COMMENT5, MSO_Check_Number, MSO_ABA, MSO_AcctType, MSO_Default_ACH, MSO_DLicense, MSO_ACCT, MSO_BankName, MSO_DateOfBirth, MSO_SSN, DEX_ROW_ID FROM .MS273527 WHERE CUSTNMBR BETWEEN @CUSTNMBR_RS AND @CUSTNMBR_RE AND MSO_CardNumberPABP BETWEEN @MSO_CardNumberPABP_RS AND @MSO_CardNumberPABP_RE AND MSO_CardExpDate BETWEEN @MSO_CardExpDate_RS AND @MSO_CardExpDate_RE ORDER BY CUSTNMBR DESC, MSO_CardNumberPABP DESC, MSO_CardExpDate DESC END set nocount off 
GO
GRANT EXECUTE ON  [dbo].[zDP_MS273527L_1] TO [DYNGRP]
GO
