SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SVC00203N_10] (@BS int, @SRVRECTYPE smallint, @CALLNBR char(11), @TECHID char(11), @EQPLINE int, @LINITMTYP char(3), @CMPNTSEQ int, @LNITMSEQ int, @SRVRECTYPE_RS smallint, @CALLNBR_RS char(11), @TECHID_RS char(11), @EQPLINE_RS int, @LINITMTYP_RS char(3), @CMPNTSEQ_RS int, @LNITMSEQ_RS int, @SRVRECTYPE_RE smallint, @CALLNBR_RE char(11), @TECHID_RE char(11), @EQPLINE_RE int, @LINITMTYP_RE char(3), @CMPNTSEQ_RE int, @LNITMSEQ_RE int) AS  set nocount on IF @SRVRECTYPE_RS IS NULL BEGIN SELECT TOP 25  SRVRECTYPE, CALLNBR, EQPLINE, LNITMSEQ, LINITMTYP, SRVSTAT, TECHID, ITEMNMBR, ITEMUSETYPE, ITEMDESC, LOCNCODE, UOFM, QTYORDER, ATYALLOC, QTYBACKO, QTYSOLD, UNITCOST, UNITPRCE, EXTDCOST, XTNDPRCE, NOTEINDX, STRTDATE, STRTTIME, ENDDATE, ENDTME, TRANSTME, BILLABLTIM, TRNSFLOC, TRNSFQTY, TRNFLAG, ORDDOCID, TRANSLINESEQ, LABPCT, PARTPCT, MISCPCT, FUFILDAT, PONMBRSTR, POLNSEQ, On_Return, RETDOCID, LNSEQNBR, Miles_Start, Miles_End, Miles_Used, PRICELVL, SVC_Address_Option, SVC_Misc_Address_Code, SVC_Disable_XFR_Grouping, Work_Type, ORUNTCST, ORUNTPRC, OREXTCST, OXTNDPRC, TAXAMNT, ORTAXAMT, SVC_FO_ID, svcCreateVoucher, VCHRNMBR, CMPNTSEQ, CMPITQTY, DEX_ROW_ID FROM .SVC00203 WHERE ( SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID = @TECHID AND EQPLINE = @EQPLINE AND LINITMTYP = @LINITMTYP AND CMPNTSEQ = @CMPNTSEQ AND LNITMSEQ > @LNITMSEQ OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID = @TECHID AND EQPLINE = @EQPLINE AND LINITMTYP = @LINITMTYP AND CMPNTSEQ > @CMPNTSEQ OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID = @TECHID AND EQPLINE = @EQPLINE AND LINITMTYP > @LINITMTYP OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID = @TECHID AND EQPLINE > @EQPLINE OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID > @TECHID OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR > @CALLNBR OR SRVRECTYPE > @SRVRECTYPE ) ORDER BY SRVRECTYPE ASC, CALLNBR ASC, TECHID ASC, EQPLINE ASC, LINITMTYP ASC, CMPNTSEQ ASC, LNITMSEQ ASC END ELSE IF @SRVRECTYPE_RS = @SRVRECTYPE_RE BEGIN SELECT TOP 25  SRVRECTYPE, CALLNBR, EQPLINE, LNITMSEQ, LINITMTYP, SRVSTAT, TECHID, ITEMNMBR, ITEMUSETYPE, ITEMDESC, LOCNCODE, UOFM, QTYORDER, ATYALLOC, QTYBACKO, QTYSOLD, UNITCOST, UNITPRCE, EXTDCOST, XTNDPRCE, NOTEINDX, STRTDATE, STRTTIME, ENDDATE, ENDTME, TRANSTME, BILLABLTIM, TRNSFLOC, TRNSFQTY, TRNFLAG, ORDDOCID, TRANSLINESEQ, LABPCT, PARTPCT, MISCPCT, FUFILDAT, PONMBRSTR, POLNSEQ, On_Return, RETDOCID, LNSEQNBR, Miles_Start, Miles_End, Miles_Used, PRICELVL, SVC_Address_Option, SVC_Misc_Address_Code, SVC_Disable_XFR_Grouping, Work_Type, ORUNTCST, ORUNTPRC, OREXTCST, OXTNDPRC, TAXAMNT, ORTAXAMT, SVC_FO_ID, svcCreateVoucher, VCHRNMBR, CMPNTSEQ, CMPITQTY, DEX_ROW_ID FROM .SVC00203 WHERE SRVRECTYPE = @SRVRECTYPE_RS AND CALLNBR BETWEEN @CALLNBR_RS AND @CALLNBR_RE AND TECHID BETWEEN @TECHID_RS AND @TECHID_RE AND EQPLINE BETWEEN @EQPLINE_RS AND @EQPLINE_RE AND LINITMTYP BETWEEN @LINITMTYP_RS AND @LINITMTYP_RE AND CMPNTSEQ BETWEEN @CMPNTSEQ_RS AND @CMPNTSEQ_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE AND ( SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID = @TECHID AND EQPLINE = @EQPLINE AND LINITMTYP = @LINITMTYP AND CMPNTSEQ = @CMPNTSEQ AND LNITMSEQ > @LNITMSEQ OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID = @TECHID AND EQPLINE = @EQPLINE AND LINITMTYP = @LINITMTYP AND CMPNTSEQ > @CMPNTSEQ OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID = @TECHID AND EQPLINE = @EQPLINE AND LINITMTYP > @LINITMTYP OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID = @TECHID AND EQPLINE > @EQPLINE OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID > @TECHID OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR > @CALLNBR OR SRVRECTYPE > @SRVRECTYPE ) ORDER BY SRVRECTYPE ASC, CALLNBR ASC, TECHID ASC, EQPLINE ASC, LINITMTYP ASC, CMPNTSEQ ASC, LNITMSEQ ASC END ELSE BEGIN SELECT TOP 25  SRVRECTYPE, CALLNBR, EQPLINE, LNITMSEQ, LINITMTYP, SRVSTAT, TECHID, ITEMNMBR, ITEMUSETYPE, ITEMDESC, LOCNCODE, UOFM, QTYORDER, ATYALLOC, QTYBACKO, QTYSOLD, UNITCOST, UNITPRCE, EXTDCOST, XTNDPRCE, NOTEINDX, STRTDATE, STRTTIME, ENDDATE, ENDTME, TRANSTME, BILLABLTIM, TRNSFLOC, TRNSFQTY, TRNFLAG, ORDDOCID, TRANSLINESEQ, LABPCT, PARTPCT, MISCPCT, FUFILDAT, PONMBRSTR, POLNSEQ, On_Return, RETDOCID, LNSEQNBR, Miles_Start, Miles_End, Miles_Used, PRICELVL, SVC_Address_Option, SVC_Misc_Address_Code, SVC_Disable_XFR_Grouping, Work_Type, ORUNTCST, ORUNTPRC, OREXTCST, OXTNDPRC, TAXAMNT, ORTAXAMT, SVC_FO_ID, svcCreateVoucher, VCHRNMBR, CMPNTSEQ, CMPITQTY, DEX_ROW_ID FROM .SVC00203 WHERE SRVRECTYPE BETWEEN @SRVRECTYPE_RS AND @SRVRECTYPE_RE AND CALLNBR BETWEEN @CALLNBR_RS AND @CALLNBR_RE AND TECHID BETWEEN @TECHID_RS AND @TECHID_RE AND EQPLINE BETWEEN @EQPLINE_RS AND @EQPLINE_RE AND LINITMTYP BETWEEN @LINITMTYP_RS AND @LINITMTYP_RE AND CMPNTSEQ BETWEEN @CMPNTSEQ_RS AND @CMPNTSEQ_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE AND ( SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID = @TECHID AND EQPLINE = @EQPLINE AND LINITMTYP = @LINITMTYP AND CMPNTSEQ = @CMPNTSEQ AND LNITMSEQ > @LNITMSEQ OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID = @TECHID AND EQPLINE = @EQPLINE AND LINITMTYP = @LINITMTYP AND CMPNTSEQ > @CMPNTSEQ OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID = @TECHID AND EQPLINE = @EQPLINE AND LINITMTYP > @LINITMTYP OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID = @TECHID AND EQPLINE > @EQPLINE OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR = @CALLNBR AND TECHID > @TECHID OR SRVRECTYPE = @SRVRECTYPE AND CALLNBR > @CALLNBR OR SRVRECTYPE > @SRVRECTYPE ) ORDER BY SRVRECTYPE ASC, CALLNBR ASC, TECHID ASC, EQPLINE ASC, LINITMTYP ASC, CMPNTSEQ ASC, LNITMSEQ ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SVC00203N_10] TO [DYNGRP]
GO
