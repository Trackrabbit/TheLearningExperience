SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IV50300N_2] (@BS int, @RANKINGVALUE numeric(19,5), @ITEMNMBR char(31), @RANKINGVALUE_RS numeric(19,5), @ITEMNMBR_RS char(31), @RANKINGVALUE_RE numeric(19,5), @ITEMNMBR_RE char(31)) AS  set nocount on IF @RANKINGVALUE_RS IS NULL BEGIN SELECT TOP 25  ITEMNMBR, ITEMDESC, ITEMTYPE, ABCCODE, SGGSTDABCCD, INCLUDEITEM, QTYONHND, PRCNTOFTTL, CMLTVPRCNTOFTTL, CMLTVPRCNTOFITMS, UNITCOST, RANKINGVALUE, SMMRYDPNDNTUSGQTY, DECPLQTY, DECPLCUR, UPDATED, DEX_ROW_ID FROM .IV50300 WHERE ( RANKINGVALUE = @RANKINGVALUE AND ITEMNMBR > @ITEMNMBR OR RANKINGVALUE < @RANKINGVALUE ) ORDER BY RANKINGVALUE DESC, ITEMNMBR ASC END ELSE IF @RANKINGVALUE_RS = @RANKINGVALUE_RE BEGIN SELECT TOP 25  ITEMNMBR, ITEMDESC, ITEMTYPE, ABCCODE, SGGSTDABCCD, INCLUDEITEM, QTYONHND, PRCNTOFTTL, CMLTVPRCNTOFTTL, CMLTVPRCNTOFITMS, UNITCOST, RANKINGVALUE, SMMRYDPNDNTUSGQTY, DECPLQTY, DECPLCUR, UPDATED, DEX_ROW_ID FROM .IV50300 WHERE RANKINGVALUE = @RANKINGVALUE_RE AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND ( RANKINGVALUE = @RANKINGVALUE AND ITEMNMBR > @ITEMNMBR OR RANKINGVALUE < @RANKINGVALUE ) ORDER BY RANKINGVALUE DESC, ITEMNMBR ASC END ELSE BEGIN SELECT TOP 25  ITEMNMBR, ITEMDESC, ITEMTYPE, ABCCODE, SGGSTDABCCD, INCLUDEITEM, QTYONHND, PRCNTOFTTL, CMLTVPRCNTOFTTL, CMLTVPRCNTOFITMS, UNITCOST, RANKINGVALUE, SMMRYDPNDNTUSGQTY, DECPLQTY, DECPLCUR, UPDATED, DEX_ROW_ID FROM .IV50300 WHERE RANKINGVALUE BETWEEN @RANKINGVALUE_RE AND @RANKINGVALUE_RS AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND ( RANKINGVALUE = @RANKINGVALUE AND ITEMNMBR > @ITEMNMBR OR RANKINGVALUE < @RANKINGVALUE ) ORDER BY RANKINGVALUE DESC, ITEMNMBR ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IV50300N_2] TO [DYNGRP]
GO
