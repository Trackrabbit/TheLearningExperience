SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_MC60400N_2] (@BS int, @ENABLED tinyint, @DENOMCURR char(15), @ENABLED_RS tinyint, @DENOMCURR_RS char(15), @ENABLED_RE tinyint, @DENOMCURR_RE char(15)) AS  set nocount on IF @ENABLED_RS IS NULL BEGIN SELECT TOP 25  DENOMCURR, ENABLED, USERID, REALGAIN, REALLOSS, PSTGDATE, DEX_ROW_ID FROM .MC60400 WHERE ( ENABLED = @ENABLED AND DENOMCURR > @DENOMCURR OR ENABLED > @ENABLED ) ORDER BY ENABLED ASC, DENOMCURR ASC END ELSE IF @ENABLED_RS = @ENABLED_RE BEGIN SELECT TOP 25  DENOMCURR, ENABLED, USERID, REALGAIN, REALLOSS, PSTGDATE, DEX_ROW_ID FROM .MC60400 WHERE ENABLED = @ENABLED_RS AND DENOMCURR BETWEEN @DENOMCURR_RS AND @DENOMCURR_RE AND ( ENABLED = @ENABLED AND DENOMCURR > @DENOMCURR OR ENABLED > @ENABLED ) ORDER BY ENABLED ASC, DENOMCURR ASC END ELSE BEGIN SELECT TOP 25  DENOMCURR, ENABLED, USERID, REALGAIN, REALLOSS, PSTGDATE, DEX_ROW_ID FROM .MC60400 WHERE ENABLED BETWEEN @ENABLED_RS AND @ENABLED_RE AND DENOMCURR BETWEEN @DENOMCURR_RS AND @DENOMCURR_RE AND ( ENABLED = @ENABLED AND DENOMCURR > @DENOMCURR OR ENABLED > @ENABLED ) ORDER BY ENABLED ASC, DENOMCURR ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_MC60400N_2] TO [DYNGRP]
GO
