SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[rmCustomerModifier]   @I_charStartCustomer varchar(30),  @I_charEndCustomer varchar(30),  @O_iErrorState int = NULL output  as  set transaction isolation level read uncommitted set nocount on  declare @LEN1 tinyint,  @LEN2 tinyint,  @BALNCTYP int,  @CUSTNMBR char(255),  @tTransaction tinyint,  @tLoop tinyint,  @iStatus int,  @cStartCustomer char(50),  @cEndCustomer char(50)  select  @LEN1 = 0,  @LEN2 = 0,  @BALNCTYP = 0 exec @iStatus = smFormatStringsForExecs  @I_vInputString  = @I_charStartCustomer,  @O_cOutputString = @cStartCustomer output,  @O_iErrorState  = @O_iErrorState output  if @iStatus <> 0 or @O_iErrorState <> 0 begin  set @O_iErrorState = 90  return end  exec @iStatus = smFormatStringsForExecs  @I_vInputString  = @I_charEndCustomer,  @O_cOutputString = @cEndCustomer output,  @O_iErrorState  = @O_iErrorState output  if @iStatus <> 0 or @O_iErrorState <> 0 begin  set @O_iErrorState = 90  return end  select @O_iErrorState   = 0  if @@trancount = 0 begin  select @tTransaction = 1  begin transaction end  while ( @tLoop is NULL ) begin  select @tLoop = 1   exec @iStatus = rmCustomerModifierPre  @I_charStartCustomer output,  @I_charEndCustomer output,  @cStartCustomer output,  @cEndCustomer output,  @O_iErrorState output  if @O_iErrorState <> 0   begin  break  end   if @I_charStartCustomer is NULL or  @I_charEndCustomer is NULL or  @cStartCustomer is NULL or  @cEndCustomer is NULL  begin  select @O_iErrorState = 1   break  end    if exists (select * from sysobjects where name = 'RM_Customer_MSTR_NA')  ALTER TABLE dbo.RM00101  DROP CONSTRAINT RM_Customer_MSTR_NA   if @@error <> 0   begin  select @O_iErrorState = 2   break  end   if exists (select * from sysobjects where name = 'RM_NationalAccounts_MSTR_FKC')  ALTER TABLE dbo.RM00105   DROP CONSTRAINT RM_NationalAccounts_MSTR_FKC  if @@error <> 0  begin  select @O_iErrorState = 3   break  end   if exists (select * from sysobjects where id = object_id('dbo.taCustomerInsert'))  alter table RM00101 disable trigger taCustomerInsert  if @@error <> 0   begin  select @O_iErrorState = 4   break  end   if exists (select * from sysobjects where id = object_id('dbo.taCustomerAddressInsert'))  alter table RM00102 disable trigger taCustomerAddressInsert  if @@error <> 0   begin  select @O_iErrorState = 5   break  end   if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_Cust_Ext_U'))  alter table RM00102 disable trigger tr_SVC_Cust_Ext_U  if @@error <> 0   begin  select @O_iErrorState = 40   break  end   if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_RM00102_D'))  alter table RM00102 disable trigger tr_SVC_RM00102_D  if @@error <> 0   begin  select @O_iErrorState = 41   break  end   if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_SVC00601_IUD'))  alter table SVC00601 disable trigger tr_SVC_SVC00601_IUD  if @@error <> 0   begin  select @O_iErrorState = 42   break  end   select @BALNCTYP = BALNCTYP from RM00101 where CUSTNMBR = @I_charStartCustomer   if @BALNCTYP = 1  begin  if LEN(@I_charEndCustomer) > LEN(@I_charStartCustomer)  select @LEN1 = ( LEN(@I_charEndCustomer) - LEN(@I_charStartCustomer) )  else if LEN(@I_charEndCustomer) < LEN(@I_charStartCustomer)  select @LEN2 = ( LEN(@I_charStartCustomer) - LEN(@I_charEndCustomer) )   update RM20101 set CUSTNMBR = @I_charEndCustomer, DOCNUMBR =  rtrim(@I_charEndCustomer)+  '^'+  replicate('0',@LEN2)+  substring(rtrim(DOCNUMBR),LEN(@I_charStartCustomer)+2 + @LEN1,20)  where CUSTNMBR = @I_charStartCustomer and RMDTYPAL = 0  if @@error <> 0   begin  select @O_iErrorState = 31   break  end   update RM00401 set CUSTNMBR = @I_charEndCustomer, DOCNUMBR =  rtrim(@I_charEndCustomer)+  '^'+  replicate('0',@LEN2)+  substring(rtrim(DOCNUMBR),LEN(@I_charStartCustomer)+2 + @LEN1,20)  where CUSTNMBR = @I_charStartCustomer and RMDTYPAL = 0  if @@error <> 0   begin  select @O_iErrorState = 32   break  end   update RM30101 set CUSTNMBR = @I_charEndCustomer, DOCNUMBR =  rtrim(@I_charEndCustomer)+  '^'+  replicate('0',@LEN2)+  substring(rtrim(DOCNUMBR),LEN(@I_charStartCustomer)+2 + @LEN1,20),  BALFWDNM =   rtrim(@I_charEndCustomer)+  '^'+  replicate('0',@LEN2)+  substring(rtrim(BALFWDNM),LEN(@I_charStartCustomer)+2 + @LEN1,20)  where CUSTNMBR = @I_charStartCustomer and RMDTYPAL = 0  if @@error <> 0   begin  select @O_iErrorState = 33   break  end   update RM30101 set CUSTNMBR = @I_charEndCustomer, BALFWDNM =  rtrim(@I_charEndCustomer)+  '^'+  replicate('0',@LEN2)+  substring(rtrim(BALFWDNM),LEN(@I_charStartCustomer)+2 + @LEN1,20)  where CUSTNMBR = @I_charStartCustomer and RMDTYPAL <> 0  if @@error <> 0   begin  select @O_iErrorState = 34   break  end  end   insert into RM00101  (CUSTNMBR,CUSTNAME,CUSTCLAS,CPRCSTNM,CNTCPRSN,STMTNAME,  SHRTNAME,ADRSCODE,UPSZONE,SHIPMTHD,TAXSCHID,ADDRESS1,  ADDRESS2,ADDRESS3,COUNTRY,CITY,STATE,ZIP,  PHONE1,PHONE2,PHONE3,FAX,PRBTADCD,PRSTADCD,  STADDRCD,SLPRSNID,CHEKBKID,PYMTRMID,CRLMTTYP,CRLMTAMT,  CRLMTPER,CRLMTPAM,CURNCYID,RATETPID,CUSTDISC,PRCLEVEL,  MINPYTYP,MINPYDLR,MINPYPCT,FNCHATYP,FNCHPCNT,FINCHDLR,  MXWOFTYP,MXWROFAM,COMMENT1,COMMENT2,USERDEF1,USERDEF2,  TAXEXMT1,TAXEXMT2,TXRGNNUM,BALNCTYP,STMTCYCL,BANKNAME,  BNKBRNCH,SALSTERR,DEFCACTY,RMCSHACC,RMARACC,RMSLSACC,  RMIVACC,RMCOSACC,RMTAKACC,RMAVACC,RMFCGACC,RMWRACC,  RMSORACC,FRSTINDT,INACTIVE,HOLD,CRCARDID,CRCRDNUM,  CCRDXPDT,KPDSTHST,KPCALHST,KPERHIST,KPTRXHST,NOTEINDX,  CREATDDT,MODIFDT,Revalue_Customer,Post_Results_To,FINCHID,GOVCRPID,  GOVINDID,DISGRPER,DUEGRPER,DOCFMTID,Send_Email_Statements,USERLANG,  GPSFOINTEGRATIONID,INTEGRATIONSOURCE,INTEGRATIONID,ORDERFULFILLDEFAULT,  CUSTPRIORITY,CCode,DECLID,RMOvrpymtWrtoffAcctIdx,SHIPCOMPLETE,CBVAT,INCLUDEINDP)  select  @I_charEndCustomer,CUSTNAME,CUSTCLAS,CPRCSTNM,CNTCPRSN,STMTNAME,  SHRTNAME,ADRSCODE,UPSZONE,SHIPMTHD,TAXSCHID,ADDRESS1,  ADDRESS2,ADDRESS3,COUNTRY,CITY,STATE,ZIP,  PHONE1,PHONE2,PHONE3,FAX,PRBTADCD,PRSTADCD,  STADDRCD,SLPRSNID,CHEKBKID,PYMTRMID,CRLMTTYP,CRLMTAMT,  CRLMTPER,CRLMTPAM,CURNCYID,RATETPID,CUSTDISC,PRCLEVEL,  MINPYTYP,MINPYDLR,MINPYPCT,FNCHATYP,FNCHPCNT,FINCHDLR,  MXWOFTYP,MXWROFAM,COMMENT1,COMMENT2,USERDEF1,USERDEF2,  TAXEXMT1,TAXEXMT2,TXRGNNUM,BALNCTYP,STMTCYCL,BANKNAME,  BNKBRNCH,SALSTERR,DEFCACTY,RMCSHACC,RMARACC,RMSLSACC,  RMIVACC,RMCOSACC,RMTAKACC,RMAVACC,RMFCGACC,RMWRACC,  RMSORACC,FRSTINDT,INACTIVE,HOLD,CRCARDID,CRCRDNUM,  CCRDXPDT,KPDSTHST,KPCALHST,KPERHIST,KPTRXHST,NOTEINDX,  CREATDDT,MODIFDT,Revalue_Customer,Post_Results_To,FINCHID,GOVCRPID,  GOVINDID,DISGRPER,DUEGRPER,DOCFMTID,Send_Email_Statements,USERLANG,  GPSFOINTEGRATIONID,INTEGRATIONSOURCE,INTEGRATIONID,ORDERFULFILLDEFAULT,  CUSTPRIORITY,CCode,DECLID,RMOvrpymtWrtoffAcctIdx,SHIPCOMPLETE,CBVAT,INCLUDEINDP   from RM00101 where CUSTNMBR = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 35   break  end   delete RM00101 where CUSTNMBR = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 36   break  end   insert into RM00102  (CUSTNMBR,ADRSCODE,SLPRSNID,UPSZONE,SHIPMTHD,TAXSCHID,  CNTCPRSN,ADDRESS1,ADDRESS2,ADDRESS3,COUNTRY,CITY,  STATE,ZIP,PHONE1,PHONE2,PHONE3,FAX,MODIFDT,CREATDDT,  GPSFOINTEGRATIONID,INTEGRATIONSOURCE,INTEGRATIONID,  CCode,DECLID,LOCNCODE,SALSTERR,USERDEF1,USERDEF2)  select  @I_charEndCustomer,ADRSCODE,SLPRSNID,UPSZONE,SHIPMTHD,TAXSCHID,  CNTCPRSN,ADDRESS1,ADDRESS2,ADDRESS3,COUNTRY,CITY,  STATE,ZIP,PHONE1,PHONE2,PHONE3,FAX,MODIFDT,CREATDDT,  GPSFOINTEGRATIONID,INTEGRATIONSOURCE,INTEGRATIONID,  CCode,DECLID,LOCNCODE,SALSTERR,USERDEF1,USERDEF2  from RM00102 where CUSTNMBR = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 50   break  end   delete RM00102 where CUSTNMBR = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 51   break  end   declare ta_CMCursor insensitive CURSOR for select 'update ['+o.name+'] set CUSTNMBR =' + rtrim(@cEndCustomer) +  ' where CUSTNMBR = ' + rtrim(@cStartCustomer)  from sysobjects o, syscolumns c  where o.id = c.id  and o.type = 'U'  and c.name = 'CUSTNMBR'  and o.name <> 'SOP10100'  and o.name <> 'SOP30200'  and o.name <> 'RM00101'   and o.name <> 'RM00102'  and o.name <> 'DXPublish_Customer'  and o.name <> 'DXPublish_Customer_Work'  and o.name <> 'DXPublish_Address'  and o.name <> 'DXPublish_Address_Work'  order by o.name  set nocount on  OPEN ta_CMCursor  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  WHILE (@@FETCH_STATUS <> -1)  begin  exec (@CUSTNMBR)  if @@error <> 0   begin  select @O_iErrorState = 1   break  end  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  end  DEALLOCATE ta_CMCursor   if @O_iErrorState <> 0  break   declare ta_CMCursor insensitive CURSOR for select 'update ['+o.name+'] set STCUSTID =' + rtrim(@cEndCustomer) +  ' where STCUSTID = ' + rtrim(@cStartCustomer)  from sysobjects o, syscolumns c  where o.id = c.id  and o.type = 'U'  and c.name = 'STCUSTID'   order by o.name  set nocount on  OPEN ta_CMCursor  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  WHILE (@@FETCH_STATUS <> -1)  begin  exec (@CUSTNMBR)  if @@error <> 0   begin  select @O_iErrorState = 6   break  end  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  end  DEALLOCATE ta_CMCursor   if @O_iErrorState <> 0  break   declare ta_CMCursor insensitive CURSOR for select 'update ['+o.name+'] set ENCUSTID =' + rtrim(@cEndCustomer) +  ' where ENCUSTID = ' + rtrim(@cStartCustomer)  from sysobjects o, syscolumns c  where o.id = c.id  and o.type = 'U'  and c.name = 'ENCUSTID'  order by o.name  set nocount on  OPEN ta_CMCursor  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  WHILE (@@FETCH_STATUS <> -1)  begin  exec (@CUSTNMBR)  if @@error <> 0   begin  select @O_iErrorState = 7   break  end   FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  end  DEALLOCATE ta_CMCursor   if @O_iErrorState <> 0  break   declare ta_CMCursor insensitive CURSOR for select 'update ['+o.name+'] set CPRCSTNM =' + rtrim(@cEndCustomer) +  ' where CPRCSTNM = ' + rtrim(@cStartCustomer)  from sysobjects o, syscolumns c  where o.id = c.id  and o.type = 'U'  and c.name = 'CPRCSTNM'  order by o.name  set nocount on  OPEN ta_CMCursor  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  WHILE (@@FETCH_STATUS <> -1)  begin  exec (@CUSTNMBR)  if @@error <> 0   begin  select @O_iErrorState = 8   break  end   FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  end  DEALLOCATE ta_CMCursor   if @O_iErrorState <> 0  break   declare ta_CMCursor insensitive CURSOR for select 'update ['+o.name+'] set CustomerVendor_ID =' + rtrim(@cEndCustomer) +   ' where SERIES = 3 and CustomerVendor_ID = ' + rtrim(@cStartCustomer)  from sysobjects o, syscolumns c  where o.id = c.id  and o.type = 'U'  and c.name = 'CustomerVendor_ID'  and o.name <> 'TX30000'  and o.name <> 'EDCVAT26'  order by o.name  set nocount on  OPEN ta_CMCursor  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  WHILE (@@FETCH_STATUS <> -1)  begin  exec (@CUSTNMBR)  if @@error <> 0   begin  select @O_iErrorState = 9   break  end   FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  end  DEALLOCATE ta_CMCursor   if @O_iErrorState <> 0  break   declare ta_CMCursor insensitive CURSOR for select 'update ['+o.name+'] set Bill_To_Customer =' + rtrim(@cEndCustomer) +  ' where Bill_To_Customer = ' + rtrim(@cStartCustomer)   from sysobjects o, syscolumns c  where o.id = c.id  and o.type = 'U'  and c.name = 'Bill_To_Customer'  order by o.name  set nocount on  OPEN ta_CMCursor  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  WHILE (@@FETCH_STATUS <> -1)  begin  exec (@CUSTNMBR  )  if @@error <> 0   begin  select @O_iErrorState = 10   break  end   FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  end  DEALLOCATE ta_CMCursor   if @O_iErrorState <> 0  break   declare ta_CMCursor insensitive CURSOR for select 'update ['+o.name+'] set customer_id =' + (@cEndCustomer) +  ' where customer_id = ' + rtrim(@cStartCustomer)  from sysobjects o, syscolumns c  where o.id = c.id  and o.type = 'U'  and c.name = 'customer_id'  order by o.name  set nocount on  OPEN ta_CMCursor  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  WHILE (@@FETCH_STATUS <> -1)  begin  exec (@CUSTNMBR)  if @@error <> 0  begin  select @O_iErrorState = 11   break  end  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  end  DEALLOCATE ta_CMCursor   if @O_iErrorState <> 0  break   declare ta_CMCursor insensitive CURSOR for select 'update ['+o.name+'] set Bill_Customer_Number =' + (@cEndCustomer) +  ' where Bill_Customer_Number = ' + rtrim(@cStartCustomer)  from sysobjects o, syscolumns c  where o.id = c.id  and o.type = 'U'  and c.name = 'Bill_Customer_Number'  order by o.name  set nocount on  OPEN ta_CMCursor  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  WHILE (@@FETCH_STATUS <> -1)  begin  exec (@CUSTNMBR)  if @@error <> 0  begin  select @O_iErrorState = 12   break  end  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  end  DEALLOCATE ta_CMCursor   if @O_iErrorState <> 0  break   declare ta_CMCursor insensitive CURSOR for select 'update ['+o.name+'] set LINKCODE =' + (@cEndCustomer) +  ' where PRODTCOD = ''C'' and LINKCODE = ' + rtrim(@cStartCustomer)  from sysobjects o, syscolumns c, syscolumns c2  where o.id = c.id  and o.type = 'U'  and c.name = 'LINKCODE'  and c.id = c2.id  and c2.name = 'PRODTCOD'  order by o.name  set nocount on  OPEN ta_CMCursor  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  WHILE (@@FETCH_STATUS <> -1)  begin  exec (@CUSTNMBR)  if @@error <> 0  begin  select @O_iErrorState = 39   break  end  FETCH NEXT FROM ta_CMCursor INTO @CUSTNMBR  end  DEALLOCATE ta_CMCursor   if @O_iErrorState <> 0  break   declare ta_CCCursor insensitive CURSOR for select 'update ['+o.name+'] set aaCustID='+rtrim(@cEndCustomer) +  ' where aaCustID='+rtrim(@cStartCustomer)  from sysobjects o, syscolumns c  where o.id=c.id  and o.type='U'  and c.name='aaCustID'   order by o.name  set nocount on  OPEN ta_CCCursor  FETCH NEXT FROM ta_CCCursor INTO @CUSTNMBR  WHILE (@@FETCH_STATUS<>-1)  begin  exec (@CUSTNMBR)  if @@error<>0  begin  select @O_iErrorState=88   break  end   FETCH NEXT FROM ta_CCCursor INTO @CUSTNMBR  end  DEALLOCATE ta_CCCursor   if @O_iErrorState<>0  break   update a set ORMSTRID = @I_charEndCustomer from GL10001 a, GL10000 b  where  a.ORMSTRID = @I_charStartCustomer and  a.JRNENTRY = b.JRNENTRY and  b.SERIES = 3  if @@error <> 0  begin  select @O_iErrorState = 13   break  end   update GL20000 set ORMSTRID = @I_charEndCustomer where ORMSTRID = @I_charStartCustomer and SERIES = 3  if @@error <> 0   begin  select @O_iErrorState = 14   break  end   update GL30000 set ORMSTRID = @I_charEndCustomer where ORMSTRID = @I_charStartCustomer and SERIES = 3  if @@error <> 0   begin  select @O_iErrorState = 15   break  end   update PJOURNAL set ORMSTRID = @I_charEndCustomer where ORMSTRID = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 16   break  end   update CM20200 set CMLinkID = @I_charEndCustomer where CMLinkID = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 17   break  end   update CM20300 set CMLinkID = @I_charEndCustomer where CMLinkID = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 18   break  end   update TX30000 set CustomerVendor_ID = @I_charEndCustomer where CustomerVendor_ID = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 218   break  end   if exists(select 1 from sysobjects (nolock) where name = 'EDCVAT26' and type = 'U')  begin  update EDCVAT26 set CustomerVendor_ID = @I_charEndCustomer where CustomerVendor_ID = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 219   break  end  end  update MC10000 set StartCustOrVendID = @I_charEndCustomer where StartCustOrVendID = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 19   break  end   update MC10000 set EndCustOrVendID = @I_charEndCustomer where EndCustOrVendID = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 20   break  end   if exists (select * from sysobjects where id = object_id('dbo.PP100100')  and sysstat & 0xf = 3)  begin  update PP100100 set CUSTVNDR = @I_charEndCustomer where CUSTVNDR = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 204   break  end  end   if exists (select * from sysobjects where id = object_id('dbo.PA50105') and sysstat & 0xf = 3)  begin  update PA50105 set CustVenID = @I_charEndCustomer where CustVenID = @I_charStartCustomer  if @@error <> 0   begin  select @O_iErrorState = 21   break  end  end   update SOP10100 set CUSTNMBR = @I_charEndCustomer where CUSTNMBR = @I_charStartCustomer and PROSPECT = 0  if @@error <> 0   begin  select @O_iErrorState = 22   break  end   update SOP30200 set CUSTNMBR = @I_charEndCustomer where CUSTNMBR = @I_charStartCustomer and PROSPECT = 0  if @@error <> 0   begin  select @O_iErrorState = 23   break  end   update SY01200 set Master_ID = @I_charEndCustomer where Master_ID = @I_charStartCustomer and Master_Type = 'CUS'  if @@error <> 0   begin  select @O_iErrorState = 24   break  end   if exists (select * from sysobjects where id = object_id('dbo.PA01901') and sysstat & 0xf = 3)  begin  update PA01901 set PACOSTOWNER = @I_charEndCustomer where PACOSTOWNER = @I_charStartCustomer and (PATranType = 7 or PATranType = 10)  if @@error <> 0   begin  select @O_iErrorState = 25   break  end  end   if exists (select * from sysobjects where id = object_id('dbo.PA43001') and sysstat & 0xf = 3)  begin  update PA43001 set PArecordid = @I_charEndCustomer where PArecordid = @I_charStartCustomer and (PAsfid = 21 or PAsfid = 36)  if @@error <> 0   begin  select @O_iErrorState = 26   break  end  end   if @O_iErrorState <> 0  break  end   ALTER TABLE dbo.RM00101 WITH NOCHECK   ADD CONSTRAINT RM_Customer_MSTR_NA CHECK   ((CPRCSTNM <> '' AND BALNCTYP = 0) or   (CPRCSTNM = '' AND BALNCTYP = 1) or   (CPRCSTNM = '' AND BALNCTYP = 0)) if @@error <> 0  begin  select @O_iErrorState = 27  end  ALTER TABLE dbo.RM00105 WITH NOCHECK   ADD CONSTRAINT RM_NationalAccounts_MSTR_FKC FOREIGN KEY   (CPRCSTNM) REFERENCES dbo.RM00101 (CUSTNMBR) if @@error <> 0  begin  select @O_iErrorState = 28  end   if exists (select * from sysobjects where id = object_id('dbo.taCustomerInsert'))  alter table RM00101 enable trigger taCustomerInsert if @@error <> 0  begin  select @O_iErrorState = 29  end  if exists (select * from sysobjects where id = object_id('dbo.taCustomerAddressInsert')) alter table RM00102 enable trigger taCustomerAddressInsert if @@error <> 0  begin  select @O_iErrorState = 30  end  if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_Cust_Ext_U')) alter table RM00102 enable trigger tr_SVC_Cust_Ext_U if @@error <> 0  begin  select @O_iErrorState = 38  end  if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_RM00102_D')) alter table RM00102 enable trigger tr_SVC_RM00102_D if @@error <> 0  begin  select @O_iErrorState = 43  end  if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_SVC00601_IUD')) alter table SVC00601 enable trigger tr_SVC_SVC00601_IUD if @@error <> 0  begin  select @O_iErrorState = 44  end  exec @iStatus = rmCustomerModifierPost  @I_charStartCustomer,  @I_charEndCustomer,  @cStartCustomer,  @cEndCustomer,  @O_iErrorState  if @O_iErrorState <> 0 begin  if @tTransaction = 1  rollback transaction end else if @tTransaction = 1 begin  commit transaction end  return   
GO
GRANT EXECUTE ON  [dbo].[rmCustomerModifier] TO [DYNGRP]
GO
