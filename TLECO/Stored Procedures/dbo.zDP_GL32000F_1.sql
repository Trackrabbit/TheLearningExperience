SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_GL32000F_1] (@JRNENTRY_RS int, @BUDGETID_RS char(15), @ACTINDX_RS int, @PERIODDT_RS datetime, @PERIODID_RS smallint, @JRNENTRY_RE int, @BUDGETID_RE char(15), @ACTINDX_RE int, @PERIODDT_RE datetime, @PERIODID_RE smallint) AS  set nocount on IF @JRNENTRY_RS IS NULL BEGIN SELECT TOP 25  JRNENTRY, BUDGETID, YEAR1, PERIODDT, PERIODID, ACTINDX, BUDGETAMT, BudgerAdjustment, REFRENCE, TRXDATE, SOURCDOC, TRXSORCE, USWHPSTD, NOTEINDX, DEX_ROW_TS, DEX_ROW_ID FROM .GL32000 ORDER BY JRNENTRY ASC, BUDGETID ASC, ACTINDX ASC, PERIODDT ASC, PERIODID ASC END ELSE IF @JRNENTRY_RS = @JRNENTRY_RE BEGIN SELECT TOP 25  JRNENTRY, BUDGETID, YEAR1, PERIODDT, PERIODID, ACTINDX, BUDGETAMT, BudgerAdjustment, REFRENCE, TRXDATE, SOURCDOC, TRXSORCE, USWHPSTD, NOTEINDX, DEX_ROW_TS, DEX_ROW_ID FROM .GL32000 WHERE JRNENTRY = @JRNENTRY_RS AND BUDGETID BETWEEN @BUDGETID_RS AND @BUDGETID_RE AND ACTINDX BETWEEN @ACTINDX_RS AND @ACTINDX_RE AND PERIODDT BETWEEN @PERIODDT_RS AND @PERIODDT_RE AND PERIODID BETWEEN @PERIODID_RS AND @PERIODID_RE ORDER BY JRNENTRY ASC, BUDGETID ASC, ACTINDX ASC, PERIODDT ASC, PERIODID ASC END ELSE BEGIN SELECT TOP 25  JRNENTRY, BUDGETID, YEAR1, PERIODDT, PERIODID, ACTINDX, BUDGETAMT, BudgerAdjustment, REFRENCE, TRXDATE, SOURCDOC, TRXSORCE, USWHPSTD, NOTEINDX, DEX_ROW_TS, DEX_ROW_ID FROM .GL32000 WHERE JRNENTRY BETWEEN @JRNENTRY_RS AND @JRNENTRY_RE AND BUDGETID BETWEEN @BUDGETID_RS AND @BUDGETID_RE AND ACTINDX BETWEEN @ACTINDX_RS AND @ACTINDX_RE AND PERIODDT BETWEEN @PERIODDT_RS AND @PERIODDT_RE AND PERIODID BETWEEN @PERIODID_RS AND @PERIODID_RE ORDER BY JRNENTRY ASC, BUDGETID ASC, ACTINDX ASC, PERIODDT ASC, PERIODID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_GL32000F_1] TO [DYNGRP]
GO
