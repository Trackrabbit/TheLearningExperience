SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_POP10500N_3] (@BS int, @PONUMBER char(17), @VENDORID char(15), @Status smallint, @ITEMNMBR char(31), @UOFM char(9), @APPYTYPE smallint, @POPRCTNM char(17), @RCPTLNNM int, @DEX_ROW_ID int, @PONUMBER_RS char(17), @VENDORID_RS char(15), @Status_RS smallint, @ITEMNMBR_RS char(31), @UOFM_RS char(9), @APPYTYPE_RS smallint, @POPRCTNM_RS char(17), @RCPTLNNM_RS int, @PONUMBER_RE char(17), @VENDORID_RE char(15), @Status_RE smallint, @ITEMNMBR_RE char(31), @UOFM_RE char(9), @APPYTYPE_RE smallint, @POPRCTNM_RE char(17), @RCPTLNNM_RE int) AS  set nocount on IF @PONUMBER_RS IS NULL BEGIN SELECT TOP 25  PONUMBER, POLNENUM, POPRCTNM, RCPTLNNM, QTYSHPPD, QTYINVCD, QTYREJ, QTYMATCH, QTYRESERVED, QTYINVRESERVE, Status, UMQTYINB, OLDCUCST, JOBNUMBR, COSTCODE, COSTTYPE, ORCPTCOST, OSTDCOST, APPYTYPE, POPTYPE, VENDORID, ITEMNMBR, UOFM, TRXLOCTN, DATERECD, RCTSEQNM, SPRCTSEQ, PCHRPTCT, SPRCPTCT, OREXTCST, RUPPVAMT, ACPURIDX, INVINDX, UPPVIDX, NOTEINDX, CURNCYID, CURRNIDX, XCHGRATE, RATECALC, DENXRATE, RATETPID, EXGTBLID, Capital_Item, Product_Indicator, Total_Landed_Cost_Amount, QTYTYPE, Posted_LC_PPV_Amount, QTYREPLACED, QTYINVADJ, DEX_ROW_ID FROM .POP10500 WHERE ( PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM = @UOFM AND APPYTYPE = @APPYTYPE AND POPRCTNM = @POPRCTNM AND RCPTLNNM = @RCPTLNNM AND DEX_ROW_ID > @DEX_ROW_ID OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM = @UOFM AND APPYTYPE = @APPYTYPE AND POPRCTNM = @POPRCTNM AND RCPTLNNM > @RCPTLNNM OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM = @UOFM AND APPYTYPE = @APPYTYPE AND POPRCTNM > @POPRCTNM OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM = @UOFM AND APPYTYPE > @APPYTYPE OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM > @UOFM OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR > @ITEMNMBR OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status > @Status OR PONUMBER = @PONUMBER AND VENDORID > @VENDORID OR PONUMBER > @PONUMBER ) ORDER BY PONUMBER ASC, VENDORID ASC, Status ASC, ITEMNMBR ASC, UOFM ASC, APPYTYPE ASC, POPRCTNM ASC, RCPTLNNM ASC, DEX_ROW_ID ASC END ELSE IF @PONUMBER_RS = @PONUMBER_RE BEGIN SELECT TOP 25  PONUMBER, POLNENUM, POPRCTNM, RCPTLNNM, QTYSHPPD, QTYINVCD, QTYREJ, QTYMATCH, QTYRESERVED, QTYINVRESERVE, Status, UMQTYINB, OLDCUCST, JOBNUMBR, COSTCODE, COSTTYPE, ORCPTCOST, OSTDCOST, APPYTYPE, POPTYPE, VENDORID, ITEMNMBR, UOFM, TRXLOCTN, DATERECD, RCTSEQNM, SPRCTSEQ, PCHRPTCT, SPRCPTCT, OREXTCST, RUPPVAMT, ACPURIDX, INVINDX, UPPVIDX, NOTEINDX, CURNCYID, CURRNIDX, XCHGRATE, RATECALC, DENXRATE, RATETPID, EXGTBLID, Capital_Item, Product_Indicator, Total_Landed_Cost_Amount, QTYTYPE, Posted_LC_PPV_Amount, QTYREPLACED, QTYINVADJ, DEX_ROW_ID FROM .POP10500 WHERE PONUMBER = @PONUMBER_RS AND VENDORID BETWEEN @VENDORID_RS AND @VENDORID_RE AND Status BETWEEN @Status_RS AND @Status_RE AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND UOFM BETWEEN @UOFM_RS AND @UOFM_RE AND APPYTYPE BETWEEN @APPYTYPE_RS AND @APPYTYPE_RE AND POPRCTNM BETWEEN @POPRCTNM_RS AND @POPRCTNM_RE AND RCPTLNNM BETWEEN @RCPTLNNM_RS AND @RCPTLNNM_RE AND ( PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM = @UOFM AND APPYTYPE = @APPYTYPE AND POPRCTNM = @POPRCTNM AND RCPTLNNM = @RCPTLNNM AND DEX_ROW_ID > @DEX_ROW_ID OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM = @UOFM AND APPYTYPE = @APPYTYPE AND POPRCTNM = @POPRCTNM AND RCPTLNNM > @RCPTLNNM OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM = @UOFM AND APPYTYPE = @APPYTYPE AND POPRCTNM > @POPRCTNM OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM = @UOFM AND APPYTYPE > @APPYTYPE OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM > @UOFM OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR > @ITEMNMBR OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status > @Status OR PONUMBER = @PONUMBER AND VENDORID > @VENDORID OR PONUMBER > @PONUMBER ) ORDER BY PONUMBER ASC, VENDORID ASC, Status ASC, ITEMNMBR ASC, UOFM ASC, APPYTYPE ASC, POPRCTNM ASC, RCPTLNNM ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  PONUMBER, POLNENUM, POPRCTNM, RCPTLNNM, QTYSHPPD, QTYINVCD, QTYREJ, QTYMATCH, QTYRESERVED, QTYINVRESERVE, Status, UMQTYINB, OLDCUCST, JOBNUMBR, COSTCODE, COSTTYPE, ORCPTCOST, OSTDCOST, APPYTYPE, POPTYPE, VENDORID, ITEMNMBR, UOFM, TRXLOCTN, DATERECD, RCTSEQNM, SPRCTSEQ, PCHRPTCT, SPRCPTCT, OREXTCST, RUPPVAMT, ACPURIDX, INVINDX, UPPVIDX, NOTEINDX, CURNCYID, CURRNIDX, XCHGRATE, RATECALC, DENXRATE, RATETPID, EXGTBLID, Capital_Item, Product_Indicator, Total_Landed_Cost_Amount, QTYTYPE, Posted_LC_PPV_Amount, QTYREPLACED, QTYINVADJ, DEX_ROW_ID FROM .POP10500 WHERE PONUMBER BETWEEN @PONUMBER_RS AND @PONUMBER_RE AND VENDORID BETWEEN @VENDORID_RS AND @VENDORID_RE AND Status BETWEEN @Status_RS AND @Status_RE AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND UOFM BETWEEN @UOFM_RS AND @UOFM_RE AND APPYTYPE BETWEEN @APPYTYPE_RS AND @APPYTYPE_RE AND POPRCTNM BETWEEN @POPRCTNM_RS AND @POPRCTNM_RE AND RCPTLNNM BETWEEN @RCPTLNNM_RS AND @RCPTLNNM_RE AND ( PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM = @UOFM AND APPYTYPE = @APPYTYPE AND POPRCTNM = @POPRCTNM AND RCPTLNNM = @RCPTLNNM AND DEX_ROW_ID > @DEX_ROW_ID OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM = @UOFM AND APPYTYPE = @APPYTYPE AND POPRCTNM = @POPRCTNM AND RCPTLNNM > @RCPTLNNM OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM = @UOFM AND APPYTYPE = @APPYTYPE AND POPRCTNM > @POPRCTNM OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM = @UOFM AND APPYTYPE > @APPYTYPE OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR = @ITEMNMBR AND UOFM > @UOFM OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status = @Status AND ITEMNMBR > @ITEMNMBR OR PONUMBER = @PONUMBER AND VENDORID = @VENDORID AND Status > @Status OR PONUMBER = @PONUMBER AND VENDORID > @VENDORID OR PONUMBER > @PONUMBER ) ORDER BY PONUMBER ASC, VENDORID ASC, Status ASC, ITEMNMBR ASC, UOFM ASC, APPYTYPE ASC, POPRCTNM ASC, RCPTLNNM ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_POP10500N_3] TO [DYNGRP]
GO
