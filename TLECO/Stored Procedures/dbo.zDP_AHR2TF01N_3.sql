SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_AHR2TF01N_3] (@BS int, @DESIREDCOMPANYCODE_I char(7), @DESDIVCODE_I char(7), @DESDEPTCODE_I char(7), @DESPOSCODE_I char(7), @EMPID_I char(15), @TRANSFERREQUESTDAT_I datetime, @DEX_ROW_ID int, @DESIREDCOMPANYCODE_I_RS char(7), @DESDIVCODE_I_RS char(7), @DESDEPTCODE_I_RS char(7), @DESPOSCODE_I_RS char(7), @EMPID_I_RS char(15), @TRANSFERREQUESTDAT_I_RS datetime, @DESIREDCOMPANYCODE_I_RE char(7), @DESDIVCODE_I_RE char(7), @DESDEPTCODE_I_RE char(7), @DESPOSCODE_I_RE char(7), @EMPID_I_RE char(15), @TRANSFERREQUESTDAT_I_RE datetime) AS  set nocount on IF @DESIREDCOMPANYCODE_I_RS IS NULL BEGIN SELECT TOP 25  EMPID_I, TRANSFERREQUESTDAT_I, DESIREDCOMPANYCODE_I, DESDIVCODE_I, DESDEPTCODE_I, DESPOSCODE_I, DESSUPCODE_I, DESLOCCODE_I, EMPLOYMENTTYPE, DESIREDSHIFTCODE_I, CHANGEBY_I, CHANGEDATE_I, NOTESINDEX_I, DEX_ROW_ID FROM .AHR2TF01 WHERE ( DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I = @DESDEPTCODE_I AND DESPOSCODE_I = @DESPOSCODE_I AND EMPID_I = @EMPID_I AND TRANSFERREQUESTDAT_I = @TRANSFERREQUESTDAT_I AND DEX_ROW_ID > @DEX_ROW_ID OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I = @DESDEPTCODE_I AND DESPOSCODE_I = @DESPOSCODE_I AND EMPID_I = @EMPID_I AND TRANSFERREQUESTDAT_I < @TRANSFERREQUESTDAT_I OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I = @DESDEPTCODE_I AND DESPOSCODE_I = @DESPOSCODE_I AND EMPID_I > @EMPID_I OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I = @DESDEPTCODE_I AND DESPOSCODE_I > @DESPOSCODE_I OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I > @DESDEPTCODE_I OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I > @DESDIVCODE_I OR DESIREDCOMPANYCODE_I > @DESIREDCOMPANYCODE_I ) ORDER BY DESIREDCOMPANYCODE_I ASC, DESDIVCODE_I ASC, DESDEPTCODE_I ASC, DESPOSCODE_I ASC, EMPID_I ASC, TRANSFERREQUESTDAT_I DESC, DEX_ROW_ID ASC END ELSE IF @DESIREDCOMPANYCODE_I_RS = @DESIREDCOMPANYCODE_I_RE BEGIN SELECT TOP 25  EMPID_I, TRANSFERREQUESTDAT_I, DESIREDCOMPANYCODE_I, DESDIVCODE_I, DESDEPTCODE_I, DESPOSCODE_I, DESSUPCODE_I, DESLOCCODE_I, EMPLOYMENTTYPE, DESIREDSHIFTCODE_I, CHANGEBY_I, CHANGEDATE_I, NOTESINDEX_I, DEX_ROW_ID FROM .AHR2TF01 WHERE DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I_RS AND DESDIVCODE_I BETWEEN @DESDIVCODE_I_RS AND @DESDIVCODE_I_RE AND DESDEPTCODE_I BETWEEN @DESDEPTCODE_I_RS AND @DESDEPTCODE_I_RE AND DESPOSCODE_I BETWEEN @DESPOSCODE_I_RS AND @DESPOSCODE_I_RE AND EMPID_I BETWEEN @EMPID_I_RS AND @EMPID_I_RE AND TRANSFERREQUESTDAT_I BETWEEN @TRANSFERREQUESTDAT_I_RE AND @TRANSFERREQUESTDAT_I_RS AND ( DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I = @DESDEPTCODE_I AND DESPOSCODE_I = @DESPOSCODE_I AND EMPID_I = @EMPID_I AND TRANSFERREQUESTDAT_I = @TRANSFERREQUESTDAT_I AND DEX_ROW_ID > @DEX_ROW_ID OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I = @DESDEPTCODE_I AND DESPOSCODE_I = @DESPOSCODE_I AND EMPID_I = @EMPID_I AND TRANSFERREQUESTDAT_I < @TRANSFERREQUESTDAT_I OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I = @DESDEPTCODE_I AND DESPOSCODE_I = @DESPOSCODE_I AND EMPID_I > @EMPID_I OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I = @DESDEPTCODE_I AND DESPOSCODE_I > @DESPOSCODE_I OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I > @DESDEPTCODE_I OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I > @DESDIVCODE_I OR DESIREDCOMPANYCODE_I > @DESIREDCOMPANYCODE_I ) ORDER BY DESIREDCOMPANYCODE_I ASC, DESDIVCODE_I ASC, DESDEPTCODE_I ASC, DESPOSCODE_I ASC, EMPID_I ASC, TRANSFERREQUESTDAT_I DESC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  EMPID_I, TRANSFERREQUESTDAT_I, DESIREDCOMPANYCODE_I, DESDIVCODE_I, DESDEPTCODE_I, DESPOSCODE_I, DESSUPCODE_I, DESLOCCODE_I, EMPLOYMENTTYPE, DESIREDSHIFTCODE_I, CHANGEBY_I, CHANGEDATE_I, NOTESINDEX_I, DEX_ROW_ID FROM .AHR2TF01 WHERE DESIREDCOMPANYCODE_I BETWEEN @DESIREDCOMPANYCODE_I_RS AND @DESIREDCOMPANYCODE_I_RE AND DESDIVCODE_I BETWEEN @DESDIVCODE_I_RS AND @DESDIVCODE_I_RE AND DESDEPTCODE_I BETWEEN @DESDEPTCODE_I_RS AND @DESDEPTCODE_I_RE AND DESPOSCODE_I BETWEEN @DESPOSCODE_I_RS AND @DESPOSCODE_I_RE AND EMPID_I BETWEEN @EMPID_I_RS AND @EMPID_I_RE AND TRANSFERREQUESTDAT_I BETWEEN @TRANSFERREQUESTDAT_I_RE AND @TRANSFERREQUESTDAT_I_RS AND ( DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I = @DESDEPTCODE_I AND DESPOSCODE_I = @DESPOSCODE_I AND EMPID_I = @EMPID_I AND TRANSFERREQUESTDAT_I = @TRANSFERREQUESTDAT_I AND DEX_ROW_ID > @DEX_ROW_ID OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I = @DESDEPTCODE_I AND DESPOSCODE_I = @DESPOSCODE_I AND EMPID_I = @EMPID_I AND TRANSFERREQUESTDAT_I < @TRANSFERREQUESTDAT_I OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I = @DESDEPTCODE_I AND DESPOSCODE_I = @DESPOSCODE_I AND EMPID_I > @EMPID_I OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I = @DESDEPTCODE_I AND DESPOSCODE_I > @DESPOSCODE_I OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I = @DESDIVCODE_I AND DESDEPTCODE_I > @DESDEPTCODE_I OR DESIREDCOMPANYCODE_I = @DESIREDCOMPANYCODE_I AND DESDIVCODE_I > @DESDIVCODE_I OR DESIREDCOMPANYCODE_I > @DESIREDCOMPANYCODE_I ) ORDER BY DESIREDCOMPANYCODE_I ASC, DESDIVCODE_I ASC, DESDEPTCODE_I ASC, DESPOSCODE_I ASC, EMPID_I ASC, TRANSFERREQUESTDAT_I DESC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_AHR2TF01N_3] TO [DYNGRP]
GO
