SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[icDistributionToCompanyExists]  @I_iJournalEntry int  = NULL,  @I_cIntercompanyID char(5)  = NULL,  @O_tDistributionExists tinyint  = NULL output,  @O_cRateTypeID char(15) = NULL output,  @O_cExchangeTableID char(15) = NULL output,  @O_nExchangeRate numeric(15,7) = NULL output,  @O_dExchangeDate datetime = NULL output,  @O_dTime datetime = NULL output,  @O_sRateCalculationMethod smallint = NULL output,  @O_nDenomExchangeRate numeric(15,7) = NULL output,  @O_sMCTrxState smallint = NULL output,  @O_iErrorState int  = NULL output as  declare  @TRUE tinyint,  @dMinDate datetime,  @iStatus int  exec @iStatus = smGetMinDate @dMinDate output  select @O_tDistributionExists  = 0,  @O_cRateTypeID   = '',  @O_cExchangeTableID  = '',  @O_nExchangeRate  = 0.0,  @O_dExchangeDate  = convert(char(12),@dMinDate,102),  @O_dTime   = convert(char(12),@dMinDate,108),  @O_sRateCalculationMethod = 0   if @I_iJournalEntry is NULL or  @I_cIntercompanyID is NULL  begin  select @O_iErrorState = 20954  return end   select @TRUE = 1  set rowcount 1  select  @O_nExchangeRate   = isnull(XCHGRATE,0.0),  @O_cRateTypeID    = isnull(RATETPID,''),  @O_cExchangeTableID   = isnull(EXGTBLID,''),  @O_dExchangeDate   = isnull(EXCHDATE,convert(char(12),@dMinDate,102)),  @O_dTime    = isnull(TIME1,convert(char(12),@dMinDate,108)),  @O_sRateCalculationMethod  = isnull(RTCLCMTD, 0),  @O_nDenomExchangeRate  = isnull(DENXRATE,0.0),   @O_sMCTrxState   = isnull(MCTRXSTT, 0)  from  GL10001 with (NOLOCK) where  JRNENTRY = @I_iJournalEntry and INTERID = @I_cIntercompanyID  if @@rowcount = 1  select @O_tDistributionExists = @TRUE  set rowcount 0  return   
GO
GRANT EXECUTE ON  [dbo].[icDistributionToCompanyExists] TO [DYNGRP]
GO
