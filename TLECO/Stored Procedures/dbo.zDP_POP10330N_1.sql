SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_POP10330N_1] (@BS int, @ITMTRKOP smallint, @POPRCTNM char(17), @RCPTLNNM int, @QTYTYPE smallint, @SLTSQNUM int, @ITMTRKOP_RS smallint, @POPRCTNM_RS char(17), @RCPTLNNM_RS int, @QTYTYPE_RS smallint, @SLTSQNUM_RS int, @ITMTRKOP_RE smallint, @POPRCTNM_RE char(17), @RCPTLNNM_RE int, @QTYTYPE_RE smallint, @SLTSQNUM_RE int) AS  set nocount on IF @ITMTRKOP_RS IS NULL BEGIN SELECT TOP 25  ITMTRKOP, POPRCTNM, RCPTLNNM, SLTSQNUM, ITEMNMBR, SERLTNUM, SERLTQTY, TRXSORCE, DATERECD, DTSEQNUM, UNITCOST, QTYTYPE, BIN, MFGDATE, EXPNDATE, DEX_ROW_ID FROM .POP10330 WHERE ( ITMTRKOP = @ITMTRKOP AND POPRCTNM = @POPRCTNM AND RCPTLNNM = @RCPTLNNM AND QTYTYPE = @QTYTYPE AND SLTSQNUM > @SLTSQNUM OR ITMTRKOP = @ITMTRKOP AND POPRCTNM = @POPRCTNM AND RCPTLNNM = @RCPTLNNM AND QTYTYPE > @QTYTYPE OR ITMTRKOP = @ITMTRKOP AND POPRCTNM = @POPRCTNM AND RCPTLNNM > @RCPTLNNM OR ITMTRKOP = @ITMTRKOP AND POPRCTNM > @POPRCTNM OR ITMTRKOP > @ITMTRKOP ) ORDER BY ITMTRKOP ASC, POPRCTNM ASC, RCPTLNNM ASC, QTYTYPE ASC, SLTSQNUM ASC END ELSE IF @ITMTRKOP_RS = @ITMTRKOP_RE BEGIN SELECT TOP 25  ITMTRKOP, POPRCTNM, RCPTLNNM, SLTSQNUM, ITEMNMBR, SERLTNUM, SERLTQTY, TRXSORCE, DATERECD, DTSEQNUM, UNITCOST, QTYTYPE, BIN, MFGDATE, EXPNDATE, DEX_ROW_ID FROM .POP10330 WHERE ITMTRKOP = @ITMTRKOP_RS AND POPRCTNM BETWEEN @POPRCTNM_RS AND @POPRCTNM_RE AND RCPTLNNM BETWEEN @RCPTLNNM_RS AND @RCPTLNNM_RE AND QTYTYPE BETWEEN @QTYTYPE_RS AND @QTYTYPE_RE AND SLTSQNUM BETWEEN @SLTSQNUM_RS AND @SLTSQNUM_RE AND ( ITMTRKOP = @ITMTRKOP AND POPRCTNM = @POPRCTNM AND RCPTLNNM = @RCPTLNNM AND QTYTYPE = @QTYTYPE AND SLTSQNUM > @SLTSQNUM OR ITMTRKOP = @ITMTRKOP AND POPRCTNM = @POPRCTNM AND RCPTLNNM = @RCPTLNNM AND QTYTYPE > @QTYTYPE OR ITMTRKOP = @ITMTRKOP AND POPRCTNM = @POPRCTNM AND RCPTLNNM > @RCPTLNNM OR ITMTRKOP = @ITMTRKOP AND POPRCTNM > @POPRCTNM OR ITMTRKOP > @ITMTRKOP ) ORDER BY ITMTRKOP ASC, POPRCTNM ASC, RCPTLNNM ASC, QTYTYPE ASC, SLTSQNUM ASC END ELSE BEGIN SELECT TOP 25  ITMTRKOP, POPRCTNM, RCPTLNNM, SLTSQNUM, ITEMNMBR, SERLTNUM, SERLTQTY, TRXSORCE, DATERECD, DTSEQNUM, UNITCOST, QTYTYPE, BIN, MFGDATE, EXPNDATE, DEX_ROW_ID FROM .POP10330 WHERE ITMTRKOP BETWEEN @ITMTRKOP_RS AND @ITMTRKOP_RE AND POPRCTNM BETWEEN @POPRCTNM_RS AND @POPRCTNM_RE AND RCPTLNNM BETWEEN @RCPTLNNM_RS AND @RCPTLNNM_RE AND QTYTYPE BETWEEN @QTYTYPE_RS AND @QTYTYPE_RE AND SLTSQNUM BETWEEN @SLTSQNUM_RS AND @SLTSQNUM_RE AND ( ITMTRKOP = @ITMTRKOP AND POPRCTNM = @POPRCTNM AND RCPTLNNM = @RCPTLNNM AND QTYTYPE = @QTYTYPE AND SLTSQNUM > @SLTSQNUM OR ITMTRKOP = @ITMTRKOP AND POPRCTNM = @POPRCTNM AND RCPTLNNM = @RCPTLNNM AND QTYTYPE > @QTYTYPE OR ITMTRKOP = @ITMTRKOP AND POPRCTNM = @POPRCTNM AND RCPTLNNM > @RCPTLNNM OR ITMTRKOP = @ITMTRKOP AND POPRCTNM > @POPRCTNM OR ITMTRKOP > @ITMTRKOP ) ORDER BY ITMTRKOP ASC, POPRCTNM ASC, RCPTLNNM ASC, QTYTYPE ASC, SLTSQNUM ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_POP10330N_1] TO [DYNGRP]
GO
