SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_FACNVDTLN_2] (@BS int, @BOOKID char(15), @ASSETID char(15), @ASSETIDSUF smallint, @INDXLONG int, @BOOKID_RS char(15), @ASSETID_RS char(15), @ASSETIDSUF_RS smallint, @INDXLONG_RS int, @BOOKID_RE char(15), @ASSETID_RE char(15), @ASSETIDSUF_RE smallint, @INDXLONG_RE int) AS  set nocount on IF @BOOKID_RS IS NULL BEGIN SELECT TOP 25  ASSETID, ASSETIDSUF, Import_Record_Type, BOOKID, INDXLONG, SEQNUMBR, ERRICON, ERMSGTXT, DEX_ROW_ID FROM .FACNVDTL WHERE ( BOOKID = @BOOKID AND ASSETID = @ASSETID AND ASSETIDSUF = @ASSETIDSUF AND INDXLONG > @INDXLONG OR BOOKID = @BOOKID AND ASSETID = @ASSETID AND ASSETIDSUF > @ASSETIDSUF OR BOOKID = @BOOKID AND ASSETID > @ASSETID OR BOOKID > @BOOKID ) ORDER BY BOOKID ASC, ASSETID ASC, ASSETIDSUF ASC, INDXLONG ASC END ELSE IF @BOOKID_RS = @BOOKID_RE BEGIN SELECT TOP 25  ASSETID, ASSETIDSUF, Import_Record_Type, BOOKID, INDXLONG, SEQNUMBR, ERRICON, ERMSGTXT, DEX_ROW_ID FROM .FACNVDTL WHERE BOOKID = @BOOKID_RS AND ASSETID BETWEEN @ASSETID_RS AND @ASSETID_RE AND ASSETIDSUF BETWEEN @ASSETIDSUF_RS AND @ASSETIDSUF_RE AND INDXLONG BETWEEN @INDXLONG_RS AND @INDXLONG_RE AND ( BOOKID = @BOOKID AND ASSETID = @ASSETID AND ASSETIDSUF = @ASSETIDSUF AND INDXLONG > @INDXLONG OR BOOKID = @BOOKID AND ASSETID = @ASSETID AND ASSETIDSUF > @ASSETIDSUF OR BOOKID = @BOOKID AND ASSETID > @ASSETID OR BOOKID > @BOOKID ) ORDER BY BOOKID ASC, ASSETID ASC, ASSETIDSUF ASC, INDXLONG ASC END ELSE BEGIN SELECT TOP 25  ASSETID, ASSETIDSUF, Import_Record_Type, BOOKID, INDXLONG, SEQNUMBR, ERRICON, ERMSGTXT, DEX_ROW_ID FROM .FACNVDTL WHERE BOOKID BETWEEN @BOOKID_RS AND @BOOKID_RE AND ASSETID BETWEEN @ASSETID_RS AND @ASSETID_RE AND ASSETIDSUF BETWEEN @ASSETIDSUF_RS AND @ASSETIDSUF_RE AND INDXLONG BETWEEN @INDXLONG_RS AND @INDXLONG_RE AND ( BOOKID = @BOOKID AND ASSETID = @ASSETID AND ASSETIDSUF = @ASSETIDSUF AND INDXLONG > @INDXLONG OR BOOKID = @BOOKID AND ASSETID = @ASSETID AND ASSETIDSUF > @ASSETIDSUF OR BOOKID = @BOOKID AND ASSETID > @ASSETID OR BOOKID > @BOOKID ) ORDER BY BOOKID ASC, ASSETID ASC, ASSETIDSUF ASC, INDXLONG ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_FACNVDTLN_2] TO [DYNGRP]
GO
