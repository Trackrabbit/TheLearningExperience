SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyPA2] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255), @DestCMPANYID smallint, @SourcCMPANYID smallint, @DestCMPNYNAM varchar(65) select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '', @DestCMPANYID = 0, @SourcCMPANYID = 0, @DestCMPNYNAM = '' select @DestCMPANYID = CMPANYID, @DestCMPNYNAM = CMPNYNAM from DYNAMICS..SY01500 where INTERID = @I_vToCompany select @SourcCMPANYID = CMPANYID from DYNAMICS..SY01500 where INTERID = @I_vFromCompany if (@I_vData = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01121' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01121 ( [PACONTNUMBER],[YEAR1],[PERIODID],[PABQuantity],[PABTotalCost],[PABProfit], [PABBillings],[PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PAFQuantity],[PAFProfit], [PAFBillings],[PAFTaxPaidAmt],[PAFTaxChargedAmt],[PAForecastOvhdCost],[PA_Earnings],[PA_Cost_of_Earnings], [PAUnpostedQty],[PAPostedQty],[PAUnpostedProfitN],[PAPostedProfitN],[PAUnpostAccrRevN],[PAPosted_Accr_RevN], [PAUnpostedRecogRevN],[PAPostRecogRevN],[PAUnpostedTotalCostN],[PAPostedTotalCostN],[PAUnposted_Overhead],[PAPosted_Overhead], [PAUnpostBillN],[PAPostedBillingsN],[PAUnposted_Fee_Amount],[PAPosted_Fee_Amount],[PAUNPEIEBAMOUNT],[PAPOSEIEBAMOUNT], [PAUNPOSTBIEEAMOUNT],[PAPOSBIEEAMOUNT],[PAWrite_UpDown_Amount],[PA_Unposted_Billed_Reten],[PAUnposted_Project_Fee],[PAUnposted_Retainer_Fee], [PAUnposted_Service_Fee],[PAUNPOSTRETAMT],[PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PA_Actual_Billed_Retenti],[PAPosted_Project_Fee], [PAPosted_Retainer_Fee],[PAPOSTRETAMT],[PAPosted_Service_Fee],[PAFeeAmount],[WROFAMNT],[ActualWriteOffAmount], [DISTKNAM],[ActualDiscTakenAmount],[PAFTotalCost],[PAUnposted_Sales_Tax_Am],[PAPosted_Sales_Tax_Amou],[PACostPcntCompleted], [PAQuantityPcntCompleted],[PACommitted_Costs],[PACommitted_Qty],[PAPOPostedCost],[PAPOPostedQty],[PAPOCost], [PAPOQty],[PAUnposted_Tax_Amount],[PAPosted_Tax_Amount],[PAtaxpaidamt],[PAPostedTaxPaidN],[PAPostedDiscDolAmtN], [PAUnpostDiscDolAmtN],[PABilled_Accrued_Revenu],[PABilled_QtyN],[PAApproved_Accrued_Reve],[PAApproved_Quantity],[PApretainage], [PAunpretainage],[PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt],[PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PAPosted_Earnings], [PAActualCostofEarnings],[PAUnpostedLossAmount],[PAActualLossAmount],[PAFQLaborOnly],[PAAQLaborOnly] ) select [PACONTNUMBER],[YEAR1],[PERIODID],[PABQuantity],[PABTotalCost],[PABProfit], [PABBillings],[PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PAFQuantity],[PAFProfit], [PAFBillings],[PAFTaxPaidAmt],[PAFTaxChargedAmt],[PAForecastOvhdCost],[PA_Earnings],[PA_Cost_of_Earnings], [PAUnpostedQty],[PAPostedQty],[PAUnpostedProfitN],[PAPostedProfitN],[PAUnpostAccrRevN],[PAPosted_Accr_RevN], [PAUnpostedRecogRevN],[PAPostRecogRevN],[PAUnpostedTotalCostN],[PAPostedTotalCostN],[PAUnposted_Overhead],[PAPosted_Overhead], [PAUnpostBillN],[PAPostedBillingsN],[PAUnposted_Fee_Amount],[PAPosted_Fee_Amount],[PAUNPEIEBAMOUNT],[PAPOSEIEBAMOUNT], [PAUNPOSTBIEEAMOUNT],[PAPOSBIEEAMOUNT],[PAWrite_UpDown_Amount],[PA_Unposted_Billed_Reten],[PAUnposted_Project_Fee],[PAUnposted_Retainer_Fee], [PAUnposted_Service_Fee],[PAUNPOSTRETAMT],[PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PA_Actual_Billed_Retenti],[PAPosted_Project_Fee], [PAPosted_Retainer_Fee],[PAPOSTRETAMT],[PAPosted_Service_Fee],[PAFeeAmount],[WROFAMNT],[ActualWriteOffAmount], [DISTKNAM],[ActualDiscTakenAmount],[PAFTotalCost],[PAUnposted_Sales_Tax_Am],[PAPosted_Sales_Tax_Amou],[PACostPcntCompleted], [PAQuantityPcntCompleted],[PACommitted_Costs],[PACommitted_Qty],[PAPOPostedCost],[PAPOPostedQty],[PAPOCost], [PAPOQty],[PAUnposted_Tax_Amount],[PAPosted_Tax_Amount],[PAtaxpaidamt],[PAPostedTaxPaidN],[PAPostedDiscDolAmtN], [PAUnpostDiscDolAmtN],[PABilled_Accrued_Revenu],[PABilled_QtyN],[PAApproved_Accrued_Reve],[PAApproved_Quantity],[PApretainage], [PAunpretainage],[PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt],[PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PAPosted_Earnings], [PAActualCostofEarnings],[PAUnpostedLossAmount],[PAActualLossAmount],[PAFQLaborOnly],[PAAQLaborOnly] from ' + rtrim(@I_vFromCompany) + '..PA01121 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01122' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01122 ( [PACONTNUMBER],[YEAR1],[PERIODID],[PATOTCHGORDAMT],[PACOBASEPROJAMT],[PACOBSLNFEEPROJAMT] ) select [PACONTNUMBER],[YEAR1],[PERIODID],[PATOTCHGORDAMT],[PACOBASEPROJAMT],[PACOBSLNFEEPROJAMT] from ' + rtrim(@I_vFromCompany) + '..PA01122 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01141' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01141 ( [PACONTNUMBER],[PAchangeorderdocounter],[PATRKCHGORDS],[PATRKCOBDGADDFLY],[PACOTRKBASELINE],[PATOTCHGORDAMT], [PANOPENDCO],[PANUMCO],[PACOBASEPROJAMT],[PACOBSLNFEEPROJAMT],[PAUNPRRTOTPROJAMT],[PAUNABSTOTBILL], [PAUNPBSTOTCST],[PAUNPBSLTOTPROF],[PAUNPBSTOTQTY],[PAUNAPFRTOTBILL],[PAUNAPPFRTOTCST],[PAUNFRCTOTPROF], [PAUNPFRTOTQTY],[PAPostedQty],[PAPostedTotalCostN],[PAPosted_Overhead],[PAPostedProfitN],[PAPosted_Tax_Amount], [PAPosted_Accr_RevN],[PAPostRecogRevN],[PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PApostbillamt],[PA_Actual_Receipts_Amoun], [PAPostedBillingsN],[PAPostedDiscDolAmtN],[PAPosted_Sales_Tax_Amou],[ActualWriteOffAmount],[ActualDiscTakenAmount],[PAPostedTaxPaidN], [PAPOSTRETAMT],[PAActualWOTaxAmt],[PAActualTermsTakenTax],[PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPosted_Service_Fee], [PAGBTRKCHG] ) select [PACONTNUMBER],[PAchangeorderdocounter],[PATRKCHGORDS],[PATRKCOBDGADDFLY],[PACOTRKBASELINE],[PATOTCHGORDAMT], [PANOPENDCO],[PANUMCO],[PACOBASEPROJAMT],[PACOBSLNFEEPROJAMT],[PAUNPRRTOTPROJAMT],[PAUNABSTOTBILL], [PAUNPBSTOTCST],[PAUNPBSLTOTPROF],[PAUNPBSTOTQTY],[PAUNAPFRTOTBILL],[PAUNAPPFRTOTCST],[PAUNFRCTOTPROF], [PAUNPFRTOTQTY],[PAPostedQty],[PAPostedTotalCostN],[PAPosted_Overhead],[PAPostedProfitN],[PAPosted_Tax_Amount], [PAPosted_Accr_RevN],[PAPostRecogRevN],[PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PApostbillamt],[PA_Actual_Receipts_Amoun], [PAPostedBillingsN],[PAPostedDiscDolAmtN],[PAPosted_Sales_Tax_Amou],[ActualWriteOffAmount],[ActualDiscTakenAmount],[PAPostedTaxPaidN], [PAPOSTRETAMT],[PAActualWOTaxAmt],[PAActualTermsTakenTax],[PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPosted_Service_Fee], [PAGBTRKCHG] from ' + rtrim(@I_vFromCompany) + '..PA01141 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01201' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01201 ( [CUSTNMBR],[PACONTNUMBER],[PAcontid],[PAprojid],[PAprojname],[PAPROJNUMBER], [PAprjclsid],[PAProjectType],[PAAcctgMethod],[PASTAT],[CURRNIDX],[PApurordnum], [PABBeginDate],[PABEndDate],[PABQuantity],[PABTotalCost],[PABProfit],[PABBillings], [PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PAACTUALBEGDATE],[PA_Actual_End_Date],[PAFBeginDate], [PAFEndDate],[PAFQuantity],[PAFTotalCost],[PAFProfit],[PAFBillings],[PAFTaxPaidAmt], [PAFTaxChargedAmt],[PAForecastOvhdCost],[PAcloseProjcosts],[PAclosetobillings],[PADepartment],[PAEstimatorID], [PAprojmngrid],[PABusMgrID],[LOCATNID],[SLPRSNID],[SALSTERR],[COMPRCNT], [COMAPPTO],[CNTCPRSN],[PRBTADCD],[PALabor_Rate_Table_ID],[PALabor_RateTable_Type],[PALabor_Rate_Table_Acc], [PAEquip_Rate_Table_ID],[PAEquip_Rate_Table_Acc],[PAbllngtype],[PAService_Fee_Amount],[PAProject_Fee_Amount],[PARetainer_Fee_Amount], [PARetentionFeeAmount],[PAProject_Amount],[ACCTAMNT],[PABILLFORMAT],[DSCPCTAM],[PA_Retention_Percent], [PAtotcbts],[PAtotcbEL],[PAtotcbML],[PAtotcbvi],[PAtotcber],[PAtotcbinv], [PAtotcbfee],[PAUD1Proj],[PAUD2_Proj],[PASegmentCB],[PAbillnoteidx],[PAbillnoteidxts], [PAELbillniteidx],[PAbillnoteidxML],[PAbillnoteidxvi],[PAbillnoteidxee],[PAbillnoteidxinv],[PAbillnoteidxfee], [PAUnpostedQty],[PAUnpostedTotalCostN],[PAUnposted_Overhead],[PAUnpostedProfitN],[PAUnposted_Tax_Amount],[PAUnpostAccrRevN], [PAUnpostedRecogRevN],[PAUnpostedCommitedQty],[PAUnpostedCommitedCost],[PAUnpostedCommitedTaxAmt],[PAUnposted_Project_Fee],[PAUnposted_Retainer_Fee], [PAUnposted_Service_Fee],[PAUNPOSTRETAMT],[PAUNPOSTBIEEAMOUNT],[PAUNPEIEBAMOUNT],[PA_Unposted_Billed_Reten],[PAPostedQty], [PAPostedTotalCostN],[PAPostedProfitN],[PAPosted_Tax_Amount],[PAPosted_Accr_RevN],[PAPostRecogRevN],[PAPostedCommitedQty], [PAPostedCommitedCost],[PAPostedCommitedTaxAmt],[PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPosted_Service_Fee],[PAPOSTRETAMT], [PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PA_Actual_Billed_Retenti],[PAWrite_UpDown_Amount],[PABilled_QtyN],[PABilled_Cost], [PABilled_Accrued_Revenu],[PACostPcntCompleted],[PAQuantityPcntCompleted],[PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PA_Earnings], [PA_Cost_of_Earnings],[PAUnpostBillN],[PAUnpostDiscDolAmtN],[PAUnposted_Sales_Tax_Am],[PAPostedBillingsN],[PAPostedDiscDolAmtN], [PAPosted_Sales_Tax_Amou],[PABCWPAMT],[PABCWSAMT],[PAACWPAMT],[NOTEINDX],[PAPosted_Overhead], [PAApproved_Accrued_Reve],[PAApproved_Cost],[PAApproved_Quantity],[WROFAMNT],[ActualWriteOffAmount],[DISTKNAM], [ActualDiscTakenAmount],[PACommitted_Costs],[PACommitted_Qty],[PAPOCost],[PAPOQty],[PAPOPostedCost], [PAPOPostedQty],[PAtaxpaidamt],[PAPostedTaxPaidN],[PApretainage],[PAunpretainage],[PA_Write_Off_Tax_Amount], [PAActualWOTaxAmt],[PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[WRKRCOMP],[SUTASTAT],[PA_Actual_Billing_not_RM], [PA_ActualDiscnotRM],[PA_RestrictCustomerList],[PAPosted_Earnings],[PAActualCostofEarnings],[PAUnpostedLossAmount],[PAActualLossAmount], [PAFQLaborOnly],[PAAQLaborOnly],[PAMCCURNCYID],[PAMCProjectAmount],[PAMCUnpostBillN],[PAMCUnpostedSalesTax], [PAMCUnpostedDiscount],[PAMCActualBillings],[PAMCActualSalesTaxAmt],[PAMCActualDiscountAmt],[PAMCBBillings],[PAMCFBillings], [PA_MC_Project_Fee_Amount],[PA_MC_Service_Fee_Amount],[PA_MC_Retainer_Fee_Amt],[PA_MC_UnpostedProjectFee],[PA_MC_Unposted_Retainer],[PA_MC_UnpostedServiceFee], [PA_MC_Actual_Project_Fee],[PA_MC_Actual_RetainerFee],[PA_MC_Actual_Service_Fee],[PANOTIFBILL] ) select [CUSTNMBR],[PACONTNUMBER],[PAcontid],[PAprojid],[PAprojname],[PAPROJNUMBER], [PAprjclsid],[PAProjectType],[PAAcctgMethod],[PASTAT],[CURRNIDX],[PApurordnum], [PABBeginDate],[PABEndDate],[PABQuantity],[PABTotalCost],[PABProfit],[PABBillings], [PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PAACTUALBEGDATE],[PA_Actual_End_Date],[PAFBeginDate], [PAFEndDate],[PAFQuantity],[PAFTotalCost],[PAFProfit],[PAFBillings],[PAFTaxPaidAmt], [PAFTaxChargedAmt],[PAForecastOvhdCost],[PAcloseProjcosts],[PAclosetobillings],[PADepartment],[PAEstimatorID], [PAprojmngrid],[PABusMgrID],[LOCATNID],[SLPRSNID],[SALSTERR],[COMPRCNT], [COMAPPTO],[CNTCPRSN],[PRBTADCD],[PALabor_Rate_Table_ID],[PALabor_RateTable_Type],[PALabor_Rate_Table_Acc], [PAEquip_Rate_Table_ID],[PAEquip_Rate_Table_Acc],[PAbllngtype],[PAService_Fee_Amount],[PAProject_Fee_Amount],[PARetainer_Fee_Amount], [PARetentionFeeAmount],[PAProject_Amount],[ACCTAMNT],[PABILLFORMAT],[DSCPCTAM],[PA_Retention_Percent], [PAtotcbts],[PAtotcbEL],[PAtotcbML],[PAtotcbvi],[PAtotcber],[PAtotcbinv], [PAtotcbfee],[PAUD1Proj],[PAUD2_Proj],[PASegmentCB],[PAbillnoteidx],[PAbillnoteidxts], [PAELbillniteidx],[PAbillnoteidxML],[PAbillnoteidxvi],[PAbillnoteidxee],[PAbillnoteidxinv],[PAbillnoteidxfee], [PAUnpostedQty],[PAUnpostedTotalCostN],[PAUnposted_Overhead],[PAUnpostedProfitN],[PAUnposted_Tax_Amount],[PAUnpostAccrRevN], [PAUnpostedRecogRevN],[PAUnpostedCommitedQty],[PAUnpostedCommitedCost],[PAUnpostedCommitedTaxAmt],[PAUnposted_Project_Fee],[PAUnposted_Retainer_Fee], [PAUnposted_Service_Fee],[PAUNPOSTRETAMT],[PAUNPOSTBIEEAMOUNT],[PAUNPEIEBAMOUNT],[PA_Unposted_Billed_Reten],[PAPostedQty], [PAPostedTotalCostN],[PAPostedProfitN],[PAPosted_Tax_Amount],[PAPosted_Accr_RevN],[PAPostRecogRevN],[PAPostedCommitedQty], [PAPostedCommitedCost],[PAPostedCommitedTaxAmt],[PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPosted_Service_Fee],[PAPOSTRETAMT], [PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PA_Actual_Billed_Retenti],[PAWrite_UpDown_Amount],[PABilled_QtyN],[PABilled_Cost], [PABilled_Accrued_Revenu],[PACostPcntCompleted],[PAQuantityPcntCompleted],[PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PA_Earnings], [PA_Cost_of_Earnings],[PAUnpostBillN],[PAUnpostDiscDolAmtN],[PAUnposted_Sales_Tax_Am],[PAPostedBillingsN],[PAPostedDiscDolAmtN], [PAPosted_Sales_Tax_Amou],[PABCWPAMT],[PABCWSAMT],[PAACWPAMT],[NOTEINDX],[PAPosted_Overhead], [PAApproved_Accrued_Reve],[PAApproved_Cost],[PAApproved_Quantity],[WROFAMNT],[ActualWriteOffAmount],[DISTKNAM], [ActualDiscTakenAmount],[PACommitted_Costs],[PACommitted_Qty],[PAPOCost],[PAPOQty],[PAPOPostedCost], [PAPOPostedQty],[PAtaxpaidamt],[PAPostedTaxPaidN],[PApretainage],[PAunpretainage],[PA_Write_Off_Tax_Amount], [PAActualWOTaxAmt],[PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[WRKRCOMP],[SUTASTAT],[PA_Actual_Billing_not_RM], [PA_ActualDiscnotRM],[PA_RestrictCustomerList],[PAPosted_Earnings],[PAActualCostofEarnings],[PAUnpostedLossAmount],[PAActualLossAmount], [PAFQLaborOnly],[PAAQLaborOnly],[PAMCCURNCYID],[PAMCProjectAmount],[PAMCUnpostBillN],[PAMCUnpostedSalesTax], [PAMCUnpostedDiscount],[PAMCActualBillings],[PAMCActualSalesTaxAmt],[PAMCActualDiscountAmt],[PAMCBBillings],[PAMCFBillings], [PA_MC_Project_Fee_Amount],[PA_MC_Service_Fee_Amount],[PA_MC_Retainer_Fee_Amt],[PA_MC_UnpostedProjectFee],[PA_MC_Unposted_Retainer],[PA_MC_UnpostedServiceFee], [PA_MC_Actual_Project_Fee],[PA_MC_Actual_RetainerFee],[PA_MC_Actual_Service_Fee],[PANOTIFBILL] from ' + rtrim(@I_vFromCompany) + '..PA01201 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01202' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01202 ( [PAPROJNUMBER],[PAMCCURNCYID],[CURRNIDX],[PABRATETPID],[PABEXGTBLID],[PABXCHGRATE], [PABEXCHDATE],[PABTIME1],[PABRTCLCMTD],[PABDENXRATE],[PABMCTRXSTT],[PAFRATETPID], [PAFEXGTBLID],[PAFXCHGRATE],[PAFEXCHDATE],[PAFTIME1],[PAFRTCLCMTD],[PAFDENXRATE], [PAFMCTRXSTT] ) select [PAPROJNUMBER],[PAMCCURNCYID],[CURRNIDX],[PABRATETPID],[PABEXGTBLID],[PABXCHGRATE], [PABEXCHDATE],[PABTIME1],[PABRTCLCMTD],[PABDENXRATE],[PABMCTRXSTT],[PAFRATETPID], [PAFEXGTBLID],[PAFXCHGRATE],[PAFEXCHDATE],[PAFTIME1],[PAFRTCLCMTD],[PAFDENXRATE], [PAFMCTRXSTT] from ' + rtrim(@I_vFromCompany) + '..PA01202 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01211' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01211 ( [PACONTNUMBER],[PAPROJNUMBER],[CUSTNMBR],[PABillingMode],[PARevSourceAmt],[PARevSourcePercent] ) select [PACONTNUMBER],[PAPROJNUMBER],[CUSTNMBR],[PABillingMode],[PARevSourceAmt],[PARevSourcePercent] from ' + rtrim(@I_vFromCompany) + '..PA01211 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01221' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01221 ( [PAPROJNUMBER],[YEAR1],[PERIODID],[PABQuantity],[PABTotalCost],[PABProfit], [PABBillings],[PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PAFQuantity],[PAFTotalCost], [PAFProfit],[PAFBillings],[PAFTaxPaidAmt],[PAFTaxChargedAmt],[PAForecastOvhdCost],[PA_Earnings], [PA_Cost_of_Earnings],[PAUnpostedQty],[PAPostedQty],[PAUnpostedProfitN],[PAPostedProfitN],[PAUnpostAccrRevN], [PAPosted_Accr_RevN],[PAUnpostedTotalCostN],[PAPostedTotalCostN],[PAUnposted_Overhead],[PAPosted_Overhead],[PAUnpostBillN], [PAPostedBillingsN],[PAUnposted_Fee_Amount],[PAPosted_Fee_Amount],[PAUnpostedRecogRevN],[PAPostRecogRevN],[PAUNPEIEBAMOUNT], [PAPOSEIEBAMOUNT],[PAUNPOSTBIEEAMOUNT],[PAPOSBIEEAMOUNT],[PAWrite_UpDown_Amount],[PA_Unposted_Billed_Reten],[PAUnposted_Project_Fee], [PAUnposted_Retainer_Fee],[PAUNPOSTRETAMT],[PAUnposted_Service_Fee],[PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PA_Actual_Billed_Retenti], [PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPOSTRETAMT],[PAPosted_Service_Fee],[PAFeeAmount],[WROFAMNT], [ActualWriteOffAmount],[DISTKNAM],[ActualDiscTakenAmount],[PAUnposted_Sales_Tax_Am],[PAPosted_Sales_Tax_Amou],[PACostPcntCompleted], [PAQuantityPcntCompleted],[PACommitted_Costs],[PACommitted_Qty],[PAPOCost],[PAPOQty],[PAPOPostedCost], [PAPOPostedQty],[PAUnposted_Tax_Amount],[PAPosted_Tax_Amount],[PAtaxpaidamt],[PAPostedTaxPaidN],[PAPostedDiscDolAmtN], [PAUnpostDiscDolAmtN],[PABilled_Accrued_Revenu],[PABilled_QtyN],[PAApproved_Accrued_Reve],[PAApproved_Quantity],[PApretainage], [PAunpretainage],[PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt],[PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PAPosted_Earnings], [PAActualCostofEarnings],[PAUnpostedLossAmount],[PAActualLossAmount],[PAFQLaborOnly],[PAAQLaborOnly] ) select [PAPROJNUMBER],[YEAR1],[PERIODID],[PABQuantity],[PABTotalCost],[PABProfit], [PABBillings],[PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PAFQuantity],[PAFTotalCost], [PAFProfit],[PAFBillings],[PAFTaxPaidAmt],[PAFTaxChargedAmt],[PAForecastOvhdCost],[PA_Earnings], [PA_Cost_of_Earnings],[PAUnpostedQty],[PAPostedQty],[PAUnpostedProfitN],[PAPostedProfitN],[PAUnpostAccrRevN], [PAPosted_Accr_RevN],[PAUnpostedTotalCostN],[PAPostedTotalCostN],[PAUnposted_Overhead],[PAPosted_Overhead],[PAUnpostBillN], [PAPostedBillingsN],[PAUnposted_Fee_Amount],[PAPosted_Fee_Amount],[PAUnpostedRecogRevN],[PAPostRecogRevN],[PAUNPEIEBAMOUNT], [PAPOSEIEBAMOUNT],[PAUNPOSTBIEEAMOUNT],[PAPOSBIEEAMOUNT],[PAWrite_UpDown_Amount],[PA_Unposted_Billed_Reten],[PAUnposted_Project_Fee], [PAUnposted_Retainer_Fee],[PAUNPOSTRETAMT],[PAUnposted_Service_Fee],[PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PA_Actual_Billed_Retenti], [PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPOSTRETAMT],[PAPosted_Service_Fee],[PAFeeAmount],[WROFAMNT], [ActualWriteOffAmount],[DISTKNAM],[ActualDiscTakenAmount],[PAUnposted_Sales_Tax_Am],[PAPosted_Sales_Tax_Amou],[PACostPcntCompleted], [PAQuantityPcntCompleted],[PACommitted_Costs],[PACommitted_Qty],[PAPOCost],[PAPOQty],[PAPOPostedCost], [PAPOPostedQty],[PAUnposted_Tax_Amount],[PAPosted_Tax_Amount],[PAtaxpaidamt],[PAPostedTaxPaidN],[PAPostedDiscDolAmtN], [PAUnpostDiscDolAmtN],[PABilled_Accrued_Revenu],[PABilled_QtyN],[PAApproved_Accrued_Reve],[PAApproved_Quantity],[PApretainage], [PAunpretainage],[PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt],[PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PAPosted_Earnings], [PAActualCostofEarnings],[PAUnpostedLossAmount],[PAActualLossAmount],[PAFQLaborOnly],[PAAQLaborOnly] from ' + rtrim(@I_vFromCompany) + '..PA01221 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01222' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01222 ( [PAPROJNUMBER],[YEAR1],[PERIODID],[PATOTCHGORDAMT],[PACOBASEPROJAMT],[PACOBSLNFEEPROJAMT] ) select [PAPROJNUMBER],[YEAR1],[PERIODID],[PATOTCHGORDAMT],[PACOBASEPROJAMT],[PACOBSLNFEEPROJAMT] from ' + rtrim(@I_vFromCompany) + '..PA01222 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01241' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01241 ( [PAPROJNUMBER],[PATRKCHGORDS],[PATRKCOBDGADDFLY],[PATOTCHGORDAMT],[PANOPENDCO],[PANUMCO], [PACOBASEPROJAMT],[PAUNPRRTOTPROJAMT],[PACOBSLNFEEPROJAMT],[PAUNABSTOTBILL],[PAUNPBSTOTCST],[PAUNPBSLTOTPROF], [PAUNPBSTOTQTY],[PAUNAPFRTOTBILL],[PAUNAPPFRTOTCST],[PAUNFRCTOTPROF],[PAUNPFRTOTQTY],[PAPostedQty], [PAPostedTotalCostN],[PAPosted_Overhead],[PAPostedProfitN],[PAPosted_Tax_Amount],[PAACREV],[PAPostRecogRevN], [PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PApostbillamt],[PA_Actual_Receipts_Amoun],[PAPostedBillingsN],[PAPostedDiscDolAmtN], [PAPosted_Sales_Tax_Amou],[ActualWriteOffAmount],[ActualDiscTakenAmount],[PAactjtaxpd],[PAPOSTRETAMT],[PAActualWOTaxAmt], [PAActualTermsTakenTax],[PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPosted_Service_Fee] ) select [PAPROJNUMBER],[PATRKCHGORDS],[PATRKCOBDGADDFLY],[PATOTCHGORDAMT],[PANOPENDCO],[PANUMCO], [PACOBASEPROJAMT],[PAUNPRRTOTPROJAMT],[PACOBSLNFEEPROJAMT],[PAUNABSTOTBILL],[PAUNPBSTOTCST],[PAUNPBSLTOTPROF], [PAUNPBSTOTQTY],[PAUNAPFRTOTBILL],[PAUNAPPFRTOTCST],[PAUNFRCTOTPROF],[PAUNPFRTOTQTY],[PAPostedQty], [PAPostedTotalCostN],[PAPosted_Overhead],[PAPostedProfitN],[PAPosted_Tax_Amount],[PAACREV],[PAPostRecogRevN], [PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PApostbillamt],[PA_Actual_Receipts_Amoun],[PAPostedBillingsN],[PAPostedDiscDolAmtN], [PAPosted_Sales_Tax_Amou],[ActualWriteOffAmount],[ActualDiscTakenAmount],[PAactjtaxpd],[PAPOSTRETAMT],[PAActualWOTaxAmt], [PAActualTermsTakenTax],[PAPosted_Project_Fee],[PAPosted_Retainer_Fee],[PAPosted_Service_Fee] from ' + rtrim(@I_vFromCompany) + '..PA01241 ' exec(@cStatement) exec @iStatus = eeCompanyCopyPA3 @I_vFromCompany,			 @I_vToCompany,				 @I_vData,					 @I_vReportOptions,			 @O_iErrorState output		 if ((@iStatus <> 0) or (@O_iErrorState <> 0)) begin select @O_iErrorState = 1  return (@O_iErrorState) end end return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyPA2] TO [DYNGRP]
GO
