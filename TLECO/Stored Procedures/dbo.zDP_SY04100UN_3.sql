SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SY04100UN_3] (@BS int, @STATE char(29), @CITY char(35), @BANKID char(15), @STATE_RS char(29), @CITY_RS char(35), @BANKID_RS char(15), @STATE_RE char(29), @CITY_RE char(35), @BANKID_RE char(15)) AS  set nocount on IF @STATE_RS IS NULL BEGIN SELECT TOP 25  BANKID, BANKNAME, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, COUNTRY, PHNUMBR1, PHNUMBR2, PHONE3, FAXNUMBR, TRNSTNBR, BNKBRNCH, NOTEINDX, DDTRANUM, DEX_ROW_ID FROM .SY04100 WHERE ( STATE = @STATE AND CITY = @CITY AND BANKID > @BANKID OR STATE = @STATE AND CITY > @CITY OR STATE > @STATE ) ORDER BY STATE ASC, CITY ASC, BANKID ASC, DEX_ROW_ID ASC END ELSE IF @STATE_RS = @STATE_RE BEGIN SELECT TOP 25  BANKID, BANKNAME, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, COUNTRY, PHNUMBR1, PHNUMBR2, PHONE3, FAXNUMBR, TRNSTNBR, BNKBRNCH, NOTEINDX, DDTRANUM, DEX_ROW_ID FROM .SY04100 WHERE STATE = @STATE_RS AND CITY BETWEEN @CITY_RS AND @CITY_RE AND BANKID BETWEEN @BANKID_RS AND @BANKID_RE AND ( STATE = @STATE AND CITY = @CITY AND BANKID > @BANKID OR STATE = @STATE AND CITY > @CITY OR STATE > @STATE ) ORDER BY STATE ASC, CITY ASC, BANKID ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  BANKID, BANKNAME, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, COUNTRY, PHNUMBR1, PHNUMBR2, PHONE3, FAXNUMBR, TRNSTNBR, BNKBRNCH, NOTEINDX, DDTRANUM, DEX_ROW_ID FROM .SY04100 WHERE STATE BETWEEN @STATE_RS AND @STATE_RE AND CITY BETWEEN @CITY_RS AND @CITY_RE AND BANKID BETWEEN @BANKID_RS AND @BANKID_RE AND ( STATE = @STATE AND CITY = @CITY AND BANKID > @BANKID OR STATE = @STATE AND CITY > @CITY OR STATE > @STATE ) ORDER BY STATE ASC, CITY ASC, BANKID ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY04100UN_3] TO [DYNGRP]
GO
