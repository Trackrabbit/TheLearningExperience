SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SY70500L_1] (@RPTGRIND_RS smallint, @RTPACHIN_RS smallint, @RTGRSBIN_RS numeric(19,5), @RPTGRIND_RE smallint, @RTPACHIN_RE smallint, @RTGRSBIN_RE numeric(19,5)) AS  set nocount on IF @RPTGRIND_RS IS NULL BEGIN SELECT TOP 25  STDPSSRS, ENDPSERS, STSERVID, ENDSRVID, FINRPTNM, PRNTNOTS, PRNTTYPE, STRTCMNM, STRTZPCD, STWSTNTY, STTCATEG, ENDCATEG, ENDCMPNM, ENDZIPCD, ENDWSTYP, ASKECHTM, INCLGNDS, PRNTOFIL, PRTOPRTR, PRTOSCRN, IFFILXST, FILEXPNM, EXPTTYPE, RPTGRIND, RTPACHIN, RTGRSBIN, SORTBY, RPTYPSEC, ENDUSRID, ENDUSRNM, ENDUSRCL, ENDINGDT, ENDTKNDT, ENDFRSRS, STTUSRID, STTUSRNM, STTUSRCL, STRTNGDT, STTOKNDT, STTFMSRS, STCURRID, ENDCURID, STCURRDESC, ENDCURRDESC, STEXTABID, ENDEXTABID, STEXTABDESC, ENDEXTABDESC, STICID, ENDICID, STSECMODALTID, STSECROLEID, STSECTASKCAT, STSECTASKID, ENDSECMODALTID, ENDSECROLEID, ENDSECTASKCAT, ENDSECTASKID, IncludeInactiveUsers, DEX_ROW_ID FROM .SY70500 ORDER BY RPTGRIND DESC, RTPACHIN DESC, RTGRSBIN DESC END ELSE IF @RPTGRIND_RS = @RPTGRIND_RE BEGIN SELECT TOP 25  STDPSSRS, ENDPSERS, STSERVID, ENDSRVID, FINRPTNM, PRNTNOTS, PRNTTYPE, STRTCMNM, STRTZPCD, STWSTNTY, STTCATEG, ENDCATEG, ENDCMPNM, ENDZIPCD, ENDWSTYP, ASKECHTM, INCLGNDS, PRNTOFIL, PRTOPRTR, PRTOSCRN, IFFILXST, FILEXPNM, EXPTTYPE, RPTGRIND, RTPACHIN, RTGRSBIN, SORTBY, RPTYPSEC, ENDUSRID, ENDUSRNM, ENDUSRCL, ENDINGDT, ENDTKNDT, ENDFRSRS, STTUSRID, STTUSRNM, STTUSRCL, STRTNGDT, STTOKNDT, STTFMSRS, STCURRID, ENDCURID, STCURRDESC, ENDCURRDESC, STEXTABID, ENDEXTABID, STEXTABDESC, ENDEXTABDESC, STICID, ENDICID, STSECMODALTID, STSECROLEID, STSECTASKCAT, STSECTASKID, ENDSECMODALTID, ENDSECROLEID, ENDSECTASKCAT, ENDSECTASKID, IncludeInactiveUsers, DEX_ROW_ID FROM .SY70500 WHERE RPTGRIND = @RPTGRIND_RS AND RTPACHIN BETWEEN @RTPACHIN_RS AND @RTPACHIN_RE AND RTGRSBIN BETWEEN @RTGRSBIN_RS AND @RTGRSBIN_RE ORDER BY RPTGRIND DESC, RTPACHIN DESC, RTGRSBIN DESC END ELSE BEGIN SELECT TOP 25  STDPSSRS, ENDPSERS, STSERVID, ENDSRVID, FINRPTNM, PRNTNOTS, PRNTTYPE, STRTCMNM, STRTZPCD, STWSTNTY, STTCATEG, ENDCATEG, ENDCMPNM, ENDZIPCD, ENDWSTYP, ASKECHTM, INCLGNDS, PRNTOFIL, PRTOPRTR, PRTOSCRN, IFFILXST, FILEXPNM, EXPTTYPE, RPTGRIND, RTPACHIN, RTGRSBIN, SORTBY, RPTYPSEC, ENDUSRID, ENDUSRNM, ENDUSRCL, ENDINGDT, ENDTKNDT, ENDFRSRS, STTUSRID, STTUSRNM, STTUSRCL, STRTNGDT, STTOKNDT, STTFMSRS, STCURRID, ENDCURID, STCURRDESC, ENDCURRDESC, STEXTABID, ENDEXTABID, STEXTABDESC, ENDEXTABDESC, STICID, ENDICID, STSECMODALTID, STSECROLEID, STSECTASKCAT, STSECTASKID, ENDSECMODALTID, ENDSECROLEID, ENDSECTASKCAT, ENDSECTASKID, IncludeInactiveUsers, DEX_ROW_ID FROM .SY70500 WHERE RPTGRIND BETWEEN @RPTGRIND_RS AND @RPTGRIND_RE AND RTPACHIN BETWEEN @RTPACHIN_RS AND @RTPACHIN_RE AND RTGRSBIN BETWEEN @RTGRSBIN_RS AND @RTGRSBIN_RE ORDER BY RPTGRIND DESC, RTPACHIN DESC, RTGRSBIN DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY70500L_1] TO [DYNGRP]
GO
