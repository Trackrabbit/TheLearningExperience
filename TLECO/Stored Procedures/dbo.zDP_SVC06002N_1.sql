SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SVC06002N_1] (@BS int, @DEPSTATGRP char(11), @STATIONID char(11), @DEPSTATGRP_RS char(11), @STATIONID_RS char(11), @DEPSTATGRP_RE char(11), @STATIONID_RE char(11)) AS  set nocount on IF @DEPSTATGRP_RS IS NULL BEGIN SELECT TOP 25  DEPSTATGRP, STATIONID, DEX_ROW_ID FROM .SVC06002 WHERE ( DEPSTATGRP = @DEPSTATGRP AND STATIONID > @STATIONID OR DEPSTATGRP > @DEPSTATGRP ) ORDER BY DEPSTATGRP ASC, STATIONID ASC END ELSE IF @DEPSTATGRP_RS = @DEPSTATGRP_RE BEGIN SELECT TOP 25  DEPSTATGRP, STATIONID, DEX_ROW_ID FROM .SVC06002 WHERE DEPSTATGRP = @DEPSTATGRP_RS AND STATIONID BETWEEN @STATIONID_RS AND @STATIONID_RE AND ( DEPSTATGRP = @DEPSTATGRP AND STATIONID > @STATIONID OR DEPSTATGRP > @DEPSTATGRP ) ORDER BY DEPSTATGRP ASC, STATIONID ASC END ELSE BEGIN SELECT TOP 25  DEPSTATGRP, STATIONID, DEX_ROW_ID FROM .SVC06002 WHERE DEPSTATGRP BETWEEN @DEPSTATGRP_RS AND @DEPSTATGRP_RE AND STATIONID BETWEEN @STATIONID_RS AND @STATIONID_RE AND ( DEPSTATGRP = @DEPSTATGRP AND STATIONID > @STATIONID OR DEPSTATGRP > @DEPSTATGRP ) ORDER BY DEPSTATGRP ASC, STATIONID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SVC06002N_1] TO [DYNGRP]
GO
