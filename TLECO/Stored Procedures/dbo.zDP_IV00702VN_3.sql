SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IV00702VN_3] (@BS int, @ORDDOCID char(15), @LNITMSEQ int, @OVRSERLT smallint, @SLTSQNUM int, @ORDDOCID_RS char(15), @LNITMSEQ_RS int, @OVRSERLT_RS smallint, @SLTSQNUM_RS int, @ORDDOCID_RE char(15), @LNITMSEQ_RE int, @OVRSERLT_RE smallint, @SLTSQNUM_RE int) AS  set nocount on IF @ORDDOCID_RS IS NULL BEGIN SELECT TOP 25  ORDDOCID, LNITMSEQ, QTYTYPE, SERLTNUM, SERLTQTY, SLTSQNUM, ITEMNMBR, DATERECD, POSTED, FROMBIN, TOBIN, Status, OVRSERLT, MFGDATE, EXPNDATE, UNITCOST, DTSEQNUM, DEX_ROW_ID FROM .IV00702V WHERE ( ORDDOCID = @ORDDOCID AND LNITMSEQ = @LNITMSEQ AND OVRSERLT = @OVRSERLT AND SLTSQNUM > @SLTSQNUM OR ORDDOCID = @ORDDOCID AND LNITMSEQ = @LNITMSEQ AND OVRSERLT > @OVRSERLT OR ORDDOCID = @ORDDOCID AND LNITMSEQ > @LNITMSEQ OR ORDDOCID > @ORDDOCID ) ORDER BY ORDDOCID ASC, LNITMSEQ ASC, OVRSERLT ASC, SLTSQNUM ASC END ELSE IF @ORDDOCID_RS = @ORDDOCID_RE BEGIN SELECT TOP 25  ORDDOCID, LNITMSEQ, QTYTYPE, SERLTNUM, SERLTQTY, SLTSQNUM, ITEMNMBR, DATERECD, POSTED, FROMBIN, TOBIN, Status, OVRSERLT, MFGDATE, EXPNDATE, UNITCOST, DTSEQNUM, DEX_ROW_ID FROM .IV00702V WHERE ORDDOCID = @ORDDOCID_RS AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE AND OVRSERLT BETWEEN @OVRSERLT_RS AND @OVRSERLT_RE AND SLTSQNUM BETWEEN @SLTSQNUM_RS AND @SLTSQNUM_RE AND ( ORDDOCID = @ORDDOCID AND LNITMSEQ = @LNITMSEQ AND OVRSERLT = @OVRSERLT AND SLTSQNUM > @SLTSQNUM OR ORDDOCID = @ORDDOCID AND LNITMSEQ = @LNITMSEQ AND OVRSERLT > @OVRSERLT OR ORDDOCID = @ORDDOCID AND LNITMSEQ > @LNITMSEQ OR ORDDOCID > @ORDDOCID ) ORDER BY ORDDOCID ASC, LNITMSEQ ASC, OVRSERLT ASC, SLTSQNUM ASC END ELSE BEGIN SELECT TOP 25  ORDDOCID, LNITMSEQ, QTYTYPE, SERLTNUM, SERLTQTY, SLTSQNUM, ITEMNMBR, DATERECD, POSTED, FROMBIN, TOBIN, Status, OVRSERLT, MFGDATE, EXPNDATE, UNITCOST, DTSEQNUM, DEX_ROW_ID FROM .IV00702V WHERE ORDDOCID BETWEEN @ORDDOCID_RS AND @ORDDOCID_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE AND OVRSERLT BETWEEN @OVRSERLT_RS AND @OVRSERLT_RE AND SLTSQNUM BETWEEN @SLTSQNUM_RS AND @SLTSQNUM_RE AND ( ORDDOCID = @ORDDOCID AND LNITMSEQ = @LNITMSEQ AND OVRSERLT = @OVRSERLT AND SLTSQNUM > @SLTSQNUM OR ORDDOCID = @ORDDOCID AND LNITMSEQ = @LNITMSEQ AND OVRSERLT > @OVRSERLT OR ORDDOCID = @ORDDOCID AND LNITMSEQ > @LNITMSEQ OR ORDDOCID > @ORDDOCID ) ORDER BY ORDDOCID ASC, LNITMSEQ ASC, OVRSERLT ASC, SLTSQNUM ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IV00702VN_3] TO [DYNGRP]
GO
