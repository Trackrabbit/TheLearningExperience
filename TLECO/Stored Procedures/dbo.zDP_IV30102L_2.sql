SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IV30102L_2] (@SMRYTYPE_RS smallint, @LOCNCODE_RS char(11), @YEAR1_RS smallint, @SMRYPMTH_RS smallint, @SMRYTYPE_RE smallint, @LOCNCODE_RE char(11), @YEAR1_RE smallint, @SMRYPMTH_RE smallint) AS  set nocount on IF @SMRYTYPE_RS IS NULL BEGIN SELECT TOP 25  ITEMNMBR, LOCNCODE, SMRYTYPE, SMRYPMTH, YEAR1, SMRYQTYS, SMRYCOST, SMRYSALS, SMMRYDPNDNTUSGQTY, SMMRYDPNDNTUSGCST, SMMRYPRJCTDUSGQTY, DEX_ROW_ID FROM .IV30102 ORDER BY SMRYTYPE DESC, LOCNCODE DESC, YEAR1 DESC, SMRYPMTH DESC, DEX_ROW_ID DESC END ELSE IF @SMRYTYPE_RS = @SMRYTYPE_RE BEGIN SELECT TOP 25  ITEMNMBR, LOCNCODE, SMRYTYPE, SMRYPMTH, YEAR1, SMRYQTYS, SMRYCOST, SMRYSALS, SMMRYDPNDNTUSGQTY, SMMRYDPNDNTUSGCST, SMMRYPRJCTDUSGQTY, DEX_ROW_ID FROM .IV30102 WHERE SMRYTYPE = @SMRYTYPE_RS AND LOCNCODE BETWEEN @LOCNCODE_RS AND @LOCNCODE_RE AND YEAR1 BETWEEN @YEAR1_RS AND @YEAR1_RE AND SMRYPMTH BETWEEN @SMRYPMTH_RS AND @SMRYPMTH_RE ORDER BY SMRYTYPE DESC, LOCNCODE DESC, YEAR1 DESC, SMRYPMTH DESC, DEX_ROW_ID DESC END ELSE BEGIN SELECT TOP 25  ITEMNMBR, LOCNCODE, SMRYTYPE, SMRYPMTH, YEAR1, SMRYQTYS, SMRYCOST, SMRYSALS, SMMRYDPNDNTUSGQTY, SMMRYDPNDNTUSGCST, SMMRYPRJCTDUSGQTY, DEX_ROW_ID FROM .IV30102 WHERE SMRYTYPE BETWEEN @SMRYTYPE_RS AND @SMRYTYPE_RE AND LOCNCODE BETWEEN @LOCNCODE_RS AND @LOCNCODE_RE AND YEAR1 BETWEEN @YEAR1_RS AND @YEAR1_RE AND SMRYPMTH BETWEEN @SMRYPMTH_RS AND @SMRYPMTH_RE ORDER BY SMRYTYPE DESC, LOCNCODE DESC, YEAR1 DESC, SMRYPMTH DESC, DEX_ROW_ID DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IV30102L_2] TO [DYNGRP]
GO
