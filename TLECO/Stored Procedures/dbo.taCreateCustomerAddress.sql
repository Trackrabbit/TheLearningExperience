SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[taCreateCustomerAddress]  @I_vCUSTNMBR char(15),    @I_vADRSCODE char(15),    @I_vSLPRSNID char(15) = null,   @I_vUPSZONE char(3) = null,   @I_vSHIPMTHD char(15) = null,   @I_vTAXSCHID char(15) = null,   @I_vCNTCPRSN char(60) = null,   @I_vADDRESS1 char(60) = null,   @I_vADDRESS2 char(60) = null,     @I_vADDRESS3 char(60) = null,     @I_vCOUNTRY char(60) = null,   @I_vCITY char(35) = null,   @I_vSTATE char(29) = null,   @I_vZIPCODE char(10) = null,    @I_vPHNUMBR1 char(21) = null,   @I_vPHNUMBR2 char(21) = null,   @I_vPHNUMBR3 char(21) = null,   @I_vFAX char(21) = null,   @I_vGPSFOINTEGRATIONID char(30) = null,  @I_vINTEGRATIONSOURCE smallint = null,  @I_vINTEGRATIONID char(30) = null,  @I_vCCode char(6) = null,   @I_vLOCNCODE char(10) = null,   @I_vSALSTERR char(15) = null,   @I_vShipToName char(64) = null,      @I_vPrint_Phone_NumberGB smallint = null,  @I_vUSERDEF1 char(20) = null,   @I_vUSERDEF2 char(20) = null,   @I_vUpdateIfExists tinyint = 1,   @I_vRequesterTrx smallint = 0,   @I_vUSRDEFND1 char(50) = null,       @I_vUSRDEFND2 char(50) = null,       @I_vUSRDEFND3 char(50) = null,       @I_vUSRDEFND4 varchar(8000) = null,  @I_vUSRDEFND5 varchar(8000) = null,  @O_iErrorState int output, @oErrString varchar(255) output  with encryption as  set transaction isolation level read uncommitted set nocount on  declare @O_oErrorState int,  @iCustomState int,  @iCustomErrString varchar(255),  @iStatus int,  @iAddShippingErrState int,  @iAddShippingErrString varchar(255),  @iError int,  @exists tinyint,  @SLPRSNID char(15),  @SALSTERR char(15),  @CCode char(6),  @COUNTRY char(60),  @CUSTNAME char (65)  select @O_iErrorState = 0,  @O_oErrorState = 0,  @iCustomState = 0,  @iCustomErrString = '',  @iStatus = 0,  @iAddShippingErrState = 0,  @iAddShippingErrString = '',  @iError = 0,  @exists = 0,  @SLPRSNID = '',  @SALSTERR = '',  @CCode = '',  @COUNTRY = '',  @CUSTNAME = ''  if (@oErrString is null) begin  select @oErrString = '' end  exec @iStatus = taCreateCustomerAddressPre  @I_vCUSTNMBR output,  @I_vADRSCODE output,  @I_vSLPRSNID output,  @I_vUPSZONE output,  @I_vSHIPMTHD output,  @I_vTAXSCHID output,  @I_vCNTCPRSN output,  @I_vADDRESS1 output,  @I_vADDRESS2 output,  @I_vADDRESS3 output,  @I_vCOUNTRY output,  @I_vCITY output,  @I_vSTATE output,  @I_vZIPCODE output,  @I_vPHNUMBR1 output,  @I_vPHNUMBR2 output,  @I_vPHNUMBR3 output,  @I_vFAX output,  @I_vGPSFOINTEGRATIONID output,  @I_vINTEGRATIONSOURCE output,  @I_vINTEGRATIONID output,  @I_vCCode output,  @I_vLOCNCODE output,  @I_vSALSTERR output,  @I_vShipToName output,  @I_vPrint_Phone_NumberGB output,  @I_vUSERDEF1 output,  @I_vUSERDEF2 output,  @I_vUpdateIfExists output,  @I_vRequesterTrx output,  @I_vUSRDEFND1 output,  @I_vUSRDEFND2 output,  @I_vUSRDEFND3 output,  @I_vUSRDEFND4 output,  @I_vUSRDEFND5 output,  @O_iErrorState  = @iCustomState output,  @oErrString = @iCustomErrString output  select @iError = @@error if ((@iStatus <> 0) or (@iCustomState <> 0) or (@iError <> 0)) begin  select @O_iErrorState = 3471    exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output end  if ( @I_vCUSTNMBR is null or  @I_vADRSCODE is null or  @I_vUpdateIfExists is null or  @I_vRequesterTrx is null) begin  select @O_iErrorState = 98    exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output end  select  @I_vCUSTNMBR = UPPER(@I_vCUSTNMBR),  @I_vADRSCODE = UPPER(@I_vADRSCODE),  @I_vSLPRSNID = UPPER(@I_vSLPRSNID),  @I_vSHIPMTHD = UPPER(@I_vSHIPMTHD),  @I_vTAXSCHID = UPPER(@I_vTAXSCHID),  @I_vCCode = UPPER(@I_vCCode),  @I_vLOCNCODE = UPPER(@I_vLOCNCODE),  @I_vSALSTERR = UPPER(@I_vSALSTERR)   select  @SLPRSNID = @I_vSLPRSNID,  @SALSTERR = @I_vSALSTERR,  @CCode = @I_vCCode,  @COUNTRY = @I_vCOUNTRY  if (@I_vCUSTNMBR = '') begin  select @O_iErrorState = 99    exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vCUSTNMBR <> '') begin  if not exists(select 1 from RM00101 (nolock) where CUSTNMBR = @I_vCUSTNMBR)  begin   select @O_iErrorState = 118    exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vADRSCODE = '') begin  select @O_iErrorState = 107    exec @iStatus = taUpdateString   @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output end  if (exists(select 1 from RM00102 (nolock) where CUSTNMBR = @I_vCUSTNMBR and ADRSCODE = @I_vADRSCODE)) begin  select @exists = 1 end  if (@exists = 0) begin  select  @I_vSLPRSNID =  case  when @I_vSLPRSNID is null  then ''  else @I_vSLPRSNID  end,  @I_vUPSZONE =  case  when @I_vUPSZONE is null  then ''  else @I_vUPSZONE  end,  @I_vSHIPMTHD =  case  when @I_vSHIPMTHD is null  then ''  else @I_vSHIPMTHD  end,  @I_vTAXSCHID =  case  when @I_vTAXSCHID is null  then ''  else @I_vTAXSCHID  end,  @I_vCNTCPRSN =  case  when @I_vCNTCPRSN is null  then ''  else @I_vCNTCPRSN  end,  @I_vADDRESS1 =  case  when @I_vADDRESS1 is null  then ''  else @I_vADDRESS1  end,  @I_vADDRESS2 =  case  when @I_vADDRESS2 is null  then ''  else @I_vADDRESS2  end,  @I_vADDRESS3 =  case  when @I_vADDRESS3 is null  then ''  else @I_vADDRESS3  end,  @I_vCITY =  case  when @I_vCITY is null  then ''  else @I_vCITY  end,  @I_vSTATE =  case  when @I_vSTATE is null  then ''  else @I_vSTATE  end,  @I_vZIPCODE =  case  when @I_vZIPCODE is null  then ''  else @I_vZIPCODE  end,  @I_vPHNUMBR1 =  case  when @I_vPHNUMBR1 is null  then ''  else @I_vPHNUMBR1  end,  @I_vPHNUMBR2 =  case  when @I_vPHNUMBR2 is null  then ''  else @I_vPHNUMBR2  end,  @I_vPHNUMBR3 =  case  when @I_vPHNUMBR3 is null  then ''  else @I_vPHNUMBR3  end,  @I_vFAX =  case  when @I_vFAX is null  then ''  else @I_vFAX  end,  @I_vGPSFOINTEGRATIONID =  case  when @I_vGPSFOINTEGRATIONID is null  then ''  else @I_vGPSFOINTEGRATIONID  end,  @I_vINTEGRATIONSOURCE =  case  when @I_vINTEGRATIONSOURCE is null  then 0  else @I_vINTEGRATIONSOURCE  end,  @I_vINTEGRATIONID =  case  when @I_vINTEGRATIONID is null  then ''  else @I_vINTEGRATIONID  end,  @I_vCCode =  case  when @I_vCCode is null  then ''  else @I_vCCode  end,  @I_vLOCNCODE =  case  when @I_vLOCNCODE is null  then ''  else @I_vLOCNCODE  end,  @I_vUSERDEF1 =  case  when @I_vUSERDEF1 is null  then ''  else @I_vUSERDEF1  end,  @I_vUSERDEF2 =  case  when @I_vUSERDEF2 is null  then ''  else @I_vUSERDEF2  end,  @I_vShipToName =   case   when @I_vShipToName is null  then ''  else @I_vShipToName  end,  @I_vPrint_Phone_NumberGB =   case   when @I_vPrint_Phone_NumberGB is null  then 0  else @I_vPrint_Phone_NumberGB  end   if ((@I_vSALSTERR is null) and (@I_vSLPRSNID <> ''))  begin  select @I_vSALSTERR = SALSTERR from RM00301 (nolock) where SLPRSNID = @I_vSLPRSNID  end   if (@I_vSALSTERR is null)  begin  select @I_vSALSTERR = ''   end   if ((@I_vCOUNTRY is null) and (@I_vCCode <> ''))  begin  select @I_vCOUNTRY = CCodeDesc from VAT10001 (nolock) where CCode = @I_vCCode  end   if (@I_vCOUNTRY is null)  begin  select @I_vCOUNTRY = ''  end    if (@I_vShipToName = '')  begin  select @CUSTNAME = CUSTNAME from RM00101 where CUSTNMBR = @I_vCUSTNMBR  select @I_vShipToName = @CUSTNAME  end end else begin  select  @I_vSLPRSNID =  case  when @I_vSLPRSNID is null  then SLPRSNID  else @I_vSLPRSNID  end,  @I_vUPSZONE =  case  when @I_vUPSZONE is null  then UPSZONE  else @I_vUPSZONE  end,  @I_vSHIPMTHD =  case  when @I_vSHIPMTHD is null  then SHIPMTHD  else @I_vSHIPMTHD  end,  @I_vTAXSCHID =  case  when @I_vTAXSCHID is null  then TAXSCHID  else @I_vTAXSCHID  end,  @I_vCNTCPRSN =  case  when @I_vCNTCPRSN is null  then CNTCPRSN  else @I_vCNTCPRSN  end,  @I_vADDRESS1 =  case  when @I_vADDRESS1 is null  then ADDRESS1  else @I_vADDRESS1  end,  @I_vADDRESS2 =  case  when @I_vADDRESS2 is null  then ADDRESS2  else @I_vADDRESS2  end,  @I_vADDRESS3 =  case  when @I_vADDRESS3 is null  then ADDRESS3  else @I_vADDRESS3  end,  @I_vCOUNTRY =       case  when @I_vCOUNTRY is null  then COUNTRY  else @I_vCOUNTRY  end,  @I_vCITY =  case  when @I_vCITY is null  then CITY  else @I_vCITY  end,  @I_vSTATE =  case  when @I_vSTATE is null  then STATE  else @I_vSTATE  end,  @I_vZIPCODE =  case  when @I_vZIPCODE is null  then ZIP  else @I_vZIPCODE  end,  @I_vPHNUMBR1 =  case  when @I_vPHNUMBR1 is null  then PHONE1  else @I_vPHNUMBR1  end,  @I_vPHNUMBR2 =  case  when @I_vPHNUMBR2 is null  then PHONE2  else @I_vPHNUMBR2  end,  @I_vPHNUMBR3 =  case  when @I_vPHNUMBR3 is null  then PHONE3  else @I_vPHNUMBR3  end,  @I_vFAX =  case  when @I_vFAX is null  then FAX  else @I_vFAX  end,  @I_vGPSFOINTEGRATIONID =  case  when @I_vGPSFOINTEGRATIONID is null  then GPSFOINTEGRATIONID  else @I_vGPSFOINTEGRATIONID  end,  @I_vINTEGRATIONSOURCE =  case  when @I_vINTEGRATIONSOURCE is null  then INTEGRATIONSOURCE  else @I_vINTEGRATIONSOURCE  end,  @I_vINTEGRATIONID =  case  when @I_vINTEGRATIONID is null  then INTEGRATIONID  else @I_vINTEGRATIONID  end,  @I_vCCode =  case  when @I_vCCode is null  then CCode  else @I_vCCode  end,  @I_vLOCNCODE =  case  when @I_vLOCNCODE is null  then LOCNCODE  else @I_vLOCNCODE  end,  @I_vSALSTERR =       case  when @I_vSALSTERR is null  then SALSTERR  else @I_vSALSTERR  end,  @I_vUSERDEF1 =  case  when @I_vUSERDEF1 is null  then USERDEF1  else @I_vUSERDEF1  end,  @I_vUSERDEF2 =  case  when @I_vUSERDEF2 is null  then USERDEF2  else @I_vUSERDEF2  end,  @I_vShipToName =   case   when @I_vShipToName is null  then ShipToName  else @I_vShipToName  end,  @I_vPrint_Phone_NumberGB =   case   when @I_vPrint_Phone_NumberGB is null  then Print_Phone_NumberGB  else @I_vPrint_Phone_NumberGB  end  from RM00102 (nolock) where CUSTNMBR = @I_vCUSTNMBR and ADRSCODE = @I_vADRSCODE   if ((@SLPRSNID is not null) and (@SALSTERR is null))  begin  select @I_vSALSTERR = SALSTERR from RM00301 (nolock) where SLPRSNID = @I_vSLPRSNID  end   if ((@SLPRSNID = '') and (@SALSTERR is null))  begin  select @I_vSALSTERR = ''  end   if ((@CCode is not null) and (@COUNTRY is null))  begin  select @I_vCOUNTRY = CCodeDesc from VAT10001 (nolock) where CCode = @I_vCCode  end   if ((@CCode = '') and (@COUNTRY is null))  begin  select @I_vCOUNTRY = ''  end  end  if (@I_vSLPRSNID <> '') begin  if (not exists(select 1 from RM00301 (nolock) where SLPRSNID = @I_vSLPRSNID))  begin   select @O_iErrorState = 8285     exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vTAXSCHID <> '') begin  if not exists(select 1 from TX00101 (nolock) where TAXSCHID = @I_vTAXSCHID)  begin   select @O_iErrorState = 117     exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vSHIPMTHD <> '') begin  if (not exists(select 1 from SY03000 (nolock) where SHIPMTHD = @I_vSHIPMTHD))  begin  exec @iStatus = taCreateShippingMethod  @I_vSHIPMTHD = @I_vSHIPMTHD,  @I_vUpdateIfExists = 0,  @O_iErrorState = @iAddShippingErrState output,  @oErrString = @iAddShippingErrString output  select @iError = @@error  if ((@iStatus <> 0) or (@iAddShippingErrState <> 0) or (@iError <> 0))  begin  select @oErrString = rtrim(@oErrString) + ' ' + @iAddShippingErrString  select @O_iErrorState = 176    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  end end  if (@I_vCCode <> '') begin  if (not exists(select 1 from VAT10001 (nolock) where CCode = @I_vCCode))  begin  select @O_iErrorState = 6307     exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vLOCNCODE <> '') begin  if (not exists(select 1 from IV40700 (nolock) where LOCNCODE = @I_vLOCNCODE))  begin  select @O_iErrorState = 6308     exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vSALSTERR <> '') begin  if (not exists(select 1 from RM00303 (nolock) where SALSTERR = @I_vSALSTERR))  begin  select @O_iErrorState = 6309     exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vUpdateIfExists not in(0,1)) begin  select @O_iErrorState = 9365     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (exists (select 1 from RM00102 (nolock) where CUSTNMBR = @I_vCUSTNMBR and ADRSCODE = @I_vADRSCODE)) and (@I_vUpdateIfExists = 0) begin  select @O_iErrorState = 9366     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vRequesterTrx not in(0,1)) begin  select @O_iErrorState = 3618     exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vPrint_Phone_NumberGB not in(0,1,2,3,4)) begin  select @O_iErrorState = 11762     exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output end  if (@O_iErrorState <> 0) begin  return (@O_iErrorState) end  if (@I_vRequesterTrx = 0) begin  exec @iStatus = eConnectOutVerify  @I_vDOCTYPE = 'Customer',  @I_vINDEX1 = @I_vCUSTNMBR,  @I_vINDEX2 = '',  @I_vINDEX3 = '',  @I_vINDEX4 = '',  @I_vINDEX5 = '',  @I_vINDEX6 = '',  @I_vINDEX7 = '',  @I_vINDEX8 = '',  @I_vINDEX9 = '',  @I_vINDEX10 = '',  @I_vINDEX11 = '',  @I_vINDEX12 = '',  @I_vINDEX13 = '',  @I_vINDEX14 = '',  @I_vINDEX15 = '',  @I_vDelete = 0,  @O_iErrorState = @iCustomState output  select @iError = @@error  if ((@iStatus <> 0) or (@iCustomState <> 0) or (@iError <> 0))  begin  select @oErrString = rtrim(@oErrString) + ' ' + @iCustomState  select @O_iErrorState = 3001   exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  if (@O_iErrorState = 0) begin  if (not exists (select 1 from RM00102 (nolock) where CUSTNMBR = @I_vCUSTNMBR and ADRSCODE = @I_vADRSCODE))  begin  insert RM00102  (  CUSTNMBR,  ADRSCODE,  SLPRSNID,  UPSZONE,  SHIPMTHD,  TAXSCHID,  CNTCPRSN,  ADDRESS1,  ADDRESS2,  ADDRESS3,  COUNTRY,  CITY,  STATE,  ZIP,  PHONE1,  PHONE2,  PHONE3,  FAX,  MODIFDT,  CREATDDT,  GPSFOINTEGRATIONID,  INTEGRATIONSOURCE,  INTEGRATIONID,  CCode,  DECLID,  LOCNCODE,  SALSTERR,  USERDEF1,  USERDEF2,  ShipToName,  Print_Phone_NumberGB  )  select  @I_vCUSTNMBR,     @I_vADRSCODE,     @I_vSLPRSNID,     @I_vUPSZONE,      @I_vSHIPMTHD,     @I_vTAXSCHID,     @I_vCNTCPRSN,     @I_vADDRESS1,     @I_vADDRESS2,     @I_vADDRESS3,     @I_vCOUNTRY,     @I_vCITY,     @I_vSTATE,     @I_vZIPCODE,     @I_vPHNUMBR1,     @I_vPHNUMBR2,     @I_vPHNUMBR3,     @I_vFAX,     convert(varchar(12),getdate()),        convert(varchar(12),getdate()),        @I_vGPSFOINTEGRATIONID,    @I_vINTEGRATIONSOURCE,    @I_vINTEGRATIONID,    @I_vCCode,     '',      @I_vLOCNCODE,     @I_vSALSTERR,     @I_vUSERDEF1,     @I_vUSERDEF2,     @I_vShipToName,              @I_vPrint_Phone_NumberGB     if (@@error <> 0)  begin  select @O_iErrorState = 111    exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  end  else  begin  if (@I_vUpdateIfExists = 1)   begin  update RM00102 set  SLPRSNID = @I_vSLPRSNID,  UPSZONE = @I_vUPSZONE,  SHIPMTHD = @I_vSHIPMTHD,  TAXSCHID = @I_vTAXSCHID,  CNTCPRSN = @I_vCNTCPRSN,  ADDRESS1 = @I_vADDRESS1,  ADDRESS2 = @I_vADDRESS2,  ADDRESS3 = @I_vADDRESS3,  COUNTRY = @I_vCOUNTRY,  CITY = @I_vCITY,  STATE = @I_vSTATE,  ZIP = @I_vZIPCODE,  PHONE1 = @I_vPHNUMBR1,  PHONE2 = @I_vPHNUMBR2,  PHONE3 = @I_vPHNUMBR3,  FAX = @I_vFAX,  MODIFDT = convert(varchar(12),getdate()),   GPSFOINTEGRATIONID = @I_vGPSFOINTEGRATIONID,  INTEGRATIONSOURCE = @I_vINTEGRATIONSOURCE,  INTEGRATIONID = @I_vINTEGRATIONID,  CCode = @I_vCCode,  LOCNCODE = @I_vLOCNCODE,  SALSTERR = @I_vSALSTERR,  USERDEF1 = @I_vUSERDEF1,  USERDEF2 = @I_vUSERDEF2,  ShipToName = @I_vShipToName,  Print_Phone_NumberGB = @I_vPrint_Phone_NumberGB  where CUSTNMBR = @I_vCUSTNMBR and ADRSCODE = @I_vADRSCODE  if (@@error <> 0)  begin  select @O_iErrorState = 116    exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end   update RM00101 set  CNTCPRSN = @I_vCNTCPRSN,  ADDRESS1 = @I_vADDRESS1,  ADDRESS2 = @I_vADDRESS2,  ADDRESS3 = @I_vADDRESS3,  CITY = @I_vCITY,  STATE = @I_vSTATE,  ZIP = @I_vZIPCODE,  COUNTRY = @I_vCOUNTRY,  PHONE1 = @I_vPHNUMBR1,  PHONE2 = @I_vPHNUMBR2,  PHONE3 = @I_vPHNUMBR3,  FAX = @I_vFAX,  UPSZONE = @I_vUPSZONE,  SHIPMTHD = @I_vSHIPMTHD,  TAXSCHID = @I_vTAXSCHID,  MODIFDT = convert(varchar(12),getdate()),  CCode = @I_vCCode,  SALSTERR = @I_vSALSTERR,  SLPRSNID = @I_vSLPRSNID       where CUSTNMBR = @I_vCUSTNMBR and ADRSCODE = @I_vADRSCODE  if (@@error <> 0)  begin  select @O_iErrorState = 2320    exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  end  end end  if (@O_iErrorState <> 0) begin  return (@O_iErrorState) end  exec @iStatus = taCreateCustomerAddressPost  @I_vCUSTNMBR,  @I_vADRSCODE,  @I_vSLPRSNID,  @I_vUPSZONE,  @I_vSHIPMTHD,  @I_vTAXSCHID,  @I_vCNTCPRSN,  @I_vADDRESS1,  @I_vADDRESS2,  @I_vADDRESS3,  @I_vCOUNTRY,  @I_vCITY,  @I_vSTATE,  @I_vZIPCODE,  @I_vPHNUMBR1,  @I_vPHNUMBR2,  @I_vPHNUMBR3,  @I_vFAX,  @I_vGPSFOINTEGRATIONID,  @I_vINTEGRATIONSOURCE,  @I_vINTEGRATIONID,  @I_vCCode,  @I_vLOCNCODE,  @I_vSALSTERR,  @I_vShipToName,  @I_vPrint_Phone_NumberGB,  @I_vUSERDEF1,  @I_vUSERDEF2,  @I_vUpdateIfExists,  @I_vRequesterTrx,  @I_vUSRDEFND1,  @I_vUSRDEFND2,  @I_vUSRDEFND3,  @I_vUSRDEFND4,  @I_vUSRDEFND5,  @O_iErrorState  = @iCustomState output,  @oErrString = @iCustomErrString output  select @iError = @@error if ((@iStatus <> 0) or (@iCustomState <> 0) or (@iError <> 0)) begin  select @O_iErrorState = 1326    exec @iStatus = taUpdateString  @O_iErrorState,  @iCustomErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if (@I_vRequesterTrx = 0) begin  exec @iStatus = eConnectOutVerify  @I_vDOCTYPE = 'Customer',  @I_vINDEX1 = @I_vCUSTNMBR,  @I_vINDEX2 = '',  @I_vINDEX3 = '',  @I_vINDEX4 = '',  @I_vINDEX5 = '',  @I_vINDEX6 = '',  @I_vINDEX7 = '',  @I_vINDEX8 = '',  @I_vINDEX9 = '',  @I_vINDEX10 = '',  @I_vINDEX11 = '',  @I_vINDEX12 = '',  @I_vINDEX13 = '',  @I_vINDEX14 = '',  @I_vINDEX15 = '',  @I_vDelete = 1,  @O_iErrorState = @iCustomState output  select @iError = @@error  if ((@iStatus <> 0) or (@iCustomState <> 0) or (@iError <> 0))  begin  select @oErrString = rtrim(@oErrString) + ' ' + @iCustomState  select @O_iErrorState = 3387   exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  return (@O_iErrorState)   
GO
GRANT EXECUTE ON  [dbo].[taCreateCustomerAddress] TO [DYNGRP]
GO
