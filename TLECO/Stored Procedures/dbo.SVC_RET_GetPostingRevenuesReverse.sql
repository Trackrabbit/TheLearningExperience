SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 CREATE Procedure [dbo].[SVC_RET_GetPostingRevenuesReverse]  (  @Year integer,  @Period integer,  @User char(15)   ) As delete from SVC00625 where USERID = @User  insert into SVC00625  SELECT @User, SVC00601.CONSTS, SVC00601.CONTNBR, SVC00600.CNTTYPE,SVC00601.CUSTNMBR, YEAR1,  PERIODID,0,0, SUM(PSTDAMNT), SUM(Originating_PostedAmount) , '','','' FROM         SVC00604 INNER JOIN SVC00601 on (SVC00604.CONSTS = SVC00601.CONSTS AND SVC00604.CONTNBR = SVC00601.CONTNBR and SVC00604.LNSEQNBR = SVC00601.LNSEQNBR) inner join SVC00600 on (SVC00604.CONSTS = SVC00600.CONSTS AND SVC00604.CONTNBR = SVC00600.CONTNBR)  WHERE   ((YEAR1 = @Year and PERIODID = @Period)) and  (Status = 1) and SVC00601.CONSTS = 2 and SVC00601.Credit_Hold = 0 GROUP BY SVC00601.CONSTS, SVC00601.CONTNBR,SVC00600.CNTTYPE,SVC00601.CUSTNMBR,YEAR1, PERIODID  return    
GO
GRANT EXECUTE ON  [dbo].[SVC_RET_GetPostingRevenuesReverse] TO [DYNGRP]
GO
