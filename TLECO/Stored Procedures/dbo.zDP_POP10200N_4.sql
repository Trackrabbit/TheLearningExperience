SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_POP10200N_4] (@BS int, @RequisitionStatus smallint, @POPRequisitionNumber char(17), @RequisitionStatus_RS smallint, @POPRequisitionNumber_RS char(17), @RequisitionStatus_RE smallint, @POPRequisitionNumber_RE char(17)) AS  set nocount on IF @RequisitionStatus_RS IS NULL BEGIN SELECT TOP 25  POPRequisitionNumber, Requisition_Note_Index, RequisitionDescription, RequisitionStatus, COMMNTID, Comment_Note_Index, DOCDATE, REQDATE, REQSTDBY, PRSTADCD, CMPNYNAM, CONTACT, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, CCode, COUNTRY, PHONE1, PHONE2, PHONE3, FAX, DOCAMNT, CREATDDT, MODIFDT, USER2ENT, Flags, Workflow_Status, DomainUserName, USERDEF1, USERDEF2, DEX_ROW_TS, DEX_ROW_ID FROM .POP10200 WHERE ( RequisitionStatus = @RequisitionStatus AND POPRequisitionNumber > @POPRequisitionNumber OR RequisitionStatus > @RequisitionStatus ) ORDER BY RequisitionStatus ASC, POPRequisitionNumber ASC END ELSE IF @RequisitionStatus_RS = @RequisitionStatus_RE BEGIN SELECT TOP 25  POPRequisitionNumber, Requisition_Note_Index, RequisitionDescription, RequisitionStatus, COMMNTID, Comment_Note_Index, DOCDATE, REQDATE, REQSTDBY, PRSTADCD, CMPNYNAM, CONTACT, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, CCode, COUNTRY, PHONE1, PHONE2, PHONE3, FAX, DOCAMNT, CREATDDT, MODIFDT, USER2ENT, Flags, Workflow_Status, DomainUserName, USERDEF1, USERDEF2, DEX_ROW_TS, DEX_ROW_ID FROM .POP10200 WHERE RequisitionStatus = @RequisitionStatus_RS AND POPRequisitionNumber BETWEEN @POPRequisitionNumber_RS AND @POPRequisitionNumber_RE AND ( RequisitionStatus = @RequisitionStatus AND POPRequisitionNumber > @POPRequisitionNumber OR RequisitionStatus > @RequisitionStatus ) ORDER BY RequisitionStatus ASC, POPRequisitionNumber ASC END ELSE BEGIN SELECT TOP 25  POPRequisitionNumber, Requisition_Note_Index, RequisitionDescription, RequisitionStatus, COMMNTID, Comment_Note_Index, DOCDATE, REQDATE, REQSTDBY, PRSTADCD, CMPNYNAM, CONTACT, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIPCODE, CCode, COUNTRY, PHONE1, PHONE2, PHONE3, FAX, DOCAMNT, CREATDDT, MODIFDT, USER2ENT, Flags, Workflow_Status, DomainUserName, USERDEF1, USERDEF2, DEX_ROW_TS, DEX_ROW_ID FROM .POP10200 WHERE RequisitionStatus BETWEEN @RequisitionStatus_RS AND @RequisitionStatus_RE AND POPRequisitionNumber BETWEEN @POPRequisitionNumber_RS AND @POPRequisitionNumber_RE AND ( RequisitionStatus = @RequisitionStatus AND POPRequisitionNumber > @POPRequisitionNumber OR RequisitionStatus > @RequisitionStatus ) ORDER BY RequisitionStatus ASC, POPRequisitionNumber ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_POP10200N_4] TO [DYNGRP]
GO
