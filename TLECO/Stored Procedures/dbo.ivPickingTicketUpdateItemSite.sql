SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[ivPickingTicketUpdateItemSite]   @LocationCode   Char(10),  @PickingTicketOption tinyint,  @ReportTableOSName varchar(31),  @WorkTableOSName varchar(31)  AS  DECLARE @sql_statement as varchar(8000)  if @WorkTableOSName = ''   begin  update IV00102  set PICKTICKETITEMOPT = @PickingTicketOption  where LOCNCODE = @LocationCode  and RCRDTYPE = 2   select @sql_statement = ''  select @sql_statement = @sql_statement + 'delete from ' + @ReportTableOSName   exec (@sql_statement)   select @sql_statement = ''  select @sql_statement = @sql_statement + 'insert into ' + @ReportTableOSName + ' select a.LOCNCODE, a.ITEMNMBR, b.ITEMDESC, '  select @sql_statement = @sql_statement + 'b.ITMGEDSC, b.ITMCLSCD, c.PICKTICKETSITEOPT, a.PICKTICKETITEMOPT, '  select @sql_statement = @sql_statement + 'c.BINBREAK from IV00102 a, IV00101 b, IV40700 c where '  select @sql_statement = @sql_statement + 'a.LOCNCODE = '''+ @LocationCode + ''' and a.RCRDTYPE = 2 and b.ITEMNMBR '  select @sql_statement = @sql_statement + '= a.ITEMNMBR and c.LOCNCODE = a.LOCNCODE'  exec (@sql_statement)  end else  begin  select @sql_statement = ''  select @sql_statement = @sql_statement + 'update IV00102 set PICKTICKETITEMOPT = b.PICKTICKETITEMOPT from '  select @sql_statement = @sql_statement + 'IV00102 a, ' + @WorkTableOSName + ' b where a.ITEMNMBR = '  select @sql_statement = @sql_statement + 'b.ITEMNMBR and a.LOCNCODE = b.LOCNCODE and a.RCRDTYPE = 2'   exec (@sql_statement)   select @sql_statement = ''  select @sql_statement = @sql_statement + 'delete from ' + @ReportTableOSName   exec (@sql_statement)   select @sql_statement = ''  select @sql_statement = @sql_statement + 'insert into ' + @ReportTableOSName + ' select a.LOCNCODE, a.ITEMNMBR, b.ITEMDESC, '  select @sql_statement = @sql_statement + 'b.ITMGEDSC, b.ITMCLSCD, c.PICKTICKETSITEOPT, a.PICKTICKETITEMOPT, '  select @sql_statement = @sql_statement + 'c.BINBREAK from IV00102 a, IV00101 b, IV40700 c, ' + @WorkTableOSName + ' d where '  select @sql_statement = @sql_statement + 'a.LOCNCODE = d.LOCNCODE and a.ITEMNMBR = d.ITEMNMBR and a.RCRDTYPE = 2 and '  select @sql_statement = @sql_statement + 'b.ITEMNMBR = a.ITEMNMBR and c.LOCNCODE = a.LOCNCODE'  exec (@sql_statement)  end    
GO
GRANT EXECUTE ON  [dbo].[ivPickingTicketUpdateItemSite] TO [DYNGRP]
GO
