SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE PROC [dbo].[zDP_B4600900N_4] (@BS int, @LSTUSRED char(15), @DEX_ROW_ID int, @LSTUSRED_RS char(15), @LSTUSRED_RE char(15)) AS /* 12.00.0270.000 */ set nocount on IF @LSTUSRED_RS IS NULL BEGIN SELECT TOP 25  BSSI_ParentCompanyID, BSSI_Description, COMMENT_1, COMMENT_2, COMMENT_3, COMMENT_4, NOTEINDX, CRUSRID, CREATDDT, LSTUSRED, LSTEDTDT, DEX_ROW_ID FROM .B4600900 WHERE ( LSTUSRED = @LSTUSRED AND DEX_ROW_ID > @DEX_ROW_ID OR LSTUSRED > @LSTUSRED ) ORDER BY LSTUSRED ASC, DEX_ROW_ID ASC END ELSE IF @LSTUSRED_RS = @LSTUSRED_RE BEGIN SELECT TOP 25  BSSI_ParentCompanyID, BSSI_Description, COMMENT_1, COMMENT_2, COMMENT_3, COMMENT_4, NOTEINDX, CRUSRID, CREATDDT, LSTUSRED, LSTEDTDT, DEX_ROW_ID FROM .B4600900 WHERE LSTUSRED = @LSTUSRED_RS AND ( LSTUSRED = @LSTUSRED AND DEX_ROW_ID > @DEX_ROW_ID OR LSTUSRED > @LSTUSRED ) ORDER BY LSTUSRED ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  BSSI_ParentCompanyID, BSSI_Description, COMMENT_1, COMMENT_2, COMMENT_3, COMMENT_4, NOTEINDX, CRUSRID, CREATDDT, LSTUSRED, LSTEDTDT, DEX_ROW_ID FROM .B4600900 WHERE LSTUSRED BETWEEN @LSTUSRED_RS AND @LSTUSRED_RE AND ( LSTUSRED = @LSTUSRED AND DEX_ROW_ID > @DEX_ROW_ID OR LSTUSRED > @LSTUSRED ) ORDER BY LSTUSRED ASC, DEX_ROW_ID ASC END set nocount off 
GO
GRANT EXECUTE ON  [dbo].[zDP_B4600900N_4] TO [DYNGRP]
GO
