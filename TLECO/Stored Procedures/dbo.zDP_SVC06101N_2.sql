SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SVC06101N_2] (@BS int, @WORECTYPE smallint, @WORKORDNUM char(11), @SEQUENCE1 numeric(19,5), @DEX_ROW_ID int, @WORECTYPE_RS smallint, @WORKORDNUM_RS char(11), @SEQUENCE1_RS numeric(19,5), @WORECTYPE_RE smallint, @WORKORDNUM_RE char(11), @SEQUENCE1_RE numeric(19,5)) AS  set nocount on IF @WORECTYPE_RS IS NULL BEGIN SELECT TOP 25  WORECTYPE, WORKORDNUM, WOSTAT, LINITMTYP, LNITMSEQ, ITEMNMBR, ITEMUSETYPE, ITEMDESC, STATIONID, LOCNCODE, UOFM, TECHID, QTYORDER, ATYALLOC, QTYBACKO, QTYSOLD, UNITCOST, UNITPRCE, EXTDCOST, XTNDPRCE, STRTDATE, STRTTIME, ENDDATE, ENDTIME, TRANSTME, BILLABLTIM, NOTEINDX, SEQUENCE1, ORDDOCID, TRANSLINESEQ, PONMBRSTR, POLNSEQ, FUFILDAT, CMPNTSEQ, CMPITQTY, DEX_ROW_ID FROM .SVC06101 WHERE ( WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND SEQUENCE1 = @SEQUENCE1 AND DEX_ROW_ID > @DEX_ROW_ID OR WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND SEQUENCE1 > @SEQUENCE1 OR WORECTYPE = @WORECTYPE AND WORKORDNUM > @WORKORDNUM OR WORECTYPE > @WORECTYPE ) ORDER BY WORECTYPE ASC, WORKORDNUM ASC, SEQUENCE1 ASC, DEX_ROW_ID ASC END ELSE IF @WORECTYPE_RS = @WORECTYPE_RE BEGIN SELECT TOP 25  WORECTYPE, WORKORDNUM, WOSTAT, LINITMTYP, LNITMSEQ, ITEMNMBR, ITEMUSETYPE, ITEMDESC, STATIONID, LOCNCODE, UOFM, TECHID, QTYORDER, ATYALLOC, QTYBACKO, QTYSOLD, UNITCOST, UNITPRCE, EXTDCOST, XTNDPRCE, STRTDATE, STRTTIME, ENDDATE, ENDTIME, TRANSTME, BILLABLTIM, NOTEINDX, SEQUENCE1, ORDDOCID, TRANSLINESEQ, PONMBRSTR, POLNSEQ, FUFILDAT, CMPNTSEQ, CMPITQTY, DEX_ROW_ID FROM .SVC06101 WHERE WORECTYPE = @WORECTYPE_RS AND WORKORDNUM BETWEEN @WORKORDNUM_RS AND @WORKORDNUM_RE AND SEQUENCE1 BETWEEN @SEQUENCE1_RS AND @SEQUENCE1_RE AND ( WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND SEQUENCE1 = @SEQUENCE1 AND DEX_ROW_ID > @DEX_ROW_ID OR WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND SEQUENCE1 > @SEQUENCE1 OR WORECTYPE = @WORECTYPE AND WORKORDNUM > @WORKORDNUM OR WORECTYPE > @WORECTYPE ) ORDER BY WORECTYPE ASC, WORKORDNUM ASC, SEQUENCE1 ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  WORECTYPE, WORKORDNUM, WOSTAT, LINITMTYP, LNITMSEQ, ITEMNMBR, ITEMUSETYPE, ITEMDESC, STATIONID, LOCNCODE, UOFM, TECHID, QTYORDER, ATYALLOC, QTYBACKO, QTYSOLD, UNITCOST, UNITPRCE, EXTDCOST, XTNDPRCE, STRTDATE, STRTTIME, ENDDATE, ENDTIME, TRANSTME, BILLABLTIM, NOTEINDX, SEQUENCE1, ORDDOCID, TRANSLINESEQ, PONMBRSTR, POLNSEQ, FUFILDAT, CMPNTSEQ, CMPITQTY, DEX_ROW_ID FROM .SVC06101 WHERE WORECTYPE BETWEEN @WORECTYPE_RS AND @WORECTYPE_RE AND WORKORDNUM BETWEEN @WORKORDNUM_RS AND @WORKORDNUM_RE AND SEQUENCE1 BETWEEN @SEQUENCE1_RS AND @SEQUENCE1_RE AND ( WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND SEQUENCE1 = @SEQUENCE1 AND DEX_ROW_ID > @DEX_ROW_ID OR WORECTYPE = @WORECTYPE AND WORKORDNUM = @WORKORDNUM AND SEQUENCE1 > @SEQUENCE1 OR WORECTYPE = @WORECTYPE AND WORKORDNUM > @WORKORDNUM OR WORECTYPE > @WORECTYPE ) ORDER BY WORECTYPE ASC, WORKORDNUM ASC, SEQUENCE1 ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SVC06101N_2] TO [DYNGRP]
GO
