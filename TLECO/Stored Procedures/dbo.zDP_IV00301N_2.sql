SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IV00301N_2] (@BS int, @IUSCOUNT smallint, @RCRDSTTS smallint, @DEX_ROW_ID int, @IUSCOUNT_RS smallint, @RCRDSTTS_RS smallint, @IUSCOUNT_RE smallint, @RCRDSTTS_RE smallint) AS  set nocount on IF @IUSCOUNT_RS IS NULL BEGIN SELECT TOP 25  ITEMNMBR, LOTNUMBR, LOTATRB1, LOTATRB2, LOTATRB3, LOTATRB4, LOTATRB5, IUSCOUNT, RCRDSTTS, DEX_ROW_ID FROM .IV00301 WHERE ( IUSCOUNT = @IUSCOUNT AND RCRDSTTS = @RCRDSTTS AND DEX_ROW_ID > @DEX_ROW_ID OR IUSCOUNT = @IUSCOUNT AND RCRDSTTS > @RCRDSTTS OR IUSCOUNT > @IUSCOUNT ) ORDER BY IUSCOUNT ASC, RCRDSTTS ASC, DEX_ROW_ID ASC END ELSE IF @IUSCOUNT_RS = @IUSCOUNT_RE BEGIN SELECT TOP 25  ITEMNMBR, LOTNUMBR, LOTATRB1, LOTATRB2, LOTATRB3, LOTATRB4, LOTATRB5, IUSCOUNT, RCRDSTTS, DEX_ROW_ID FROM .IV00301 WHERE IUSCOUNT = @IUSCOUNT_RS AND RCRDSTTS BETWEEN @RCRDSTTS_RS AND @RCRDSTTS_RE AND ( IUSCOUNT = @IUSCOUNT AND RCRDSTTS = @RCRDSTTS AND DEX_ROW_ID > @DEX_ROW_ID OR IUSCOUNT = @IUSCOUNT AND RCRDSTTS > @RCRDSTTS OR IUSCOUNT > @IUSCOUNT ) ORDER BY IUSCOUNT ASC, RCRDSTTS ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  ITEMNMBR, LOTNUMBR, LOTATRB1, LOTATRB2, LOTATRB3, LOTATRB4, LOTATRB5, IUSCOUNT, RCRDSTTS, DEX_ROW_ID FROM .IV00301 WHERE IUSCOUNT BETWEEN @IUSCOUNT_RS AND @IUSCOUNT_RE AND RCRDSTTS BETWEEN @RCRDSTTS_RS AND @RCRDSTTS_RE AND ( IUSCOUNT = @IUSCOUNT AND RCRDSTTS = @RCRDSTTS AND DEX_ROW_ID > @DEX_ROW_ID OR IUSCOUNT = @IUSCOUNT AND RCRDSTTS > @RCRDSTTS OR IUSCOUNT > @IUSCOUNT ) ORDER BY IUSCOUNT ASC, RCRDSTTS ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IV00301N_2] TO [DYNGRP]
GO
