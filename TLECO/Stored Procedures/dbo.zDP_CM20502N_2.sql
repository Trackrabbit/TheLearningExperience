SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_CM20502N_2] (@BS int, @CMRECNUM numeric(19,5), @RECONUM numeric(19,5), @CMRECNUM_RS numeric(19,5), @RECONUM_RS numeric(19,5), @CMRECNUM_RE numeric(19,5), @RECONUM_RE numeric(19,5)) AS  set nocount on IF @CMRECNUM_RS IS NULL BEGIN SELECT TOP 25  AUDITTRAIL, CMRECNUM, RECONUM, CMTrxNum, CMTrxType, CMLinkID, TRXDATE, TRXAMNT, clearedate, ClrdAmt, CURNCYID, paidtorcvdfrom, DSCRIPTN, DEPTYPE, SOURCDOC, SRCDOCTYP, SRCDOCNUM, USERID, CHEKBKID, DEX_ROW_ID FROM .CM20502 WHERE ( CMRECNUM = @CMRECNUM AND RECONUM > @RECONUM OR CMRECNUM > @CMRECNUM ) ORDER BY CMRECNUM ASC, RECONUM ASC END ELSE IF @CMRECNUM_RS = @CMRECNUM_RE BEGIN SELECT TOP 25  AUDITTRAIL, CMRECNUM, RECONUM, CMTrxNum, CMTrxType, CMLinkID, TRXDATE, TRXAMNT, clearedate, ClrdAmt, CURNCYID, paidtorcvdfrom, DSCRIPTN, DEPTYPE, SOURCDOC, SRCDOCTYP, SRCDOCNUM, USERID, CHEKBKID, DEX_ROW_ID FROM .CM20502 WHERE CMRECNUM = @CMRECNUM_RS AND RECONUM BETWEEN @RECONUM_RS AND @RECONUM_RE AND ( CMRECNUM = @CMRECNUM AND RECONUM > @RECONUM OR CMRECNUM > @CMRECNUM ) ORDER BY CMRECNUM ASC, RECONUM ASC END ELSE BEGIN SELECT TOP 25  AUDITTRAIL, CMRECNUM, RECONUM, CMTrxNum, CMTrxType, CMLinkID, TRXDATE, TRXAMNT, clearedate, ClrdAmt, CURNCYID, paidtorcvdfrom, DSCRIPTN, DEPTYPE, SOURCDOC, SRCDOCTYP, SRCDOCNUM, USERID, CHEKBKID, DEX_ROW_ID FROM .CM20502 WHERE CMRECNUM BETWEEN @CMRECNUM_RS AND @CMRECNUM_RE AND RECONUM BETWEEN @RECONUM_RS AND @RECONUM_RE AND ( CMRECNUM = @CMRECNUM AND RECONUM > @RECONUM OR CMRECNUM > @CMRECNUM ) ORDER BY CMRECNUM ASC, RECONUM ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_CM20502N_2] TO [DYNGRP]
GO
