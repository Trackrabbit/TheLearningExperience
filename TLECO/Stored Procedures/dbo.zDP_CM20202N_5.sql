SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_CM20202N_5] (@BS int, @BACHNUMB char(15), @BCHSOURC char(15), @SERIES smallint, @DEX_ROW_ID int, @BACHNUMB_RS char(15), @BCHSOURC_RS char(15), @SERIES_RS smallint, @BACHNUMB_RE char(15), @BCHSOURC_RE char(15), @SERIES_RE smallint) AS  set nocount on IF @BACHNUMB_RS IS NULL BEGIN SELECT TOP 25  DOCNUMBR, SERIES, EFTType, EFTFileFormat, TRXDATE, Checkbook_Amount, CURNCYID, ISOCURRC, BACHNUMB, BCHSOURC, BCHCOMNT, paidtorcvdfrom, COMMENT1, SOURCDOC, VOIDDATE, AUDITTRAIL, ExecDate, RefNum, CHEKBKID, EFTBankTypeCB, EFTBankAcctCB, EFTBankBranchCB, EFTBankCodeCB, EFTBankBranchCodeCB, EFTBankCheckDigitCB, IntlBankAcctNum, TXRGNNUM, USERDEF1, USERDEF2, CustomerVendor_ID, ADRSCODE, EFTBankType, EFTBankAcct, EFTBankBranch, EFTBankCode, EFTBankBranchCode, EFTBankCheckDigit, CustVendIBAN, SWIFTADDR, CustVendCountryCode, DeliveryCountryCode, BNKCTRCD, CBANKCD, GIROPostType, RegCode1, RegCode2, BankInfo1, BankInfo2, BankInfo3, BankInfo4, BankInfo5, BankInfo6, BankInfo7, FedResBankNum, FedResClient, FedResBranch, DEX_ROW_ID FROM .CM20202 WHERE ( BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND SERIES = @SERIES AND DEX_ROW_ID > @DEX_ROW_ID OR BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND SERIES > @SERIES OR BACHNUMB = @BACHNUMB AND BCHSOURC > @BCHSOURC OR BACHNUMB > @BACHNUMB ) ORDER BY BACHNUMB ASC, BCHSOURC ASC, SERIES ASC, DEX_ROW_ID ASC END ELSE IF @BACHNUMB_RS = @BACHNUMB_RE BEGIN SELECT TOP 25  DOCNUMBR, SERIES, EFTType, EFTFileFormat, TRXDATE, Checkbook_Amount, CURNCYID, ISOCURRC, BACHNUMB, BCHSOURC, BCHCOMNT, paidtorcvdfrom, COMMENT1, SOURCDOC, VOIDDATE, AUDITTRAIL, ExecDate, RefNum, CHEKBKID, EFTBankTypeCB, EFTBankAcctCB, EFTBankBranchCB, EFTBankCodeCB, EFTBankBranchCodeCB, EFTBankCheckDigitCB, IntlBankAcctNum, TXRGNNUM, USERDEF1, USERDEF2, CustomerVendor_ID, ADRSCODE, EFTBankType, EFTBankAcct, EFTBankBranch, EFTBankCode, EFTBankBranchCode, EFTBankCheckDigit, CustVendIBAN, SWIFTADDR, CustVendCountryCode, DeliveryCountryCode, BNKCTRCD, CBANKCD, GIROPostType, RegCode1, RegCode2, BankInfo1, BankInfo2, BankInfo3, BankInfo4, BankInfo5, BankInfo6, BankInfo7, FedResBankNum, FedResClient, FedResBranch, DEX_ROW_ID FROM .CM20202 WHERE BACHNUMB = @BACHNUMB_RS AND BCHSOURC BETWEEN @BCHSOURC_RS AND @BCHSOURC_RE AND SERIES BETWEEN @SERIES_RS AND @SERIES_RE AND ( BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND SERIES = @SERIES AND DEX_ROW_ID > @DEX_ROW_ID OR BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND SERIES > @SERIES OR BACHNUMB = @BACHNUMB AND BCHSOURC > @BCHSOURC OR BACHNUMB > @BACHNUMB ) ORDER BY BACHNUMB ASC, BCHSOURC ASC, SERIES ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  DOCNUMBR, SERIES, EFTType, EFTFileFormat, TRXDATE, Checkbook_Amount, CURNCYID, ISOCURRC, BACHNUMB, BCHSOURC, BCHCOMNT, paidtorcvdfrom, COMMENT1, SOURCDOC, VOIDDATE, AUDITTRAIL, ExecDate, RefNum, CHEKBKID, EFTBankTypeCB, EFTBankAcctCB, EFTBankBranchCB, EFTBankCodeCB, EFTBankBranchCodeCB, EFTBankCheckDigitCB, IntlBankAcctNum, TXRGNNUM, USERDEF1, USERDEF2, CustomerVendor_ID, ADRSCODE, EFTBankType, EFTBankAcct, EFTBankBranch, EFTBankCode, EFTBankBranchCode, EFTBankCheckDigit, CustVendIBAN, SWIFTADDR, CustVendCountryCode, DeliveryCountryCode, BNKCTRCD, CBANKCD, GIROPostType, RegCode1, RegCode2, BankInfo1, BankInfo2, BankInfo3, BankInfo4, BankInfo5, BankInfo6, BankInfo7, FedResBankNum, FedResClient, FedResBranch, DEX_ROW_ID FROM .CM20202 WHERE BACHNUMB BETWEEN @BACHNUMB_RS AND @BACHNUMB_RE AND BCHSOURC BETWEEN @BCHSOURC_RS AND @BCHSOURC_RE AND SERIES BETWEEN @SERIES_RS AND @SERIES_RE AND ( BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND SERIES = @SERIES AND DEX_ROW_ID > @DEX_ROW_ID OR BACHNUMB = @BACHNUMB AND BCHSOURC = @BCHSOURC AND SERIES > @SERIES OR BACHNUMB = @BACHNUMB AND BCHSOURC > @BCHSOURC OR BACHNUMB > @BACHNUMB ) ORDER BY BACHNUMB ASC, BCHSOURC ASC, SERIES ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_CM20202N_5] TO [DYNGRP]
GO
