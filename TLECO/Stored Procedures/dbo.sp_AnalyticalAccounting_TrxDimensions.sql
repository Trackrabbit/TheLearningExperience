SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_AnalyticalAccounting_TrxDimensions] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(400),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @Trx_Dimension varchar(255), @Data_Type varchar(255), @Description_1 varchar(255), @Inactive varchar(255), @Create_New_Codes_In_Background varchar(255), @Create_New_Codes_On_The_Fly varchar(255), @Decimal_Places varchar(255), @Description_2 varchar(255), @Order varchar(255), @Trx_Dim_ID varchar(255), @U_of_M_Schedule_ID varchar(255) select @I_iDictID = 3180 select @I_iMessageNumber = 22128 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Trx_Dimension output  select @I_iDictID = 3180 select @I_iMessageNumber = 22129 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Data_Type output  select @I_iDictID = 3180 select @I_iMessageNumber = 22142 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Description_1 output  select @I_iDictID = 1493 select @I_iMessageNumber = 22967 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Inactive output  select @I_iDictID = 3180 select @I_iMessageNumber = 22088 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Create_New_Codes_In_Background output  select @I_iDictID = 3180 select @I_iMessageNumber = 22157 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Create_New_Codes_On_The_Fly output select @I_iDictID = 1493 select @I_iMessageNumber = 22510 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Decimal_Places output  select @I_iDictID = 3180 select @I_iMessageNumber = 22145 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Description_2 output  select @I_iDictID = 3180 select @I_iMessageNumber = 22159 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Order output  select @I_iDictID = 3180 select @I_iMessageNumber = 22147 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Trx_Dim_ID output  select @I_iDictID = 1493 select @I_iMessageNumber = 23138 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @U_of_M_Schedule_ID output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[AATrxDimensions]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[AATrxDimensions] '  select @sqldefaultstring =   'CREATE VIEW AATrxDimensions AS ' +   'select ' +   'rtrim([''aaTrxDimMstr''].[aaTrxDim]) as ''' + @Trx_Dimension + ''', ' + '''' + @Data_Type + ''' = dbo.AA_FUNC_Data_Type([''aaTrxDimMstr''].[aaDataType]), ' + 'rtrim([''aaTrxDimMstr''].[aaTrxDimDescr]) as ''' + @Description_1 + ''', ' + '''' + @Inactive + ''' = dbo.DYN_FUNC_Boolean_All([''aaTrxDimMstr''].[INACTIVE]), '   select @sqlstring1 =   '''' + @Create_New_Codes_In_Background + ''' = dbo.DYN_FUNC_Boolean_All([''aaTrxDimMstr''].[aaDontAskForNewCodes]), ' +  '''' + @Create_New_Codes_On_The_Fly + ''' = dbo.DYN_FUNC_Boolean_All([''aaTrxDimMstr''].[aaAddCodesOnFly]), ' +  '''' + @Decimal_Places + ''' = dbo.DYN_FUNC_Decimal_Places_QTYS([''aaTrxDimMstr''].[DECPLQTY]), ' +  'rtrim([''aaTrxDimMstr''].[aaTrxDimDescr2]) as ''' + @Description_2 + ''', ' +  '[''aaTrxDimMstr''].[aaOrder] as ''' + @Order + ''', ' +  '[''aaTrxDimMstr''].[aaTrxDimID] as ''' + @Trx_Dim_ID + ''', ' +  'rtrim([''aaTrxDimMstr''].[UOMSCHDL]) as ''' + @U_of_M_Schedule_ID + ''' '   select @sqljoinstring =  'from [AAG00400] as [''aaTrxDimMstr''] with (NOLOCK) '   select @sqlaccessstring =   'GRANT SELECT ON [dbo].[AATrxDimensions] TO [rpt_accounting manager]' + 'GRANT SELECT ON [dbo].[AATrxDimensions] TO [rpt_certified accountant]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off     
GO
GRANT EXECUTE ON  [dbo].[sp_AnalyticalAccounting_TrxDimensions] TO [DYNGRP]
GO
