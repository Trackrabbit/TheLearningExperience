SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IV30102L_4] (@ITEMNMBR_RS char(31), @SMRYTYPE_RS smallint, @YEAR1_RS smallint, @SMRYPMTH_RS smallint, @LOCNCODE_RS char(11), @ITEMNMBR_RE char(31), @SMRYTYPE_RE smallint, @YEAR1_RE smallint, @SMRYPMTH_RE smallint, @LOCNCODE_RE char(11)) AS  set nocount on IF @ITEMNMBR_RS IS NULL BEGIN SELECT TOP 25  ITEMNMBR, LOCNCODE, SMRYTYPE, SMRYPMTH, YEAR1, SMRYQTYS, SMRYCOST, SMRYSALS, SMMRYDPNDNTUSGQTY, SMMRYDPNDNTUSGCST, SMMRYPRJCTDUSGQTY, DEX_ROW_ID FROM .IV30102 ORDER BY ITEMNMBR DESC, SMRYTYPE DESC, YEAR1 DESC, SMRYPMTH DESC, LOCNCODE DESC END ELSE IF @ITEMNMBR_RS = @ITEMNMBR_RE BEGIN SELECT TOP 25  ITEMNMBR, LOCNCODE, SMRYTYPE, SMRYPMTH, YEAR1, SMRYQTYS, SMRYCOST, SMRYSALS, SMMRYDPNDNTUSGQTY, SMMRYDPNDNTUSGCST, SMMRYPRJCTDUSGQTY, DEX_ROW_ID FROM .IV30102 WHERE ITEMNMBR = @ITEMNMBR_RS AND SMRYTYPE BETWEEN @SMRYTYPE_RS AND @SMRYTYPE_RE AND YEAR1 BETWEEN @YEAR1_RS AND @YEAR1_RE AND SMRYPMTH BETWEEN @SMRYPMTH_RS AND @SMRYPMTH_RE AND LOCNCODE BETWEEN @LOCNCODE_RS AND @LOCNCODE_RE ORDER BY ITEMNMBR DESC, SMRYTYPE DESC, YEAR1 DESC, SMRYPMTH DESC, LOCNCODE DESC END ELSE BEGIN SELECT TOP 25  ITEMNMBR, LOCNCODE, SMRYTYPE, SMRYPMTH, YEAR1, SMRYQTYS, SMRYCOST, SMRYSALS, SMMRYDPNDNTUSGQTY, SMMRYDPNDNTUSGCST, SMMRYPRJCTDUSGQTY, DEX_ROW_ID FROM .IV30102 WHERE ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND SMRYTYPE BETWEEN @SMRYTYPE_RS AND @SMRYTYPE_RE AND YEAR1 BETWEEN @YEAR1_RS AND @YEAR1_RE AND SMRYPMTH BETWEEN @SMRYPMTH_RS AND @SMRYPMTH_RE AND LOCNCODE BETWEEN @LOCNCODE_RS AND @LOCNCODE_RE ORDER BY ITEMNMBR DESC, SMRYTYPE DESC, YEAR1 DESC, SMRYPMTH DESC, LOCNCODE DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IV30102L_4] TO [DYNGRP]
GO
