SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE  procedure [dbo].[seeuprSRSProcessEarningsRegister]   @sEmployeeID varchar(15),   @eEmployeeID varchar(15),   @sCheckDate datetime,   @eCheckDate datetime  AS  CREATE TABLE [dbo].[#UPREARN](  [EMPLOYID] [char](15) NOT NULL,  [TMPERNAM_1] [numeric](19, 5) NOT NULL,  [TMPERNAM_2] [numeric](19, 5) NOT NULL,  [TMPERNAM_3] [numeric](19, 5) NOT NULL,  [TMPERNAM_4] [numeric](19, 5) NOT NULL,  [TMPERNAM_5] [numeric](19, 5) NOT NULL,  [TMPERNAM_6] [numeric](19, 5) NOT NULL,  [TMPERNAM_7] [numeric](19, 5) NOT NULL,  [TMPERNAM_8] [numeric](19, 5) NOT NULL,  [TMPERNAM_9] [numeric](19, 5) NOT NULL,  [TMPERNAM_10] [numeric](19, 5) NOT NULL,  [TMPERNAM_11] [numeric](19, 5) NOT NULL,  [TMPERNAM_12] [numeric](19, 5) NOT NULL,  [TMPERNAM_13] [numeric](19, 5) NOT NULL,  [TMPERNAM_14] [numeric](19, 5) NOT NULL,  [TMPERNAM_15] [numeric](19, 5) NOT NULL,  [TMPERNAM_16] [numeric](19, 5) NOT NULL,  [TMPERNAM_17] [numeric](19, 5) NOT NULL,  [TMPERNAM_18] [numeric](19, 5) NOT NULL,  [TMPERNAM_19] [numeric](19, 5) NOT NULL,  [TMPERNAM_20] [numeric](19, 5) NOT NULL,  [TMPERNAM_21] [numeric](19, 5) NOT NULL,  [TMPERNAM_22] [numeric](19, 5) NOT NULL,  [TMPERNAM_23] [numeric](19, 5) NOT NULL,  [TMPERNAM_24] [numeric](19, 5) NOT NULL,  [TMPERNAM_25] [numeric](19, 5) NOT NULL,  [TMPERNAM_26] [numeric](19, 5) NOT NULL,  [TMPERNAM_27] [numeric](19, 5) NOT NULL,  [TMPERNAM_28] [numeric](19, 5) NOT NULL,  [TMPERNAM_29] [numeric](19, 5) NOT NULL,  [TMPERNAM_30] [numeric](19, 5) NOT NULL,  [TMPERNAM_31] [numeric](19, 5) NOT NULL,  [TMPERNAM_32] [numeric](19, 5) NOT NULL,  [TMPERNAM_33] [numeric](19, 5) NOT NULL,  [TMPERNAM_34] [numeric](19, 5) NOT NULL,  [TMPERNAM_35] [numeric](19, 5) NOT NULL,  [TMPERNAM_36] [numeric](19, 5) NOT NULL,  [TMPERNAM_37] [numeric](19, 5) NOT NULL,  [TMPERNAM_38] [numeric](19, 5) NOT NULL,  [TMPERNAM_39] [numeric](19, 5) NOT NULL,  [DEX_ROW_ID] [int] IDENTITY(1,1) NOT NULL ) ON [PRIMARY]  CREATE UNIQUE NONCLUSTERED INDEX [PK#UPREARN] ON [dbo].[#UPREARN] (  [EMPLOYID] ASC ) ON [PRIMARY]  exec uprProcessEarningsRegister   '#UPREARN',   @sEmployeeID,   @eEmployeeID,   @sCheckDate,   @eCheckDate,  0  update #UPREARN set TMPERNAM_13 = DS1.AMOUNT from (select EMPLOYID, sum(UPRTRXAM) as AMOUNT from UPR30300 where PYRLRTYP = 4 and (CHEKDATE >= @sCheckDate and CHEKDATE <= @eCheckDate) group by EMPLOYID ) as DS1, #UPREARN where DS1.EMPLOYID = #UPREARN.EMPLOYID   update #UPREARN set TMPERNAM_16 = DS1.AMOUNT from (select EMPLOYID, sum(UPRTRXAM) as AMOUNT from UPR30300 where PYRLRTYP = 5 and (CHEKDATE >= @sCheckDate and CHEKDATE <= @eCheckDate) group by EMPLOYID) as DS1, #UPREARN where DS1.EMPLOYID = #UPREARN.EMPLOYID   update #UPREARN set TMPERNAM_19 = DS1.AMOUNT from (select EMPLOYID, sum(UPRTRXAM) as AMOUNT from UPR30300 where PYRLRTYP = 2 and (CHEKDATE >= @sCheckDate and CHEKDATE <= @eCheckDate) group by EMPLOYID) as DS1, #UPREARN where DS1.EMPLOYID = #UPREARN.EMPLOYID   select * from #UPREARN t left join UPR00100 m on t.EMPLOYID = m.EMPLOYID    
GO
GRANT EXECUTE ON  [dbo].[seeuprSRSProcessEarningsRegister] TO [DYNGRP]
GO
GRANT EXECUTE ON  [dbo].[seeuprSRSProcessEarningsRegister] TO [rpt_payroll]
GO
GRANT EXECUTE ON  [dbo].[seeuprSRSProcessEarningsRegister] TO [rpt_power user]
GO
