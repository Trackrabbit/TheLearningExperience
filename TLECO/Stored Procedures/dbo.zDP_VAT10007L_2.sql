SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_VAT10007L_2] (@INTRSTTTYP_RS smallint, @INTRSTTFLDDSC_RS char(31), @INTRSTTFLD_RS char(7), @INTRSTTTYP_RE smallint, @INTRSTTFLDDSC_RE char(31), @INTRSTTFLD_RE char(7)) AS  set nocount on IF @INTRSTTTYP_RS IS NULL BEGIN SELECT TOP 25  INTRSTTTYP, INTRSTTFLD, INTRSTTFLDDSC, NOTEINDX, DEX_ROW_ID FROM .VAT10007 ORDER BY INTRSTTTYP DESC, INTRSTTFLDDSC DESC, INTRSTTFLD DESC END ELSE IF @INTRSTTTYP_RS = @INTRSTTTYP_RE BEGIN SELECT TOP 25  INTRSTTTYP, INTRSTTFLD, INTRSTTFLDDSC, NOTEINDX, DEX_ROW_ID FROM .VAT10007 WHERE INTRSTTTYP = @INTRSTTTYP_RS AND INTRSTTFLDDSC BETWEEN @INTRSTTFLDDSC_RS AND @INTRSTTFLDDSC_RE AND INTRSTTFLD BETWEEN @INTRSTTFLD_RS AND @INTRSTTFLD_RE ORDER BY INTRSTTTYP DESC, INTRSTTFLDDSC DESC, INTRSTTFLD DESC END ELSE BEGIN SELECT TOP 25  INTRSTTTYP, INTRSTTFLD, INTRSTTFLDDSC, NOTEINDX, DEX_ROW_ID FROM .VAT10007 WHERE INTRSTTTYP BETWEEN @INTRSTTTYP_RS AND @INTRSTTTYP_RE AND INTRSTTFLDDSC BETWEEN @INTRSTTFLDDSC_RS AND @INTRSTTFLDDSC_RE AND INTRSTTFLD BETWEEN @INTRSTTFLD_RS AND @INTRSTTFLD_RE ORDER BY INTRSTTTYP DESC, INTRSTTFLDDSC DESC, INTRSTTFLD DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_VAT10007L_2] TO [DYNGRP]
GO
