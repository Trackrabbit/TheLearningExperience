SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 CREATE procedure [dbo].[SVC_Get_Customer_Info]   ( @custnmbr varchar(15) = NULL,  @adrscode varchar(15) = NULL OUTPUT,  @custname varchar(65) output,  @retadrs varchar(15) output,  @cntcprsn varchar(31) output,  @phone1 varchar(21) output,  @address1 varchar(31) output,  @address2 varchar(31) output,  @address3 varchar(31) output,  @city varchar(31) output,  @state varchar(30) output,  @zip varchar(11) output,  @country varchar(21) output,  @taxschid varchar(15) output,  @prclevel varchar(11) output,  @taxexmt1 varchar(25) output,  @taxexmt2 varchar(25) output,  @pymtrmid varchar(21) output,  @slspersonid varchar(15) output,  @svcarea varchar(10) output,  @offid varchar(10) output,  @timezone varchar(3) output,  @CurrencyID char(15) OUTPUT,  @BillToCustomer varchar(15) OUTPUT,  @BillToAddress varchar(15) OUTPUT ,  @OnHold tinyint OUTPUT) as if @custnmbr is NULL  begin  return 200  end  declare @tempadrscode varchar(15) declare @TempBillToCust varchar(15),  @TempBillToAddress varchar(15) select @adrscode = RTRIM(@adrscode) select  @custname     = CUSTNAME,   @tempadrscode = ADRSCODE,  @cntcprsn     = CNTCPRSN,  @phone1       = PHONE1,  @address1     = ADDRESS1,  @address2     = ADDRESS2,  @address3     = ADDRESS3,  @city         = CITY,  @state        = STATE,  @zip          = ZIP,  @country      = COUNTRY,  @taxschid     = TAXSCHID,  @prclevel     = PRCLEVEL,  @taxexmt1     = TAXEXMT1,  @taxexmt2     = TAXEXMT2,  @pymtrmid     = PYMTRMID,  @CurrencyID = CURNCYID,  @slspersonid  = SLPRSNID,  @TempBillToCust = @custnmbr,  @TempBillToAddress = PRBTADCD,  @OnHold = CASE  WHEN INACTIVE = 1  THEN 1  WHEN HOLD = 1 then 1  ELSE 0  END  from RM00101  where CUSTNMBR = @custnmbr if @@error <> 0   begin  return @@error  end if (@adrscode is NULL) or (@adrscode = 'NONE') or (@adrscode = '')  begin  select @adrscode = @tempadrscode  end select @BillToCustomer = Bill_To_Customer,  @BillToAddress = RM00101.PRBTADCD  from SVC00950 INNER JOIN  RM00101 ON (SVC00950.Bill_To_Customer = RM00101.CUSTNMBR)  WHERE SVC00950.CUSTNMBR = @custnmbr AND  SVC00950.ADRSCODE = @adrscode if @BillToCustomer is null or @BillToCustomer = '' or @BillToAddress is null or @BillToAddress = ''  select @BillToCustomer = @TempBillToCust, @BillToAddress = @TempBillToAddress select  @cntcprsn     = CNTCPRSN,  @phone1       = PHONE1,  @address1     = ADDRESS1,  @address2     = ADDRESS2,  @address3     = ADDRESS3,  @city         = CITY,  @state        = STATE,  @country      = COUNTRY,  @zip          = ZIP  from RM00102  where CUSTNMBR = @custnmbr and  ADRSCODE = @adrscode if @@error <> 0   begin  return @@error  end select @svcarea  = SVCAREA,  @offid    = OFFID,  @timezone = TIMEZONE  from SVC00950   where CUSTNMBR = @custnmbr and  ADRSCODE = @adrscode return 0    
GO
GRANT EXECUTE ON  [dbo].[SVC_Get_Customer_Info] TO [DYNGRP]
GO
