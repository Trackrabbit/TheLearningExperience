SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[taSopAuxAcctsGetIdx]  @I_vSOPTYPE smallint=0,    @I_vSOPNUMBE char(21)='',    @I_vCUSTNMBR char(15)='',   @I_vITEMNMBR char(30)='',   @I_vTYPE int,     @O_iINDEX int output,    @O_iErrorState int = NULL output  with encryption as  set transaction isolation level read uncommitted set nocount on  declare   @iStatus int,  @iError int  select  @O_iErrorState = 0,  @iStatus = 0,   @O_iINDEX = 0,  @iError = 0  if (  @I_vTYPE is NULL or  @I_vITEMNMBR is NULL or  @I_vCUSTNMBR is NULL or  @I_vSOPTYPE  is NULL or  @I_vSOPNUMBE is NULL) begin  select @O_iErrorState = 1001     return end  select @I_vSOPNUMBE = UPPER(@I_vSOPNUMBE),  @I_vCUSTNMBR = UPPER(@I_vCUSTNMBR),  @I_vITEMNMBR = UPPER(@I_vITEMNMBR)  if (@I_vTYPE = 0) begin  select @O_iErrorState = 1002     return (@O_iErrorState) end  if (@I_vTYPE = 3)   begin  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 3 and SEQNUMBR = 50 end else if (@I_vTYPE = 4)   begin  select @O_iINDEX = isnull(RMTAKACC,0) from RM00101 (nolock) where CUSTNMBR = @I_vCUSTNMBR  if (@O_iINDEX = 0)  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 3 and SEQNUMBR = 500 end else if (@I_vTYPE = 2)   begin  select @O_iINDEX = isnull(RMARACC,0) from RM00101 (nolock) where CUSTNMBR = @I_vCUSTNMBR  if (@O_iINDEX = 0)  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 3 and SEQNUMBR = 100 end else if (@I_vTYPE = 5)   begin  select @O_iINDEX = isnull(RMAVACC,0) from RM00101 (nolock) where CUSTNMBR = @I_vCUSTNMBR  if (@O_iINDEX = 0)  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 3 and SEQNUMBR = 700 end else if (@I_vTYPE = 6)   begin  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 3 and SEQNUMBR = 600 end else if (@I_vTYPE = 7)   begin  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 3 and SEQNUMBR = 1800 end else if (@I_vTYPE = 8)   begin  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 3 and SEQNUMBR = 1700 end else if (@I_vTYPE = 11)   begin  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 3 and SEQNUMBR = 2300 end else if (@I_vTYPE = 12)   begin  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 3 and SEQNUMBR = 2200 end else if (@I_vTYPE = 1)   begin  select @O_iINDEX = isnull(SLSINDX,0) from SOP10200 (nolock) where SOPTYPE = @I_vSOPTYPE and SOPNUMBE = @I_vSOPNUMBE and ITEMNMBR = @I_vITEMNMBR  if (@O_iINDEX = 0)  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 3 and SEQNUMBR = 1100 end else if (@I_vTYPE = 10)   begin  select @O_iINDEX = isnull(MKDNINDX,0) from SOP10200 (nolock) where SOPTYPE = @I_vSOPTYPE and SOPNUMBE = @I_vSOPNUMBE and ITEMNMBR = @I_vITEMNMBR end  return (@O_iErrorState)   
GO
GRANT EXECUTE ON  [dbo].[taSopAuxAcctsGetIdx] TO [DYNGRP]
GO
