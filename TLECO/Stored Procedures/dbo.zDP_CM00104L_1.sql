SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_CM00104L_1] (@EFTFormatID_RS char(15), @EFTLineType_RS smallint, @SQNCLINE_RS numeric(19,5), @EFTFormatID_RE char(15), @EFTLineType_RE smallint, @SQNCLINE_RE numeric(19,5)) AS  set nocount on IF @EFTFormatID_RS IS NULL BEGIN SELECT TOP 25  EFTFormatID, EFTLineType, SQNCLINE, EFTFieldNumber, EFTXMLTag, DSCRIPTN, EFTMapsTo, EFTSourceTable, FieldName, EFTDataValue, LOFSGMNT, EFTTagHierarchy, EFTOccurrence, EFTCalculationType, EFTDatatype, EFTJustification, EFTPadCharacter, EFTDecimalPlaces, EFTRemoveDecimalPlace, DATEFMT, EFTUseTextQualifier, DEX_ROW_ID FROM .CM00104 ORDER BY EFTFormatID DESC, EFTLineType DESC, SQNCLINE DESC END ELSE IF @EFTFormatID_RS = @EFTFormatID_RE BEGIN SELECT TOP 25  EFTFormatID, EFTLineType, SQNCLINE, EFTFieldNumber, EFTXMLTag, DSCRIPTN, EFTMapsTo, EFTSourceTable, FieldName, EFTDataValue, LOFSGMNT, EFTTagHierarchy, EFTOccurrence, EFTCalculationType, EFTDatatype, EFTJustification, EFTPadCharacter, EFTDecimalPlaces, EFTRemoveDecimalPlace, DATEFMT, EFTUseTextQualifier, DEX_ROW_ID FROM .CM00104 WHERE EFTFormatID = @EFTFormatID_RS AND EFTLineType BETWEEN @EFTLineType_RS AND @EFTLineType_RE AND SQNCLINE BETWEEN @SQNCLINE_RS AND @SQNCLINE_RE ORDER BY EFTFormatID DESC, EFTLineType DESC, SQNCLINE DESC END ELSE BEGIN SELECT TOP 25  EFTFormatID, EFTLineType, SQNCLINE, EFTFieldNumber, EFTXMLTag, DSCRIPTN, EFTMapsTo, EFTSourceTable, FieldName, EFTDataValue, LOFSGMNT, EFTTagHierarchy, EFTOccurrence, EFTCalculationType, EFTDatatype, EFTJustification, EFTPadCharacter, EFTDecimalPlaces, EFTRemoveDecimalPlace, DATEFMT, EFTUseTextQualifier, DEX_ROW_ID FROM .CM00104 WHERE EFTFormatID BETWEEN @EFTFormatID_RS AND @EFTFormatID_RE AND EFTLineType BETWEEN @EFTLineType_RS AND @EFTLineType_RE AND SQNCLINE BETWEEN @SQNCLINE_RS AND @SQNCLINE_RE ORDER BY EFTFormatID DESC, EFTLineType DESC, SQNCLINE DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_CM00104L_1] TO [DYNGRP]
GO
