SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyRM] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255) select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '' if (@I_vData = 1) begin if (exists(select top 1 1 from sysobjects where name = 'PA00002')) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA00002' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA00002 ( [INDEX1],[paNextDocumentNumber],[ACTINDX],[paAutoCreateVendors],[paAutoCreateCustomerVend],[paCreateVendorType], [paDefaultVendorClass],[paNextVendorID],[paDebitDescriptionPrefix],[paVoucherDescrPrefix],[paAutoOpenSelectChecks],[paIntegrateEFT], [paCreateCustomerType],[paDefaultCustomerClass],[paNextCustomerID],[paPMPrefix],[paPMNextDocument],[paRMPrefix], [paConsolidationIndex],[CRTMPVND] ) select [INDEX1],[paNextDocumentNumber],[ACTINDX],[paAutoCreateVendors],[paAutoCreateCustomerVend],[paCreateVendorType], [paDefaultVendorClass],[paNextVendorID],[paDebitDescriptionPrefix],[paVoucherDescrPrefix],[paAutoOpenSelectChecks],[paIntegrateEFT], [paCreateCustomerType],[paDefaultCustomerClass],[paNextCustomerID],[paPMPrefix],[paPMNextDocument],[paRMPrefix], [paConsolidationIndex],[CRTMPVND] from ' + rtrim(@I_vFromCompany) + '..PA00002 ' exec(@cStatement) end select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM00101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM00101 ( [CUSTNMBR],[CUSTNAME],[CUSTCLAS],[CPRCSTNM],[CNTCPRSN],[STMTNAME], [SHRTNAME],[ADRSCODE],[UPSZONE],[SHIPMTHD],[TAXSCHID],[ADDRESS1], [ADDRESS2],[ADDRESS3],[COUNTRY],[CITY],[STATE],[ZIP], [PHONE1],[PHONE2],[PHONE3],[FAX],[PRBTADCD],[PRSTADCD], [STADDRCD],[SLPRSNID],[CHEKBKID],[PYMTRMID],[CRLMTTYP],[CRLMTAMT], [CRLMTPER],[CRLMTPAM],[CURNCYID],[RATETPID],[CUSTDISC],[PRCLEVEL], [MINPYTYP],[MINPYDLR],[MINPYPCT],[FNCHATYP],[FNCHPCNT],[FINCHDLR], [MXWOFTYP],[MXWROFAM],[COMMENT1],[COMMENT2],[USERDEF1],[USERDEF2], [TAXEXMT1],[TAXEXMT2],[TXRGNNUM],[BALNCTYP],[STMTCYCL],[BANKNAME], [BNKBRNCH],[SALSTERR],[DEFCACTY],[RMCSHACC],[RMARACC],[RMSLSACC], [RMIVACC],[RMCOSACC],[RMTAKACC],[RMAVACC],[RMFCGACC],[RMWRACC], [RMSORACC],[FRSTINDT],[INACTIVE],[HOLD],[CRCARDID],[CRCRDNUM], [CCRDXPDT],[KPDSTHST],[KPCALHST],[KPERHIST],[KPTRXHST],[NOTEINDX], [CREATDDT],[MODIFDT],[Revalue_Customer],[Post_Results_To],[FINCHID],[GOVCRPID], [GOVINDID],[DISGRPER],[DUEGRPER],[DOCFMTID],[Send_Email_Statements],[USERLANG], [GPSFOINTEGRATIONID],[INTEGRATIONSOURCE],[INTEGRATIONID],[ORDERFULFILLDEFAULT],[CUSTPRIORITY],[CCode], [DECLID],[RMOvrpymtWrtoffAcctIdx],[SHIPCOMPLETE],[CBVAT],[INCLUDEINDP],[DEX_ROW_TS] ) select [CUSTNMBR],[CUSTNAME],[CUSTCLAS],[CPRCSTNM],[CNTCPRSN],[STMTNAME], [SHRTNAME],[ADRSCODE],[UPSZONE],[SHIPMTHD],[TAXSCHID],[ADDRESS1], [ADDRESS2],[ADDRESS3],[COUNTRY],[CITY],[STATE],[ZIP], [PHONE1],[PHONE2],[PHONE3],[FAX],[PRBTADCD],[PRSTADCD], [STADDRCD],[SLPRSNID],[CHEKBKID],[PYMTRMID],[CRLMTTYP],[CRLMTAMT], [CRLMTPER],[CRLMTPAM],[CURNCYID],[RATETPID],[CUSTDISC],[PRCLEVEL], [MINPYTYP],[MINPYDLR],[MINPYPCT],[FNCHATYP],[FNCHPCNT],[FINCHDLR], [MXWOFTYP],[MXWROFAM],[COMMENT1],[COMMENT2],[USERDEF1],[USERDEF2], [TAXEXMT1],[TAXEXMT2],[TXRGNNUM],[BALNCTYP],[STMTCYCL],[BANKNAME], [BNKBRNCH],[SALSTERR],[DEFCACTY],[RMCSHACC],[RMARACC],[RMSLSACC], [RMIVACC],[RMCOSACC],[RMTAKACC],[RMAVACC],[RMFCGACC],[RMWRACC], [RMSORACC],[FRSTINDT],[INACTIVE],[HOLD],[CRCARDID],[CRCRDNUM], [CCRDXPDT],[KPDSTHST],[KPCALHST],[KPERHIST],[KPTRXHST],[NOTEINDX], [CREATDDT],[MODIFDT],[Revalue_Customer],[Post_Results_To],[FINCHID],[GOVCRPID], [GOVINDID],[DISGRPER],[DUEGRPER],[DOCFMTID],[Send_Email_Statements],[USERLANG], [GPSFOINTEGRATIONID],[INTEGRATIONSOURCE],[INTEGRATIONID],[ORDERFULFILLDEFAULT],[CUSTPRIORITY],[CCode], [DECLID],[RMOvrpymtWrtoffAcctIdx],[SHIPCOMPLETE],[CBVAT],[INCLUDEINDP],[DEX_ROW_TS] from ' + rtrim(@I_vFromCompany) + '..RM00101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM00102' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM00102 ( [CUSTNMBR],[ADRSCODE],[SLPRSNID],[UPSZONE],[SHIPMTHD],[TAXSCHID], [CNTCPRSN],[ADDRESS1],[ADDRESS2],[ADDRESS3],[COUNTRY],[CITY], [STATE],[ZIP],[PHONE1],[PHONE2],[PHONE3],[FAX], [MODIFDT],[CREATDDT],[GPSFOINTEGRATIONID],[INTEGRATIONSOURCE],[INTEGRATIONID],[CCode], [DECLID],[LOCNCODE],[SALSTERR],[USERDEF1],[USERDEF2],[ShipToName], [Print_Phone_NumberGB] ) select [CUSTNMBR],[ADRSCODE],[SLPRSNID],[UPSZONE],[SHIPMTHD],[TAXSCHID], [CNTCPRSN],[ADDRESS1],[ADDRESS2],[ADDRESS3],[COUNTRY],[CITY], [STATE],[ZIP],[PHONE1],[PHONE2],[PHONE3],[FAX], [MODIFDT],[CREATDDT],[GPSFOINTEGRATIONID],[INTEGRATIONSOURCE],[INTEGRATIONID],[CCode], [DECLID],[LOCNCODE],[SALSTERR],[USERDEF1],[USERDEF2],[ShipToName], [Print_Phone_NumberGB] from ' + rtrim(@I_vFromCompany) + '..RM00102 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM00105' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM00105 ( [CPRCSTNM],[NAALLOWRECEIPTS],[NACREDITCHECK],[NAFINANCECHARGE],[NAHOLDINACTIVE],[NADEFPARENTVEN], [NOTEINDX],[CREATDDT],[MODIFDT] ) select [CPRCSTNM],[NAALLOWRECEIPTS],[NACREDITCHECK],[NAFINANCECHARGE],[NAHOLDINACTIVE],[NADEFPARENTVEN], [NOTEINDX],[CREATDDT],[MODIFDT] from ' + rtrim(@I_vFromCompany) + '..RM00105 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM00106' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM00106 ( [CUSTNMBR],[Email_Type],[Email_Recipient] ) select [CUSTNMBR],[Email_Type],[Email_Recipient] from ' + rtrim(@I_vFromCompany) + '..RM00106 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM00201' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM00201 ( [CLASSID],[CLASDSCR],[CRLMTTYP],[CRLMTAMT],[CRLMTPER],[CRLMTPAM], [DEFLTCLS],[BALNCTYP],[CHEKBKID],[BANKNAME],[TAXSCHID],[SHIPMTHD], [PYMTRMID],[CUSTDISC],[CSTPRLVL],[MINPYTYP],[MINPYDLR],[MINPYPCT], [MXWOFTYP],[MXWROFAM],[FINCHARG],[FNCHATYP],[FINCHDLR],[FNCHPCNT], [PRCLEVEL],[CURNCYID],[RATETPID],[DEFCACTY],[RMCSHACC],[RMARACC], [RMCOSACC],[RMIVACC],[RMSLSACC],[RMAVACC],[RMTAKACC],[RMFCGACC], [RMWRACC],[RMSORACC],[SALSTERR],[SLPRSNID],[STMTCYCL],[SNDSTMNT], [INACTIVE],[KPCALHST],[KPDSTHST],[KPERHIST],[KPTRXHST],[NOTEINDX], [MODIFDT],[CREATDDT],[Revalue_Customer],[Post_Results_To],[DISGRPER],[DUEGRPER], [ORDERFULFILLDEFAULT],[CUSTPRIORITY],[RMOvrpymtWrtoffAcctIdx],[CBVAT],[INCLUDEINDP] ) select [CLASSID],[CLASDSCR],[CRLMTTYP],[CRLMTAMT],[CRLMTPER],[CRLMTPAM], [DEFLTCLS],[BALNCTYP],[CHEKBKID],[BANKNAME],[TAXSCHID],[SHIPMTHD], [PYMTRMID],[CUSTDISC],[CSTPRLVL],[MINPYTYP],[MINPYDLR],[MINPYPCT], [MXWOFTYP],[MXWROFAM],[FINCHARG],[FNCHATYP],[FINCHDLR],[FNCHPCNT], [PRCLEVEL],[CURNCYID],[RATETPID],[DEFCACTY],[RMCSHACC],[RMARACC], [RMCOSACC],[RMIVACC],[RMSLSACC],[RMAVACC],[RMTAKACC],[RMFCGACC], [RMWRACC],[RMSORACC],[SALSTERR],[SLPRSNID],[STMTCYCL],[SNDSTMNT], [INACTIVE],[KPCALHST],[KPDSTHST],[KPERHIST],[KPTRXHST],[NOTEINDX], [MODIFDT],[CREATDDT],[Revalue_Customer],[Post_Results_To],[DISGRPER],[DUEGRPER], [ORDERFULFILLDEFAULT],[CUSTPRIORITY],[RMOvrpymtWrtoffAcctIdx],[CBVAT],[INCLUDEINDP] from ' + rtrim(@I_vFromCompany) + '..RM00201 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM00301' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM00301 ( [SLPRSNID],[EMPLOYID],[VENDORID],[SLPRSNFN],[SPRSNSMN],[SPRSNSLN], [ADDRESS1],[ADDRESS2],[ADDRESS3],[CITY],[STATE],[ZIP], [COUNTRY],[PHONE1],[PHONE2],[PHONE3],[FAX],[INACTIVE], [SALSTERR],[COMMCODE],[COMPRCNT],[STDCPRCT],[COMAPPTO],[COSTTODT], [CSTLSTYR],[TTLCOMTD],[TTLCOMLY],[COMSLTDT],[COMSLLYR],[NCOMSLTD], [NCOMSLYR],[KPCALHST],[KPERHIST],[NOTEINDX],[MODIFDT],[CREATDDT], [COMMDEST],[DEX_ROW_TS] ) select [SLPRSNID],[EMPLOYID],[VENDORID],[SLPRSNFN],[SPRSNSMN],[SPRSNSLN], [ADDRESS1],[ADDRESS2],[ADDRESS3],[CITY],[STATE],[ZIP], [COUNTRY],[PHONE1],[PHONE2],[PHONE3],[FAX],[INACTIVE], [SALSTERR],[COMMCODE],[COMPRCNT],[STDCPRCT],[COMAPPTO],[COSTTODT], [CSTLSTYR],[TTLCOMTD],[TTLCOMLY],[COMSLTDT],[COMSLLYR],[NCOMSLTD], [NCOMSLYR],[KPCALHST],[KPERHIST],[NOTEINDX],[MODIFDT],[CREATDDT], [COMMDEST],[DEX_ROW_TS] from ' + rtrim(@I_vFromCompany) + '..RM00301 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM00303' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM00303 ( [SALSTERR],[SLTERDSC],[INACTIVE],[SLPRSNID],[STMGRFNM],[STMGRMNM], [STMGRLNM],[COUNTRY],[COSTTODT],[TTLCOMTD],[TTLCOMLY],[NCOMSLYR], [COMSLLYR],[CSTLSTYR],[COMSLTDT],[NCOMSLTD],[KPCALHST],[KPERHIST], [NOTEINDX],[MODIFDT],[CREATDDT],[DEX_ROW_TS] ) select [SALSTERR],[SLTERDSC],[INACTIVE],[SLPRSNID],[STMGRFNM],[STMGRMNM], [STMGRLNM],[COUNTRY],[COSTTODT],[TTLCOMTD],[TTLCOMLY],[NCOMSLYR], [COMSLLYR],[CSTLSTYR],[COMSLTDT],[NCOMSLTD],[KPCALHST],[KPERHIST], [NOTEINDX],[MODIFDT],[CREATDDT],[DEX_ROW_TS] from ' + rtrim(@I_vFromCompany) + '..RM00303 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM00305' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM00305 ( [SALSTERR],[HISTTYPE],[PERIODID],[YEAR1],[SMRYDATE],[COSTAMNT], [TTLCOMAM],[COMSLTDT],[NCOMAMNT] ) select [SALSTERR],[HISTTYPE],[PERIODID],[YEAR1],[SMRYDATE],[COSTAMNT], [TTLCOMAM],[COMSLTDT],[NCOMAMNT] from ' + rtrim(@I_vFromCompany) + '..RM00305 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM40101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM40101 ( [SETUPKEY],[AGEBY],[AGPEREND_1],[AGPEREND_2],[AGPEREND_3],[AGPEREND_4], [AGPEREND_5],[AGPEREND_6],[AGPEREND_7],[AGPERUSD],[CRLMPSWD],[CUSTHPWD], [WRTFPSWD],[WVFCHPWD],[PRTHATRB],[CPDFINCH],[RMTRKDAV],[RMPCAIPD], [NSFCHDEF],[APLBYDEF],[LDFNCHGD],[LDSTPRTD],[LDBLFAGD],[LDOITAGD], [LDPTRRMV],[LSTYECAL],[LSTYEFSC],[USRDFPR1],[USRDRPR2],[FRTSCHID], [SLSCHDID],[MSCSCHID],[CHEKBKID],[SALESCB],[DISCNTCB],[FREIGHT], [MISC],[TAX],[RMVDSTTY_1],[RMVDSTTY_2],[RMVDSTTY_3],[RMVDSTTY_4], [RMVDSTTY_5],[RMVDSTTY_6],[RMVDSTTY_7],[RMVDSTTY_8],[RMVDSTTY_9],[LDCMTRNS], [PRCLEVEL],[RMDFTyp],[DelUPDoc],[PrntTaxDetDoc],[RPRNTSTTMNTS],[ATAPPLFNNCCHRGSFRST], [EmailStmtStatusRecipient],[DateSensitivitySumView],[PRNTDCUR],[AGEUNAPPLDCR],[WriteoffCreditMemoNumber],[WriteoffDebitMemoNumber], [USRDRPR3],[USRDRPR4] ) select [SETUPKEY],[AGEBY],[AGPEREND_1],[AGPEREND_2],[AGPEREND_3],[AGPEREND_4], [AGPEREND_5],[AGPEREND_6],[AGPEREND_7],[AGPERUSD],[CRLMPSWD],[CUSTHPWD], [WRTFPSWD],[WVFCHPWD],[PRTHATRB],[CPDFINCH],[RMTRKDAV],[RMPCAIPD], [NSFCHDEF],[APLBYDEF],[LDFNCHGD],[LDSTPRTD],[LDBLFAGD],[LDOITAGD], [LDPTRRMV],[LSTYECAL],[LSTYEFSC],[USRDFPR1],[USRDRPR2],[FRTSCHID], [SLSCHDID],[MSCSCHID],[CHEKBKID],[SALESCB],[DISCNTCB],[FREIGHT], [MISC],[TAX],[RMVDSTTY_1],[RMVDSTTY_2],[RMVDSTTY_3],[RMVDSTTY_4], [RMVDSTTY_5],[RMVDSTTY_6],[RMVDSTTY_7],[RMVDSTTY_8],[RMVDSTTY_9],[LDCMTRNS], [PRCLEVEL],[RMDFTyp],[DelUPDoc],[PrntTaxDetDoc],[RPRNTSTTMNTS],[ATAPPLFNNCCHRGSFRST], [EmailStmtStatusRecipient],[DateSensitivitySumView],[PRNTDCUR],[AGEUNAPPLDCR],[WriteoffCreditMemoNumber],[WriteoffDebitMemoNumber], [USRDRPR3],[USRDRPR4] from ' + rtrim(@I_vFromCompany) + '..RM40101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM40102' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM40102 ( [UNIQKEY],[NXTRNNMBR] ) select [UNIQKEY],[NXTRNNMBR] from ' + rtrim(@I_vFromCompany) + '..RM40102 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM40201' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM40201 ( [INDEX1],[RMPERDSC],[RMPEREND] ) select [INDEX1],[RMPERDSC],[RMPEREND] from ' + rtrim(@I_vFromCompany) + '..RM40201 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM40401' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM40401 ( [RMDTYPAL],[DOCDESCR],[DOCABREV],[DOCNUMBR],[SETUPKEY] ) select [RMDTYPAL],[DOCDESCR],[DOCABREV],[DOCNUMBR],[SETUPKEY] from ' + rtrim(@I_vFromCompany) + '..RM40401 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM40501' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM40501 ( [STMNTID],[DSCRIPTN],[NOTEINDX],[STMTFORM],[PRTCRLMT],[PRTPYTRM], [PRNTFNCH],[PRNTMSGS],[STMNTFOR],[RSTRACTY],[CUSTSORT],[DOCSORTS], [AGPERAMT_1],[AGPERAMT_2],[AGPERAMT_3],[AGPERAMT_4],[AGPERAMT_5],[AGPERAMT_6], [AGPERAMT_7],[STMTRSTR],[RSTRFRID],[RSTRTOID],[RSTRFNAM],[RSTRTNAM], [RSTRFCLS],[RSTRTCLS],[RSTRFRUD],[RSTRTOUD],[RSTFSPSN],[RSTTSPSN], [RSTRFTER],[RSTTOTER],[RSTRFZIP],[RSTRTZIP],[RSTFSTCY],[RSTTSTCY], [STMTLPTD],[PRTDTTKN],[SUMDTTKN],[COFDTOKN],[STMTPRDT],[SMRYDATE], [CUTOFDAT],[ASKECHTM],[EXPTTYPE],[FILEXPNM],[IFFILXST],[PRNTOFIL], [PRTOPRTR],[PRTOSCRN],[LOCATNID],[INDCHLDSTMT],[Email_Statements_Options],[Email_Statements_Form], [EmailStmtsSubjectLine],[RDCOLDPDBYUNAPPLDCR] ) select [STMNTID],[DSCRIPTN],[NOTEINDX],[STMTFORM],[PRTCRLMT],[PRTPYTRM], [PRNTFNCH],[PRNTMSGS],[STMNTFOR],[RSTRACTY],[CUSTSORT],[DOCSORTS], [AGPERAMT_1],[AGPERAMT_2],[AGPERAMT_3],[AGPERAMT_4],[AGPERAMT_5],[AGPERAMT_6], [AGPERAMT_7],[STMTRSTR],[RSTRFRID],[RSTRTOID],[RSTRFNAM],[RSTRTNAM], [RSTRFCLS],[RSTRTCLS],[RSTRFRUD],[RSTRTOUD],[RSTFSPSN],[RSTTSPSN], [RSTRFTER],[RSTTOTER],[RSTRFZIP],[RSTRTZIP],[RSTFSTCY],[RSTTSTCY], [STMTLPTD],[PRTDTTKN],[SUMDTTKN],[COFDTOKN],[STMTPRDT],[SMRYDATE], [CUTOFDAT],[ASKECHTM],[EXPTTYPE],[FILEXPNM],[IFFILXST],[PRNTOFIL], [PRTOPRTR],[PRTOSCRN],[LOCATNID],[INDCHLDSTMT],[Email_Statements_Options],[Email_Statements_Form], [EmailStmtsSubjectLine],[RDCOLDPDBYUNAPPLDCR] from ' + rtrim(@I_vFromCompany) + '..RM40501 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM40601' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM40601 ( [INDEX1],[DSCRIPTN],[MESSAGE] ) select [INDEX1],[DSCRIPTN],[MESSAGE] from ' + rtrim(@I_vFromCompany) + '..RM40601 ' exec(@cStatement) end if (@I_vReportOptions = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM00700' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM00700 ( [AGNGDTKN],[RANGEBY],[PRTDBRCD],[PRPSTJCB],[PRSBDRCB],[ENDDOCDT], [FILEXPNM],[FINRPTNM],[ASKECHTM],[INCLGNDS],[IFFILXST],[EXPTTYPE], [PRNTNOTS],[CSTSRTBY],[PRNTOFIL],[PRTOPRTR],[PRTOSCRN],[PRNTTYPE], [RPTGRIND],[RTGRSBIN],[RTPACHIN],[SORTBY],[ENFULNAM],[ENDADDCT], [ENDCLSID],[ENCUSTID],[ENCSTNAM],[ENDPHON1],[ENSLSTER],[ENSPSNID], [ENDSHNAM],[ENDSTATE],[ENUSRDF1],[ENDZIPCD],[ENDINGDT],[ENCLDSCR], [ENLSTNAM],[ENDVENDR],[ENDEMPLY],[ENDCITY],[ENDOCNUM],[ENDOCTYP], [ENDPEROD],[ENDPSTDT],[ENDBNMBR],[ENBCHSRC],[ENTRXSRC],[ENRMTKDT], [ENSLSAMT],[ENPRMRGN],[STRTFLNM],[STRMTKDT],[STADDCTT],[STTCLSID], [STCUSTID],[STCUSTNM],[STRTDATE],[STRTNGDT],[STTPHON1],[STSLSTER], [STSPRSID],[STTSHNAM],[STTSTATE],[STTUDEF1],[STRTZPCD],[STCLSDSC], [STTLSTNM],[STRTVNDR],[STRTEMPL],[STRTCITY],[STMTCYCL],[ENSTCYCL], [STDOCNUM],[STTDOCTP],[STTDOCDT],[STPERIOD],[STTPSTDT],[STBCHNUM], [STBCHSRC],[STRXSRC],[STPRMRGN],[STSLSAMT],[INACTIVE],[BALNCTYP], [ACTIVE],[HISTTYPE],[TRANTOPR],[PRNTDTLD],[CUTOFDAT],[CRBLNCCB], [FLLYPDCB],[NOACTVCB],[ZROBALCB],[PASTDUCB],[WHICHRPT],[PERTYPGB], [YEAR1]' select @cStatement2 = rtrim(@cStatement2)+rtrim(','+'[STTACNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement3 = rtrim(@cStatement3)+rtrim(','+'[EACCNBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement4 = ',[SEGMNTRG],[ENITMNBR],[ENDSERLT],[STTITNUM],[STRTSRLT], [TRXTYPE],[INCLTXDT],[INCLPYMT],[STQUOEXD],[EDQUOEXD],[STREQDAT], [ENDREQDT],[STTLOCCD],[ENLOCNCD],[STMSTNMB],[EDMASNMB],[STPRHDID], [ENPRHDID],[STTDOCID],[ENDDOCID],[STSOPTYP],[EDSOPTYP],[DISCOMP], [DISPRCHD],[DISSRLOT],[DISUSRDF],[EXCCOMP],[EXCFULFIL],[INCMCINF], [RPTXRATE],[RPRTCLMD],[PRTCURIN],[CONNAACT],[DateSensitivitySumSelect],[SummaryYear] ) select [AGNGDTKN],[RANGEBY],[PRTDBRCD],[PRPSTJCB],[PRSBDRCB],[ENDDOCDT], [FILEXPNM],[FINRPTNM],[ASKECHTM],[INCLGNDS],[IFFILXST],[EXPTTYPE], [PRNTNOTS],[CSTSRTBY],[PRNTOFIL],[PRTOPRTR],[PRTOSCRN],[PRNTTYPE], [RPTGRIND],[RTGRSBIN],[RTPACHIN],[SORTBY],[ENFULNAM],[ENDADDCT], [ENDCLSID],[ENCUSTID],[ENCSTNAM],[ENDPHON1],[ENSLSTER],[ENSPSNID], [ENDSHNAM],[ENDSTATE],[ENUSRDF1],[ENDZIPCD],[ENDINGDT],[ENCLDSCR], [ENLSTNAM],[ENDVENDR],[ENDEMPLY],[ENDCITY],[ENDOCNUM],[ENDOCTYP], [ENDPEROD],[ENDPSTDT],[ENDBNMBR],[ENBCHSRC],[ENTRXSRC],[ENRMTKDT], [ENSLSAMT],[ENPRMRGN],[STRTFLNM],[STRMTKDT],[STADDCTT],[STTCLSID], [STCUSTID],[STCUSTNM],[STRTDATE],[STRTNGDT],[STTPHON1],[STSLSTER], [STSPRSID],[STTSHNAM],[STTSTATE],[STTUDEF1],[STRTZPCD],[STCLSDSC], [STTLSTNM],[STRTVNDR],[STRTEMPL],[STRTCITY],[STMTCYCL],[ENSTCYCL], [STDOCNUM],[STTDOCTP],[STTDOCDT],[STPERIOD],[STTPSTDT],[STBCHNUM], [STBCHSRC],[STRXSRC],[STPRMRGN],[STSLSAMT],[INACTIVE],[BALNCTYP], [ACTIVE],[HISTTYPE],[TRANTOPR],[PRNTDTLD],[CUTOFDAT],[CRBLNCCB], [FLLYPDCB],[NOACTVCB],[ZROBALCB],[PASTDUCB],[WHICHRPT],[PERTYPGB], [YEAR1]' select @cStatement5 = rtrim(@cStatement5)+rtrim(','+'[STTACNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement6 = rtrim(@cStatement6)+rtrim(','+'[EACCNBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement7 = ',[SEGMNTRG],[ENITMNBR],[ENDSERLT],[STTITNUM],[STRTSRLT], [TRXTYPE],[INCLTXDT],[INCLPYMT],[STQUOEXD],[EDQUOEXD],[STREQDAT], [ENDREQDT],[STTLOCCD],[ENLOCNCD],[STMSTNMB],[EDMASNMB],[STPRHDID], [ENPRHDID],[STTDOCID],[ENDDOCID],[STSOPTYP],[EDSOPTYP],[DISCOMP], [DISPRCHD],[DISSRLOT],[DISUSRDF],[EXCCOMP],[EXCFULFIL],[INCMCINF], [RPTXRATE],[RPRTCLMD],[PRTCURIN],[CONNAACT],[DateSensitivitySumSelect],[SummaryYear] from ' + rtrim(@I_vFromCompany) + '..RM00700 ' exec(@cStatement+@cStatement2+@cStatement3+@cStatement4+@cStatement5+@cStatement6+@cStatement7) select @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '' select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..RM40501' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..RM40501 ( [STMNTID],[DSCRIPTN],[NOTEINDX],[STMTFORM],[PRTCRLMT],[PRTPYTRM], [PRNTFNCH],[PRNTMSGS],[STMNTFOR],[RSTRACTY],[CUSTSORT],[DOCSORTS], [AGPERAMT_1],[AGPERAMT_2],[AGPERAMT_3],[AGPERAMT_4],[AGPERAMT_5],[AGPERAMT_6], [AGPERAMT_7],[STMTRSTR],[RSTRFRID],[RSTRTOID],[RSTRFNAM],[RSTRTNAM], [RSTRFCLS],[RSTRTCLS],[RSTRFRUD],[RSTRTOUD],[RSTFSPSN],[RSTTSPSN], [RSTRFTER],[RSTTOTER],[RSTRFZIP],[RSTRTZIP],[RSTFSTCY],[RSTTSTCY], [STMTLPTD],[PRTDTTKN],[SUMDTTKN],[COFDTOKN],[STMTPRDT],[SMRYDATE], [CUTOFDAT],[ASKECHTM],[EXPTTYPE],[FILEXPNM],[IFFILXST],[PRNTOFIL], [PRTOPRTR],[PRTOSCRN],[LOCATNID],[INDCHLDSTMT],[Email_Statements_Options],[Email_Statements_Form], [EmailStmtsSubjectLine],[RDCOLDPDBYUNAPPLDCR] ) select [STMNTID],[DSCRIPTN],[NOTEINDX],[STMTFORM],[PRTCRLMT],[PRTPYTRM], [PRNTFNCH],[PRNTMSGS],[STMNTFOR],[RSTRACTY],[CUSTSORT],[DOCSORTS], [AGPERAMT_1],[AGPERAMT_2],[AGPERAMT_3],[AGPERAMT_4],[AGPERAMT_5],[AGPERAMT_6], [AGPERAMT_7],[STMTRSTR],[RSTRFRID],[RSTRTOID],[RSTRFNAM],[RSTRTNAM], [RSTRFCLS],[RSTRTCLS],[RSTRFRUD],[RSTRTOUD],[RSTFSPSN],[RSTTSPSN], [RSTRFTER],[RSTTOTER],[RSTRFZIP],[RSTRTZIP],[RSTFSTCY],[RSTTSTCY], [STMTLPTD],[PRTDTTKN],[SUMDTTKN],[COFDTOKN],[STMTPRDT],[SMRYDATE], [CUTOFDAT],[ASKECHTM],[EXPTTYPE],[FILEXPNM],[IFFILXST],[PRNTOFIL], [PRTOPRTR],[PRTOSCRN],[LOCATNID],[INDCHLDSTMT],[Email_Statements_Options],[Email_Statements_Form], [EmailStmtsSubjectLine],[RDCOLDPDBYUNAPPLDCR] from ' + rtrim(@I_vFromCompany) + '..RM40501 ' exec(@cStatement) end return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyRM] TO [DYNGRP]
GO
