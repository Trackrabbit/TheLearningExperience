SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[taPopAuxAcctsGetIdx]  @I_vPOPTYPE smallint = 0,  @I_vPOPRCTNM char(20) = '',   @I_vVENDORID char(15) = '',  @I_vITEMNMBR char(30) = '',  @I_vTAXDTLID char(15) = '', @I_vTYPE int,    @O_iINDEX int output,   @O_iErrorState int output  with encryption as  set transaction isolation level read uncommitted set nocount on  declare @iStatus int,  @iError int  select @O_iErrorState = 0,  @iStatus = 0,  @O_iINDEX = 0  if (  @I_vTYPE is NULL or  @I_vITEMNMBR is NULL or  @I_vVENDORID is NULL or  @I_vPOPTYPE  is NULL or  @I_vPOPRCTNM is NULL) begin  select @O_iErrorState = 7200   return (@O_iErrorState) end  select  @I_vVENDORID = UPPER(@I_vVENDORID),  @I_vITEMNMBR = UPPER(@I_vITEMNMBR),  @I_vPOPRCTNM = UPPER(@I_vPOPRCTNM),  @I_vTAXDTLID = UPPER(@I_vTAXDTLID)   if(@I_vTYPE = 0) begin  select @O_iErrorState = 7201   return (@O_iErrorState) end  if(@I_vTYPE = 1)   begin  select @O_iINDEX = isnull(PMPRCHIX,0) from PM00200 (nolock) where VENDORID = @I_vVENDORID  if (@O_iINDEX = 0)  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 4 and SEQNUMBR = 600 end else if (@I_vTYPE = 2)   begin  select @O_iINDEX = isnull(PMTDSCIX,0) from PM00200 (nolock) where VENDORID = @I_vVENDORID  if (@O_iINDEX = 0)  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 4 and SEQNUMBR = 700 end else if (@I_vTYPE = 3)   begin  select @O_iINDEX = isnull(PMFRTIDX,0) from PM00200 (nolock) where VENDORID = @I_vVENDORID  if (@O_iINDEX = 0)  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 4 and SEQNUMBR = 900 end else if (@I_vTYPE = 4)   begin  select @O_iINDEX = isnull(PMMSCHIX,0) from PM00200 (nolock) where VENDORID = @I_vVENDORID  if (@O_iINDEX = 0)  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 4 and SEQNUMBR = 800 end else if (@I_vTYPE = 5)   begin  select @O_iINDEX = isnull(ACTINDX,0) from POP10360 (nolock) where POPRCTNM = @I_vPOPRCTNM and TAXDTLID = TAXDTLID end else if (@I_vTYPE = 6)   begin  select @O_iINDEX = isnull(PMDAVIDX,0) from PM00200 (nolock) where VENDORID = @I_vVENDORID  if (@O_iINDEX = 0)  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 4 and SEQNUMBR = 300 end  else if (@I_vTYPE = 7)   begin  select @O_iINDEX = isnull(PMAPINDX,0) from PM00200 (nolock) where VENDORID = @I_vVENDORID  if (@O_iINDEX = 0)  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 4 and SEQNUMBR = 200 end  else if (@I_vTYPE = 9)   begin  select @O_iINDEX = isnull(ACPURIDX,0) from PM00200 (nolock) where VENDORID = @I_vVENDORID  if (@O_iINDEX = 0)  select @O_iINDEX = isnull(ACTINDX,0) from SY01100 (nolock) where SERIES = 4 and SEQNUMBR = 1300 end  else if (@I_vTYPE = 8)  begin  select @O_iINDEX = 0 end  return (@O_iErrorState)   
GO
GRANT EXECUTE ON  [dbo].[taPopAuxAcctsGetIdx] TO [DYNGRP]
GO
