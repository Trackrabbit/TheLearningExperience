SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[taCreateEmployeeBenefit] @I_vEMPLOYID char(15),    @I_vBENEFIT char(6),    @I_vINACTIVE tinyint = 0,   @I_vBNFBEGDT datetime='',    @I_vBNFENDDT datetime='',   @I_vVARBENFT tinyint=null,   @I_vBNFTFREQ smallint=null,    @I_vSBJTFDTX tinyint=null,   @I_vSBJTSSEC tinyint=null,   @I_vSBJTMCAR tinyint=null,   @I_vSBJTSTTX tinyint=null,   @I_vSBJTLTAX tinyint=null,   @I_vSBJTFUTA tinyint=null,   @I_vSBJTSUTA tinyint=null,   @I_vFFEDTXRT numeric(19,2)=null,  @I_vFLSTTXRT numeric(19,2)=null,  @I_vBORCDTYP smallint=null,   @I_vBSDORCDS smallint=null,   @I_vBNFTMTHD smallint=null,    @I_vBNFFRMLA smallint=null,   @I_vBNFPRCNT_1 numeric(19,5)=null,  @I_vBNFPRCNT_2 numeric(19,5)=null,  @I_vBNFPRCNT_3 numeric(19,5)=null,  @I_vBNFPRCNT_4 numeric(19,5)=null,  @I_vBNFPRCNT_5 numeric(19,5)=null,  @I_vBNFITAMT_1 numeric(19,5)=null,  @I_vBNFITAMT_2 numeric(19,5)=null,  @I_vBNFITAMT_3 numeric(19,5)=null,  @I_vBNFITAMT_4 numeric(19,5)=null,  @I_vBNFITAMT_5 numeric(19,5)=null,  @I_vBNFTRMAX_1 numeric(19,5)=null,  @I_vBNFTRMAX_2 numeric(19,5)=null,  @I_vBNFTRMAX_3 numeric(19,5)=null,  @I_vBNFTRMAX_4 numeric(19,5)=null,  @I_vBNFTRMAX_5 numeric(19,5)=null,  @I_vBNTRMXUN_1 numeric(19,5)=null,  @I_vBNTRMXUN_2 numeric(19,5)=null,  @I_vBNTRMXUN_3 numeric(19,5)=null,  @I_vBNTRMXUN_4 numeric(19,5)=null,  @I_vBNTRMXUN_5 numeric(19,5)=null,  @I_vBNPAYPMX numeric(19,5)=null,  @I_vBNFYRMAX numeric(19,5)=null,  @I_vBenefit_Fiscal_Max numeric(19,5)=null,  @I_vBNFLFMAX numeric(19,5)=null,  @I_vW2BXNMBR smallint=null,   @I_vW2BXLABL char(6)=null,   @I_vW2BXNMBR2 smallint=null,    @I_vW2BXLABL2 char(6)=null,    @I_vW2BXNMBR3 smallint=null,   @I_vW2BXLABL3 char(6)=null,    @I_vW2BXNMBR4 smallint=null,   @I_vW2BXLABL4 char(6)=null,    @I_vDATAENTDFLT tinyint=null,   @I_vEMPLRMAXMAT numeric(19,5)=null,  @I_vUseDefaultCoBenefit smallint=1,  @I_vUpdateIfExists tinyint=1,   @I_vRequesterTrx smallint=0,   @I_vUSRDEFND1 char(50) = '',       @I_vUSRDEFND2 char(50) = '',       @I_vUSRDEFND3 char(50) = '',       @I_vUSRDEFND4 varchar(8000) = '',  @I_vUSRDEFND5 varchar(8000) = '',  @O_iErrorState int output,   @oErrString varchar(255) output    with encryption as  set transaction isolation level read uncommitted set nocount on  declare  @TAXABLE tinyint,     @sCompanyID int,  @Enable_Fiscal_Tracking tinyint,     @iCustomState int,  @iStatus int,  @O_oErrorState int,  @nNextNoteIndex numeric(19,5),    @iGetNextNoteIdxErrState int,    @iError int,      @DBName char(50),     @iAddCodeErrState int  select  @TAXABLE = 0,      @Enable_Fiscal_Tracking = 0,  @O_iErrorState = 0,     @O_oErrorState = 0,  @sCompanyID = CMPANYID from DYNAMICS..SY01500 where INTERID = db_name()  if (@oErrString is NULL) begin  select @oErrString = '' end  exec @iStatus = taCreateEmployeeBenefitPre  @I_vEMPLOYID output,  @I_vBENEFIT output,  @I_vINACTIVE output,  @I_vBNFBEGDT output,  @I_vBNFENDDT output,  @I_vVARBENFT output,  @I_vBNFTFREQ output,  @I_vSBJTFDTX output,  @I_vSBJTSSEC output,  @I_vSBJTMCAR output,  @I_vSBJTSTTX output,  @I_vSBJTLTAX output,  @I_vSBJTFUTA output,  @I_vSBJTSUTA output,  @I_vFFEDTXRT output,  @I_vFLSTTXRT output,  @I_vBORCDTYP output,  @I_vBSDORCDS output,  @I_vBNFTMTHD output,  @I_vBNFFRMLA output,  @I_vBNFPRCNT_1 output,  @I_vBNFPRCNT_2 output,  @I_vBNFPRCNT_3 output,  @I_vBNFPRCNT_4 output,  @I_vBNFPRCNT_5 output,  @I_vBNFITAMT_1 output,  @I_vBNFITAMT_2 output,  @I_vBNFITAMT_3 output,  @I_vBNFITAMT_4 output,  @I_vBNFITAMT_5 output,  @I_vBNFTRMAX_1 output,  @I_vBNFTRMAX_2 output,  @I_vBNFTRMAX_3 output,  @I_vBNFTRMAX_4 output,  @I_vBNFTRMAX_5 output,  @I_vBNTRMXUN_1 output,  @I_vBNTRMXUN_2 output,  @I_vBNTRMXUN_3 output,  @I_vBNTRMXUN_4 output,  @I_vBNTRMXUN_5 output,  @I_vBNPAYPMX output,  @I_vBNFYRMAX output,  @I_vBenefit_Fiscal_Max output,      @I_vBNFLFMAX output,  @I_vW2BXNMBR output,  @I_vW2BXLABL output,  @I_vW2BXNMBR2 output,   @I_vW2BXLABL2 output,   @I_vW2BXNMBR3 output,   @I_vW2BXLABL3 output,   @I_vW2BXNMBR4 output,   @I_vW2BXLABL4 output,   @I_vDATAENTDFLT output,  @I_vEMPLRMAXMAT output,     @I_vUseDefaultCoBenefit output,  @I_vUpdateIfExists output,  @I_vRequesterTrx output,  @I_vUSRDEFND1 output,  @I_vUSRDEFND2 output,  @I_vUSRDEFND3 output,  @I_vUSRDEFND4 output,  @I_vUSRDEFND5 output,  @O_iErrorState = @iCustomState output,  @oErrString = @oErrString  output select @iError = @@error if @iStatus = 0 and @iError <> 0 begin  select @iStatus = @iError end if (@iStatus <> 0) or (@iCustomState <> 0) begin  select @O_iErrorState = 1564    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if (  @I_vEMPLOYID is NULL or  @I_vBENEFIT is NULL or  @I_vINACTIVE is NULL or  @I_vBNFBEGDT is NULL or  @I_vBNFENDDT is NULL or  @I_vUseDefaultCoBenefit is NULL or  @I_vUpdateIfExists is NULL or   @I_vRequesterTrx is NULL or  @I_vUSRDEFND1  is NULL or  @I_vUSRDEFND2  is NULL or  @I_vUSRDEFND3  is NULL or  @I_vUSRDEFND4  is NULL or  @I_vUSRDEFND5  is NULL   ) begin  select @O_iErrorState = 1565    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  select @I_vEMPLOYID = UPPER(@I_vEMPLOYID),  @I_vBENEFIT = UPPER(@I_vBENEFIT)  if ( @I_vEMPLOYID = '' ) begin  select @O_iErrorState = 1566    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vEMPLOYID <> '' ) begin  if (not exists (select 1 from UPR00100 (nolock) where EMPLOYID = @I_vEMPLOYID ))  begin  select @O_iErrorState = 1567    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if (@I_vEMPLOYID <> '') and (@I_vINACTIVE = 0) begin  if (exists (select 1 from UPR00100 (nolock) where EMPLOYID = @I_vEMPLOYID and INACTIVE = 1))  begin  select @I_vINACTIVE = 1  end  end   if ( @I_vBENEFIT = '' ) begin  select @O_iErrorState = 1568    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBENEFIT <> '' ) begin  if (not exists (select 1 from UPR40800 (nolock) where BENEFIT = @I_vBENEFIT ))  begin  select @O_iErrorState = 4510    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vUseDefaultCoBenefit < 0 or @I_vUseDefaultCoBenefit > 1 ) begin  select @O_iErrorState = 4511     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vUseDefaultCoBenefit = 0 )  begin  select @I_vVARBENFT =  case  WHEN @I_vVARBENFT is null  THEN 0  ELSE @I_vVARBENFT  end,  @I_vBNFTFREQ =  case  WHEN @I_vBNFTFREQ is null  THEN 1  ELSE @I_vBNFTFREQ  end,  @I_vSBJTFDTX =  case  WHEN @I_vSBJTFDTX is null  THEN 0  ELSE @I_vSBJTFDTX  end,  @I_vSBJTSSEC =  case  WHEN @I_vSBJTSSEC is null  THEN 0  ELSE @I_vSBJTSSEC  end,  @I_vSBJTMCAR =  case  WHEN @I_vSBJTMCAR is null  THEN 0  ELSE @I_vSBJTMCAR  end,  @I_vSBJTSTTX =  case  WHEN @I_vSBJTSTTX is null  THEN 0  ELSE @I_vSBJTSTTX  end,  @I_vSBJTLTAX =  case  WHEN @I_vSBJTLTAX is null  THEN 0  ELSE @I_vSBJTLTAX  end,  @I_vSBJTFUTA =  case  WHEN @I_vSBJTFUTA is null  THEN 0  ELSE @I_vSBJTFUTA  end,  @I_vSBJTSUTA =  case  WHEN @I_vSBJTSUTA is null  THEN 0  ELSE @I_vSBJTSUTA  end,  @I_vFFEDTXRT =  case  WHEN @I_vFFEDTXRT is null  THEN 0  ELSE @I_vFFEDTXRT  end,  @I_vFLSTTXRT =  case  WHEN @I_vFLSTTXRT is null  THEN 0  ELSE @I_vFLSTTXRT  end,  @I_vBORCDTYP =  case  WHEN @I_vBORCDTYP is null  THEN 1  ELSE @I_vBORCDTYP  end,  @I_vBSDORCDS =  case  WHEN @I_vBSDORCDS is null  THEN 0  ELSE @I_vBSDORCDS  end,   @I_vBNFTMTHD =  case  WHEN @I_vBNFTMTHD is null  THEN 1  ELSE @I_vBNFTMTHD  end,  @I_vBNFFRMLA =  case  WHEN @I_vBNFFRMLA is null  THEN 0  ELSE @I_vBNFFRMLA  end,  @I_vBNFPRCNT_1 =  case  WHEN @I_vBNFPRCNT_1 is null  THEN 0  ELSE @I_vBNFPRCNT_1  end,  @I_vBNFPRCNT_2 =  case  WHEN @I_vBNFPRCNT_2 is null  THEN 0  ELSE @I_vBNFPRCNT_2  end,  @I_vBNFPRCNT_3 =  case  WHEN @I_vBNFPRCNT_3 is null  THEN 0  ELSE @I_vBNFPRCNT_3  end,  @I_vBNFPRCNT_4 =  case  WHEN @I_vBNFPRCNT_4 is null  THEN 0  ELSE @I_vBNFPRCNT_4  end,  @I_vBNFPRCNT_5 =  case  WHEN @I_vBNFPRCNT_5 is null  THEN 0  ELSE @I_vBNFPRCNT_5  end,  @I_vBNFITAMT_1 =  case  WHEN @I_vBNFITAMT_1 is null  THEN 0  ELSE @I_vBNFITAMT_1  end,  @I_vBNFITAMT_2 =  case  WHEN @I_vBNFITAMT_2 is null  THEN 0  ELSE @I_vBNFITAMT_2  end,  @I_vBNFITAMT_3 =  case  WHEN @I_vBNFITAMT_3 is null  THEN 0  ELSE @I_vBNFITAMT_3  end,  @I_vBNFITAMT_4 =  case  WHEN @I_vBNFITAMT_4 is null  THEN 0  ELSE @I_vBNFITAMT_4  end,  @I_vBNFITAMT_5 =  case  WHEN @I_vBNFITAMT_5 is null  THEN 0  ELSE @I_vBNFITAMT_5  end,  @I_vBNFTRMAX_1 =  case  WHEN @I_vBNFTRMAX_1 is null  THEN 0  ELSE @I_vBNFTRMAX_1  end,  @I_vBNFTRMAX_2 =  case  WHEN @I_vBNFTRMAX_2 is null  THEN 0  ELSE @I_vBNFTRMAX_2  end,  @I_vBNFTRMAX_3 =  case  WHEN @I_vBNFTRMAX_3 is null  THEN 0  ELSE @I_vBNFTRMAX_3  end,  @I_vBNFTRMAX_4 =  case  WHEN @I_vBNFTRMAX_4 is null  THEN 0  ELSE @I_vBNFTRMAX_4  end,  @I_vBNFTRMAX_5 =  case  WHEN @I_vBNFTRMAX_5 is null  THEN 0  ELSE @I_vBNFTRMAX_5  end,  @I_vBNTRMXUN_1 =  case  WHEN @I_vBNTRMXUN_1 is null  THEN 0  ELSE @I_vBNTRMXUN_1  end,  @I_vBNTRMXUN_2 =  case  WHEN @I_vBNTRMXUN_2 is null  THEN 0  ELSE @I_vBNTRMXUN_2  end,  @I_vBNTRMXUN_3 =  case  WHEN @I_vBNTRMXUN_3 is null  THEN 0  ELSE @I_vBNTRMXUN_3  end,  @I_vBNTRMXUN_4 =  case  WHEN @I_vBNTRMXUN_4 is null  THEN 0  ELSE @I_vBNTRMXUN_4  end,  @I_vBNTRMXUN_5 =  case  WHEN @I_vBNTRMXUN_5 is null  THEN 0  ELSE @I_vBNTRMXUN_5  end,  @I_vBNPAYPMX =  case  WHEN @I_vBNPAYPMX is null  THEN 0  ELSE @I_vBNPAYPMX  end,  @I_vBNFYRMAX =  case  WHEN @I_vBNFYRMAX is null  THEN 0  ELSE @I_vBNFYRMAX  end,  @I_vBenefit_Fiscal_Max =        case  WHEN @I_vBenefit_Fiscal_Max is null  THEN 0  ELSE @I_vBenefit_Fiscal_Max   end,  @I_vBNFLFMAX =  case  WHEN @I_vBNFLFMAX is null  THEN 0  ELSE @I_vBNFLFMAX  end,  @I_vW2BXNMBR =  case  WHEN @I_vW2BXNMBR is null  THEN 0  ELSE @I_vW2BXNMBR  end,  @I_vW2BXLABL =  case  WHEN @I_vW2BXLABL is null  THEN ''  ELSE @I_vW2BXLABL  end,  @I_vW2BXNMBR2 =  case  WHEN @I_vW2BXNMBR2 is null   THEN 0  ELSE @I_vW2BXNMBR2  end,   @I_vW2BXLABL2  =  case  WHEN @I_vW2BXLABL2 is null  THEN ''  ELSE @I_vW2BXLABL2  end,  @I_vW2BXNMBR3 =  case  WHEN @I_vW2BXNMBR3 is null   THEN 0  ELSE @I_vW2BXNMBR3  end,   @I_vW2BXLABL3  =  case  WHEN @I_vW2BXLABL3 is null  THEN ''  ELSE @I_vW2BXLABL3  end,  @I_vW2BXNMBR4 =  case  WHEN @I_vW2BXNMBR4 is null   THEN 0  ELSE @I_vW2BXNMBR4  end,   @I_vW2BXLABL4 =  case  WHEN @I_vW2BXLABL4 is null  THEN ''  ELSE @I_vW2BXLABL4  end,  @I_vDATAENTDFLT =  case  WHEN @I_vDATAENTDFLT is null  THEN 0  ELSE @I_vDATAENTDFLT  end,  @I_vEMPLRMAXMAT =        case  WHEN @I_vEMPLRMAXMAT is null  THEN 0  ELSE @I_vEMPLRMAXMAT  end end  if ( @I_vUseDefaultCoBenefit = 1 )  begin  select @I_vBNFBEGDT =  case  WHEN @I_vBNFBEGDT = ''  THEN BNFBEGDT   ELSE @I_vBNFBEGDT   end,  @I_vVARBENFT =  case  WHEN @I_vVARBENFT is null  THEN VARBENFT  ELSE @I_vVARBENFT  end,  @I_vBNFTFREQ =  case  WHEN @I_vBNFTFREQ is null  THEN BNFTFREQ  ELSE @I_vBNFTFREQ  end,  @I_vSBJTFDTX =  case  WHEN @I_vSBJTFDTX is null  THEN SBJTFDTX  ELSE @I_vSBJTFDTX  end,  @I_vSBJTSSEC =  case  WHEN @I_vSBJTSSEC is null   THEN SBJTSSEC   ELSE @I_vSBJTSSEC  end,  @I_vSBJTMCAR =  case  WHEN @I_vSBJTMCAR is null  THEN SBJTMCAR  ELSE @I_vSBJTMCAR  end,  @I_vSBJTSTTX =  case  WHEN @I_vSBJTSTTX is null  THEN SBJTSTTX  ELSE @I_vSBJTSTTX  end,  @I_vSBJTLTAX =  case  WHEN @I_vSBJTLTAX is null  THEN SBJTLTAX  ELSE @I_vSBJTLTAX  end,  @I_vSBJTFUTA =  case  WHEN @I_vSBJTFUTA is null  THEN SBJTFUTA  ELSE @I_vSBJTFUTA  end,  @I_vSBJTSUTA =  case  WHEN @I_vSBJTSUTA is null  THEN SBJTSUTA  ELSE @I_vSBJTSUTA  end,  @I_vFFEDTXRT =  case  WHEN @I_vFFEDTXRT is null  THEN FFEDTXRT * .01   ELSE @I_vFFEDTXRT  end,  @I_vFLSTTXRT =  case  WHEN @I_vFLSTTXRT is null  THEN FLSTTXRT / 100  ELSE @I_vFLSTTXRT * .01   end,  @I_vBORCDTYP =  case  WHEN @I_vBORCDTYP is null  THEN BORCDTYP  ELSE @I_vBORCDTYP  end,  @I_vBSDORCDS =  case  WHEN @I_vBSDORCDS is null  THEN BSDORCDS  ELSE @I_vBSDORCDS  end,  @I_vBNFTMTHD =  case  WHEN @I_vBNFTMTHD is null  THEN BNFTMTHD  ELSE @I_vBNFTMTHD  end,  @I_vBNFFRMLA =  case  WHEN @I_vBNFFRMLA is null  THEN BNFFRMLA  ELSE @I_vBNFFRMLA  end,  @I_vBNFPRCNT_1 =  case  WHEN @I_vBNFPRCNT_1 is null  THEN BNFPRCNT_1  ELSE @I_vBNFPRCNT_1  end,  @I_vBNFPRCNT_2 =  case  WHEN @I_vBNFPRCNT_2 is null  THEN BNFPRCNT_2  ELSE @I_vBNFPRCNT_2  end,  @I_vBNFPRCNT_3 =  case  WHEN @I_vBNFPRCNT_3 is null  THEN BNFPRCNT_3  ELSE @I_vBNFPRCNT_3  end,  @I_vBNFPRCNT_4 =  case  WHEN @I_vBNFPRCNT_4 is null  THEN BNFPRCNT_4  ELSE @I_vBNFPRCNT_4  end,  @I_vBNFPRCNT_5 =  case  WHEN @I_vBNFPRCNT_5 is null  THEN BNFPRCNT_5  ELSE @I_vBNFPRCNT_5  end,  @I_vBNFITAMT_1 =  case  WHEN @I_vBNFITAMT_1 is null  THEN BNFITAMT_1  ELSE @I_vBNFITAMT_1  end,  @I_vBNFITAMT_2 =  case  WHEN @I_vBNFITAMT_2 is null  THEN BNFITAMT_2  ELSE @I_vBNFITAMT_2  end,  @I_vBNFITAMT_3 =  case  WHEN @I_vBNFITAMT_3 is null  THEN BNFITAMT_3  ELSE @I_vBNFITAMT_3  end,  @I_vBNFITAMT_4 =  case  WHEN @I_vBNFITAMT_4 is null  THEN BNFITAMT_4  ELSE @I_vBNFITAMT_4  end,  @I_vBNFITAMT_5 =  case  WHEN @I_vBNFITAMT_5 is null  THEN BNFITAMT_5  ELSE @I_vBNFITAMT_5  end,  @I_vBNFTRMAX_1 =  case  WHEN @I_vBNFTRMAX_1 is null  THEN BNFTRMAX_1  ELSE @I_vBNFTRMAX_1  end,  @I_vBNFTRMAX_2 =  case  WHEN @I_vBNFTRMAX_2 is null  THEN BNFTRMAX_2  ELSE @I_vBNFTRMAX_2  end,  @I_vBNFTRMAX_3 =  case  WHEN @I_vBNFTRMAX_3 is null  THEN BNFTRMAX_3  ELSE @I_vBNFTRMAX_3  end,  @I_vBNFTRMAX_4 =  case  WHEN @I_vBNFTRMAX_4 is null  THEN BNFTRMAX_4  ELSE @I_vBNFTRMAX_4  end,  @I_vBNFTRMAX_5 =  case  WHEN @I_vBNFTRMAX_5 is null  THEN BNFTRMAX_5  ELSE @I_vBNFTRMAX_5  end,  @I_vBNTRMXUN_1 =  case  WHEN @I_vBNTRMXUN_1 is null  THEN BNTRMXUN_1  ELSE @I_vBNTRMXUN_1  end,  @I_vBNTRMXUN_2 =  case  WHEN @I_vBNTRMXUN_2 is null  THEN BNTRMXUN_2  ELSE @I_vBNTRMXUN_2  end,  @I_vBNTRMXUN_3 =  case  WHEN @I_vBNTRMXUN_3 is null  THEN BNTRMXUN_3  ELSE @I_vBNTRMXUN_3  end,  @I_vBNTRMXUN_4 =  case  WHEN @I_vBNTRMXUN_4 is null  THEN BNTRMXUN_4  ELSE @I_vBNTRMXUN_4  end,  @I_vBNTRMXUN_5 =  case  WHEN @I_vBNTRMXUN_5 is null  THEN BNTRMXUN_5  ELSE @I_vBNTRMXUN_5  end,  @I_vBNPAYPMX =  case  WHEN @I_vBNPAYPMX is null  THEN BNPAYPMX  ELSE @I_vBNPAYPMX  end,  @I_vBNFYRMAX =  case  WHEN @I_vBNFYRMAX is null  THEN BNFYRMAX  ELSE @I_vBNFYRMAX  end,  @I_vBenefit_Fiscal_Max =        case  WHEN @I_vBenefit_Fiscal_Max is null  THEN Benefit_Fiscal_Max  ELSE @I_vBenefit_Fiscal_Max   end,  @I_vBNFLFMAX =  case   WHEN @I_vBNFLFMAX is null  THEN BNFLFMAX  ELSE @I_vBNFLFMAX  end,  @I_vW2BXNMBR =  case  WHEN @I_vW2BXNMBR is null  THEN W2BXNMBR  ELSE @I_vW2BXNMBR  end,  @I_vW2BXLABL =  case  WHEN @I_vW2BXLABL is null  THEN W2BXLABL  ELSE @I_vW2BXLABL  end,  @I_vW2BXNMBR2  =  case  WHEN @I_vW2BXNMBR2 is null   THEN W2BXNMBR2  ELSE @I_vW2BXNMBR2  end,  @I_vW2BXLABL2  =  case  WHEN @I_vW2BXLABL2 is null  THEN W2BXLABL2  ELSE @I_vW2BXLABL2  end,  @I_vW2BXNMBR3  =  case  WHEN @I_vW2BXNMBR3 is null   THEN W2BXNMBR3  ELSE @I_vW2BXNMBR3  end,  @I_vW2BXLABL3  =  case  WHEN @I_vW2BXLABL3 is null  THEN W2BXLABL3  ELSE @I_vW2BXLABL3  end,   @I_vW2BXNMBR4  =  case  WHEN @I_vW2BXNMBR4 is null   THEN W2BXNMBR4  ELSE @I_vW2BXNMBR4  end,  @I_vW2BXLABL4  =  case  WHEN @I_vW2BXLABL4 is null  THEN W2BXLABL4  ELSE @I_vW2BXLABL4  end,   @I_vDATAENTDFLT =  case  WHEN @I_vDATAENTDFLT is null  THEN DATAENTDFLT  ELSE @I_vDATAENTDFLT  end,  @I_vEMPLRMAXMAT =         case  WHEN @I_vEMPLRMAXMAT is null  THEN EMPLRMAXMAT  ELSE @I_vEMPLRMAXMAT  end   from UPR40800 (nolock) where BENEFIT = @I_vBENEFIT end  select @Enable_Fiscal_Tracking = Enable_Fiscal_Tracking from UPR40200 (nolock)  if (@Enable_Fiscal_Tracking = 0)  begin   select @I_vBenefit_Fiscal_Max = 0 end  if ( @I_vINACTIVE < 0 or @I_vINACTIVE > 1 )  begin  select @O_iErrorState = 4078     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFBEGDT = '' ) begin  select @O_iErrorState = 4079     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vVARBENFT < 0 or @I_vVARBENFT > 1 ) begin  select @O_iErrorState = 4080     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTFREQ < 1 or @I_vBNFTFREQ > 8 ) begin  select @O_iErrorState = 4081     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTFDTX < 0 or @I_vSBJTFDTX > 1 ) begin  select @O_iErrorState = 4082     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTSSEC < 0 or @I_vSBJTSSEC > 1 ) begin  select @O_iErrorState = 4083     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTMCAR < 0 or @I_vSBJTMCAR > 1 ) begin  select @O_iErrorState = 4084     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTSTTX < 0 or @I_vSBJTSTTX > 1 ) begin  select @O_iErrorState = 4595     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTLTAX < 0 or @I_vSBJTLTAX > 1 ) begin  select @O_iErrorState = 4596     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTFUTA < 0 or @I_vSBJTFUTA > 1 ) begin  select @O_iErrorState = 4087     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTSUTA < 0 or @I_vSBJTSUTA > 1 ) begin  select @O_iErrorState = 1646     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTFDTX = 0 ) and ( @I_vFFEDTXRT > 0 ) begin  select @O_iErrorState = 1647     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vFFEDTXRT < 0 or @I_vFFEDTXRT > 99.99 )  begin  select @O_iErrorState = 1648     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTSTTX = 0 ) and ( @I_vFLSTTXRT > 0 ) begin  select @O_iErrorState = 1649     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vFLSTTXRT < 0 or @I_vFLSTTXRT > 99.99 )  begin  select @O_iErrorState = 1650     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBORCDTYP < 1 or @I_vBORCDTYP > 2 ) begin  select @O_iErrorState = 1651     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBSDORCDS < 0 or @I_vBSDORCDS > 1 )  begin  select @O_iErrorState = 1652     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD < 1 or @I_vBNFTMTHD > 5 ) begin  select @O_iErrorState = 1653     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 2 ) and ( @I_vSBJTFDTX = 1 or @I_vSBJTSSEC = 1 or @I_vSBJTMCAR = 1 or @I_vSBJTSTTX = 1 or @I_vSBJTLTAX = 1 or @I_vSBJTFUTA = 1 or @I_vSBJTSUTA = 1) begin  select @O_iErrorState = 1654     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 3 ) and ( @I_vBORCDTYP = 1 ) begin  select @O_iErrorState = 1655     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 3 ) and ( @I_vBORCDTYP = 2 ) and ( @I_vBSDORCDS = 0 ) begin  select @O_iErrorState = 1656     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 5 ) and ( @I_vBORCDTYP = 2 ) begin  select @O_iErrorState = 1657     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA < 0 or @I_vBNFFRMLA > 1 ) begin  select @O_iErrorState = 1658     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vVARBENFT = 1 ) and ( @I_vBNFFRMLA = 1 ) begin  select @O_iErrorState = 1659     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vW2BXNMBR > 99 ) begin  select @O_iErrorState = 1725     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vW2BXNMBR2 > 99 ) begin  select @O_iErrorState = 11316     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vW2BXNMBR3 > 99 ) begin  select @O_iErrorState = 11317     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vW2BXNMBR4 > 99 ) begin  select @O_iErrorState = 11318     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vBenefit_Fiscal_Max < 0)  begin  select @O_iErrorState = 20188     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vDATAENTDFLT < 0 or @I_vDATAENTDFLT > 1 ) begin  select @O_iErrorState = 1726     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vDATAENTDFLT = 1 and @I_vVARBENFT = 0 )  begin  select @O_iErrorState = 5325     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD <> 3 and @I_vEMPLRMAXMAT > 0 ) begin  select @O_iErrorState = 5326     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vEMPLRMAXMAT < 0 or @I_vEMPLRMAXMAT > 100 )  begin  select @O_iErrorState = 5327     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vUpdateIfExists < 0 or @I_vUpdateIfExists > 1)  begin  select @O_iErrorState = 1727     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vRequesterTrx < 0 or @I_vRequesterTrx > 1)  begin  select @O_iErrorState = 3681     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTFDTX = 1 or @I_vSBJTSSEC = 1 or @I_vSBJTMCAR = 1 or @I_vSBJTSTTX = 1 or @I_vSBJTLTAX = 1 or @I_vSBJTFUTA = 1 or @I_vSBJTSUTA = 1 ) begin  select @TAXABLE = 1  end   if ( @I_vBNPAYPMX < 0 )  begin  select @O_iErrorState = 1728     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFYRMAX < 0 )  begin  select @O_iErrorState = 1666     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFLFMAX < 0 )  begin  select @O_iErrorState = 1667     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNPAYPMX > @I_vBNFYRMAX ) and ( @I_vBNFYRMAX > 0 ) begin  select @O_iErrorState = 1668     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNPAYPMX > @I_vBNFLFMAX ) and ( @I_vBNFLFMAX > 0 ) begin  select @O_iErrorState = 1669     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFYRMAX > @I_vBNFLFMAX ) and ( @I_vBNFLFMAX > 0 ) begin  select @O_iErrorState = 1670     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vBenefit_Fiscal_Max > @I_vBNFLFMAX) and (@I_vBNFLFMAX > 0) begin  select @O_iErrorState = 20189     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFPRCNT_1 < 0 )  begin  select @O_iErrorState = 1671     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFPRCNT_2 < 0 )  begin  select @O_iErrorState = 1672     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFPRCNT_3 < 0 )  begin  select @O_iErrorState = 1673     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFPRCNT_4 < 0 )  begin  select @O_iErrorState = 1674     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFPRCNT_5 < 0 )  begin  select @O_iErrorState = 1675     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFITAMT_1 < 0 )  begin  select @O_iErrorState = 1676     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFITAMT_2 < 0 )  begin  select @O_iErrorState = 1677     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFITAMT_3 < 0 )  begin  select @O_iErrorState = 1678     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFITAMT_4 < 0 )  begin  select @O_iErrorState = 1679     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFITAMT_5 < 0 )  begin  select @O_iErrorState = 1680     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 1 ) and ( @I_vBNFITAMT_1 <> 0 or @I_vBNFITAMT_2 <> 0 or @I_vBNFITAMT_3 <> 0 or @I_vBNFITAMT_4 <> 0 or @I_vBNFITAMT_5 <> 0 ) begin  select @O_iErrorState = 1681     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 1 ) and ( @I_vBNTRMXUN_1 <> 0 or @I_vBNTRMXUN_2 <> 0 or @I_vBNTRMXUN_3 <> 0 or @I_vBNTRMXUN_4 <> 0 or @I_vBNTRMXUN_5 <> 0 ) begin  select @O_iErrorState = 1682     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 1 ) and ( @I_vBNFFRMLA = 0 ) and ( @I_vBNFPRCNT_2 <> 0 or @I_vBNFPRCNT_3 <> 0 or @I_vBNFPRCNT_4 <> 0 or @I_vBNFPRCNT_5 <> 0 ) begin  select @O_iErrorState = 1683     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 1 ) and ( @I_vBNFFRMLA = 0 ) and ( @I_vBNFTRMAX_2 <> 0 or @I_vBNFTRMAX_3 <> 0 or @I_vBNFTRMAX_4 <> 0 or @I_vBNFTRMAX_5 <> 0 ) begin  select @O_iErrorState = 1684     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 2 ) and ( @I_vBNFITAMT_1 <> 0 or @I_vBNFITAMT_2 <> 0 or @I_vBNFITAMT_3 <> 0 or @I_vBNFITAMT_4 <> 0 or @I_vBNFITAMT_5 <> 0 ) begin  select @O_iErrorState = 1685     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 2 ) and ( @I_vBNTRMXUN_1 <> 0 or @I_vBNTRMXUN_2 <> 0 or @I_vBNTRMXUN_3 <> 0 or @I_vBNTRMXUN_4 <> 0 or @I_vBNTRMXUN_5 <> 0 ) begin  select @O_iErrorState = 1686     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 2 ) and ( @I_vBNFFRMLA = 0 ) and ( @I_vBNFPRCNT_2 <> 0 or @I_vBNFPRCNT_3 <> 0 or @I_vBNFPRCNT_4 <> 0 or @I_vBNFPRCNT_5 <> 0 ) begin  select @O_iErrorState = 1687     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 2 ) and ( @I_vBNFFRMLA = 0 ) and ( @I_vBNFTRMAX_2 <> 0 or @I_vBNFTRMAX_3 <> 0 or @I_vBNFTRMAX_4 <> 0 or @I_vBNFTRMAX_5 <> 0 ) begin  select @O_iErrorState = 1688     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 3 ) and ( @I_vBNFITAMT_1 <> 0 or @I_vBNFITAMT_2 <> 0 or @I_vBNFITAMT_3 <> 0 or @I_vBNFITAMT_4 <> 0 or @I_vBNFITAMT_5 <> 0 ) begin  select @O_iErrorState = 1689     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 3 ) and ( @I_vBNTRMXUN_1 <> 0 or @I_vBNTRMXUN_2 <> 0 or @I_vBNTRMXUN_3 <> 0 or @I_vBNTRMXUN_4 <> 0 or @I_vBNTRMXUN_5 <> 0 ) begin  select @O_iErrorState = 1690     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 3 ) and ( @I_vBNFFRMLA = 0 ) and ( @I_vBNFPRCNT_2 <> 0 or @I_vBNFPRCNT_3 <> 0 or @I_vBNFPRCNT_4 <> 0 or @I_vBNFPRCNT_5 <> 0 ) begin  select @O_iErrorState = 1691     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 3 ) and ( @I_vBNFFRMLA = 0 ) and ( @I_vBNFTRMAX_2 <> 0 or @I_vBNFTRMAX_3 <> 0 or @I_vBNFTRMAX_4 <> 0 or @I_vBNFTRMAX_5 <> 0 ) begin  select @O_iErrorState = 1692     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 4 ) and ( @I_vBNFPRCNT_1 <> 0 or @I_vBNFPRCNT_2 <> 0 or @I_vBNFPRCNT_3 <> 0 or @I_vBNFPRCNT_4 <> 0 or @I_vBNFPRCNT_5 <> 0 ) begin  select @O_iErrorState = 1693     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 4 ) and ( @I_vBNTRMXUN_1 <> 0 or @I_vBNTRMXUN_2 <> 0 or @I_vBNTRMXUN_3 <> 0 or @I_vBNTRMXUN_4 <> 0 or @I_vBNTRMXUN_5 <> 0 ) begin  select @O_iErrorState = 1694     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 4 ) and ( @I_vBNFFRMLA = 0 ) and ( @I_vBNFITAMT_2 <> 0 or @I_vBNFITAMT_3 <> 0 or @I_vBNFITAMT_4 <> 0 or @I_vBNFITAMT_5 <> 0 ) begin  select @O_iErrorState = 1695     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 4 ) and ( @I_vBNFFRMLA = 0 ) and ( @I_vBNFTRMAX_2 <> 0 or @I_vBNFTRMAX_3 <> 0 or @I_vBNFTRMAX_4 <> 0 or @I_vBNFTRMAX_5 <> 0 ) begin  select @O_iErrorState = 1696     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 5 ) and ( @I_vBNFPRCNT_1 <> 0 or @I_vBNFPRCNT_2 <> 0 or @I_vBNFPRCNT_3 <> 0 or @I_vBNFPRCNT_4 <> 0 or @I_vBNFPRCNT_5 <> 0 ) begin  select @O_iErrorState = 1697     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 5 ) and ( @I_vBNFTRMAX_1 <> 0 or @I_vBNFTRMAX_2 <> 0 or @I_vBNFTRMAX_3 <> 0 or @I_vBNFTRMAX_4 <> 0 or @I_vBNFTRMAX_5 <> 0 ) begin  select @O_iErrorState = 1698     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 5 ) and ( @I_vBNFFRMLA = 0 ) and ( @I_vBNFITAMT_2 <> 0 or @I_vBNFITAMT_3 <> 0 or @I_vBNFITAMT_4 <> 0 or @I_vBNFITAMT_5 <> 0 ) begin  select @O_iErrorState = 1699     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFTMTHD = 5 ) and ( @I_vBNFFRMLA = 0 ) and ( @I_vBNTRMXUN_2 <> 0 or @I_vBNTRMXUN_3 <> 0 or @I_vBNTRMXUN_4 <> 0 or @I_vBNTRMXUN_5 <> 0 ) begin  select @O_iErrorState = 1700     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNFTRMAX_2 <> 0 ) and ( @I_vBNFTRMAX_1 > @I_vBNFTRMAX_2 ) begin  select @O_iErrorState = 1713     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNFTRMAX_3 <> 0 ) and ( @I_vBNFTRMAX_2 > @I_vBNFTRMAX_3 ) begin  select @O_iErrorState = 1714     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNFTRMAX_4 <> 0 ) and ( @I_vBNFTRMAX_3 > @I_vBNFTRMAX_4 ) begin  select @O_iErrorState = 1715     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNFTRMAX_5 <> 0 ) and ( @I_vBNFTRMAX_4 > @I_vBNFTRMAX_5 ) begin  select @O_iErrorState = 1716     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNFTRMAX_3 <> 0 ) and ( @I_vBNFTRMAX_1 > @I_vBNFTRMAX_3 ) begin  select @O_iErrorState = 1492     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNFTRMAX_4 <> 0 ) and ( @I_vBNFTRMAX_1 > @I_vBNFTRMAX_4 ) begin  select @O_iErrorState = 1493     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNFTRMAX_5 <> 0 ) and ( @I_vBNFTRMAX_1 > @I_vBNFTRMAX_5 ) begin  select @O_iErrorState = 1494     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNFTRMAX_4 <> 0 ) and ( @I_vBNFTRMAX_2 > @I_vBNFTRMAX_4 ) begin  select @O_iErrorState = 1495     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNFTRMAX_5 <> 0 ) and ( @I_vBNFTRMAX_2 > @I_vBNFTRMAX_5 ) begin  select @O_iErrorState = 1496     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNFTRMAX_5 <> 0 ) and ( @I_vBNFTRMAX_3 > @I_vBNFTRMAX_5 ) begin  select @O_iErrorState = 1497     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNTRMXUN_2 <> 0 ) and ( @I_vBNTRMXUN_1 > @I_vBNTRMXUN_2 ) begin  select @O_iErrorState = 1498     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNTRMXUN_3 <> 0 ) and ( @I_vBNTRMXUN_2 > @I_vBNTRMXUN_3 ) begin  select @O_iErrorState = 1499     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNTRMXUN_4 <> 0 ) and ( @I_vBNTRMXUN_3 > @I_vBNTRMXUN_4 ) begin  select @O_iErrorState = 3811     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNTRMXUN_5 <> 0 ) and ( @I_vBNTRMXUN_4 > @I_vBNTRMXUN_5 ) begin  select @O_iErrorState = 1946     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNTRMXUN_3 <> 0 ) and ( @I_vBNTRMXUN_1 > @I_vBNTRMXUN_3 ) begin  select @O_iErrorState = 1947     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNTRMXUN_4 <> 0 ) and ( @I_vBNTRMXUN_1 > @I_vBNTRMXUN_4 ) begin  select @O_iErrorState = 2085     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNTRMXUN_5 <> 0 ) and ( @I_vBNTRMXUN_1 > @I_vBNTRMXUN_5 ) begin  select @O_iErrorState = 2086     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNTRMXUN_4 <> 0 ) and ( @I_vBNTRMXUN_2 > @I_vBNTRMXUN_4 ) begin  select @O_iErrorState = 2087     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNTRMXUN_5 <> 0 ) and ( @I_vBNTRMXUN_2 > @I_vBNTRMXUN_5 ) begin  select @O_iErrorState = 2088     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBNFFRMLA = 1 ) and ( @I_vBNTRMXUN_5 <> 0 ) and ( @I_vBNTRMXUN_3 > @I_vBNTRMXUN_5 ) begin  select @O_iErrorState = 2089     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if @O_iErrorState <> 0  return (@O_iErrorState)  exec @iStatus = DYNAMICS..tasmGetNextNoteIndex  @I_sCompanyID   = @sCompanyID,  @I_iSQLSessionID = 0,  @I_noteincrement  = 1,  @O_mNoteIndex   = @nNextNoteIndex output,  @O_iErrorState  = @iGetNextNoteIdxErrState output select @iError = @@error if ((@iStatus <> 0) or (@iGetNextNoteIdxErrState <> 0) or (@iError <> 0)) begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@iGetNextNoteIdxErrState))  select @O_iErrorState = 2090   exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if not exists(select 1 from UPR00600 where EMPLOYID = @I_vEMPLOYID and BENEFIT = @I_vBENEFIT ) begin  insert UPR00600(  EMPLOYID,  BENEFIT,  INACTIVE,  BNFBEGDT,  BNFENDDT,  VARBENFT,  BNFTFREQ,  TAXABLE,  SBJTFDTX,  SBJTSSEC,  SBJTMCAR,  SBJTSTTX,  SBJTLTAX,  SBJTFUTA,  SBJTSUTA,  FFEDTXRT,  FLSTTXRT,  BORCDTYP,  BSDORCDS,  BNFTMTHD,  BNFFRMLA,  BNFPRCNT_1,  BNFPRCNT_2,  BNFPRCNT_3,  BNFPRCNT_4,  BNFPRCNT_5,  BNFITAMT_1,  BNFITAMT_2,  BNFITAMT_3,  BNFITAMT_4,  BNFITAMT_5,  BNFTRMAX_1,  BNFTRMAX_2,  BNFTRMAX_3,  BNFTRMAX_4,  BNFTRMAX_5,  BNTRMXUN_1,  BNTRMXUN_2,  BNTRMXUN_3,  BNTRMXUN_4,  BNTRMXUN_5,  BNPAYPMX,  BNFYRMAX,  BNFLFMAX,  W2BXNMBR,  W2BXLABL,  NOTEINDX,  LTDBNFIT,  DATAENTDFLT,  EMPLRMAXMAT,     W2BXNMBR2,   W2BXLABL2,   W2BXNMBR3,   W2BXLABL3,   W2BXNMBR4,   W2BXLABL4,  Benefit_Fiscal_Max  )  select  @I_vEMPLOYID,     @I_vBENEFIT,     @I_vINACTIVE,     @I_vBNFBEGDT,     @I_vBNFENDDT,     @I_vVARBENFT,     @I_vBNFTFREQ,     @TAXABLE,     @I_vSBJTFDTX,     @I_vSBJTSSEC,     @I_vSBJTMCAR,     @I_vSBJTSTTX,     @I_vSBJTLTAX,     @I_vSBJTFUTA,     @I_vSBJTSUTA,     @I_vFFEDTXRT * 100,    @I_vFLSTTXRT * 100,    @I_vBORCDTYP,     @I_vBSDORCDS,     @I_vBNFTMTHD,     @I_vBNFFRMLA,     @I_vBNFPRCNT_1,     @I_vBNFPRCNT_2,     @I_vBNFPRCNT_3,     @I_vBNFPRCNT_4,     @I_vBNFPRCNT_5,     @I_vBNFITAMT_1,     @I_vBNFITAMT_2,     @I_vBNFITAMT_3,     @I_vBNFITAMT_4,     @I_vBNFITAMT_5,     @I_vBNFTRMAX_1,     @I_vBNFTRMAX_2,     @I_vBNFTRMAX_3,     @I_vBNFTRMAX_4,     @I_vBNFTRMAX_5,     @I_vBNTRMXUN_1 * 100,    @I_vBNTRMXUN_2 * 100,    @I_vBNTRMXUN_3 * 100,    @I_vBNTRMXUN_4 * 100,    @I_vBNTRMXUN_5 * 100,    @I_vBNPAYPMX,     @I_vBNFYRMAX,     @I_vBNFLFMAX,     @I_vW2BXNMBR,     @I_vW2BXLABL,     @nNextNoteIndex,    0,        @I_vDATAENTDFLT,    @I_vEMPLRMAXMAT,     @I_vW2BXNMBR2,      @I_vW2BXLABL2,      @I_vW2BXNMBR3,      @I_vW2BXLABL3,      @I_vW2BXNMBR4,     @I_vW2BXLABL4,      @I_vBenefit_Fiscal_Max   if (@@error <> 0)  begin  select @O_iErrorState = 2318     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end else if ( @I_vUpdateIfExists = 1 ) begin  update UPR00600 set  INACTIVE = @I_vINACTIVE,   BNFBEGDT =  case  WHEN @I_vBNFBEGDT = ''  THEN BNFBEGDT  ELSE @I_vBNFBEGDT  end,  BNFENDDT =  case  WHEN @I_vBNFENDDT = ''  THEN BNFENDDT  ELSE @I_vBNFENDDT  end,  VARBENFT = @I_vVARBENFT,  BNFTFREQ = @I_vBNFTFREQ,  SBJTFDTX = @I_vSBJTFDTX,  SBJTSSEC = @I_vSBJTSSEC,  SBJTMCAR = @I_vSBJTMCAR,  SBJTSTTX = @I_vSBJTSTTX,  SBJTLTAX = @I_vSBJTLTAX,  SBJTFUTA = @I_vSBJTFUTA,  SBJTSUTA = @I_vSBJTSUTA,  FFEDTXRT =  case  WHEN @I_vSBJTFDTX = 0   THEN 0   ELSE @I_vFFEDTXRT * 100  end,  FLSTTXRT =  case  WHEN SBJTSTTX = 0   THEN 0  ELSE @I_vFLSTTXRT * 100  end,  BORCDTYP = @I_vBORCDTYP,  BSDORCDS = @I_vBSDORCDS,  BNFTMTHD = @I_vBNFTMTHD,  BNFFRMLA = @I_vBNFFRMLA,  BNFPRCNT_1 =  case  WHEN @I_vBNFTMTHD = 4 or @I_vBNFTMTHD = 5  THEN 0  ELSE @I_vBNFPRCNT_1  end,  BNFPRCNT_2 =  case  WHEN @I_vBNFFRMLA = 0  THEN 0  ELSE @I_vBNFPRCNT_2  end,  BNFPRCNT_3 =  case  WHEN @I_vBNFFRMLA = 0  THEN 0  ELSE @I_vBNFPRCNT_3  end,  BNFPRCNT_4 =  case  WHEN @I_vBNFFRMLA = 0  THEN 0  ELSE @I_vBNFPRCNT_4  end,  BNFPRCNT_5 =  case  WHEN @I_vBNFFRMLA = 0  THEN 0  ELSE @I_vBNFPRCNT_5  end,  BNFITAMT_1 =  case  WHEN @I_vBNFTMTHD = 1 or @I_vBNFTMTHD = 2 or @I_vBNFTMTHD = 3  THEN 0  ELSE @I_vBNFITAMT_1  end,  BNFITAMT_2 =  case  WHEN @I_vBNFFRMLA = 0  THEN 0  ELSE @I_vBNFITAMT_2  end,  BNFITAMT_3 =  case  WHEN @I_vBNFFRMLA = 0  THEN 0  ELSE @I_vBNFITAMT_3  end,  BNFITAMT_4 =  case  WHEN @I_vBNFFRMLA = 0  THEN 0  ELSE @I_vBNFITAMT_4  end,  BNFITAMT_5 =  case  WHEN @I_vBNFFRMLA = 0  THEN 0  ELSE @I_vBNFITAMT_5  end,  BNFTRMAX_1 =  case  WHEN @I_vBNFTMTHD = 5  THEN 0   ELSE @I_vBNFTRMAX_1  end,   BNFTRMAX_2 =  case  WHEN @I_vBNFFRMLA = 0  THEN 0  ELSE @I_vBNFTRMAX_2  end,  BNFTRMAX_3 =  case  WHEN @I_vBNFFRMLA = 0  THEN 0  ELSE @I_vBNFTRMAX_3  end,  BNFTRMAX_4 =  case  WHEN @I_vBNFFRMLA = 0  THEN 0  ELSE @I_vBNFTRMAX_4  end,  BNFTRMAX_5 =  case  WHEN @I_vBNFFRMLA = 0  THEN 0  ELSE @I_vBNFTRMAX_5  end,  BNTRMXUN_1 =  case  WHEN @I_vBNFTMTHD <> 5  THEN 0  ELSE @I_vBNTRMXUN_1 * 100  end,  BNTRMXUN_2 =  case  WHEN @I_vBNFTMTHD <> 5  THEN 0  ELSE @I_vBNTRMXUN_2 * 100  end,  BNTRMXUN_3 =  case  WHEN @I_vBNFTMTHD <> 5  THEN 0  ELSE @I_vBNTRMXUN_3 * 100  end,  BNTRMXUN_4 =  case  WHEN @I_vBNFTMTHD <> 5  THEN 0  ELSE @I_vBNTRMXUN_4 * 100  end,  BNTRMXUN_5 =  case  WHEN @I_vBNFTMTHD <> 5  THEN 0  ELSE @I_vBNTRMXUN_5 * 100  end,  BNPAYPMX = @I_vBNPAYPMX,  BNFYRMAX = @I_vBNFYRMAX,  Benefit_Fiscal_Max = @I_vBenefit_Fiscal_Max,  BNFLFMAX = @I_vBNFLFMAX,  W2BXNMBR = @I_vW2BXNMBR,  W2BXLABL = @I_vW2BXLABL,  DATAENTDFLT = @I_vDATAENTDFLT,  EMPLRMAXMAT = @I_vEMPLRMAXMAT,      W2BXNMBR2 = @I_vW2BXNMBR2,  W2BXLABL2 = @I_vW2BXLABL2,  W2BXNMBR3 = @I_vW2BXNMBR3,  W2BXLABL3 = @I_vW2BXLABL3,  W2BXNMBR4 = @I_vW2BXNMBR4,  W2BXLABL4 = @I_vW2BXLABL4  from UPR00600  where EMPLOYID = @I_vEMPLOYID and BENEFIT = @I_vBENEFIT  if (@@error <> 0)  begin  select @O_iErrorState = 2319     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if @O_iErrorState <> 0  return (@O_iErrorState)  exec @iStatus = taCreateEmployeeBenefitPost  @I_vEMPLOYID,  @I_vBENEFIT,  @I_vINACTIVE,  @I_vBNFBEGDT,  @I_vBNFENDDT,  @I_vVARBENFT,  @I_vBNFTFREQ,  @I_vSBJTFDTX,  @I_vSBJTSSEC,  @I_vSBJTMCAR,  @I_vSBJTSTTX,  @I_vSBJTLTAX,  @I_vSBJTFUTA,  @I_vSBJTSUTA,  @I_vFFEDTXRT,  @I_vFLSTTXRT,  @I_vBORCDTYP,  @I_vBSDORCDS,  @I_vBNFTMTHD,  @I_vBNFFRMLA,  @I_vBNFPRCNT_1,  @I_vBNFPRCNT_2,  @I_vBNFPRCNT_3,  @I_vBNFPRCNT_4,  @I_vBNFPRCNT_5,  @I_vBNFITAMT_1,  @I_vBNFITAMT_2,  @I_vBNFITAMT_3,  @I_vBNFITAMT_4,  @I_vBNFITAMT_5,  @I_vBNFTRMAX_1,  @I_vBNFTRMAX_2,  @I_vBNFTRMAX_3,  @I_vBNFTRMAX_4,  @I_vBNFTRMAX_5,  @I_vBNTRMXUN_1,  @I_vBNTRMXUN_2,  @I_vBNTRMXUN_3,  @I_vBNTRMXUN_4,  @I_vBNTRMXUN_5,  @I_vBNPAYPMX,  @I_vBNFYRMAX,  @I_vBenefit_Fiscal_Max,  @I_vBNFLFMAX,  @I_vW2BXNMBR,  @I_vW2BXLABL,  @I_vW2BXNMBR2,   @I_vW2BXLABL2,   @I_vW2BXNMBR3,   @I_vW2BXLABL3,   @I_vW2BXNMBR4,   @I_vW2BXLABL4,  @I_vDATAENTDFLT,  @I_vEMPLRMAXMAT,     @I_vUseDefaultCoBenefit,  @I_vUpdateIfExists,  @I_vRequesterTrx,  @I_vUSRDEFND1,  @I_vUSRDEFND2,  @I_vUSRDEFND3,  @I_vUSRDEFND4,  @I_vUSRDEFND5,  @O_iErrorState = @iCustomState output,  @oErrString = @oErrString  output select @iError = @@error if @iStatus = 0 and @iError <> 0 begin  select @iStatus = @iError end if (@iStatus <> 0) or (@iCustomState <> 0) begin  select @O_iErrorState = 2784    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  return (@O_iErrorState)   
GO
GRANT EXECUTE ON  [dbo].[taCreateEmployeeBenefit] TO [DYNGRP]
GO
