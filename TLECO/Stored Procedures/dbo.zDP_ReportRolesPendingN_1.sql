SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_ReportRolesPendingN_1] (@BS int, @Identity_Column int, @BP_GUID char(41), @DEX_ROW_ID int, @Identity_Column_RS int, @BP_GUID_RS char(41), @Identity_Column_RE int, @BP_GUID_RE char(41)) AS  set nocount on IF @Identity_Column_RS IS NULL BEGIN SELECT TOP 25  Identity_Column, BP_GUID, BP_Role, MKTOPROC, Business_Desk_Report_Nam, PRODID, Report_Option, RPTGRIND, UserIDTime, DEX_ROW_ID FROM .ReportRolesPending WHERE ( Identity_Column = @Identity_Column AND BP_GUID = @BP_GUID AND DEX_ROW_ID > @DEX_ROW_ID OR Identity_Column = @Identity_Column AND BP_GUID > @BP_GUID OR Identity_Column > @Identity_Column ) ORDER BY Identity_Column ASC, BP_GUID ASC, DEX_ROW_ID ASC END ELSE IF @Identity_Column_RS = @Identity_Column_RE BEGIN SELECT TOP 25  Identity_Column, BP_GUID, BP_Role, MKTOPROC, Business_Desk_Report_Nam, PRODID, Report_Option, RPTGRIND, UserIDTime, DEX_ROW_ID FROM .ReportRolesPending WHERE Identity_Column = @Identity_Column_RS AND BP_GUID BETWEEN @BP_GUID_RS AND @BP_GUID_RE AND ( Identity_Column = @Identity_Column AND BP_GUID = @BP_GUID AND DEX_ROW_ID > @DEX_ROW_ID OR Identity_Column = @Identity_Column AND BP_GUID > @BP_GUID OR Identity_Column > @Identity_Column ) ORDER BY Identity_Column ASC, BP_GUID ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  Identity_Column, BP_GUID, BP_Role, MKTOPROC, Business_Desk_Report_Nam, PRODID, Report_Option, RPTGRIND, UserIDTime, DEX_ROW_ID FROM .ReportRolesPending WHERE Identity_Column BETWEEN @Identity_Column_RS AND @Identity_Column_RE AND BP_GUID BETWEEN @BP_GUID_RS AND @BP_GUID_RE AND ( Identity_Column = @Identity_Column AND BP_GUID = @BP_GUID AND DEX_ROW_ID > @DEX_ROW_ID OR Identity_Column = @Identity_Column AND BP_GUID > @BP_GUID OR Identity_Column > @Identity_Column ) ORDER BY Identity_Column ASC, BP_GUID ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_ReportRolesPendingN_1] TO [DYNGRP]
GO
