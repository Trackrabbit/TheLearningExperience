SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SEE30303N_3] (@BS int, @DOCDATE datetime, @ITEMNMBR char(31), @TRXQTY numeric(19,5), @EXTDCOST numeric(19,5), @SEQNUMBR int, @DOCDATE_RS datetime, @ITEMNMBR_RS char(31), @TRXQTY_RS numeric(19,5), @EXTDCOST_RS numeric(19,5), @SEQNUMBR_RS int, @DOCDATE_RE datetime, @ITEMNMBR_RE char(31), @TRXQTY_RE numeric(19,5), @EXTDCOST_RE numeric(19,5), @SEQNUMBR_RE int) AS  set nocount on IF @DOCDATE_RS IS NULL BEGIN SELECT TOP 25  ITEMNMBR, SEQNUMBR, DOCDATE, GLPOSTDT, DOCNUMBR, DOCTYPE, LOCNCODE, RCPTNMBR, RCTSEQNM, PCHSRCTY, QTYTYPE, UOFM, TRXQTYInBase, TRXQTY, VARIANCEQTY, UNITCOST, EXTDCOST, DECPLQTY, DECPLCUR, IsOverrideReceipt, IsOverrideRelieved, OverrideRelievedDate, RCPTNMBR1, HSTMODUL, ORTRXSRC, LNSEQNBR, LNITMSEQ, CMPNTSEQ, SRCRFRNCNMBR, VENDORID, PONUMBER, TRXREFERENCE, VCTNMTHD, IVIVINDX, IVIVOFIX, JRNENTRY, TRXSORCE, DEBITAMT, CRDTAMNT, DATE1, TIME1, DEX_ROW_ID FROM .SEE30303 WHERE ( DOCDATE = @DOCDATE AND ITEMNMBR = @ITEMNMBR AND TRXQTY = @TRXQTY AND EXTDCOST = @EXTDCOST AND SEQNUMBR > @SEQNUMBR OR DOCDATE = @DOCDATE AND ITEMNMBR = @ITEMNMBR AND TRXQTY = @TRXQTY AND EXTDCOST > @EXTDCOST OR DOCDATE = @DOCDATE AND ITEMNMBR = @ITEMNMBR AND TRXQTY > @TRXQTY OR DOCDATE = @DOCDATE AND ITEMNMBR > @ITEMNMBR OR DOCDATE > @DOCDATE ) ORDER BY DOCDATE ASC, ITEMNMBR ASC, TRXQTY ASC, EXTDCOST ASC, SEQNUMBR ASC END ELSE IF @DOCDATE_RS = @DOCDATE_RE BEGIN SELECT TOP 25  ITEMNMBR, SEQNUMBR, DOCDATE, GLPOSTDT, DOCNUMBR, DOCTYPE, LOCNCODE, RCPTNMBR, RCTSEQNM, PCHSRCTY, QTYTYPE, UOFM, TRXQTYInBase, TRXQTY, VARIANCEQTY, UNITCOST, EXTDCOST, DECPLQTY, DECPLCUR, IsOverrideReceipt, IsOverrideRelieved, OverrideRelievedDate, RCPTNMBR1, HSTMODUL, ORTRXSRC, LNSEQNBR, LNITMSEQ, CMPNTSEQ, SRCRFRNCNMBR, VENDORID, PONUMBER, TRXREFERENCE, VCTNMTHD, IVIVINDX, IVIVOFIX, JRNENTRY, TRXSORCE, DEBITAMT, CRDTAMNT, DATE1, TIME1, DEX_ROW_ID FROM .SEE30303 WHERE DOCDATE = @DOCDATE_RS AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND TRXQTY BETWEEN @TRXQTY_RS AND @TRXQTY_RE AND EXTDCOST BETWEEN @EXTDCOST_RS AND @EXTDCOST_RE AND SEQNUMBR BETWEEN @SEQNUMBR_RS AND @SEQNUMBR_RE AND ( DOCDATE = @DOCDATE AND ITEMNMBR = @ITEMNMBR AND TRXQTY = @TRXQTY AND EXTDCOST = @EXTDCOST AND SEQNUMBR > @SEQNUMBR OR DOCDATE = @DOCDATE AND ITEMNMBR = @ITEMNMBR AND TRXQTY = @TRXQTY AND EXTDCOST > @EXTDCOST OR DOCDATE = @DOCDATE AND ITEMNMBR = @ITEMNMBR AND TRXQTY > @TRXQTY OR DOCDATE = @DOCDATE AND ITEMNMBR > @ITEMNMBR OR DOCDATE > @DOCDATE ) ORDER BY DOCDATE ASC, ITEMNMBR ASC, TRXQTY ASC, EXTDCOST ASC, SEQNUMBR ASC END ELSE BEGIN SELECT TOP 25  ITEMNMBR, SEQNUMBR, DOCDATE, GLPOSTDT, DOCNUMBR, DOCTYPE, LOCNCODE, RCPTNMBR, RCTSEQNM, PCHSRCTY, QTYTYPE, UOFM, TRXQTYInBase, TRXQTY, VARIANCEQTY, UNITCOST, EXTDCOST, DECPLQTY, DECPLCUR, IsOverrideReceipt, IsOverrideRelieved, OverrideRelievedDate, RCPTNMBR1, HSTMODUL, ORTRXSRC, LNSEQNBR, LNITMSEQ, CMPNTSEQ, SRCRFRNCNMBR, VENDORID, PONUMBER, TRXREFERENCE, VCTNMTHD, IVIVINDX, IVIVOFIX, JRNENTRY, TRXSORCE, DEBITAMT, CRDTAMNT, DATE1, TIME1, DEX_ROW_ID FROM .SEE30303 WHERE DOCDATE BETWEEN @DOCDATE_RS AND @DOCDATE_RE AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND TRXQTY BETWEEN @TRXQTY_RS AND @TRXQTY_RE AND EXTDCOST BETWEEN @EXTDCOST_RS AND @EXTDCOST_RE AND SEQNUMBR BETWEEN @SEQNUMBR_RS AND @SEQNUMBR_RE AND ( DOCDATE = @DOCDATE AND ITEMNMBR = @ITEMNMBR AND TRXQTY = @TRXQTY AND EXTDCOST = @EXTDCOST AND SEQNUMBR > @SEQNUMBR OR DOCDATE = @DOCDATE AND ITEMNMBR = @ITEMNMBR AND TRXQTY = @TRXQTY AND EXTDCOST > @EXTDCOST OR DOCDATE = @DOCDATE AND ITEMNMBR = @ITEMNMBR AND TRXQTY > @TRXQTY OR DOCDATE = @DOCDATE AND ITEMNMBR > @ITEMNMBR OR DOCDATE > @DOCDATE ) ORDER BY DOCDATE ASC, ITEMNMBR ASC, TRXQTY ASC, EXTDCOST ASC, SEQNUMBR ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SEE30303N_3] TO [DYNGRP]
GO
