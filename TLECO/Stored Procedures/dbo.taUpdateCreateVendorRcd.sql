SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[taUpdateCreateVendorRcd]  @I_vVENDORID char(15),    @I_vVENDNAME char(64) = null,   @I_vVENDSHNM char(15) = null,   @I_vVNDCHKNM char(64) = null,   @I_vHOLD tinyint = null,   @I_vVENDSTTS smallint = null,   @I_vVNDCLSID char(10) = null,   @I_vVADDCDPR char(15) = null,   @I_vVNDCNTCT char(60) = null,   @I_vADDRESS1 char(60) = null,   @I_vADDRESS2 char(60) = null,   @I_vADDRESS3 char(60) = null,   @I_vCITY char(35) = null,   @I_vSTATE char(29) = null,   @I_vZIPCODE char(10) = null,   @I_vCCode char(6) = null,   @I_vCOUNTRY char(60) = null,   @I_vPHNUMBR1 char(21) = null,   @I_vPHNUMBR2 char(21) = null,   @I_vPHNUMBR3 char(21) = null,   @I_vFAXNUMBR char(21) = null,   @I_vTAXSCHID char(15) = null,   @I_vSHIPMTHD char(15) = null,   @I_vUPSZONE char(3) = null,   @I_vVADCDPAD char(15) = null,   @I_vVADCDTRO char(15) = null,   @I_vVADCDSFR char(15) = null,   @I_vACNMVNDR char(20) = null,   @I_vCOMMENT1 char(30) = null,   @I_vCOMMENT2 char(30) = null,   @I_vNOTETEXT varchar(8000) = null,  @I_vCURNCYID char(15) = null,   @I_vRATETPID char(15) = null,   @I_vPYMTRMID char(20) = null,   @I_vDISGRPER smallint = null,   @I_vDUEGRPER smallint = null,   @I_vPYMNTPRI char(3) = null,   @I_vMINORDER numeric(19,5) = null,  @I_vTRDDISCT numeric(19,2) = null,  @I_vTXIDNMBR char(11) = null,   @I_vTXRGNNUM char(25) = null,   @I_vCHEKBKID char(15) = null,   @I_vUSERDEF1 char(20) = null,   @I_vUSERDEF2 char(20) = null,   @I_vTEN99TYPE smallint = null,   @I_vTEN99BOXNUMBER smallint = null,   @I_vFREEONBOARD smallint = null,  @I_vUSERLANG smallint = null,            @I_vMINPYTYP smallint = null,   @I_vMINPYDLR numeric(19,5) = null,  @I_vMINPYPCT numeric(19,2) = null,  @I_vMXIAFVND smallint = null,   @I_vMAXINDLR numeric(19,5) = null,  @I_vCREDTLMT smallint = null,   @I_vCRLMTDLR numeric(19,5) = null,  @I_vWRITEOFF smallint = null,   @I_vMXWOFAMT numeric(19,5) = null,  @I_vRevalue_Vendor tinyint = null,  @I_vPost_Results_To smallint = null,  @I_vKPCALHST tinyint = null,   @I_vKPERHIST tinyint = null,   @I_vKPTRXHST tinyint = null,   @I_vKGLDSTHS tinyint = null,   @I_vPTCSHACF smallint = null,   @I_vPMCSHACTNUMST varchar(75) = null,  @I_vPMAPACTNUMST varchar(75) = null,  @I_vPMDAVACTNUMST varchar(75) = null,  @I_vPMDTKACTNUMST varchar(75) = null,  @I_vPMFINACTNUMST varchar(75) = null,  @I_vPMPRCHACTNUMST varchar(75) = null,  @I_vPMTDSCACTNUMST varchar(75) = null,  @I_vPMMSCHACTNUMST varchar(75) = null,  @I_vPMFRTACTNUMST varchar(75) = null,  @I_vPMTAXACTNUMST varchar(75) = null,  @I_vPMWRTACTNUMST varchar(75) = null,  @I_vACPURACTNUMST varchar(75) = null,  @I_vPURPVACTNUMST varchar(75) = null,  @I_vUseVendorClass tinyint = 0,   @I_vCreateAddress tinyint = 1,   @I_vUpdateIfExists tinyint = 1,   @I_vRequesterTrx smallint = 0,   @I_vUSRDEFND1 char(50) = null,       @I_vUSRDEFND2 char(50) = null,       @I_vUSRDEFND3 char(50) = null,       @I_vUSRDEFND4 varchar(8000) = null,  @I_vUSRDEFND5 varchar(8000) = null,  @O_iErrorState int output, @oErrString varchar(255) output  with encryption as  set transaction isolation level read uncommitted set nocount on  declare @iStatus int,  @iAddShippingErrState int,  @iAddShippingErrString varchar(255),  @iAddAddressErrState int,  @iAddAddressErrString varchar(255),  @iCustomState int,  @iCustomErrString varchar(255),  @O_oErrorState int,  @iError int,  @exists tinyint,  @PMCSHIDX int,  @PMAPINDX int,  @PMDAVIDX int,  @PMDTKIDX int,  @PMFINIDX int,  @PMPRCHIX int,  @PMTDSCIX int,  @PMMSCHIX int,  @PMFRTIDX int,  @PMTAXIDX int,  @PMWRTIDX int,  @ACPURIDX int,  @PURPVIDX int,  @sCompanyID smallint,  @nNextNoteIndex numeric(19,5),  @iGetNextNoteIdxErrState int,  @ActualDate datetime,  @ActualTime datetime,  @UseRolldown tinyint,  @ACTIVE tinyint,  @ACCTTYPE smallint,  @MINPYTYP smallint,  @MXIAFVND smallint,  @CREDTLMT smallint,  @WRITEOFF smallint,  @FUNLCURR char(15),  @DECPLCUR smallint,  @VADDCDPR char(15),  @WORKFLOWENABLED smallint,     @Workflow_Approval_Status smallint,    @Workflow_Priority smallint,      @Workflow_Status smallint  select @O_iErrorState = 0,  @iStatus = 0,  @iAddShippingErrState = 0,  @iAddShippingErrString = '',  @iAddAddressErrState = 0,  @iAddAddressErrString = '',  @iCustomState = 0,  @iCustomErrString = '',  @O_oErrorState = 0,  @iError = 0,  @exists = 0,  @PMCSHIDX = 0,  @PMAPINDX = 0,  @PMDAVIDX = 0,  @PMDTKIDX = 0,  @PMFINIDX = 0,  @PMPRCHIX = 0,  @PMTDSCIX = 0,  @PMMSCHIX = 0,  @PMFRTIDX = 0,  @PMTAXIDX = 0,  @PMWRTIDX = 0,  @ACPURIDX = 0,  @PURPVIDX = 0,  @sCompanyID = 0,  @nNextNoteIndex = 0,  @iGetNextNoteIdxErrState = 0,  @ActualDate = '',  @ActualTime = '',  @UseRolldown = 0,  @ACTIVE = 0,  @ACCTTYPE = 0,  @MINPYTYP = 0,  @MXIAFVND = 0,  @CREDTLMT = 0,  @WRITEOFF = 0,  @FUNLCURR = '',  @DECPLCUR = 0,  @VADDCDPR = '',  @WORKFLOWENABLED = 0,  @Workflow_Approval_Status = 0,   @Workflow_Priority = 0,  @Workflow_Status = 0  if (@oErrString is null) begin  select @oErrString = '' end  exec @iStatus = taUpdateCreateVendorRcdPre  @I_vVENDORID output,  @I_vVENDNAME output,  @I_vVENDSHNM output,  @I_vVNDCHKNM output,  @I_vHOLD output,  @I_vVENDSTTS output,  @I_vVNDCLSID output,  @I_vVADDCDPR output,  @I_vVNDCNTCT output,  @I_vADDRESS1 output,  @I_vADDRESS2 output,  @I_vADDRESS3 output,  @I_vCITY output,  @I_vSTATE output,  @I_vZIPCODE output,  @I_vCCode output,  @I_vCOUNTRY output,  @I_vPHNUMBR1 output,  @I_vPHNUMBR2 output,  @I_vPHNUMBR3 output,  @I_vFAXNUMBR output,  @I_vTAXSCHID output,  @I_vSHIPMTHD output,  @I_vUPSZONE output,  @I_vVADCDPAD output,  @I_vVADCDTRO output,  @I_vVADCDSFR output,  @I_vACNMVNDR output,  @I_vCOMMENT1 output,  @I_vCOMMENT2 output,  @I_vNOTETEXT output,  @I_vCURNCYID output,  @I_vRATETPID output,  @I_vPYMTRMID output,  @I_vDISGRPER output,  @I_vDUEGRPER output,  @I_vPYMNTPRI output,  @I_vMINORDER output,  @I_vTRDDISCT output,  @I_vTXIDNMBR output,  @I_vTXRGNNUM output,  @I_vCHEKBKID output,  @I_vUSERDEF1 output,  @I_vUSERDEF2 output,  @I_vTEN99TYPE output,  @I_vTEN99BOXNUMBER output,  @I_vFREEONBOARD output,  @I_vUSERLANG output,  @I_vMINPYTYP output,  @I_vMINPYDLR output,  @I_vMINPYPCT output,  @I_vMXIAFVND output,  @I_vMAXINDLR output,  @I_vCREDTLMT output,  @I_vCRLMTDLR output,  @I_vWRITEOFF output,  @I_vMXWOFAMT output,  @I_vRevalue_Vendor output,  @I_vPost_Results_To output,  @I_vKPCALHST output,  @I_vKPERHIST output,  @I_vKPTRXHST output,  @I_vKGLDSTHS output,  @I_vPTCSHACF output,  @I_vPMCSHACTNUMST output,  @I_vPMAPACTNUMST output,  @I_vPMDAVACTNUMST output,  @I_vPMDTKACTNUMST output,  @I_vPMFINACTNUMST output,  @I_vPMPRCHACTNUMST output,  @I_vPMTDSCACTNUMST output,  @I_vPMMSCHACTNUMST output,  @I_vPMFRTACTNUMST output,  @I_vPMTAXACTNUMST output,  @I_vPMWRTACTNUMST output,  @I_vACPURACTNUMST output,  @I_vPURPVACTNUMST output,  @I_vUseVendorClass output,  @I_vCreateAddress output,  @I_vUpdateIfExists output,  @I_vRequesterTrx output,  @I_vUSRDEFND1 output,  @I_vUSRDEFND2 output,  @I_vUSRDEFND3 output,  @I_vUSRDEFND4 output,  @I_vUSRDEFND5 output,  @O_iErrorState = @iCustomState output,  @oErrString = @iCustomErrString output select @iError = @@error if ((@iStatus <> 0) or (@iCustomState <> 0) or (@iError <> 0)) begin  select @oErrString = rtrim(@oErrString) + ' ' + @iCustomErrString  select @O_iErrorState = 73    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if ( @I_vVENDORID is null or  @I_vUseVendorClass is null or  @I_vCreateAddress is null or  @I_vUpdateIfExists is null or  @I_vRequesterTrx is null  ) begin  select @O_iErrorState = 931     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if (  (@I_vMINORDER < 0) or  (@I_vTRDDISCT < 0) or  (@I_vMINPYDLR < 0) or  (@I_vMINPYPCT < 0) or  (@I_vMAXINDLR < 0) or  (@I_vCRLMTDLR < 0) or  (@I_vMXWOFAMT < 0)  ) begin  select @O_iErrorState = 508    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  select  @I_vVENDORID = UPPER(@I_vVENDORID),  @I_vVNDCLSID = UPPER(@I_vVNDCLSID),  @I_vVADDCDPR = UPPER(@I_vVADDCDPR),  @I_vCCode = UPPER(@I_vCCode),  @I_vTAXSCHID = UPPER(@I_vTAXSCHID),  @I_vSHIPMTHD = UPPER(@I_vSHIPMTHD),  @I_vVADCDPAD = UPPER(@I_vVADCDPAD),  @I_vVADCDTRO = UPPER(@I_vVADCDTRO),  @I_vVADCDSFR = UPPER(@I_vVADCDSFR),  @I_vCURNCYID = UPPER(@I_vCURNCYID),  @I_vRATETPID = UPPER(@I_vRATETPID),  @I_vCHEKBKID = UPPER(@I_vCHEKBKID)  if (exists(select top 1 VENDORID from PM00200 (nolock) where VENDORID = @I_vVENDORID)) begin  select @exists = 1 end  if (@I_vVENDORID = '') begin  select @O_iErrorState = 933     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if (@exists = 0) begin  if ((@I_vVENDNAME = '') or (@I_vVENDNAME is null))  begin  select @O_iErrorState = 7851     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end else begin  if (@I_vVENDNAME = '')  begin  select @O_iErrorState = 7852     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  select @sCompanyID = CMPANYID from DYNAMICS..SY01500 (nolock) where INTERID = db_name()  select @ActualDate = convert(varchar(12),getdate()) select @ActualTime = ltrim(substring(convert(varchar(25),getdate()),12,12))  if (@exists = 1) begin  select @nNextNoteIndex = NOTEINDX from PM00200 (nolock) where VENDORID = @I_vVENDORID end  if (@exists = 1) begin  if (@I_vUpdateIfExists = 0)  begin  select @O_iErrorState = 7807     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  else  begin  if (@I_vUpdateIfExists = 2)  begin  return (@O_iErrorState)  end  end end else begin  if (@I_vUpdateIfExists = 2)  begin  select @I_vUpdateIfExists = 0  end end  if (@exists = 1) begin  if (@I_vUseVendorClass = 1)  begin  if (@I_vVNDCLSID is null)  begin  select @UseRolldown = 0  end  else  begin  select @UseRolldown = 1  end  end  else  begin  select @UseRolldown = 0  end   select @MINPYTYP = MINPYTYP,  @MXIAFVND = MXIAFVND,  @CREDTLMT = CREDTLMT,  @WRITEOFF = WRITEOFF,  @VADDCDPR = VADDCDPR  from PM00200 where VENDORID = @I_vVENDORID   if (@MINPYTYP <> @I_vMINPYTYP)  begin  if (@I_vMINPYDLR is null)  begin  select @I_vMINPYDLR = 0  end   if (@I_vMINPYPCT is null)  begin  select @I_vMINPYPCT = 0  end  end   if (@MXIAFVND <> @I_vMXIAFVND)  begin  if (@I_vMAXINDLR is null)  begin  select @I_vMAXINDLR = 0  end  end   if (@CREDTLMT <> @I_vCREDTLMT)  begin  if (@I_vCRLMTDLR is null)  begin  select @I_vCRLMTDLR = 0  end  end   if (@WRITEOFF <> @I_vWRITEOFF)  begin  if (@I_vMXWOFAMT is null)  begin  select @I_vMXWOFAMT = 0  end  end   if (@VADDCDPR <> @I_vVADDCDPR)  begin  if (exists(select 1 from PM00300 (nolock) where VENDORID = @I_vVENDORID and ADRSCODE = @I_vVADDCDPR))  begin  if ((@I_vVNDCNTCT is null) and  (@I_vADDRESS1 is null) and  (@I_vADDRESS2 is null) and  (@I_vADDRESS3 is null) and  (@I_vCITY is null) and  (@I_vSTATE is null) and  (@I_vZIPCODE is null) and  (@I_vCOUNTRY is null) and  (@I_vPHNUMBR1 is null) and  (@I_vPHNUMBR2 is null) and  (@I_vPHNUMBR3 is null) and  (@I_vFAXNUMBR is null) and  (@I_vUPSZONE is null) and  (@I_vSHIPMTHD is null) and  (@I_vTAXSCHID is null))  begin  select @I_vVNDCNTCT = VNDCNTCT,  @I_vADDRESS1 = ADDRESS1,  @I_vADDRESS2 = ADDRESS2,  @I_vADDRESS3 = ADDRESS3,  @I_vCITY = CITY,  @I_vSTATE = STATE,  @I_vZIPCODE = ZIPCODE,  @I_vCOUNTRY = COUNTRY,  @I_vPHNUMBR1 = PHNUMBR1,  @I_vPHNUMBR2 = PHNUMBR2,  @I_vPHNUMBR3 = PHONE3,  @I_vFAXNUMBR = FAXNUMBR,  @I_vUPSZONE = UPSZONE,  @I_vSHIPMTHD = SHIPMTHD,  @I_vTAXSCHID = TAXSCHID  from PM00300 (nolock) where VENDORID = @I_vVENDORID and ADRSCODE = @I_vVADDCDPR  end  else  begin  select @I_vVNDCNTCT =  case  when @I_vVNDCNTCT is null  then ''  else @I_vVNDCNTCT  end,  @I_vADDRESS1 =  case  when @I_vADDRESS1 is null  then ''  else @I_vADDRESS1  end,  @I_vADDRESS2 =  case  when @I_vADDRESS2 is null  then ''  else @I_vADDRESS2  end,  @I_vADDRESS3 =  case  when @I_vADDRESS3 is null  then ''  else @I_vADDRESS3  end,  @I_vCITY =  case  when @I_vCITY is null  then ''  else @I_vCITY  end,  @I_vSTATE =  case  when @I_vSTATE is null  then ''  else @I_vSTATE  end,  @I_vZIPCODE =  case  when @I_vZIPCODE is null  then ''  else @I_vZIPCODE  end,  @I_vCOUNTRY =  case  when @I_vCOUNTRY is null  then ''  else @I_vCOUNTRY  end,  @I_vPHNUMBR1 =  case  when @I_vPHNUMBR1 is null  then ''  else @I_vPHNUMBR1  end,  @I_vPHNUMBR2 =  case  when @I_vPHNUMBR2 is null  then ''  else @I_vPHNUMBR2  end,  @I_vPHNUMBR3 =  case  when @I_vPHNUMBR3 is null  then ''  else @I_vPHNUMBR3  end,  @I_vFAXNUMBR =  case  when @I_vFAXNUMBR is null  then ''  else @I_vFAXNUMBR  end,  @I_vUPSZONE =  case  when @I_vUPSZONE is null  then ''  else @I_vUPSZONE  end,  @I_vSHIPMTHD =  case  when @I_vSHIPMTHD is null  then ''  else @I_vSHIPMTHD  end,  @I_vTAXSCHID =  case  when @I_vTAXSCHID is null  then ''  else @I_vTAXSCHID  end  end  end  else  begin  select @I_vVNDCNTCT =  case  when @I_vVNDCNTCT is null  then ''  else @I_vVNDCNTCT  end,  @I_vADDRESS1 =  case  when @I_vADDRESS1 is null  then ''  else @I_vADDRESS1  end,  @I_vADDRESS2 =  case  when @I_vADDRESS2 is null  then ''  else @I_vADDRESS2  end,  @I_vADDRESS3 =  case  when @I_vADDRESS3 is null  then ''  else @I_vADDRESS3  end,  @I_vCITY =  case  when @I_vCITY is null  then ''  else @I_vCITY  end,  @I_vSTATE =  case  when @I_vSTATE is null  then ''  else @I_vSTATE  end,  @I_vZIPCODE =  case  when @I_vZIPCODE is null  then ''  else @I_vZIPCODE  end,  @I_vCOUNTRY =  case  when @I_vCOUNTRY is null  then ''  else @I_vCOUNTRY  end,  @I_vPHNUMBR1 =  case  when @I_vPHNUMBR1 is null  then ''  else @I_vPHNUMBR1  end,  @I_vPHNUMBR2 =  case  when @I_vPHNUMBR2 is null  then ''  else @I_vPHNUMBR2  end,  @I_vPHNUMBR3 =  case  when @I_vPHNUMBR3 is null  then ''  else @I_vPHNUMBR3  end,  @I_vFAXNUMBR =  case  when @I_vFAXNUMBR is null  then ''  else @I_vFAXNUMBR  end,  @I_vUPSZONE =  case  when @I_vUPSZONE is null  then ''  else @I_vUPSZONE  end,  @I_vSHIPMTHD =  case  when @I_vSHIPMTHD is null  then ''  else @I_vSHIPMTHD  end,  @I_vTAXSCHID =  case  when @I_vTAXSCHID is null  then ''  else @I_vTAXSCHID  end  end  end end  if (@exists = 0) begin  if (@I_vMINPYTYP = 0)  begin  if (@I_vMINPYPCT is null)  begin  select @I_vMINPYPCT = 0  end   if (@I_vMINPYDLR is null)  begin  select @I_vMINPYDLR = 0  end  end   if ((@I_vMINPYTYP in(0,1)) and (@I_vMINPYDLR is null))  begin  select @I_vMINPYDLR = 0  end   if ((@I_vMINPYTYP in(0,2)) and (@I_vMINPYPCT is null))  begin  select @I_vMINPYPCT = 0  end   if ((@I_vMXIAFVND = 0) and (@I_vMAXINDLR is null))  begin  select @I_vMAXINDLR = 0  end   if ((@I_vCREDTLMT in(0,1)) and (@I_vCRLMTDLR is null))  begin  select @I_vCRLMTDLR = 0  end   if ((@I_vWRITEOFF in(0,1)) and (@I_vMXWOFAMT is null))  begin  select @I_vMXWOFAMT = 0  end end  if (@exists = 0) begin     if (@I_vUseVendorClass = 0)  begin  select  @I_vVENDSHNM =  case  when @I_vVENDSHNM is null  then @I_vVENDNAME  else @I_vVENDSHNM  end,  @I_vVNDCHKNM =  case  when @I_vVNDCHKNM is null  then @I_vVENDNAME  else @I_vVNDCHKNM  end,  @I_vHOLD =  case  when @I_vHOLD is null  then 0  else @I_vHOLD  end,  @I_vVENDSTTS =  case  when @I_vVENDSTTS is null  then 1  else @I_vVENDSTTS  end,  @I_vVNDCLSID =  case  when @I_vVNDCLSID is null  then ''  else @I_vVNDCLSID  end,  @I_vVADDCDPR =  case  when @I_vVADDCDPR is null  then ''  else @I_vVADDCDPR  end,  @I_vVNDCNTCT =  case  when @I_vVNDCNTCT is null  then ''  else @I_vVNDCNTCT  end,  @I_vADDRESS1 =  case  when @I_vADDRESS1 is null  then ''  else @I_vADDRESS1  end,  @I_vADDRESS2 =  case  when @I_vADDRESS2 is null  then ''  else @I_vADDRESS2  end,  @I_vADDRESS3 =  case  when @I_vADDRESS3 is null  then ''  else @I_vADDRESS3  end,  @I_vCITY =  case  when @I_vCITY is null  then ''  else @I_vCITY  end,  @I_vSTATE =  case  when @I_vSTATE is null  then ''  else @I_vSTATE  end,  @I_vZIPCODE =  case  when @I_vZIPCODE is null  then ''  else @I_vZIPCODE  end,  @I_vCCode =  case  when @I_vCCode is null  then ''  else @I_vCCode  end,  @I_vCOUNTRY =  case  when @I_vCOUNTRY is null  then ''  else @I_vCOUNTRY  end,  @I_vPHNUMBR1 =  case  when @I_vPHNUMBR1 is null  then ''  else @I_vPHNUMBR1  end,  @I_vPHNUMBR2 =  case  when @I_vPHNUMBR2 is null  then ''  else @I_vPHNUMBR2  end,  @I_vPHNUMBR3 =  case  when @I_vPHNUMBR3 is null  then ''  else @I_vPHNUMBR3  end,  @I_vFAXNUMBR =  case  when @I_vFAXNUMBR is null  then ''  else @I_vFAXNUMBR  end,  @I_vTAXSCHID =  case  when @I_vTAXSCHID is null  then ''  else @I_vTAXSCHID  end,  @I_vSHIPMTHD =  case  when @I_vSHIPMTHD is null  then ''  else @I_vSHIPMTHD  end,  @I_vUPSZONE =  case  when @I_vUPSZONE is null  then ''  else @I_vUPSZONE  end,  @I_vVADCDPAD =  case  when @I_vVADCDPAD is null  then @I_vVADDCDPR  else @I_vVADCDPAD  end,  @I_vVADCDTRO =  case  when @I_vVADCDTRO is null  then @I_vVADDCDPR  else @I_vVADCDTRO  end,  @I_vVADCDSFR =  case  when @I_vVADCDSFR is null  then @I_vVADDCDPR  else @I_vVADCDSFR  end,  @I_vACNMVNDR =  case  when @I_vACNMVNDR is null  then ''  else @I_vACNMVNDR  end,  @I_vCOMMENT1 =  case  when @I_vCOMMENT1 is null  then ''  else @I_vCOMMENT1  end,  @I_vCOMMENT2 =  case  when @I_vCOMMENT2 is null  then ''  else @I_vCOMMENT2  end,  @I_vNOTETEXT =  case  when @I_vNOTETEXT is null  then ''  else @I_vNOTETEXT  end,  @I_vCURNCYID =  case  when @I_vCURNCYID is null  then ''  else @I_vCURNCYID  end,  @I_vRATETPID =  case  when @I_vRATETPID is null  then ''  else @I_vRATETPID  end,  @I_vPYMTRMID =  case  when @I_vPYMTRMID is null  then ''  else @I_vPYMTRMID  end,  @I_vDISGRPER =  case  when @I_vDISGRPER is null  then 0  else @I_vDISGRPER  end,  @I_vDUEGRPER =  case  when @I_vDUEGRPER is null  then 0  else @I_vDUEGRPER  end,  @I_vPYMNTPRI =  case  when @I_vPYMNTPRI is null  then ''  else @I_vPYMNTPRI  end,  @I_vMINORDER =  case  when @I_vMINORDER is null  then 0  else @I_vMINORDER  end,  @I_vTRDDISCT =  case  when @I_vTRDDISCT is null  then 0.00  else @I_vTRDDISCT  end,  @I_vTXIDNMBR =  case  when @I_vTXIDNMBR is null  then ''  else @I_vTXIDNMBR  end,  @I_vTXRGNNUM =  case  when @I_vTXRGNNUM is null  then ''  else @I_vTXRGNNUM  end,  @I_vCHEKBKID =  case  when @I_vCHEKBKID is null  then ''  else @I_vCHEKBKID  end,  @I_vUSERDEF1 =  case  when @I_vUSERDEF1 is null  then ''  else @I_vUSERDEF1  end,  @I_vUSERDEF2 =  case  when @I_vUSERDEF2 is null  then ''  else @I_vUSERDEF2  end,  @I_vTEN99TYPE =  case  when @I_vTEN99TYPE is null  then 1  else @I_vTEN99TYPE  end,  @I_vTEN99BOXNUMBER =  case  when @I_vTEN99BOXNUMBER is null  then   case when @I_vTEN99TYPE in (2, 3)   then 1   when @I_vTEN99TYPE = 4   then 7  else 0   end  else @I_vTEN99BOXNUMBER  end,  @I_vFREEONBOARD =  case  when @I_vFREEONBOARD is null  then 1  else @I_vFREEONBOARD  end,  @I_vUSERLANG =  case  when @I_vUSERLANG is null  then 0  else @I_vUSERLANG  end,  @I_vMINPYTYP =  case  when @I_vMINPYTYP is null  then 0  else @I_vMINPYTYP  end,  @I_vMINPYDLR =  case  when @I_vMINPYDLR is null  then 0  else @I_vMINPYDLR  end,  @I_vMINPYPCT =  case  when @I_vMINPYPCT is null  then 0.00  else @I_vMINPYPCT  end,  @I_vMXIAFVND =  case  when @I_vMXIAFVND is null  then 0  else @I_vMXIAFVND  end,  @I_vMAXINDLR =  case  when @I_vMAXINDLR is null  then 0  else @I_vMAXINDLR  end,  @I_vCREDTLMT =  case  when @I_vCREDTLMT is null  then 1  else @I_vCREDTLMT  end,  @I_vCRLMTDLR =  case  when @I_vCRLMTDLR is null  then 0  else @I_vCRLMTDLR  end,  @I_vWRITEOFF =  case  when @I_vWRITEOFF is null  then 1  else @I_vWRITEOFF  end,  @I_vMXWOFAMT =  case  when @I_vMXWOFAMT is null  then 0  else @I_vMXWOFAMT  end,  @I_vRevalue_Vendor =  case  when @I_vRevalue_Vendor is null  then 1  else @I_vRevalue_Vendor  end,  @I_vPost_Results_To =  case  when @I_vPost_Results_To is null  then 0  else @I_vPost_Results_To  end,  @I_vKPCALHST =  case  when @I_vKPCALHST is null  then 1  else @I_vKPCALHST  end,  @I_vKPERHIST =  case  when @I_vKPERHIST is null  then 1  else @I_vKPERHIST  end,  @I_vKPTRXHST =  case  when @I_vKPTRXHST is null  then 1  else @I_vKPTRXHST  end,  @I_vKGLDSTHS =  case  when @I_vKGLDSTHS is null  then 1  else @I_vKGLDSTHS  end,  @I_vPTCSHACF =  case  when @I_vPTCSHACF is null  then 0  else @I_vPTCSHACF  end,  @I_vPMCSHACTNUMST =  case  when @I_vPMCSHACTNUMST is null  then ''  else @I_vPMCSHACTNUMST  end,  @I_vPMAPACTNUMST =  case  when @I_vPMAPACTNUMST is null  then ''  else @I_vPMAPACTNUMST  end,  @I_vPMDAVACTNUMST =  case  when @I_vPMDAVACTNUMST is null  then ''  else @I_vPMDAVACTNUMST  end,  @I_vPMDTKACTNUMST =  case  when @I_vPMDTKACTNUMST is null  then ''  else @I_vPMDTKACTNUMST  end,  @I_vPMFINACTNUMST =  case  when @I_vPMFINACTNUMST is null  then ''  else @I_vPMFINACTNUMST  end,  @I_vPMPRCHACTNUMST =  case  when @I_vPMPRCHACTNUMST is null  then ''  else @I_vPMPRCHACTNUMST  end,  @I_vPMTDSCACTNUMST =  case  when @I_vPMTDSCACTNUMST is null  then ''  else @I_vPMTDSCACTNUMST  end,  @I_vPMMSCHACTNUMST =  case  when @I_vPMMSCHACTNUMST is null  then ''  else @I_vPMMSCHACTNUMST  end,  @I_vPMFRTACTNUMST =  case  when @I_vPMFRTACTNUMST is null  then ''  else @I_vPMFRTACTNUMST  end,  @I_vPMTAXACTNUMST =  case  when @I_vPMTAXACTNUMST is null  then ''  else @I_vPMTAXACTNUMST  end,  @I_vPMWRTACTNUMST =  case  when @I_vPMWRTACTNUMST is null  then ''  else @I_vPMWRTACTNUMST  end,  @I_vACPURACTNUMST =  case  when @I_vACPURACTNUMST is null  then ''  else @I_vACPURACTNUMST  end,  @I_vPURPVACTNUMST =  case  when @I_vPURPVACTNUMST is null  then ''  else @I_vPURPVACTNUMST  end  end   if (@I_vUseVendorClass = 1)  begin  if ((@I_vUseVendorClass = 1) and ((@I_vVNDCLSID = '') or (@I_vVNDCLSID is null)))  begin  select @O_iErrorState = 7809     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end   select  @I_vVENDSHNM =  case  when @I_vVENDSHNM is null  then @I_vVENDNAME  else @I_vVENDSHNM  end,  @I_vVNDCHKNM =  case  when @I_vVNDCHKNM is null  then @I_vVENDNAME  else @I_vVNDCHKNM  end,  @I_vHOLD =  case  when @I_vHOLD is null  then 0  else @I_vHOLD  end,  @I_vVENDSTTS =  case  when @I_vVENDSTTS is null  then 1  else @I_vVENDSTTS  end,  @I_vVADDCDPR =  case  when @I_vVADDCDPR is null  then ''  else @I_vVADDCDPR  end,  @I_vVNDCNTCT =  case  when @I_vVNDCNTCT is null  then ''  else @I_vVNDCNTCT  end,  @I_vADDRESS1 =  case  when @I_vADDRESS1 is null  then ''  else @I_vADDRESS1  end,  @I_vADDRESS2 =  case  when @I_vADDRESS2 is null  then ''  else @I_vADDRESS2  end,  @I_vADDRESS3 =  case  when @I_vADDRESS3 is null  then ''  else @I_vADDRESS3  end,  @I_vCITY =  case  when @I_vCITY is null  then ''  else @I_vCITY  end,  @I_vSTATE =  case  when @I_vSTATE is null  then ''  else @I_vSTATE  end,  @I_vZIPCODE =  case  when @I_vZIPCODE is null  then ''  else @I_vZIPCODE  end,  @I_vCCode =  case  when @I_vCCode is null  then ''  else @I_vCCode  end,  @I_vCOUNTRY =  case  when @I_vCOUNTRY is null  then ''  else @I_vCOUNTRY  end,  @I_vPHNUMBR1 =  case  when @I_vPHNUMBR1 is null  then ''  else @I_vPHNUMBR1  end,  @I_vPHNUMBR2 =  case  when @I_vPHNUMBR2 is null  then ''  else @I_vPHNUMBR2  end,  @I_vPHNUMBR3 =  case  when @I_vPHNUMBR3 is null  then ''  else @I_vPHNUMBR3  end,  @I_vFAXNUMBR =  case  when @I_vFAXNUMBR is null  then ''  else @I_vFAXNUMBR  end,  @I_vTAXSCHID =  case  when @I_vTAXSCHID is null  then a.TAXSCHID  else @I_vTAXSCHID  end,  @I_vSHIPMTHD =  case  when @I_vSHIPMTHD is null  then a.SHIPMTHD  else @I_vSHIPMTHD  end,  @I_vUPSZONE =  case  when @I_vUPSZONE is null  then ''  else @I_vUPSZONE  end,  @I_vVADCDPAD =  case  when @I_vVADCDPAD is null  then @I_vVADDCDPR  else @I_vVADCDPAD  end,  @I_vVADCDTRO =  case  when @I_vVADCDTRO is null  then @I_vVADDCDPR  else @I_vVADCDTRO  end,  @I_vVADCDSFR =  case  when @I_vVADCDSFR is null  then @I_vVADDCDPR  else @I_vVADCDSFR  end,  @I_vACNMVNDR =  case  when @I_vACNMVNDR is null  then ''  else @I_vACNMVNDR  end,  @I_vCOMMENT1 =  case  when @I_vCOMMENT1 is null  then ''  else @I_vCOMMENT1  end,  @I_vCOMMENT2 =  case  when @I_vCOMMENT2 is null  then ''  else @I_vCOMMENT2  end,  @I_vNOTETEXT =  case  when @I_vNOTETEXT is null  then ''  else @I_vNOTETEXT  end,  @I_vCURNCYID =  case  when @I_vCURNCYID is null  then a.CURNCYID  else @I_vCURNCYID  end,  @I_vRATETPID =  case  when @I_vRATETPID is null  then a.RATETPID  else @I_vRATETPID  end,  @I_vPYMTRMID =  case  when @I_vPYMTRMID is null  then a.PYMTRMID  else @I_vPYMTRMID  end,  @I_vDISGRPER =  case  when @I_vDISGRPER is null  then a.DISGRPER  else @I_vDISGRPER  end,  @I_vDUEGRPER =  case  when @I_vDUEGRPER is null  then a.DUEGRPER  else @I_vDUEGRPER  end,  @I_vPYMNTPRI =  case  when @I_vPYMNTPRI is null  then a.PYMNTPRI  else @I_vPYMNTPRI  end,  @I_vMINORDER =  case  when @I_vMINORDER is null  then a.MINORDER  else @I_vMINORDER  end,  @I_vTRDDISCT =  case  when @I_vTRDDISCT is null  then a.TRDDISCT * .01  else @I_vTRDDISCT  end,  @I_vTXIDNMBR =  case  when @I_vTXIDNMBR is null  then ''  else @I_vTXIDNMBR  end,  @I_vTXRGNNUM =  case  when @I_vTXRGNNUM is null  then ''  else @I_vTXRGNNUM  end,  @I_vCHEKBKID =  case  when @I_vCHEKBKID is null  then a.CHEKBKID  else @I_vCHEKBKID  end,  @I_vUSERDEF1 =  case  when @I_vUSERDEF1 is null  then a.USERDEF1  else @I_vUSERDEF1  end,  @I_vUSERDEF2 =  case  when @I_vUSERDEF2 is null  then a.USERDEF2  else @I_vUSERDEF2  end,  @I_vTEN99TYPE =  case  when @I_vTEN99TYPE is null  then a.TEN99TYPE  else @I_vTEN99TYPE  end,  @I_vTEN99BOXNUMBER =  case  when @I_vTEN99BOXNUMBER is null  then   case when @I_vTEN99TYPE in (2, 3)   then 1   when @I_vTEN99TYPE = 4   then 7  else 0   end  else @I_vTEN99BOXNUMBER  end,  @I_vFREEONBOARD =  case  when @I_vFREEONBOARD is null  then a.FREEONBOARD  else @I_vFREEONBOARD  end,  @I_vUSERLANG =  case  when @I_vUSERLANG is null  then 0  else @I_vUSERLANG  end,  @I_vMINPYTYP =  case  when @I_vMINPYTYP is null  then a.MINPYTYP  else @I_vMINPYTYP  end,  @I_vMINPYDLR =  case  when @I_vMINPYDLR is null  then a.MINPYDLR  else @I_vMINPYDLR  end,  @I_vMINPYPCT =  case  when @I_vMINPYPCT is null  then a.MINPYPCT * .01  else @I_vMINPYPCT  end,  @I_vMXIAFVND =  case  when @I_vMXIAFVND is null  then a.MXIAFVND  else @I_vMXIAFVND  end,  @I_vMAXINDLR =  case  when @I_vMAXINDLR is null  then a.MXINVAMT  else @I_vMAXINDLR  end,  @I_vCREDTLMT =  case  when @I_vCREDTLMT is null  then a.CREDTLMT  else @I_vCREDTLMT  end,  @I_vCRLMTDLR =  case  when @I_vCRLMTDLR is null  then a.CRLMTDLR  else @I_vCRLMTDLR  end,  @I_vWRITEOFF =  case  when @I_vWRITEOFF is null  then a.WRITEOFF  else @I_vWRITEOFF  end,  @I_vMXWOFAMT =  case  when @I_vMXWOFAMT is null  then a.MXWOFAMT  else @I_vMXWOFAMT  end,  @I_vRevalue_Vendor =  case  when @I_vRevalue_Vendor is null  then a.Revalue_Vendor  else @I_vRevalue_Vendor  end,  @I_vPost_Results_To =  case  when @I_vPost_Results_To is null  then a.Post_Results_To  else @I_vPost_Results_To  end,  @I_vKPCALHST =  case  when @I_vKPCALHST is null  then a.KPCALHST  else @I_vKPCALHST  end,  @I_vKPERHIST =  case  when @I_vKPERHIST is null  then a.KPERHIST  else @I_vKPERHIST  end,  @I_vKPTRXHST =  case  when @I_vKPTRXHST is null  then a.KPTRXHST  else @I_vKPTRXHST  end,  @I_vKGLDSTHS =  case  when @I_vKGLDSTHS is null  then a.KGLDSTHS  else @I_vKGLDSTHS  end,  @I_vPTCSHACF =  case  when @I_vPTCSHACF is null  then a.PTCSHACF  else @I_vPTCSHACF  end,   @I_vPMCSHACTNUMST =  case  when @I_vPMCSHACTNUMST is null  then isnull(b.ACTNUMST, '')  else @I_vPMCSHACTNUMST  end,  @I_vPMAPACTNUMST =  case  when @I_vPMAPACTNUMST is null  then isnull(c.ACTNUMST, '')  else @I_vPMAPACTNUMST  end,  @I_vPMDAVACTNUMST =  case  when @I_vPMDAVACTNUMST is null  then isnull(d.ACTNUMST, '')  else @I_vPMDAVACTNUMST  end,  @I_vPMDTKACTNUMST =  case  when @I_vPMDTKACTNUMST is null  then isnull(e.ACTNUMST, '')  else @I_vPMDTKACTNUMST  end,  @I_vPMFINACTNUMST =  case  when @I_vPMFINACTNUMST is null  then isnull(f.ACTNUMST, '')  else @I_vPMFINACTNUMST  end,  @I_vPMPRCHACTNUMST =  case  when @I_vPMPRCHACTNUMST is null  then isnull(g.ACTNUMST, '')  else @I_vPMPRCHACTNUMST  end,  @I_vPMTDSCACTNUMST =  case  when @I_vPMTDSCACTNUMST is null  then isnull(h.ACTNUMST, '')  else @I_vPMTDSCACTNUMST  end,  @I_vPMMSCHACTNUMST =  case  when @I_vPMMSCHACTNUMST is null  then isnull(i.ACTNUMST, '')  else @I_vPMMSCHACTNUMST  end,  @I_vPMFRTACTNUMST =  case  when @I_vPMFRTACTNUMST is null  then isnull(j.ACTNUMST, '')  else @I_vPMFRTACTNUMST  end,  @I_vPMTAXACTNUMST =  case  when @I_vPMTAXACTNUMST is null  then isnull(k.ACTNUMST, '')  else @I_vPMTAXACTNUMST  end,  @I_vPMWRTACTNUMST =  case  when @I_vPMWRTACTNUMST is null  then isnull(l.ACTNUMST, '')  else @I_vPMWRTACTNUMST  end,  @I_vACPURACTNUMST =  case  when @I_vACPURACTNUMST is null  then isnull(m.ACTNUMST, '')  else @I_vACPURACTNUMST  end,  @I_vPURPVACTNUMST =  case  when @I_vPURPVACTNUMST is null  then isnull(n.ACTNUMST, '')  else @I_vPURPVACTNUMST  end  from PM00100 a (nolock)  left outer join GL00105 b (nolock) on  a.PMCSHIDX = b.ACTINDX  left outer join GL00105 c (nolock) on  a.PMAPINDX = c.ACTINDX  left outer join GL00105 d (nolock) on  a.PMDAVIDX = d.ACTINDX  left outer join GL00105 e (nolock) on  a.PMDTKIDX = e.ACTINDX  left outer join GL00105 f (nolock) on  a.PMFINIDX = f.ACTINDX  left outer join GL00105 g (nolock) on  a.PMPRCHIX = g.ACTINDX  left outer join GL00105 h (nolock) on  a.PMTDSCIX = h.ACTINDX  left outer join GL00105 i (nolock) on  a.PMMSCHIX = i.ACTINDX  left outer join GL00105 j (nolock) on  a.PMFRTIDX = j.ACTINDX  left outer join GL00105 k (nolock) on  a.PMTAXIDX = k.ACTINDX  left outer join GL00105 l (nolock) on  a.PMWRTIDX = l.ACTINDX  left outer join GL00105 m (nolock) on  a.ACPURIDX = m.ACTINDX  left outer join GL00105 n (nolock) on  a.PURPVIDX = n.ACTINDX  where a.VNDCLSID = @I_vVNDCLSID  end end  if (@exists = 1) begin  if ((@I_vUseVendorClass = 0) or (@UseRolldown = 0))  begin  select  @I_vVENDNAME =  case  when @I_vVENDNAME is null  then a.VENDNAME  else @I_vVENDNAME  end,   @I_vVENDSHNM =  case  when @I_vVENDSHNM is null  then a.VENDSHNM  else @I_vVENDSHNM  end,  @I_vVNDCHKNM =  case  when @I_vVNDCHKNM is null  then a.VNDCHKNM  else @I_vVNDCHKNM        end,  @I_vHOLD =  case  when @I_vHOLD is null  then a.HOLD  else @I_vHOLD  end,  @I_vVENDSTTS =  case  when @I_vVENDSTTS is null  then a.VENDSTTS  else @I_vVENDSTTS  end,  @I_vVNDCLSID =  case  when @I_vVNDCLSID is null  then a.VNDCLSID  else @I_vVNDCLSID  end,  @I_vVADDCDPR =  case  when @I_vVADDCDPR is null  then a.VADDCDPR  else @I_vVADDCDPR  end,  @I_vVNDCNTCT =  case  when @I_vVNDCNTCT is null  then a.VNDCNTCT  else @I_vVNDCNTCT  end,  @I_vADDRESS1 =  case  when @I_vADDRESS1 is null  then a.ADDRESS1  else @I_vADDRESS1  end,  @I_vADDRESS2 =  case  when @I_vADDRESS2 is null  then a.ADDRESS2  else @I_vADDRESS2  end,  @I_vADDRESS3 =  case  when @I_vADDRESS3 is null  then a.ADDRESS3  else @I_vADDRESS3  end,  @I_vCITY =  case  when @I_vCITY is null  then a.CITY  else @I_vCITY  end,  @I_vSTATE =  case  when @I_vSTATE is null  then a.STATE  else @I_vSTATE  end,  @I_vZIPCODE =  case  when @I_vZIPCODE is null  then a.ZIPCODE  else @I_vZIPCODE  end,  @I_vCCode =  case  when @I_vCCode is null  then a.CCode  else @I_vCCode  end,  @I_vCOUNTRY =  case  when @I_vCOUNTRY is null  then a.COUNTRY  else @I_vCOUNTRY  end,  @I_vPHNUMBR1 =  case  when @I_vPHNUMBR1 is null  then a.PHNUMBR1  else @I_vPHNUMBR1  end,  @I_vPHNUMBR2 =  case  when @I_vPHNUMBR2 is null  then a.PHNUMBR2  else @I_vPHNUMBR2  end,  @I_vPHNUMBR3 =  case  when @I_vPHNUMBR3 is null  then a.PHONE3  else @I_vPHNUMBR3  end,  @I_vFAXNUMBR =  case  when @I_vFAXNUMBR is null  then a.FAXNUMBR  else @I_vFAXNUMBR  end,  @I_vTAXSCHID =  case  when @I_vTAXSCHID is null  then a.TAXSCHID  else @I_vTAXSCHID  end,  @I_vSHIPMTHD =  case  when @I_vSHIPMTHD is null  then a.SHIPMTHD  else @I_vSHIPMTHD  end,  @I_vUPSZONE =  case  when @I_vUPSZONE is null  then a.UPSZONE  else @I_vUPSZONE  end,  @I_vVADCDPAD =  case  when @I_vVADCDPAD is null  then a.VADCDPAD  else @I_vVADCDPAD  end,  @I_vVADCDTRO =  case  when @I_vVADCDTRO is null  then a.VADCDTRO  else @I_vVADCDTRO  end,  @I_vVADCDSFR =  case  when @I_vVADCDSFR is null  then a.VADCDSFR  else @I_vVADCDSFR  end,  @I_vACNMVNDR =  case  when @I_vACNMVNDR is null  then a.ACNMVNDR  else @I_vACNMVNDR  end,  @I_vCOMMENT1 =  case  when @I_vCOMMENT1 is null  then a.COMMENT1  else @I_vCOMMENT1  end,  @I_vCOMMENT2 =  case  when @I_vCOMMENT2 is null  then a.COMMENT2  else @I_vCOMMENT2  end,  @I_vCURNCYID =  case  when @I_vCURNCYID is null  then a.CURNCYID  else @I_vCURNCYID  end,  @I_vRATETPID =  case  when @I_vRATETPID is null  then a.RATETPID  else @I_vRATETPID  end,  @I_vPYMTRMID =  case  when @I_vPYMTRMID is null  then a.PYMTRMID  else @I_vPYMTRMID  end,  @I_vDISGRPER =  case  when @I_vDISGRPER is null  then a.DISGRPER  else @I_vDISGRPER  end,  @I_vDUEGRPER =  case  when @I_vDUEGRPER is null  then a.DUEGRPER  else @I_vDUEGRPER  end,  @I_vPYMNTPRI =  case  when @I_vPYMNTPRI is null  then a.PYMNTPRI  else @I_vPYMNTPRI  end,  @I_vMINORDER =  case  when @I_vMINORDER is null  then a.MINORDER  else @I_vMINORDER  end,  @I_vTRDDISCT =  case  when @I_vTRDDISCT is null  then a.TRDDISCT * .01  else @I_vTRDDISCT  end,  @I_vTXIDNMBR =  case  when @I_vTXIDNMBR is null  then a.TXIDNMBR  else @I_vTXIDNMBR  end,  @I_vTXRGNNUM =  case  when @I_vTXRGNNUM is null  then a.TXRGNNUM  else @I_vTXRGNNUM  end,  @I_vCHEKBKID =  case  when @I_vCHEKBKID is null  then a.CHEKBKID  else @I_vCHEKBKID  end,  @I_vUSERDEF1 =  case  when @I_vUSERDEF1 is null  then a.USERDEF1  else @I_vUSERDEF1  end,  @I_vUSERDEF2 =  case  when @I_vUSERDEF2 is null  then a.USERDEF2  else @I_vUSERDEF2  end,  @I_vTEN99TYPE =  case  when @I_vTEN99TYPE is null  then a.TEN99TYPE  else @I_vTEN99TYPE  end,  @I_vTEN99BOXNUMBER =  case  when @I_vTEN99BOXNUMBER is null  then a.TEN99BOXNUMBER  else @I_vTEN99BOXNUMBER  end,  @I_vFREEONBOARD =  case  when @I_vFREEONBOARD is null  then a.FREEONBOARD  else @I_vFREEONBOARD  end,  @I_vUSERLANG =  case  when @I_vUSERLANG is null  then a.USERLANG  else @I_vUSERLANG  end,  @I_vMINPYTYP =  case  when @I_vMINPYTYP is null  then a.MINPYTYP  else @I_vMINPYTYP  end,  @I_vMINPYDLR =  case  when @I_vMINPYDLR is null  then a.MINPYDLR  else @I_vMINPYDLR  end,  @I_vMINPYPCT =  case  when @I_vMINPYPCT is null  then a.MINPYPCT * .01  else @I_vMINPYPCT  end,  @I_vMXIAFVND =  case  when @I_vMXIAFVND is null  then a.MXIAFVND  else @I_vMXIAFVND  end,  @I_vMAXINDLR =  case  when @I_vMAXINDLR is null  then a.MAXINDLR  else @I_vMAXINDLR  end,  @I_vCREDTLMT =  case  when @I_vCREDTLMT is null  then a.CREDTLMT  else @I_vCREDTLMT  end,  @I_vCRLMTDLR =  case  when @I_vCRLMTDLR is null  then a.CRLMTDLR  else @I_vCRLMTDLR  end,  @I_vWRITEOFF =  case  when @I_vWRITEOFF is null  then a.WRITEOFF  else @I_vWRITEOFF  end,  @I_vMXWOFAMT =  case  when @I_vMXWOFAMT is null  then a.MXWOFAMT  else @I_vMXWOFAMT  end,  @I_vRevalue_Vendor =  case  when @I_vRevalue_Vendor is null  then a.Revalue_Vendor  else @I_vRevalue_Vendor  end,  @I_vPost_Results_To =  case  when @I_vPost_Results_To is null  then a.Post_Results_To  else @I_vPost_Results_To  end,  @I_vKPCALHST =  case  when @I_vKPCALHST is null  then a.KPCALHST  else @I_vKPCALHST  end,  @I_vKPERHIST =  case  when @I_vKPERHIST is null  then a.KPERHIST  else @I_vKPERHIST  end,  @I_vKPTRXHST =  case  when @I_vKPTRXHST is null  then a.KPTRXHST  else @I_vKPTRXHST  end,  @I_vKGLDSTHS =  case  when @I_vKGLDSTHS is null  then a.KGLDSTHS  else @I_vKGLDSTHS  end,  @I_vPTCSHACF =  case  when @I_vPTCSHACF is null  then a.PTCSHACF  else @I_vPTCSHACF  end,  @I_vPMCSHACTNUMST =  case  when @I_vPMCSHACTNUMST is null  then isnull(b.ACTNUMST, '')  else @I_vPMCSHACTNUMST  end,  @I_vPMAPACTNUMST =  case  when @I_vPMAPACTNUMST is null  then isnull(c.ACTNUMST, '')  else @I_vPMAPACTNUMST  end,  @I_vPMDAVACTNUMST =  case  when @I_vPMDAVACTNUMST is null  then isnull(d.ACTNUMST, '')  else @I_vPMDAVACTNUMST  end,  @I_vPMDTKACTNUMST =  case  when @I_vPMDTKACTNUMST is null  then isnull(e.ACTNUMST, '')  else @I_vPMDTKACTNUMST  end,  @I_vPMFINACTNUMST =  case  when @I_vPMFINACTNUMST is null  then isnull(f.ACTNUMST, '')  else @I_vPMFINACTNUMST  end,  @I_vPMPRCHACTNUMST =  case  when @I_vPMPRCHACTNUMST is null  then isnull(g.ACTNUMST, '')  else @I_vPMPRCHACTNUMST  end,  @I_vPMTDSCACTNUMST =  case  when @I_vPMTDSCACTNUMST is null  then isnull(h.ACTNUMST, '')  else @I_vPMTDSCACTNUMST  end,  @I_vPMMSCHACTNUMST =  case  when @I_vPMMSCHACTNUMST is null  then isnull(i.ACTNUMST, '')  else @I_vPMMSCHACTNUMST  end,  @I_vPMFRTACTNUMST =  case  when @I_vPMFRTACTNUMST is null  then isnull(j.ACTNUMST, '')  else @I_vPMFRTACTNUMST  end,  @I_vPMTAXACTNUMST =  case  when @I_vPMTAXACTNUMST is null  then isnull(k.ACTNUMST, '')  else @I_vPMTAXACTNUMST  end,  @I_vPMWRTACTNUMST =  case  when @I_vPMWRTACTNUMST is null  then isnull(l.ACTNUMST, '')  else @I_vPMWRTACTNUMST  end,  @I_vACPURACTNUMST =  case  when @I_vACPURACTNUMST is null  then isnull(m.ACTNUMST, '')  else @I_vACPURACTNUMST  end,  @I_vPURPVACTNUMST =  case  when @I_vPURPVACTNUMST is null  then isnull(n.ACTNUMST, '')  else @I_vPURPVACTNUMST  end  from PM00200 a (nolock)  left outer join GL00105 b (nolock) on  a.PMCSHIDX = b.ACTINDX  left outer join GL00105 c (nolock) on  a.PMAPINDX = c.ACTINDX  left outer join GL00105 d (nolock) on  a.PMDAVIDX = d.ACTINDX  left outer join GL00105 e (nolock) on  a.PMDTKIDX = e.ACTINDX  left outer join GL00105 f (nolock) on  a.PMFINIDX = f.ACTINDX  left outer join GL00105 g (nolock) on  a.PMPRCHIX = g.ACTINDX  left outer join GL00105 h (nolock) on  a.PMTDSCIX = h.ACTINDX  left outer join GL00105 i (nolock) on  a.PMMSCHIX = i.ACTINDX  left outer join GL00105 j (nolock) on  a.PMFRTIDX = j.ACTINDX  left outer join GL00105 k (nolock) on  a.PMTAXIDX = k.ACTINDX  left outer join GL00105 l (nolock) on  a.PMWRTIDX = l.ACTINDX  left outer join GL00105 m (nolock) on  a.ACPURIDX = m.ACTINDX  left outer join GL00105 n (nolock) on  a.PURPVIDX = n.ACTINDX  where VENDORID = @I_vVENDORID   if (@I_vNOTETEXT is null)  begin  select @I_vNOTETEXT = TXTFIELD from SY03900 (nolock) where NOTEINDX = @nNextNoteIndex  end  end   if (@UseRolldown = 1)  begin  if (@I_vVNDCLSID = '')  begin  select @O_iErrorState = 7853     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end   select  @I_vVENDNAME =  case  when @I_vVENDNAME is null  then a.VENDNAME  else @I_vVENDNAME  end,   @I_vVENDSHNM =  case  when @I_vVENDSHNM is null  then a.VENDSHNM  else @I_vVENDSHNM  end,  @I_vVNDCHKNM =  case  when @I_vVNDCHKNM is null  then a.VNDCHKNM  else @I_vVNDCHKNM              end,  @I_vHOLD =  case  when @I_vHOLD is null  then a.HOLD  else @I_vHOLD  end,  @I_vVENDSTTS =  case  when @I_vVENDSTTS is null  then a.VENDSTTS  else @I_vVENDSTTS  end,  @I_vVADDCDPR =  case  when @I_vVADDCDPR is null  then a.VADDCDPR  else @I_vVADDCDPR  end,  @I_vVNDCNTCT =  case  when @I_vVNDCNTCT is null  then a.VNDCNTCT  else @I_vVNDCNTCT  end,  @I_vADDRESS1 =  case  when @I_vADDRESS1 is null  then a.ADDRESS1  else @I_vADDRESS1  end,  @I_vADDRESS2 =  case  when @I_vADDRESS2 is null  then a.ADDRESS2  else @I_vADDRESS2  end,  @I_vADDRESS3 =  case  when @I_vADDRESS3 is null  then a.ADDRESS3  else @I_vADDRESS3  end,  @I_vCITY =  case  when @I_vCITY is null  then a.CITY  else @I_vCITY  end,  @I_vSTATE =  case  when @I_vSTATE is null  then a.STATE  else @I_vSTATE  end,  @I_vZIPCODE =  case  when @I_vZIPCODE is null  then a.ZIPCODE  else @I_vZIPCODE  end,  @I_vCCode =  case  when @I_vCCode is null  then a.CCode  else @I_vCCode  end,  @I_vCOUNTRY =  case  when @I_vCOUNTRY is null  then a.COUNTRY  else @I_vCOUNTRY  end,  @I_vPHNUMBR1 =  case  when @I_vPHNUMBR1 is null  then a.PHNUMBR1  else @I_vPHNUMBR1  end,  @I_vPHNUMBR2 =  case  when @I_vPHNUMBR2 is null  then a.PHNUMBR2  else @I_vPHNUMBR2  end,  @I_vPHNUMBR3 =  case  when @I_vPHNUMBR3 is null  then a.PHONE3  else @I_vPHNUMBR3  end,  @I_vFAXNUMBR =  case  when @I_vFAXNUMBR is null  then a.FAXNUMBR  else @I_vFAXNUMBR  end,  @I_vTAXSCHID =  case  when @I_vTAXSCHID is null  then b.TAXSCHID  else @I_vTAXSCHID  end,  @I_vSHIPMTHD =  case  when @I_vSHIPMTHD is null  then b.SHIPMTHD  else @I_vSHIPMTHD  end,  @I_vUPSZONE =  case  when @I_vUPSZONE is null  then a.UPSZONE  else @I_vUPSZONE  end,  @I_vVADCDPAD =  case  when @I_vVADCDPAD is null  then a.VADCDPAD  else @I_vVADCDPAD  end,  @I_vVADCDTRO =  case  when @I_vVADCDTRO is null  then a.VADCDTRO  else @I_vVADCDTRO  end,  @I_vVADCDSFR =  case  when @I_vVADCDSFR is null  then a.VADCDSFR  else @I_vVADCDSFR  end,  @I_vACNMVNDR =  case  when @I_vACNMVNDR is null  then a.ACNMVNDR  else @I_vACNMVNDR  end,  @I_vCOMMENT1 =  case  when @I_vCOMMENT1 is null  then a.COMMENT1  else @I_vCOMMENT1  end,  @I_vCOMMENT2 =  case  when @I_vCOMMENT2 is null  then a.COMMENT2  else @I_vCOMMENT2  end,  @I_vCURNCYID =  case  when @I_vCURNCYID is null  then b.CURNCYID  else @I_vCURNCYID  end,  @I_vRATETPID =  case  when @I_vRATETPID is null  then b.RATETPID  else @I_vRATETPID  end,  @I_vPYMTRMID =  case  when @I_vPYMTRMID is null  then b.PYMTRMID  else @I_vPYMTRMID  end,  @I_vDISGRPER =  case  when @I_vDISGRPER is null  then b.DISGRPER  else @I_vDISGRPER  end,  @I_vDUEGRPER =  case  when @I_vDUEGRPER is null  then b.DUEGRPER  else @I_vDUEGRPER  end,  @I_vPYMNTPRI =  case  when @I_vPYMNTPRI is null  then b.PYMNTPRI  else @I_vPYMNTPRI  end,  @I_vMINORDER =  case  when @I_vMINORDER is null  then b.MINORDER  else @I_vMINORDER  end,  @I_vTRDDISCT =  case  when @I_vTRDDISCT is null  then b.TRDDISCT * .01  else @I_vTRDDISCT  end,  @I_vTXIDNMBR =  case  when @I_vTXIDNMBR is null  then a.TXIDNMBR  else @I_vTXIDNMBR  end,  @I_vTXRGNNUM =  case  when @I_vTXRGNNUM is null  then a.TXRGNNUM  else @I_vTXRGNNUM  end,  @I_vCHEKBKID =  case  when @I_vCHEKBKID is null  then b.CHEKBKID  else @I_vCHEKBKID  end,  @I_vUSERDEF1 =  case  when @I_vUSERDEF1 is null  then b.USERDEF1  else @I_vUSERDEF1  end,  @I_vUSERDEF2 =  case  when @I_vUSERDEF2 is null  then b.USERDEF2  else @I_vUSERDEF2  end,  @I_vTEN99TYPE =  case  when @I_vTEN99TYPE is null  then b.TEN99TYPE  else @I_vTEN99TYPE  end,  @I_vTEN99BOXNUMBER =  case  when @I_vTEN99BOXNUMBER is null  then   case when @I_vTEN99TYPE in (2, 3)   then 1   when @I_vTEN99TYPE = 4   then 7  else 0   end  else @I_vTEN99BOXNUMBER  end,  @I_vFREEONBOARD =  case  when @I_vFREEONBOARD is null  then b.FREEONBOARD  else @I_vFREEONBOARD  end,  @I_vUSERLANG =  case  when @I_vUSERLANG is null  then a.USERLANG  else @I_vUSERLANG  end,  @I_vMINPYTYP =  case  when @I_vMINPYTYP is null  then b.MINPYTYP  else @I_vMINPYTYP  end,  @I_vMINPYDLR =  case  when @I_vMINPYDLR is null  then b.MINPYDLR  else @I_vMINPYDLR  end,  @I_vMINPYPCT =  case  when @I_vMINPYPCT is null  then b.MINPYPCT * .01  else @I_vMINPYPCT  end,  @I_vMXIAFVND =  case  when @I_vMXIAFVND is null  then b.MXIAFVND  else @I_vMXIAFVND  end,  @I_vMAXINDLR =  case  when @I_vMAXINDLR is null  then b.MXINVAMT  else @I_vMAXINDLR  end,  @I_vCREDTLMT =  case  when @I_vCREDTLMT is null  then b.CREDTLMT  else @I_vCREDTLMT  end,  @I_vCRLMTDLR =  case  when @I_vCRLMTDLR is null  then b.CRLMTDLR  else @I_vCRLMTDLR  end,  @I_vWRITEOFF =  case  when @I_vWRITEOFF is null  then b.WRITEOFF  else @I_vWRITEOFF  end,  @I_vMXWOFAMT =  case  when @I_vMXWOFAMT is null  then b.MXWOFAMT  else @I_vMXWOFAMT  end,  @I_vRevalue_Vendor =  case  when @I_vRevalue_Vendor is null  then b.Revalue_Vendor  else @I_vRevalue_Vendor  end,  @I_vPost_Results_To =  case  when @I_vPost_Results_To is null  then b.Post_Results_To  else @I_vPost_Results_To  end,  @I_vKPCALHST =  case  when @I_vKPCALHST is null  then b.KPCALHST  else @I_vKPCALHST  end,  @I_vKPERHIST =  case  when @I_vKPERHIST is null  then b.KPERHIST  else @I_vKPERHIST  end,  @I_vKPTRXHST =  case  when @I_vKPTRXHST is null  then b.KPTRXHST  else @I_vKPTRXHST  end,  @I_vKGLDSTHS =  case  when @I_vKGLDSTHS is null  then b.KGLDSTHS  else @I_vKGLDSTHS  end,  @I_vPTCSHACF =  case  when @I_vPTCSHACF is null  then b.PTCSHACF  else @I_vPTCSHACF  end,   @I_vPMCSHACTNUMST =  case  when @I_vPMCSHACTNUMST is null  then isnull(c.ACTNUMST, '')  else @I_vPMCSHACTNUMST  end,  @I_vPMAPACTNUMST =  case  when @I_vPMAPACTNUMST is null  then isnull(d.ACTNUMST, '')  else @I_vPMAPACTNUMST  end,  @I_vPMDAVACTNUMST =  case  when @I_vPMDAVACTNUMST is null  then isnull(e.ACTNUMST, '')  else @I_vPMDAVACTNUMST  end,  @I_vPMDTKACTNUMST =  case  when @I_vPMDTKACTNUMST is null  then isnull(f.ACTNUMST, '')  else @I_vPMDTKACTNUMST  end,  @I_vPMFINACTNUMST =  case  when @I_vPMFINACTNUMST is null  then isnull(g.ACTNUMST, '')  else @I_vPMFINACTNUMST  end,  @I_vPMPRCHACTNUMST =  case  when @I_vPMPRCHACTNUMST is null  then isnull(h.ACTNUMST, '')  else @I_vPMPRCHACTNUMST  end,  @I_vPMTDSCACTNUMST =  case  when @I_vPMTDSCACTNUMST is null  then isnull(i.ACTNUMST, '')  else @I_vPMTDSCACTNUMST  end,  @I_vPMMSCHACTNUMST =  case  when @I_vPMMSCHACTNUMST is null  then isnull(j.ACTNUMST, '')  else @I_vPMMSCHACTNUMST  end,  @I_vPMFRTACTNUMST =  case  when @I_vPMFRTACTNUMST is null  then isnull(k.ACTNUMST, '')  else @I_vPMFRTACTNUMST  end,  @I_vPMTAXACTNUMST =  case  when @I_vPMTAXACTNUMST is null  then isnull(l.ACTNUMST, '')  else @I_vPMTAXACTNUMST  end,  @I_vPMWRTACTNUMST =  case  when @I_vPMWRTACTNUMST is null  then isnull(m.ACTNUMST, '')  else @I_vPMWRTACTNUMST  end,  @I_vACPURACTNUMST =  case  when @I_vACPURACTNUMST is null  then isnull(n.ACTNUMST, '')  else @I_vACPURACTNUMST  end,  @I_vPURPVACTNUMST =  case  when @I_vPURPVACTNUMST is null  then isnull(o.ACTNUMST, '')  else @I_vPURPVACTNUMST  end  from PM00200 a (nolock)  inner join PM00100 b (nolock) on b.VNDCLSID = @I_vVNDCLSID  left outer join GL00105 c (nolock) on  b.PMCSHIDX = c.ACTINDX  left outer join GL00105 d (nolock) on  b.PMAPINDX = d.ACTINDX  left outer join GL00105 e (nolock) on  b.PMDAVIDX = e.ACTINDX  left outer join GL00105 f (nolock) on  b.PMDTKIDX = f.ACTINDX  left outer join GL00105 g (nolock) on  b.PMFINIDX = g.ACTINDX  left outer join GL00105 h (nolock) on  b.PMPRCHIX = h.ACTINDX  left outer join GL00105 i (nolock) on  b.PMTDSCIX = i.ACTINDX  left outer join GL00105 j (nolock) on  b.PMMSCHIX = j.ACTINDX  left outer join GL00105 k (nolock) on  b.PMFRTIDX = k.ACTINDX  left outer join GL00105 l (nolock) on  b.PMTAXIDX = l.ACTINDX  left outer join GL00105 m (nolock) on  b.PMWRTIDX = m.ACTINDX  left outer join GL00105 n (nolock) on  b.ACPURIDX = n.ACTINDX  left outer join GL00105 o (nolock) on  b.PURPVIDX = o.ACTINDX  where a.VENDORID = @I_vVENDORID   if (@I_vNOTETEXT is null)  begin  select @I_vNOTETEXT = TXTFIELD from SY03900 (nolock) where NOTEINDX = @nNextNoteIndex  end  end end  if (@I_vHOLD not in(0,1)) begin  select @O_iErrorState = 1661     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vVENDSTTS not in(1,2,3)) begin  select @O_iErrorState = 1662     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vVNDCLSID <> '') begin  if (not exists(select 1 from PM00100 (nolock) where VNDCLSID = @I_vVNDCLSID))  begin  select @O_iErrorState = 233     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vCCode <> '') begin  if (not exists(select 1 from VAT10001 (nolock) where CCode = @I_vCCode))  begin   select @O_iErrorState = 6303     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vTAXSCHID <> '') begin  if (not exists(select 1 from TX00102 (nolock) where TAXSCHID = @I_vTAXSCHID))  begin   select @O_iErrorState = 9159     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vCURNCYID <> '') begin  if (not exists(select 1 from DYNAMICS..MC40200 (nolock) where CURNCYID = @I_vCURNCYID))  begin   select @O_iErrorState = 9238     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (not exists(select top 1 CURNCYID from DYNAMICS..MC60100 (nolock) where CURNCYID = @I_vCURNCYID and CMPANYID = @sCompanyID ))  begin  select @O_iErrorState = 529    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vRATETPID <> '') begin  if (not exists(select 1 from MC40100 (nolock) where RATETPID = @I_vRATETPID))  begin  select @O_iErrorState = 7810     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vPYMTRMID <> '') begin  if (not exists(select 1 from SY03300 (nolock) where PYMTRMID = @I_vPYMTRMID))  begin  select @O_iErrorState = 497     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if ((@I_vDISGRPER < 0) or (@I_vDISGRPER > 99)) begin  select @O_iErrorState = 932     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if ((@I_vDUEGRPER < 0) or (@I_vDUEGRPER > 99)) begin  select @O_iErrorState = 7811     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vTRDDISCT > 99.99) begin  select @O_iErrorState = 527     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vCHEKBKID <> '') begin  if (not exists(select 1 from CM00100 (nolock) where CHEKBKID = @I_vCHEKBKID))  begin  select @O_iErrorState = 498     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if ((@I_vTEN99TYPE < 1) or (@I_vTEN99TYPE > 4)) begin  select @O_iErrorState = 3396     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vTEN99TYPE in(2,3,4)) begin  select @I_vKPCALHST = 1  end  if (@I_vTEN99TYPE = 1) and (@I_vTEN99BOXNUMBER <> 0) begin  select @O_iErrorState = 10450     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end   if (@I_vTEN99TYPE = 2) and (@I_vTEN99BOXNUMBER < 1 or @I_vTEN99BOXNUMBER > 12) begin  select @O_iErrorState = 10454     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end   if (@I_vTEN99TYPE = 3) and (@I_vTEN99BOXNUMBER < 1 or @I_vTEN99BOXNUMBER > 8) begin  select @O_iErrorState = 10452     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end   if (@I_vTEN99TYPE = 4) and (@I_vTEN99BOXNUMBER < 1 or @I_vTEN99BOXNUMBER > 14) begin  select @O_iErrorState = 10453     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end   if (@I_vFREEONBOARD not in(1,2,3)) begin  select @O_iErrorState = 7812     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vUSERLANG <> 0) begin  if (not exists(select top 1 USERLANG from DYNAMICS..SY05400 (nolock) where USERLANG = @I_vUSERLANG))  begin  select @O_iErrorState = 7813     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vMINPYTYP not in(0,1,2)) begin  select @O_iErrorState = 7814     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if ((@I_vMINPYDLR > 0) and (@I_vMINPYTYP <> 2)) begin  select @O_iErrorState = 7815     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vMINPYPCT > 100.00) begin  select @O_iErrorState = 7816     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if ((@I_vMINPYPCT > 0) and (@I_vMINPYTYP <> 1)) begin  select @O_iErrorState = 7817     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vMXIAFVND not in(0,1)) begin  select @O_iErrorState = 7818     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if ((@I_vMAXINDLR > 0) and (@I_vMXIAFVND <> 1)) begin  select @O_iErrorState = 7819     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vCREDTLMT not in(0,1,2)) begin  select @O_iErrorState = 7820     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if ((@I_vCRLMTDLR > 0) and (@I_vCREDTLMT <> 2)) begin  select @O_iErrorState = 7821     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vWRITEOFF not in(0,1,2)) begin  select @O_iErrorState = 7822     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if ((@I_vMXWOFAMT > 0) and (@I_vWRITEOFF <> 2)) begin  select @O_iErrorState = 7823     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vRevalue_Vendor not in(0,1)) begin  select @O_iErrorState = 7824     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vRevalue_Vendor = 0) begin  select @I_vPost_Results_To = 0   end  if (@I_vPost_Results_To not in(0,1)) begin  select @O_iErrorState = 7825     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vKPCALHST not in(0,1)) begin  select @O_iErrorState = 7826     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vKPERHIST not in(0,1)) begin  select @O_iErrorState = 7827     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vKPTRXHST not in(0,1)) begin  select @O_iErrorState = 7828     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vKGLDSTHS not in(0,1)) begin  select @O_iErrorState = 7829     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vPTCSHACF not in(0,1)) begin  select @O_iErrorState = 7830     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vPMCSHACTNUMST <> '') begin  select @PMCSHIDX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vPMCSHACTNUMST   if (@PMCSHIDX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @PMCSHIDX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 584     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 90     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7831     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if ((@I_vPTCSHACF <> 1) and (@I_vPMCSHACTNUMST <> '')) begin  select @O_iErrorState = 7832     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vPMAPACTNUMST <> '') begin  select @PMAPINDX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vPMAPACTNUMST   if (@PMAPINDX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @PMAPINDX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 7924     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 7925     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7833     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vPMDAVACTNUMST <> '') begin  select @PMDAVIDX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vPMDAVACTNUMST   if (@PMDAVIDX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @PMDAVIDX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 7926     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 7927     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7834     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vPMDTKACTNUMST <> '') begin  select @PMDTKIDX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vPMDTKACTNUMST   if (@PMDTKIDX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @PMDTKIDX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 7928     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 7929     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7835     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vPMFINACTNUMST <> '') begin  select @PMFINIDX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vPMFINACTNUMST   if (@PMFINIDX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @PMFINIDX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 7930     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 7931     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7836     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vPMPRCHACTNUMST <> '') begin  select @PMPRCHIX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vPMPRCHACTNUMST   if (@PMPRCHIX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @PMPRCHIX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 8012     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 7932     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7837     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vPMTDSCACTNUMST <> '') begin  select @PMTDSCIX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vPMTDSCACTNUMST   if (@PMTDSCIX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @PMTDSCIX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 7933     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 7934     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7838     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vPMMSCHACTNUMST <> '') begin  select @PMMSCHIX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vPMMSCHACTNUMST   if (@PMMSCHIX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @PMMSCHIX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 8013     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 7935     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7839     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vPMFRTACTNUMST <> '') begin  select @PMFRTIDX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vPMFRTACTNUMST   if (@PMFRTIDX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @PMFRTIDX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 8014     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 7936     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7840     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vPMTAXACTNUMST <> '') begin  select @PMTAXIDX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vPMTAXACTNUMST   if (@PMTAXIDX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @PMTAXIDX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 8015     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 7937     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7841     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vPMWRTACTNUMST <> '') begin  select @PMWRTIDX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vPMWRTACTNUMST   if (@PMWRTIDX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @PMWRTIDX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 8016     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 7938     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7842     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vACPURACTNUMST <> '') begin  select @ACPURIDX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vACPURACTNUMST   if (@ACPURIDX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @ACPURIDX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 7939     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 7940     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7843     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vPURPVACTNUMST <> '') begin  select @PURPVIDX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vPURPVACTNUMST   if (@PURPVIDX <> 0)  begin  select @ACTIVE = ACTIVE,  @ACCTTYPE = ACCTTYPE  from GL00100 (nolock) where ACTINDX = @PURPVIDX   if (@ACTIVE = 0)  begin  select @O_iErrorState = 7941     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   if (@ACCTTYPE not in(1,3))  begin  select @O_iErrorState = 7942     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   select @ACTIVE = 0, @ACCTTYPE = 0  end  else  begin  select @O_iErrorState = 7844     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vUseVendorClass not in(0,1)) begin  select @O_iErrorState = 7845     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vCreateAddress not in(0,1)) begin  select @O_iErrorState = 7846     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vUpdateIfExists not in(0,1)) begin  select @O_iErrorState = 7847     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vRequesterTrx not in(0,1)) begin  select @O_iErrorState = 3714     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vVADDCDPR = '') begin  if (  (@I_vVNDCNTCT <> '') or  (@I_vADDRESS1 <> '') or  (@I_vADDRESS2 <> '') or  (@I_vADDRESS3 <> '') or  (@I_vCITY <> '') or  (@I_vSTATE <> '') or  (@I_vZIPCODE <> '') or  (@I_vCCode <> '') or  (@I_vCOUNTRY <> '') or  ((@I_vPHNUMBR1 <> '') and (@I_vPHNUMBR1 > '0')) or  ((@I_vPHNUMBR2 <> '')  and (@I_vPHNUMBR2 > '0')) or  ((@I_vPHNUMBR3 <> '')  and (@I_vPHNUMBR3 > '0')) or  ((@I_vFAXNUMBR <> '')  and (@I_vFAXNUMBR > '0')) or  (@I_vTAXSCHID <> '') or  (@I_vSHIPMTHD <> '') or  (@I_vUPSZONE <> '')  )  begin  select @O_iErrorState = 7850     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  select @FUNLCURR = isnull(FUNLCURR,'') from MC40000 (nolock)  if (@FUNLCURR = '') begin  select @O_iErrorState = 8007    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  select @DECPLCUR = DECPLCUR - 1 from DYNAMICS..MC40200 (nolock) where CURNCYID = @FUNLCURR  if ( (@I_vMINORDER <> round(@I_vMINORDER,@DECPLCUR)) or  (@I_vMINPYDLR <> round(@I_vMINPYDLR,@DECPLCUR)) or  (@I_vMAXINDLR <> round(@I_vMAXINDLR,@DECPLCUR)) or  (@I_vCRLMTDLR <> round(@I_vCRLMTDLR,@DECPLCUR)) or  (@I_vMXWOFAMT <> round(@I_vMXWOFAMT,@DECPLCUR))) begin  select @O_iErrorState = 8008     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if (@I_vCOUNTRY = '' and @I_vCCode <> '') begin  select @I_vCOUNTRY = substring(CCodeDesc,1,20) from VAT10001 (nolock) where CCode = @I_vCCode end   if (@exists = 0) Begin  if exists (select Workflow_Type_Name from WF100001 where FormID = 210 ) and  exists (select 1 from WF100002 where WF100002.ACTIVE = 1 and Workflow_Type_Name = (select Workflow_Type_Name from WF100001 where FormID = 210 ))  select @Workflow_Status = 1, @Workflow_Priority = 0    else  select @Workflow_Status = 9, @Workflow_Priority = 0    end Else Begin  if exists (select 1 from WF100002 where WF100002.ACTIVE = 1 and Workflow_Type_Name = (select Workflow_Type_Name from WF100001 where FormID = 210 ))  Begin  select @O_iErrorState = 12011     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@O_iErrorState <> 0) begin  return (@O_iErrorState) end  if (@I_vRequesterTrx = 0) begin  exec @iStatus = eConnectOutVerify  @I_vDOCTYPE = 'Vendor',  @I_vINDEX1 = @I_vVENDORID,  @I_vINDEX2 = '',  @I_vINDEX3 = '',  @I_vINDEX4 = '',  @I_vINDEX5 = '',  @I_vINDEX6 = '',  @I_vINDEX7 = '',  @I_vINDEX8 = '',  @I_vINDEX9 = '',  @I_vINDEX10 = '',  @I_vINDEX11 = '',  @I_vINDEX12 = '',  @I_vINDEX13 = '',  @I_vINDEX14 = '',  @I_vINDEX15 = '',  @I_vDelete = 0,  @O_iErrorState = @iCustomState output  select @iError = @@error  if ((@iStatus <> 0) or (@iCustomState <> 0) or (@iError <> 0))  begin  select @oErrString = rtrim(@oErrString) + ' ' + @iCustomState  select @O_iErrorState = 2029    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  if (@I_vSHIPMTHD <> '') begin  if (not exists(select 1 from SY03000 (nolock) where SHIPMTHD = @I_vSHIPMTHD))  begin  exec @iStatus = taCreateShippingMethod  @I_vSHIPMTHD = @I_vSHIPMTHD,  @I_vUpdateIfExists = 0,  @O_iErrorState = @iAddShippingErrState output,  @oErrString = @iAddShippingErrString output  select @iError = @@error  if ((@iStatus <> 0) or (@iAddShippingErrState <> 0) or (@iError <> 0))  begin  select @oErrString = rtrim(@oErrString) + ' ' + @iAddShippingErrString  select @O_iErrorState = 9175     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  end end  if (@exists = 0) begin  exec @iStatus = DYNAMICS..tasmGetNextNoteIndex  @I_sCompanyID = @sCompanyID,  @I_iSQLSessionID = 0,  @I_noteincrement = 1,  @O_mNoteIndex = @nNextNoteIndex output,  @O_iErrorState = @iGetNextNoteIdxErrState output  select @iError = @@error  if ((@iStatus <> 0) or (@iGetNextNoteIdxErrState <> 0) or (@iError <> 0))  begin  select @oErrString = rtrim(@oErrString) + ' ' + @iGetNextNoteIdxErrState  select @O_iErrorState = 7848    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  select @I_vTRDDISCT = @I_vTRDDISCT * 100,  @I_vMINPYPCT = @I_vMINPYPCT * 100  if (@exists = 0) begin  insert PM00200  (  VENDORID,  VENDNAME,  VNDCHKNM,  VENDSHNM,  VADDCDPR,  VADCDPAD,  VADCDSFR,  VADCDTRO,  VNDCLSID,  VNDCNTCT,  ADDRESS1,  ADDRESS2,  ADDRESS3,  CITY,  STATE,  ZIPCODE,  COUNTRY,  PHNUMBR1,  PHNUMBR2,  PHONE3,  FAXNUMBR,  UPSZONE,  SHIPMTHD,  TAXSCHID,  ACNMVNDR,  TXIDNMBR,  VENDSTTS,  CURNCYID,  TXRGNNUM,  PARVENID,  TRDDISCT,  TEN99TYPE,  TEN99BOXNUMBER,  MINORDER,  PYMTRMID,  MINPYTYP,  MINPYPCT,  MINPYDLR,  MXIAFVND,  MAXINDLR,  COMMENT1,  COMMENT2,  USERDEF1,  USERDEF2,  CRLMTDLR,  PYMNTPRI,  KPCALHST,  KGLDSTHS,  KPERHIST,  KPTRXHST,  HOLD,  PTCSHACF,  CREDTLMT,  WRITEOFF,  MXWOFAMT,  SBPPSDED,  PPSTAXRT,  DXVARNUM,  CRTCOMDT,  CRTEXPDT,  RTOBUTKN,  XPDTOBLG,  PRSPAYEE,  PMAPINDX,  PMCSHIDX,  PMDAVIDX,  PMDTKIDX,  PMFINIDX,  PMMSCHIX,  PMFRTIDX,  PMTAXIDX,  PMWRTIDX,  PMPRCHIX,  PMRTNGIX,  PMTDSCIX,  ACPURIDX,  PURPVIDX,  NOTEINDX,  CHEKBKID,  MODIFDT,  CREATDDT,  RATETPID,  Revalue_Vendor,  Post_Results_To,  FREEONBOARD,  GOVCRPID,  GOVINDID,  DISGRPER,  DUEGRPER,  DOCFMTID,  TaxInvRecvd,  USERLANG,  WithholdingType,  WithholdingFormType,  WithholdingEntityType,  TaxFileNumMode,  BRTHDATE,  LaborPmtType,  CCode,  DECLID,  CBVAT,  Workflow_Approval_Status,  Workflow_Priority,  Workflow_Status  )  select  @I_vVENDORID,    @I_vVENDNAME,    @I_vVNDCHKNM,    @I_vVENDSHNM,    @I_vVADDCDPR,    @I_vVADCDPAD,    @I_vVADCDSFR,    @I_vVADCDTRO,    @I_vVNDCLSID,    @I_vVNDCNTCT,    @I_vADDRESS1,    @I_vADDRESS2,    @I_vADDRESS3,    @I_vCITY,    @I_vSTATE,    @I_vZIPCODE,    @I_vCOUNTRY,    @I_vPHNUMBR1,    @I_vPHNUMBR2,    @I_vPHNUMBR3,    @I_vFAXNUMBR,    @I_vUPSZONE,    @I_vSHIPMTHD,    @I_vTAXSCHID,    @I_vACNMVNDR,    @I_vTXIDNMBR,    @I_vVENDSTTS,    @I_vCURNCYID,    @I_vTXRGNNUM,    '',     @I_vTRDDISCT,    @I_vTEN99TYPE,    @I_vTEN99BOXNUMBER,   @I_vMINORDER,    @I_vPYMTRMID,    @I_vMINPYTYP,    @I_vMINPYPCT,    @I_vMINPYDLR,    @I_vMXIAFVND,    @I_vMAXINDLR,    @I_vCOMMENT1,    @I_vCOMMENT2,    @I_vUSERDEF1,    @I_vUSERDEF2,    @I_vCRLMTDLR,    @I_vPYMNTPRI,    @I_vKPCALHST,    @I_vKGLDSTHS,    @I_vKPERHIST,    @I_vKPTRXHST,    @I_vHOLD,    @I_vPTCSHACF,    @I_vCREDTLMT,    @I_vWRITEOFF,    @I_vMXWOFAMT,    0,     0,     '',     '',     '',     0,     0,     0,     @PMAPINDX,    @PMCSHIDX,    @PMDAVIDX,    @PMDTKIDX,    @PMFINIDX,    @PMMSCHIX,    @PMFRTIDX,    @PMTAXIDX,    @PMWRTIDX,    @PMPRCHIX,    0,     @PMTDSCIX,    @ACPURIDX,    @PURPVIDX,    @nNextNoteIndex,   @I_vCHEKBKID,    @ActualDate,    @ActualDate,    @I_vRATETPID,    @I_vRevalue_Vendor,   @I_vPost_Results_To,   @I_vFREEONBOARD,   '',     '',     @I_vDISGRPER,    @I_vDUEGRPER,    '',     0,     @I_vUSERLANG,    0,     0,     0,     0,     '',     0,     @I_vCCode,    '',     0,     @Workflow_Approval_Status,     @Workflow_Priority,     @Workflow_Status  if (@@error <> 0)  begin  select @O_iErrorState = 994     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end else begin  update PM00200 set   VENDNAME = @I_vVENDNAME,  VNDCHKNM = @I_vVNDCHKNM,  VENDSHNM = @I_vVENDSHNM,  VADDCDPR = @I_vVADDCDPR,  VADCDPAD = @I_vVADCDPAD,  VADCDSFR = @I_vVADCDSFR,  VADCDTRO = @I_vVADCDTRO,  VNDCLSID = @I_vVNDCLSID,  VNDCNTCT = @I_vVNDCNTCT,  ADDRESS1 = @I_vADDRESS1,  ADDRESS2 = @I_vADDRESS2,  ADDRESS3 = @I_vADDRESS3,  CITY = @I_vCITY,  STATE = @I_vSTATE,  ZIPCODE = @I_vZIPCODE,  COUNTRY = @I_vCOUNTRY,  PHNUMBR1 = @I_vPHNUMBR1,  PHNUMBR2 = @I_vPHNUMBR2,  PHONE3 = @I_vPHNUMBR3,  FAXNUMBR = @I_vFAXNUMBR,  UPSZONE = @I_vUPSZONE,  SHIPMTHD = @I_vSHIPMTHD,  TAXSCHID = @I_vTAXSCHID,  ACNMVNDR = @I_vACNMVNDR,  TXIDNMBR = @I_vTXIDNMBR,  VENDSTTS = @I_vVENDSTTS,  CURNCYID = @I_vCURNCYID,  TXRGNNUM = @I_vTXRGNNUM,  TRDDISCT = @I_vTRDDISCT,  TEN99TYPE = @I_vTEN99TYPE,  TEN99BOXNUMBER = @I_vTEN99BOXNUMBER,  MINORDER = @I_vMINORDER,  PYMTRMID = @I_vPYMTRMID,  MINPYTYP = @I_vMINPYTYP,  MINPYPCT = @I_vMINPYPCT,  MINPYDLR = @I_vMINPYDLR,  MXIAFVND = @I_vMXIAFVND,  MAXINDLR = @I_vMAXINDLR,  COMMENT1 = @I_vCOMMENT1,  COMMENT2 = @I_vCOMMENT2,  USERDEF1 = @I_vUSERDEF1,  USERDEF2 = @I_vUSERDEF2,  CRLMTDLR = @I_vCRLMTDLR,  PYMNTPRI = @I_vPYMNTPRI,  KPCALHST = @I_vKPCALHST,  KGLDSTHS = @I_vKGLDSTHS,  KPERHIST = @I_vKPERHIST,  KPTRXHST = @I_vKPTRXHST,  HOLD = @I_vHOLD,  PTCSHACF = @I_vPTCSHACF,  CREDTLMT = @I_vCREDTLMT,  WRITEOFF = @I_vWRITEOFF,  MXWOFAMT = @I_vMXWOFAMT,  PMAPINDX = @PMAPINDX,  PMCSHIDX = @PMCSHIDX,  PMDAVIDX = @PMDAVIDX,  PMDTKIDX = @PMDTKIDX,  PMFINIDX = @PMFINIDX,  PMMSCHIX = @PMMSCHIX,  PMFRTIDX = @PMFRTIDX,  PMTAXIDX = @PMTAXIDX,  PMWRTIDX = @PMWRTIDX,  PMPRCHIX = @PMPRCHIX,  PMTDSCIX = @PMTDSCIX,  ACPURIDX = @ACPURIDX,  PURPVIDX = @PURPVIDX,  NOTEINDX = @nNextNoteIndex,  CHEKBKID = @I_vCHEKBKID,  MODIFDT = @ActualDate,  RATETPID = @I_vRATETPID,  Revalue_Vendor = @I_vRevalue_Vendor,  Post_Results_To = @I_vPost_Results_To,  FREEONBOARD = @I_vFREEONBOARD,  DISGRPER = @I_vDISGRPER,  DUEGRPER = @I_vDUEGRPER,  USERLANG = @I_vUSERLANG,  CCode = @I_vCCode,  Workflow_Approval_Status = @Workflow_Approval_Status,   Workflow_Priority = @Workflow_Priority,  Workflow_Status = @Workflow_Status  where VENDORID = @I_vVENDORID  if (@@error <> 0)  begin  select @O_iErrorState = 993     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  if (@I_vNOTETEXT <> '') begin  if (not exists(select top 1 NOTEINDX from SY03900 (nolock) where NOTEINDX = @nNextNoteIndex))  begin  insert SY03900   (  NOTEINDX,   DATE1,   TIME1,   TXTFIELD  )   select   @nNextNoteIndex,  @ActualDate,  @ActualTime,  @I_vNOTETEXT  if (@@error <> 0)  begin  select @O_iErrorState = 7849    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  end  else  begin  update SY03900 set  DATE1 = @ActualDate,  TIME1 = @ActualTime,  TXTFIELD = @I_vNOTETEXT  where NOTEINDX = @nNextNoteIndex  if (@@error <> 0)  begin  select @O_iErrorState = 1313    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  end end else begin  delete SY03900 where NOTEINDX = @nNextNoteIndex  if (@@error <> 0)  begin  select @O_iErrorState = 7887    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  if (@I_vVADDCDPR <> '') begin  if (not exists(select 1 from PM00300 (nolock) where VENDORID = @I_vVENDORID and ADRSCODE = @I_vVADDCDPR))  begin  if (@I_vCreateAddress = 0)  begin  select @O_iErrorState = 9141     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  else  begin  exec @iStatus = taCreateVendorAddress  @I_vVENDORID = @I_vVENDORID,  @I_vADRSCODE = @I_vVADDCDPR,  @I_vVNDCNTCT = @I_vVNDCNTCT,  @I_vADDRESS1 = @I_vADDRESS1,  @I_vADDRESS2 = @I_vADDRESS2,  @I_vADDRESS3 = @I_vADDRESS3,  @I_vCITY = @I_vCITY,  @I_vSTATE = @I_vSTATE,  @I_vZIPCODE = @I_vZIPCODE,  @I_vCOUNTRY = @I_vCOUNTRY,  @I_vUPSZONE = @I_vUPSZONE,  @I_vPHNUMBR1 = @I_vPHNUMBR1,  @I_vPHNUMBR2 = @I_vPHNUMBR2,  @I_vPHNUMBR3 = @I_vPHNUMBR3,  @I_vFAXNUMBR = @I_vFAXNUMBR,  @I_vSHIPMTHD = @I_vSHIPMTHD,  @I_vTAXSCHID = @I_vTAXSCHID,  @I_vCCode = @I_vCCode,  @I_vRequesterTrx = 1,  @O_iErrorState = @iAddAddressErrState output,  @oErrString = @iAddAddressErrString output  select @iError = @@error  if ((@iStatus <> 0) or (@iAddAddressErrState <> 0) or (@iError <> 0))  begin  select @oErrString = rtrim(@oErrString) + ' ' + @iAddAddressErrString  select @O_iErrorState = 173     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  end  end  else  begin  if (@I_vUpdateIfExists = 1)  begin  exec @iStatus = taCreateVendorAddress  @I_vVENDORID = @I_vVENDORID,  @I_vADRSCODE = @I_vVADDCDPR,  @I_vVNDCNTCT = @I_vVNDCNTCT,  @I_vADDRESS1 = @I_vADDRESS1,  @I_vADDRESS2 = @I_vADDRESS2,  @I_vADDRESS3 = @I_vADDRESS3,  @I_vCITY = @I_vCITY,  @I_vSTATE = @I_vSTATE,  @I_vZIPCODE = @I_vZIPCODE,  @I_vCOUNTRY = @I_vCOUNTRY,  @I_vUPSZONE = @I_vUPSZONE,  @I_vPHNUMBR1 = @I_vPHNUMBR1,  @I_vPHNUMBR2 = @I_vPHNUMBR2,  @I_vPHNUMBR3 = @I_vPHNUMBR3,  @I_vFAXNUMBR = @I_vFAXNUMBR,  @I_vSHIPMTHD = @I_vSHIPMTHD,  @I_vTAXSCHID = @I_vTAXSCHID,  @I_vCCode = @I_vCCode,  @I_vRequesterTrx = 1,  @O_iErrorState = @iAddAddressErrState output,  @oErrString = @iAddAddressErrString output  select @iError = @@error  if ((@iStatus <> 0) or (@iAddAddressErrState <> 0) or (@iError <> 0))  begin  select @oErrString = rtrim(@oErrString) + ' ' + @iAddAddressErrString  select @O_iErrorState = 3693     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  end  end end  if (@I_vVADCDPAD <> '') begin  if (not exists(select 1 from PM00300 (nolock) where VENDORID = @I_vVENDORID and ADRSCODE = @I_vVADCDPAD))  begin  if (@I_vCreateAddress = 0)  begin  select @O_iErrorState = 9142     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  else  begin  exec @iStatus = taCreateVendorAddress  @I_vVENDORID = @I_vVENDORID,  @I_vADRSCODE = @I_vVADCDPAD,  @I_vRequesterTrx = 1,  @O_iErrorState = @iAddAddressErrState output,  @oErrString = @iAddAddressErrString output  select @iError = @@error  if ((@iStatus <> 0) or (@iAddAddressErrState <> 0) or (@iError <> 0))  begin  select @oErrString = rtrim(@oErrString) + ' ' + @iAddAddressErrString  select @O_iErrorState = 174     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  end  end end  if (@I_vVADCDTRO <> '') begin  if (not exists(select 1 from PM00300 (nolock) where VENDORID = @I_vVENDORID and ADRSCODE = @I_vVADCDTRO))  begin  if (@I_vCreateAddress = 0)  begin  select @O_iErrorState = 9143     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  else  begin  exec @iStatus = taCreateVendorAddress  @I_vVENDORID = @I_vVENDORID,  @I_vADRSCODE = @I_vVADCDTRO,  @I_vRequesterTrx = 1,  @O_iErrorState = @iAddAddressErrState output,  @oErrString = @iAddAddressErrString output  select @iError = @@error  if ((@iStatus <> 0) or (@iAddAddressErrState <> 0) or (@iError <> 0))  begin  select @oErrString = rtrim(@oErrString) + ' ' + @iAddAddressErrString  select @O_iErrorState = 916     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  end  end end  if (@I_vVADCDSFR <> '') begin  if (not exists(select 1 from PM00300 (nolock) where VENDORID = @I_vVENDORID and ADRSCODE = @I_vVADCDSFR))  begin  if (@I_vCreateAddress = 0)  begin  select @O_iErrorState = 9144     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  else  begin  exec @iStatus = taCreateVendorAddress  @I_vVENDORID = @I_vVENDORID,  @I_vADRSCODE = @I_vVADCDSFR,  @I_vRequesterTrx = 1,  @O_iErrorState = @iAddAddressErrState output,  @oErrString = @iAddAddressErrString output  select @iError = @@error  if ((@iStatus <> 0) or (@iAddAddressErrState <> 0) or (@iError <> 0))  begin  select @oErrString = rtrim(@oErrString) + ' ' + @iAddAddressErrString  select @O_iErrorState = 926     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  end  end end  if (@O_iErrorState <> 0) begin  return (@O_iErrorState) end  exec @iStatus = taUpdateCreateVendorRcdPost  @I_vVENDORID,  @I_vVENDNAME,  @I_vVENDSHNM,  @I_vVNDCHKNM,  @I_vHOLD,  @I_vVENDSTTS,  @I_vVNDCLSID,  @I_vVADDCDPR,  @I_vVNDCNTCT,  @I_vADDRESS1,  @I_vADDRESS2,  @I_vADDRESS3,  @I_vCITY,  @I_vSTATE,  @I_vZIPCODE,  @I_vCCode,  @I_vCOUNTRY,  @I_vPHNUMBR1,  @I_vPHNUMBR2,  @I_vPHNUMBR3,  @I_vFAXNUMBR,  @I_vTAXSCHID,  @I_vSHIPMTHD,  @I_vUPSZONE,  @I_vVADCDPAD,  @I_vVADCDTRO,  @I_vVADCDSFR,  @I_vACNMVNDR,  @I_vCOMMENT1,  @I_vCOMMENT2,  @I_vNOTETEXT,  @I_vCURNCYID,  @I_vRATETPID,  @I_vPYMTRMID,  @I_vDISGRPER,  @I_vDUEGRPER,  @I_vPYMNTPRI,  @I_vMINORDER,  @I_vTRDDISCT,  @I_vTXIDNMBR,  @I_vTXRGNNUM,  @I_vCHEKBKID,  @I_vUSERDEF1,  @I_vUSERDEF2,  @I_vTEN99TYPE,  @I_vTEN99BOXNUMBER,  @I_vFREEONBOARD,  @I_vUSERLANG,  @I_vMINPYTYP,  @I_vMINPYDLR,  @I_vMINPYPCT,  @I_vMXIAFVND,  @I_vMAXINDLR,  @I_vCREDTLMT,  @I_vCRLMTDLR,  @I_vWRITEOFF,  @I_vMXWOFAMT,  @I_vRevalue_Vendor,  @I_vPost_Results_To,  @I_vKPCALHST,  @I_vKPERHIST,  @I_vKPTRXHST,  @I_vKGLDSTHS,  @I_vPTCSHACF,  @I_vPMCSHACTNUMST,  @I_vPMAPACTNUMST,  @I_vPMDAVACTNUMST,  @I_vPMDTKACTNUMST,  @I_vPMFINACTNUMST,  @I_vPMPRCHACTNUMST,  @I_vPMTDSCACTNUMST,  @I_vPMMSCHACTNUMST,  @I_vPMFRTACTNUMST,  @I_vPMTAXACTNUMST,  @I_vPMWRTACTNUMST,  @I_vACPURACTNUMST,  @I_vPURPVACTNUMST,  @I_vUseVendorClass,  @I_vCreateAddress,  @I_vUpdateIfExists,  @I_vRequesterTrx,  @I_vUSRDEFND1,  @I_vUSRDEFND2,  @I_vUSRDEFND3,  @I_vUSRDEFND4,  @I_vUSRDEFND5,  @O_iErrorState = @iCustomState output,  @oErrString = @iCustomErrString output select @iError = @@error if ((@iStatus <> 0) or (@iCustomState <> 0) or (@iError <> 0)) begin  select @oErrString = rtrim(@oErrString) + ' ' + @iCustomErrString  select @O_iErrorState = 76    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if (@I_vRequesterTrx = 0) begin  exec @iStatus = eConnectOutVerify  @I_vDOCTYPE = 'Vendor',  @I_vINDEX1 = @I_vVENDORID,  @I_vINDEX2 = '',  @I_vINDEX3 = '',  @I_vINDEX4 = '',  @I_vINDEX5 = '',  @I_vINDEX6 = '',  @I_vINDEX7 = '',  @I_vINDEX8 = '',  @I_vINDEX9 = '',  @I_vINDEX10 = '',  @I_vINDEX11 = '',  @I_vINDEX12 = '',  @I_vINDEX13 = '',  @I_vINDEX14 = '',  @I_vINDEX15 = '',  @I_vDelete = 1,  @O_iErrorState = @iCustomState output  select @iError = @@error  if ((@iStatus <> 0) or (@iCustomState <> 0) or (@iError <> 0))  begin  select @oErrString = rtrim(@oErrString) + ' ' + @iCustomState  select @O_iErrorState = 2030    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end end  return (@O_iErrorState)   
GO
GRANT EXECUTE ON  [dbo].[taUpdateCreateVendorRcd] TO [DYNGRP]
GO
