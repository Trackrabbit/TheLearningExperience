SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyPA3] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255), @DestCMPANYID smallint, @SourcCMPANYID smallint, @DestCMPNYNAM varchar(65) select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '', @DestCMPANYID = 0, @SourcCMPANYID = 0, @DestCMPNYNAM = '' select @DestCMPANYID = CMPANYID, @DestCMPNYNAM = CMPNYNAM from DYNAMICS..SY01500 where INTERID = @I_vToCompany select @SourcCMPANYID = CMPANYID from DYNAMICS..SY01500 where INTERID = @I_vFromCompany if (@I_vData = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01301' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01301 ( [PAPROJNUMBER],[PACOSTCATID],[PATU],[PAIV_Item_Checkbox],[PASTAT],[PAProfitType], [PAbllngtype],[PABase_Qty],[PABase_Unit_Cost],[PABaseProfitAmount],[PABaseOvhdCost],[PAForecastBaseOvrhdAmt], [PAForecastBaseQty],[PAForecastBaseUnitCost],[PAForecastBaseProfitAmt],[PABBeginDate],[PABEndDate],[PABQuantity], [PABUnitCost],[PABTotalCost],[PABBillings],[PABProfit],[PABProfitAmt],[PABProfitPcnt], [PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PABaselinePTaxOptions],[PABaselineCTaxSchedID],[PABaselineSTaxOptions], [PABaselineBTaxSchedID],[PAACTUALBEGDATE],[PA_Actual_End_Date],[PAFBeginDate],[PAFEndDate],[PAFQuantity], [PAFUnitCost],[PAFTotalCost],[PAFBillings],[PAFProfit],[PAFTaxPaidAmt],[PAFTaxChargedAmt], [PAFProfitAmt],[PAFProfitPcnt],[PAForecastOvhdCost],[PAForecastPTaxOptions],[PAForecastCTaxSchedID],[PAForecastSTaxOptions], [PAForecastBTaxSchedID],[PAUnit_of_Measure],[UOMSCHDL],[PAUOfMMult],[DECPLQTY],[PAPay_Code_Hourly], [PAPay_Code_Salary],[DECPLCUR],[PALabor_Rate_Table_ID],[PALabor_RateTable_Type],[PALabor_Rate_Table_Acc],[PAEquip_Rate_Table_ID], [PAEquip_Rate_Table_Acc],[TM_WIP_SRC],[TM_COGS_SRC],[TM_Cost_Contra_SRC],[TM_Unbilled_AR_SRC],[TM_Unbilled_Rev_SRC], [TM_AR_SRC],[TM_Prj_Rev_SRC],[TM_OVHD_SRC],[FF_WIP_SRC],[FF_Cost_Contra_SRC],[FF_AR_SRC], [FF_Prj_Billings_SRC],[FF_Prj_Expense_SRC],[FF_Prj_Revenue_SRC],[FF_Prj_Loss_SRC],[FF_BIEE_SRC],[FF_EIEB_SRC], [FF_OVHD_SRC],[PAProject_Amount],[PAOverheadRateMethod],[PABaselineOvhdAmtPerUnit],[PABaselineOvrhdPct],[PAForecastOvrhdAmtPerUnt], [PAForecastOvrhdPct],[PAUBeginDate],[PAUEndDate],[PAUnpostedQty],[PAUnpostedTotalCostN],[PAUnposted_Overhead], [PAUnpostedProfitN],[PAUnposted_Tax_Amount],[PAUnpostAccrRevN],[PAUnpostedCommitedQty],[PAUnpostedCommitedCost],[PAUnpostedCommitedTaxAmt], [PAUNPOSTBIEEAMOUNT],[PAUNPEIEBAMOUNT],[PAunpostbillamt],[PAPostedQty],[PAPostedTotalCostN],[PAPosted_Overhead], [PAPostedProfitN],[PAPosted_Tax_Amount],[PAPosted_Accr_RevN],[PAPostedCommitedQty],[PAPostedCommitedCost],[PAPostedCommitedTaxAmt], [PAPostRecogRevN],[PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PApostbillamt],[PAWrite_UpDown_Amount],[PABilled_QtyN], [PABilled_Cost],[PABilled_Accrued_Revenu],[PACostPcntCompleted],[PAQuantityPcntCompleted],[PA_Receipts_Amount],[PA_Actual_Receipts_Amoun], [PA_Earnings],[PA_Cost_of_Earnings],[PAUnpostBillN],[PAUnpostDiscDolAmtN],[PAUnposted_Sales_Tax_Am],[PAPostedBillingsN], [PAPostedDiscDolAmtN],[PAPosted_Sales_Tax_Amou],[PABCWPAMT],[PABCWSAMT],[PAACWPAMT],[LNITMSEQ], [PALineItemSeq],[PAbillnoteidx],[PAUnpostedRecogRevN],[PAApproved_Accrued_Reve],[PAApproved_Cost],[PAApproved_Quantity], [PACommitted_Costs],[PACommitted_Qty],[PAPOQty],[PAPOCost],[PAPOPostedQty],[PAPOPostedCost], [WROFAMNT],[ActualWriteOffAmount],[DISTKNAM],[ActualDiscTakenAmount],[PAsfid],[PAPreviouslyOpen], [PAtaxpaidamt],[PAPostedTaxPaidN],[PAPOSTRETAMT],[PAUNPOSTRETAMT],[PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt], [PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PACHGORDNO],[PAUNAPPRVPROJAMT],[PAUNAPFRTOTBILL],[PAUNAPPFRTOTCST], [PAUNFRCTOTPROF],[PAUNPFRTOTQTY],[PAUNABSTOTBILL],[PAUNPBSTOTCST],[PAUNPBSLTOTPROF],[PAUNPBSTOTQTY], [PATOTCHGORDAMT],[PAPosted_Earnings],[PAActualCostofEarnings],[PAUnpostedLossAmount],[PAActualLossAmount],[PAMCCURNCYID], [PAMCBProfitAmt],[PAMCBBillings],[PAMCFProfitAmt],[PAMCFBillings],[PAMCBaseProfitAmount],[PAMCForecastBProfitAmt], [PAMCProjectAmount],[PAMCActualBillings],[PAMCActualDiscountAmt],[PAMCActualSalesTaxAmt],[PAMCUnpostBillN],[PAMCUnpostedDiscount], [PAMCUnpostedSalesTax],[PABILLMIN],[PAMCBILLMIN] ) select [PAPROJNUMBER],[PACOSTCATID],[PATU],[PAIV_Item_Checkbox],[PASTAT],[PAProfitType], [PAbllngtype],[PABase_Qty],[PABase_Unit_Cost],[PABaseProfitAmount],[PABaseOvhdCost],[PAForecastBaseOvrhdAmt], [PAForecastBaseQty],[PAForecastBaseUnitCost],[PAForecastBaseProfitAmt],[PABBeginDate],[PABEndDate],[PABQuantity], [PABUnitCost],[PABTotalCost],[PABBillings],[PABProfit],[PABProfitAmt],[PABProfitPcnt], [PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PABaselinePTaxOptions],[PABaselineCTaxSchedID],[PABaselineSTaxOptions], [PABaselineBTaxSchedID],[PAACTUALBEGDATE],[PA_Actual_End_Date],[PAFBeginDate],[PAFEndDate],[PAFQuantity], [PAFUnitCost],[PAFTotalCost],[PAFBillings],[PAFProfit],[PAFTaxPaidAmt],[PAFTaxChargedAmt], [PAFProfitAmt],[PAFProfitPcnt],[PAForecastOvhdCost],[PAForecastPTaxOptions],[PAForecastCTaxSchedID],[PAForecastSTaxOptions], [PAForecastBTaxSchedID],[PAUnit_of_Measure],[UOMSCHDL],[PAUOfMMult],[DECPLQTY],[PAPay_Code_Hourly], [PAPay_Code_Salary],[DECPLCUR],[PALabor_Rate_Table_ID],[PALabor_RateTable_Type],[PALabor_Rate_Table_Acc],[PAEquip_Rate_Table_ID], [PAEquip_Rate_Table_Acc],[TM_WIP_SRC],[TM_COGS_SRC],[TM_Cost_Contra_SRC],[TM_Unbilled_AR_SRC],[TM_Unbilled_Rev_SRC], [TM_AR_SRC],[TM_Prj_Rev_SRC],[TM_OVHD_SRC],[FF_WIP_SRC],[FF_Cost_Contra_SRC],[FF_AR_SRC], [FF_Prj_Billings_SRC],[FF_Prj_Expense_SRC],[FF_Prj_Revenue_SRC],[FF_Prj_Loss_SRC],[FF_BIEE_SRC],[FF_EIEB_SRC], [FF_OVHD_SRC],[PAProject_Amount],[PAOverheadRateMethod],[PABaselineOvhdAmtPerUnit],[PABaselineOvrhdPct],[PAForecastOvrhdAmtPerUnt], [PAForecastOvrhdPct],[PAUBeginDate],[PAUEndDate],[PAUnpostedQty],[PAUnpostedTotalCostN],[PAUnposted_Overhead], [PAUnpostedProfitN],[PAUnposted_Tax_Amount],[PAUnpostAccrRevN],[PAUnpostedCommitedQty],[PAUnpostedCommitedCost],[PAUnpostedCommitedTaxAmt], [PAUNPOSTBIEEAMOUNT],[PAUNPEIEBAMOUNT],[PAunpostbillamt],[PAPostedQty],[PAPostedTotalCostN],[PAPosted_Overhead], [PAPostedProfitN],[PAPosted_Tax_Amount],[PAPosted_Accr_RevN],[PAPostedCommitedQty],[PAPostedCommitedCost],[PAPostedCommitedTaxAmt], [PAPostRecogRevN],[PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PApostbillamt],[PAWrite_UpDown_Amount],[PABilled_QtyN], [PABilled_Cost],[PABilled_Accrued_Revenu],[PACostPcntCompleted],[PAQuantityPcntCompleted],[PA_Receipts_Amount],[PA_Actual_Receipts_Amoun], [PA_Earnings],[PA_Cost_of_Earnings],[PAUnpostBillN],[PAUnpostDiscDolAmtN],[PAUnposted_Sales_Tax_Am],[PAPostedBillingsN], [PAPostedDiscDolAmtN],[PAPosted_Sales_Tax_Amou],[PABCWPAMT],[PABCWSAMT],[PAACWPAMT],[LNITMSEQ], [PALineItemSeq],[PAbillnoteidx],[PAUnpostedRecogRevN],[PAApproved_Accrued_Reve],[PAApproved_Cost],[PAApproved_Quantity], [PACommitted_Costs],[PACommitted_Qty],[PAPOQty],[PAPOCost],[PAPOPostedQty],[PAPOPostedCost], [WROFAMNT],[ActualWriteOffAmount],[DISTKNAM],[ActualDiscTakenAmount],[PAsfid],[PAPreviouslyOpen], [PAtaxpaidamt],[PAPostedTaxPaidN],[PAPOSTRETAMT],[PAUNPOSTRETAMT],[PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt], [PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PACHGORDNO],[PAUNAPPRVPROJAMT],[PAUNAPFRTOTBILL],[PAUNAPPFRTOTCST], [PAUNFRCTOTPROF],[PAUNPFRTOTQTY],[PAUNABSTOTBILL],[PAUNPBSTOTCST],[PAUNPBSLTOTPROF],[PAUNPBSTOTQTY], [PATOTCHGORDAMT],[PAPosted_Earnings],[PAActualCostofEarnings],[PAUnpostedLossAmount],[PAActualLossAmount],[PAMCCURNCYID], [PAMCBProfitAmt],[PAMCBBillings],[PAMCFProfitAmt],[PAMCFBillings],[PAMCBaseProfitAmount],[PAMCForecastBProfitAmt], [PAMCProjectAmount],[PAMCActualBillings],[PAMCActualDiscountAmt],[PAMCActualSalesTaxAmt],[PAMCUnpostBillN],[PAMCUnpostedDiscount], [PAMCUnpostedSalesTax],[PABILLMIN],[PAMCBILLMIN] from ' + rtrim(@I_vFromCompany) + '..PA01301 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01303' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01303 ( [PAPROJNUMBER],[PACOSTCATID],[ITEMNMBR],[PABase_Qty],[PABase_Unit_Cost],[PABaseProfitAmount], [PABaseOvhdCost],[PABQuantity],[PAForecastBaseQty],[PAForecastBaseUnitCost],[PAForecastBaseProfitAmt],[PABUnitCost], [PABTotalCost],[PABBillings],[PABProfitAmt],[PABaselineOvhdCost],[PABTaxPaidAmt],[PABTaxChargedAmt], [PABaselinePTaxOptions],[PABaselineCTaxSchedID],[PABaselineSTaxOptions],[PABaselineBTaxSchedID],[PAFQuantity],[PAFUnitCost], [PAFTotalCost],[PAFBillings],[PAFProfitAmt],[PAForecastOvhdCost],[PAFTaxPaidAmt],[PAFTaxChargedAmt], [PAForecastPTaxOptions],[PAForecastCTaxSchedID],[PAForecastSTaxOptions],[PAForecastBTaxSchedID],[UOFM],[UOMSCHDL], [PRICELVL],[PAUOfMMult],[PAbllngtype],[PAbillnoteidx],[DECPLCUR],[DECPLQTY], [PAPostedQty],[PApstdcosts],[PAPosted_Accr_RevN],[PAPosted_Return_QTY],[PAPosted_Return_Costs],[PAActualReturnAccrRev], [PAunpcosts],[PAUnpQty],[PAUnpostAccrRevN],[PAUnposted_Return_QTY],[PAUnposted_Return_Cost],[PAUnpostedReturnAccrRev], [PAPOCost],[PAPOQty],[PACommitted_Costs],[PACommitted_Qty],[PAPOPostedQty],[PAPOPostedCost], [REQDATE],[PALineItemSeq],[PAPostedBillingsN],[PAUnposted_Tax_Amount],[PAPosted_Tax_Amount],[PACHGORDNO] ) select [PAPROJNUMBER],[PACOSTCATID],[ITEMNMBR],[PABase_Qty],[PABase_Unit_Cost],[PABaseProfitAmount], [PABaseOvhdCost],[PABQuantity],[PAForecastBaseQty],[PAForecastBaseUnitCost],[PAForecastBaseProfitAmt],[PABUnitCost], [PABTotalCost],[PABBillings],[PABProfitAmt],[PABaselineOvhdCost],[PABTaxPaidAmt],[PABTaxChargedAmt], [PABaselinePTaxOptions],[PABaselineCTaxSchedID],[PABaselineSTaxOptions],[PABaselineBTaxSchedID],[PAFQuantity],[PAFUnitCost], [PAFTotalCost],[PAFBillings],[PAFProfitAmt],[PAForecastOvhdCost],[PAFTaxPaidAmt],[PAFTaxChargedAmt], [PAForecastPTaxOptions],[PAForecastCTaxSchedID],[PAForecastSTaxOptions],[PAForecastBTaxSchedID],[UOFM],[UOMSCHDL], [PRICELVL],[PAUOfMMult],[PAbllngtype],[PAbillnoteidx],[DECPLCUR],[DECPLQTY], [PAPostedQty],[PApstdcosts],[PAPosted_Accr_RevN],[PAPosted_Return_QTY],[PAPosted_Return_Costs],[PAActualReturnAccrRev], [PAunpcosts],[PAUnpQty],[PAUnpostAccrRevN],[PAUnposted_Return_QTY],[PAUnposted_Return_Cost],[PAUnpostedReturnAccrRev], [PAPOCost],[PAPOQty],[PACommitted_Costs],[PACommitted_Qty],[PAPOPostedQty],[PAPOPostedCost], [REQDATE],[PALineItemSeq],[PAPostedBillingsN],[PAUnposted_Tax_Amount],[PAPosted_Tax_Amount],[PACHGORDNO] from ' + rtrim(@I_vFromCompany) + '..PA01303 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01304' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01304 ( [PAPROJNUMBER],[PATU],[PAsfid],[PACOSTCATID],[PERIODID],[YEAR1], [PAPeriodStartDate],[PAPeriodEndDate],[PERIODDT],[PAACTUALBEGDATE],[PA_Actual_End_Date],[PABQuantity], [PAFeeAmount],[PABUnitCost],[PABTotalCost],[PABProfit],[PABProfitAmt],[PABBillings], [PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PAFQuantity],[PAFUnitCost],[PAFTotalCost], [PAFProfit],[PAFBillings],[PAFTaxPaidAmt],[PAFTaxChargedAmt],[PAForecastOvhdCost],[LNITMSEQ], [PAUnpostedQty],[PAUnpostedTotalCostN],[PAUnposted_Overhead],[PAUnpostedProfitN],[PAUnposted_Tax_Amount],[PAUnpostAccrRevN], [PAUnpostedCommitedQty],[PAUnpostedCommitedCost],[PAUnpostedCommitedTaxAmt],[PAUnpostedRecogRevN],[PAUnposted_Fee_Amount],[PAUNPOSTBIEEAMOUNT], [PAUNPEIEBAMOUNT],[PA_Unposted_Billed_Reten],[PAunpostbillamt],[PAPostedQty],[PAPostedTotalCostN],[PAPosted_Overhead], [PAPostedProfitN],[PAPosted_Tax_Amount],[PAPosted_Accr_RevN],[PAPostedCommitedQty],[PAPostRecogRevN],[PAPostedCommitedCost], [PAPostedCommitedTaxAmt],[PAPosted_Fee_Amount],[PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PA_Actual_Billed_Retenti],[PApostbillamt], [PAWrite_UpDown_Amount],[PAApproved_Quantity],[PARemaining_Quantity],[PABilled_QtyN],[PAApproved_Cost],[PARemaining_Cost], [PABilled_Cost],[PAApproved_Accrued_Reve],[PARemaining_Accrued_Rev],[PABilled_Accrued_Revenu],[PACostPcntCompleted],[PAQuantityPcntCompleted], [PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PA_Earnings],[PA_Cost_of_Earnings],[PAUnpostBillN],[PAUnpostDiscDolAmtN], [PAUnposted_Sales_Tax_Am],[PAPostedBillingsN],[PAPostedDiscDolAmtN],[PAPosted_Sales_Tax_Amou],[WROFAMNT],[ActualWriteOffAmount], [DISTKNAM],[ActualDiscTakenAmount],[PACommitted_Costs],[PACommitted_Qty],[PAPOCost],[PAPOQty], [PAPOPostedCost],[PAPOPostedQty],[PAtaxpaidamt],[PAPostedTaxPaidN],[PAPOSTRETAMT],[PAUNPOSTRETAMT], [PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt],[PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PAPosted_Earnings],[PAActualCostofEarnings], [PAUnpostedLossAmount],[PAActualLossAmount] ) select [PAPROJNUMBER],[PATU],[PAsfid],[PACOSTCATID],[PERIODID],[YEAR1], [PAPeriodStartDate],[PAPeriodEndDate],[PERIODDT],[PAACTUALBEGDATE],[PA_Actual_End_Date],[PABQuantity], [PAFeeAmount],[PABUnitCost],[PABTotalCost],[PABProfit],[PABProfitAmt],[PABBillings], [PABTaxPaidAmt],[PABTaxChargedAmt],[PABaselineOvhdCost],[PAFQuantity],[PAFUnitCost],[PAFTotalCost], [PAFProfit],[PAFBillings],[PAFTaxPaidAmt],[PAFTaxChargedAmt],[PAForecastOvhdCost],[LNITMSEQ], [PAUnpostedQty],[PAUnpostedTotalCostN],[PAUnposted_Overhead],[PAUnpostedProfitN],[PAUnposted_Tax_Amount],[PAUnpostAccrRevN], [PAUnpostedCommitedQty],[PAUnpostedCommitedCost],[PAUnpostedCommitedTaxAmt],[PAUnpostedRecogRevN],[PAUnposted_Fee_Amount],[PAUNPOSTBIEEAMOUNT], [PAUNPEIEBAMOUNT],[PA_Unposted_Billed_Reten],[PAunpostbillamt],[PAPostedQty],[PAPostedTotalCostN],[PAPosted_Overhead], [PAPostedProfitN],[PAPosted_Tax_Amount],[PAPosted_Accr_RevN],[PAPostedCommitedQty],[PAPostRecogRevN],[PAPostedCommitedCost], [PAPostedCommitedTaxAmt],[PAPosted_Fee_Amount],[PAPOSBIEEAMOUNT],[PAPOSEIEBAMOUNT],[PA_Actual_Billed_Retenti],[PApostbillamt], [PAWrite_UpDown_Amount],[PAApproved_Quantity],[PARemaining_Quantity],[PABilled_QtyN],[PAApproved_Cost],[PARemaining_Cost], [PABilled_Cost],[PAApproved_Accrued_Reve],[PARemaining_Accrued_Rev],[PABilled_Accrued_Revenu],[PACostPcntCompleted],[PAQuantityPcntCompleted], [PA_Receipts_Amount],[PA_Actual_Receipts_Amoun],[PA_Earnings],[PA_Cost_of_Earnings],[PAUnpostBillN],[PAUnpostDiscDolAmtN], [PAUnposted_Sales_Tax_Am],[PAPostedBillingsN],[PAPostedDiscDolAmtN],[PAPosted_Sales_Tax_Amou],[WROFAMNT],[ActualWriteOffAmount], [DISTKNAM],[ActualDiscTakenAmount],[PACommitted_Costs],[PACommitted_Qty],[PAPOCost],[PAPOQty], [PAPOPostedCost],[PAPOPostedQty],[PAtaxpaidamt],[PAPostedTaxPaidN],[PAPOSTRETAMT],[PAUNPOSTRETAMT], [PA_Write_Off_Tax_Amount],[PAActualWOTaxAmt],[PA_Terms_Taken_Tax_Amt],[PAActualTermsTakenTax],[PAPosted_Earnings],[PAActualCostofEarnings], [PAUnpostedLossAmount],[PAActualLossAmount] from ' + rtrim(@I_vFromCompany) + '..PA01304 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01402' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01402 ( [PARate_Table_ID],[PADESCRIPTION],[PARate_Table_Date],[PAinactive],[PAProfitType],[NOTEINDX] ) select [PARate_Table_ID],[PADESCRIPTION],[PARate_Table_Date],[PAinactive],[PAProfitType],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..PA01402 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01403' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01403 ( [PARate_Table_ID],[EMPLOYID],[PAPayCode],[PAUnit_of_Measure],[PAUNITCOST],[PAProfitType], [PAProfitAmount],[PAProfitPercent],[PAOverheadRateMethod],[PAOvhdAmtPerUnit],[PAOverheaPercentage],[PAOverhead_Group_ID], [SUTASTAT],[WRKRCOMP],[PA_Orig_Profit_AmtTM],[CURNCYID],[CURRNIDX],[RATETPID], [EXGTBLID],[XCHGRATE],[EXCHDATE],[TIME1],[RTCLCMTD],[DENXRATE], [MCTRXSTT] ) select [PARate_Table_ID],[EMPLOYID],[PAPayCode],[PAUnit_of_Measure],[PAUNITCOST],[PAProfitType], [PAProfitAmount],[PAProfitPercent],[PAOverheadRateMethod],[PAOvhdAmtPerUnit],[PAOverheaPercentage],[PAOverhead_Group_ID], [SUTASTAT],[WRKRCOMP],[PA_Orig_Profit_AmtTM],[CURNCYID],[CURRNIDX],[RATETPID], [EXGTBLID],[XCHGRATE],[EXCHDATE],[TIME1],[RTCLCMTD],[DENXRATE], [MCTRXSTT] from ' + rtrim(@I_vFromCompany) + '..PA01403 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01405' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01405 ( [PARate_Table_ID],[PARate_Table_Date],[PAJob_Title],[PAPayCode],[PAUnit_of_Measure],[PAUNITCOST], [PAProfitType],[PAProfitAmount],[PAProfitPercent],[PAOverhead_Group_ID],[SUTASTAT],[WRKRCOMP], [PA_Orig_Profit_AmtTM],[CURNCYID],[CURRNIDX],[RATETPID],[EXGTBLID],[XCHGRATE], [EXCHDATE],[TIME1],[RTCLCMTD],[DENXRATE],[MCTRXSTT] ) select [PARate_Table_ID],[PARate_Table_Date],[PAJob_Title],[PAPayCode],[PAUnit_of_Measure],[PAUNITCOST], [PAProfitType],[PAProfitAmount],[PAProfitPercent],[PAOverhead_Group_ID],[SUTASTAT],[WRKRCOMP], [PA_Orig_Profit_AmtTM],[CURNCYID],[CURRNIDX],[RATETPID],[EXGTBLID],[XCHGRATE], [EXCHDATE],[TIME1],[RTCLCMTD],[DENXRATE],[MCTRXSTT] from ' + rtrim(@I_vFromCompany) + '..PA01405 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01406' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01406 ( [PARate_Table_ID],[PADESCRIPTION],[PARate_Table_Date],[PAinactive],[PAProfitType],[NOTEINDX] ) select [PARate_Table_ID],[PADESCRIPTION],[PARate_Table_Date],[PAinactive],[PAProfitType],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..PA01406 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01407' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01407 ( [PARate_Table_ID],[PAEQUIPTID],[PAUnit_of_Measure],[PAUNITCOST],[PAProfitType],[PAProfitAmount], [PAProfitPercent],[PAOverhead_Group_ID] ) select [PARate_Table_ID],[PAEQUIPTID],[PAUnit_of_Measure],[PAUNITCOST],[PAProfitType],[PAProfitAmount], [PAProfitPercent],[PAOverhead_Group_ID] from ' + rtrim(@I_vFromCompany) + '..PA01407 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01408' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01408 ( [PACONTNUMBER],[PAPROJNUMBER],[EMPLOYID],[ContractEntry],[ContractInquire],[ContractReport], [ContractReview],[ProjectEntry],[ProjectInquire],[ProjectReport],[ProjectReview],[ALEntry], [ALInquire],[ALReport],[ALReview],[EEEntry],[EEInquire],[EEReport], [EEReview],[ELEntry],[ELInquire],[ELReport],[ELReview],[FFEntry], [FFInquire],[FFReport],[FFReview],[POEntry],[POInquire],[POReport], [RQEntry],[RQInquire],[RQReport],[RQReview],[TSEntry],[TSInquire], [TSReport],[TSReview],[VIEntry],[VIInquire],[VIReport],[VIReview] ) select [PACONTNUMBER],[PAPROJNUMBER],[EMPLOYID],[ContractEntry],[ContractInquire],[ContractReport], [ContractReview],[ProjectEntry],[ProjectInquire],[ProjectReport],[ProjectReview],[ALEntry], [ALInquire],[ALReport],[ALReview],[EEEntry],[EEInquire],[EEReport], [EEReview],[ELEntry],[ELInquire],[ELReport],[ELReview],[FFEntry], [FFInquire],[FFReport],[FFReview],[POEntry],[POInquire],[POReport], [RQEntry],[RQInquire],[RQReport],[RQReview],[TSEntry],[TSInquire], [TSReport],[TSReview],[VIEntry],[VIInquire],[VIReport],[VIReview] from ' + rtrim(@I_vFromCompany) + '..PA01408 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01409' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01409 ( [PAPROJNUMBER],[PAEQUIPTID] ) select [PAPROJNUMBER],[PAEQUIPTID] from ' + rtrim(@I_vFromCompany) + '..PA01409 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA01410' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA01410 ( [PAPROJNUMBER],[CUSTNMBR],[LNITMSEQ],[PRBTADCD],[PAcbdefault] ) select [PAPROJNUMBER],[CUSTNMBR],[LNITMSEQ],[PRBTADCD],[PAcbdefault] from ' + rtrim(@I_vFromCompany) + '..PA01410 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA02000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA02000 ( [PABILLCYCLEID],[PABILLCYCLEDESC],[PABilling_Frequency],[PABillingFreqDetail],[PA_Day1],[PA_Month_Number_1], [PA_Month_Number_2],[PA_Day_Number_1],[PA_Day_Number_2],[PA_Day2],[PADays_Interval],[PADDLDay], [PAPrior_Days_Before_Bi],[PAInclSrvFees],[PA_Include_Project_Fee],[PA_Include_Retainer_Fee],[PAtotcbts],[PAtotcbEL], [PAtotcbML],[PAtotcbvi],[PAtotcber],[PAtotcbinv],[PAtotcbfee],[PAefbillfmt], [NOTEINDX] ) select [PABILLCYCLEID],[PABILLCYCLEDESC],[PABilling_Frequency],[PABillingFreqDetail],[PA_Day1],[PA_Month_Number_1], [PA_Month_Number_2],[PA_Day_Number_1],[PA_Day_Number_2],[PA_Day2],[PADays_Interval],[PADDLDay], [PAPrior_Days_Before_Bi],[PAInclSrvFees],[PA_Include_Project_Fee],[PA_Include_Retainer_Fee],[PAtotcbts],[PAtotcbEL], [PAtotcbML],[PAtotcbvi],[PAtotcber],[PAtotcbinv],[PAtotcbfee],[PAefbillfmt], [NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..PA02000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA02010' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA02010 ( [PABILLCYCLEID1],[PABILLCYCLEDESC1],[NOTEINDX] ) select [PABILLCYCLEID1],[PABILLCYCLEDESC1],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..PA02010 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA02101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA02101 ( [PAPROJNUMBER],[PALineItemSeq],[PAFeeID],[PAFeeName],[PAFeeType],[PAFeeAmount], [PAPercent_Cost],[PAPercent_Revenue],[PA_Retention_Percent],[PAFeeToUse],[PAbilltaxscheduleid],[PASales_Tax_Options], [PAbillnoteidx],[PAbegindate],[PAEnDate],[PAFrequency],[STRTDATE],[ENDDATE], [PARenew],[PARenewal_Date],[PATotAmt],[TM_AR_Fee_SRC],[TM_Prj_Deferred_Rev_Fee_],[TM_Prj_Rev_Fee_SRC], [PAFF_AR_Fee_SRC],[FF_Prj_Billings_Fee_SRC],[FF_Prj_Rev_Fee_SRC],[FF_Retention_Fee_SRC],[FF_WIP_Fee_SRC],[FF_Prj_Deferred_Rev_Fee_], [FF_BIEE_Fee_SRC],[FF_EIEB_Fee_SRC],[PAtotcbts],[PAtotcbEL],[PAtotcbML],[PAtotcbvi], [PAtotcber],[PAtotcbinv],[PA_Renew_Day],[PA_Renew_Month],[PAUD1],[PAUD2], [PACHGORDNO],[PAService_Fee_Amount],[PA_MC_Fee_Amount],[PA_MC_Service_Fee_Amount],[PA_MC_Total_Amount] ) select [PAPROJNUMBER],[PALineItemSeq],[PAFeeID],[PAFeeName],[PAFeeType],[PAFeeAmount], [PAPercent_Cost],[PAPercent_Revenue],[PA_Retention_Percent],[PAFeeToUse],[PAbilltaxscheduleid],[PASales_Tax_Options], [PAbillnoteidx],[PAbegindate],[PAEnDate],[PAFrequency],[STRTDATE],[ENDDATE], [PARenew],[PARenewal_Date],[PATotAmt],[TM_AR_Fee_SRC],[TM_Prj_Deferred_Rev_Fee_],[TM_Prj_Rev_Fee_SRC], [PAFF_AR_Fee_SRC],[FF_Prj_Billings_Fee_SRC],[FF_Prj_Rev_Fee_SRC],[FF_Retention_Fee_SRC],[FF_WIP_Fee_SRC],[FF_Prj_Deferred_Rev_Fee_], [FF_BIEE_Fee_SRC],[FF_EIEB_Fee_SRC],[PAtotcbts],[PAtotcbEL],[PAtotcbML],[PAtotcbvi], [PAtotcber],[PAtotcbinv],[PA_Renew_Day],[PA_Renew_Month],[PAUD1],[PAUD2], [PACHGORDNO],[PAService_Fee_Amount],[PA_MC_Fee_Amount],[PA_MC_Service_Fee_Amount],[PA_MC_Total_Amount] from ' + rtrim(@I_vFromCompany) + '..PA02101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA02301' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA02301 ( [CUSTNMBR],[PABILLCYCLEID],[PABILLFORMAT] ) select [CUSTNMBR],[PABILLCYCLEID],[PABILLFORMAT] from ' + rtrim(@I_vFromCompany) + '..PA02301 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA02401' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA02401 ( [PACONTNUMBER],[PABILLCYCLEID],[PABILLFORMAT] ) select [PACONTNUMBER],[PABILLCYCLEID],[PABILLFORMAT] from ' + rtrim(@I_vFromCompany) + '..PA02401 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..PA02501' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..PA02501 ( [PACONTNUMBER],[PABILLCYCLEID1] ) select [PACONTNUMBER],[PABILLCYCLEID1] from ' + rtrim(@I_vFromCompany) + '..PA02501 ' exec(@cStatement) exec @iStatus = eeCompanyCopyPA4 @I_vFromCompany,			 @I_vToCompany,				 @I_vData,					 @I_vReportOptions,			 @O_iErrorState output		 if ((@iStatus <> 0) or (@O_iErrorState <> 0)) begin select @O_iErrorState = 1  return (@O_iErrorState) end end return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyPA3] TO [DYNGRP]
GO
