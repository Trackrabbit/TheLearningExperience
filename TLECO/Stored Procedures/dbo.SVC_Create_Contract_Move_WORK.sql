SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 Create Procedure [dbo].[SVC_Create_Contract_Move_WORK]  (@UserID char(15),  @ContractRecordType smallint,  @FromContract char(11),@ToContract char(11),  @FromType char(11), @ToType char(11),  @FromCustomer char(15),@ToCustomer char(15),  @CHECKDATE datetime,  @History smallint   )  AS if @ContractRecordType = 3   return  if @History = 1   BEGIN  insert into SVC00670  select   CONSTS,   CONTNBR,   SVC_Contract_Version,  CNTTYPE,   STRTDATE,   ENDDATE,   DATEADD(dd,1,ENDDATE),   ENDDATE,  CUSTNMBR,  ADRSCODE,  0,  0,  0,  RENCNTTYP,  @UserID   from SVC30600 where CONSTS = @ContractRecordType   and CONTNBR >= @FromContract and CONTNBR <= @ToContract   and CUSTNMBR >= @FromCustomer and CUSTNMBR <= @ToCustomer   and CNTTYPE >= @FromType and CNTTYPE <= @ToType  and ENDDATE <= @CHECKDATE   END ELSE   BEGIN  if @ContractRecordType = 1   insert into SVC00670  select CONSTS, CONTNBR, 0,CNTTYPE,STRTDATE,ENDDATE,   STRTDATE,       ENDDATE,  CUSTNMBR,  ADRSCODE,0, 0, 0, RENCNTTYP, @UserID  from SVC00600 where (CONSTS = @ContractRecordType   and CONTNBR >= @FromContract and CONTNBR <= @ToContract   and CUSTNMBR >= @FromCustomer and CUSTNMBR <= @ToCustomer   and CNTTYPE >= @FromType and CNTTYPE <= @ToType )  and STRTDATE >= @CHECKDATE  else  insert into SVC00670  select CONSTS, CONTNBR, 0,CNTTYPE,STRTDATE,ENDDATE,   DATEADD(dd,1,ENDDATE),   CASE   WHEN Contract_Period = 1 THEN DATEADD(dd,Contract_Length,ENDDATE)  WHEN Contract_Period = 2 THEN DATEADD(mm,Contract_Length ,ENDDATE)  WHEN Contract_Period = 3 THEN DATEADD(mm,(Contract_Length * 12), ENDDATE)  END,  CUSTNMBR,  ADRSCODE,0, 0, 0, RENCNTTYP, @UserID  from SVC00600 where (CONSTS = @ContractRecordType   and CONTNBR >= @FromContract and CONTNBR <= @ToContract   and CUSTNMBR >= @FromCustomer and CUSTNMBR <= @ToCustomer   and CNTTYPE >= @FromType and CNTTYPE <= @ToType )  and ENDDATE <= @CHECKDATE  END return    
GO
GRANT EXECUTE ON  [dbo].[SVC_Create_Contract_Move_WORK] TO [DYNGRP]
GO
