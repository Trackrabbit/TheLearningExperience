SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_AF40102N_2] (@BS int, @REPORTID smallint, @HDRFTRTY smallint, @SBHSBFIN smallint, @FLDNUM smallint, @REPORTID_RS smallint, @HDRFTRTY_RS smallint, @SBHSBFIN_RS smallint, @FLDNUM_RS smallint, @REPORTID_RE smallint, @HDRFTRTY_RE smallint, @SBHSBFIN_RE smallint, @FLDNUM_RE smallint) AS  set nocount on IF @REPORTID_RS IS NULL BEGIN SELECT TOP 25  REPORTID, HDRFTRTY, FLDNUM, FLDPOSX1, FLDPOSY1, FLDPOSX2, FLDPOSY2, FLDTYPE, FLDFRMAT, SBHSBFIN, FLDOPT, FLDOPT2, FLDALIGN, FLDFTFML, FLDFTSIZ, FLDSTYLE_1, FLDSTYLE_2, FLDSTYLE_3, FLDSTYLE_4, FLDSTYLE_5, FLDSTYLE_6, FLDVALUE, FLDVALU2, FLDPRNAM, DEX_ROW_ID FROM .AF40102 WHERE ( REPORTID = @REPORTID AND HDRFTRTY = @HDRFTRTY AND SBHSBFIN = @SBHSBFIN AND FLDNUM > @FLDNUM OR REPORTID = @REPORTID AND HDRFTRTY = @HDRFTRTY AND SBHSBFIN > @SBHSBFIN OR REPORTID = @REPORTID AND HDRFTRTY > @HDRFTRTY OR REPORTID > @REPORTID ) ORDER BY REPORTID ASC, HDRFTRTY ASC, SBHSBFIN ASC, FLDNUM ASC END ELSE IF @REPORTID_RS = @REPORTID_RE BEGIN SELECT TOP 25  REPORTID, HDRFTRTY, FLDNUM, FLDPOSX1, FLDPOSY1, FLDPOSX2, FLDPOSY2, FLDTYPE, FLDFRMAT, SBHSBFIN, FLDOPT, FLDOPT2, FLDALIGN, FLDFTFML, FLDFTSIZ, FLDSTYLE_1, FLDSTYLE_2, FLDSTYLE_3, FLDSTYLE_4, FLDSTYLE_5, FLDSTYLE_6, FLDVALUE, FLDVALU2, FLDPRNAM, DEX_ROW_ID FROM .AF40102 WHERE REPORTID = @REPORTID_RS AND HDRFTRTY BETWEEN @HDRFTRTY_RS AND @HDRFTRTY_RE AND SBHSBFIN BETWEEN @SBHSBFIN_RS AND @SBHSBFIN_RE AND FLDNUM BETWEEN @FLDNUM_RS AND @FLDNUM_RE AND ( REPORTID = @REPORTID AND HDRFTRTY = @HDRFTRTY AND SBHSBFIN = @SBHSBFIN AND FLDNUM > @FLDNUM OR REPORTID = @REPORTID AND HDRFTRTY = @HDRFTRTY AND SBHSBFIN > @SBHSBFIN OR REPORTID = @REPORTID AND HDRFTRTY > @HDRFTRTY OR REPORTID > @REPORTID ) ORDER BY REPORTID ASC, HDRFTRTY ASC, SBHSBFIN ASC, FLDNUM ASC END ELSE BEGIN SELECT TOP 25  REPORTID, HDRFTRTY, FLDNUM, FLDPOSX1, FLDPOSY1, FLDPOSX2, FLDPOSY2, FLDTYPE, FLDFRMAT, SBHSBFIN, FLDOPT, FLDOPT2, FLDALIGN, FLDFTFML, FLDFTSIZ, FLDSTYLE_1, FLDSTYLE_2, FLDSTYLE_3, FLDSTYLE_4, FLDSTYLE_5, FLDSTYLE_6, FLDVALUE, FLDVALU2, FLDPRNAM, DEX_ROW_ID FROM .AF40102 WHERE REPORTID BETWEEN @REPORTID_RS AND @REPORTID_RE AND HDRFTRTY BETWEEN @HDRFTRTY_RS AND @HDRFTRTY_RE AND SBHSBFIN BETWEEN @SBHSBFIN_RS AND @SBHSBFIN_RE AND FLDNUM BETWEEN @FLDNUM_RS AND @FLDNUM_RE AND ( REPORTID = @REPORTID AND HDRFTRTY = @HDRFTRTY AND SBHSBFIN = @SBHSBFIN AND FLDNUM > @FLDNUM OR REPORTID = @REPORTID AND HDRFTRTY = @HDRFTRTY AND SBHSBFIN > @SBHSBFIN OR REPORTID = @REPORTID AND HDRFTRTY > @HDRFTRTY OR REPORTID > @REPORTID ) ORDER BY REPORTID ASC, HDRFTRTY ASC, SBHSBFIN ASC, FLDNUM ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_AF40102N_2] TO [DYNGRP]
GO
