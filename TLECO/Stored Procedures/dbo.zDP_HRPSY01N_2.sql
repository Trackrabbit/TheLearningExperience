SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_HRPSY01N_2] (@BS int, @FILENAME char(45), @DEX_ROW_ID int, @FILENAME_RS char(45), @FILENAME_RE char(45)) AS  set nocount on IF @FILENAME_RS IS NULL BEGIN SELECT TOP 25  INDEX1, FILENAME, ERRMSG1_I, ERRMSG2_I, DEX_ROW_ID FROM .HRPSY01 WHERE ( FILENAME = @FILENAME AND DEX_ROW_ID > @DEX_ROW_ID OR FILENAME > @FILENAME ) ORDER BY FILENAME ASC, DEX_ROW_ID ASC END ELSE IF @FILENAME_RS = @FILENAME_RE BEGIN SELECT TOP 25  INDEX1, FILENAME, ERRMSG1_I, ERRMSG2_I, DEX_ROW_ID FROM .HRPSY01 WHERE FILENAME = @FILENAME_RS AND ( FILENAME = @FILENAME AND DEX_ROW_ID > @DEX_ROW_ID OR FILENAME > @FILENAME ) ORDER BY FILENAME ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  INDEX1, FILENAME, ERRMSG1_I, ERRMSG2_I, DEX_ROW_ID FROM .HRPSY01 WHERE FILENAME BETWEEN @FILENAME_RS AND @FILENAME_RE AND ( FILENAME = @FILENAME AND DEX_ROW_ID > @DEX_ROW_ID OR FILENAME > @FILENAME ) ORDER BY FILENAME ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_HRPSY01N_2] TO [DYNGRP]
GO
