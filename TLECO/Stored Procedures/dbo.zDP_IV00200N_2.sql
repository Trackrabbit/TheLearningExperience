SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IV00200N_2] (@BS int, @ITEMNMBR char(31), @LOCNCODE char(11), @SERLNSLD tinyint, @QTYTYPE smallint, @DATERECD datetime, @DTSEQNUM numeric(19,5), @ITEMNMBR_RS char(31), @LOCNCODE_RS char(11), @SERLNSLD_RS tinyint, @QTYTYPE_RS smallint, @DATERECD_RS datetime, @DTSEQNUM_RS numeric(19,5), @ITEMNMBR_RE char(31), @LOCNCODE_RE char(11), @SERLNSLD_RE tinyint, @QTYTYPE_RE smallint, @DATERECD_RE datetime, @DTSEQNUM_RE numeric(19,5)) AS  set nocount on IF @ITEMNMBR_RS IS NULL BEGIN SELECT TOP 25  ITEMNMBR, LOCNCODE, DATERECD, DTSEQNUM, SERLNMBR, FGDITMNM, FGSERNBR, UNITCOST, RCTSEQNM, VNDRNMBR, CMPFINGD, SERLNSLD, QTYTYPE, BIN, DEX_ROW_ID FROM .IV00200 WHERE ( ITEMNMBR = @ITEMNMBR AND LOCNCODE = @LOCNCODE AND SERLNSLD = @SERLNSLD AND QTYTYPE = @QTYTYPE AND DATERECD = @DATERECD AND DTSEQNUM > @DTSEQNUM OR ITEMNMBR = @ITEMNMBR AND LOCNCODE = @LOCNCODE AND SERLNSLD = @SERLNSLD AND QTYTYPE = @QTYTYPE AND DATERECD > @DATERECD OR ITEMNMBR = @ITEMNMBR AND LOCNCODE = @LOCNCODE AND SERLNSLD = @SERLNSLD AND QTYTYPE > @QTYTYPE OR ITEMNMBR = @ITEMNMBR AND LOCNCODE = @LOCNCODE AND SERLNSLD > @SERLNSLD OR ITEMNMBR = @ITEMNMBR AND LOCNCODE > @LOCNCODE OR ITEMNMBR > @ITEMNMBR ) ORDER BY ITEMNMBR ASC, LOCNCODE ASC, SERLNSLD ASC, QTYTYPE ASC, DATERECD ASC, DTSEQNUM ASC END ELSE IF @ITEMNMBR_RS = @ITEMNMBR_RE BEGIN SELECT TOP 25  ITEMNMBR, LOCNCODE, DATERECD, DTSEQNUM, SERLNMBR, FGDITMNM, FGSERNBR, UNITCOST, RCTSEQNM, VNDRNMBR, CMPFINGD, SERLNSLD, QTYTYPE, BIN, DEX_ROW_ID FROM .IV00200 WHERE ITEMNMBR = @ITEMNMBR_RS AND LOCNCODE BETWEEN @LOCNCODE_RS AND @LOCNCODE_RE AND SERLNSLD BETWEEN @SERLNSLD_RS AND @SERLNSLD_RE AND QTYTYPE BETWEEN @QTYTYPE_RS AND @QTYTYPE_RE AND DATERECD BETWEEN @DATERECD_RS AND @DATERECD_RE AND DTSEQNUM BETWEEN @DTSEQNUM_RS AND @DTSEQNUM_RE AND ( ITEMNMBR = @ITEMNMBR AND LOCNCODE = @LOCNCODE AND SERLNSLD = @SERLNSLD AND QTYTYPE = @QTYTYPE AND DATERECD = @DATERECD AND DTSEQNUM > @DTSEQNUM OR ITEMNMBR = @ITEMNMBR AND LOCNCODE = @LOCNCODE AND SERLNSLD = @SERLNSLD AND QTYTYPE = @QTYTYPE AND DATERECD > @DATERECD OR ITEMNMBR = @ITEMNMBR AND LOCNCODE = @LOCNCODE AND SERLNSLD = @SERLNSLD AND QTYTYPE > @QTYTYPE OR ITEMNMBR = @ITEMNMBR AND LOCNCODE = @LOCNCODE AND SERLNSLD > @SERLNSLD OR ITEMNMBR = @ITEMNMBR AND LOCNCODE > @LOCNCODE OR ITEMNMBR > @ITEMNMBR ) ORDER BY ITEMNMBR ASC, LOCNCODE ASC, SERLNSLD ASC, QTYTYPE ASC, DATERECD ASC, DTSEQNUM ASC END ELSE BEGIN SELECT TOP 25  ITEMNMBR, LOCNCODE, DATERECD, DTSEQNUM, SERLNMBR, FGDITMNM, FGSERNBR, UNITCOST, RCTSEQNM, VNDRNMBR, CMPFINGD, SERLNSLD, QTYTYPE, BIN, DEX_ROW_ID FROM .IV00200 WHERE ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND LOCNCODE BETWEEN @LOCNCODE_RS AND @LOCNCODE_RE AND SERLNSLD BETWEEN @SERLNSLD_RS AND @SERLNSLD_RE AND QTYTYPE BETWEEN @QTYTYPE_RS AND @QTYTYPE_RE AND DATERECD BETWEEN @DATERECD_RS AND @DATERECD_RE AND DTSEQNUM BETWEEN @DTSEQNUM_RS AND @DTSEQNUM_RE AND ( ITEMNMBR = @ITEMNMBR AND LOCNCODE = @LOCNCODE AND SERLNSLD = @SERLNSLD AND QTYTYPE = @QTYTYPE AND DATERECD = @DATERECD AND DTSEQNUM > @DTSEQNUM OR ITEMNMBR = @ITEMNMBR AND LOCNCODE = @LOCNCODE AND SERLNSLD = @SERLNSLD AND QTYTYPE = @QTYTYPE AND DATERECD > @DATERECD OR ITEMNMBR = @ITEMNMBR AND LOCNCODE = @LOCNCODE AND SERLNSLD = @SERLNSLD AND QTYTYPE > @QTYTYPE OR ITEMNMBR = @ITEMNMBR AND LOCNCODE = @LOCNCODE AND SERLNSLD > @SERLNSLD OR ITEMNMBR = @ITEMNMBR AND LOCNCODE > @LOCNCODE OR ITEMNMBR > @ITEMNMBR ) ORDER BY ITEMNMBR ASC, LOCNCODE ASC, SERLNSLD ASC, QTYTYPE ASC, DATERECD ASC, DTSEQNUM ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IV00200N_2] TO [DYNGRP]
GO
