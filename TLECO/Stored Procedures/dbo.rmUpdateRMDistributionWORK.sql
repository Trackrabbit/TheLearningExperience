SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create proc [dbo].[rmUpdateRMDistributionWORK]  @cStartRangeUserID char(15) =NULL,  @sStartRangePostingStatus smallint =NULL,  @sStartRangeRMDocumentTypeAll smallint =NULL,  @cStartRangeDocumentNumber char(21) =NULL,  @iStartRangeSequenceNumber integer  =NULL,  @cEndRangeUserID char(15) =NULL,  @sEndRangePostingStatus smallint =NULL,  @sEndRangeRMDocumentTypeAll smallint =NULL,  @cEndRangeDocumentNumber char(21) =NULL,  @iEndRangeSequenceNumber integer  =NULL,  @tSetValuePosted tinyint  =NULL,  @sSetValuePostingStatus smallint =NULL,  @cSetValueTRXSource char(13) =NULL,  @dSetValuePostedDate datetime =NULL,  @cSetValueUserID char(15) =NULL,  @iErrorState     int  =NULL output as  set nocount on  select @iErrorState = 0  if  @cStartRangeUserID is NULL or  @sStartRangePostingStatus is NULL or  @sStartRangeRMDocumentTypeAll is NULL or  @cStartRangeDocumentNumber is NULL or  @iStartRangeSequenceNumber is NULL or  @cEndRangeUserID is NULL or  @sEndRangePostingStatus is NULL or  @sEndRangeRMDocumentTypeAll is NULL or  @cEndRangeDocumentNumber is NULL or  @iEndRangeSequenceNumber is NULL or  @tSetValuePosted is NULL or  @sSetValuePostingStatus is NULL or  @cSetValueTRXSource is NULL or  @dSetValuePostedDate is NULL or  @cSetValueUserID is NULL begin  select @iErrorState = 21077  return end   update  RM10101 set   POSTED    = @tSetValuePosted,  PSTGSTUS  = @sSetValuePostingStatus,  TRXSORCE   = @cSetValueTRXSource,  POSTEDDT  = @dSetValuePostedDate,  USERID   = @cSetValueUserID where  USERID  = @cStartRangeUserID and PSTGSTUS  = @sStartRangePostingStatus and RMDTYPAL = @sStartRangeRMDocumentTypeAll  and DOCNUMBR = @cStartRangeDocumentNumber and SEQNUMBR  between @iStartRangeSequenceNumber and @iEndRangeSequenceNumber  return(@@error)   
GO
GRANT EXECUTE ON  [dbo].[rmUpdateRMDistributionWORK] TO [DYNGRP]
GO
