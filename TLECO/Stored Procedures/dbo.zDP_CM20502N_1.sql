SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_CM20502N_1] (@BS int, @AUDITTRAIL char(13), @RECONUM numeric(19,5), @CMRECNUM numeric(19,5), @AUDITTRAIL_RS char(13), @RECONUM_RS numeric(19,5), @CMRECNUM_RS numeric(19,5), @AUDITTRAIL_RE char(13), @RECONUM_RE numeric(19,5), @CMRECNUM_RE numeric(19,5)) AS  set nocount on IF @AUDITTRAIL_RS IS NULL BEGIN SELECT TOP 25  AUDITTRAIL, CMRECNUM, RECONUM, CMTrxNum, CMTrxType, CMLinkID, TRXDATE, TRXAMNT, clearedate, ClrdAmt, CURNCYID, paidtorcvdfrom, DSCRIPTN, DEPTYPE, SOURCDOC, SRCDOCTYP, SRCDOCNUM, USERID, CHEKBKID, DEX_ROW_ID FROM .CM20502 WHERE ( AUDITTRAIL = @AUDITTRAIL AND RECONUM = @RECONUM AND CMRECNUM > @CMRECNUM OR AUDITTRAIL = @AUDITTRAIL AND RECONUM > @RECONUM OR AUDITTRAIL > @AUDITTRAIL ) ORDER BY AUDITTRAIL ASC, RECONUM ASC, CMRECNUM ASC END ELSE IF @AUDITTRAIL_RS = @AUDITTRAIL_RE BEGIN SELECT TOP 25  AUDITTRAIL, CMRECNUM, RECONUM, CMTrxNum, CMTrxType, CMLinkID, TRXDATE, TRXAMNT, clearedate, ClrdAmt, CURNCYID, paidtorcvdfrom, DSCRIPTN, DEPTYPE, SOURCDOC, SRCDOCTYP, SRCDOCNUM, USERID, CHEKBKID, DEX_ROW_ID FROM .CM20502 WHERE AUDITTRAIL = @AUDITTRAIL_RS AND RECONUM BETWEEN @RECONUM_RS AND @RECONUM_RE AND CMRECNUM BETWEEN @CMRECNUM_RS AND @CMRECNUM_RE AND ( AUDITTRAIL = @AUDITTRAIL AND RECONUM = @RECONUM AND CMRECNUM > @CMRECNUM OR AUDITTRAIL = @AUDITTRAIL AND RECONUM > @RECONUM OR AUDITTRAIL > @AUDITTRAIL ) ORDER BY AUDITTRAIL ASC, RECONUM ASC, CMRECNUM ASC END ELSE BEGIN SELECT TOP 25  AUDITTRAIL, CMRECNUM, RECONUM, CMTrxNum, CMTrxType, CMLinkID, TRXDATE, TRXAMNT, clearedate, ClrdAmt, CURNCYID, paidtorcvdfrom, DSCRIPTN, DEPTYPE, SOURCDOC, SRCDOCTYP, SRCDOCNUM, USERID, CHEKBKID, DEX_ROW_ID FROM .CM20502 WHERE AUDITTRAIL BETWEEN @AUDITTRAIL_RS AND @AUDITTRAIL_RE AND RECONUM BETWEEN @RECONUM_RS AND @RECONUM_RE AND CMRECNUM BETWEEN @CMRECNUM_RS AND @CMRECNUM_RE AND ( AUDITTRAIL = @AUDITTRAIL AND RECONUM = @RECONUM AND CMRECNUM > @CMRECNUM OR AUDITTRAIL = @AUDITTRAIL AND RECONUM > @RECONUM OR AUDITTRAIL > @AUDITTRAIL ) ORDER BY AUDITTRAIL ASC, RECONUM ASC, CMRECNUM ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_CM20502N_1] TO [DYNGRP]
GO
