SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_FieldService_HistoryRMALines] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @Return_Document_ID varchar(255), @Return_Record_Type varchar(255), @Line_SEQ_Number varchar(255), @SVC_Next_Line_SEQ_Number varchar(255), @SVC_Prev_Line_SEQ_Number varchar(255), @SVC_Return_Type varchar(255), @RMA_Status varchar(255), @Return_Status varchar(255), @Received varchar(255), @Traveler_Printed varchar(255), @SVC_Ready_To_Close varchar(255), @SVC_RMA_Reason_Code varchar(255), @SVC_RMA_Reason_Code_Desc varchar(255), @Note_Index varchar(255), @Return_Origin varchar(255), @Return_Reference varchar(255), @Service_Record_Type varchar(255), @Service_Call_Number varchar(255), @Equipment_Line_Item_Sequence varchar(255), @Line_Item_Sequence varchar(255), @SVC_RMA_From_Service varchar(255), @SOP_Type varchar(255), @SOP_Number varchar(255), @Component_Sequence varchar(255), @SOP_Line_Item_Sequence varchar(255), @Entry_Date varchar(255), @Entry_Time varchar(255), @ETA_Date varchar(255), @ETA_Time varchar(255), @Commit_Date varchar(255), @Commit_Time varchar(255), @Return_Date varchar(255), @Return_Time varchar(255), @Complete_Date varchar(255), @Complete_Time varchar(255), @Promised_Date varchar(255), @Reference varchar(255), @User_ID varchar(255), @Office_ID varchar(255), @Location_Code varchar(255), @Return_Address_Name varchar(255), @Return_Address_1 varchar(255), @Return_Address_2 varchar(255), @Return_Address_3 varchar(255), @Return_Address_City varchar(255), @SVC_Return_State varchar(255), @Return_Address_Zip_Code varchar(255), @Return_Country varchar(255), @Customer_ID varchar(255), @Customer_Name varchar(255), @Address_Code varchar(255), @Contact varchar(255), @Address_1 varchar(255), @Address_2 varchar(255), @Address_3 varchar(255), @City varchar(255), @State varchar(255), @Zip_Code varchar(255), @Country varchar(255), @Bill_To_Customer_ID varchar(255), @SVC_Bill_To_Address_Code varchar(255), @Customer_PO_Number varchar(255), @QTY varchar(255), @Decimal_Places_QTYS varchar(255), @U_Of_M varchar(255), @Item_Number varchar(255), @Item_Description varchar(255), @Unit_Cost varchar(255), @Originating_Unit_Cost varchar(255), @Extended_Cost varchar(255), @Originating_Extended_Cost varchar(255), @Unit_Price varchar(255), @Originating_Unit_Price varchar(255), @Extended_Price varchar(255), @Originating_Extended_Price varchar(255), @Customer_Owned varchar(255), @Factory_Sealed varchar(255), @Order_Document_ID varchar(255), @Transfer_Line_Item_Sequence varchar(255), @Transfer_Status varchar(255), @Flat_Rate_Repair_Price varchar(255), @Originating_Flat_Rate_Repair_Price varchar(255), @Repair_Price varchar(255), @Originating_Repair_Price varchar(255), @NTE_Price varchar(255), @Originating_NTE_Price varchar(255), @Repair_Cost varchar(255), @Originating_Repair_Cost varchar(255), @Bill_of_Lading varchar(255), @Shipping_Method varchar(255), @Credit_SOP_Type varchar(255), @Credit_SOP_Number varchar(255), @Credit_SOP_Line_Item_Sequence varchar(255), @Replace_SOP_Type varchar(255), @Replace_SOP_Number varchar(255), @Replace_SOP_Line_Item_Sequence varchar(255), @Location_Code_Replacement varchar(255), @Replace_Item_Number varchar(255), @Replace_U_Of_M varchar(255), @Replace_Price_Level varchar(255), @Replace_QTY varchar(255), @Replace_Cost varchar(255), @Originating_Replace_Cost varchar(255), @Replace_Price varchar(255), @Originating_Replace_Price varchar(255), @SOP_Number_Invoice varchar(255), @Item_Number_Invoice varchar(255), @User_Defined_1 varchar(255), @User_Defined_2 varchar(255), @User_Defined_3 varchar(255), @User_Defined_4 varchar(255), @User_Defined_5 varchar(255), @Currency_Index varchar(255), @Decimal_Places_Currency varchar(255), @Originating_Decimal_Places_Currency varchar(255), @Return_Item_Number varchar(255), @Return_Item_Description varchar(255), @Return_Location_Code varchar(255), @Return_QTY varchar(255), @Return_U_Of_M varchar(255), @Return_Cost varchar(255), @Originating_Return_Cost varchar(255), @SVC_Extended_Return_Cost varchar(255), @SVC_Originating_Extended_Return_Cost varchar(255), @SVC_Return_Price_Level varchar(255), @SVC_Return_Price varchar(255), @Originating_Return_Price varchar(255), @SVC_Extended_Return_Price varchar(255), @SVC_Originating_Extended_Return_Price varchar(255), @SVC_FO_ID varchar(255), @SVC_SCM_Complete varchar(255), @Bill_To_Customer_Name varchar(255),  @DrillBack_Base_Url varchar(255), @DrillBack_Base_Url_For_FS varchar(255), @Service_Call_Number_For_DrillBack varchar(255), @Customer_ID_For_DrillBack varchar(255), @Item_Number_For_DrillBack varchar(255), @Return_Document_ID_For_DrillBack varchar(255), @SOP_Number_For_DrillBack varchar(255)  select @DrillBack_Base_Url = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),0) select @DrillBack_Base_Url_For_FS = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),949)  select @I_iDictID = 949 select @I_iMessageNumber = 27400 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Document_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27401 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Record_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 27402 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Line_SEQ_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27403 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Next_Line_SEQ_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27404 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Prev_Line_SEQ_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27405 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Return_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 27406 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @RMA_Status output  select @I_iDictID = 949 select @I_iMessageNumber = 27407 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Status output  select @I_iDictID = 949 select @I_iMessageNumber = 27408 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Received output  select @I_iDictID = 949 select @I_iMessageNumber = 27409 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Traveler_Printed output  select @I_iDictID = 949 select @I_iMessageNumber = 27410 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Ready_To_Close output  select @I_iDictID = 949 select @I_iMessageNumber = 27411 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_RMA_Reason_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27412 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_RMA_Reason_Code_Desc output  select @I_iDictID = 949 select @I_iMessageNumber = 27413 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Note_Index output  select @I_iDictID = 949 select @I_iMessageNumber = 27414 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Origin output  select @I_iDictID = 949 select @I_iMessageNumber = 27415 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Reference output  select @I_iDictID = 949 select @I_iMessageNumber = 27416 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Record_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 27417 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Call_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27418 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Equipment_Line_Item_Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 27419 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Line_Item_Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 27420 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_RMA_From_Service output  select @I_iDictID = 949 select @I_iMessageNumber = 27421 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SOP_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 27422 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SOP_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27423 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Component_Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 27424 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SOP_Line_Item_Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 27425 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Entry_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 27426 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Entry_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 27427 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ETA_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 27428 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ETA_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 27429 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Commit_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 27430 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Commit_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 27431 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 27432 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 27433 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Complete_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 27434 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Complete_Time output  select @I_iDictID = 949 select @I_iMessageNumber = 27435 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Promised_Date output  select @I_iDictID = 949 select @I_iMessageNumber = 27436 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reference output  select @I_iDictID = 949 select @I_iMessageNumber = 27437 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27438 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Office_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27439 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Location_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27440 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Address_Name output  select @I_iDictID = 949 select @I_iMessageNumber = 27441 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Address_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 27442 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Address_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 27443 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Address_3 output  select @I_iDictID = 949 select @I_iMessageNumber = 27444 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Address_City output  select @I_iDictID = 949 select @I_iMessageNumber = 27445 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Return_State output  select @I_iDictID = 949 select @I_iMessageNumber = 27446 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Address_Zip_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27447 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Country output  select @I_iDictID = 949 select @I_iMessageNumber = 27448 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27449 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_Name output  select @I_iDictID = 949 select @I_iMessageNumber = 27450 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27451 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Contact output  select @I_iDictID = 949 select @I_iMessageNumber = 27452 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 27453 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 27454 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_3 output  select @I_iDictID = 949 select @I_iMessageNumber = 27455 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @City output  select @I_iDictID = 949 select @I_iMessageNumber = 27456 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @State output  select @I_iDictID = 949 select @I_iMessageNumber = 27457 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Zip_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27458 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Country output  select @I_iDictID = 949 select @I_iMessageNumber = 27459 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Bill_To_Customer_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27460 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Bill_To_Address_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27461 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_PO_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27462 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @QTY output  select @I_iDictID = 949 select @I_iMessageNumber = 27463 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Decimal_Places_QTYS output  select @I_iDictID = 949 select @I_iMessageNumber = 27464 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @U_Of_M output  select @I_iDictID = 949 select @I_iMessageNumber = 27465 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27466 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Description output  select @I_iDictID = 949 select @I_iMessageNumber = 27467 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Unit_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27468 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Unit_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27469 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Extended_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27470 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Extended_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27471 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Unit_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27472 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Unit_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27473 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Extended_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27474 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Extended_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27475 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_Owned output  select @I_iDictID = 949 select @I_iMessageNumber = 27476 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Factory_Sealed output  select @I_iDictID = 949 select @I_iMessageNumber = 27477 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Order_Document_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27478 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Transfer_Line_Item_Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 27479 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Transfer_Status output  select @I_iDictID = 949 select @I_iMessageNumber = 27480 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Flat_Rate_Repair_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27481 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Flat_Rate_Repair_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27482 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Repair_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27483 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Repair_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27484 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @NTE_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27485 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_NTE_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27486 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Repair_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27487 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Repair_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27488 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Bill_of_Lading output  select @I_iDictID = 949 select @I_iMessageNumber = 27489 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Shipping_Method output  select @I_iDictID = 949 select @I_iMessageNumber = 27490 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Credit_SOP_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 27491 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Credit_SOP_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27492 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Credit_SOP_Line_Item_Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 27493 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Replace_SOP_Type output  select @I_iDictID = 949 select @I_iMessageNumber = 27494 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Replace_SOP_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27495 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Replace_SOP_Line_Item_Sequence output  select @I_iDictID = 949 select @I_iMessageNumber = 27496 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Location_Code_Replacement output  select @I_iDictID = 949 select @I_iMessageNumber = 27497 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Replace_Item_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27498 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Replace_U_Of_M output  select @I_iDictID = 949 select @I_iMessageNumber = 27499 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Replace_Price_Level output  select @I_iDictID = 949 select @I_iMessageNumber = 27500 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Replace_QTY output  select @I_iDictID = 949 select @I_iMessageNumber = 27501 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Replace_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27502 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Replace_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27503 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Replace_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27504 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Replace_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27505 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SOP_Number_Invoice output  select @I_iDictID = 949 select @I_iMessageNumber = 27506 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number_Invoice output  select @I_iDictID = 949 select @I_iMessageNumber = 27507 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_1 output  select @I_iDictID = 949 select @I_iMessageNumber = 27508 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_2 output  select @I_iDictID = 949 select @I_iMessageNumber = 27509 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_3 output  select @I_iDictID = 949 select @I_iMessageNumber = 27510 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_4 output  select @I_iDictID = 949 select @I_iMessageNumber = 27511 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @User_Defined_5 output  select @I_iDictID = 949 select @I_iMessageNumber = 27512 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Currency_Index output  select @I_iDictID = 949 select @I_iMessageNumber = 27513 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Decimal_Places_Currency output  select @I_iDictID = 949 select @I_iMessageNumber = 27514 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Decimal_Places_Currency output  select @I_iDictID = 949 select @I_iMessageNumber = 27515 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Item_Number output  select @I_iDictID = 949 select @I_iMessageNumber = 27516 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Item_Description output  select @I_iDictID = 949 select @I_iMessageNumber = 27517 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Location_Code output  select @I_iDictID = 949 select @I_iMessageNumber = 27518 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_QTY output  select @I_iDictID = 949 select @I_iMessageNumber = 27519 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_U_Of_M output  select @I_iDictID = 949 select @I_iMessageNumber = 27520 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27521 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Return_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27522 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Extended_Return_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27523 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Originating_Extended_Return_Cost output  select @I_iDictID = 949 select @I_iMessageNumber = 27524 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Return_Price_Level output  select @I_iDictID = 949 select @I_iMessageNumber = 27525 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Return_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27526 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Originating_Return_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27527 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Extended_Return_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27528 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_Originating_Extended_Return_Price output  select @I_iDictID = 949 select @I_iMessageNumber = 27529 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_FO_ID output  select @I_iDictID = 949 select @I_iMessageNumber = 27530 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SVC_SCM_Complete output  select @I_iDictID = 949 select @I_iMessageNumber = 27580 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Bill_To_Customer_Name output   select @I_iDictID = 949 select @I_iMessageNumber = 27417 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Service_Call_Number_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 27448 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Customer_ID_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 27465 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Item_Number_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 27400 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Return_Document_ID_For_DrillBack output   select @I_iDictID = 949 select @I_iMessageNumber = 27422 select @I_iAliasMessageNumber = 30088 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @SOP_Number_For_DrillBack output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[HistoryRMALines]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[HistoryRMALines] '  select @sqldefaultstring =   'CREATE VIEW HistoryRMALines AS ' +   'select ' +   'rtrim([''SVC_RMA_Line_HIST''].[RETDOCID]) as ''' + @Return_Document_ID + ''', ' + '''' + @Return_Record_Type + ''' = dbo.FS_FUNC_Return_Record_Type([''SVC_RMA_Line_HIST''].[Return_Record_Type]), ' + '[''SVC_RMA_Line_HIST''].[LNSEQNBR] as ''' + @Line_SEQ_Number + ''', ' + 'rtrim([''SVC_RMA_Line_HIST''].[RETTYPE]) as ''' + @SVC_Return_Type + ''', ' + '''' + @RMA_Status + ''' = dbo.FS_FUNC_RMA_Status([''SVC_RMA_Line_HIST''].[RMA_Status]), ' + 'rtrim([''SVC_RMA_Line_HIST''].[RETSTAT]) as ''' + @Return_Status + ''', ' + '''' + @Received + ''' = dbo.DYN_FUNC_Boolean_All([''SVC_RMA_Line_HIST''].[Received]), ' + '''' + @SVC_Ready_To_Close + ''' = dbo.DYN_FUNC_Boolean_All([''SVC_RMA_Line_HIST''].[SVC_Ready_To_Close]), ' + '''' + @Return_Origin + ''' = dbo.FS_FUNC_Return_Origin([''SVC_RMA_Line_HIST''].[RETORIG]), ' + 'rtrim([''SVC_RMA_Line_HIST''].[RETREF]) as ''' + @Return_Reference + ''', ' + '[''SVC_RMA_Line_HIST''].[ENTDTE] as ''' + @Entry_Date + ''', ' + '[''SVC_RMA_Line_HIST''].[ETADTE] as ''' + @ETA_Date + ''', ' + '[''SVC_RMA_Line_HIST''].[RETUDATE] as ''' + @Return_Date + ''', ' + '[''SVC_RMA_Line_HIST''].[COMPDTE] as ''' + @Complete_Date + ''', ' + 'rtrim([''SVC_RMA_Line_HIST''].[OFFID]) as ''' + @Office_ID + ''', ' + 'rtrim([''SVC_RMA_Line_HIST''].[LOCNCODE]) as ''' + @Location_Code + ''', ' + 'rtrim([''RM Customer MSTR''].[CUSTNMBR]) as ''' + @Customer_ID + ''', ' + 'rtrim([''SVC_RMA_Line_HIST''].[ADRSCODE]) as ''' + @Address_Code + ''', ' + 'rtrim([''SVC_RMA_Line_HIST''].[ITEMNMBR]) as ''' + @Item_Number + ''', ' + '[''SVC_RMA_Line_HIST''].[EXTDCOST] as ''' + @Extended_Cost + ''', ' + '[''SVC_RMA_Line_HIST''].[XTNDPRCE] as ''' + @Extended_Price + ''', '   select @sqlstring1 =   'rtrim([''SVC_RMA_Line_HIST''].[ADDRESS1]) as ''' + @Address_1 + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[ADDRESS2]) as ''' + @Address_2 + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[ADDRESS3]) as ''' + @Address_3 + ''', ' +  'rtrim([''RM Customer MSTR2''].[CUSTNMBR]) as ''' + @Bill_To_Customer_ID + ''', ' +  'rtrim([''RM Customer MSTR2''].[CUSTNAME]) as ''' + @Bill_To_Customer_Name + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[Bill_of_Lading]) as ''' + @Bill_of_Lading + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[CITY]) as ''' + @City + ''', ' +  '[''SVC_RMA_Line_HIST''].[Commit_Date] as ''' + @Commit_Date + ''', ' +  '[''SVC_RMA_Line_HIST''].[Commit_Time] as ''' + @Commit_Time + ''', ' +  '[''SVC_RMA_Line_HIST''].[COMPTME] as ''' + @Complete_Time + ''', ' +  '[''SVC_RMA_Line_HIST''].[CMPNTSEQ] as ''' + @Component_Sequence + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[CONTACT]) as ''' + @Contact + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[COUNTRY]) as ''' + @Country + ''', ' +  '[''SVC_RMA_Line_HIST''].[Credit_SOP_Line_Item_Seq] as ''' + @Credit_SOP_Line_Item_Sequence + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[Credit_SOP_Number]) as ''' + @Credit_SOP_Number + ''', ' +  '''' + @Credit_SOP_Type + ''' = dbo.DYN_FUNC_SOP_Type([''SVC_RMA_Line_HIST''].[Credit_SOP_Type]), ' +  '[''SVC_RMA_Line_HIST''].[CURRNIDX] as ''' + @Currency_Index + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[CUSTNAME]) as ''' + @Customer_Name + ''', ' +  '''' + @Customer_Owned + ''' = dbo.DYN_FUNC_Boolean_All([''SVC_RMA_Line_HIST''].[CUSTOWN]), ' +  'rtrim([''SVC_RMA_Line_HIST''].[CSTPONBR]) as ''' + @Customer_PO_Number + ''', ' +  '''' + @Decimal_Places_Currency + ''' = dbo.DYN_FUNC_Decimal_Places_Currency([''SVC_RMA_Line_HIST''].[DECPLCUR]), ' +  '''' + @Decimal_Places_QTYS + ''' = dbo.DYN_FUNC_Decimal_Places_QTYS([''SVC_RMA_Line_HIST''].[DECPLQTY]), ' +  '[''SVC_RMA_Line_HIST''].[ETATME] as ''' + @ETA_Time + ''', ' +  '[''SVC_RMA_Line_HIST''].[ENTTME] as ''' + @Entry_Time + ''', ' +  '[''SVC_RMA_Line_HIST''].[EQPLINE] as ''' + @Equipment_Line_Item_Sequence + ''', ' +  '''' + @Factory_Sealed + ''' = dbo.DYN_FUNC_Boolean_All([''SVC_RMA_Line_HIST''].[FACTSEAL]), ' +  '[''SVC_RMA_Line_HIST''].[Flat_Rate_Repair_Price] as ''' + @Flat_Rate_Repair_Price + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[ITEMDESC]) as ''' + @Item_Description + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[Item_Number_Invoice]) as ''' + @Item_Number_Invoice + ''', ' +  '[''SVC_RMA_Line_HIST''].[LNITMSEQ] as ''' + @Line_Item_Sequence + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[Location_Code_Replacemen]) as ''' + @Location_Code_Replacement + ''', ' +  '[''SVC_RMA_Line_HIST''].[NTE_Price] as ''' + @NTE_Price + ''', ' +  '[''SVC_RMA_Line_HIST''].[NOTEINDX] as ''' + @Note_Index + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[ORDDOCID]) as ''' + @Order_Document_ID + ''', ' +  '''' + @Originating_Decimal_Places_Currency + ''' = dbo.DYN_FUNC_Decimal_Places_Currency([''SVC_RMA_Line_HIST''].[ODECPLCU]), ' +  '[''SVC_RMA_Line_HIST''].[OREXTCST] as ''' + @Originating_Extended_Cost + ''', ' +  '[''SVC_RMA_Line_HIST''].[OXTNDPRC] as ''' + @Originating_Extended_Price + ''', ' +  '[''SVC_RMA_Line_HIST''].[Orig_Flat_RepairPrice] as ''' + @Originating_Flat_Rate_Repair_Price + ''', ' +  '[''SVC_RMA_Line_HIST''].[Originating_NTE_Price] as ''' + @Originating_NTE_Price + ''', ' +  '[''SVC_RMA_Line_HIST''].[Originating_Repair_Cost] as ''' + @Originating_Repair_Cost + ''', ' +  '[''SVC_RMA_Line_HIST''].[Originating_Repair_Price] as ''' + @Originating_Repair_Price + ''', ' +  '[''SVC_RMA_Line_HIST''].[Originating_Replace_Cost] as ''' + @Originating_Replace_Cost + ''', ' +  '[''SVC_RMA_Line_HIST''].[Originating_Replace_Pric] as ''' + @Originating_Replace_Price + ''', ' +  '[''SVC_RMA_Line_HIST''].[Originating_Return_Cost] as ''' + @Originating_Return_Cost + ''', ' +  '[''SVC_RMA_Line_HIST''].[Originating_Return_Price] as ''' + @Originating_Return_Price + ''', ' +  '[''SVC_RMA_Line_HIST''].[ORUNTCST] as ''' + @Originating_Unit_Cost + ''', ' +  '[''SVC_RMA_Line_HIST''].[ORUNTPRC] as ''' + @Originating_Unit_Price + ''', ' +  '[''SVC_RMA_Line_HIST''].[PRMDATE] as ''' + @Promised_Date + ''', ' +  '[''SVC_RMA_Line_HIST''].[QUANTITY] as ''' + @QTY + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[REFRENCE]) as ''' + @Reference + ''', ' +  '[''SVC_RMA_Line_HIST''].[Repair_Cost] as ''' + @Repair_Cost + ''', ' +  '[''SVC_RMA_Line_HIST''].[Repair_Price] as ''' + @Repair_Price + ''', ' +  '[''SVC_RMA_Line_HIST''].[Replace_Cost] as ''' + @Replace_Cost + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[Replace_Item_Number]) as ''' + @Replace_Item_Number + ''', ' +  '[''SVC_RMA_Line_HIST''].[Replace_Price] as ''' + @Replace_Price + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[Replace_Price_Level]) as ''' + @Replace_Price_Level + ''', ' +  '[''SVC_RMA_Line_HIST''].[Replace_QTY] as ''' + @Replace_QTY + ''', ' +  '[''SVC_RMA_Line_HIST''].[Replace_SOP_Line_Item_Se] as ''' + @Replace_SOP_Line_Item_Sequence + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[Replace_SOP_Number]) as ''' + @Replace_SOP_Number + ''', ' +  '''' + @Replace_SOP_Type + ''' = dbo.DYN_FUNC_SOP_Type([''SVC_RMA_Line_HIST''].[Replace_SOP_Type]), '   select @sqlstring2 =   'rtrim([''SVC_RMA_Line_HIST''].[Replace_U_Of_M]) as ''' + @Replace_U_Of_M + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[RETADDR1]) as ''' + @Return_Address_1 + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[RETADDR2]) as ''' + @Return_Address_2 + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[RETADDR3]) as ''' + @Return_Address_3 + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[RTRNCITY]) as ''' + @Return_Address_City + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[RTRNNAME]) as ''' + @Return_Address_Name + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[RTRNZIP]) as ''' + @Return_Address_Zip_Code + ''', ' +  '[''SVC_RMA_Line_HIST''].[RETCOST] as ''' + @Return_Cost + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[Return_Country]) as ''' + @Return_Country + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[Return_Item_Description]) as ''' + @Return_Item_Description + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[Return_Item_Number]) as ''' + @Return_Item_Number + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[Return_Location_Code]) as ''' + @Return_Location_Code + ''', ' +  '[''SVC_RMA_Line_HIST''].[Return_QTY] as ''' + @Return_QTY + ''', ' +  '[''SVC_RMA_Line_HIST''].[Return_Time] as ''' + @Return_Time + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[Return_U_Of_M]) as ''' + @Return_U_Of_M + ''', ' +  '[''SVC_RMA_Line_HIST''].[SOP_Line_Item_Sequence] as ''' + @SOP_Line_Item_Sequence + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[SOPNUMBE]) as ''' + @SOP_Number + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[SOP_Number_Invoice]) as ''' + @SOP_Number_Invoice + ''', ' +  '''' + @SOP_Type + ''' = dbo.DYN_FUNC_SOP_Type([''SVC_RMA_Line_HIST''].[SOPTYPE]), ' +  'rtrim([''SVC_RMA_Line_HIST''].[SVC_Bill_To_Address_Code]) as ''' + @SVC_Bill_To_Address_Code + ''', ' +  '[''SVC_RMA_Line_HIST''].[SVC_Extended_Return_Cost] as ''' + @SVC_Extended_Return_Cost + ''', ' +  '[''SVC_RMA_Line_HIST''].[SVC_Extended_Return_Pric] as ''' + @SVC_Extended_Return_Price + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[SVC_FO_ID]) as ''' + @SVC_FO_ID + ''', ' +  '[''SVC_RMA_Line_HIST''].[SVC_Next_Line_SEQ_Number] as ''' + @SVC_Next_Line_SEQ_Number + ''', ' +  '[''SVC_RMA_Line_HIST''].[SVC_Orig_Ext_Return_Cost] as ''' + @SVC_Originating_Extended_Return_Cost + ''', ' +  '[''SVC_RMA_Line_HIST''].[SVC_Orig_Ext_Return_Pric] as ''' + @SVC_Originating_Extended_Return_Price + ''', ' +  '[''SVC_RMA_Line_HIST''].[SVC_Prev_Line_SEQ_Number] as ''' + @SVC_Prev_Line_SEQ_Number + ''', ' +  '''' + @SVC_RMA_From_Service + ''' = dbo.DYN_FUNC_Boolean_All([''SVC_RMA_Line_HIST''].[SVC_RMA_From_Service]), ' +  'rtrim([''SVC_RMA_Line_HIST''].[SVC_RMA_Reason_Code]) as ''' + @SVC_RMA_Reason_Code + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[SVC_RMA_Reason_Code_Desc]) as ''' + @SVC_RMA_Reason_Code_Desc + ''', ' +  '[''SVC_RMA_Line_HIST''].[SVC_Return_Price] as ''' + @SVC_Return_Price + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[SVC_Return_Price_Level]) as ''' + @SVC_Return_Price_Level + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[SVC_Return_State]) as ''' + @SVC_Return_State + ''', ' +  '[''SVC_RMA_Line_HIST''].[SVC_SCM_Complete] as ''' + @SVC_SCM_Complete + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[CALLNBR]) as ''' + @Service_Call_Number + ''', ' +  '''' + @Service_Record_Type + ''' = dbo.FS_FUNC_Service_Record_Type([''SVC_RMA_Line_HIST''].[SRVRECTYPE]), ' +  'rtrim([''SVC_RMA_Line_HIST''].[SHIPMTHD]) as ''' + @Shipping_Method + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[STATE]) as ''' + @State + ''', ' +  '[''SVC_RMA_Line_HIST''].[TRANSLINESEQ] as ''' + @Transfer_Line_Item_Sequence + ''', ' +  '[''SVC_RMA_Line_HIST''].[STATUS] as ''' + @Transfer_Status + ''', ' +  '''' + @Traveler_Printed + ''' = dbo.DYN_FUNC_Boolean_All([''SVC_RMA_Line_HIST''].[Traveler_Printed]), ' +  'rtrim([''SVC_RMA_Line_HIST''].[UOFM]) as ''' + @U_Of_M + ''', ' +  '[''SVC_RMA_Line_HIST''].[UNITCOST] as ''' + @Unit_Cost + ''', ' +  '[''SVC_RMA_Line_HIST''].[UNITPRCE] as ''' + @Unit_Price + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[USERDEF1]) as ''' + @User_Defined_1 + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[USERDEF2]) as ''' + @User_Defined_2 + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[USRDEF03]) as ''' + @User_Defined_3 + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[USRDEF04]) as ''' + @User_Defined_4 + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[USRDEF05]) as ''' + @User_Defined_5 + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[USERID]) as ''' + @User_ID + ''', ' +  'rtrim([''SVC_RMA_Line_HIST''].[ZIPCODE]) as ''' + @Zip_Code + ''', '   select @sqlstring3 =  '''' + @Customer_ID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppCustomerID(1,[''RM Customer MSTR''].[CUSTNMBR] ), '+ '''' + @Item_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppItemID(1,[''SVC_RMA_Line_HIST''].[ITEMNMBR],'''' ), '+ '''' + @Return_Document_ID_For_DrillBack + ''' = ''' + @DrillBack_Base_Url_For_FS + ''' +dbo.dgppRMANumber(1,[''SVC_RMA_Line_HIST''].[RETDOCID],[''SVC_RMA_Line_HIST''].[Return_Record_Type] ), '+ '''' + @Service_Call_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url_For_FS + ''' +dbo.dgppServiceRecordType(1,[''SVC_RMA_Line_HIST''].[CALLNBR],[''SVC_RMA_Line_HIST''].[SRVRECTYPE] ), '  select @sqlstring4 = '''' + @SOP_Number_For_DrillBack + ''' = ''' + @DrillBack_Base_Url + ''' +dbo.dgppSalesOrder(1,3,11,'''',0,0,[''SVC_RMA_Line_HIST''].[CUSTNMBR],'''',0,'''',[''SVC_RMA_Line_HIST''].[SOPTYPE],[''SVC_RMA_Line_HIST''].[SOPNUMBE] ) '   select @sqljoinstring =   'from [SVC35200] as [''SVC_RMA_Line_HIST''] with (NOLOCK) '   + 'left outer join [RM00101] as [''RM Customer MSTR''] with (NOLOCK) on '   + '[''SVC_RMA_Line_HIST''].[CUSTNMBR] = [''RM Customer MSTR''].[CUSTNMBR] '   + 'left outer join [RM00101] as [''RM Customer MSTR2''] with (NOLOCK) on '   + '[''SVC_RMA_Line_HIST''].[Bill_To_Customer] = [''RM Customer MSTR2''].[CUSTNMBR] '   select @sqlaccessstring =   'GRANT SELECT ON [dbo].[HistoryRMALines] TO [rpt_dispatcher]' + 'GRANT SELECT ON [dbo].[HistoryRMALines] TO [rpt_customer service rep]' + 'GRANT SELECT ON [dbo].[HistoryRMALines] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[HistoryRMALines] TO [rpt_project manager]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_FieldService_HistoryRMALines] TO [DYNGRP]
GO
