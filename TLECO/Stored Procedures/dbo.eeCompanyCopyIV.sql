SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[eeCompanyCopyIV] @I_vFromCompany varchar(50),			 @I_vToCompany varchar(50),				 @I_vData tinyint,						 @I_vReportOptions tinyint,				 @O_iErrorState int = 0 output			 with encryption as set transaction isolation level read uncommitted set nocount on declare @iStatus int, @cStatement varchar(8000), @cStatement2 varchar(8000), @cStatement3 varchar(8000), @cStatement4 varchar(8000), @cStatement5 varchar(8000), @cStatement6 varchar(8000), @cStatement7 varchar(8000), @cStatement8 varchar(8000), @cStatement9 varchar(8000), @cStatement10 varchar(8000), @cStatement11 varchar(8000), @cStatement12 varchar(500), @cStatement1 varchar(255) select @iStatus = 0, @cStatement = '', @cStatement2 = '', @cStatement3 = '', @cStatement4 = '', @cStatement5 = '', @cStatement6 = '', @cStatement7 = '', @cStatement8 = '', @cStatement9 = '', @cStatement10 = '', @cStatement11 = '', @cStatement12 = '', @cStatement1 = '' if (@I_vData = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00101 ( [ITEMNMBR],[ITEMDESC],[NOTEINDX],[ITMSHNAM],[ITEMTYPE],[ITMGEDSC], [STNDCOST],[CURRCOST],[ITEMSHWT],[DECPLQTY],[DECPLCUR],[ITMTSHID], [TAXOPTNS],[IVIVINDX],[IVIVOFIX],[IVCOGSIX],[IVSLSIDX],[IVSLDSIX], [IVSLRNIX],[IVINUSIX],[IVINSVIX],[IVDMGIDX],[IVVARIDX],[DPSHPIDX], [PURPVIDX],[UPPVIDX],[IVRETIDX],[ASMVRIDX],[ITMCLSCD],[ITMTRKOP], [LOTTYPE],[KPERHIST],[KPTRXHST],[KPCALHST],[KPDSTHST],[ALWBKORD], [VCTNMTHD],[UOMSCHDL],[ALTITEM1],[ALTITEM2],[USCATVLS_1],[USCATVLS_2], [USCATVLS_3],[USCATVLS_4],[USCATVLS_5],[USCATVLS_6],[MSTRCDTY],[MODIFDT], [CREATDDT],[WRNTYDYS],[PRCLEVEL],[LOCNCODE],[PINFLIDX],[PURMCIDX], [IVINFIDX],[INVMCIDX],[CGSINFLX],[CGSMCIDX],[ITEMCODE],[TCC], [PriceGroup],[PRICMTHD],[PRCHSUOM],[SELNGUOM],[KTACCTSR],[LASTGENSN], [ABCCODE],[Revalue_Inventory],[Tolerance_Percentage],[Purchase_Item_Tax_Schedu],[Purchase_Tax_Options],[ITMPLNNNGTYP], [STTSTCLVLPRCNTG],[CNTRYORGN],[INACTIVE],[MINSHELF1],[MINSHELF2],[INCLUDEINDP], [LOTEXPWARN],[LOTEXPWARNDAYS],[LASTGENLOT],[Lot_Split_Quantity],[UseQtyOverageTolerance],[UseQtyShortageTolerance], [QtyOverTolerancePercent],[QtyShortTolerancePercent],[IVSCRVIX] ) select [ITEMNMBR],[ITEMDESC],[NOTEINDX],[ITMSHNAM],[ITEMTYPE],[ITMGEDSC], [STNDCOST],[CURRCOST],[ITEMSHWT],[DECPLQTY],[DECPLCUR],[ITMTSHID], [TAXOPTNS],[IVIVINDX],[IVIVOFIX],[IVCOGSIX],[IVSLSIDX],[IVSLDSIX], [IVSLRNIX],[IVINUSIX],[IVINSVIX],[IVDMGIDX],[IVVARIDX],[DPSHPIDX], [PURPVIDX],[UPPVIDX],[IVRETIDX],[ASMVRIDX],[ITMCLSCD],[ITMTRKOP], [LOTTYPE],[KPERHIST],[KPTRXHST],[KPCALHST],[KPDSTHST],[ALWBKORD], [VCTNMTHD],[UOMSCHDL],[ALTITEM1],[ALTITEM2],[USCATVLS_1],[USCATVLS_2], [USCATVLS_3],[USCATVLS_4],[USCATVLS_5],[USCATVLS_6],[MSTRCDTY],[MODIFDT], [CREATDDT],[WRNTYDYS],[PRCLEVEL],[LOCNCODE],[PINFLIDX],[PURMCIDX], [IVINFIDX],[INVMCIDX],[CGSINFLX],[CGSMCIDX],[ITEMCODE],[TCC], [PriceGroup],[PRICMTHD],[PRCHSUOM],[SELNGUOM],[KTACCTSR],[LASTGENSN], [ABCCODE],[Revalue_Inventory],[Tolerance_Percentage],[Purchase_Item_Tax_Schedu],[Purchase_Tax_Options],[ITMPLNNNGTYP], [STTSTCLVLPRCNTG],[CNTRYORGN],[INACTIVE],[MINSHELF1],[MINSHELF2],[INCLUDEINDP], [LOTEXPWARN],[LOTEXPWARNDAYS],[LASTGENLOT],[Lot_Split_Quantity],[UseQtyOverageTolerance],[UseQtyShortageTolerance], [QtyOverTolerancePercent],[QtyShortTolerancePercent],[IVSCRVIX] from ' + rtrim(@I_vFromCompany) + '..IV00101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00102' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00102 ( [ITEMNMBR],[LOCNCODE],[BINNMBR],[RCRDTYPE],[PRIMVNDR],[ITMFRFLG], [BGNGQTY],[LSORDQTY],[LRCPTQTY],[LSTORDDT],[LSORDVND],[LSRCPTDT], [QTYRQSTN],[QTYONORD],[QTYBKORD],[QTY_Drop_Shipped],[QTYINUSE],[QTYINSVC], [QTYRTRND],[QTYDMGED],[QTYONHND],[ATYALLOC],[QTYCOMTD],[QTYSOLD], [NXTCNTDT],[NXTCNTTM],[LSTCNTDT],[LSTCNTTM],[STCKCNTINTRVL],[Landed_Cost_Group_ID], [BUYERID],[PLANNERID],[ORDERPOLICY],[FXDORDRQTY],[ORDRPNTQTY],[NMBROFDYS], [MNMMORDRQTY],[MXMMORDRQTY],[ORDERMULTIPLE],[REPLENISHMENTMETHOD],[SHRINKAGEFACTOR],[PRCHSNGLDTM], [MNFCTRNGFXDLDTM],[MNFCTRNGVRBLLDTM],[STAGINGLDTME],[PLNNNGTMFNCDYS],[DMNDTMFNCPRDS],[INCLDDINPLNNNG], [CALCULATEATP],[AUTOCHKATP],[PLNFNLPAB],[FRCSTCNSMPTNPRD],[ORDRUPTOLVL],[SFTYSTCKQTY], [REORDERVARIANCE],[PORECEIPTBIN],[PORETRNBIN],[SOFULFILLMENTBIN],[SORETURNBIN],[BOMRCPTBIN], [MATERIALISSUEBIN],[MORECEIPTBIN],[REPAIRISSUESBIN],[ReplenishmentLevel],[POPOrderMethod],[MasterLocationCode], [POPVendorSelection],[POPPricingSelection],[PurchasePrice],[IncludeAllocations],[IncludeBackorders],[IncludeRequisitions], [PICKTICKETITEMOPT],[INCLDMRPMOVEIN],[INCLDMRPMOVEOUT],[INCLDMRPCANCEL],[Move_Out_Fence] ) select [ITEMNMBR],[LOCNCODE],[BINNMBR],[RCRDTYPE],[PRIMVNDR],[ITMFRFLG], [BGNGQTY],[LSORDQTY],[LRCPTQTY],[LSTORDDT],[LSORDVND],[LSRCPTDT], [QTYRQSTN],[QTYONORD],[QTYBKORD],[QTY_Drop_Shipped],[QTYINUSE],[QTYINSVC], [QTYRTRND],[QTYDMGED],[QTYONHND],[ATYALLOC],[QTYCOMTD],[QTYSOLD], [NXTCNTDT],[NXTCNTTM],[LSTCNTDT],[LSTCNTTM],[STCKCNTINTRVL],[Landed_Cost_Group_ID], [BUYERID],[PLANNERID],[ORDERPOLICY],[FXDORDRQTY],[ORDRPNTQTY],[NMBROFDYS], [MNMMORDRQTY],[MXMMORDRQTY],[ORDERMULTIPLE],[REPLENISHMENTMETHOD],[SHRINKAGEFACTOR],[PRCHSNGLDTM], [MNFCTRNGFXDLDTM],[MNFCTRNGVRBLLDTM],[STAGINGLDTME],[PLNNNGTMFNCDYS],[DMNDTMFNCPRDS],[INCLDDINPLNNNG], [CALCULATEATP],[AUTOCHKATP],[PLNFNLPAB],[FRCSTCNSMPTNPRD],[ORDRUPTOLVL],[SFTYSTCKQTY], [REORDERVARIANCE],[PORECEIPTBIN],[PORETRNBIN],[SOFULFILLMENTBIN],[SORETURNBIN],[BOMRCPTBIN], [MATERIALISSUEBIN],[MORECEIPTBIN],[REPAIRISSUESBIN],[ReplenishmentLevel],[POPOrderMethod],[MasterLocationCode], [POPVendorSelection],[POPPricingSelection],[PurchasePrice],[IncludeAllocations],[IncludeBackorders],[IncludeRequisitions], [PICKTICKETITEMOPT],[INCLDMRPMOVEIN],[INCLDMRPMOVEOUT],[INCLDMRPCANCEL],[Move_Out_Fence] from ' + rtrim(@I_vFromCompany) + '..IV00102 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00103' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00103 ( [ITEMNMBR],[VENDORID],[ITMVNDTY],[VNDITNUM],[QTYRQSTN],[QTYONORD], [QTY_Drop_Shipped],[LSTORDDT],[LSORDQTY],[LRCPTQTY],[LSRCPTDT],[LRCPTCST], [AVRGLDTM],[NORCTITM],[MINORQTY],[MAXORDQTY],[ECORDQTY],[VNDITDSC], [Last_Originating_Cost],[Last_Currency_ID],[FREEONBOARD],[PRCHSUOM],[CURRNIDX],[PLANNINGLEADTIME], [ORDERMULTIPLE],[MNFCTRITMNMBR] ) select [ITEMNMBR],[VENDORID],[ITMVNDTY],[VNDITNUM],[QTYRQSTN],[QTYONORD], [QTY_Drop_Shipped],[LSTORDDT],[LSORDQTY],[LRCPTQTY],[LSRCPTDT],[LRCPTCST], [AVRGLDTM],[NORCTITM],[MINORQTY],[MAXORDQTY],[ECORDQTY],[VNDITDSC], [Last_Originating_Cost],[Last_Currency_ID],[FREEONBOARD],[PRCHSUOM],[CURRNIDX],[PLANNINGLEADTIME], [ORDERMULTIPLE],[MNFCTRITMNMBR] from ' + rtrim(@I_vFromCompany) + '..IV00103 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00104' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00104 ( [ITEMNMBR],[SEQNUMBR],[CMPTITNM],[CMPITUOM],[CMPITQTY],[CMPSERNM] ) select [ITEMNMBR],[SEQNUMBR],[CMPTITNM],[CMPITUOM],[CMPITQTY],[CMPSERNM] from ' + rtrim(@I_vFromCompany) + '..IV00104 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00105' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00105 ( [ITEMNMBR],[CURNCYID],[CURRNIDX],[DECPLCUR],[LISTPRCE] ) select [ITEMNMBR],[CURNCYID],[CURRNIDX],[DECPLCUR],[LISTPRCE] from ' + rtrim(@I_vFromCompany) + '..IV00105 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00106' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00106 ( [ITEMNMBR],[UOFM],[QTYBSUOM],[UMPUROPT] ) select [ITEMNMBR],[UOFM],[QTYBSUOM],[UMPUROPT] from ' + rtrim(@I_vFromCompany) + '..IV00106 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00107' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00107 ( [ITEMNMBR],[CURNCYID],[PRCLEVEL],[UOFM],[RNDGAMNT],[ROUNDHOW], [ROUNDTO],[UMSLSOPT],[QTYBSUOM],[DEX_ROW_TS] ) select [ITEMNMBR],[CURNCYID],[PRCLEVEL],[UOFM],[RNDGAMNT],[ROUNDHOW], [ROUNDTO],[UMSLSOPT],[QTYBSUOM],[DEX_ROW_TS] from ' + rtrim(@I_vFromCompany) + '..IV00107 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00108' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00108 ( [ITEMNMBR],[CURNCYID],[PRCLEVEL],[UOFM],[TOQTY],[FROMQTY], [UOMPRICE],[QTYBSUOM],[DEX_ROW_TS] ) select [ITEMNMBR],[CURNCYID],[PRCLEVEL],[UOFM],[TOQTY],[FROMQTY], [UOMPRICE],[QTYBSUOM],[DEX_ROW_TS] from ' + rtrim(@I_vFromCompany) + '..IV00108 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00109' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00109 ( [ITEMNMBR],[ORD],[SNSEGTYPE],[DATEFMT],[SGMNTLTH],[SNOPERATION], [SNSTARTVAL],[SNENDVAL] ) select [ITEMNMBR],[ORD],[SNSEGTYPE],[DATEFMT],[SGMNTLTH],[SNOPERATION], [SNSTARTVAL],[SNENDVAL] from ' + rtrim(@I_vFromCompany) + '..IV00109 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00110' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00110 ( [PLANNERID],[PLANNERNAME],[NOTEINDX] ) select [PLANNERID],[PLANNERNAME],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..IV00110 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00111' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00111 ( [LOCNCODE],[ORDERPOLICY],[FXDORDRQTY],[NMBROFDYS],[ORDRPNTQTY],[REPLENISHMENTMETHOD], [PRCHSNGLDTM],[MNFCTRNGFXDLDTM],[MNFCTRNGVRBLLDTM],[STAGINGLDTME],[PLNNNGTMFNCDYS],[DMNDTMFNCPRDS], [BUYERID],[PLANNERID],[FRCSTCNSMPTNPRD],[INCLDDINPLNNNG],[CALCULATEATP],[AUTOCHKATP], [PLNFNLPAB],[Move_Out_Fence] ) select [LOCNCODE],[ORDERPOLICY],[FXDORDRQTY],[NMBROFDYS],[ORDRPNTQTY],[REPLENISHMENTMETHOD], [PRCHSNGLDTM],[MNFCTRNGFXDLDTM],[MNFCTRNGVRBLLDTM],[STAGINGLDTME],[PLNNNGTMFNCDYS],[DMNDTMFNCPRDS], [BUYERID],[PLANNERID],[FRCSTCNSMPTNPRD],[INCLDDINPLNNNG],[CALCULATEATP],[AUTOCHKATP], [PLNFNLPAB],[Move_Out_Fence] from ' + rtrim(@I_vFromCompany) + '..IV00111 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00113' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00113 ( [ITEMNMBR],[CURNCYID],[PRCLEVEL],[UOFM],[TOQTY],[PRICTYPE], [PRCNTAGE],[UOMPRICE],[INCORDEC] ) select [ITEMNMBR],[CURNCYID],[PRCLEVEL],[UOFM],[TOQTY],[PRICTYPE], [PRCNTAGE],[UOMPRICE],[INCORDEC] from ' + rtrim(@I_vFromCompany) + '..IV00113 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00114' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00114 ( [ITEMNMBR] ) select [ITEMNMBR] from ' + rtrim(@I_vFromCompany) + '..IV00114 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV00115' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV00115 ( [ITEMNMBR],[MANUFACTURER],[MNFCTRITMNMBR],[ITEMDESC],[PRIMARYITEM] ) select [ITEMNMBR],[MANUFACTURER],[MNFCTRITMNMBR],[ITEMDESC],[PRIMARYITEM] from ' + rtrim(@I_vFromCompany) + '..IV00115 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40100 ( [SETUPKEY],[USCATDSC_1],[USCATDSC_2],[USCATDSC_3],[USCATDSC_4],[USCATDSC_5], [USCATDSC_6],[DCDCRADJ],[ACSGFLOC],[MAINLOCN],[DECPLCUR],[DECPLQTY], [NXADJDOC],[TXTRDNUM],[NXTVDNUM],[NXPRDNUM],[ALADJOVR],[AVAROVRD], [ATRSOVRD],[ATPSTVRNC],[ENABLEMULTIBIN],[ENPICKSHORTTSK],[USERID],[DISABLEAVGPERPADJ], [DISABLEPERPADJ],[ALLEXPLOTSIV],[ALLEXPLOTSIVPASS],[ALLEXPLOTSOTHER],[ALLEXPLOTOTHERPASS],[USEEXISTINGSNLOTS], [ASSIGNLOTNUMBY],[NXTSPNUM],[VIALOCN],[Next_Bin_XFer_Doc_Number] ) select [SETUPKEY],[USCATDSC_1],[USCATDSC_2],[USCATDSC_3],[USCATDSC_4],[USCATDSC_5], [USCATDSC_6],[DCDCRADJ],[ACSGFLOC],[MAINLOCN],[DECPLCUR],[DECPLQTY], [NXADJDOC],[TXTRDNUM],[NXTVDNUM],[NXPRDNUM],[ALADJOVR],[AVAROVRD], [ATRSOVRD],[ATPSTVRNC],[ENABLEMULTIBIN],[ENPICKSHORTTSK],[USERID],[DISABLEAVGPERPADJ], [DISABLEPERPADJ],[ALLEXPLOTSIV],[ALLEXPLOTSIVPASS],[ALLEXPLOTSOTHER],[ALLEXPLOTOTHERPASS],[USEEXISTINGSNLOTS], [ASSIGNLOTNUMBY],[NXTSPNUM],[VIALOCN],[Next_Bin_XFer_Doc_Number] from ' + rtrim(@I_vFromCompany) + '..IV40100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40201' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40201 ( [UOMSCHDL],[UMSCHDSC],[NOTEINDX],[BASEUOFM],[UMDPQTYS],[DEX_ROW_TS] ) select [UOMSCHDL],[UMSCHDSC],[NOTEINDX],[BASEUOFM],[UMDPQTYS],[DEX_ROW_TS] from ' + rtrim(@I_vFromCompany) + '..IV40201 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40202' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40202 ( [UOMSCHDL],[UOFM],[SEQNUMBR],[EQUIVUOM],[EQUOMQTY],[QTYBSUOM], [UOFMLONGDESC],[DEX_ROW_TS] ) select [UOMSCHDL],[UOFM],[SEQNUMBR],[EQUIVUOM],[EQUOMQTY],[QTYBSUOM], [UOFMLONGDESC],[DEX_ROW_TS] from ' + rtrim(@I_vFromCompany) + '..IV40202 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40400' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40400 ( [ITMCLSCD],[ITMCLSDC],[DEFLTCLS],[NOTEINDX],[ITEMTYPE],[ITMTRKOP], [LOTTYPE],[KPERHIST],[KPTRXHST],[KPCALHST],[KPDSTHST],[ALWBKORD], [ITMGEDSC],[TAXOPTNS],[ITMTSHID],[Purchase_Tax_Options],[Purchase_Item_Tax_Schedu],[UOMSCHDL], [VCTNMTHD],[USCATVLS_1],[USCATVLS_2],[USCATVLS_3],[USCATVLS_4],[USCATVLS_5], [USCATVLS_6],[DECPLQTY],[IVIVINDX],[IVIVOFIX],[IVCOGSIX],[IVSLSIDX], [IVSLDSIX],[IVSLRNIX],[IVINUSIX],[IVINSVIX],[IVDMGIDX],[IVVARIDX], [DPSHPIDX],[PURPVIDX],[UPPVIDX],[IVRETIDX],[ASMVRIDX],[PRCLEVEL], [PriceGroup],[PRICMTHD],[TCC],[Revalue_Inventory],[Tolerance_Percentage],[CNTRYORGN], [STTSTCLVLPRCNTG],[INCLUDEINDP],[LOTEXPWARN],[LOTEXPWARNDAYS],[UseQtyOverageTolerance],[UseQtyShortageTolerance], [QtyOverTolerancePercent],[QtyShortTolerancePercent],[IVSCRVIX] ) select [ITMCLSCD],[ITMCLSDC],[DEFLTCLS],[NOTEINDX],[ITEMTYPE],[ITMTRKOP], [LOTTYPE],[KPERHIST],[KPTRXHST],[KPCALHST],[KPDSTHST],[ALWBKORD], [ITMGEDSC],[TAXOPTNS],[ITMTSHID],[Purchase_Tax_Options],[Purchase_Item_Tax_Schedu],[UOMSCHDL], [VCTNMTHD],[USCATVLS_1],[USCATVLS_2],[USCATVLS_3],[USCATVLS_4],[USCATVLS_5], [USCATVLS_6],[DECPLQTY],[IVIVINDX],[IVIVOFIX],[IVCOGSIX],[IVSLSIDX], [IVSLDSIX],[IVSLRNIX],[IVINUSIX],[IVINSVIX],[IVDMGIDX],[IVVARIDX], [DPSHPIDX],[PURPVIDX],[UPPVIDX],[IVRETIDX],[ASMVRIDX],[PRCLEVEL], [PriceGroup],[PRICMTHD],[TCC],[Revalue_Inventory],[Tolerance_Percentage],[CNTRYORGN], [STTSTCLVLPRCNTG],[INCLUDEINDP],[LOTEXPWARN],[LOTEXPWARNDAYS],[UseQtyOverageTolerance],[UseQtyShortageTolerance], [QtyOverTolerancePercent],[QtyShortTolerancePercent],[IVSCRVIX] from ' + rtrim(@I_vFromCompany) + '..IV40400 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40401' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40401 ( [ITMCLSCD],[CURNCYID],[DECPLCUR] ) select [ITMCLSCD],[CURNCYID],[DECPLCUR] from ' + rtrim(@I_vFromCompany) + '..IV40401 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40500' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40500 ( [LOTTYPE],[LTATRDSC_1],[LTATRDSC_2],[LTATRDSC_3],[LTATRDSC_4],[LTATRDSC_5], [NOTEINDX] ) select [LOTTYPE],[LTATRDSC_1],[LTATRDSC_2],[LTATRDSC_3],[LTATRDSC_4],[LTATRDSC_5], [NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..IV40500 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40600' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40600 ( [USCATVAL],[USCATNUM],[Image_URL],[UserCatLongDescr] ) select [USCATVAL],[USCATNUM],[Image_URL],[UserCatLongDescr] from ' + rtrim(@I_vFromCompany) + '..IV40600 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40700' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40700 ( [LOCNCODE],[LOCNDSCR],[NOTEINDX],[ADDRESS1],[ADDRESS2],[ADDRESS3], [CITY],[STATE],[ZIPCODE],[COUNTRY],[PHONE1],[PHONE2], [PHONE3],[FAXNUMBR],[Location_Segment],[STAXSCHD],[PCTAXSCH],[INCLDDINPLNNNG], [PORECEIPTBIN],[PORETRNBIN],[SOFULFILLMENTBIN],[SORETURNBIN],[BOMRCPTBIN],[MATERIALISSUEBIN], [MORECEIPTBIN],[REPAIRISSUESBIN],[WMSINT],[PICKTICKETSITEOPT],[BINBREAK],[CCode], [DECLID],[INACTIVE] ) select [LOCNCODE],[LOCNDSCR],[NOTEINDX],[ADDRESS1],[ADDRESS2],[ADDRESS3], [CITY],[STATE],[ZIPCODE],[COUNTRY],[PHONE1],[PHONE2], [PHONE3],[FAXNUMBR],[Location_Segment],[STAXSCHD],[PCTAXSCH],[INCLDDINPLNNNG], [PORECEIPTBIN],[PORETRNBIN],[SOFULFILLMENTBIN],[SORETURNBIN],[BOMRCPTBIN],[MATERIALISSUEBIN], [MORECEIPTBIN],[REPAIRISSUESBIN],[WMSINT],[PICKTICKETSITEOPT],[BINBREAK],[CCode], [DECLID],[INACTIVE] from ' + rtrim(@I_vFromCompany) + '..IV40700 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40701' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40701 ( [LOCNCODE],[BIN],[NOTEINDX] ) select [LOCNCODE],[BIN],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..IV40701 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40702' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40702 ( [LOCNCODE],[TXRGNNUM],[CCode],[TMCODE],[TRANSNATURE],[PRCDRRGM], [INCTRMS],[PRT],[RGN],[CNTRYORGN] ) select [LOCNCODE],[TXRGNNUM],[CCode],[TMCODE],[TRANSNATURE],[PRCDRRGM], [INCTRMS],[PRT],[RGN],[CNTRYORGN] from ' + rtrim(@I_vFromCompany) + '..IV40702 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40800' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40800 ( [PRCLEVEL],[DSCRIPTN],[NOTEINDX],[CREATDDT],[MODIFDT],[DEX_ROW_TS] ) select [PRCLEVEL],[DSCRIPTN],[NOTEINDX],[CREATDDT],[MODIFDT],[DEX_ROW_TS] from ' + rtrim(@I_vFromCompany) + '..IV40800 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40900' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40900 ( [PriceGroup],[DSCRIPTN],[CREATDDT],[MODIFDT],[NOTEINDX] ) select [PriceGroup],[DSCRIPTN],[CREATDDT],[MODIFDT],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..IV40900 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV41000' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV41000 ( [SETUPKEY],[NUMBERSHIFTS],[HRSPRSHFT],[STRTTIME],[DWNONWKNDS] ) select [SETUPKEY],[NUMBERSHIFTS],[HRSPRSHFT],[STRTTIME],[DWNONWKNDS] from ' + rtrim(@I_vFromCompany) + '..IV41000 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV41001' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV41001 ( [EXCEPTIONDATE],[DATETYPE] ) select [EXCEPTIONDATE],[DATETYPE] from ' + rtrim(@I_vFromCompany) + '..IV41001 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV41100' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV41100 ( [Landed_Cost_ID],[Long_Description],[NOTEINDX],[VENDORID],[CURNCYID],[CURRNIDX], [RATETPID],[DECPLCUR],[ODECPLCU],[ACPURIDX],[PURPVIDX],[Invoice_Match], [CALCMTHD],[Orig_Landed_Cost_Amount],[Calculation_Percentage],[Revalue_Inventory],[Tolerance_Percentage],[Vendor_Note_Index], [Currency_Note_Index] ) select [Landed_Cost_ID],[Long_Description],[NOTEINDX],[VENDORID],[CURNCYID],[CURRNIDX], [RATETPID],[DECPLCUR],[ODECPLCU],[ACPURIDX],[PURPVIDX],[Invoice_Match], [CALCMTHD],[Orig_Landed_Cost_Amount],[Calculation_Percentage],[Revalue_Inventory],[Tolerance_Percentage],[Vendor_Note_Index], [Currency_Note_Index] from ' + rtrim(@I_vFromCompany) + '..IV41100 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV41101' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV41101 ( [Landed_Cost_Group_ID],[Long_Description],[NOTEINDX] ) select [Landed_Cost_Group_ID],[Long_Description],[NOTEINDX] from ' + rtrim(@I_vFromCompany) + '..IV41101 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV41102' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV41102 ( [Landed_Cost_Group_ID],[Landed_Cost_ID] ) select [Landed_Cost_Group_ID],[Landed_Cost_ID] from ' + rtrim(@I_vFromCompany) + '..IV41102 ' exec(@cStatement) select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV40300' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV40300 ( [Reason_Code],[Reason_Code_Description],[INACTIVE],[Types_of_Adj_Var],[Adjustment],[Variance], [OFFINDX],[Item_Transfer],[InTransit_Transfer],[Item_Bin_Transfer],[NOTEINDX],[CREATDDT] ) select [Reason_Code],[Reason_Code_Description],[INACTIVE],[Types_of_Adj_Var],[Adjustment],[Variance], [OFFINDX],[Item_Transfer],[InTransit_Transfer],[Item_Bin_Transfer],[NOTEINDX],[CREATDDT] from ' + rtrim(@I_vFromCompany) + '..IV40300 ' exec(@cStatement) end if (@I_vReportOptions = 1) begin select @cStatement =  'delete ' + rtrim(@I_vToCompany) +'..IV70500' exec(@cStatement) select @cStatement =  ' insert into ' + rtrim(@I_vToCompany) +'..IV70500 ( [PRTBYSIT],[PRNTOPTN],[STTGNDSC],[ENGENDSC],[ENUSRCAT_1],[ENUSRCAT_2], [ENUSRCAT_3],[ENUSRCAT_4],[ENUSRCAT_5],[ENUSRCAT_6],[KITSRTBY],[STRTUCAT_1], [STRTUCAT_2],[STRTUCAT_3],[STRTUCAT_4],[STRTUCAT_5],[STRTUCAT_6],[STTITNUM], [ENITMNBR],[PRVDRINF],[PRTDSCNT],[FINRPTNM],[PRNTNOTS],[PRNTTYPE], [ASKECHTM],[INCLGNDS],[PRNTOFIL],[PRTOPRTR],[PRTOSCRN],[IFFILXST], [FILEXPNM],[EXPTTYPE],[RPTGRIND],[STTCLASS],[ENDCLASS],[STTSCHED], [ENSCHDUL],[STTLOCCD],[ENLOCNCD],[STTLOTTY],[ENLOTTYP],[STRTNGDT], [ENDINGDT],[ENDTKNDT],[STTOKNDT],[STRCTNUM],[ENRCTNBR],[RTPACHIN], [RTGRSBIN],[SORTBY],[PRTSRLOT],[INZROQTY],[PRTITQTY],[STTBINUM], [ENBINNBR],[STDOCNUM],[ENDOCNUM],[STDOCTYP],[ENDOCTYP],[STTMODUL], [ENDMODUL],[STRXSRC],[ENTRXSRC],[STBCHSRC],[ENBCHSRC],[STBCHNUM], [ENDBNMBR],[STVNDRID],[ENDVNDID],[INQTYREQ],[INZRORLV],[CALSGQTY], [RCPTOPTS],[VENDROPT],[SEGSRTBY]' select @cStatement2 = rtrim(@cStatement2)+rtrim(','+'[STTACNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement3 = rtrim(@cStatement3)+rtrim(','+'[EACCNBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement4 = ',[SEGMNTRG],[Start_PriceLevel],[End_PriceLevel], [Start_QTY_Type],[End_QTY_Type],[Start_Component_Item_Num],[End_Component_Item_Numbe],[BM_Assembly_Journal],[BM_Distribution_Detail], [BM_Bill_Status_Active],[BM_Bill_Status_Pending],[BM_Bill_Status_Obsolete],[BM_Comp_Status_Active],[BM_Comp_Status_Pending],[BM_Comp_Status_Obsolete], [BM_Comp_Type_Misc_Charge],[BM_Comp_Type_Services],[BM_Comp_Type_Flat_Fee],[BM_Print_Notes_Bill],[BM_Print_Notes_Comp],[BM_Print_Cost_Options], [Max_Levels],[DATE1],[BMTRXSTATNOTREL],[BMTRXSTATREL],[OPTIONS],[Start_TRX_ID], [End_TRX_ID],[Starting_TRX_Date],[Ending_TRX_Date],[STRTSRLT],[ENDSERLT],[StartPriceGroup], [EndPriceGroup],[STCURRID],[ENDCURID],[STRTABCCD],[ENDABCCD],[STRTSTCKCNTID], [ENDSTCKCNTID],[Start_Landed_Cost_ID],[End_Landed_Cost_ID],[Start_LandedCostGroupID],[End_LandedCostGroupID],[ASOFDATE], [INZRQTYI],[STARTBIN],[ENDBIN],[LNGSTRTDESC],[LNGENDDESC],[USEGLPOSTINGDATE], [INNGVQTY],[COSTAVGPERIODIC],[PRTINACT] ) select [PRTBYSIT],[PRNTOPTN],[STTGNDSC],[ENGENDSC],[ENUSRCAT_1],[ENUSRCAT_2], [ENUSRCAT_3],[ENUSRCAT_4],[ENUSRCAT_5],[ENUSRCAT_6],[KITSRTBY],[STRTUCAT_1], [STRTUCAT_2],[STRTUCAT_3],[STRTUCAT_4],[STRTUCAT_5],[STRTUCAT_6],[STTITNUM], [ENITMNBR],[PRVDRINF],[PRTDSCNT],[FINRPTNM],[PRNTNOTS],[PRNTTYPE], [ASKECHTM],[INCLGNDS],[PRNTOFIL],[PRTOPRTR],[PRTOSCRN],[IFFILXST], [FILEXPNM],[EXPTTYPE],[RPTGRIND],[STTCLASS],[ENDCLASS],[STTSCHED], [ENSCHDUL],[STTLOCCD],[ENLOCNCD],[STTLOTTY],[ENLOTTYP],[STRTNGDT], [ENDINGDT],[ENDTKNDT],[STTOKNDT],[STRCTNUM],[ENRCTNBR],[RTPACHIN], [RTGRSBIN],[SORTBY],[PRTSRLOT],[INZROQTY],[PRTITQTY],[STTBINUM], [ENBINNBR],[STDOCNUM],[ENDOCNUM],[STDOCTYP],[ENDOCTYP],[STTMODUL], [ENDMODUL],[STRXSRC],[ENTRXSRC],[STBCHSRC],[ENBCHSRC],[STBCHNUM], [ENDBNMBR],[STVNDRID],[ENDVNDID],[INQTYREQ],[INZRORLV],[CALSGQTY], [RCPTOPTS],[VENDROPT],[SEGSRTBY]' select @cStatement5 = rtrim(@cStatement5)+rtrim(','+'[STTACNUM_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement6 = rtrim(@cStatement6)+rtrim(','+'[EACCNBR_'+ltrim(str(SGMTNUMB)))+']' from DYNAMICS..SY00302 select @cStatement7 = ',[SEGMNTRG],[Start_PriceLevel],[End_PriceLevel], [Start_QTY_Type],[End_QTY_Type],[Start_Component_Item_Num],[End_Component_Item_Numbe],[BM_Assembly_Journal],[BM_Distribution_Detail], [BM_Bill_Status_Active],[BM_Bill_Status_Pending],[BM_Bill_Status_Obsolete],[BM_Comp_Status_Active],[BM_Comp_Status_Pending],[BM_Comp_Status_Obsolete], [BM_Comp_Type_Misc_Charge],[BM_Comp_Type_Services],[BM_Comp_Type_Flat_Fee],[BM_Print_Notes_Bill],[BM_Print_Notes_Comp],[BM_Print_Cost_Options], [Max_Levels],[DATE1],[BMTRXSTATNOTREL],[BMTRXSTATREL],[OPTIONS],[Start_TRX_ID], [End_TRX_ID],[Starting_TRX_Date],[Ending_TRX_Date],[STRTSRLT],[ENDSERLT],[StartPriceGroup], [EndPriceGroup],[STCURRID],[ENDCURID],[STRTABCCD],[ENDABCCD],[STRTSTCKCNTID], [ENDSTCKCNTID],[Start_Landed_Cost_ID],[End_Landed_Cost_ID],[Start_LandedCostGroupID],[End_LandedCostGroupID],[ASOFDATE], [INZRQTYI],[STARTBIN],[ENDBIN],[LNGSTRTDESC],[LNGENDDESC],[USEGLPOSTINGDATE], [INNGVQTY],[COSTAVGPERIODIC],[PRTINACT] from ' + rtrim(@I_vFromCompany) + '..IV70500 ' exec(@cStatement+@cStatement2+@cStatement3+@cStatement4+@cStatement5+@cStatement6+@cStatement7) end return 
GO
GRANT EXECUTE ON  [dbo].[eeCompanyCopyIV] TO [DYNGRP]
GO
