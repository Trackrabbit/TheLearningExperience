SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[ASI_Fill_IV_Item_MSTR_Lookup_Temp] @OSName varchar (15)  AS BEGIN  declare @SQL_Statement varchar(2000)  CREATE TABLE [dbo].[#IV00101Temp](  [ITEMNMBR] [char](31) NOT NULL,  [ITEMDESC] [char](101) NOT NULL,  [NOTEINDX] [numeric](19, 5) NOT NULL,  [ITMSHNAM] [char](15) NOT NULL,  [ITEMTYPE] [smallint] NOT NULL,  [ITMGEDSC] [char](11) NOT NULL,  [STNDCOST] [numeric](19, 5) NOT NULL,  [CURRCOST] [numeric](19, 5) NOT NULL,  [ITEMSHWT] [int] NOT NULL,  [DECPLQTY] [smallint] NOT NULL,  [DECPLCUR] [smallint] NOT NULL,  [ITMTSHID] [char](15) NOT NULL,  [TAXOPTNS] [smallint] NOT NULL,  [IVIVINDX] [int] NOT NULL,  [IVIVOFIX] [int] NOT NULL,  [IVCOGSIX] [int] NOT NULL,  [IVSLSIDX] [int] NOT NULL,  [IVSLDSIX] [int] NOT NULL,  [IVSLRNIX] [int] NOT NULL,  [IVINUSIX] [int] NOT NULL,  [IVINSVIX] [int] NOT NULL,  [IVDMGIDX] [int] NOT NULL,  [IVVARIDX] [int] NOT NULL,  [DPSHPIDX] [int] NOT NULL,  [PURPVIDX] [int] NOT NULL,  [UPPVIDX] [int] NOT NULL,  [IVRETIDX] [int] NOT NULL,  [ASMVRIDX] [int] NOT NULL,  [ITMCLSCD] [char](11) NOT NULL,  [ITMTRKOP] [smallint] NOT NULL,  [LOTTYPE] [char](11) NOT NULL,  [KPERHIST] [tinyint] NOT NULL,  [KPTRXHST] [tinyint] NOT NULL,  [KPCALHST] [tinyint] NOT NULL,  [KPDSTHST] [tinyint] NOT NULL,  [ALWBKORD] [tinyint] NOT NULL,  [VCTNMTHD] [smallint] NOT NULL,  [UOMSCHDL] [char](11) NOT NULL,  [ALTITEM1] [char](31) NOT NULL,  [ALTITEM2] [char](31) NOT NULL,  [USCATVLS_1] [char](11) NOT NULL,  [USCATVLS_2] [char](11) NOT NULL,  [USCATVLS_3] [char](11) NOT NULL,  [USCATVLS_4] [char](11) NOT NULL,  [USCATVLS_5] [char](11) NOT NULL,  [USCATVLS_6] [char](11) NOT NULL,  [MSTRCDTY] [smallint] NOT NULL,  [MODIFDT] [datetime] NOT NULL,  [CREATDDT] [datetime] NOT NULL,  [WRNTYDYS] [smallint] NOT NULL,  [PRCLEVEL] [char](11) NOT NULL,  [LOCNCODE] [char](11) NOT NULL,  [PINFLIDX] [int] NOT NULL,  [PURMCIDX] [int] NOT NULL,  [IVINFIDX] [int] NOT NULL,  [INVMCIDX] [int] NOT NULL,  [CGSINFLX] [int] NOT NULL,  [CGSMCIDX] [int] NOT NULL,  [ITEMCODE] [char](15) NOT NULL,  [TCC] [char](31) NOT NULL,  [PriceGroup] [char](11) NOT NULL,  [PRICMTHD] [smallint] NOT NULL,  [PRCHSUOM] [char](9) NOT NULL,  [SELNGUOM] [char](9) NOT NULL,  [KTACCTSR] [smallint] NOT NULL,  [LASTGENSN] [char](21) NOT NULL,  [ABCCODE] [smallint] NOT NULL,  [Revalue_Inventory] [tinyint] NOT NULL,  [Tolerance_Percentage] [int] NOT NULL,  [Purchase_Item_Tax_Schedu] [char](15) NOT NULL,  [Purchase_Tax_Options] [smallint] NOT NULL,  [CNTRYORGN] [char](7) NOT NULL,  [Master_ID] [char](31) NOT NULL,  [ASI_Master_Item_Number] [char](31) NOT NULL,  [ASI_Master_Item_Descript] [char](51) NOT NULL,  [VENDORID] [char](15) NOT NULL,  [ITMVNDTY] [smallint] NOT NULL,  [VNDITNUM] [char](31) NOT NULL,  [QTYRQSTN] [numeric](19, 5) NOT NULL,  [QTYONORD] [numeric](19, 5) NOT NULL,  [QTY_Drop_Shipped] [numeric](19, 5) NOT NULL,  [LSTORDDT] [datetime] NOT NULL,  [LSORDQTY] [numeric](19, 5) NOT NULL,  [LRCPTQTY] [numeric](19, 5) NOT NULL,  [LSRCPTDT] [datetime] NOT NULL,  [LRCPTCST] [numeric](19, 5) NOT NULL,  [AVRGLDTM] [int] NOT NULL,  [NORCTITM] [smallint] NOT NULL,  [MINORQTY] [numeric](19, 5) NOT NULL,  [MAXORDQTY] [numeric](19, 5) NOT NULL,  [ECORDQTY] [numeric](19, 5) NOT NULL,  [VNDITDSC] [char](101) NOT NULL,  [Last_Originating_Cost] [numeric](19, 5) NOT NULL,  [Last_Currency_ID] [char](15) NOT NULL,  [FREEONBOARD] [smallint] NOT NULL,  [CURRNIDX] [smallint] NOT NULL,  [PLANNINGLEADTIME] [smallint] NOT NULL,  [CUSTNMBR] [char](15) NOT NULL,  [ASICUSTITNO] [char](31) NOT NULL,  [ASICUSTITDSC] [char](51) NOT NULL,  [ASICUSTITSNM] [char](15) NOT NULL,  [ASICUSTITGDSC] [char](11) NOT NULL,  [USERDEF1] [char](21) NOT NULL,  [USERDEF2] [char](21) NOT NULL,  [USRDEF03] [char](21) NOT NULL,  [USRDEF04] [char](21) NOT NULL,  [USRDEF05] [char](21) NOT NULL,  [ASIUSERDEF1] [char](51) NOT NULL,  [ASIUSERDEF2] [char](51) NOT NULL,  [ASIUSERDEF3] [char](51) NOT NULL,  [ASIUSERDEF4] [char](51) NOT NULL,  [DEX_ROW_ID] [int] NOT NULL)  delete from #IV00101Temp insert into #IV00101Temp  select  a.ITEMNMBR, a.ITEMDESC, a.NOTEINDX, a.ITMSHNAM, a.ITEMTYPE, a.ITMGEDSC, a.STNDCOST,   a.CURRCOST, a.ITEMSHWT, a.DECPLQTY, a.DECPLCUR, a.ITMTSHID, a.TAXOPTNS, a.IVIVINDX, a.IVIVOFIX, a.IVCOGSIX,   a.IVSLSIDX, a.IVSLDSIX, a.IVSLRNIX, a.IVINUSIX, a.IVINSVIX, a.IVDMGIDX, a.IVVARIDX, a.DPSHPIDX, a.PURPVIDX,  a.UPPVIDX, a.IVRETIDX, a.ASMVRIDX, a.ITMCLSCD, a.ITMTRKOP, a.LOTTYPE, a.KPERHIST, a.KPTRXHST, a.KPCALHST,  a.KPDSTHST, a.ALWBKORD, a.VCTNMTHD, a.UOMSCHDL, a.ALTITEM1, a.ALTITEM2, a.USCATVLS_1, a.USCATVLS_2, a.USCATVLS_3,   a.USCATVLS_4, a.USCATVLS_5, a.USCATVLS_6, a.MSTRCDTY, a.MODIFDT, a.CREATDDT, a.WRNTYDYS, a.PRCLEVEL, a.LOCNCODE,   a.PINFLIDX, a.PURMCIDX, a.IVINFIDX, a.INVMCIDX, a.CGSINFLX, a.CGSMCIDX, a.ITEMCODE, a.TCC, a.PriceGroup, a.PRICMTHD, a.PRCHSUOM,  a.SELNGUOM, a.KTACCTSR, a.LASTGENSN, a.ABCCODE, a.Revalue_Inventory, a.Tolerance_Percentage, a.Purchase_Item_Tax_Schedu, a.Purchase_Tax_Options,  a.CNTRYORGN, '' as Master_ID, '' as ASI_Master_Item_Number, '' as ASI_Master_Item_Descript, '' as VENDORID,  0 as ITMVNDTY, '' as VNDITNUM, 0 as QTYRQSTN, 0 as QTYONORD, 0 as QTY_Drop_Shipped, 0 as LSTORDDT, 0 as LSORDQTY,  0 as LRCPTQTY, '' as LSRCPTDT, 0.00 as LRCPTCST, 0 as AVRGLDTM, 0 as NORCTITM, 0 as MINORQTY, 0 as MAXORDQTY, 0 as ECORDQTY, '' as VNDITDSC,  0.0 as Last_Originating_Cost, '' as Last_Currency_ID, 0 as FREEONBOARD, 0 as CURRNIDX, 0 as PLANNINGLEADTIME, '' as CUSTNMBR, '' as ASICUSTITNO,  '' as ASICUSTITDSC, '' as ASICUSTITSNM, '' as ASICUSTITGDSC, '' as USERDEF1, '' as USERDEF2, '' as USRDEF03, '' as USRDEF04, '' as USRDEF05,  '' as ASIUSERDEF1, '' as ASIUSERDEF2, '' as ASIUSERDEF3, '' as ASIUSERDEF4, a.DEX_ROW_ID   from IV00101 a, IV00102 b  where   a.ITEMNMBR = b.ITEMNMBR and  (a.ITEMTYPE <> 2 or (a.ITEMTYPE = 2 and (b.QTYONHND - b.ATYALLOC > 0))) and  b.LOCNCODE = ''  select @SQL_Statement = 'delete from '+  @OSName + ' insert into ' + @OSName + ' ' +  ' select ITEMNMBR, ITEMDESC, NOTEINDX, ITMSHNAM, ITEMTYPE, ITMGEDSC, STNDCOST, ' +  ' CURRCOST, ITEMSHWT, DECPLQTY, DECPLCUR, ITMTSHID, TAXOPTNS, IVIVINDX, IVIVOFIX, IVCOGSIX, ' +  ' IVSLSIDX, IVSLDSIX, IVSLRNIX, IVINUSIX, IVINSVIX, IVDMGIDX, IVVARIDX, DPSHPIDX, PURPVIDX, ' +  ' UPPVIDX, IVRETIDX, ASMVRIDX, ITMCLSCD, ITMTRKOP, LOTTYPE, KPERHIST, KPTRXHST, KPCALHST, ' +  ' KPDSTHST, ALWBKORD, VCTNMTHD, UOMSCHDL, ALTITEM1, ALTITEM2, USCATVLS_1, USCATVLS_2, USCATVLS_3, ' +  ' USCATVLS_4, USCATVLS_5, USCATVLS_6, MSTRCDTY, MODIFDT, CREATDDT, WRNTYDYS, PRCLEVEL, LOCNCODE, ' +  ' PINFLIDX, PURMCIDX, IVINFIDX, INVMCIDX, CGSINFLX, CGSMCIDX, ITEMCODE, TCC, PriceGroup, PRICMTHD, PRCHSUOM, ' +  ' SELNGUOM, KTACCTSR, LASTGENSN, ABCCODE, Revalue_Inventory, Tolerance_Percentage, Purchase_Item_Tax_Schedu, Purchase_Tax_Options, '+  ' CNTRYORGN, Master_ID, ASI_Master_Item_Number, ASI_Master_Item_Descript, VENDORID, ' +  ' ITMVNDTY, VNDITNUM, QTYRQSTN,  QTYONORD, QTY_Drop_Shipped, LSTORDDT,  LSORDQTY,' +  ' LRCPTQTY, LSRCPTDT, LRCPTCST, AVRGLDTM, NORCTITM, MINORQTY, MAXORDQTY, ECORDQTY, VNDITDSC, '+  ' Last_Originating_Cost, Last_Currency_ID, FREEONBOARD, CURRNIDX, PLANNINGLEADTIME, CUSTNMBR, ASICUSTITNO, ' +  ' ASICUSTITDSC, ASICUSTITSNM, ASICUSTITGDSC, USERDEF1, USERDEF2, USRDEF03, USRDEF04, USRDEF05, '+  ' ASIUSERDEF1, ASIUSERDEF2, ASIUSERDEF3, ASIUSERDEF4 from #IV00101Temp '  exec (@SQL_Statement)  END   
GO
GRANT EXECUTE ON  [dbo].[ASI_Fill_IV_Item_MSTR_Lookup_Temp] TO [DYNGRP]
GO
