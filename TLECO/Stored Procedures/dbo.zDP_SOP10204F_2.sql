SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SOP10204F_2] (@PROMOSTS_RS smallint, @ITEMNMBR_RS char(31), @SOPNUMBE_RS char(21), @SOPTYPE_RS smallint, @LNITMSEQ_RS int, @PROMOSTS_RE smallint, @ITEMNMBR_RE char(31), @SOPNUMBE_RE char(21), @SOPTYPE_RE smallint, @LNITMSEQ_RE int) AS  set nocount on IF @PROMOSTS_RS IS NULL BEGIN SELECT TOP 25  SOPNUMBE, SOPTYPE, CMPNTSEQ, LNITMSEQ, ITEMNMBR, PROMOSTS, PROMOTYP, PSITMVAL, FREEITEM, FREEUOFM, PRMCMSEQ, PRMLISEQ, DEX_ROW_ID FROM .SOP10204 ORDER BY PROMOSTS ASC, ITEMNMBR ASC, SOPNUMBE ASC, SOPTYPE ASC, LNITMSEQ ASC END ELSE IF @PROMOSTS_RS = @PROMOSTS_RE BEGIN SELECT TOP 25  SOPNUMBE, SOPTYPE, CMPNTSEQ, LNITMSEQ, ITEMNMBR, PROMOSTS, PROMOTYP, PSITMVAL, FREEITEM, FREEUOFM, PRMCMSEQ, PRMLISEQ, DEX_ROW_ID FROM .SOP10204 WHERE PROMOSTS = @PROMOSTS_RS AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND SOPNUMBE BETWEEN @SOPNUMBE_RS AND @SOPNUMBE_RE AND SOPTYPE BETWEEN @SOPTYPE_RS AND @SOPTYPE_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE ORDER BY PROMOSTS ASC, ITEMNMBR ASC, SOPNUMBE ASC, SOPTYPE ASC, LNITMSEQ ASC END ELSE BEGIN SELECT TOP 25  SOPNUMBE, SOPTYPE, CMPNTSEQ, LNITMSEQ, ITEMNMBR, PROMOSTS, PROMOTYP, PSITMVAL, FREEITEM, FREEUOFM, PRMCMSEQ, PRMLISEQ, DEX_ROW_ID FROM .SOP10204 WHERE PROMOSTS BETWEEN @PROMOSTS_RS AND @PROMOSTS_RE AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND SOPNUMBE BETWEEN @SOPNUMBE_RS AND @SOPNUMBE_RE AND SOPTYPE BETWEEN @SOPTYPE_RS AND @SOPTYPE_RE AND LNITMSEQ BETWEEN @LNITMSEQ_RS AND @LNITMSEQ_RE ORDER BY PROMOSTS ASC, ITEMNMBR ASC, SOPNUMBE ASC, SOPTYPE ASC, LNITMSEQ ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SOP10204F_2] TO [DYNGRP]
GO
