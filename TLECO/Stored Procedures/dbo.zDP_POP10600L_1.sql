SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_POP10600L_1] (@POPIVCNO_RS char(17), @IVCLINNO_RS int, @POPRCTNM_RS char(17), @RCPTLNNM_RS int, @LCLINENUMBER_RS int, @POPIVCNO_RE char(17), @IVCLINNO_RE int, @POPRCTNM_RE char(17), @RCPTLNNM_RE int, @LCLINENUMBER_RE int) AS  set nocount on IF @POPIVCNO_RS IS NULL BEGIN SELECT TOP 25  POPIVCNO, IVCLINNO, POPRCTNM, RCPTLNNM, LCLINENUMBER, Status, QTYINVCD, QTYINVRESERVE, ORUNTCST, RCPTCOST, ORCPTCOST, ACPURTOT, UPPVTOTL, PURPVIDX, PCHRPTCT, SPRCPTCT, CURNCYID, CURRNIDX, XCHGRATE, RATECALC, DENXRATE, Revalue_Inventory, PPVTotal, INVINDX, BCKTXAMT, OBTAXAMT, PRCNTOFTTL, DEX_ROW_ID FROM .POP10600 ORDER BY POPIVCNO DESC, IVCLINNO DESC, POPRCTNM DESC, RCPTLNNM DESC, LCLINENUMBER DESC END ELSE IF @POPIVCNO_RS = @POPIVCNO_RE BEGIN SELECT TOP 25  POPIVCNO, IVCLINNO, POPRCTNM, RCPTLNNM, LCLINENUMBER, Status, QTYINVCD, QTYINVRESERVE, ORUNTCST, RCPTCOST, ORCPTCOST, ACPURTOT, UPPVTOTL, PURPVIDX, PCHRPTCT, SPRCPTCT, CURNCYID, CURRNIDX, XCHGRATE, RATECALC, DENXRATE, Revalue_Inventory, PPVTotal, INVINDX, BCKTXAMT, OBTAXAMT, PRCNTOFTTL, DEX_ROW_ID FROM .POP10600 WHERE POPIVCNO = @POPIVCNO_RS AND IVCLINNO BETWEEN @IVCLINNO_RS AND @IVCLINNO_RE AND POPRCTNM BETWEEN @POPRCTNM_RS AND @POPRCTNM_RE AND RCPTLNNM BETWEEN @RCPTLNNM_RS AND @RCPTLNNM_RE AND LCLINENUMBER BETWEEN @LCLINENUMBER_RS AND @LCLINENUMBER_RE ORDER BY POPIVCNO DESC, IVCLINNO DESC, POPRCTNM DESC, RCPTLNNM DESC, LCLINENUMBER DESC END ELSE BEGIN SELECT TOP 25  POPIVCNO, IVCLINNO, POPRCTNM, RCPTLNNM, LCLINENUMBER, Status, QTYINVCD, QTYINVRESERVE, ORUNTCST, RCPTCOST, ORCPTCOST, ACPURTOT, UPPVTOTL, PURPVIDX, PCHRPTCT, SPRCPTCT, CURNCYID, CURRNIDX, XCHGRATE, RATECALC, DENXRATE, Revalue_Inventory, PPVTotal, INVINDX, BCKTXAMT, OBTAXAMT, PRCNTOFTTL, DEX_ROW_ID FROM .POP10600 WHERE POPIVCNO BETWEEN @POPIVCNO_RS AND @POPIVCNO_RE AND IVCLINNO BETWEEN @IVCLINNO_RS AND @IVCLINNO_RE AND POPRCTNM BETWEEN @POPRCTNM_RS AND @POPRCTNM_RE AND RCPTLNNM BETWEEN @RCPTLNNM_RS AND @RCPTLNNM_RE AND LCLINENUMBER BETWEEN @LCLINENUMBER_RS AND @LCLINENUMBER_RE ORDER BY POPIVCNO DESC, IVCLINNO DESC, POPRCTNM DESC, RCPTLNNM DESC, LCLINENUMBER DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_POP10600L_1] TO [DYNGRP]
GO
