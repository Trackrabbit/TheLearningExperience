SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROCEDURE [dbo].[SVC_Create_Dispatch_Service_TEMP] (@TableName char(40), @TECHID char(11),  @SRVRECTYPE smallint, @FromSRVSTAT char(3), @ToSRVSTAT char(3) ) AS  exec( 'declare @TECHID char(11) set @TECHID = '''+@TECHID+''' '+ 'declare @SRVRECTYPE smallint set @SRVRECTYPE = '+@SRVRECTYPE+' '+ 'declare @FromSRVSTAT char(3)set @FromSRVSTAT = '''+@FromSRVSTAT+''' '+ 'declare @ToSRVSTAT char(3) set @ToSRVSTAT = '''+@ToSRVSTAT+''' '+ 'delete ' + @TableName + ' '+ 'insert into ' + @TableName + '(SRVRECTYPE, CALLNBR, PARSTOTCST, ORIGPARSTOTCST, PARSTOTPRC, ORIGPARSTOTPRC, Part_Sub_Total_Tax, Orig_PartSubTotalTax, LABSTOTCST, ORIGLABSUBTOTCOST, LABSTOTPRC, ORIGLABSTOTPRC, Labor_Sub_Total_Tax, OrigLaborSubTotalTax, MISSTOTCST, ORIGMISSTOTCST, MSCSTOTPRC, ORIGMSCSTOTPRC, Misc_Sub_Total_Tax, OrigMiscSubTotalTax, Expense_Sub_Total_Cost, Orig_ExpensesSubCost, Expenses_SubTotal_Price, OrigExpensesSubPrice, Expenses_SubTotal_Tax, Originating_Expenses_Sub) '+ 'select SVC00200.SRVRECTYPE,SVC00200.CALLNBR,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 '+ 'from SVC00200 '+ 'inner join ( '+ ' SELECT SRVRECTYPE, CALLNBR FROM SVC00200  '+ ' where TECHID = @TECHID and SRVRECTYPE = @SRVRECTYPE and SRVSTAT between @FromSRVSTAT and @ToSRVSTAT '+ ' union '+ ' SELECT SVC00200.SRVRECTYPE, SVC00200.CALLNBR '+ ' FROM SVC00200  '+ ' inner join SVC00207 on SVC00200.SRVRECTYPE = SVC00207.SRVRECTYPE and SVC00200.CALLNBR = SVC00207.CALLNBR '+ ' where SVC00207.TECHID = @TECHID and SVC00200.SRVRECTYPE = @SRVRECTYPE and SRVSTAT between @FromSRVSTAT and @ToSRVSTAT '+ ') as MultTech on SVC00200.SRVRECTYPE = MultTech.SRVRECTYPE and SVC00200.CALLNBR = MultTech.CALLNBR ' )   
GO
GRANT EXECUTE ON  [dbo].[SVC_Create_Dispatch_Service_TEMP] TO [DYNGRP]
GO
