SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SOP00200UN_2] (@BS int, @CUSTNAME char(65), @CUSTNAME_RS char(65), @CUSTNAME_RE char(65)) AS  set nocount on IF @CUSTNAME_RS IS NULL BEGIN SELECT TOP 25  PROSPID, NOTEINDX, CUSTNAME, CNTCPRSN, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIP, COUNTRY, CUSTCLAS, PHONE1, PHONE2, PHONE3, PRCLEVEL, FAX, SHIPMTHD, TAXSCHID, USERDEF1, USERDEF2, USER2ENT, CREATDDT, MODIFDT, DEX_ROW_ID FROM .SOP00200 WHERE ( CUSTNAME > @CUSTNAME ) ORDER BY CUSTNAME ASC, DEX_ROW_ID ASC END ELSE IF @CUSTNAME_RS = @CUSTNAME_RE BEGIN SELECT TOP 25  PROSPID, NOTEINDX, CUSTNAME, CNTCPRSN, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIP, COUNTRY, CUSTCLAS, PHONE1, PHONE2, PHONE3, PRCLEVEL, FAX, SHIPMTHD, TAXSCHID, USERDEF1, USERDEF2, USER2ENT, CREATDDT, MODIFDT, DEX_ROW_ID FROM .SOP00200 WHERE CUSTNAME = @CUSTNAME_RS AND ( CUSTNAME > @CUSTNAME ) ORDER BY CUSTNAME ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  PROSPID, NOTEINDX, CUSTNAME, CNTCPRSN, ADDRESS1, ADDRESS2, ADDRESS3, CITY, STATE, ZIP, COUNTRY, CUSTCLAS, PHONE1, PHONE2, PHONE3, PRCLEVEL, FAX, SHIPMTHD, TAXSCHID, USERDEF1, USERDEF2, USER2ENT, CREATDDT, MODIFDT, DEX_ROW_ID FROM .SOP00200 WHERE CUSTNAME BETWEEN @CUSTNAME_RS AND @CUSTNAME_RE AND ( CUSTNAME > @CUSTNAME ) ORDER BY CUSTNAME ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SOP00200UN_2] TO [DYNGRP]
GO
