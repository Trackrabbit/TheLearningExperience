SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
create procedure [dbo].[TACallItemCombine] @I_charStartItem 	char(31),  @I_charEndItem 		char(31),  @O_iErrorState 		int = NULL output with encryption as declare  @iStatus 	int, @iError 	int,  @tTransaction	tinyint, @tLoop		tinyint select @O_iErrorState 	 = 0 if @@trancount = 0    begin select @tTransaction = 1 begin transaction end while ( @tLoop is NULL ) begin select @tLoop = 1 if exists (select * from sysobjects where id = object_id('dbo.mfg_update_location_update')) alter table IV00101 disable trigger mfg_update_location_update if @@error <> 0  begin select @O_iErrorState = 1	 break end  if exists (select * from sysobjects where id = object_id('dbo.mfg_remove_orphaned_records')) alter table IV00101 disable trigger mfg_remove_orphaned_records if @@error <> 0  begin select @O_iErrorState = 2	 break end  if exists (select * from sysobjects where id = object_id('dbo.mfg_insert_IV00102_location')) alter table IV00102 disable trigger mfg_insert_IV00102_location if @@error <> 0  begin select @O_iErrorState = 40	 break end if exists (select * from sysobjects where id = object_id('dbo.mfg_update_IV00102')) alter table IV00102 disable trigger mfg_update_IV00102 if @@error <> 0  begin select @O_iErrorState = 41	 break end if exists (select * from sysobjects where id = object_id('dbo.mfg_delete_IV00102')) alter table IV00102 disable trigger mfg_delete_IV00102 if @@error <> 0  begin select @O_iErrorState = 42	 break end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_Item_Ext_U')) alter table IV00101 disable trigger tr_SVC_Item_Ext_U if @@error <> 0  begin select @O_iErrorState = 3	 break end  if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_Item_Site_Ext_U')) alter table IV00102 disable trigger tr_SVC_Item_Site_Ext_U if @@error <> 0  begin select @O_iErrorState = 4	 break end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_IV00101_D')) alter table IV00101 disable trigger tr_SVC_IV00101_D if @@error <> 0  begin select @O_iErrorState = 5	 break end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_IV00101_U')) alter table IV00101 disable trigger tr_SVC_IV00101_U if @@error <> 0  begin select @O_iErrorState = 6	 break end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_IV00101_U')) alter table IV00101 disable trigger tr_SVC_IV00101_U if @@error <> 0  begin select @O_iErrorState = 7	 break end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_IV00102_D')) alter table IV00102 disable trigger tr_SVC_IV00102_D if @@error <> 0  begin select @O_iErrorState = 8	 break end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_IV00102_U')) alter table IV00102 disable trigger tr_SVC_IV00102_U if @@error <> 0  begin select @O_iErrorState = 9	 break end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_SVC00201_UD')) alter table SVC00201 disable trigger tr_SVC_SVC00201_UD if @@error <> 0  begin select @O_iErrorState = 10	 break end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_SVC00601_IUD')) alter table SVC00601 disable trigger tr_SVC_SVC00601_IUD if @@error <> 0  begin select @O_iErrorState = 11	 break end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_SVC00701_U')) alter table SVC00701 disable trigger tr_SVC_SVC00701_U if @@error <> 0  begin select @O_iErrorState = 12	 break end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC00951_U')) alter table SVC00951 disable trigger tr_SVC00951_U if @@error <> 0  begin select @O_iErrorState = 13	 break end if exists (select * from sysobjects where id = object_id('dbo.IntIvPriceListONIV00108_INSERT')) alter table IV00108 disable trigger IntIvPriceListONIV00108_INSERT if @@error <> 0  begin select @O_iErrorState = 28	 break end if exists (select * from sysobjects where id = object_id('dbo.IntIvPriceListONIV00108_UPDATE')) alter table IV00108 disable trigger IntIvPriceListONIV00108_UPDATE if @@error <> 0  begin select @O_iErrorState = 29	 break end if exists (select * from sysobjects where id = object_id('dbo.IntIvPriceListONIV00108_DELETE')) alter table IV00108 disable trigger IntIvPriceListONIV00108_DELETE if @@error <> 0  begin select @O_iErrorState = 30	 break end if exists (select * from sysobjects where id = object_id('dbo.DXPublish_IvMasterForIvSubst_INSERT')) alter table IV00101 disable trigger DXPublish_IvMasterForIvSubst_INSERT if @@error <> 0  begin select @O_iErrorState = 31	 break end If exists (select * from sysobjects where id = object_id('dbo.DXPublish_IvMasterForIvSubst_UPDATE')) alter table IV00101 disable trigger DXPublish_IvMasterForIvSubst_UPDATE if @@error <> 0  begin select @O_iErrorState = 32	 break end exec @iStatus = smItemNumberCombiner @I_charStartItem, @I_charEndItem, @O_iErrorState output select @iError = @@error if @iStatus = 0 and @iError <> 0 select @iStatus = @iError if (@iStatus <> 0) or (@O_iErrorState <> 0) begin select @O_iErrorState = 38 break end end if exists (select * from sysobjects where id = object_id('dbo.mfg_update_location_update')) alter table IV00101 enable trigger mfg_update_location_update if @@error <> 0  begin select @O_iErrorState = 15	 end if exists (select * from sysobjects where id = object_id('dbo.mfg_remove_orphaned_records')) alter table IV00101 enable trigger mfg_remove_orphaned_records if @@error <> 0  begin select @O_iErrorState = 16	 end if exists (select * from sysobjects where id = object_id('dbo.mfg_insert_IV00102_location')) alter table IV00102 enable trigger mfg_insert_IV00102_location if @@error <> 0  begin select @O_iErrorState = 43	 end if exists (select * from sysobjects where id = object_id('dbo.mfg_update_IV00102')) alter table IV00102 enable trigger mfg_update_IV00102 if @@error <> 0  begin select @O_iErrorState = 44	 end if exists (select * from sysobjects where id = object_id('dbo.mfg_delete_IV00102')) alter table IV00102 enable trigger mfg_delete_IV00102 if @@error <> 0  begin select @O_iErrorState = 45	 end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_Item_Ext_U')) alter table IV00101 enable trigger tr_SVC_Item_Ext_U if @@error <> 0  begin select @O_iErrorState = 17	 end  if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_Item_Site_Ext_U')) alter table IV00102 enable trigger tr_SVC_Item_Site_Ext_U if @@error <> 0  begin select @O_iErrorState = 18	 end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_IV00101_D')) alter table IV00101 enable trigger tr_SVC_IV00101_D if @@error <> 0  begin select @O_iErrorState = 19	 end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_IV00101_U')) alter table IV00101 enable trigger tr_SVC_IV00101_U if @@error <> 0  begin select @O_iErrorState = 20	 end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_IV00101_U')) alter table IV00101 enable trigger tr_SVC_IV00101_U if @@error <> 0  begin select @O_iErrorState = 21	 end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_IV00102_D')) alter table IV00102 enable trigger tr_SVC_IV00102_D if @@error <> 0  begin select @O_iErrorState = 22	 end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_IV00102_U')) alter table IV00102 enable trigger tr_SVC_IV00102_U if @@error <> 0  begin select @O_iErrorState = 23	 end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_SVC00201_UD')) alter table SVC00201 enable trigger tr_SVC_SVC00201_UD if @@error <> 0  begin select @O_iErrorState = 24	 end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_SVC00601_IUD')) alter table SVC00601 enable trigger tr_SVC_SVC00601_IUD if @@error <> 0  begin select @O_iErrorState = 25	 end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC_SVC00701_U')) alter table SVC00701 enable trigger tr_SVC_SVC00701_U if @@error <> 0  begin select @O_iErrorState = 26	 end if exists (select * from sysobjects where id = object_id('dbo.tr_SVC00951_U')) alter table SVC00951 enable trigger tr_SVC00951_U if @@error <> 0  begin select @O_iErrorState = 27	 end if exists (select * from sysobjects where id = object_id('dbo.IntIvPriceListONIV00108_INSERT')) alter table IV00108 enable trigger IntIvPriceListONIV00108_INSERT if @@error <> 0  begin select @O_iErrorState = 33	 end if exists (select * from sysobjects where id = object_id('dbo.IntIvPriceListONIV00108_UPDATE')) alter table IV00108 enable trigger IntIvPriceListONIV00108_UPDATE if @@error <> 0  begin select @O_iErrorState = 34	 end if exists (select * from sysobjects where id = object_id('dbo.IntIvPriceListONIV00108_DELETE')) alter table IV00108 enable trigger IntIvPriceListONIV00108_DELETE if @@error <> 0  begin select @O_iErrorState = 35	 end if exists (select * from sysobjects where id = object_id('dbo.DXPublish_IvMasterForIvSubst_INSERT')) alter table IV00101 enable trigger DXPublish_IvMasterForIvSubst_INSERT if @@error <> 0  begin select @O_iErrorState = 36	 end if exists (select * from sysobjects where id = object_id('dbo.DXPublish_IvMasterForIvSubst_UPDATE')) alter table IV00101 enable trigger DXPublish_IvMasterForIvSubst_UPDATE if @@error <> 0  begin select @O_iErrorState = 37	 end  if @O_iErrorState <> 0 begin if @tTransaction = 1 rollback transaction end else if @tTransaction = 1 begin commit transaction end return  
GO
GRANT EXECUTE ON  [dbo].[TACallItemCombine] TO [DYNGRP]
GO
