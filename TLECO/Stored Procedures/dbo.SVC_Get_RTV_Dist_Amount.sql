SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 Create Procedure [dbo].[SVC_Get_RTV_Dist_Amount]  @RTVNumber as char(15),  @RTVLine numeric(19,5),  @LineType as char(3),  @DistType as smallint,  @Cost numeric (19,2) output,  @OrigCost numeric (19,2) output,  @Price numeric (19,2) output,  @OrigPrice numeric (19,2) output As declare @TableType smallint   exec SVC_Get_RTV_Table @RTVNumber, @TableType OUTPUT if @TableType = 1   Begin  if @RTVLine = 0   Begin  select @Cost = SUM(CRDTAMNT)-SUM(DEBITAMT),@OrigCost = SUM(ORCRDAMT)-SUM(ORDBTAMT) from SVC05630  where RTV_Number = @RTVNumber and LINITMTYP = 'I' and SVC_Distribution_Type = 4  select @Price = SUM(CRDTAMNT)-SUM(DEBITAMT),@OrigPrice = SUM(ORCRDAMT)-SUM(ORDBTAMT) from SVC05630  where RTV_Number = @RTVNumber and LINITMTYP <> 'I' and SVC_Distribution_Type = 7  end  else  Begin  select @Cost = SUM(CRDTAMNT)-SUM(DEBITAMT),@OrigCost = SUM(ORCRDAMT)-SUM(ORDBTAMT) from SVC05630  where RTV_Number = @RTVNumber and RTV_Line =  @RTVLine and LINITMTYP = 'I' and SVC_Distribution_Type = 4  select @Price = SUM(CRDTAMNT)-SUM(DEBITAMT),@OrigPrice = SUM(ORCRDAMT)-SUM(ORDBTAMT) from SVC05630  where RTV_Number = @RTVNumber and RTV_Line =  @RTVLine and LINITMTYP <> 'I' and SVC_Distribution_Type = 7  End  End else  Begin  if @RTVLine = 0   Begin  select @Cost = SUM(CRDTAMNT)-SUM(DEBITAMT),@OrigCost = SUM(ORCRDAMT)-SUM(ORDBTAMT) from SVC35630  where RTV_Number = @RTVNumber and LINITMTYP = 'I' and SVC_Distribution_Type = 4  select @Price = SUM(CRDTAMNT)-SUM(DEBITAMT),@OrigPrice = SUM(ORCRDAMT)-SUM(ORDBTAMT) from SVC35630  where RTV_Number = @RTVNumber and LINITMTYP <> 'I' and SVC_Distribution_Type = 7  end  else  Begin  select @Cost = SUM(CRDTAMNT)-SUM(DEBITAMT),@OrigCost = SUM(ORCRDAMT)-SUM(ORDBTAMT) from SVC35630  where RTV_Number = @RTVNumber and RTV_Line =  @RTVLine and LINITMTYP = 'I' and SVC_Distribution_Type = 4  select @Price = SUM(CRDTAMNT)-SUM(DEBITAMT),@OrigPrice = SUM(ORCRDAMT)-SUM(ORDBTAMT) from SVC35630  where RTV_Number = @RTVNumber and RTV_Line =  @RTVLine and LINITMTYP <> 'I' and SVC_Distribution_Type = 7  End  End  return     
GO
GRANT EXECUTE ON  [dbo].[SVC_Get_RTV_Dist_Amount] TO [DYNGRP]
GO
