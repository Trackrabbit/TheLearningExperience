SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IV00300L_4] (@ITEMNMBR_RS char(31), @LOCNCODE_RS char(11), @LTNUMSLD_RS tinyint, @QTYTYPE_RS smallint, @LOTNUMBR_RS char(21), @DATERECD_RS datetime, @DTSEQNUM_RS numeric(19,5), @ITEMNMBR_RE char(31), @LOCNCODE_RE char(11), @LTNUMSLD_RE tinyint, @QTYTYPE_RE smallint, @LOTNUMBR_RE char(21), @DATERECD_RE datetime, @DTSEQNUM_RE numeric(19,5)) AS  set nocount on IF @ITEMNMBR_RS IS NULL BEGIN SELECT TOP 25  ITEMNMBR, LOCNCODE, DATERECD, DTSEQNUM, LOTNUMBR, QTYRECVD, QTYSOLD, ATYALLOC, UNITCOST, RCTSEQNM, VNDRNMBR, LTNUMSLD, QTYTYPE, BIN, MFGDATE, EXPNDATE, DEX_ROW_ID FROM .IV00300 ORDER BY ITEMNMBR DESC, LOCNCODE DESC, LTNUMSLD DESC, QTYTYPE DESC, LOTNUMBR DESC, DATERECD DESC, DTSEQNUM DESC END ELSE IF @ITEMNMBR_RS = @ITEMNMBR_RE BEGIN SELECT TOP 25  ITEMNMBR, LOCNCODE, DATERECD, DTSEQNUM, LOTNUMBR, QTYRECVD, QTYSOLD, ATYALLOC, UNITCOST, RCTSEQNM, VNDRNMBR, LTNUMSLD, QTYTYPE, BIN, MFGDATE, EXPNDATE, DEX_ROW_ID FROM .IV00300 WHERE ITEMNMBR = @ITEMNMBR_RS AND LOCNCODE BETWEEN @LOCNCODE_RS AND @LOCNCODE_RE AND LTNUMSLD BETWEEN @LTNUMSLD_RS AND @LTNUMSLD_RE AND QTYTYPE BETWEEN @QTYTYPE_RS AND @QTYTYPE_RE AND LOTNUMBR BETWEEN @LOTNUMBR_RS AND @LOTNUMBR_RE AND DATERECD BETWEEN @DATERECD_RS AND @DATERECD_RE AND DTSEQNUM BETWEEN @DTSEQNUM_RS AND @DTSEQNUM_RE ORDER BY ITEMNMBR DESC, LOCNCODE DESC, LTNUMSLD DESC, QTYTYPE DESC, LOTNUMBR DESC, DATERECD DESC, DTSEQNUM DESC END ELSE BEGIN SELECT TOP 25  ITEMNMBR, LOCNCODE, DATERECD, DTSEQNUM, LOTNUMBR, QTYRECVD, QTYSOLD, ATYALLOC, UNITCOST, RCTSEQNM, VNDRNMBR, LTNUMSLD, QTYTYPE, BIN, MFGDATE, EXPNDATE, DEX_ROW_ID FROM .IV00300 WHERE ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND LOCNCODE BETWEEN @LOCNCODE_RS AND @LOCNCODE_RE AND LTNUMSLD BETWEEN @LTNUMSLD_RS AND @LTNUMSLD_RE AND QTYTYPE BETWEEN @QTYTYPE_RS AND @QTYTYPE_RE AND LOTNUMBR BETWEEN @LOTNUMBR_RS AND @LOTNUMBR_RE AND DATERECD BETWEEN @DATERECD_RS AND @DATERECD_RE AND DTSEQNUM BETWEEN @DTSEQNUM_RS AND @DTSEQNUM_RE ORDER BY ITEMNMBR DESC, LOCNCODE DESC, LTNUMSLD DESC, QTYTYPE DESC, LOTNUMBR DESC, DATERECD DESC, DTSEQNUM DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IV00300L_4] TO [DYNGRP]
GO
