SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[taCreatePayCode] @I_vPAYRCORD char(6),    @I_vDSCRIPTN char(30),    @I_vINACTIVE tinyint = 0,   @I_vPAYTYPE smallint=1,     @I_vBSPAYRCD char(6)='',   @I_vPAYRTAMT numeric(19,5)=0,   @I_vPAYUNIT char(25)='',   @I_vPAYUNPER smallint=1,    @I_vPAYPEROD smallint=1,    @I_vMXPYPPER numeric(19,5)=0,   @I_vTipType smallint=1,    @I_vPAYADVNC numeric(19,5)=0,   @I_vRPTASWGS tinyint=0,    @I_vW2BXNMBR smallint=0,   @I_vW2BXLABL char(6)='',   @I_vW2BXNMBR2 smallint=0,    @I_vW2BXLABL2 char(6)='',    @I_vW2BXNMBR3 smallint=0,   @I_vW2BXLABL3 char(6)='',    @I_vW2BXNMBR4 smallint=0,   @I_vW2BXLABL4 char(6)='',    @I_vSBJTFDTX tinyint=1,    @I_vSBJTSSEC tinyint=1,    @I_vSBJTMCAR tinyint=1,    @I_vSBJTSTTX tinyint=1,    @I_vSBJTLTAX tinyint=1,    @I_vSBJTFUTA tinyint=1,    @I_vSBJTSUTA tinyint=1,    @I_vFFEDTXRT numeric(19,2)=0,   @I_vFLSTTXRT numeric(19,2)=0,   @I_vACRUVACN tinyint=0,    @I_vACRUSTIM tinyint=0,    @I_vDATAENTDFLT tinyint=0,   @I_vSHFTCODE char(6)='',   @I_vPAYFACTR numeric(19,5)=0,   @I_vUpdateIfExists tinyint = 1,   @I_vRequesterTrx smallint = 0,   @I_vUSRDEFND1 char(50) = '',       @I_vUSRDEFND2 char(50) = '',       @I_vUSRDEFND3 char(50) = '',       @I_vUSRDEFND4 varchar(8000) = '',  @I_vUSRDEFND5 varchar(8000) = '',  @O_iErrorState int output,   @oErrString varchar(255) output    with encryption as  set transaction isolation level read uncommitted set nocount on  declare  @BSDONRTE numeric(19,5),    @PAYPRPRD numeric(19,5),    @TAXABLE tinyint,     @sCompanyID int,  @iStatus int,  @iCustomState int,  @iCustomErrString varchar(255),  @nNextNoteIndex numeric(19,5),    @iGetNextNoteIdxErrState int,    @iAddCodeErrState int,  @O_oErrorState int,  @iError int      select  @BSDONRTE = 0,       @PAYPRPRD = 0,      @TAXABLE = 1,      @O_iErrorState = 0,     @sCompanyID = CMPANYID from DYNAMICS..SY01500 where INTERID = db_name()  if (@oErrString is NULL) begin  select @oErrString = '' end  exec @iStatus = taCreatePayCodePre  @I_vPAYRCORD output,  @I_vDSCRIPTN output,  @I_vINACTIVE output,  @I_vPAYTYPE output,  @I_vBSPAYRCD output,  @I_vPAYRTAMT output,  @I_vPAYUNIT output,  @I_vPAYUNPER output,  @I_vPAYPEROD output,  @I_vMXPYPPER output,  @I_vTipType output,  @I_vPAYADVNC output,  @I_vRPTASWGS output,  @I_vW2BXNMBR output,  @I_vW2BXLABL output,  @I_vW2BXNMBR2 output,  @I_vW2BXLABL2 output,  @I_vW2BXNMBR3 output,  @I_vW2BXLABL3 output,  @I_vW2BXNMBR4 output,  @I_vW2BXLABL4 output,  @I_vSBJTFDTX output,  @I_vSBJTSSEC output,  @I_vSBJTMCAR output,  @I_vSBJTSTTX output,  @I_vSBJTLTAX output,  @I_vSBJTFUTA output,  @I_vSBJTSUTA output,  @I_vFFEDTXRT output,  @I_vFLSTTXRT output,  @I_vACRUVACN output,  @I_vACRUSTIM output,  @I_vDATAENTDFLT output,  @I_vSHFTCODE output,  @I_vPAYFACTR output,     @I_vUpdateIfExists output,  @I_vRequesterTrx output,  @I_vUSRDEFND1 output,  @I_vUSRDEFND2 output,  @I_vUSRDEFND3 output,  @I_vUSRDEFND4 output,  @I_vUSRDEFND5 output,  @O_iErrorState = @iCustomState output,  @oErrString = @iCustomErrString output select @iError = @@error if @iStatus = 0 and @iError <> 0 begin  select @iStatus = @iError end if (@iStatus <> 0) or (@iCustomState <> 0) begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@iCustomErrString))  select @O_iErrorState = 4185    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if (  @I_vPAYRCORD is NULL or  @I_vDSCRIPTN is NULL or  @I_vINACTIVE is NULL or  @I_vPAYTYPE is NULL or  @I_vBSPAYRCD is NULL or  @I_vPAYRTAMT is NULL or  @I_vPAYUNIT is NULL or  @I_vPAYUNPER is NULL or  @I_vPAYPEROD is NULL or  @I_vMXPYPPER is NULL or  @I_vTipType is NULL or  @I_vPAYADVNC is NULL or  @I_vRPTASWGS is NULL or  @I_vW2BXNMBR is NULL or  @I_vW2BXLABL is NULL or  @I_vW2BXNMBR2 is NULL or  @I_vW2BXLABL2 is NULL or  @I_vW2BXNMBR3 is NULL or  @I_vW2BXLABL3 is NULL or  @I_vW2BXNMBR4 is NULL or  @I_vW2BXLABL4 is NULL or  @I_vSBJTFDTX is NULL or  @I_vSBJTSSEC is NULL or  @I_vSBJTMCAR is NULL or  @I_vSBJTSTTX is NULL or  @I_vSBJTLTAX is NULL or  @I_vSBJTFUTA is NULL or  @I_vSBJTSUTA is NULL or  @I_vFFEDTXRT is NULL or  @I_vFLSTTXRT is NULL or  @I_vACRUVACN is NULL or  @I_vACRUSTIM is NULL or  @I_vDATAENTDFLT is NULL or  @I_vSHFTCODE is NULL or  @I_vPAYFACTR is NULL or      @I_vUpdateIfExists is NULL or  @I_vRequesterTrx is NULL or  @I_vUSRDEFND1 is NULL or  @I_vUSRDEFND2 is NULL or  @I_vUSRDEFND3 is NULL or  @I_vUSRDEFND4 is NULL or  @I_vUSRDEFND5 is NULL  ) begin  select @O_iErrorState = 4186    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  select @I_vPAYRCORD =UPPER(@I_vPAYRCORD),  @I_vBSPAYRCD =UPPER(@I_vBSPAYRCD),  @I_vSHFTCODE =UPPER(@I_vSHFTCODE)  if ( @I_vPAYRCORD = '' ) begin  select @O_iErrorState = 4187    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vDSCRIPTN = '' ) begin  select @O_iErrorState = 4188    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vINACTIVE < 0 or @I_vINACTIVE > 1 ) begin  select @O_iErrorState = 4189     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vPAYTYPE < 1 or @I_vPAYTYPE > 16 ) begin  select @O_iErrorState = 4190     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYRTAMT < 0 )  begin  select @O_iErrorState = 4191     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE < 6 or @I_vPAYTYPE > 7 ) and ( @I_vPAYFACTR <> 0 )  begin  select @O_iErrorState = 5328     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYFACTR < 0 or @I_vPAYFACTR > 999.99 ) begin  select @O_iErrorState = 5329     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE = 6 or @I_vPAYTYPE = 7 ) and ( @I_vPAYRTAMT <> 0 )  begin  select @O_iErrorState = 5330     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE < 6 or @I_vPAYTYPE > 10 ) and ( @I_vBSPAYRCD <> '' ) begin  select @O_iErrorState = 4192     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE >= 6 and @I_vPAYTYPE <= 10 ) and ( @I_vBSPAYRCD <> '' ) begin  if (not exists (select 1 from UPR40600 (nolock) where PAYRCORD = @I_vBSPAYRCD ))  begin  select @O_iErrorState = 3484     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if @I_vPAYTYPE in (2,11,13,14,15,16) and ( @I_vSHFTCODE <> '' ) begin  select @O_iErrorState = 3485     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if @I_vPAYTYPE in (1,2,3,6,7,8,9,10,11,12,13,14,15,16) and ( @I_vMXPYPPER <> 0 ) begin  select @O_iErrorState = 3486     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if @I_vPAYTYPE in (1,3,5,6,7,8,9,10,11,12,13,14,15,16) and ( @I_vPAYADVNC <> 0 ) begin  select @O_iErrorState = 3487     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if  ( @I_vPAYTYPE >= 3 and @I_vPAYTYPE <= 10 ) and ( @I_vSHFTCODE <> '' ) begin  if (not exists (select 1 from UPR41500 (nolock) where SHFTCODE = @I_vSHFTCODE ))  begin  select @O_iErrorState = 4193     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vPAYTYPE <> 5 ) and ( @I_vRPTASWGS <> 0 ) begin  select @O_iErrorState = 4194     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vW2BXNMBR < 0 or @I_vW2BXNMBR > 99 ) begin  select @O_iErrorState = 4196     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vW2BXNMBR2 < 0 or @I_vW2BXNMBR2 > 99 ) begin  select @O_iErrorState = 10498     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vW2BXNMBR3 < 0 or @I_vW2BXNMBR3 > 99 ) begin  select @O_iErrorState = 10499     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vW2BXNMBR4 < 0 or @I_vW2BXNMBR4 > 99 ) begin  select @O_iErrorState = 11300     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE <> 5 ) and ( @I_vW2BXNMBR <> 0 ) begin  select @O_iErrorState = 4195     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE <> 5 ) and ( @I_vW2BXNMBR2 <> 0 ) begin  select @O_iErrorState = 11301     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE <> 5 ) and ( @I_vW2BXNMBR3 <> 0 ) begin  select @O_iErrorState = 11302     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE <> 5 ) and ( @I_vW2BXNMBR4 <> 0 ) begin  select @O_iErrorState = 11303     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE <> 5 ) and ( @I_vW2BXLABL <> '' ) begin  select @O_iErrorState = 4197     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE <> 5 ) and ( @I_vW2BXLABL2 <> '' ) begin  select @O_iErrorState = 11304     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE <> 5 ) and ( @I_vW2BXLABL3 <> '' ) begin  select @O_iErrorState = 11305     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE <> 5 ) and ( @I_vW2BXLABL4 <> '' ) begin  select @O_iErrorState = 11306     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE = 13 )  begin  select  @TAXABLE = 0,   @I_vSBJTFDTX = 0,  @I_vSBJTSSEC = 0,  @I_vSBJTMCAR = 0,  @I_vSBJTSTTX = 0,  @I_vSBJTLTAX = 0,  @I_vSBJTFUTA = 0,  @I_vSBJTSUTA = 0 end  if ( @I_vPAYTYPE <> 3 ) and ( @I_vPAYUNIT <> '' ) begin  select @O_iErrorState = 4198     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE >= 6 and @I_vPAYTYPE <= 10 ) and ( @I_vBSPAYRCD <> '' ) and ( @I_vPAYUNIT = '') begin  select  @I_vPAYUNIT = PAYUNIT from UPR40600 (nolock) where PAYRCORD = @I_vBSPAYRCD end  if ( @I_vPAYTYPE >= 8 and @I_vPAYTYPE <= 10 ) and ( @I_vBSPAYRCD <> '' ) and ( @I_vPAYRTAMT = 0 ) begin  select  @I_vPAYRTAMT = PAYRTAMT from UPR40600 (nolock) where PAYRCORD = @I_vBSPAYRCD end  if ( @I_vPAYTYPE >= 6 and @I_vPAYTYPE <= 10 ) and ( @I_vBSPAYRCD <> '' ) and ( @I_vPAYPEROD = 1 ) begin  select  @I_vPAYPEROD = PAYPEROD from UPR40600 (nolock) where PAYRCORD = @I_vBSPAYRCD end  if ( @I_vPAYTYPE = 6 or @I_vPAYTYPE = 7 ) and ( @I_vBSPAYRCD <> '' )  begin  select @BSDONRTE = PAYRTAMT from UPR40600 (nolock) where PAYRCORD = @I_vBSPAYRCD end   if ( @I_vPAYUNPER < 1 or @I_vPAYUNPER > 8 ) begin  select @O_iErrorState = 4199     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYPEROD < 1 or @I_vPAYPEROD > 8 ) begin  select @O_iErrorState = 4200     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE <> 2 and @I_vPAYTYPE <> 11 and @I_vPAYTYPE <> 13 ) begin  select @PAYPRPRD = 0  end   if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 1 ) and ( @I_vPAYPEROD = 1 ) begin  select @PAYPRPRD = @I_vPAYRTAMT end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 1 ) and ( @I_vPAYPEROD = 2 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 2 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 1 ) and ( @I_vPAYPEROD = 3 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 2.16667  end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 1 ) and ( @I_vPAYPEROD = 4 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 4.33333  end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 1 ) and ( @I_vPAYPEROD = 5 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 13 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 1 ) and ( @I_vPAYPEROD = 6 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 26 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 1 ) and ( @I_vPAYPEROD = 7 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 52 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 1 ) and ( @I_vPAYPEROD = 8 ) begin  select @PAYPRPRD = @I_vPAYRTAMT / 5 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 2 ) and ( @I_vPAYPEROD = 1 ) begin  select @PAYPRPRD = @I_vPAYRTAMT / 2 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 2 ) and ( @I_vPAYPEROD = 2 ) begin  select @PAYPRPRD = @I_vPAYRTAMT end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 2 ) and ( @I_vPAYPEROD = 3 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 1.0833334   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 2 ) and ( @I_vPAYPEROD = 4 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 2.1666666  end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 2 ) and ( @I_vPAYPEROD = 5 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 6.5 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 2 ) and ( @I_vPAYPEROD = 6 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 13 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 2 ) and ( @I_vPAYPEROD = 7 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 26 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 2 ) and ( @I_vPAYPEROD = 8 ) begin  select @PAYPRPRD = @I_vPAYRTAMT / 10 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 3 ) and ( @I_vPAYPEROD = 1 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .4615384   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 3 ) and ( @I_vPAYPEROD = 2 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .923077   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 3 ) and ( @I_vPAYPEROD = 3 ) begin  select @PAYPRPRD = @I_vPAYRTAMT end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 3 ) and ( @I_vPAYPEROD = 4 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 2 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 3 ) and ( @I_vPAYPEROD = 5 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 6 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 3 ) and ( @I_vPAYPEROD = 6 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 12 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 3 ) and ( @I_vPAYPEROD = 7 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 24 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 3 ) and ( @I_vPAYPEROD = 8 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .0923076   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 4 ) and ( @I_vPAYPEROD = 1 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .2307692   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 4 ) and ( @I_vPAYPEROD = 2 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .4615384   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 4 ) and ( @I_vPAYPEROD = 3 ) begin  select @PAYPRPRD = @I_vPAYRTAMT / 2 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 4 ) and ( @I_vPAYPEROD = 4 ) begin  select @PAYPRPRD = @I_vPAYRTAMT end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 4 ) and ( @I_vPAYPEROD = 5 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 3 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 4 ) and ( @I_vPAYPEROD = 6 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 6 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 4 ) and ( @I_vPAYPEROD = 7 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 12 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 4 ) and ( @I_vPAYPEROD = 8 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .0461538   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 5 ) and ( @I_vPAYPEROD = 1 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .076923   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 5 ) and ( @I_vPAYPEROD = 2 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .1538462   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 5 ) and ( @I_vPAYPEROD = 3 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .1666666   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 5 ) and ( @I_vPAYPEROD = 4 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .3333334   end   if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 5 ) and ( @I_vPAYPEROD = 5 ) begin  select @PAYPRPRD = @I_vPAYRTAMT  end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 5 ) and ( @I_vPAYPEROD = 6 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 2 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 5 ) and ( @I_vPAYPEROD = 7 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 4 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 5 ) and ( @I_vPAYPEROD = 8 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .0153846   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 6 ) and ( @I_vPAYPEROD = 1 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .0384616   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 6 ) and ( @I_vPAYPEROD = 2 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .076923   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 6 ) and ( @I_vPAYPEROD = 3 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .0833334   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 6 ) and ( @I_vPAYPEROD = 4 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .1666666   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 6 ) and ( @I_vPAYPEROD = 5 ) begin  select @PAYPRPRD = @I_vPAYRTAMT / 2 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 6 ) and ( @I_vPAYPEROD = 6 ) begin  select @PAYPRPRD = @I_vPAYRTAMT  end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 6 ) and ( @I_vPAYPEROD = 7 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 2 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 6 ) and ( @I_vPAYPEROD = 8 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .0076924   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 7 ) and ( @I_vPAYPEROD = 1 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .0192308   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 7 ) and ( @I_vPAYPEROD = 2 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .0384616   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 7 ) and ( @I_vPAYPEROD = 3 ) begin  select @PAYPRPRD = round(@I_vPAYRTAMT / 24,2)   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 7 ) and ( @I_vPAYPEROD = 4 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .0833334   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 7 ) and ( @I_vPAYPEROD = 5 ) begin  select @PAYPRPRD = @I_vPAYRTAMT / 4 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 7 ) and ( @I_vPAYPEROD = 6 ) begin  select @PAYPRPRD = @I_vPAYRTAMT / 2 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 7 ) and ( @I_vPAYPEROD = 7 ) begin  select @PAYPRPRD = @I_vPAYRTAMT end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 7 ) and ( @I_vPAYPEROD = 8 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * .0038462   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 8 ) and ( @I_vPAYPEROD = 1 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 5 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 8 ) and ( @I_vPAYPEROD = 2 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 10 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 8 ) and ( @I_vPAYPEROD = 3 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 10.8333334   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 8 ) and ( @I_vPAYPEROD = 4 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 21.6666666   end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 8 ) and ( @I_vPAYPEROD = 5 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 65 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 8 ) and ( @I_vPAYPEROD = 6 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 130 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 8 ) and ( @I_vPAYPEROD = 7 ) begin  select @PAYPRPRD = @I_vPAYRTAMT * 260 end  if ( @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13 ) and ( @I_vPAYRTAMT <> 0 ) and ( @I_vPAYUNPER = 8 ) and ( @I_vPAYPEROD = 8 ) begin  select @PAYPRPRD = @I_vPAYRTAMT  end  if ( @I_vMXPYPPER < 0 ) begin  select @O_iErrorState = 4201     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vTipType < 1 or @I_vTipType > 2 ) begin  select @O_iErrorState = 4202     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYTYPE < 14 or @I_vPAYTYPE > 15 ) and ( @I_vTipType = 2 )  begin  select @O_iErrorState = 4203     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPAYADVNC < 0 )  begin  select @O_iErrorState = 4204     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vRPTASWGS < 0 or @I_vRPTASWGS > 1 ) begin  select @O_iErrorState = 4586     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTFDTX < 0 or @I_vSBJTFDTX > 1 ) begin  select @O_iErrorState = 3501     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTSSEC < 0 or @I_vSBJTSSEC > 1 ) begin  select @O_iErrorState = 3502     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTMCAR < 0 or @I_vSBJTMCAR > 1 ) begin  select @O_iErrorState = 3503     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTSTTX < 0 or @I_vSBJTSTTX > 1 ) begin  select @O_iErrorState = 3504     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTLTAX < 0 or @I_vSBJTLTAX > 1 ) begin  select @O_iErrorState = 4205     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTFUTA < 0 or @I_vSBJTFUTA > 1 ) begin  select @O_iErrorState = 4206     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTSUTA < 0 or @I_vSBJTSUTA > 1 ) begin  select @O_iErrorState = 4207     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTFDTX = 0 and @I_vSBJTSSEC = 0 and @I_vSBJTMCAR = 0 and @I_vSBJTSTTX = 0 and @I_vSBJTLTAX = 0 and @I_vSBJTFUTA = 0 and @I_vSBJTSUTA = 0 ) begin  select @TAXABLE = 0 end   if ( @I_vSBJTFDTX = 0 ) and ( @I_vFFEDTXRT > 0 ) begin  select @O_iErrorState = 4208     exec @iStatus = taUpdateString   @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vFFEDTXRT < 0 or @I_vFFEDTXRT > 99.99 )  begin  select @O_iErrorState = 4209     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSBJTSTTX = 0 ) and ( @I_vFLSTTXRT > 0 ) begin  select @O_iErrorState = 4210     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vFLSTTXRT < 0 or @I_vFLSTTXRT > 99.99 ) begin  select @O_iErrorState = 4211     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vACRUVACN < 0 or @I_vACRUVACN > 1 ) begin  select @O_iErrorState = 4212     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vACRUSTIM < 0 or @I_vACRUSTIM > 1 ) begin  select @O_iErrorState = 4213     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vDATAENTDFLT < 0 or @I_vDATAENTDFLT > 1 ) begin  select @O_iErrorState = 4214     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vUpdateIfExists < 0 or @I_vUpdateIfExists > 1 ) begin  select @O_iErrorState = 4215     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vRequesterTrx < 0 or @I_vRequesterTrx > 1)  begin  select @O_iErrorState = 3670     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if @O_iErrorState <> 0  return (@O_iErrorState)  exec @iStatus = DYNAMICS..tasmGetNextNoteIndex  @I_sCompanyID   = @sCompanyID,  @I_iSQLSessionID = 0,  @I_noteincrement  = 1,  @O_mNoteIndex   = @nNextNoteIndex output,  @O_iErrorState  = @iGetNextNoteIdxErrState output select @iError = @@error if ((@iStatus <> 0) or (@iGetNextNoteIdxErrState <> 0) or (@iError <> 0)) begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@iGetNextNoteIdxErrState))  select @O_iErrorState = 4216   exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  begin  if not exists( select 1 from UPR40600 (nolock) where PAYRCORD = @I_vPAYRCORD )  begin  insert UPR40600(  PAYRCORD,  DSCRIPTN,  INACTIVE,  PAYTYPE,  BSPAYRCD,  PAYRTAMT,  PAYUNIT,   PAYUNPER,  PAYPEROD,  PAYPRPRD,  MXPYPPER,  TipType,  PAYADVNC,  RPTASWGS,  W2BXNMBR,  W2BXLABL,  TAXABLE,  SBJTFDTX,  SBJTSSEC,  SBJTMCAR,  SBJTSTTX,  SBJTLTAX,  SBJTFUTA,  SBJTSUTA,  FFEDTXRT,  FLSTTXRT,  ACRUVACN,  ACRUSTIM,  NOTEINDX,  DATAENTDFLT,  SHFTCODE,  PAYFACTR,    BSDONRTE,    W2BXNMBR2,  W2BXLABL2,   W2BXNMBR3,   W2BXLABL3,   W2BXNMBR4,  W2BXLABL4   )  select  @I_vPAYRCORD,    @I_vDSCRIPTN,    @I_vINACTIVE,    @I_vPAYTYPE,    @I_vBSPAYRCD,    case     WHEN @I_vPAYTYPE = 6 or @I_vPAYTYPE = 7  THEN @BSDONRTE * @I_vPAYFACTR  ELSE @I_vPAYRTAMT  end,  case     WHEN @I_vPAYTYPE = 1 or @I_vPAYTYPE = 16  THEN 'Hourly'  ELSE @I_vPAYUNIT   end,  @I_vPAYUNPER,    @I_vPAYPEROD,    case     WHEN @I_vPAYRTAMT = 0  THEN 0  ELSE @PAYPRPRD   end,  @I_vMXPYPPER,    @I_vTipType,    @I_vPAYADVNC,    @I_vRPTASWGS,    @I_vW2BXNMBR,    @I_vW2BXLABL,    @TAXABLE,    @I_vSBJTFDTX,    @I_vSBJTSSEC,    @I_vSBJTMCAR,    @I_vSBJTSTTX,    @I_vSBJTLTAX,    @I_vSBJTFUTA,    @I_vSBJTSUTA,    (@I_vFFEDTXRT * 100),   (@I_vFLSTTXRT * 100),   @I_vACRUVACN,    @I_vACRUSTIM,    @nNextNoteIndex,   @I_vDATAENTDFLT,   @I_vSHFTCODE,    case       WHEN @I_vPAYTYPE = 6 or @I_vPAYTYPE = 7   THEN @I_vPAYFACTR  ELSE 0  end,   case       WHEN @I_vPAYTYPE = 6 or @I_vPAYTYPE = 7   THEN @BSDONRTE   ELSE 0  end,  @I_vW2BXNMBR2,  @I_vW2BXLABL2,   @I_vW2BXNMBR3,   @I_vW2BXLABL3,   @I_vW2BXNMBR4,  @I_vW2BXLABL4   if @@error <> 0  begin  select @O_iErrorState = 4217    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end  end  else  if ( @I_vUpdateIfExists = 1 )  begin  if ( @I_vINACTIVE = 1 )  begin  if (exists (select 1 from UPR40600 (nolock) where BSPAYRCD = @I_vPAYRCORD ))  begin  select @O_iErrorState = 4546   exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end  end  update UPR40600  set DSCRIPTN =  case  WHEN @I_vDSCRIPTN = ''  THEN DSCRIPTN  ELSE @I_vDSCRIPTN  end,  INACTIVE = @I_vINACTIVE,  BSPAYRCD = @I_vBSPAYRCD,  PAYRTAMT =       case  WHEN @I_vPAYTYPE = 6 or @I_vPAYTYPE = 7  THEN @BSDONRTE * @I_vPAYFACTR  ELSE @I_vPAYRTAMT  end,  PAYUNIT =  case  WHEN @I_vPAYTYPE = 1 or @I_vPAYTYPE = 16  THEN 'Hourly'  ELSE @I_vPAYUNIT   end,  PAYUNPER = @I_vPAYUNPER,  PAYPEROD = @I_vPAYPEROD,  PAYPRPRD =  case  WHEN @I_vPAYTYPE = 2 or @I_vPAYTYPE = 11 or @I_vPAYTYPE = 13  THEN @PAYPRPRD  ELSE 0  end,  MXPYPPER =  case  WHEN @I_vPAYTYPE = 4 or @I_vPAYTYPE = 5   THEN @I_vMXPYPPER  ELSE 0  end,  TipType =  case  WHEN @I_vPAYTYPE = 14 or @I_vPAYTYPE = 15   THEN @I_vTipType   ELSE 1  end,  PAYADVNC =  case  WHEN @I_vPAYTYPE = 2 or @I_vPAYTYPE = 4  THEN @I_vPAYADVNC  ELSE 0  end,  RPTASWGS =  case  WHEN @I_vPAYTYPE <> 5  THEN 0  ELSE @I_vRPTASWGS  end,  W2BXNMBR =  case  WHEN @I_vPAYTYPE <> 5  THEN 0  ELSE @I_vW2BXNMBR  end,  W2BXLABL =  case  WHEN @I_vPAYTYPE <> 5  THEN ''  ELSE @I_vW2BXLABL  end,  W2BXNMBR2 =  case  WHEN @I_vPAYTYPE <> 5  THEN 0  ELSE @I_vW2BXNMBR2  end,  W2BXLABL2 =  case  WHEN @I_vPAYTYPE <> 5  THEN ''  ELSE @I_vW2BXLABL2  end,  W2BXNMBR3 =  case  WHEN @I_vPAYTYPE <> 5  THEN 0  ELSE @I_vW2BXNMBR3  end,  W2BXLABL3 =  case  WHEN @I_vPAYTYPE <> 5  THEN ''  ELSE @I_vW2BXLABL3  end,  W2BXNMBR4 =  case  WHEN @I_vPAYTYPE <> 5  THEN 0  ELSE @I_vW2BXNMBR4  end,  W2BXLABL4 =  case  WHEN @I_vPAYTYPE <> 5  THEN ''  ELSE @I_vW2BXLABL4  end,  TAXABLE =  case  WHEN @I_vPAYTYPE = 13   THEN 0   WHEN @I_vSBJTFDTX=0 and @I_vSBJTSSEC=0 and @I_vSBJTMCAR=0 and @I_vSBJTSTTX=0 and @I_vSBJTLTAX=0 and @I_vSBJTFUTA=0 and @I_vSBJTSUTA=0  THEN 0  ELSE 1  end,  SBJTFDTX = @I_vSBJTFDTX,  SBJTSSEC = @I_vSBJTSSEC,  SBJTMCAR = @I_vSBJTMCAR,  SBJTSTTX = @I_vSBJTSTTX,  SBJTLTAX = @I_vSBJTLTAX,  SBJTFUTA = @I_vSBJTFUTA,  SBJTSUTA = @I_vSBJTSUTA,  FFEDTXRT =  case  WHEN @I_vSBJTFDTX = 0   THEN 0  ELSE (@I_vFFEDTXRT * 100)   end,  FLSTTXRT =  case  WHEN @I_vSBJTSTTX = 0  THEN 0  ELSE (@I_vSBJTSTTX * 100)  end,  ACRUVACN = @I_vACRUVACN ,  ACRUSTIM = @I_vACRUSTIM ,  DATAENTDFLT = @I_vDATAENTDFLT ,  SHFTCODE =  case  WHEN @I_vPAYTYPE = 2  THEN ''  WHEN @I_vPAYTYPE = 11  THEN ''  WHEN @I_vPAYTYPE = 13  THEN ''  WHEN @I_vPAYTYPE = 14  THEN ''  WHEN @I_vPAYTYPE = 15  THEN ''  WHEN @I_vPAYTYPE = 16  THEN ''  ELSE @I_vSHFTCODE  end,  PAYFACTR =       case  WHEN @I_vPAYTYPE = 6 or @I_vPAYTYPE = 7   THEN @I_vPAYFACTR  ELSE 0  end,  BSDONRTE =       case  WHEN @I_vPAYTYPE = 6 or @I_vPAYTYPE = 7   THEN @BSDONRTE   ELSE 0  end   where  PAYRCORD = @I_vPAYRCORD  if @@error <> 0  begin  select @O_iErrorState = 4218    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end  end end  exec @iStatus = taCreatePayCodePost  @I_vPAYRCORD,  @I_vDSCRIPTN,  @I_vINACTIVE,  @I_vPAYTYPE,  @I_vBSPAYRCD,  @I_vPAYRTAMT,  @I_vPAYUNIT,  @I_vPAYUNPER,  @I_vPAYPEROD,  @I_vMXPYPPER,  @I_vTipType,  @I_vPAYADVNC,  @I_vRPTASWGS,  @I_vW2BXNMBR,  @I_vW2BXLABL,  @I_vW2BXNMBR2,  @I_vW2BXLABL2,  @I_vW2BXNMBR3,  @I_vW2BXLABL3,  @I_vW2BXNMBR4,  @I_vW2BXLABL4,  @I_vSBJTFDTX,  @I_vSBJTSSEC,  @I_vSBJTMCAR,  @I_vSBJTSTTX,  @I_vSBJTLTAX,  @I_vSBJTFUTA,  @I_vSBJTSUTA,  @I_vFFEDTXRT,  @I_vFLSTTXRT,  @I_vACRUVACN,  @I_vACRUSTIM,  @I_vDATAENTDFLT,  @I_vSHFTCODE,  @I_vPAYFACTR,      @I_vUpdateIfExists,  @I_vRequesterTrx,  @I_vUSRDEFND1,  @I_vUSRDEFND2,  @I_vUSRDEFND3,  @I_vUSRDEFND4,  @I_vUSRDEFND5,  @O_iErrorState = @iCustomState output,  @oErrString = @iCustomErrString output select @iError = @@error if @iStatus = 0 and @iError <> 0 begin  select @iStatus = @iError end if (@iStatus <> 0) or (@iCustomState <> 0) begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@iCustomErrString))  select @O_iErrorState = 4219    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  return (@O_iErrorState)   
GO
GRANT EXECUTE ON  [dbo].[taCreatePayCode] TO [DYNGRP]
GO
