SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create proc [dbo].[rmUpdateRMAppliedOPEN]  @sStartRangeApplyFromDocumentType  smallint =NULL,   @cStartRangeApplyFromDocumentNumber  char(20) =NULL,   @sStartRangeApplyToDocumentType  smallint =NULL,   @cStartRangeApplyToDocumentNumber  char(20) =NULL,  @sEndRangeApplyFromDocumentType  smallint =NULL,   @cEndRangeApplyFromDocumentNumber  char(20) =NULL,   @sEndRangeApplyToDocumentType   smallint =NULL,   @cEndRangeApplyToDocumentNumber  char(20) =NULL,  @tSetValuePosted tinyint  =NULL,  @cSetValueTRXSource char(13) =NULL,  @dSetValueGLPostingDate datetime =NULL,  @dSetValueApplyFromGLPostingDate datetime =NULL,  @dSetValueApplyFromDocumentDate datetime =NULL,  @iErrorState     int  =NULL output as  set nocount on  select @iErrorState = 0  IF   @sStartRangeApplyFromDocumentType  is NULL or  @cStartRangeApplyFromDocumentNumber  is NULL or   @sStartRangeApplyToDocumentType  is NULL or   @cStartRangeApplyToDocumentNumber  is NULL or  @sEndRangeApplyFromDocumentType  is NULL or  @cEndRangeApplyFromDocumentNumber  is NULL or   @sEndRangeApplyToDocumentType   is NULL or   @cEndRangeApplyToDocumentNumber  is NULL or  @tSetValuePosted is NULL or  @cSetValueTRXSource is NULL or  @dSetValueGLPostingDate is NULL or  @dSetValueApplyFromGLPostingDate is NULL or  @dSetValueApplyFromDocumentDate is NULL begin  select @iErrorState = 21076  return end   update  RM20201 set   POSTED    = @tSetValuePosted,  TRXSORCE   = @cSetValueTRXSource,  GLPOSTDT  = @dSetValueGLPostingDate,  ApplyFromGLPostDate = @dSetValueApplyFromGLPostingDate,  APFRDCDT  = @dSetValueApplyFromDocumentDate where  APFRDCTY = @sStartRangeApplyFromDocumentType  and APFRDCNM = @cStartRangeApplyFromDocumentNumber  and APTODCTY between @sStartRangeApplyToDocumentType and @sEndRangeApplyToDocumentType and APTODCNM between @cStartRangeApplyToDocumentNumber and @cEndRangeApplyToDocumentNumber  return(@@error)   
GO
GRANT EXECUTE ON  [dbo].[rmUpdateRMAppliedOPEN] TO [DYNGRP]
GO
