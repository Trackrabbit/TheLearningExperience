SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[taCreateEmployee] @I_vEMPLOYID char(15),    @I_vEMPLCLAS char(15)='',   @I_vINACTIVE tinyint=0,    @I_vLASTNAME char(20),    @I_vFRSTNAME char(15),    @I_vMIDLNAME char(15)='',   @I_vEMPLSUFF char(4)= '',   @I_vADRSCODE char(15)='',   @I_vADDRESS1 char(60)='',   @I_vADDRESS2 char(60)='',   @I_vADDRESS3 char(60)='',   @I_vCITY char(35)='',    @I_vSTATE char(29)='',    @I_vZIPCODE char(10)='',   @I_vCOUNTY char(60)='',    @I_vCOUNTRY char(60)='',   @I_vPHONE1 char(21)='',    @I_vPHONE2 char(21)='',    @I_vPHONE3 char(21)='',    @I_vFAX char(21)='',    @I_vSOCSCNUM char(15),    @I_vBRTHDATE datetime='',   @I_vGENDER smallint=3,    @I_vETHNORGN smallint=7,    @I_vCalc_Min_Wage_Bal tinyint=null,  @I_vDIVISIONCODE_I char(6)='',   @I_vDEPRTMNT char(6),    @I_vJOBTITLE char(6),    @I_vSUPERVISORCODE_I char(6)='',  @I_vLOCATNID char(15)='',   @I_vWCACFPAY smallint=0,   @I_vAccountNumber char(75)='',   @I_vWKHRPRYR smallint=0,   @I_vSTRTDATE datetime='',   @I_vDEMPINAC datetime='',   @I_vRSNEMPIN char(30)='',   @I_vMINETPAY numeric(19,5)=null,  @I_vSUTASTAT char(2)='',   @I_vWRKRCOMP char(6)='',   @I_vATACRVAC tinyint=null,   @I_vVACCRAMT numeric(19,5)=null,  @I_vVACCRMTH smallint=null,   @I_vVACAPRYR numeric(19,5)=null,  @I_vVACAVLBL numeric(19,5)=null,  @I_vWRNVCNFLSBLWZR tinyint =null,  @I_vATACRSTM tinyint=null,   @I_vSTMACMTH smallint = 0,   @I_vSKTMACAM numeric(19,5)=null,  @I_vSIKTIMAV numeric(19,5)=null,  @I_vSKTMHPYR numeric(19,5)=null,  @I_vWRNSTFLSBLWZR tinyint=null,   @I_vUSERDEF1 char(20)='',   @I_vUSERDEF2 char(20)='',   @I_vEMPLOYMENTTYPE smallint=null,  @I_vMARITALSTATUS smallint=3,   @I_vBENADJDATE datetime='',   @I_vLASTDAYWORKED_I datetime='' ,  @I_vBIRTHDAY smallint=0,   @I_vBIRTHMONTH smallint=0,   @I_vSPOUSE char(15)='',    @I_vSPOUSESSN char(15)='',   @I_vNICKNAME char(20)='',   @I_vALTERNATENAME char(20)='',   @I_vSTATUSCD char(15) = '',   @I_vHRSTATUS smallint=1,    @I_vDATEOFLASTREVIEW_I datetime='' ,  @I_vDATEOFNEXTREVIEW_I datetime='' ,  @I_vBENEFITEXPIRE_I datetime='' ,  @I_vHANDICAPPED tinyint=0,   @I_vVETERAN tinyint=0,    @I_vVIETNAMVETERAN tinyint=0,   @I_vDISABLEDVETERAN tinyint=0,   @I_vUNIONEMPLOYEE tinyint=0,   @I_vSMOKER_I tinyint=0,    @I_vCITIZEN tinyint=0,    @I_vVERIFIED tinyint=0,    @I_vI9RENEW datetime='',   @I_vPrimary_Pay_Record char(6) = '',  @I_vCHANGEBY_I char(15)='',   @I_vCHANGEDATE_I datetime='',   @I_vUNIONCD char(6)='',    @I_vRATECLSS char(15)='',   @I_vFEDCLSSCD char(10)='',   @I_vOTHERVET tinyint = 0,   @I_vMilitary_Discharge_Date datetime='', @I_vDefaultFromClass tinyint = 1,  @I_vUpdateIfExists tinyint = 1,   @I_vRequesterTrx smallint = 0,   @I_vUSRDEFND1 char(50) = '',       @I_vUSRDEFND2 char(50) = '',       @I_vUSRDEFND3 char(50) = '',       @I_vUSRDEFND4 varchar(8000) = '',  @I_vUSRDEFND5 varchar(8000) = '',  @I_vUSERID char(15) = '',    @O_iErrorState int output,   @oErrString varchar(255) output    with encryption as  set transaction isolation level read uncommitted set nocount on  declare  @ACTINDX int,      @iStatus int,  @iAddCodeErrState int,  @iStatement int,  @O_oErrorState int,  @iGetNextNoteIdxErrState int,    @iCustomState int,  @iCustomErrString varchar(255),   @iError int,      @DBName char(50),     @O_iInitErrorState int,     @oInitErrString varchar(255),    @nNextNoteIndex numeric(19,5),    @iAddAddressErrState int,    @iAddAddressErrString varchar(255),   @ActualDate datetime,    @WORKFLOWENABLED smallint,     @Workflow_Approval_Status smallint,   @Workflow_Priority smallint,        @sCompanyID int      select  @ACTINDX = 0,      @iStatus = 0,  @iAddCodeErrState = 0,  @O_oErrorState = 0,  @iStatement = 0,  @O_iErrorState = 0,     @ActualDate = convert(varchar(12),getdate()),   @WORKFLOWENABLED = 0,  @Workflow_Approval_Status = 0,   @Workflow_Priority = 0,  @sCompanyID = CMPANYID from DYNAMICS..SY01500 where INTERID = db_name()  if (@oErrString is NULL) begin  select @oErrString = '' end  exec @iStatus = taCreateEmployeePre  @I_vEMPLOYID output,  @I_vEMPLCLAS output,  @I_vINACTIVE output,  @I_vLASTNAME output,  @I_vFRSTNAME output,  @I_vMIDLNAME output,  @I_vEMPLSUFF output,  @I_vADRSCODE output,  @I_vADDRESS1 output,  @I_vADDRESS2 output,  @I_vADDRESS3 output,  @I_vCITY output,  @I_vSTATE output,  @I_vZIPCODE output,  @I_vCOUNTY output,  @I_vCOUNTRY output,  @I_vPHONE1 output,  @I_vPHONE2 output,  @I_vPHONE3 output,  @I_vFAX output,  @I_vSOCSCNUM output,  @I_vBRTHDATE output,  @I_vGENDER output,  @I_vETHNORGN output,  @I_vCalc_Min_Wage_Bal output,  @I_vDIVISIONCODE_I output,  @I_vDEPRTMNT output,  @I_vJOBTITLE output,  @I_vSUPERVISORCODE_I output,  @I_vLOCATNID output,  @I_vWCACFPAY output,  @I_vAccountNumber output,  @I_vWKHRPRYR output,  @I_vSTRTDATE output,  @I_vDEMPINAC output,  @I_vRSNEMPIN output,  @I_vMINETPAY output,  @I_vSUTASTAT output,  @I_vWRKRCOMP output,  @I_vATACRVAC output,  @I_vVACCRAMT output,  @I_vVACCRMTH output,  @I_vVACAPRYR output,  @I_vVACAVLBL output,  @I_vWRNVCNFLSBLWZR output,  @I_vATACRSTM output,  @I_vSTMACMTH output,  @I_vSKTMACAM output,  @I_vSIKTIMAV output,  @I_vSKTMHPYR output,  @I_vWRNSTFLSBLWZR output,  @I_vUSERDEF1 output,  @I_vUSERDEF2 output,  @I_vEMPLOYMENTTYPE output,  @I_vMARITALSTATUS output,  @I_vBENADJDATE output,  @I_vLASTDAYWORKED_I output,  @I_vBIRTHDAY output,  @I_vBIRTHMONTH output,  @I_vSPOUSE output,  @I_vSPOUSESSN output,  @I_vNICKNAME output,  @I_vALTERNATENAME output,  @I_vSTATUSCD output,  @I_vHRSTATUS output,  @I_vDATEOFLASTREVIEW_I output,  @I_vDATEOFNEXTREVIEW_I output,  @I_vBENEFITEXPIRE_I output,  @I_vHANDICAPPED output,  @I_vVETERAN output,  @I_vVIETNAMVETERAN output,  @I_vDISABLEDVETERAN output,  @I_vUNIONEMPLOYEE output,  @I_vSMOKER_I output,  @I_vCITIZEN output,  @I_vVERIFIED output,  @I_vI9RENEW output,  @I_vPrimary_Pay_Record output,  @I_vCHANGEBY_I output,  @I_vCHANGEDATE_I output,  @I_vUNIONCD output,  @I_vRATECLSS output,  @I_vFEDCLSSCD output,  @I_vOTHERVET output,  @I_vMilitary_Discharge_Date output,     @I_vDefaultFromClass output,  @I_vUpdateIfExists output,  @I_vRequesterTrx output,  @I_vUSRDEFND1 output,  @I_vUSRDEFND2 output,  @I_vUSRDEFND3 output,  @I_vUSRDEFND4 output,  @I_vUSRDEFND5 output,  @I_vUSERID output,      @O_iErrorState = @iCustomState output,  @oErrString = @oErrString  output select @iError = @@error if @iStatus = 0 and @iError <> 0 begin  select @iStatus = @iError end if (@iStatus <> 0) or (@iCustomState <> 0) begin  select @O_iErrorState = 4550    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if    (  @I_vEMPLOYID is NULL or   @I_vEMPLCLAS is NULL or  @I_vINACTIVE is NULL or  @I_vLASTNAME is NULL or  @I_vFRSTNAME is NULL or  @I_vMIDLNAME is NULL or  @I_vEMPLSUFF is NULL or   @I_vADRSCODE is NULL or  @I_vADDRESS1 is NULL or  @I_vADDRESS2 is NULL or  @I_vADDRESS3 is NULL or  @I_vCITY is NULL or  @I_vSTATE is NULL or  @I_vZIPCODE is NULL or  @I_vCOUNTY is NULL or  @I_vCOUNTRY is NULL or  @I_vPHONE1 is NULL or  @I_vPHONE2 is NULL or  @I_vPHONE3 is NULL or  @I_vFAX is NULL or  @I_vSOCSCNUM is NULL or  @I_vBRTHDATE is NULL or  @I_vGENDER is NULL or  @I_vETHNORGN is NULL or  @I_vDIVISIONCODE_I is NULL or  @I_vDEPRTMNT is NULL or  @I_vJOBTITLE is NULL or  @I_vSUPERVISORCODE_I is NULL or  @I_vLOCATNID is NULL or  @I_vWCACFPAY is NULL or  @I_vAccountNumber is NULL or  @I_vWKHRPRYR is NULL or  @I_vSTRTDATE is NULL or  @I_vDEMPINAC is NULL or  @I_vRSNEMPIN is NULL or  @I_vSUTASTAT is NULL or  @I_vWRKRCOMP is NULL or  @I_vSTMACMTH is NULL or  @I_vUSERDEF1 is NULL or  @I_vUSERDEF2 is NULL or  @I_vMARITALSTATUS is NULL or  @I_vBENADJDATE is NULL or  @I_vLASTDAYWORKED_I is NULL or  @I_vBIRTHDAY is NULL or  @I_vBIRTHMONTH is NULL or  @I_vSPOUSE is NULL or  @I_vSPOUSESSN is NULL or  @I_vNICKNAME is NULL or  @I_vALTERNATENAME is NULL or  @I_vSTATUSCD is NULL or   @I_vHRSTATUS is NULL or  @I_vDATEOFLASTREVIEW_I is NULL or  @I_vDATEOFNEXTREVIEW_I is NULL or  @I_vBENEFITEXPIRE_I is NULL or  @I_vHANDICAPPED is NULL or  @I_vVETERAN is NULL or  @I_vVIETNAMVETERAN is NULL or  @I_vDISABLEDVETERAN is NULL or  @I_vUNIONEMPLOYEE is NULL or  @I_vSMOKER_I is NULL or  @I_vCITIZEN is NULL or  @I_vVERIFIED is NULL or  @I_vI9RENEW is NULL or  @I_vPrimary_Pay_Record is NULL or  @I_vCHANGEBY_I is NULL or  @I_vCHANGEDATE_I is NULL or  @I_vUNIONCD is NULL or  @I_vRATECLSS is NULL or  @I_vFEDCLSSCD is NULL or  @I_vOTHERVET is NULL or  @I_vMilitary_Discharge_Date is NULL or      @I_vDefaultFromClass is NULL or  @I_vUpdateIfExists is NULL or  @I_vRequesterTrx is NULL or  @I_vUSRDEFND1 is NULL or  @I_vUSRDEFND2 is NULL or  @I_vUSRDEFND3 is NULL or  @I_vUSRDEFND4 is NULL or  @I_vUSRDEFND5 is NULL   ) begin  select @O_iErrorState = 4551    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  select  @I_vEMPLOYID = UPPER(@I_vEMPLOYID),  @I_vEMPLCLAS = UPPER(@I_vEMPLCLAS),  @I_vADRSCODE = UPPER(@I_vADRSCODE),  @I_vDEPRTMNT = UPPER(@I_vDEPRTMNT),  @I_vJOBTITLE = UPPER(@I_vJOBTITLE),  @I_vLOCATNID = UPPER(@I_vLOCATNID),  @I_vSUPERVISORCODE_I = UPPER(@I_vSUPERVISORCODE_I),  @I_vSUTASTAT = UPPER(@I_vSUTASTAT),  @I_vWRKRCOMP = UPPER(@I_vWRKRCOMP),  @I_vPrimary_Pay_Record = UPPER(@I_vPrimary_Pay_Record),  @I_vDIVISIONCODE_I = UPPER(@I_vDIVISIONCODE_I)  if ( @I_vEMPLOYID = '' ) begin  select @O_iErrorState = 4359    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vEMPLCLAS <> '' ) begin  if (not exists (select 1 from UPR41200 (nolock) where EMPLCLAS = @I_vEMPLCLAS ))  begin  select @O_iErrorState = 4360     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vINACTIVE< 0 or  @I_vINACTIVE > 1) begin  select @O_iErrorState = 4361     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vLASTNAME = '' ) begin  select @O_iErrorState = 4362    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vFRSTNAME = '' ) begin  select @O_iErrorState = 4363    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSOCSCNUM = '')  begin  select @O_iErrorState = 4364     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vGENDER < 1 or @I_vGENDER > 3 ) begin  select @O_iErrorState = 1500     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vETHNORGN < 1 or @I_vETHNORGN > 8 ) begin  select @O_iErrorState = 3812     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vDEPRTMNT <> '' ) begin  if (not exists (select 1 from UPR40300 (nolock) where DEPRTMNT = @I_vDEPRTMNT ))  begin  select @O_iErrorState = 4366     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vJOBTITLE <> '' )  begin  if (not exists (select 1 from UPR40301 (nolock) where JOBTITLE = @I_vJOBTITLE ))  begin  select @O_iErrorState = 4367     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vDIVISIONCODE_I <> '' ) begin  if (not exists (select 1 from HR2DIV02 (nolock) where DIVISIONCODE_I = @I_vDIVISIONCODE_I ))  begin  select @O_iErrorState = 5884     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vSUPERVISORCODE_I <> '' )  begin  if (not exists (select 1 from UPR41700 (nolock) where SUPERVISORCODE_I = @I_vSUPERVISORCODE_I ))  begin  select @O_iErrorState = 4368     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vLOCATNID <> '' ) begin  if (not exists (select 1 from SY00600 (nolock) where LOCATNID = @I_vLOCATNID and CMPANYID = @sCompanyID))  begin  select @O_iErrorState = 4369     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vWCACFPAY < 0 or @I_vWCACFPAY > 1 )  begin  select @O_iErrorState = 4370     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vWKHRPRYR < 0 )  begin  select @O_iErrorState = 3813     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vWKHRPRYR > 9999 )  begin  select @O_iErrorState = 8293     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vINACTIVE = 1 and @I_vDEMPINAC = '' ) begin  select @O_iErrorState = 3814     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vINACTIVE = 1 and @I_vRSNEMPIN = '' ) begin  select @O_iErrorState = 3815     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vINACTIVE = 0) and (@I_vDEMPINAC <> '') begin  select @O_iErrorState = 9529     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vINACTIVE = 0) and (@I_vRSNEMPIN <> '') begin  select @O_iErrorState = 9530     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vDEMPINAC <> '') and (@I_vSTRTDATE <> '') begin  if (@I_vDEMPINAC < @I_vSTRTDATE)  begin  select @O_iErrorState = 9531     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if (@I_vDEMPINAC <> '') and (@I_vBRTHDATE <> '') begin  if (@I_vDEMPINAC < @I_vBRTHDATE)  begin  select @O_iErrorState = 9532     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if (@I_vSTRTDATE <> '') and (@I_vBRTHDATE <> '') begin  if (@I_vSTRTDATE < @I_vBRTHDATE)  begin  select @O_iErrorState = 9533     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if (@I_vLASTDAYWORKED_I <> '') and (@I_vDEMPINAC <> '') begin  if (@I_vLASTDAYWORKED_I > @I_vDEMPINAC)  begin  select @O_iErrorState = 9534     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if (@I_vLASTDAYWORKED_I <> '') and (@I_vSTRTDATE <> '') begin  if (@I_vLASTDAYWORKED_I < @I_vSTRTDATE)  begin  select @O_iErrorState = 9535     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if (@I_vLASTDAYWORKED_I <> '') and (@I_vBRTHDATE <> '') begin  if (@I_vLASTDAYWORKED_I < @I_vBRTHDATE)  begin  select @O_iErrorState = 9536     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vINACTIVE = 1 ) begin  if  exists(select 1 from UPR10202 (nolock) where EMPLOYID = @I_vEMPLOYID) or   exists(select 1 from UPR10302 (nolock) where EMPLOYID = @I_vEMPLOYID) or   exists(select 1 from UPR10307 (nolock) where EMPLOYID = @I_vEMPLOYID)  begin  select @O_iErrorState = 5650    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end  if ( @I_vSUTASTAT <> '')  begin  if (not exists (select 1 from UPR41100 (nolock) where STATECD = @I_vSUTASTAT ))  begin  select @O_iErrorState = 3817     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vWRKRCOMP <> '' )  begin  if (not exists (select 1 from UPR40700 (nolock) where WRKRCOMP = @I_vWRKRCOMP ))  begin  select @O_iErrorState = 3818     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vSTMACMTH < 0 or @I_vSTMACMTH > 1 ) begin  select @O_iErrorState = 3826     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vMARITALSTATUS < 1 or @I_vMARITALSTATUS > 3 ) begin  select @O_iErrorState = 3832     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBIRTHMONTH < 0 or @I_vBIRTHMONTH > 12 ) begin  select @O_iErrorState = 3833     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBIRTHMONTH > 0 and @I_vBIRTHDAY = 0 ) begin  select @O_iErrorState = 3834     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBIRTHDAY < 0 or @I_vBIRTHDAY > 31 ) begin  select @O_iErrorState = 3835     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vBIRTHMONTH = 2 ) and ( @I_vBIRTHDAY > 29 ) begin  select @O_iErrorState = 3836     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vBIRTHMONTH in (4,6,9,11)) and (@I_vBIRTHDAY > 30) begin  select @O_iErrorState = 3837     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vHRSTATUS < 1 or @I_vHRSTATUS > 9 ) begin  select @O_iErrorState = 3838     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vHANDICAPPED < 0 or @I_vHANDICAPPED > 1 ) begin  select @O_iErrorState = 3839     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vVETERAN < 0 or @I_vVETERAN > 1 ) begin  select @O_iErrorState = 3840     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vVIETNAMVETERAN < 0 or @I_vVIETNAMVETERAN > 1 ) begin  select @O_iErrorState = 3841     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vDISABLEDVETERAN < 0 or @I_vDISABLEDVETERAN > 1 ) begin  select @O_iErrorState = 3842     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vUNIONEMPLOYEE < 0 or @I_vUNIONEMPLOYEE > 1 ) begin  select @O_iErrorState = 3843     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSMOKER_I < 0 or @I_vSMOKER_I > 1 ) begin  select @O_iErrorState = 3844     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vCITIZEN < 0 or @I_vCITIZEN > 1 ) begin  select @O_iErrorState = 4479     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vVERIFIED < 0 or @I_vVERIFIED > 1 ) begin  select @O_iErrorState = 4480     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vOTHERVET < 0 or @I_vOTHERVET > 1 ) begin  select @O_iErrorState = 4481     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vUpdateIfExists < 0 or @I_vUpdateIfExists > 1 ) begin  select @O_iErrorState = 4482     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vUpdateIfExists <> 1) begin   if (exists (select 1 from UPR00100 (nolock) where EMPLOYID = @I_vEMPLOYID))   begin  select @O_iErrorState = 8694     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vRequesterTrx < 0 or @I_vRequesterTrx > 1 ) begin  select @O_iErrorState = 3666     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vPrimary_Pay_Record <> '' )  begin  if (not exists (select 1 from UPR40600 (nolock) where PAYRCORD = @I_vPrimary_Pay_Record ))  begin  select @O_iErrorState = 4548     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  end end  if ( @I_vDefaultFromClass < 0 or @I_vDefaultFromClass > 1 ) begin  select @O_iErrorState = 4483     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vDefaultFromClass = 1) and (@I_vEMPLCLAS = '') begin  select @O_iErrorState = 8695     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if  ( @I_vAccountNumber <> '' ) begin  select @ACTINDX = ACTINDX from GL00105 (nolock) where ACTNUMST = @I_vAccountNumber  if (@ACTINDX is null) or (@ACTINDX = 0)  begin  select @O_iErrorState = 4484     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end end  if (@I_vUSERID <> '') and (@I_vUSERID is not NULL) begin  if not exists( select 1  from DYNAMICS..SY01400 where USERID = @I_vUSERID )     begin  select @O_iErrorState = 11997   exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end  else  begin  if exists( select 1  from UPR00100 where USERID = @I_vUSERID )     begin   select @O_iErrorState = 12005   exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  end   end end  if ( @I_vEMPLCLAS <> '' and @I_vDefaultFromClass = 1 )  begin   select  @I_vDEPRTMNT =  case   WHEN @I_vDEPRTMNT = ''  THEN DEPRTMNT  ELSE @I_vDEPRTMNT  end,  @I_vJOBTITLE =  case  WHEN @I_vJOBTITLE = ''  THEN JOBTITLE  ELSE @I_vJOBTITLE  end,  @I_vSUTASTAT =  case  WHEN @I_vSUTASTAT = ''  THEN SUTASTAT  ELSE @I_vSUTASTAT  end,   @I_vWRKRCOMP =  case  WHEN @I_vWRKRCOMP = ''  THEN WRKRCOMP  ELSE @I_vWRKRCOMP  end,  @I_vMINETPAY =  case  WHEN @I_vMINETPAY is null   THEN MINETPAY  ELSE @I_vMINETPAY  end,  @I_vWKHRPRYR =  case  WHEN @I_vWKHRPRYR = 0   THEN WKHRPRYR  ELSE @I_vWKHRPRYR  end,  @I_vUSERDEF1 =  case  WHEN @I_vUSERDEF1 = ''  THEN USERDEF1  ELSE @I_vUSERDEF1  end,  @I_vUSERDEF2 =  case  WHEN @I_vUSERDEF2 = ''  THEN USERDEF2  ELSE @I_vUSERDEF2  end,  @I_vATACRVAC =       case  WHEN @I_vATACRVAC is null   THEN ATACRVAC  ELSE @I_vATACRVAC  end,  @I_vVACCRMTH =       case  WHEN @I_vATACRVAC = 0  THEN 0  WHEN @I_vVACCRMTH is null  THEN VACCRMTH  ELSE @I_vVACCRMTH  end,  @I_vVACCRAMT =       case  WHEN @I_vATACRVAC = 0   THEN 0  WHEN @I_vVACCRAMT is null   THEN VACCRAMT  ELSE @I_vVACCRAMT * 100  end,  @I_vVACAPRYR =       case  WHEN @I_vATACRVAC = 0  THEN 0  WHEN @I_vVACAPRYR is null  THEN VACAPRYR  ELSE @I_vVACAPRYR * 100  end,  @I_vVACAVLBL =       case  WHEN @I_vVACAVLBL is null  THEN VACAVLBL  ELSE @I_vVACAVLBL * 100  end,  @I_vWRNVCNFLSBLWZR =      case  WHEN @I_vWRNVCNFLSBLWZR is null  THEN WRNVCNFLSBLWZR  ELSE 1   end,  @I_vATACRSTM =       case  WHEN @I_vATACRSTM is null  THEN ATACRSTM  ELSE 0      end,  @I_vSKTMACAM =       case  WHEN @I_vATACRSTM = 0  THEN 0   WHEN @I_vSKTMACAM is null  THEN SKTMACAM  ELSE @I_vSKTMACAM * 100  end,  @I_vSKTMHPYR =       case  WHEN @I_vATACRSTM = 0  THEN 0   WHEN @I_vSKTMHPYR is null  THEN SKTMHPYR  ELSE @I_vSKTMHPYR * 100  end,  @I_vSIKTIMAV =       case  WHEN @I_vSIKTIMAV is null  THEN SIKTIMAV  ELSE @I_vSIKTIMAV * 100  end,  @I_vWRNSTFLSBLWZR =  case  WHEN @I_vWRNSTFLSBLWZR is null  THEN WRNSTFLSBLWZR  ELSE 1      end,  @I_vCalc_Min_Wage_Bal =     case  WHEN @I_vCalc_Min_Wage_Bal is null  THEN Calc_Min_Wage_Bal  ELSE @I_vCalc_Min_Wage_Bal  end,  @I_vEMPLOYMENTTYPE =      case  WHEN @I_vEMPLOYMENTTYPE is null  THEN EMPLOYMENTTYPE  ELSE @I_vEMPLOYMENTTYPE  end,  @ACTINDX =  case  WHEN @ACTINDX = 0  THEN ACTINDX  ELSE @ACTINDX  end  from UPR41200 (nolock)  where EMPLCLAS = @I_vEMPLCLAS end else begin   if ( @I_vMINETPAY is null )  begin  select @I_vMINETPAY = 0  end   if ( @I_vWKHRPRYR = 0 )   begin  select @I_vWKHRPRYR = 2080  end   if ( @I_vATACRVAC is null )  begin  select @I_vATACRVAC = 0  end   if ( @I_vATACRVAC = 0 )   begin  select @I_vVACCRAMT = 0  end   if ( @I_vVACCRMTH is null )   begin  select @I_vVACCRMTH = 0  end   if ( @I_vVACCRAMT is null )  begin  select @I_vVACCRAMT = 0  end   if ( @I_vVACAPRYR is null )   begin  select @I_vVACAPRYR = 0  end   if ( @I_vATACRSTM is null )  begin  select @I_vATACRSTM = 0  end   if ( @I_vSKTMACAM is null )   begin  select @I_vSKTMACAM = 0  end   if ( @I_vSKTMHPYR is null )  begin  select @I_vSKTMHPYR = 0  end   if ( @I_vSIKTIMAV is null )  begin  select @I_vSIKTIMAV = 0  end   if ( @I_vWRNVCNFLSBLWZR is null )   begin  select @I_vWRNVCNFLSBLWZR = 1   end   if ( @I_vWRNSTFLSBLWZR is null )  begin  select @I_vWRNSTFLSBLWZR = 1  end   if ( @I_vCalc_Min_Wage_Bal is null )  begin  select @I_vCalc_Min_Wage_Bal = 0  end   if ( @I_vEMPLOYMENTTYPE is null )  begin  select @I_vEMPLOYMENTTYPE = 1  end   if ( @I_vVACAVLBL is null)  begin  select @I_vVACAVLBL = 0   end end  if ( @I_vATACRVAC = 1 and @I_vVACCRMTH = 0 and @I_vDefaultFromClass = 1 ) begin  select @I_vVACCRAMT = 0 end  if ( @I_vATACRSTM = 1 and @I_vSTMACMTH = 0 and @I_vDefaultFromClass = 1 ) begin  select @I_vSKTMACAM = 0  end  if ( @I_vATACRVAC = 1 and @I_vVACCRMTH = 1 and @I_vDefaultFromClass = 1 ) begin  select @I_vVACAPRYR = 0  end  if ( @I_vATACRSTM = 1 and @I_vSTMACMTH = 1 and @I_vDefaultFromClass = 1 ) begin  select @I_vSKTMHPYR = 0  end  if ( @I_vATACRVAC = 0 and @I_vVACCRMTH <> 0 ) begin  select @O_iErrorState = 4485     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRVAC = 0 and @I_vVACCRAMT <> 0 ) begin  select @O_iErrorState = 4486     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRVAC = 0 and @I_vVACAPRYR <> 0 ) begin  select @O_iErrorState = 4487     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vVACCRMTH = 0 ) and ( @I_vVACCRAMT <> 0 ) begin  select @O_iErrorState = 4488     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRSTM = 0 and @I_vSTMACMTH <> 0 ) begin  select @O_iErrorState = 4489     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRSTM = 0 and @I_vSKTMHPYR <> 0 ) begin  select @O_iErrorState = 4490     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRSTM = 0 ) and ( @I_vSKTMHPYR <> 0 ) begin  select @O_iErrorState = 4491     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSTMACMTH = 0 ) and ( @I_vSKTMACAM <> 0 ) begin  select @O_iErrorState = 4492     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,   @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRVAC = 1 and @I_vVACCRMTH = 0 and @I_vVACCRAMT <> 0 ) begin  select @O_iErrorState = 4493     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRSTM = 1 and @I_vSTMACMTH = 0 and @I_vSKTMACAM <> 0 ) begin  select @O_iErrorState = 4494     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRVAC = 1 and @I_vVACCRMTH = 1 and @I_vVACAPRYR <> 0 ) begin  select @O_iErrorState = 4495     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRSTM = 1 and @I_vSTMACMTH = 1 and @I_vSKTMHPYR <> 0 ) begin  select @O_iErrorState = 4496     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vCalc_Min_Wage_Bal < 0 or @I_vCalc_Min_Wage_Bal > 1 ) begin  select @O_iErrorState = 4365     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vMINETPAY < 0 ) begin  select @O_iErrorState = 3816     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vVACCRAMT < 0 ) begin  select @O_iErrorState = 3820     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vVACCRMTH < 0 or @I_vVACCRMTH > 1 ) begin  select @O_iErrorState = 3821     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vVACAPRYR < 0 ) begin  select @O_iErrorState = 3822     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vVACAVLBL < 0 ) begin  select @O_iErrorState = 3823     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vWRNVCNFLSBLWZR < 0 or @I_vWRNVCNFLSBLWZR > 1 ) begin  select @O_iErrorState = 3824     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRSTM < 0 or @I_vATACRSTM > 1 ) begin  select @O_iErrorState = 3825     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSIKTIMAV < 0 ) begin  select @O_iErrorState = 3828     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSKTMHPYR < 0 ) begin  select @O_iErrorState = 3829     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vWRNSTFLSBLWZR < 0 or @I_vWRNSTFLSBLWZR > 1 ) begin  select @O_iErrorState = 3830     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vEMPLOYMENTTYPE < 1 or @I_vEMPLOYMENTTYPE > 6 ) begin  select @O_iErrorState = 3831     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vATACRVAC < 0 or @I_vATACRVAC > 1 ) begin  select @O_iErrorState = 3819     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vSKTMACAM < 0 ) begin  select @O_iErrorState = 3827     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vCHANGEDATE_I = '' ) begin  select @I_vCHANGEDATE_I = @ActualDate end  if @O_iErrorState <> 0  return (@O_iErrorState)  exec @iStatus = DYNAMICS..tasmGetNextNoteIndex  @I_sCompanyID   = @sCompanyID,  @I_iSQLSessionID = 0,  @I_noteincrement  = 1,  @O_mNoteIndex   = @nNextNoteIndex output,  @O_iErrorState  = @iGetNextNoteIdxErrState output select @iError = @@error if ((@iStatus <> 0) or (@iGetNextNoteIdxErrState <> 0) or (@iError <> 0)) begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@iGetNextNoteIdxErrState))  select @O_iErrorState = 4497   exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output end  if not exists(select 1 from UPR00100 (nolock) where EMPLOYID = @I_vEMPLOYID)  begin  select @WORKFLOWENABLED = WORKFLOWENABLED from DYNAMICS..SY01500 where INTERID = db_name()  if (@WORKFLOWENABLED = 1)  begin  select @Workflow_Approval_Status = 1, @Workflow_Priority = 2  end  else  begin  select @Workflow_Approval_Status = 9, @Workflow_Priority = 2  end  insert UPR00100(  EMPLOYID,  EMPLCLAS,  INACTIVE,  LASTNAME,  FRSTNAME,  MIDLNAME,  EMPLSUFF,  ADRSCODE,  SOCSCNUM,  BRTHDATE,  GENDER,  ETHNORGN,  Calc_Min_Wage_Bal,  DIVISIONCODE_I,  DEPRTMNT,  JOBTITLE,  SUPERVISORCODE_I,  LOCATNID,  WCACFPAY,  ACTINDX,  WKHRPRYR,  STRTDATE,  DEMPINAC,  RSNEMPIN,  MINETPAY,  SUTASTAT,  WRKRCOMP,  ATACRVAC,  VACCRAMT,  VACCRMTH,  VACAPRYR,  VACAVLBL,  WRNVCNFLSBLWZR,  ATACRSTM,  STMACMTH,  SKTMACAM,  SIKTIMAV,  SKTMHPYR,  WRNSTFLSBLWZR,  USERDEF1,  USERDEF2,  EMPLOYMENTTYPE,  MARITALSTATUS,  BENADJDATE,  LASTDAYWORKED_I,  BIRTHDAY,  BIRTHMONTH,  SPOUSE,  SPOUSESSN,  NICKNAME,  ALTERNATENAME,  HRSTATUS,  DATEOFLASTREVIEW_I,  DATEOFNEXTREVIEW_I,  BENEFITEXPIRE_I,  HANDICAPPED,  VETERAN,  VIETNAMVETERAN,  DISABLEDVETERAN,  UNIONEMPLOYEE,  SMOKER_I,  CITIZEN,  VERIFIED,  I9RENEW,  Primary_Pay_Record,  CHANGEBY_I,  CHANGEDATE_I,  NOTEINDX,  NOTEINDX2,  UNIONCD,  RATECLSS,  FEDCLSSCD,  OTHERVET,  Military_Discharge_Date,    STATUSCD,  Workflow_Approval_Status,  Workflow_Priority,  USERID  )  select  @I_vEMPLOYID,      @I_vEMPLCLAS,      @I_vINACTIVE,      @I_vLASTNAME,      @I_vFRSTNAME,      @I_vMIDLNAME,      @I_vEMPLSUFF,      @I_vADRSCODE,      @I_vSOCSCNUM,      @I_vBRTHDATE,      @I_vGENDER,      @I_vETHNORGN,      @I_vCalc_Min_Wage_Bal,     @I_vDIVISIONCODE_I,     @I_vDEPRTMNT,      @I_vJOBTITLE,      @I_vSUPERVISORCODE_I,     @I_vLOCATNID,      @I_vWCACFPAY,      @ACTINDX,      @I_vWKHRPRYR,      @I_vSTRTDATE,      @I_vDEMPINAC,      @I_vRSNEMPIN,      @I_vMINETPAY,      @I_vSUTASTAT,      @I_vWRKRCOMP,      @I_vATACRVAC,      @I_vVACCRAMT,      @I_vVACCRMTH,      @I_vVACAPRYR,      @I_vVACAVLBL,      @I_vWRNVCNFLSBLWZR,     @I_vATACRSTM,      @I_vSTMACMTH,      @I_vSKTMACAM,      @I_vSIKTIMAV,      @I_vSKTMHPYR,      @I_vWRNSTFLSBLWZR,     @I_vUSERDEF1,      @I_vUSERDEF2,      @I_vEMPLOYMENTTYPE,     @I_vMARITALSTATUS,     @I_vBENADJDATE,      @I_vLASTDAYWORKED_I,     case          WHEN @I_vBIRTHDAY = 0 and @I_vBRTHDATE <> ''  THEN datepart(day,@I_vBRTHDATE)  ELSE @I_vBIRTHDAY  end,  case        WHEN @I_vBIRTHMONTH = 0 and @I_vBRTHDATE <> ''  THEN datepart(month,@I_vBRTHDATE)  ELSE @I_vBIRTHMONTH  end,  @I_vSPOUSE,      @I_vSPOUSESSN,      @I_vNICKNAME,      @I_vALTERNATENAME,     @I_vHRSTATUS,      @I_vDATEOFLASTREVIEW_I,     @I_vDATEOFNEXTREVIEW_I,     @I_vBENEFITEXPIRE_I,     @I_vHANDICAPPED,     @I_vVETERAN,      @I_vVIETNAMVETERAN,     @I_vDISABLEDVETERAN,     @I_vUNIONEMPLOYEE,     @I_vSMOKER_I,      @I_vCITIZEN,      @I_vVERIFIED,      @I_vI9RENEW,      @I_vPrimary_Pay_Record,     @I_vCHANGEBY_I,       @I_vCHANGEDATE_I,     @nNextNoteIndex,     0,       @I_vUNIONCD,      @I_vRATECLSS,      @I_vFEDCLSSCD,      @I_vOTHERVET,      @I_vMilitary_Discharge_Date,    @I_vSTATUSCD,      @Workflow_Approval_Status,   @Workflow_Priority,     case   WHEN @I_vUSERID = null  THEN ''  ELSE @I_vUSERID       end  if(@@error<>0)  begin  select @O_iErrorState = 4498    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end else if ( @I_vUpdateIfExists = 1 ) begin   select @WORKFLOWENABLED = WORKFLOWENABLED from DYNAMICS..SY01500 where INTERID = db_name()  if (@WORKFLOWENABLED = 1)  begin  if( exists(select 1 from UPR00100 where Workflow_Approval_Status = 4 and EMPLOYID = @I_vEMPLOYID))  begin  select @O_iErrorState = 11399     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState)  end  else  begin  select @Workflow_Approval_Status = 1, @Workflow_Priority = 2  end  end  else  begin  select @Workflow_Approval_Status = 9, @Workflow_Priority = 2  end  update UPR00100 set  EMPLCLAS = @I_vEMPLCLAS,  INACTIVE = @I_vINACTIVE,  LASTNAME =  case  WHEN @I_vLASTNAME = ''  THEN LASTNAME  ELSE @I_vLASTNAME  end,  FRSTNAME =  case  WHEN @I_vFRSTNAME = ''  THEN FRSTNAME  ELSE @I_vFRSTNAME  end,  MIDLNAME = @I_vMIDLNAME,  EMPLSUFF = @I_vEMPLSUFF,  ADRSCODE = @I_vADRSCODE,  SOCSCNUM =  case  WHEN @I_vSOCSCNUM = ''  THEN SOCSCNUM  ELSE @I_vSOCSCNUM  end,  BRTHDATE = @I_vBRTHDATE,  GENDER = @I_vGENDER,  ETHNORGN = @I_vETHNORGN,  Calc_Min_Wage_Bal = @I_vCalc_Min_Wage_Bal,  DIVISIONCODE_I = @I_vDIVISIONCODE_I,       DEPRTMNT =  case  WHEN @I_vDEPRTMNT = ''  THEN DEPRTMNT  ELSE @I_vDEPRTMNT  end,  JOBTITLE =  case  WHEN @I_vJOBTITLE = ''  THEN JOBTITLE  ELSE @I_vJOBTITLE  end,  SUPERVISORCODE_I = @I_vSUPERVISORCODE_I,  LOCATNID = @I_vLOCATNID,  WCACFPAY = @I_vWCACFPAY,  ACTINDX = @ACTINDX,  WKHRPRYR = @I_vWKHRPRYR,  STRTDATE = @I_vSTRTDATE,  DEMPINAC = @I_vDEMPINAC,  RSNEMPIN = @I_vRSNEMPIN,  MINETPAY = @I_vMINETPAY,  SUTASTAT = @I_vSUTASTAT,  WRKRCOMP = @I_vWRKRCOMP,  ATACRVAC = @I_vATACRVAC,  VACCRAMT =  case   WHEN @I_vVACCRMTH = 0  THEN 0   ELSE @I_vVACCRAMT   end ,  VACCRMTH =  case  WHEN @I_vATACRVAC = 0  THEN 0   ELSE @I_vVACCRMTH  end,   VACAPRYR =  case  WHEN @I_vATACRVAC = 1 and @I_vVACCRMTH = 1  THEN 0   ELSE @I_vVACAPRYR   end,  VACAVLBL = @I_vVACAVLBL,  WRNVCNFLSBLWZR = @I_vWRNVCNFLSBLWZR,  ATACRSTM = @I_vATACRSTM,  STMACMTH =  case  WHEN @I_vATACRSTM = 0  THEN 0   ELSE @I_vSTMACMTH  end,  SKTMACAM =  case  WHEN @I_vSTMACMTH = 0  THEN 0  else @I_vSKTMACAM   end,  SIKTIMAV = @I_vSIKTIMAV,  SKTMHPYR =  case  WHEN @I_vATACRSTM = 1 and @I_vSTMACMTH = 1  THEN 0  ELSE @I_vSKTMHPYR  end,  WRNSTFLSBLWZR = @I_vWRNSTFLSBLWZR,  USERDEF1 = @I_vUSERDEF1,  USERDEF2 = @I_vUSERDEF2,  EMPLOYMENTTYPE = @I_vEMPLOYMENTTYPE,  MARITALSTATUS = @I_vMARITALSTATUS,  BENADJDATE = @I_vBENADJDATE,  LASTDAYWORKED_I = @I_vLASTDAYWORKED_I,  BIRTHDAY = @I_vBIRTHDAY,  BIRTHMONTH = @I_vBIRTHMONTH,  SPOUSE = @I_vSPOUSE,  SPOUSESSN = @I_vSPOUSESSN,  NICKNAME = @I_vNICKNAME,  ALTERNATENAME = @I_vALTERNATENAME,  HRSTATUS = @I_vHRSTATUS,  DATEOFLASTREVIEW_I = @I_vDATEOFLASTREVIEW_I,  DATEOFNEXTREVIEW_I = @I_vDATEOFNEXTREVIEW_I,  BENEFITEXPIRE_I = @I_vBENEFITEXPIRE_I,  HANDICAPPED = @I_vHANDICAPPED,  VETERAN = @I_vVETERAN,  VIETNAMVETERAN = @I_vVIETNAMVETERAN,  DISABLEDVETERAN = @I_vDISABLEDVETERAN,  UNIONEMPLOYEE = @I_vUNIONEMPLOYEE,  SMOKER_I = @I_vSMOKER_I,  CITIZEN = @I_vCITIZEN,  VERIFIED = @I_vVERIFIED,  I9RENEW = @I_vI9RENEW,  Primary_Pay_Record = @I_vPrimary_Pay_Record,  CHANGEBY_I = @I_vCHANGEBY_I,          CHANGEDATE_I = @I_vCHANGEDATE_I,  UNIONCD = @I_vUNIONCD,  RATECLSS = @I_vRATECLSS,  FEDCLSSCD = @I_vFEDCLSSCD,  OTHERVET = @I_vOTHERVET,  Military_Discharge_Date = @I_vMilitary_Discharge_Date,  STATUSCD = @I_vSTATUSCD,  Workflow_Approval_Status = @Workflow_Approval_Status,   Workflow_Priority = @Workflow_Priority,  USERID =   CASE WHEN @I_vUSERID = null  THEN ''  ELSE @I_vUSERID  END      where EMPLOYID = @I_vEMPLOYID  if @@error <> 0  begin  select @O_iErrorState = 4549    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end  if (@I_vADRSCODE <> '') begin  if (not exists (select 1 from UPR00102 (nolock) where EMPLOYID = @I_vEMPLOYID and ADRSCODE = @I_vADRSCODE))  begin  exec @iStatus = taCreateEmployeeAddress  @I_vEMPLOYID = @I_vEMPLOYID,  @I_vADRSCODE = @I_vADRSCODE,  @I_vADDRESS1 = @I_vADDRESS1,  @I_vADDRESS2 = @I_vADDRESS2,  @I_vADDRESS3 = @I_vADDRESS3,  @I_vCITY = @I_vCITY,  @I_vSTATE = @I_vSTATE,  @I_vZIPCODE = @I_vZIPCODE,  @I_vCOUNTY = @I_vCOUNTY,  @I_vCOUNTRY = @I_vCOUNTRY,  @I_vPHONE1 = @I_vPHONE1,  @I_vPHONE2 = @I_vPHONE2,  @I_vPHONE3 = @I_vPHONE3,  @I_vFAX = @I_vFAX,  @O_iErrorState = @iAddAddressErrState output,  @oErrString = @iAddAddressErrString output  select @iError = @@error  if @iStatus = 0 and @iError <> 0  begin  select @iStatus = @iError  end  if (@iStatus <> 0) or (@iAddAddressErrState <> 0)  begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@iAddAddressErrString))  select @O_iErrorState = 4499   exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,   @oErrString output,  @iAddCodeErrState output  end  end end  exec @iStatus = taCreateEmployeePost  @I_vEMPLOYID,  @I_vEMPLCLAS,  @I_vINACTIVE,  @I_vLASTNAME,  @I_vFRSTNAME,  @I_vMIDLNAME,  @I_vEMPLSUFF,  @I_vADRSCODE,  @I_vADDRESS1,   @I_vADDRESS2,  @I_vADDRESS3,  @I_vCITY,  @I_vSTATE,  @I_vZIPCODE,  @I_vCOUNTY,  @I_vCOUNTRY,  @I_vPHONE1,  @I_vPHONE2,  @I_vPHONE3,  @I_vFAX,  @I_vSOCSCNUM,  @I_vBRTHDATE,  @I_vGENDER,  @I_vETHNORGN,  @I_vCalc_Min_Wage_Bal,  @I_vDIVISIONCODE_I,  @I_vDEPRTMNT,  @I_vJOBTITLE,  @I_vSUPERVISORCODE_I,  @I_vLOCATNID,  @I_vWCACFPAY,  @I_vAccountNumber,  @I_vWKHRPRYR,  @I_vSTRTDATE,  @I_vDEMPINAC,  @I_vRSNEMPIN,  @I_vMINETPAY,  @I_vSUTASTAT,  @I_vWRKRCOMP,  @I_vATACRVAC,  @I_vVACCRAMT,  @I_vVACCRMTH,  @I_vVACAPRYR,  @I_vVACAVLBL,  @I_vWRNVCNFLSBLWZR,  @I_vATACRSTM,  @I_vSTMACMTH,  @I_vSKTMACAM,  @I_vSIKTIMAV,  @I_vSKTMHPYR,  @I_vWRNSTFLSBLWZR,  @I_vUSERDEF1,  @I_vUSERDEF2,  @I_vEMPLOYMENTTYPE,  @I_vMARITALSTATUS,  @I_vBENADJDATE,  @I_vLASTDAYWORKED_I,  @I_vBIRTHDAY,  @I_vBIRTHMONTH,  @I_vSPOUSE,  @I_vSPOUSESSN,  @I_vNICKNAME,  @I_vALTERNATENAME,  @I_vSTATUSCD,  @I_vHRSTATUS,  @I_vDATEOFLASTREVIEW_I,  @I_vDATEOFNEXTREVIEW_I,  @I_vBENEFITEXPIRE_I,  @I_vHANDICAPPED,  @I_vVETERAN,  @I_vVIETNAMVETERAN,  @I_vDISABLEDVETERAN,  @I_vUNIONEMPLOYEE,  @I_vSMOKER_I,  @I_vCITIZEN,  @I_vVERIFIED,  @I_vI9RENEW,  @I_vPrimary_Pay_Record,  @I_vCHANGEBY_I,  @I_vCHANGEDATE_I,  @I_vUNIONCD,  @I_vRATECLSS,  @I_vFEDCLSSCD,  @I_vOTHERVET,  @I_vMilitary_Discharge_Date,     @I_vDefaultFromClass,  @I_vUpdateIfExists,  @I_vRequesterTrx,  @I_vUSRDEFND1,  @I_vUSRDEFND2,  @I_vUSRDEFND3,  @I_vUSRDEFND4,  @I_vUSRDEFND5,  @I_vUSERID,       @O_iErrorState = @iCustomState output,  @oErrString = @oErrString  output select @iError = @@error if @iStatus = 0 and @iError <> 0 begin  select @iStatus = @iError end if (@iStatus <> 0) or (@iCustomState <> 0) begin  select @O_iErrorState = 4500    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  return @O_iErrorState   
GO
GRANT EXECUTE ON  [dbo].[taCreateEmployee] TO [DYNGRP]
GO
