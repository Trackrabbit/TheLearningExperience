SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SVC06300UN_3] (@BS int, @NXTSTATID char(11), @NXTSEQ numeric(19,5), @NXTSTATID_RS char(11), @NXTSEQ_RS numeric(19,5), @NXTSTATID_RE char(11), @NXTSEQ_RE numeric(19,5)) AS  set nocount on IF @NXTSTATID_RS IS NULL BEGIN SELECT TOP 25  STATIONID, SEQUENCE1, Queue_Status, WORECTYPE, WORKORDNUM, Route_Sequence, SVC_Depot_Priority, Status, TECHID, ETTR, ETADTE, ETATME, ECOMPDT, EComp_Time, ACTSTRTDTE, ACTSTRTTME, LSTSTAID, Last_Sequence, NXTSTATID, NXTSEQ, DEX_ROW_ID FROM .SVC06300 WHERE ( NXTSTATID = @NXTSTATID AND NXTSEQ > @NXTSEQ OR NXTSTATID > @NXTSTATID ) ORDER BY NXTSTATID ASC, NXTSEQ ASC, DEX_ROW_ID ASC END ELSE IF @NXTSTATID_RS = @NXTSTATID_RE BEGIN SELECT TOP 25  STATIONID, SEQUENCE1, Queue_Status, WORECTYPE, WORKORDNUM, Route_Sequence, SVC_Depot_Priority, Status, TECHID, ETTR, ETADTE, ETATME, ECOMPDT, EComp_Time, ACTSTRTDTE, ACTSTRTTME, LSTSTAID, Last_Sequence, NXTSTATID, NXTSEQ, DEX_ROW_ID FROM .SVC06300 WHERE NXTSTATID = @NXTSTATID_RS AND NXTSEQ BETWEEN @NXTSEQ_RS AND @NXTSEQ_RE AND ( NXTSTATID = @NXTSTATID AND NXTSEQ > @NXTSEQ OR NXTSTATID > @NXTSTATID ) ORDER BY NXTSTATID ASC, NXTSEQ ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  STATIONID, SEQUENCE1, Queue_Status, WORECTYPE, WORKORDNUM, Route_Sequence, SVC_Depot_Priority, Status, TECHID, ETTR, ETADTE, ETATME, ECOMPDT, EComp_Time, ACTSTRTDTE, ACTSTRTTME, LSTSTAID, Last_Sequence, NXTSTATID, NXTSEQ, DEX_ROW_ID FROM .SVC06300 WHERE NXTSTATID BETWEEN @NXTSTATID_RS AND @NXTSTATID_RE AND NXTSEQ BETWEEN @NXTSEQ_RS AND @NXTSEQ_RE AND ( NXTSTATID = @NXTSTATID AND NXTSEQ > @NXTSEQ OR NXTSTATID > @NXTSTATID ) ORDER BY NXTSTATID ASC, NXTSEQ ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SVC06300UN_3] TO [DYNGRP]
GO
