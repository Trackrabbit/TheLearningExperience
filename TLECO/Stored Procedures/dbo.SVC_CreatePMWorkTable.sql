SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 CREATE Procedure [dbo].[SVC_CreatePMWorkTable] (  @BeginCustomer char(15),  @EndCustomer char(15),  @BeginItem char(31),  @EndItem char(31),  @BeginSerial char(21),  @EndSerial char(21),  @BeginSchedule char(9),  @EndSchedule char(9),  @CurrentDate datetime,      @CheckDate datetime ) As delete from SVC00350 INSERT INTO SVC00350  (EQUIPID, SVC_PM_Annual_Date, SCHEDID, PMDTLID, FREQOFPM, SRVTYPE, QUANTITY, SVC_PM_Type,   SVC_Meter_Type,CONTNBR,LNSEQNBR) SELECT  SVC00300.EQUIPID,  case   when (SVC00300.SVC_PM_Date is null) or (SVC00300.SVC_PM_Date = 0) THEN '01/01/1900 00:00:00'  when (SVC00300.SVC_PM_Day is null) or (SVC00300.SVC_PM_Day = 0)  THEN '01/01/1900 00:00:00'  else   CONVERT(datetime,(CONVERT(varchar(2),SVC00300.SVC_PM_Date) + '/' +   CONVERT(varchar(2),SVC00300.SVC_PM_Day) + '/' +   CONVERT(varchar(4),DATEPART(yy,@CurrentDate)) + ' 00:00:00'))  end,    SVC8009.SCHEDID,   SVC8009.PMDTLID,   SVC8009.FREQOFPM,  SVC8005.SRVTYPE,  SVC8009.QUANTITY,  SVC8009.SVC_PM_Type,  SVC8009.SVC_Meter_Type,  '',  0  FROM SVC00300 INNER JOIN  SVC00315 ON SVC00300.EQUIPID = SVC00315.EQUIPID INNER JOIN  SVC8005 ON (SVC00315.SCHEDID = SVC8005.SCHEDID) INNER JOIN  SVC8009 ON (SVC8005.SCHEDID = SVC8009.SCHEDID)  WHERE   (SVC00300.CUSTNMBR >= @BeginCustomer AND SVC00300.CUSTNMBR <= @EndCustomer) AND   (SVC00300.ITEMNMBR >= @BeginItem AND SVC00300.ITEMNMBR <= @EndItem) AND   (SVC00315.SCHEDID >= @BeginSchedule AND SVC00315.SCHEDID <= @EndSchedule) AND   (SVC00300.SERLNMBR >= @BeginSerial AND SVC00300.SERLNMBR <= @EndSerial) AND  (SVC00315.ACTIVE = 1)  return    
GO
GRANT EXECUTE ON  [dbo].[SVC_CreatePMWorkTable] TO [DYNGRP]
GO
