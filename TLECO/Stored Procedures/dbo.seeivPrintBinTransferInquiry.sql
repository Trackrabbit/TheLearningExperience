SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[seeivPrintBinTransferInquiry]   @in_QuantityType smallint,  @in_LocationCode VARCHAR(11) = null,  @in_StartFromBin VARCHAR(15) = null,  @in_EndFromBin VARCHAR(15) = null,  @in_StartToBin VARCHAR(15) = null,  @in_EndToBin VARCHAR(15) = null,  @in_StartReasonCode VARCHAR(15) = null,  @in_EndReasonCode VARCHAR(15) = null,  @in_StartBinTransferDocNumber VARCHAR(21) = null,  @in_EndBinTransferDocNumber VARCHAR(21) = null,  @in_StartBinTransferDate datetime = null,  @in_EndBinTransferDate datetime = null,  @in_StartItemNumber VARCHAR(31) = null,  @in_EndItemNumber VARCHAR(31) = null AS  declare @DrillBack_Base_Url varchar(255)  select @DrillBack_Base_Url = DYNAMICS.dbo.createBaseDrillBackUrlString(DB_NAME(),0)  select @in_LocationCode = Case When @in_LocationCode Is Null Or @in_LocationCode = '' Then 'ALL' Else @in_LocationCode End select @in_StartFromBin = Case When @in_StartFromBin Is Null Or @in_StartFromBin = '' Then 'ALL' Else @in_StartFromBin End select @in_EndFromBin = Case When @in_EndFromBin Is Null Or @in_EndFromBin = '' Then 'ALL' Else @in_EndFromBin End select @in_StartToBin = Case When @in_StartToBin Is Null Or @in_StartToBin = '' Then 'ALL' Else @in_StartToBin End select @in_EndToBin = Case When @in_EndToBin Is Null Or @in_EndToBin = '' Then 'ALL' Else @in_EndToBin End select @in_StartReasonCode = Case When @in_StartReasonCode Is Null Or @in_StartReasonCode = '' Then 'ALL' Else @in_StartReasonCode End select @in_EndReasonCode = Case When @in_EndReasonCode Is Null Or @in_EndReasonCode = '' Then 'ALL' Else @in_EndReasonCode End select @in_StartBinTransferDocNumber = Case When @in_StartBinTransferDocNumber Is Null Or @in_StartBinTransferDocNumber = '' Then 'ALL' Else @in_StartBinTransferDocNumber End select @in_EndBinTransferDocNumber = Case When @in_EndBinTransferDocNumber Is Null Or @in_EndBinTransferDocNumber = '' Then 'ALL' Else @in_EndBinTransferDocNumber End select @in_StartBinTransferDate = Case When @in_StartBinTransferDate Is Null Or @in_StartBinTransferDate = '' Then GETDATE() Else @in_StartBinTransferDate End select @in_EndBinTransferDate = Case When @in_EndBinTransferDate Is Null Or @in_EndBinTransferDate = '' Then GETDATE() Else @in_EndBinTransferDate End select @in_StartItemNumber = Case When @in_StartItemNumber Is Null Or @in_StartItemNumber = '' Then 'ALL' Else @in_StartItemNumber End select @in_EndItemNumber = Case When @in_EndItemNumber Is Null Or @in_EndItemNumber = '' Then 'ALL' Else @in_EndItemNumber End select @in_QuantityType = Case When @in_QuantityType Is Null Or @in_QuantityType = '' Then 1 Else @in_QuantityType End    SELECT a.DOCTYPE,a.Bin_XFer_Doc_Number,a.Bin_XFer_Date,a.SEQNUMBR,a.ITEMNMBR,a.LOCNCODE,a.QTYTYPE,  a.FROMBIN,a.TOBIN,a.SERLTNUM,a.SERLTQTY,a.DATERECD,a.DTSEQNUM,a.OVRSERLT,a.Reason_Code,  a.USERID,a.NOTEINDX,a.DEX_ROW_ID,b.ITEMDESC,b.ITMTRKOP,b.DECPLQTY,c.BASEUOFM,  (@DrillBack_Base_Url + dbo.dgppItemID(1,b.[ITEMNMBR],b.[LOCNCODE])) as Item_Number_For_DrillBack   FROM IV30004 a, IV00101 b, IV40201 c  WHERE (@in_LocationCode='ALL' or (a.LOCNCODE=@in_LocationCode))  and (@in_StartFromBin='ALL' or (FROMBIN>=@in_StartFromBin))  and (@in_EndFromBin='ALL' or (FROMBIN<=@in_EndFromBin))  and (@in_StartToBin='ALL' or (TOBIN>=@in_StartToBin))  and (@in_EndToBin='ALL' or (TOBIN<=@in_EndToBin))  and (@in_StartReasonCode='ALL' or (Reason_Code>=@in_StartReasonCode))  and (@in_EndReasonCode='ALL' or (Reason_Code<=@in_EndReasonCode))  and (@in_StartBinTransferDocNumber='ALL' or (Bin_XFer_Doc_Number>=@in_StartBinTransferDocNumber))  and (@in_EndBinTransferDocNumber='ALL' or (Bin_XFer_Doc_Number<=@in_EndBinTransferDocNumber))  and (@in_StartBinTransferDate='' or (Bin_XFer_Date>=@in_StartBinTransferDate))  and (@in_EndBinTransferDate='' or (Bin_XFer_Date<=@in_EndBinTransferDate))  and (@in_StartItemNumber='ALL' or (a.ITEMNMBR>=@in_StartItemNumber))  and (@in_EndItemNumber='ALL' or (a.ITEMNMBR<=@in_EndItemNumber))  and (QTYTYPE=@in_QuantityType)  and a.ITEMNMBR=b.ITEMNMBR and b.UOMSCHDL=c.UOMSCHDL  ORDER BY Bin_XFer_Doc_Number   
GO
GRANT EXECUTE ON  [dbo].[seeivPrintBinTransferInquiry] TO [DYNGRP]
GO
GRANT EXECUTE ON  [dbo].[seeivPrintBinTransferInquiry] TO [rpt_materials manager]
GO
GRANT EXECUTE ON  [dbo].[seeivPrintBinTransferInquiry] TO [rpt_operations manager]
GO
GRANT EXECUTE ON  [dbo].[seeivPrintBinTransferInquiry] TO [rpt_power user]
GO
GRANT EXECUTE ON  [dbo].[seeivPrintBinTransferInquiry] TO [rpt_production manager]
GO
GRANT EXECUTE ON  [dbo].[seeivPrintBinTransferInquiry] TO [rpt_warehouse manager]
GO
