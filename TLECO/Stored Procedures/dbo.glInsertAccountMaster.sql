SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[glInsertAccountMaster]  @I_cDuplicateFlag char(1)   = NULL,  @I_cFixedOrVariable char(1)   = NULL,  @I_cSelectList varchar(255) = NULL,  @I_cUser_ID char(15)  = NULL,  @I_cAccount_MSTR_Table_Name char(255)  = NULL,  @I_cGETMSG123 char(255) = NULL,  @I_cGETMSG5709 char(255)  = NULL,  @I_cGETMSG17800 char(255)  = NULL,  @O_SQL_Error_State int    = NULL   output as  select @O_SQL_Error_State = 0  if (  @I_cDuplicateFlag is NULL or  @I_cFixedOrVariable is NULL or  @I_cSelectList is NULL or  @I_cUser_ID is NULL or  @I_cAccount_MSTR_Table_Name is NULL or  @I_cGETMSG123 is NULL or  @I_cGETMSG5709 is NULL or  @I_cGETMSG17800 is NULL)  begin  select          @O_SQL_Error_State = 20859  return end  exec(' insert into   GL00100   (ACTINDX,  ' + @I_cSelectList + ',  ACCTTYPE,  ACTDESCR,  ACCATNUM,  ACTIVE,  FXDORVAR,  ACCTENTR)  select   GL00105.ACTINDX,  ' + @I_cSelectList + ',  ACCTTYPE,  ''' + @I_cGETMSG123 + ''',  1,  1,'  + @I_cFixedOrVariable + ',  1   from   GL00105,  #SY_FM_Error_Log   where   GL00105.ACTINDX = #SY_FM_Error_Log.ACTINDX   and #SY_FM_Error_Log.DUPLICATE = ' + @I_cDuplicateFlag)  exec (' update   GL00100   set  GL00100.ACCATNUM = GL10110.ACCATNUM  from  GL00100,  GL10110,  #SY_FM_Error_Log  where  GL00100.ACTINDX = #SY_FM_Error_Log.ACTINDX   and  GL10110.ACTINDX = GL00100.ACTINDX ')  insert into  SY03400 select  @I_cUser_ID,  INDEX1,  @I_cAccount_MSTR_Table_Name,  ERMSGTXT =  CASE  WHEN (DUPLICATE = 1)   then stuff(@I_cGETMSG5709,charindex ('%1',@I_cGETMSG5709),2,rtrim(ACTNUMST))  ELSE   stuff(@I_cGETMSG17800,charindex ('%1',@I_cGETMSG17800),2,ltrim(str(ACTINDX)))  END,  '' from  #SY_FM_Error_Log  delete #SY_FM_Error_Log   return    
GO
GRANT EXECUTE ON  [dbo].[glInsertAccountMaster] TO [DYNGRP]
GO
