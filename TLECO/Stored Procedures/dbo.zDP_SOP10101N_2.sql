SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_SOP10101N_2] (@BS int, @SALSTERR char(15), @SOPTYPE smallint, @SOPNUMBE char(21), @SLPRSNID char(15), @SALSTERR_RS char(15), @SOPTYPE_RS smallint, @SOPNUMBE_RS char(21), @SLPRSNID_RS char(15), @SALSTERR_RE char(15), @SOPTYPE_RE smallint, @SOPNUMBE_RE char(21), @SLPRSNID_RE char(15)) AS  set nocount on IF @SALSTERR_RS IS NULL BEGIN SELECT TOP 25  SOPTYPE, SOPNUMBE, SEQNUMBR, SLPRSNID, SALSTERR, COMPRCNT, COMMAMNT, OCOMMAMT, NCOMAMNT, ORNCMAMT, PRCTOSAL, ACTSLAMT, ORSLSAMT, CMMSLAMT, ORCOSAMT, CURRNIDX, TRXSORCE, DEX_ROW_ID FROM .SOP10101 WHERE ( SALSTERR = @SALSTERR AND SOPTYPE = @SOPTYPE AND SOPNUMBE = @SOPNUMBE AND SLPRSNID > @SLPRSNID OR SALSTERR = @SALSTERR AND SOPTYPE = @SOPTYPE AND SOPNUMBE > @SOPNUMBE OR SALSTERR = @SALSTERR AND SOPTYPE > @SOPTYPE OR SALSTERR > @SALSTERR ) ORDER BY SALSTERR ASC, SOPTYPE ASC, SOPNUMBE ASC, SLPRSNID ASC END ELSE IF @SALSTERR_RS = @SALSTERR_RE BEGIN SELECT TOP 25  SOPTYPE, SOPNUMBE, SEQNUMBR, SLPRSNID, SALSTERR, COMPRCNT, COMMAMNT, OCOMMAMT, NCOMAMNT, ORNCMAMT, PRCTOSAL, ACTSLAMT, ORSLSAMT, CMMSLAMT, ORCOSAMT, CURRNIDX, TRXSORCE, DEX_ROW_ID FROM .SOP10101 WHERE SALSTERR = @SALSTERR_RS AND SOPTYPE BETWEEN @SOPTYPE_RS AND @SOPTYPE_RE AND SOPNUMBE BETWEEN @SOPNUMBE_RS AND @SOPNUMBE_RE AND SLPRSNID BETWEEN @SLPRSNID_RS AND @SLPRSNID_RE AND ( SALSTERR = @SALSTERR AND SOPTYPE = @SOPTYPE AND SOPNUMBE = @SOPNUMBE AND SLPRSNID > @SLPRSNID OR SALSTERR = @SALSTERR AND SOPTYPE = @SOPTYPE AND SOPNUMBE > @SOPNUMBE OR SALSTERR = @SALSTERR AND SOPTYPE > @SOPTYPE OR SALSTERR > @SALSTERR ) ORDER BY SALSTERR ASC, SOPTYPE ASC, SOPNUMBE ASC, SLPRSNID ASC END ELSE BEGIN SELECT TOP 25  SOPTYPE, SOPNUMBE, SEQNUMBR, SLPRSNID, SALSTERR, COMPRCNT, COMMAMNT, OCOMMAMT, NCOMAMNT, ORNCMAMT, PRCTOSAL, ACTSLAMT, ORSLSAMT, CMMSLAMT, ORCOSAMT, CURRNIDX, TRXSORCE, DEX_ROW_ID FROM .SOP10101 WHERE SALSTERR BETWEEN @SALSTERR_RS AND @SALSTERR_RE AND SOPTYPE BETWEEN @SOPTYPE_RS AND @SOPTYPE_RE AND SOPNUMBE BETWEEN @SOPNUMBE_RS AND @SOPNUMBE_RE AND SLPRSNID BETWEEN @SLPRSNID_RS AND @SLPRSNID_RE AND ( SALSTERR = @SALSTERR AND SOPTYPE = @SOPTYPE AND SOPNUMBE = @SOPNUMBE AND SLPRSNID > @SLPRSNID OR SALSTERR = @SALSTERR AND SOPTYPE = @SOPTYPE AND SOPNUMBE > @SOPNUMBE OR SALSTERR = @SALSTERR AND SOPTYPE > @SOPTYPE OR SALSTERR > @SALSTERR ) ORDER BY SALSTERR ASC, SOPTYPE ASC, SOPNUMBE ASC, SLPRSNID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SOP10101N_2] TO [DYNGRP]
GO
