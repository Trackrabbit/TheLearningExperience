SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROC [dbo].[zDP_IV50200N_3] (@BS int, @INCLUDEITEM tinyint, @USERID char(15), @IntegerValue smallint, @LOCNCODE char(11), @BINNMBR char(21), @ITEMNMBR char(31), @INCLUDEITEM_RS tinyint, @USERID_RS char(15), @IntegerValue_RS smallint, @LOCNCODE_RS char(11), @BINNMBR_RS char(21), @ITEMNMBR_RS char(31), @INCLUDEITEM_RE tinyint, @USERID_RE char(15), @IntegerValue_RE smallint, @LOCNCODE_RE char(11), @BINNMBR_RE char(21), @ITEMNMBR_RE char(31)) AS  set nocount on IF @INCLUDEITEM_RS IS NULL BEGIN SELECT TOP 25  INCLUDEITEM, ITEMNMBR, LOCNCODE, BINNMBR, ITMCLSCD, ABCCODE, ITMGEDSC, ITEMDESC, LSTCNTDT, STCKCNTINTRVL, NXTCNTDT, NXTCNTTM, UPDATED, ITEMTYPE, USERID, IntegerValue, DEX_ROW_ID FROM .IV50200 WHERE ( INCLUDEITEM = @INCLUDEITEM AND USERID = @USERID AND IntegerValue = @IntegerValue AND LOCNCODE = @LOCNCODE AND BINNMBR = @BINNMBR AND ITEMNMBR > @ITEMNMBR OR INCLUDEITEM = @INCLUDEITEM AND USERID = @USERID AND IntegerValue = @IntegerValue AND LOCNCODE = @LOCNCODE AND BINNMBR > @BINNMBR OR INCLUDEITEM = @INCLUDEITEM AND USERID = @USERID AND IntegerValue = @IntegerValue AND LOCNCODE > @LOCNCODE OR INCLUDEITEM = @INCLUDEITEM AND USERID = @USERID AND IntegerValue > @IntegerValue OR INCLUDEITEM = @INCLUDEITEM AND USERID > @USERID OR INCLUDEITEM > @INCLUDEITEM ) ORDER BY INCLUDEITEM ASC, USERID ASC, IntegerValue ASC, LOCNCODE ASC, BINNMBR ASC, ITEMNMBR ASC END ELSE IF @INCLUDEITEM_RS = @INCLUDEITEM_RE BEGIN SELECT TOP 25  INCLUDEITEM, ITEMNMBR, LOCNCODE, BINNMBR, ITMCLSCD, ABCCODE, ITMGEDSC, ITEMDESC, LSTCNTDT, STCKCNTINTRVL, NXTCNTDT, NXTCNTTM, UPDATED, ITEMTYPE, USERID, IntegerValue, DEX_ROW_ID FROM .IV50200 WHERE INCLUDEITEM = @INCLUDEITEM_RS AND USERID BETWEEN @USERID_RS AND @USERID_RE AND IntegerValue BETWEEN @IntegerValue_RS AND @IntegerValue_RE AND LOCNCODE BETWEEN @LOCNCODE_RS AND @LOCNCODE_RE AND BINNMBR BETWEEN @BINNMBR_RS AND @BINNMBR_RE AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND ( INCLUDEITEM = @INCLUDEITEM AND USERID = @USERID AND IntegerValue = @IntegerValue AND LOCNCODE = @LOCNCODE AND BINNMBR = @BINNMBR AND ITEMNMBR > @ITEMNMBR OR INCLUDEITEM = @INCLUDEITEM AND USERID = @USERID AND IntegerValue = @IntegerValue AND LOCNCODE = @LOCNCODE AND BINNMBR > @BINNMBR OR INCLUDEITEM = @INCLUDEITEM AND USERID = @USERID AND IntegerValue = @IntegerValue AND LOCNCODE > @LOCNCODE OR INCLUDEITEM = @INCLUDEITEM AND USERID = @USERID AND IntegerValue > @IntegerValue OR INCLUDEITEM = @INCLUDEITEM AND USERID > @USERID OR INCLUDEITEM > @INCLUDEITEM ) ORDER BY INCLUDEITEM ASC, USERID ASC, IntegerValue ASC, LOCNCODE ASC, BINNMBR ASC, ITEMNMBR ASC END ELSE BEGIN SELECT TOP 25  INCLUDEITEM, ITEMNMBR, LOCNCODE, BINNMBR, ITMCLSCD, ABCCODE, ITMGEDSC, ITEMDESC, LSTCNTDT, STCKCNTINTRVL, NXTCNTDT, NXTCNTTM, UPDATED, ITEMTYPE, USERID, IntegerValue, DEX_ROW_ID FROM .IV50200 WHERE INCLUDEITEM BETWEEN @INCLUDEITEM_RS AND @INCLUDEITEM_RE AND USERID BETWEEN @USERID_RS AND @USERID_RE AND IntegerValue BETWEEN @IntegerValue_RS AND @IntegerValue_RE AND LOCNCODE BETWEEN @LOCNCODE_RS AND @LOCNCODE_RE AND BINNMBR BETWEEN @BINNMBR_RS AND @BINNMBR_RE AND ITEMNMBR BETWEEN @ITEMNMBR_RS AND @ITEMNMBR_RE AND ( INCLUDEITEM = @INCLUDEITEM AND USERID = @USERID AND IntegerValue = @IntegerValue AND LOCNCODE = @LOCNCODE AND BINNMBR = @BINNMBR AND ITEMNMBR > @ITEMNMBR OR INCLUDEITEM = @INCLUDEITEM AND USERID = @USERID AND IntegerValue = @IntegerValue AND LOCNCODE = @LOCNCODE AND BINNMBR > @BINNMBR OR INCLUDEITEM = @INCLUDEITEM AND USERID = @USERID AND IntegerValue = @IntegerValue AND LOCNCODE > @LOCNCODE OR INCLUDEITEM = @INCLUDEITEM AND USERID = @USERID AND IntegerValue > @IntegerValue OR INCLUDEITEM = @INCLUDEITEM AND USERID > @USERID OR INCLUDEITEM > @INCLUDEITEM ) ORDER BY INCLUDEITEM ASC, USERID ASC, IntegerValue ASC, LOCNCODE ASC, BINNMBR ASC, ITEMNMBR ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IV50200N_3] TO [DYNGRP]
GO
