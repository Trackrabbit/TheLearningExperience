SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE    PROCEDURE  [dbo].[aagUpdateSubLedCustVendItemSiteInfo]  @I_HdrID INT = 0, @I_DistID INT = 0, @I_CustID VARCHAR(15) = '',  @I_VendID VARCHAR(15) = '',  @I_ItemID VARCHAR(31) = '',  @I_SiteID VARCHAR(11) = '',  @I_AssetID VARCHAR(31) ='',  @I_BookID VARCHAR(11) = ''  AS  DECLARE @TrackCust TINYINT,  @TrackVend TINYINT,  @TrackItem TINYINT,  @TrackSite TINYINT,  @TrackAsset TINYINT,  @TrackBook TINYINT,  @nAccIndx  INT  select @TrackCust = 0, @TrackVend = 0, @TrackItem = 0, @TrackSite = 0, @TrackAsset = 0, @TrackBook = 0  If @I_HdrID = 0 or @I_DistID = 0   return  select @nAccIndx = ACTINDX from AAG20001   where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID  select @TrackCust = aaSetCustID, @TrackVend = aaSetVendID,   @TrackItem = aaSetItemID, @TrackSite = aaSetSiteID,  @TrackAsset = aaSetAssetID, @TrackBook = aaSetBookID from AAG00201  where aaAcctClassID IN (select aaAcctClassID from AAG00200 where ACTINDX = @nAccIndx)  If @TrackCust = 1  update AAG20001 set aaCustID = @I_CustID   where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID  Else  update AAG20001 set aaCustID = ''  where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID  If @TrackVend = 1  update AAG20001 set aaVendID = @I_VendID   where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID  Else  update AAG20001 set aaVendID = ''  where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID  If @TrackItem = 1  update AAG20001 set aaItemID = @I_ItemID   where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID  Else  update AAG20001 set aaItemID = ''  where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID  If @TrackSite = 1  update AAG20001 set aaSiteID = @I_SiteID   where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID  Else  update AAG20001 set aaSiteID = ''  where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID  If @TrackAsset = 1  update AAG20001 set aaAssetID = @I_AssetID   where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID  Else  update AAG20001 set aaAssetID = ''  where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID  If @TrackBook = 1  update AAG20001 set aaBookID = @I_BookID   where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID  Else  update AAG20001 set aaBookID = ''  where aaSubLedgerHdrID = @I_HdrID and aaSubLedgerDistID = @I_DistID     
GO
GRANT EXECUTE ON  [dbo].[aagUpdateSubLedCustVendItemSiteInfo] TO [DYNGRP]
GO
