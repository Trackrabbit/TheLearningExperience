SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[RMAs] AS select rtrim(['Returns Master'].[RETDOCID]) as 'Return Document ID', 'Return Record Type' = dbo.FS_FUNC_Return_Record_Type(['Returns Master'].[Return_Record_Type]), 'RMA Status' = dbo.FS_FUNC_RMA_Status(['Returns Master'].[RMA_Status]), 'Received' = dbo.DYN_FUNC_Boolean_All(['Returns Master'].[Received]), 'Return Origin' = dbo.FS_FUNC_Return_Origin(['Returns Master'].[RETORIG]), rtrim(['Returns Master'].[RETREF]) as 'Return Reference', rtrim(['Returns Master'].[RETSTAT]) as 'Return Status', rtrim(['Returns Master'].[RETTYPE]) as 'SVC Return Type', ['Returns Master'].[ENTDTE] as 'Entry Date', ['Returns Master'].[ETADTE] as 'ETA Date', ['Returns Master'].[RETUDATE] as 'Return Date', ['Returns Master'].[COMPDTE] as 'Complete Date', rtrim(['Returns Master'].[OFFID]) as 'Office ID', rtrim(['Returns Master'].[LOCNCODE]) as 'Location Code', rtrim(['RM Customer MSTR'].[CUSTNMBR]) as 'Customer ID', rtrim(['Returns Master'].[ADRSCODE]) as 'Address Code',  rtrim(['Returns Master'].[ADDRESS1]) as 'Address 1', rtrim(['Returns Master'].[ADDRESS2]) as 'Address 2', rtrim(['Returns Master'].[ADDRESS3]) as 'Address 3', rtrim(['RM Customer MSTR2'].[CUSTNMBR]) as 'Bill To Customer ID', rtrim(['RM Customer MSTR2'].[CUSTNAME]) as 'Bill To Customer Name', rtrim(['Returns Master'].[Bill_of_Lading]) as 'Bill of Lading', rtrim(['Returns Master'].[CITY]) as 'City', ['Returns Master'].[Commit_Date] as 'Commit Date', ['Returns Master'].[Commit_Time] as 'Commit Time', ['Returns Master'].[COMPTME] as 'Complete Time', ['Returns Master'].[CMPNTSEQ] as 'Component Sequence', rtrim(['Returns Master'].[CONTACT]) as 'Contact', rtrim(['Returns Master'].[COUNTRY]) as 'Country', rtrim(['Returns Master'].[CURNCYID]) as 'Currency ID', ['Returns Master'].[CURRNIDX] as 'Currency Index', rtrim(['Returns Master'].[CUSTNAME]) as 'Customer Name', rtrim(['Returns Master'].[CSTPONBR]) as 'Customer PO Number', 'Decimal Places' = dbo.DYN_FUNC_Decimal_Places_QTYS(['Returns Master'].[DECPLACS]), ['Returns Master'].[DENXRATE] as 'Denomination Exchange Rate', ['Returns Master'].[ETATME] as 'ETA Time', ['Returns Master'].[ENTTME] as 'Entry Time', ['Returns Master'].[EQPLINE] as 'Equipment Line Item Sequence', ['Returns Master'].[EXCHDATE] as 'Exchange Date', ['Returns Master'].[XCHGRATE] as 'Exchange Rate', rtrim(['Returns Master'].[EXGTBLID]) as 'Exchange Table ID', ['Returns Master'].[EXPNDATE] as 'Expiration Date', ['Returns Master'].[ISMCTRX] as 'IS MC Trx', ['Returns Master'].[LNITMSEQ] as 'Line Item Sequence', ['Returns Master'].[MCTRXSTT] as 'MC Transaction State', ['Returns Master'].[NOTEINDX] as 'Note Index', ['Returns Master'].[RATECALC] as 'Rate Calc Method', rtrim(['Returns Master'].[RATETPID]) as 'Rate Type ID', rtrim(['Returns Master'].[RETADDR1]) as 'Return Address 1', rtrim(['Returns Master'].[RETADDR2]) as 'Return Address 2', rtrim(['Returns Master'].[RETADDR3]) as 'Return Address 3', rtrim(['Returns Master'].[RTRNCITY]) as 'Return Address City', rtrim(['Returns Master'].[RTRNNAME]) as 'Return Address Name', rtrim(['Returns Master'].[RTRNZIP]) as 'Return Address Zip Code', rtrim(['Returns Master'].[Return_Country]) as 'Return Country', ['Returns Master'].[Return_Time] as 'Return Time', ['Returns Master'].[SOP_Line_Item_Sequence] as 'SOP Line Item Sequence', rtrim(['Returns Master'].[SOPNUMBE]) as 'SOP Number', 'SOP Type' = dbo.DYN_FUNC_SOP_Type(['Returns Master'].[SOPTYPE]), rtrim(['Returns Master'].[SVC_Bill_To_Address_Code]) as 'SVC Bill To Address Code', 'SVC FO ID' = dbo.DYN_FUNC_Boolean_All(['Returns Master'].[SVC_FO_ID]), rtrim(['Returns Master'].[SVC_RMA_Reason_Code]) as 'SVC_RMA_Reason_Code', rtrim(['Returns Master'].[SVC_RMA_Reason_Code_Desc]) as 'SVC_RMA_Reason_Code_Desc', rtrim(['Returns Master'].[SVC_Return_State]) as 'SVC Return State', rtrim(['Returns Master'].[CALLNBR]) as 'Service Call Number', 'Service Record Type' = dbo.FS_FUNC_Service_Record_Type(['Returns Master'].[SRVRECTYPE]), rtrim(['Returns Master'].[SHIPMTHD]) as 'Shipping Method', rtrim(['Returns Master'].[STATE]) as 'State', ['Returns Master'].[TIME1] as 'Time', rtrim(['Returns Master'].[USERDEF1]) as 'User Defined 1', rtrim(['Returns Master'].[USERDEF2]) as 'User Defined 2', rtrim(['Returns Master'].[USRDEF03]) as 'User Defined 3', rtrim(['Returns Master'].[USRDEF04]) as 'User Defined 4', rtrim(['Returns Master'].[USRDEF05]) as 'User Defined 5', rtrim(['Returns Master'].[USERID]) as 'User ID', ['Returns Master'].[VIEWMODE] as 'View Mode', rtrim(['Returns Master'].[ZIPCODE]) as 'Zip Code', 'SVC RMA From Service' = dbo.DYN_FUNC_Boolean_All(['Returns Master'].[SVC_RMA_From_Service]),  'Customer ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCustomerID(1,['RM Customer MSTR'].[CUSTNMBR] ), 'Return Document ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=949' +dbo.dgppRMANumber(1,['Returns Master'].[RETDOCID],['Returns Master'].[Return_Record_Type] ), 'Service Call Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=949' +dbo.dgppServiceRecordType(1,['Returns Master'].[CALLNBR],['Returns Master'].[SRVRECTYPE] ),  'SOP Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppSalesOrder(1,1,11,'',0,0,['Returns Master'].[CUSTNMBR],'',0,'',['Returns Master'].[SOPTYPE],['Returns Master'].[SOPNUMBE] )         from [SVC05000] as ['Returns Master'] with (NOLOCK) left outer join [RM00101] as ['RM Customer MSTR'] with (NOLOCK) on ['Returns Master'].[CUSTNMBR] = ['RM Customer MSTR'].[CUSTNMBR] left outer join [RM00101] as ['RM Customer MSTR2'] with (NOLOCK) on ['Returns Master'].[Bill_To_Customer] = ['RM Customer MSTR2'].[CUSTNMBR] 
GO
GRANT SELECT ON  [dbo].[RMAs] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[RMAs] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[RMAs] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[RMAs] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[RMAs] TO [rpt_customer service rep]
GO
GRANT SELECT ON  [dbo].[RMAs] TO [rpt_dispatcher]
GO
GRANT SELECT ON  [dbo].[RMAs] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[RMAs] TO [rpt_project manager]
GO
