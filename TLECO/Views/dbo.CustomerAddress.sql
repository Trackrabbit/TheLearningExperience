SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[CustomerAddress] AS select rtrim(['Customer Master Address File'].[CUSTNMBR]) as 'Customer Number', rtrim(['RM Customer MSTR'].[CUSTNAME]) as 'Customer Name', rtrim(['Customer Master Address File'].[ADDRESS1]) as 'Address 1', rtrim(['Customer Master Address File'].[ADDRESS2]) as 'Address 2', rtrim(['Customer Master Address File'].[CITY]) as 'City', rtrim(['Customer Master Address File'].[STATE]) as 'State', rtrim(['Customer Master Address File'].[ZIP]) as 'Zip', rtrim(['Customer Master Address File'].[PHONE1]) as 'Phone 1',  (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['RM Customer MSTR'].[RMARACC]) as 'Accounts Receivable Account Number', rtrim(['Customer Master Address File'].[ADDRESS3]) as 'Address 3', rtrim(['Customer Master Address File'].[ADRSCODE]) as 'Address Code', 'Balance Type' = dbo.DYN_FUNC_Balance_Type(['RM Customer MSTR'].[BALNCTYP]), rtrim(['RM Customer MSTR'].[BNKBRNCH]) as 'Bank Branch', rtrim(['RM Customer MSTR'].[BANKNAME]) as 'Bank Name', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['RM Customer MSTR'].[RMCOSACC]) as 'COGS Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['RM Customer MSTR'].[RMCSHACC]) as 'Cash Account Number', rtrim(['RM Customer MSTR'].[CHEKBKID]) as 'Checkbook ID', rtrim(['RM Customer MSTR'].[COMMENT1]) as 'Comment1', rtrim(['RM Customer MSTR'].[COMMENT2]) as 'Comment2', rtrim(['Customer Master Address File'].[CNTCPRSN]) as 'Contact Person', rtrim(['RM Customer MSTR'].[CPRCSTNM]) as 'Corporate Customer Number', rtrim(['Customer Master Address File'].[COUNTRY]) as 'Country', ['Customer Master Address File'].[CREATDDT] as 'Created Date', ['RM Customer MSTR'].[CCRDXPDT] as 'Credit Card Exp Date', rtrim(['RM Customer MSTR'].[CRCARDID]) as 'Credit Card ID', ['RM Customer MSTR'].[CRLMTAMT] as 'Credit Limit Amount', ['RM Customer MSTR'].[CRLMTPER] as 'Credit Limit Period', ['RM Customer MSTR'].[CRLMTPAM] as 'Credit Limit Period Amount', 'Credit Limit Type' = dbo.DYN_FUNC_Credit_Limit_Type(['RM Customer MSTR'].[CRLMTTYP]), rtrim(['RM Customer MSTR'].[CURNCYID]) as 'Currency ID', rtrim(['RM Customer MSTR'].[CUSTCLAS]) as 'Customer Class', ['RM Customer MSTR'].[CUSTDISC]/100.00 as 'Customer Discount', 'Default Cash Account Type' = dbo.DYN_FUNC_Default_Cash_Account_Type(['RM Customer MSTR'].[DEFCACTY]), ['RM Customer MSTR'].[DISGRPER] as 'Discount Grace Period', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['RM Customer MSTR'].[RMAVACC]) as 'Discounts Avail Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['RM Customer MSTR'].[RMTAKACC]) as 'Discounts Taken Account Number', rtrim(['RM Customer MSTR'].[DOCFMTID]) as 'Document Format ID', ['RM Customer MSTR'].[DUEGRPER] as 'Due Date Grace Period', rtrim(['Customer Master Address File'].[FAX]) as 'Fax', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['RM Customer MSTR'].[RMFCGACC]) as 'Finance Charge Account Number', 'Finance Charge Amt Type' = dbo.DYN_FUNC_Finance_Charge_Amt_Type(['RM Customer MSTR'].[FNCHATYP]), ['RM Customer MSTR'].[FINCHDLR] as 'Finance Charge Dollar', rtrim(['RM Customer MSTR'].[FINCHID]) as 'Finance Charge ID', ['RM Customer MSTR'].[FNCHPCNT]/100.00 as 'Finance Charge Percent', ['RM Customer MSTR'].[FRSTINDT] as 'First Invoice Date', rtrim(['RM Customer MSTR'].[GOVCRPID]) as 'Governmental Corporate ID', rtrim(['RM Customer MSTR'].[GOVINDID]) as 'Governmental Individual ID', 'Hold' = dbo.DYN_FUNC_Boolean_All(['RM Customer MSTR'].[HOLD]), rtrim(['Internet Addresses'].[INET1]) as 'INet1', rtrim(['Internet Addresses'].[INET2]) as 'INet2', rtrim(['Internet Addresses'].[INET3]) as 'INet3', rtrim(['Internet Addresses'].[INET4]) as 'INet4', rtrim(['Internet Addresses'].[INET5]) as 'INet5', rtrim(['Internet Addresses'].[INET6]) as 'INet6', rtrim(['Internet Addresses'].[INET7]) as 'INet7', rtrim(['Internet Addresses'].[INET8]) as 'INet8', 'Inactive' = dbo.DYN_FUNC_Boolean_All(['RM Customer MSTR'].[INACTIVE]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['RM Customer MSTR'].[RMIVACC]) as 'Inventory Account Number', 'Keep Calendar History' = dbo.DYN_FUNC_Boolean_All(['RM Customer MSTR'].[KPCALHST]), 'Keep Distribution History' = dbo.DYN_FUNC_Boolean_All(['RM Customer MSTR'].[KPDSTHST]), 'Keep Period History' = dbo.DYN_FUNC_Boolean_All(['RM Customer MSTR'].[KPERHIST]), 'Keep Trx History' = dbo.DYN_FUNC_Boolean_All(['RM Customer MSTR'].[KPTRXHST]), ['RM Customer MSTR'].[MXWROFAM] as 'Max Writeoff Amount', 'Maximum Writeoff Type' = dbo.DYN_FUNC_Maximum_Writeoff_Type(['RM Customer MSTR'].[MXWOFTYP]), ['RM Customer MSTR'].[MINPYDLR] as 'Minimum Payment Dollar', ['RM Customer MSTR'].[MINPYPCT]/100.00 as 'Minimum Payment Percent', 'Minimum Payment Type' = dbo.DYN_FUNC_Minimum_Payment_Type(['RM Customer MSTR'].[MINPYTYP]), ['Customer Master Address File'].[MODIFDT] as 'Modified Date', ['RM Customer MSTR'].[NOTEINDX] as 'Note Index', 'Order Fulfillment Shortage Default' = dbo.DYN_FUNC_Order_Fulfillment_Shortage_Default(['RM Customer MSTR'].[ORDERFULFILLDEFAULT]), rtrim(['RM Customer MSTR'].[PYMTRMID]) as 'Payment Terms ID',  rtrim(['Customer Master Address File'].[PHONE2]) as 'Phone 2', rtrim(['Customer Master Address File'].[PHONE3]) as 'Phone 3', 'Post Results To' = dbo.DYN_FUNC_Post_Results_To_Customer(['RM Customer MSTR'].[Post_Results_To]), rtrim(['RM Customer MSTR'].[PRCLEVEL]) as 'PriceLevel', rtrim(['RM Customer MSTR'].[PRBTADCD]) as 'Primary Billto Address Code', rtrim(['RM Customer MSTR'].[PRSTADCD]) as 'Primary Shipto Address Code', 'Priority' = dbo.DYN_FUNC_Priority(['RM Customer MSTR'].[CUSTPRIORITY]), rtrim(['RM Customer MSTR'].[RATETPID]) as 'Rate Type ID', 'Revalue Customer' = dbo.DYN_FUNC_Boolean_All(['RM Customer MSTR'].[Revalue_Customer]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['RM Customer MSTR'].[RMSLSACC]) as 'Sales Account Number', rtrim(['RM Customer MSTR'].[SALSTERR]) as 'Sales Territory', rtrim(['Customer Master Address File'].[SLPRSNID]) as 'Salesperson ID', rtrim(['RM Customer MSTR'].[SLPRSNID]) as 'Salesperson ID from Customer Master', rtrim(['Customer Master Address File'].[SHIPMTHD]) as 'Shipping Method', rtrim(['RM Customer MSTR'].[SHRTNAME]) as 'Short Name', rtrim(['Customer Master Address File'].[LOCNCODE]) as 'Site ID', rtrim(['RM Customer MSTR'].[STADDRCD]) as 'Statement Address Code', 'Statement Cycle' = dbo.DYN_FUNC_Statement_Cycle(['RM Customer MSTR'].[STMTCYCL]), rtrim(['RM Customer MSTR'].[STMTNAME]) as 'Statement Name', rtrim(['RM Customer MSTR'].[TAXEXMT1]) as 'Tax Exempt 1', rtrim(['RM Customer MSTR'].[TAXEXMT2]) as 'Tax Exempt 2', rtrim(['RM Customer MSTR'].[TXRGNNUM]) as 'Tax Registration Number', rtrim(['Customer Master Address File'].[TAXSCHID]) as 'Tax Schedule ID', rtrim(['Customer Master Address File'].[SALSTERR]) as 'Territory ID', rtrim(['Customer Master Address File'].[UPSZONE]) as 'UPS Zone', rtrim(['Customer Master Address File'].[USERDEF1]) as 'User Defined 1', rtrim(['RM Customer MSTR'].[USERDEF1]) as 'User Defined 1 from Customer Master', rtrim(['Customer Master Address File'].[USERDEF2]) as 'User Defined 2', rtrim(['RM Customer MSTR'].[USERDEF2]) as 'User Defined 2 from Customer Master', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['RM Customer MSTR'].[RMWRACC]) as 'Writeoff Account Number',  'Accounts Receivable Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['RM Customer MSTR'].[RMARACC] ), 'Cash Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['RM Customer MSTR'].[RMCSHACC] ), 'Checkbook ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCheckbookID(1,['RM Customer MSTR'].[CHEKBKID] ), 'COGS Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['RM Customer MSTR'].[RMCOSACC] ), 'Customer Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCustomerID(1,['Customer Master Address File'].[CUSTNMBR] ), 'Discounts Avail Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['RM Customer MSTR'].[RMAVACC] ), 'Discounts Taken Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['RM Customer MSTR'].[RMTAKACC] ), 'Finance Charge Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['RM Customer MSTR'].[RMFCGACC] ), 'Inventory Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['RM Customer MSTR'].[RMIVACC] ), 'Sales Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['RM Customer MSTR'].[RMSLSACC] ), 'Salesperson ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppSalespersonID(1,['Customer Master Address File'].[SLPRSNID],2 ), 'Writeoff Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['RM Customer MSTR'].[RMWRACC] )         from [RM00102] as ['Customer Master Address File'] with (NOLOCK) left outer join [RM00101] as ['RM Customer MSTR'] with (NOLOCK) on ['Customer Master Address File'].[CUSTNMBR] = ['RM Customer MSTR'].[CUSTNMBR] left outer join [SY01200] as ['Internet Addresses'] with (NOLOCK) on 'CUS' = ['Internet Addresses'].[Master_Type]  and ['Customer Master Address File'].[CUSTNMBR] = ['Internet Addresses'].[Master_ID]  and ['Customer Master Address File'].[ADRSCODE] = ['Internet Addresses'].[ADRSCODE] 
GO
GRANT SELECT ON  [dbo].[CustomerAddress] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[CustomerAddress] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[CustomerAddress] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[CustomerAddress] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[CustomerAddress] TO [rpt_accounting manager]
GO
GRANT SELECT ON  [dbo].[CustomerAddress] TO [rpt_accounts receivable coordinator]
GO
GRANT SELECT ON  [dbo].[CustomerAddress] TO [rpt_bookkeeper]
GO
GRANT SELECT ON  [dbo].[CustomerAddress] TO [rpt_collections manager]
GO
GRANT SELECT ON  [dbo].[CustomerAddress] TO [rpt_customer service rep]
GO
GRANT SELECT ON  [dbo].[CustomerAddress] TO [rpt_dispatcher]
GO
GRANT SELECT ON  [dbo].[CustomerAddress] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[CustomerAddress] TO [rpt_project manager]
GO
GRANT SELECT ON  [dbo].[CustomerAddress] TO [rpt_sales manager]
GO
