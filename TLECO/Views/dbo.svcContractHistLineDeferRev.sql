SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE VIEW [dbo].[svcContractHistLineDeferRev] as (   select  0 as MY_GROUP_ID,  SVC30601.CONSTS, SVC30601.CONTNBR, SVC30601.CNTTYPE,   SVC30601.LNSEQNBR,   case SVC30601.SVC_Liability_Type  when 1 then 'S'  when 2 then 'B'  when 3 then 'R'  when 4 then 'C'  when 5 then 'M'  else ''  end  as SVC_Liability_Type_Txt,  '' as HIST,  SVC30601.CUSTNMBR, RM00101.CUSTNAME, SVC30601.ADRSCODE, SVC30601.Contract_Line_Status,  SVC30601.STRTDATE, SVC30601.ENDDATE, SVC30601.Contract_Length, SVC30601.Contract_Period,   SVC30601.ITEMNMBR, SVC30601.DSCRIPTN, SVC30601.EQUIPID, SVC30601.SERLNMBR, SVC30601.QUANTITY, SVC30601.UOFM,   case   when IV00101.DECPLCUR is not null then IV00101.DECPLCUR  else 2  end as DECPLCUR,  SVC30601.CURNCYID, SVC30601.CURRNIDX, SVC30601.SVC_Monthly_Price,  SVC30601.FRSTBLDTE, SVC30601.Last_Amount_Billed, SVC30601.LSTBLDTE, SVC30601.TOTAL,  SVC30601.Invoiced_Amount, SVC30601.Amount_To_Invoice,  SVC30601.NXTBLDTE, SVC30601.TOTBIL,   SVC30601.BILONDY, SVC30601.BILCYC, SVC30601.BILSTAT,   SVC30601.Liabiltiy_Reduction, SVC30601.Liability_Amount, SVC30601.Total_Liability_Amount, SVC30601.Total_Liability_Billed,  SVC30601.TAXAMNT  from SVC30601  inner join SVC30600 on SVC30600.CONSTS = SVC30601.CONSTS and SVC30600.CONTNBR = SVC30601.CONTNBR   left outer join IV00101 on IV00101.ITEMNMBR = SVC30601.ITEMNMBR   inner join RM00101 on RM00101.CUSTNMBR = SVC30601.CUSTNMBR   and (SVC30600.BILCYC > 3 or (SVC30600.BILCYC = 3 and (SVC30600.svcFrequencyQty>1 or SVC30600.Liabiltiy_Reduction = 1)))  )    
GO
GRANT SELECT ON  [dbo].[svcContractHistLineDeferRev] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[svcContractHistLineDeferRev] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[svcContractHistLineDeferRev] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[svcContractHistLineDeferRev] TO [DYNGRP]
GO
