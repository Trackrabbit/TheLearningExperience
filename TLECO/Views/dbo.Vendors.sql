SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[Vendors] AS select rtrim(['PM Vendor Master File'].[VENDORID]) as 'Vendor ID', rtrim(['PM Vendor Master File'].[VENDNAME]) as 'Vendor Name', rtrim(['PM Vendor Master File'].[ADDRESS1]) as 'Address 1', rtrim(['PM Vendor Master File'].[ADDRESS2]) as 'Address 2', rtrim(['PM Vendor Master File'].[CITY]) as 'City', rtrim(['PM Vendor Master File'].[STATE]) as 'State', rtrim(['PM Vendor Master File'].[ZIPCODE]) as 'Zip Code', rtrim(['PM Vendor Master File'].[PHNUMBR1]) as 'Phone Number 1',  ['PM Vendor Master Summary'].[TEN99ALIF] as '1099 Amount LIFE', ['PM Vendor Master Summary'].[TEN99ALYR] as '1099 Amount LYR', ['PM Vendor Master Summary'].[TEN99AYTD] as '1099 Amount YTD', '1099 Type' = dbo.DYN_FUNC_1099_Type(['PM Vendor Master File'].[TEN99TYPE]), rtrim(['PM Vendor Master File'].[ACNMVNDR]) as 'Account Number With Vendor', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMAPINDX]) as 'Accounts Payable Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[ACPURIDX]) as 'Accrued Purchases Account Number', rtrim(['PM Vendor Master File'].[ADDRESS3]) as 'Address 3', ['PM Vendor Master Summary'].[AMBLDLIF] as 'Amount Billed LIFE', ['PM Vendor Master Summary'].[AMBLDLYR] as 'Amount Billed LYR', ['PM Vendor Master Summary'].[AMBLDTYD] as 'Amount Billed YTD', ['PM Vendor Master Summary'].[AMTPDLIF] as 'Amount Paid LIFE', ['PM Vendor Master Summary'].[AMTPDLYR] as 'Amount Paid LYR', ['PM Vendor Master Summary'].[AMTPDYTD] as 'Amount Paid YTD', ['PM Vendor Master Summary'].[AVDTPLIF] as 'Average Days To Pay - Life', ['PM Vendor Master Summary'].[AVGDTPYR] as 'Average Days To Pay - Year', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMCSHIDX]) as 'Cash Account Number', ['PM Vendor Master File'].[CRTCOMDT] as 'Certificate Commencing Date', ['PM Vendor Master File'].[CRTEXPDT] as 'Certificate Expiration Date', rtrim(['PM Vendor Master File'].[CHEKBKID]) as 'Checkbook ID', rtrim(['PM Vendor Master File'].[COMMENT1]) as 'Comment1', rtrim(['PM Vendor Master File'].[COMMENT2]) as 'Comment2', rtrim(['PM Vendor Master File'].[COUNTRY]) as 'Country', ['PM Vendor Master File'].[CREATDDT] as 'Created Date', 'Credit Limit' = dbo.DYN_FUNC_Credit_Limit(['PM Vendor Master File'].[CREDTLMT]), ['PM Vendor Master File'].[CRLMTDLR] as 'Credit Limit Dollar', rtrim(['PM Vendor Master File'].[CURNCYID]) as 'Currency ID', ['PM Vendor Master Summary'].[CURRBLNC] as 'Current Balance', ['PM Vendor Master Summary'].[CURUNPBN] as 'Current Unapplied Payment Balance', rtrim(['Customer Vendor Master'].[CUSTNMBR]) as 'Customer Number', ['PM Vendor Master Summary'].[DYCHTCLR] as 'Days Checks To Clear', rtrim(['PM Vendor Master File'].[DXVARNUM]) as 'Deduction Exemption/Variation Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMDAVIDX]) as 'Discount Available Account Number', ['PM Vendor Master Summary'].[DISAVLIF] as 'Discount Available LIFE', ['PM Vendor Master Summary'].[DISAVLYR] as 'Discount Available LYR', ['PM Vendor Master Summary'].[DISAVYTD] as 'Discount Available YTD', ['PM Vendor Master File'].[DISGRPER] as 'Discount Grace Period', ['PM Vendor Master Summary'].[DISLSTLF] as 'Discount Lost LIFE', ['PM Vendor Master Summary'].[DISLSLYR] as 'Discount Lost LYR', ['PM Vendor Master Summary'].[DISLSYTD] as 'Discount Lost YTD', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMDTKIDX]) as 'Discount Taken Account Number', ['PM Vendor Master Summary'].[DISTKNLF] as 'Discount Taken LIFE', ['PM Vendor Master Summary'].[DISTKLYR] as 'Discount Taken LYR', ['PM Vendor Master Summary'].[DISTKYTD] as 'Discount Taken YTD', rtrim(['PM Vendor Master File'].[DOCFMTID]) as 'Document Format ID', ['PM Vendor Master File'].[DUEGRPER] as 'Due Date Grace Period', 'Expiration Date Obligation' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[XPDTOBLG]), rtrim(['PM Vendor Master File'].[FAXNUMBR]) as 'Fax Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMFINIDX]) as 'Finance Charge Account Number', ['PM Vendor Master Summary'].[FINCHLIF] as 'Finance Charge LIFE', ['PM Vendor Master Summary'].[FINCHLYR] as 'Finance Charge LYR', ['PM Vendor Master Summary'].[FINCHYTD] as 'Finance Charge YTD', ['PM Vendor Master Summary'].[FSTPURDT] as 'First Purchase Date', 'Free On Board' = dbo.DYN_FUNC_Free_On_Board(['PM Vendor Master File'].[FREEONBOARD]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMFRTIDX]) as 'Freight Account Number', rtrim(['PM Vendor Master File'].[GOVCRPID]) as 'Governmental Corporate ID', rtrim(['PM Vendor Master File'].[GOVINDID]) as 'Governmental Individual ID', ['PM Vendor Master Summary'].[HIESTBAL] as 'Highest Balance', 'Hold' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[HOLD]), 'Keep Calendar History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPCALHST]),  'Keep GL Dist History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KGLDSTHS]), 'Keep Period History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPERHIST]), 'Keep Trx History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPTRXHST]), ['PM Vendor Master Summary'].[LSTCHAMT] as 'Last Check Amount', ['PM Vendor Master Summary'].[LSTCHKDT] as 'Last Check Date', rtrim(['PM Vendor Master Summary'].[LSTCHNUM]) as 'Last Check Number', ['PM Vendor Master Summary'].[LSTINVAM] as 'Last Invoice Amount', rtrim(['PM Vendor Master Summary'].[LSTINNUM]) as 'Last Invoice Number', ['PM Vendor Master Summary'].[LSTPURDT] as 'Last Purchase Date', 'Maximum Invoice Amount For Vendors' = dbo.DYN_FUNC_Maximum_Invoice_Amount_For_Vendors(['PM Vendor Master File'].[MXIAFVND]), ['PM Vendor Master File'].[MAXINDLR] as 'Maximum Invoice Dollar', ['PM Vendor Master File'].[MXWOFAMT] as 'Maximum Write Off Amount', ['PM Vendor Master File'].[MINORDER] as 'Minimum Order', ['PM Vendor Master File'].[MINPYDLR] as 'Minimum Payment Dollar', ['PM Vendor Master File'].[MINPYPCT]/100.00 as 'Minimum Payment Percent', 'Minimum Payment Type' = dbo.DYN_FUNC_Minimum_Payment_Type(['PM Vendor Master File'].[MINPYTYP]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMMSCHIX]) as 'Misc Charges Account Number', ['PM Vendor Master File'].[MODIFDT] as 'Modified Date', ['PM Vendor Master File'].[NOTEINDX] as 'Note Index', ['PM Vendor Master Summary'].[NFNCHLIF] as 'Number of Finance Charges LIFE', ['PM Vendor Master Summary'].[NFNCHLYR] as 'Number of Finance Charges LYR', ['PM Vendor Master Summary'].[NFNCHYTD] as 'Number of Finance Charges YTD', ['PM Vendor Master Summary'].[NOINVLIF] as 'Number of Invoices LIFE', ['PM Vendor Master Summary'].[NOINVLYR] as 'Number of Invoices LYR', ['PM Vendor Master Summary'].[NOINVYTD] as 'Number of Invoices YTD', ['PM Vendor Master Summary'].[NOPILIFE] as 'Number of Paid Invoices LIFE', ['PM Vendor Master Summary'].[NOPINYTD] as 'Number of Paid Invoices YTD', ['PM Vendor Master Summary'].[ONORDAMT] as 'On Order Amount', ['PM Vendor Master File'].[PPSTAXRT]/100.00 as 'PPS Tax Rate', rtrim(['PM Vendor Master File'].[PARVENID]) as 'Parent Vendor ID', rtrim(['PM Vendor Master File'].[PYMNTPRI]) as 'Payment Priority', rtrim(['PM Vendor Master File'].[PYMTRMID]) as 'Payment Terms ID', rtrim(['PM Vendor Master File'].[PHONE3]) as 'Phone 3', rtrim(['PM Vendor Master File'].[PHNUMBR2]) as 'Phone Number 2', 'Post Results To' = dbo.DYN_FUNC_Post_Results_To_Vendor(['PM Vendor Master File'].[Post_Results_To]), 'Post To Cash Account From' = dbo.DYN_FUNC_Post_To_Cash_Account_From(['PM Vendor Master File'].[PTCSHACF]), 'Prescribed Payee' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[PRSPAYEE]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PURPVIDX]) as 'Purchase Price Variance Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMPRCHIX]) as 'Purchases Account Number', rtrim(['PM Vendor Master File'].[RATETPID]) as 'Rate Type ID', 'Reporting Obligation Undertaken' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[RTOBUTKN]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMRTNGIX]) as 'Retainage Account Number', ['PM Vendor Master Summary'].[RTNGOWED] as 'Retainage Owed', ['PM Vendor Master Summary'].[RTRNSLIF] as 'Returns LIFE', ['PM Vendor Master Summary'].[RTRNSLYR] as 'Returns LYR', ['PM Vendor Master Summary'].[RTRNSYTD] as 'Returns YTD', 'Revalue Vendor' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[Revalue_Vendor]), rtrim(['PM Vendor Master File'].[SHIPMTHD]) as 'Shipping Method', 'Subject To PPS Deductions' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[SBPPSDED]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMTAXIDX]) as 'Tax Account Number', rtrim(['PM Vendor Master File'].[TXIDNMBR]) as 'Tax ID Number', 'Tax Invoice Received' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[TaxInvRecvd]), rtrim(['PM Vendor Master File'].[TXRGNNUM]) as 'Tax Registration Number', rtrim(['PM Vendor Master File'].[TAXSCHID]) as 'Tax Schedule ID', ['PM Vendor Master File'].[TRDDISCT]/100.00 as 'Trade Discount', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMTDSCIX]) as 'Trade Discount Account Number', ['PM Vendor Master Summary'].[TRDTKLIF] as 'Trade Discounts Taken LIFE', ['PM Vendor Master Summary'].[TRDTLYR] as 'Trade Discounts Taken LYR', ['PM Vendor Master Summary'].[TRDTYTD] as 'Trade Discounts Taken YTD', rtrim(['PM Vendor Master File'].[UPSZONE]) as 'UPS Zone', ['PM Vendor Master Summary'].[UNPDFNCH] as 'Unpaid Finance Charges', rtrim(['PM Vendor Master File'].[USERDEF1]) as 'User Defined 1', rtrim(['PM Vendor Master File'].[USERDEF2]) as 'User Defined 2', rtrim(['PM Vendor Master File'].[VADDCDPR]) as 'Vendor Address Code - Primary', rtrim(['PM Vendor Master File'].[VADCDPAD]) as 'Vendor Address Code - Purchase Address', rtrim(['PM Vendor Master File'].[VADCDTRO]) as 'Vendor Address Code - Remit To', rtrim(['PM Vendor Master File'].[VADCDSFR]) as 'Vendor Address Code - Ship From', rtrim(['PM Vendor Master File'].[VNDCHKNM]) as 'Vendor Check Name', rtrim(['PM Vendor Master File'].[VNDCLSID]) as 'Vendor Class ID', rtrim(['PM Vendor Master File'].[VNDCNTCT]) as 'Vendor Contact',  rtrim(['PM Vendor Master File'].[VENDSHNM]) as 'Vendor Short Name', 'Vendor Status' = dbo.DYN_FUNC_Vendor_Status(['PM Vendor Master File'].[VENDSTTS]), ['PM Vendor Master Summary'].[Withholding_LIFE] as 'Withholding LIFE', ['PM Vendor Master Summary'].[WITHLYR] as 'Withholding LYR', ['PM Vendor Master Summary'].[WITHYTD] as 'Withholding YTD', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMWRTIDX]) as 'Write Offs Account Number', ['PM Vendor Master Summary'].[WROFSLIF] as 'Write Offs LIFE', ['PM Vendor Master Summary'].[WROFSLYR] as 'Write Offs LYR', ['PM Vendor Master Summary'].[WROFSYTD] as 'Write Offs YTD', 'Writeoff' = dbo.DYN_FUNC_Writeoff(['PM Vendor Master File'].[WRITEOFF]), '1099 Box' = dbo.DYN_FUNC_1099_Box_Type(['PM Vendor Master File'].[TEN99TYPE],['PM Vendor Master File'].[TEN99BOXNUMBER]),  'Accounts Payable Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMAPINDX] ), 'Accrued Purchases Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[ACPURIDX] ), 'Cash Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMCSHIDX] ),  'Checkbook ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCheckbookID(1,['PM Vendor Master File'].[CHEKBKID] ), 'Customer Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCustomerID(1,['Customer Vendor Master'].[CUSTNMBR] ), 'Discount Available Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMDAVIDX] ), 'Discount Taken Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMDTKIDX] ),  'Finance Charge Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMFINIDX] ), 'Freight Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMFRTIDX] ), 'Misc Charges Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMMSCHIX] ), 'Purchase Price Variance Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PURPVIDX] ),  'Purchases Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMPRCHIX] ), 'Retainage Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMRTNGIX] ), 'Tax Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMTAXIDX] ), 'Trade Discount Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMTDSCIX] ),  'Vendor ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppVendorID(1,['PM Vendor Master File'].[VENDORID] ), 'Write Offs Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMWRTIDX] )    from [PM00200] as ['PM Vendor Master File'] with (NOLOCK) left outer join [PM00201] as ['PM Vendor Master Summary'] with (NOLOCK) on ['PM Vendor Master File'].[VENDORID] = ['PM Vendor Master Summary'].[VENDORID] left outer join [PA00001] as ['Customer Vendor Master'] with (NOLOCK) on ['PM Vendor Master File'].[VENDORID] = ['Customer Vendor Master'].[VENDORID] 
GO
GRANT SELECT ON  [dbo].[Vendors] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[Vendors] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[Vendors] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[Vendors] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[Vendors] TO [rpt_accounting manager]
GO
GRANT SELECT ON  [dbo].[Vendors] TO [rpt_accounts payable coordinator]
GO
GRANT SELECT ON  [dbo].[Vendors] TO [rpt_bookkeeper]
GO
GRANT SELECT ON  [dbo].[Vendors] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[Vendors] TO [rpt_materials manager]
GO
GRANT SELECT ON  [dbo].[Vendors] TO [rpt_operations manager]
GO
GRANT SELECT ON  [dbo].[Vendors] TO [rpt_production manager]
GO
GRANT SELECT ON  [dbo].[Vendors] TO [rpt_purchasing agent]
GO
GRANT SELECT ON  [dbo].[Vendors] TO [rpt_warehouse manager]
GO
