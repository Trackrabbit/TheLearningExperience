SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[ReqPurInvHeaderView] AS  
select  
	1 "TrxState", -- Set to 1 for Work  
	POPRCTNM,  
	POPTYPE,  
	VNDDOCNM,  
	receiptdate,  
	BACHNUMB,  
	BCHSOURC, 
	(SELECT CREATDDT FROM SY00500 WHERE POP10300.BACHNUMB = SY00500.BACHNUMB AND POP10300.BCHSOURC = SY00500.BCHSOURC) AS BatchCreatedDate, 
	(SELECT TIME1 FROM SY00500 WHERE POP10300.BACHNUMB = SY00500.BACHNUMB AND POP10300.BCHSOURC = SY00500.BCHSOURC) AS BatchCreatedTime, 
	VENDORID,  
	VENDNAME,  
	SUBTOTAL,  
	ORSUBTOT,  
	TRDISAMT, 
	ORTDISAM, 
	FRTAMNT, 
	ORFRTAMT, 
	MISCAMNT, 
	ORMISCAMT, 
	TAXAMNT, 
	ORTAXAMT, 
	TEN99AMNT, 
	OR1099AM, 
	PYMTRMID, 
	DSCPCTAM, 
	DSCDLRAM, 
	ORDDLRAT, 
	DISAVAMT, 
	ORDAVAMT, 
	USER2ENT,  
	TAXSCHID, 
	Purchase_Freight_Taxable, 
	Purchase_Misc_Taxable, 
	FRTSCHID, 
	MSCSCHID, 
	FRTTXAMT, 
	ORFRTTAX, 
	MSCTXAMT, 
	ORMSCTAX, 
	CURNCYID,  
	XCHGRATE,  
	EXCHDATE,  
	DUEDATE, 
	DISCDATE, 
	VCHRNMBR, 
	VADCDTRO,  
	GLPOSTDT,  
	POSTEDDT,  
	PTDUSRID,  
	CREATDDT,  
	MODIFDT,  
	REFRENCE, 
	TRXSORCE,  
	DEX_ROW_ID  
from   
	POP10300  
  
union all  
  
select  
	3 "TrxState", -- Set to 3 for History  
	POPRCTNM,  
	POPTYPE,  
	VNDDOCNM,  
	receiptdate,  
	BACHNUMB, 
	BCHSOURC, 
	'', --BatchCreatedDate 
	'', --BatchCreatedTime  
	VENDORID,  
	VENDNAME,  
	SUBTOTAL,  
	ORSUBTOT,  
	TRDISAMT, 
	ORTDISAM, 
	FRTAMNT, 
	ORFRTAMT, 
	MISCAMNT, 
	ORMISCAMT, 
	TAXAMNT, 
	ORTAXAMT, 
	TEN99AMNT, 
	OR1099AM, 
	PYMTRMID, 
	DSCPCTAM, 
	DSCDLRAM, 
	ORDDLRAT, 
	DISAVAMT, 
	ORDAVAMT, 
	USER2ENT,  
	TAXSCHID, 
	Purchase_Freight_Taxable, 
	Purchase_Misc_Taxable, 
	FRTSCHID, 
	MSCSCHID, 
	FRTTXAMT, 
	ORFRTTAX, 
	MSCTXAMT, 
	ORMSCTAX, 
	CURNCYID,  
	XCHGRATE,  
	EXCHDATE,  
	DUEDATE, 
	DISCDATE, 
	VCHRNMBR, 
	VADCDTRO,  
	GLPOSTDT,  
	POSTEDDT,  
	PTDUSRID,  
	CREATDDT,  
	MODIFDT,  
	REFRENCE, 
	TRXSORCE,  
	DEX_ROW_ID  
from   
	POP30300  
  
 
GO
GRANT SELECT ON  [dbo].[ReqPurInvHeaderView] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[ReqPurInvHeaderView] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[ReqPurInvHeaderView] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[ReqPurInvHeaderView] TO [DYNGRP]
GO
