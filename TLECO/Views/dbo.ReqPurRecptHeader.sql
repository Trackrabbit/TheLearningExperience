SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[ReqPurRecptHeader] AS 
select 
	1 "TrxState", -- Set to 1 for Work 
	POPRCTNM, 
	POPTYPE, 
	VNDDOCNM, 
	receiptdate, 
	ACTLSHIP, 
	BACHNUMB, 
	BCHSOURC,	 
	(SELECT CREATDDT FROM SY00500 WHERE POP10300.BACHNUMB = SY00500.BACHNUMB AND POP10300.BCHSOURC = SY00500.BCHSOURC) AS BatchCreatedDate, 
	(SELECT TIME1 FROM SY00500 WHERE POP10300.BACHNUMB = SY00500.BACHNUMB AND POP10300.BCHSOURC = SY00500.BCHSOURC) AS BatchCreatedTime, 
	VENDORID, 
	VENDNAME, 
	REFRENCE, 
	SUBTOTAL, 
	ORSUBTOT, 
	USER2ENT, 
	CURNCYID, 
	XCHGRATE, 
	EXCHDATE, 
	VADCDTRO, 
	GLPOSTDT, 
	POSTEDDT, 
	PTDUSRID, 
	CREATDDT, 
	MODIFDT, 
	Total_Landed_Cost_Amount, 
	TRXSORCE, 
	DEX_ROW_ID 
from  
	POP10300 
 
union all 
 
select 
	3 "TrxState", -- Set to 3 for History 
	POPRCTNM, 
	POPTYPE, 
	VNDDOCNM, 
	receiptdate, 
	ACTLSHIP, 
	BACHNUMB, 
	BCHSOURC, 
	'', --BatchCreatedDate 
	'', --BatchCreatedTime 
	VENDORID, 
	VENDNAME, 
	REFRENCE, 
	SUBTOTAL, 
	ORSUBTOT, 
	USER2ENT, 
	CURNCYID, 
	XCHGRATE, 
	EXCHDATE, 
	VADCDTRO, 
	GLPOSTDT, 
	POSTEDDT, 
	PTDUSRID, 
	CREATDDT, 
	MODIFDT, 
	Total_Landed_Cost_Amount, 
	TRXSORCE, 
	DEX_ROW_ID 
from  
	POP30300 
GO
GRANT SELECT ON  [dbo].[ReqPurRecptHeader] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[ReqPurRecptHeader] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[ReqPurRecptHeader] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[ReqPurRecptHeader] TO [DYNGRP]
GO
