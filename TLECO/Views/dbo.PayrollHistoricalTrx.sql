SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[PayrollHistoricalTrx] AS select rtrim(['Payroll Transaction History'].[AUCTRLCD]) as 'Audit Control Code', rtrim(['Payroll Transaction History'].[EMPLOYID]) as 'Employee ID', rtrim(['Payroll Transaction History'].[CHEKNMBR]) as 'Check Number', ['Payroll Transaction History'].[UPRTRXAM] as 'UPR TRX Amount',  (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Payroll Master'].[ACTINDX]) as 'Account Number', ['Payroll Tax Information Master'].[ADFDWHDG] as 'Additional Federal Withholding', rtrim(['Payroll Address Master'].[ADDRESS1]) as 'Address 1', rtrim(['Payroll Address Master'].[ADDRESS2]) as 'Address 2', rtrim(['Payroll Address Master'].[ADDRESS3]) as 'Address 3', rtrim(['Payroll Master'].[ADRSCODE]) as 'Address Code', rtrim(['Payroll Master'].[ALTERNATENAME]) as 'Alternate Name', 'Auto Accrue Sick Time' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[ATACRSTM]), 'Auto Accrue Vacation' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[ATACRVAC]), ['Payroll Transaction History'].[BSDONRTE] as 'Based On Rate', ['Payroll Master'].[BENADJDATE] as 'Ben Adj Date', ['Payroll Master'].[BENEFITEXPIRE_I] as 'Benefit Expire', ['Payroll Master'].[BRTHDATE] as 'Birth Date', ['Payroll Master'].[BIRTHDAY] as 'Birth Day', ['Payroll Master'].[BIRTHMONTH] as 'Birth Month', 'Calc Min Wage Bal' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[Calc_Min_Wage_Bal]), rtrim(['Payroll Master'].[CHANGEBY_I]) as 'Change By', ['Payroll Master'].[CHANGEDATE_I] as 'Change Date', ['Payroll Transaction History'].[CHEKDATE] as 'Check Date', 'Citizen' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[CITIZEN]), rtrim(['Payroll Address Master'].[CITY]) as 'City', rtrim(['Payroll Address Master'].[COUNTRY]) as 'Country', rtrim(['Payroll Address Master'].[CCode]) as 'Country Code', rtrim(['Payroll Address Master'].[COUNTY]) as 'County', ['Payroll Master'].[DEMPINAC] as 'Date Employee Inactivated', ['Payroll Master'].[DATEOFLASTREVIEW_I] as 'Date Of Last Review', ['Payroll Master'].[DATEOFNEXTREVIEW_I] as 'Date Of Next Review', ['Payroll Transaction History'].[DAYSWRDK] as 'Days Worked', rtrim(['Payroll Transaction History'].[DEPRTMNT]) as 'Department', rtrim(['Payroll Master'].[DEPRTMNT]) as 'Department from Employee Master', 'Disabled Veteran' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[DISABLEDVETERAN]), rtrim(['Payroll Master'].[DIVISIONCODE_I]) as 'Division Code', ['Payroll Transaction History'].[DOCTYPE] as 'Document Type', 'EIC Filing Status' = dbo.DYN_FUNC_EIC_Filing_Status(['Payroll Tax Information Master'].[EICFLGST]), rtrim(['Payroll Master'].[EMPLCLAS]) as 'Employee Class', ['Payroll Tax Information Master'].[ESTFEDWH] as 'Estimated Federal Withholding', 'Ethnic Origin' = dbo.DYN_FUNC_Ethnic_Origin(['Payroll Master'].[ETHNORGN]), 'Exempt From Federal' = dbo.DYN_FUNC_Boolean_All(['Payroll Tax Information Master'].[EXMFRFED]), rtrim(['Payroll Address Master'].[FAX]) as 'Fax', rtrim(['Payroll Master'].[FEDCLSSCD]) as 'Federal Classification Code', ['Payroll Tax Information Master'].[FEDEXMPT] as 'Federal Exemptions', rtrim(['Payroll Tax Information Master'].[FDFLGSTS]) as 'Federal Filing Status', rtrim(['Payroll Master'].[FRSTNAME]) as 'First Name', 'Foreign Address' = dbo.DYN_FUNC_Boolean_All(['Payroll Address Master'].[Foreign_Address]), rtrim(['Payroll Address Master'].[Foreign_Postal_Code]) as 'Foreign Postal Code', rtrim(['Payroll Address Master'].[Foreign_StateProvince]) as 'Foreign State/Province', 'Gender' = dbo.DYN_FUNC_Gender(['Payroll Master'].[GENDER]), 'HR Status' = dbo.DYN_FUNC_HR_Status(['Payroll Master'].[HRSTATUS]), 'Handicapped' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[HANDICAPPED]), ['Payroll Master'].[I9RENEW] as 'I9renew', 'Inactive' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[INACTIVE]), rtrim(['Payroll Transaction History'].[JOBTITLE]) as 'Job Title', rtrim(['Payroll Master'].[JOBTITLE]) as 'Job Title from Employee Master', ['Payroll Transaction History'].[LSTDTEDT] as 'Last Date Edited', ['Payroll Master'].[LASTDAYWORKED_I] as 'Last Day Worked', rtrim(['Payroll Master'].[LASTNAME]) as 'Last Name', rtrim(['Payroll Transaction History'].[LASTUSER]) as 'Last User', rtrim(['Payroll Transaction History'].[LOCALTAX]) as 'Local Tax', rtrim(['Payroll Tax Information Master'].[LOCALTAX]) as 'Local Tax from Employee Master', rtrim(['Payroll Master'].[LOCATNID]) as 'Location ID', 'MaritalStatus' = dbo.DYN_FUNC_MaritalStatus(['Payroll Master'].[MARITALSTATUS]), 'Medicare Qualified Govt Employee' = dbo.DYN_FUNC_Boolean_All(['Payroll Tax Information Master'].[MCRQGEMP]), rtrim(['Payroll Master'].[MIDLNAME]) as 'Middle Name', ['Payroll Master'].[MINETPAY] as 'Minimum Net Pay', rtrim(['Payroll Master'].[NICKNAME]) as 'NickName', ['Payroll Master'].[NOTEINDX] as 'Note Index', ['Payroll Master'].[NOTEINDX2] as 'Note Index2', 'Other Veterans' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[OTHERVET]), ['Payroll Transaction History'].[PAYADVNC] as 'Pay Advance', ['Payroll Transaction History'].[PAYRATE] as 'Pay Rate', ['Payroll Transaction History'].[PYADNMBR] as 'Payment/Adjustment Number', rtrim(['Payroll Transaction History'].[PAYROLCD]) as 'Payroll Code', 'Payroll Record Type' = dbo.DYN_FUNC_Payroll_Record_Type(['Payroll Transaction History'].[PYRLRTYP]), rtrim(['Payroll Address Master'].[PHONE1]) as 'Phone 1',  rtrim(['Payroll Address Master'].[PHONE2]) as 'Phone 2', rtrim(['Payroll Address Master'].[PHONE3]) as 'Phone 3', rtrim(['Payroll Master'].[Primary_Pay_Record]) as 'Primary Pay Record', rtrim(['Payroll Master'].[RATECLSS]) as 'Rate Class', rtrim(['Payroll Master'].[RSNEMPIN]) as 'Reason Employee Inactivated', ['Payroll Transaction History'].[RECEIPTS] as 'Receipts', ['Payroll Transaction History'].[CMRECNUM] as 'Record Number', rtrim(['Payroll Transaction History'].[SHFTCODE]) as 'Shift Code', ['Payroll Transaction History'].[SHFTPREM] as 'Shift Premium', ['Payroll Master'].[SKTMACAM]/100.00 as 'Sick Time Accrual Amount', 'Sick Time Accrual Method' = dbo.DYN_FUNC_Sick_Time_Accrual_Method(['Payroll Master'].[STMACMTH]), ['Payroll Master'].[SIKTIMAV]/100.00 as 'Sick Time Available', ['Payroll Master'].[SKTMHPYR]/100.00 as 'Sick Time Hours Per Year', 'Smoker' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[SMOKER_I]), rtrim(['Payroll Master'].[SOCSCNUM]) as 'Social Security Number', rtrim(['Payroll Master'].[SPOUSE]) as 'Spouse', rtrim(['Payroll Master'].[SPOUSESSN]) as 'Spouse SSN', ['Payroll Master'].[STRTDATE] as 'Start Date', rtrim(['Payroll Address Master'].[STATE]) as 'State', rtrim(['Payroll Transaction History'].[STATECD]) as 'State Code', rtrim(['Payroll Tax Information Master'].[STATECD]) as 'State Code from Employee Master', 'Subject To Futa' = dbo.DYN_FUNC_Boolean_All(['Payroll Transaction History'].[SBJTFUTA]), rtrim(['Payroll Master'].[SUPERVISORCODE_I]) as 'Supervisor Code', rtrim(['Payroll Transaction History'].[SUTASTAT]) as 'Suta State', rtrim(['Payroll Master'].[SUTASTAT]) as 'Suta State from Employee Master', ['Payroll Transaction History'].[TRXBEGDT] as 'TRX Beginning Date', ['Payroll Transaction History'].[TRXENDDT] as 'TRX Ending Date', rtrim(['Payroll Transaction History'].[TRXSORCE]) as 'TRX Source', ['Payroll Transaction History'].[TXBLWAGS] as 'Taxable Wages', ['Payroll Transaction History'].[TIMEAVAILABLE] as 'Time Available', 'Tip Type' = dbo.DYN_FUNC_Tip_Type(['Payroll Transaction History'].[TipType]), 'Type of Employment' = dbo.DYN_FUNC_Type_of_Employment(['Payroll Master'].[EMPLOYMENTTYPE]), rtrim(['Payroll Master'].[UNIONCD]) as 'Union Code', 'Union Employee' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[UNIONEMPLOYEE]), ['Payroll Transaction History'].[UNTSTOPY] as 'Units To Pay', rtrim(['Payroll Master'].[USERDEF1]) as 'User Defined 1', rtrim(['Payroll Master'].[USERDEF2]) as 'User Defined 2', rtrim(['Payroll Transaction History'].[USWHPSTD]) as 'User Who Posted', ['Payroll Master'].[VACCRAMT]/100.00 as 'Vacation Accrual Amount', 'Vacation Accrual Method' = dbo.DYN_FUNC_Vacation_Accrual_Method(['Payroll Master'].[VACCRMTH]), ['Payroll Master'].[VACAVLBL]/100.00 as 'Vacation Available', ['Payroll Master'].[VACAPRYR]/100.00 as 'Vacation Hours Per Year', 'Verified' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[VERIFIED]), 'Veteran' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[VETERAN]), 'Vietnam Veteran' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[VIETNAMVETERAN]), 'W2 Box For 942 Employee' = dbo.DYN_FUNC_Boolean_All(['Payroll Tax Information Master'].[W2BF942E]), 'W2 Box For Deceased' = dbo.DYN_FUNC_Boolean_All(['Payroll Tax Information Master'].[W2BFDCSD]), 'W2 Box For Deferred Compensation' = dbo.DYN_FUNC_Boolean_All(['Payroll Tax Information Master'].[W2BFDCMP]), 'W2 Box For Legal Representative' = dbo.DYN_FUNC_Boolean_All(['Payroll Tax Information Master'].[W2BFLREP]), 'W2 Box For Retirement Plan' = dbo.DYN_FUNC_Boolean_All(['Payroll Tax Information Master'].[W2BFPPLN]), 'W2 Box For Statutory Employee' = dbo.DYN_FUNC_Boolean_All(['Payroll Tax Information Master'].[W2BFSTEM]), 'Warn Sick Time Falls Below Zero' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[WRNSTFLSBLWZR]), 'Warn Vacation Falls Below Zero' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[WRNVCNFLSBLWZR]), ['Payroll Transaction History'].[WKSWRKD]/100.00 as 'Weeks Worked', 'Which Cash Account For Pay' = dbo.DYN_FUNC_Which_Cash_Account_For_Pay(['Payroll Master'].[WCACFPAY]), 'Withhold NY Tax Diff' = dbo.DYN_FUNC_Boolean_All(['Payroll Tax Information Master'].[NYTXDiff]), ['Payroll Master'].[WKHRPRYR] as 'Work Hours Per Year', rtrim(['Payroll Transaction History'].[WRKRCOMP]) as 'Workers Comp', rtrim(['Payroll Master'].[WRKRCOMP]) as 'Workers Comp from Employee Master', ['Payroll Transaction History'].[YEAR1] as 'Year', rtrim(['Payroll Address Master'].[ZIPCODE]) as 'Zip Code',  'Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Payroll Master'].[ACTINDX] ), 'Employee ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppEmployeeID(1,['Payroll Transaction History'].[EMPLOYID] )        from [UPR30300] as ['Payroll Transaction History'] with (NOLOCK) left outer join [UPR00100] as ['Payroll Master'] with (NOLOCK) on ['Payroll Transaction History'].[EMPLOYID] = ['Payroll Master'].[EMPLOYID] left outer join [UPR00102] as ['Payroll Address Master'] with (NOLOCK) on ['Payroll Master'].[EMPLOYID] = ['Payroll Address Master'].[EMPLOYID]  and ['Payroll Master'].[ADRSCODE] = ['Payroll Address Master'].[ADRSCODE] left outer join [UPR00300] as ['Payroll Tax Information Master'] with (NOLOCK) on ['Payroll Master'].[EMPLOYID] = ['Payroll Tax Information Master'].[EMPLOYID] 
GO
GRANT SELECT ON  [dbo].[PayrollHistoricalTrx] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[PayrollHistoricalTrx] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[PayrollHistoricalTrx] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[PayrollHistoricalTrx] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[PayrollHistoricalTrx] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[PayrollHistoricalTrx] TO [rpt_payroll]
GO
