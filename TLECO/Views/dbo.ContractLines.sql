SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[ContractLines] AS select 'Contract Record Type' = dbo.FS_FUNC_Contract_Record_Type(['SVC_Contract_Line'].[CONSTS]), rtrim(['SVC_Contract_Line'].[CONTNBR]) as 'Contract Number', ['SVC_Contract_Line'].[LNSEQNBR] as 'Line SEQ Number', rtrim(['SVC_Contract_Line'].[ADRSCODE]) as 'Address Code', ['SVC_Contract_Line'].[QUANTITY] as 'QTY', rtrim(['SVC_Contract_Line'].[ITEMNMBR]) as 'Item Number', ['SVC_Contract_Line'].[EQUIPID] as 'Equipment ID', rtrim(['SVC_Contract_Line'].[SERLNMBR]) as 'Serial Number', ['SVC_Contract_Line'].[BILSTRT] as 'Bill Start', ['SVC_Contract_Line'].[BILEND] as 'Bill End', ['SVC_Contract_Line'].[BILLNGTH] as 'Bill Length', 'Bill Period' = dbo.FS_FUNC_Bill_Period(['SVC_Contract_Line'].[BILPRD]), ['SVC_Contract_Line'].[TOTAL] as 'Total', rtrim(['SVC_Contract_Line'].[CNTTYPE]) as 'Contract Type', rtrim(['SVC_Contract_Line'].[CUSTNMBR]) as 'Customer ID', rtrim(['SVC_Contract_Line'].[SRVTYPE]) as 'Service Type', ['SVC_Contract_Line'].[TOTBIL] as 'Total Billed', 'Pre Paid' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_Line'].[PREPAID]), ['SVC_Contract_Line'].[BILONDY] as 'Bill On Day', 'Billing Cycle' = dbo.FS_FUNC_Billing_Cycle(['SVC_Contract_Line'].[BILCYC]), ['SVC_Contract_Line'].[STRTDATE] as 'Start Date', ['SVC_Contract_Line'].[ENDDATE] as 'End Date', ['SVC_Contract_Line'].[Unit_Cost_Total] as 'Unit Cost Total', 'SVC_Liability_Type' = dbo.FS_FUNC_SVC_Liability_Type(['SVC_Contract_Line'].[SVC_Liability_Type]),  ['SVC_Contract_Line'].[ACTCAL] as 'Actual Number of Calls', ['SVC_Contract_Line'].[Amount_To_Invoice] as 'Amount To Invoice', 'Auto Renewing' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_Line'].[AUTOREN]), 'Bill For Retainer' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_Line'].[BILFRRET]), rtrim(['RM Customer MSTR2'].[CUSTNMBR]) as 'Bill To Customer ID', rtrim(['RM Customer MSTR2'].[CUSTNAME]) as 'Bill To Customer Name', 'Billing Status' = dbo.FS_FUNC_Billing_Status(['SVC_Contract_Line'].[BILSTAT]), ['SVC_Contract_Line'].[BLKTIM] as 'Blocked Time', rtrim(['SVC_Contract_Line'].[COMMCODE]) as 'Commission Code', ['SVC_Contract_Line'].[COMDLRAM] as 'Commission Dollar Amount', ['SVC_Contract_Line'].[COMPRCNT] as 'Commission Percent', ['SVC_Contract_Line'].[CNFGLVL] as 'Config Level', rtrim(['SVC_Contract_Line'].[CONFGREF]) as 'Config Reference', ['SVC_Contract_Line'].[CNFGSEQ] as 'Config Sequence', rtrim(['SVC_Contract_Line'].[CONTACT]) as 'Contact', ['SVC_Contract_Line'].[Contract_Coverage_Period_1] as 'Contract Coverage Periods End', ['SVC_Contract_Line'].[CNTCOVPD_1] as 'Contract Coverage Periods Start', ['SVC_Contract_Line'].[Contract_Length] as 'Contract Length', rtrim(['SVC_Contract_Line'].[Contract_Line_Status]) as 'Contract Line Status', 'Contract Period' = dbo.FS_FUNC_Contract_Period(['SVC_Contract_Line'].[Contract_Period]), 'Contract Price Overridden' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_Line'].[CNTPRCOVR]), rtrim(['SVC_Contract_Line'].[Contract_Renewal_Contact]) as 'Contract Renewal Contact', rtrim(['SVC_Contract_Line'].[Contract_Response_Time]) as 'Contract Response Time', ['SVC_Contract_Line'].[Contract_Transfer_Date] as 'Contract Transfer Date', 'Contract Transfer Status' = dbo.FS_FUNC_Contract_Transfer_Status(['SVC_Contract_Line'].[Contract_Transfer_Status]), rtrim(['SVC_Contract_Line'].[COUNTRY]) as 'Country', rtrim(['SVC_Contract_Line'].[CURNCYID]) as 'Currency ID', ['SVC_Contract_Line'].[CURRNIDX] as 'Currency Index', rtrim(['RM Customer MSTR'].[CUSTNAME]) as 'Customer Name', 'Decimal Places' = dbo.DYN_FUNC_Decimal_Places_QTYS(['SVC_Contract_Line'].[DECPLACS]), ['SVC_Contract_Line'].[DENXRATE] as 'Denomination Exchange Rate', rtrim(['SVC_Contract_Line'].[DSCRIPTN]) as 'Description', ['SVC_Contract_Line'].[DSCDLRAM] as 'Discount Dollar Amount', ['SVC_Contract_Line'].[DSCPCTAM]/100.00 as 'Discount Percent Amount', ['SVC_Contract_Line'].[ENTDTE] as 'Entry Date', ['SVC_Contract_Line'].[ENTTME] as 'Entry Time', ['SVC_Contract_Line'].[EXCHDATE] as 'Exchange Date', ['SVC_Contract_Line'].[XCHGRATE] as 'Exchange Rate', rtrim(['SVC_Contract_Line'].[EXGTBLID]) as 'Exchange Table ID', ['SVC_Contract_Line'].[EXPNDATE] as 'Expiration Date', ['SVC_Contract_Line'].[FRSTBLDTE] as 'First Bill Date', ['SVC_Contract_Line'].[FRZEND] as 'Frozen End', ['SVC_Contract_Line'].[FRXSTRT] as 'Frozen Start', ['SVC_Contract_Line'].[ISMCTRX] as 'IS MC Trx', ['SVC_Contract_Line'].[Invoiced_Amount] as 'Invoiced Amount', ['SVC_Contract_Line'].[LABPCT] as 'Labor Pct', ['SVC_Contract_Line'].[Last_Amount_Billed] as 'Last Amount Billed', ['SVC_Contract_Line'].[LSTBLDTE] as 'Last Bill Date', ['SVC_Contract_Line'].[Last_Liability_Date] as 'Last Liability Date', ['SVC_Contract_Line'].[Liability_Amount] as 'Liability Amount', ['SVC_Contract_Line'].[Liability_Months] as 'Liability Months', 'Liability Reduction' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_Line'].[Liabiltiy_Reduction]), rtrim(['SVC_Contract_Line'].[Location_Segment]) as 'Location Segment', ['SVC_Contract_Line'].[MCTRXSTT] as 'MC Transaction State', rtrim(['SVC_Contract_Line'].[MSTCNTRCT]) as 'Master Contract Number', ['SVC_Contract_Line'].[MAXBILL] as 'Max Billable', ['SVC_Contract_Line'].[MAXBIL] as 'Max Billable Call', ['SVC_Contract_Line'].[NBRCAL] as 'Max Number of Calls', ['SVC_Contract_Line'].[MINBIL] as 'Min Billable Call',  ['SVC_Contract_Line'].[MISCPCT] as 'Misc Pct', ['SVC_Contract_Line'].[New_Invoice_Amount] as 'New Invoice Amount', ['SVC_Contract_Line'].[NXTBLDTE] as 'Next Bill Date', ['SVC_Contract_Line'].[Next_Liability_Date] as 'Next Liability Date', ['SVC_Contract_Line'].[NOTEINDX] as 'Note Index', ['SVC_Contract_Line'].[NUMOFINV] as 'Number of Invoices', ['SVC_Contract_Line'].[Orig_Amount_To_Invoice] as 'Originating Amount To Invoice', ['SVC_Contract_Line'].[ORCOMAMT] as 'Originating Commission Dollar Amount', ['SVC_Contract_Line'].[ORDDLRAT] as 'Originating Discount Dollar Amount', ['SVC_Contract_Line'].[OrigDiscountNext] as 'Originating Discount Next', ['SVC_Contract_Line'].[OrigDiscountReceived] as 'Originating Discount Recognized', ['SVC_Contract_Line'].[OrigDiscountRemaining] as 'Originating Discount Remaining', ['SVC_Contract_Line'].[Orig_Invoiced_Amount] as 'Originating Invoiced Amount', ['SVC_Contract_Line'].[ORIGINVOICEDDISC] as 'Originating Invoiced Discount', ['SVC_Contract_Line'].[ORIGLASTAmountBilled] as 'Originating Last Amount Billed', ['SVC_Contract_Line'].[Orig_Liability_Amount] as 'Originating Liability Amount', ['SVC_Contract_Line'].[Originating_Max_Billable] as 'Originating Max Billable', ['SVC_Contract_Line'].[ORIGMAXBIL] as 'Originating Max Billable Call', ['SVC_Contract_Line'].[ORIGMINBIL] as 'Originating Min Billable Call', ['SVC_Contract_Line'].[ORIGMONTHPRICE] as 'Originating Monthly Price', ['SVC_Contract_Line'].[OrigNewInvoiceAmount] as 'Originating New Invoice Amount', ['SVC_Contract_Line'].[ORIGRETNAGAM] as 'Originating Retainage Amount', ['SVC_Contract_Line'].[ORIGRTNBILLD] as 'Originating Retainage Billed', ['SVC_Contract_Line'].[ORIGTOTAL] as 'Originating Service Total', ['SVC_Contract_Line'].[ORTAXAMT] as 'Originating Tax Amount', ['SVC_Contract_Line'].[ORIGTOTBIL] as 'Originating Total Billed', ['SVC_Contract_Line'].[OrigTotLiabilityAmount] as 'Originating Total Liability Amount', ['SVC_Contract_Line'].[OrigTotLiabBilled] as 'Originating Total Liability Billed', ['SVC_Contract_Line'].[Originating_Total_Unit] as 'Originating Total Unit', ['SVC_Contract_Line'].[ORIGTOTVALCAL] as 'Originating Total Value of Calls', ['SVC_Contract_Line'].[ORUNTCST] as 'Originating Unit Cost', ['SVC_Contract_Line'].[ORIGUNITCOSTTOTAL] as 'Originating Unit Cost Total', ['SVC_Contract_Line'].[ORIGVALTIM] as 'Originating Value of Time', ['SVC_Contract_Line'].[PMLABPCT] as 'PM Labor Pct', ['SVC_Contract_Line'].[PMMSCPCT] as 'PM Misc Pct', ['SVC_Contract_Line'].[PMPRTPCT] as 'PM Part Pct', ['SVC_Contract_Line'].[PARTPCT] as 'Part Pct', rtrim(['SVC_Contract_Line'].[PRICSHED]) as 'Price Schedule', rtrim(['SVC_Contract_Line'].[PORDNMBR]) as 'Purchase Order Number', ['SVC_Contract_Line'].[RATECALC] as 'Rate Calc Method', rtrim(['SVC_Contract_Line'].[RATETPID]) as 'Rate Type ID', ['SVC_Contract_Line'].[RETNAGAM] as 'Retainage Amount', ['SVC_Contract_Line'].[RTNBILLD] as 'Retainage Billed', rtrim(['SVC_Contract_Line'].[SVC_Bill_To_Address_Code]) as 'SVC Bill To Address Code', ['SVC_Contract_Line'].[SVC_Contract_Signed] as 'SVC_Contract_Signed', ['SVC_Contract_Line'].[SVC_Discount_Next] as 'SVC Discount Next', ['SVC_Contract_Line'].[SVC_Discount_Recognized] as 'SVC Discount Recognized', ['SVC_Contract_Line'].[SVC_Discount_Remaining] as 'SVC Discount Remaining', rtrim(['SVC_Contract_Line'].[SVC_FO_ID]) as 'SVC FO ID', ['SVC_Contract_Line'].[SVC_Invoiced_Discount] as 'SVC Invoiced Discount', ['SVC_Contract_Line'].[SVC_Monthly_Price] as 'SVC Monthly_Price', ['SVC_Contract_Line'].[SVC_PM_Day] as 'SVC PM Day', 'SVC PM Month' = dbo.FS_FUNC_SVC_PM_Month(['SVC_Contract_Line'].[SVC_PM_Date]), rtrim(['SVC_Contract_Line'].[RETTYPE]) as 'SVC Return Type', rtrim(['SVC_Contract_Line'].[SLPRSNID]) as 'Salesperson ID', rtrim(['SVC_Contract_Line'].[PRCSTAT]) as 'Status of Price', ['SVC_Contract_Line'].[TAXAMNT] as 'Tax Amount', rtrim(['SVC_Contract_Line'].[TAXEXMT1]) as 'Tax Exempt 1', rtrim(['SVC_Contract_Line'].[TAXEXMT2]) as 'Tax Exempt 2', rtrim(['SVC_Contract_Line'].[TAXSCHID]) as 'Tax Schedule ID', ['SVC_Contract_Line'].[TIME1] as 'Time', ['SVC_Contract_Line'].[Total_Liability_Amount] as 'Total Liability Amount', ['SVC_Contract_Line'].[Total_Liability_Billed] as 'Total Liability Billed', ['SVC_Contract_Line'].[Total_Unit] as 'Total Unit', ['SVC_Contract_Line'].[TOTVALCAL] as 'Total Value of Calls', rtrim(['SVC_Contract_Line'].[UOFM]) as 'U Of M', ['SVC_Contract_Line'].[UNITCOST] as 'Unit Cost', 'Use Coverage Period' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_Line'].[USECVPD_1]), ['SVC_Contract_Line'].[VALTIM] as 'Value of Time', rtrim(['SVC_Contract_Line'].[VENDORID]) as 'Vendor ID', ['SVC_Contract_Line'].[VIEWMODE] as 'View Mode', ['SVC_Contract_Line'].[priorityLevel] as 'priorityLevel',  'Customer ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCustomerID(1,['SVC_Contract_Line'].[CUSTNMBR] ), 'Equipment ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=949' +dbo.dgppEquipmentID(1,['SVC_Contract_Line'].[EQUIPID] ), 'Item Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppItemID(1,['SVC_Contract_Line'].[ITEMNMBR],'' ), 'Salesperson ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppSalespersonID(1,['SVC_Contract_Line'].[SLPRSNID],2 ),  'Vendor ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppVendorID(1,['SVC_Contract_Line'].[VENDORID] )        from [SVC00601] as ['SVC_Contract_Line'] with (NOLOCK) left outer join [RM00101] as ['RM Customer MSTR'] with (NOLOCK) on ['SVC_Contract_Line'].[CUSTNMBR] = ['RM Customer MSTR'].[CUSTNMBR] left outer join [RM00101] as ['RM Customer MSTR2'] with (NOLOCK) on ['SVC_Contract_Line'].[Bill_To_Customer] = ['RM Customer MSTR2'].[CUSTNMBR] 
GO
GRANT SELECT ON  [dbo].[ContractLines] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[ContractLines] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[ContractLines] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[ContractLines] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[ContractLines] TO [rpt_customer service rep]
GO
GRANT SELECT ON  [dbo].[ContractLines] TO [rpt_dispatcher]
GO
GRANT SELECT ON  [dbo].[ContractLines] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[ContractLines] TO [rpt_project manager]
GO
