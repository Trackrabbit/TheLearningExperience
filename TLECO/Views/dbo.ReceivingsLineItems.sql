SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[ReceivingsLineItems] AS select rtrim(['Purchasing Receipt Line'].[POPRCTNM]) as 'POP Receipt Number', 'POP Type' = dbo.DYN_FUNC_POP_Type(['Purchasing Receipt Work'].[POPTYPE]), rtrim(['Purchasing Receipt Line'].[ITEMNMBR]) as 'Item Number', rtrim(['Purchasing Receipt Line'].[ITEMDESC]) as 'Item Description', ['Purchasing Receipt Line Quantities'].[QTYSHPPD] as 'QTY Shipped', ['Purchasing Receipt Line Quantities'].[QTYINVCD] as 'QTY Invoiced', ['Purchasing Receipt Line'].[UNITCOST] as 'Unit Cost', ['Purchasing Receipt Line'].[EXTDCOST] as 'Extended Cost', rtrim(['Purchasing Receipt Work'].[VENDORID]) as 'Vendor ID', rtrim(['Purchasing Receipt Work'].[VENDNAME]) as 'Vendor Name',  ['Purchasing Receipt Line'].[ACTLSHIP] as 'Actual Ship Date', rtrim(['Purchasing Receipt Line'].[BOLPRONUMBER]) as 'BOL_PRO Number', 'Based On Invoice Total' = dbo.DYN_FUNC_Boolean_All(['Purchasing Receipt Line'].[BSIVCTTL]), rtrim(['Purchasing Receipt Work'].[BACHNUMB]) as 'Batch Number', rtrim(['Purchasing Receipt Work'].[BCHSOURC]) as 'Batch Source', 'Capital Item' = dbo.DYN_FUNC_Boolean_All(['Purchasing Receipt Line'].[Capital_Item]), rtrim(['Purchasing Receipt Line'].[COMMNTID]) as 'Comment ID', rtrim(['Purchasing Receipt Line'].[CostCatID]) as 'Cost Category ID', rtrim(['Purchasing Receipt Line'].[COSTCODE]) as 'Cost Code', ['Purchasing Receipt Line'].[COSTTYPE] as 'Cost Code Type', ['Purchasing Receipt Work'].[CREATDDT] as 'Created Date', rtrim(['Purchasing Receipt Work'].[CURNCYID]) as 'Currency ID', ['Purchasing Receipt Line'].[CURRNIDX] as 'Currency Index', 'Decimal Places Currency' = dbo.DYN_FUNC_Decimal_Places_Currency(['Purchasing Receipt Line'].[DECPLCUR]), 'Decimal Places QTYS' = dbo.DYN_FUNC_Decimal_Places_QTYS(['Purchasing Receipt Line'].[DECPLQTY]), ['Purchasing Receipt Line'].[DENXRATE] as 'Denomination Exchange Rate', ['Purchasing Receipt Work'].[XCHGRATE] as 'Exchange Rate', ['Purchasing Receipt Work'].[GLPOSTDT] as 'GL Posting Date', ['Purchasing Receipt Line'].[INVINDX] as 'Inventory Index', rtrim(['Purchasing Receipt Line'].[INVRETNUM]) as 'Invoice Return Number', 'Item Tracking Option' = dbo.DYN_FUNC_Item_Tracking_Option(['Purchasing Receipt Line'].[ITMTRKOP]), rtrim(['Purchasing Receipt Line'].[JOBNUMBR]) as 'Job Number', 'Landed Cost' = dbo.DYN_FUNC_Boolean_All(['Purchasing Receipt Line'].[Landed_Cost]), rtrim(['Purchasing Receipt Line'].[Landed_Cost_Group_ID]) as 'Landed Cost Group ID', rtrim(['Purchasing Receipt Line'].[LOCNCODE]) as 'Location Code', ['Purchasing Receipt Work'].[MODIFDT] as 'Modified Date', ['Purchasing Receipt Line'].[NONINVEN] as 'Non IV', 'Originating Decimal Places Currency' = dbo.DYN_FUNC_Decimal_Places_Currency(['Purchasing Receipt Line'].[ODECPLCU]), ['Purchasing Receipt Line'].[OREXTCST] as 'Originating Extended Cost', ['Purchasing Receipt Line'].[ORTAXAMT] as 'Originating Tax Amount', ['Purchasing Receipt Line'].[ORUNTCST] as 'Originating Unit Cost', rtrim(['Purchasing Receipt Line'].[PONUMBER]) as 'PO Number', ['Purchasing Receipt Work'].[POSTEDDT] as 'Posted Date', rtrim(['Purchasing Receipt Work'].[PTDUSRID]) as 'Posted User ID', 'Posting Status' = dbo.DYN_FUNC_Posting_Status_POP_Receipt_Lines(1), ['Purchasing Receipt Line'].[Product_Indicator] as 'Product Indicator', rtrim(['Purchasing Receipt Line'].[ProjNum]) as 'Project Number', ['Purchasing Receipt Line'].[Purchase_IV_Item_Taxable] as 'Purchase IV Item Taxable', rtrim(['Purchasing Receipt Line'].[Purchase_Item_Tax_Schedu]) as 'Purchase Item Tax Schedule ID', ['Purchasing Receipt Line'].[PURPVIDX] as 'Purchase Price Variance Index', rtrim(['Purchasing Receipt Line'].[Purchase_Site_Tax_Schedu]) as 'Purchase Site Tax Schedule ID', ['Purchasing Receipt Line Quantities'].[QTYINVRESERVE] as 'QTY Invoice Reserve', ['Purchasing Receipt Line Quantities'].[QTYMATCH] as 'QTY Matched', ['Purchasing Receipt Line Quantities'].[QTYREJ] as 'QTY Rejected', ['Purchasing Receipt Line Quantities'].[QTYRESERVED] as 'QTY Reserved', 'Rate Calc Method' = dbo.DYN_FUNC_Rate_Calc_Method_POP_Receipts(['Purchasing Receipt Work'].[RATECALC]), ['Purchasing Receipt Work'].[receiptdate] as 'Receipt Date', ['Purchasing Receipt Line'].[RCPTLNNM] as 'Receipt Line Number', rtrim(['Purchasing Receipt Line'].[RCPTRETNUM]) as 'Receipt Return Number', rtrim(['Purchasing Receipt Work'].[TRXSORCE]) as 'TRX Source', ['Purchasing Receipt Line'].[TAXAMNT] as 'Tax Amount', ['Purchasing Receipt Work'].[Tax_Date] as 'Tax Date', ['Purchasing Receipt Work'].[Total_Landed_Cost_Amount] as 'Total Landed Cost', rtrim(['Purchasing Receipt Line'].[UOFM]) as 'U Of M', ['Purchasing Receipt Line'].[UMQTYINB] as 'U Of M QTY In Base', rtrim(['Purchasing Receipt Work'].[USER2ENT]) as 'User To Enter', rtrim(['Purchasing Receipt Work'].[VNDDOCNM]) as 'Vendor Document Number', rtrim(['Purchasing Receipt Line'].[VNDITDSC]) as 'Vendor Item Description', ['Purchasing Receipt Line Quantities Table'].[POLNENUM] as 'PO Line Number',  'Item Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppItemID(1,['Purchasing Receipt Line'].[ITEMNMBR],['Purchasing Receipt Line'].[LOCNCODE] ), 'PO Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppPurchaseOrder(1,2,1,['Purchasing Receipt Work'].[POPTYPE],0, ['Purchasing Receipt Work'].[VENDORID],['Purchasing Receipt Line'].[PONUMBER], '',['Purchasing Receipt Line'].[POPRCTNM],['Purchasing Receipt Line'].[POPRCTNM],'','' ), 'Vendor ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppVendorID(1,['Purchasing Receipt Work'].[VENDORID] )  from [POP10310] as ['Purchasing Receipt Line'] with (NOLOCK) left outer join [POP10300] as ['Purchasing Receipt Work'] with (NOLOCK) on ['Purchasing Receipt Line'].[POPRCTNM] = ['Purchasing Receipt Work'].[POPRCTNM] left outer join [ASIV0001] as ['Purchasing Receipt Line Quantities'] with (NOLOCK) on ['Purchasing Receipt Line'].[POPRCTNM] = ['Purchasing Receipt Line Quantities'].[POPRCTNM]  and ['Purchasing Receipt Line'].[RCPTLNNM] = ['Purchasing Receipt Line Quantities'].[RCPTLNNM] left outer join [POP10500] as ['Purchasing Receipt Line Quantities Table'] with (NOLOCK) on ['Purchasing Receipt Line'].[POPRCTNM] = ['Purchasing Receipt Line Quantities Table'].[POPRCTNM]  and ['Purchasing Receipt Line'].[RCPTLNNM] = ['Purchasing Receipt Line Quantities Table'].[RCPTLNNM] left outer join [IV00101] as ['Item Master'] with (NOLOCK) on ['Purchasing Receipt Line'].[ITEMNMBR] = ['Item Master'].[ITEMNMBR]  union all select rtrim(['Purchasing Receipt Line History'].[POPRCTNM]) as 'POP Receipt Number', 'POP Type' = dbo.DYN_FUNC_POP_Type(['Purchasing Receipt History'].[POPTYPE]), rtrim(['Purchasing Receipt Line History'].[ITEMNMBR]) as 'Item Number', rtrim(['Purchasing Receipt Line History'].[ITEMDESC]) as 'Item Description', ['Purchasing Receipt Line Quantities'].[QTYSHPPD] as 'QTY Shipped', ['Purchasing Receipt Line Quantities'].[QTYINVCD] as 'QTY Invoiced', ['Purchasing Receipt Line History'].[UNITCOST] as 'Unit Cost', ['Purchasing Receipt Line History'].[EXTDCOST] as 'Extended Cost', rtrim(['Purchasing Receipt History'].[VENDORID]) as 'Vendor ID', rtrim(['Purchasing Receipt History'].[VENDNAME]) as 'Vendor Name',  ['Purchasing Receipt Line History'].[ACTLSHIP] as 'Actual Ship Date', rtrim(['Purchasing Receipt Line History'].[BOLPRONUMBER]) as 'BOL_PRO Number', 'Based On Invoice Total' = dbo.DYN_FUNC_Boolean_All(['Purchasing Receipt Line History'].[BSIVCTTL]), rtrim(['Purchasing Receipt History'].[BACHNUMB]) as 'Batch Number', rtrim(['Purchasing Receipt History'].[BCHSOURC]) as 'Batch Source', 'Capital Item' = dbo.DYN_FUNC_Boolean_All(['Purchasing Receipt Line History'].[Capital_Item]), rtrim(['Purchasing Receipt Line History'].[COMMNTID]) as 'Comment ID', rtrim(['Purchasing Receipt Line History'].[CostCatID]) as 'Cost Category ID', rtrim(['Purchasing Receipt Line History'].[COSTCODE]) as 'Cost Code', ['Purchasing Receipt Line History'].[COSTTYPE] as 'Cost Code Type', ['Purchasing Receipt History'].[CREATDDT] as 'Created Date', rtrim(['Purchasing Receipt History'].[CURNCYID]) as 'Currency ID', ['Purchasing Receipt Line History'].[CURRNIDX] as 'Currency Index', 'Decimal Places Currency' = dbo.DYN_FUNC_Decimal_Places_Currency(['Purchasing Receipt Line History'].[DECPLCUR]), 'Decimal Places QTYS' = dbo.DYN_FUNC_Decimal_Places_QTYS(['Purchasing Receipt Line History'].[DECPLQTY]), NULL  as 'Denomination Exchange Rate', ['Purchasing Receipt History'].[XCHGRATE] as 'Exchange Rate', ['Purchasing Receipt History'].[GLPOSTDT] as 'GL Posting Date', ['Purchasing Receipt Line History'].[INVINDX] as 'Inventory Index', rtrim(['Purchasing Receipt Line History'].[INVRETNUM]) as 'Invoice Return Number', 'Item Tracking Option' = dbo.DYN_FUNC_Item_Tracking_Option(['Purchasing Receipt Line History'].[ITMTRKOP]), rtrim(['Purchasing Receipt Line History'].[JOBNUMBR]) as 'Job Number', 'Landed Cost' = dbo.DYN_FUNC_Boolean_All(['Purchasing Receipt Line History'].[Landed_Cost]), rtrim(['Purchasing Receipt Line History'].[Landed_Cost_Group_ID]) as 'Landed Cost Group ID', rtrim(['Purchasing Receipt Line History'].[LOCNCODE]) as 'Location Code', ['Purchasing Receipt History'].[MODIFDT] as 'Modified Date', ['Purchasing Receipt Line History'].[NONINVEN] as 'Non IV', 'Originating Decimal Places Currency' = dbo.DYN_FUNC_Decimal_Places_Currency(['Purchasing Receipt Line History'].[ODECPLCU]), ['Purchasing Receipt Line History'].[OREXTCST] as 'Originating Extended Cost', ['Purchasing Receipt Line History'].[ORTAXAMT] as 'Originating Tax Amount', ['Purchasing Receipt Line History'].[ORUNTCST] as 'Originating Unit Cost', rtrim(['Purchasing Receipt Line History'].[PONUMBER]) as 'PO Number', ['Purchasing Receipt History'].[POSTEDDT] as 'Posted Date', rtrim(['Purchasing Receipt History'].[PTDUSRID]) as 'Posted User ID', 'Posting Status' = dbo.DYN_FUNC_Posting_Status_POP_Receipt_Lines(2), ['Purchasing Receipt Line History'].[Product_Indicator] as 'Product Indicator', rtrim(['Purchasing Receipt Line History'].[ProjNum]) as 'Project Number', ['Purchasing Receipt Line History'].[Purchase_IV_Item_Taxable] as 'Purchase IV Item Taxable', rtrim(['Purchasing Receipt Line History'].[Purchase_Item_Tax_Schedu]) as 'Purchase Item Tax Schedule ID', ['Purchasing Receipt Line History'].[PURPVIDX] as 'Purchase Price Variance Index', rtrim(['Purchasing Receipt Line History'].[Purchase_Site_Tax_Schedu]) as 'Purchase Site Tax Schedule ID', ['Purchasing Receipt Line Quantities'].[QTYINVRESERVE] as 'QTY Invoice Reserve', ['Purchasing Receipt Line Quantities'].[QTYMATCH] as 'QTY Matched', ['Purchasing Receipt Line Quantities'].[QTYREJ] as 'QTY Rejected', ['Purchasing Receipt Line Quantities'].[QTYRESERVED] as 'QTY Reserved', 'Rate Calc Method' = dbo.DYN_FUNC_Rate_Calc_Method_POP_Receipts(['Purchasing Receipt History'].[RATECALC]), ['Purchasing Receipt History'].[receiptdate] as 'Receipt Date', ['Purchasing Receipt Line History'].[RCPTLNNM] as 'Receipt Line Number', rtrim(['Purchasing Receipt Line History'].[RCPTRETNUM]) as 'Receipt Return Number', rtrim(['Purchasing Receipt History'].[TRXSORCE]) as 'TRX Source', ['Purchasing Receipt Line History'].[TAXAMNT] as 'Tax Amount', ['Purchasing Receipt History'].[Tax_Date] as 'Tax Date', ['Purchasing Receipt History'].[Total_Landed_Cost_Amount] as 'Total Landed Cost', rtrim(['Purchasing Receipt Line History'].[UOFM]) as 'U Of M', ['Purchasing Receipt Line History'].[UMQTYINB] as 'U Of M QTY In Base', rtrim(['Purchasing Receipt History'].[USER2ENT]) as 'User To Enter', rtrim(['Purchasing Receipt History'].[VNDDOCNM]) as 'Vendor Document Number', rtrim(['Purchasing Receipt Line History'].[VNDITDSC]) as 'Vendor Item Description', ['Purchasing Receipt Line Quantities Table'].[POLNENUM] as 'PO Line Number',  'Item Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppItemID(1,['Purchasing Receipt Line History'].[ITEMNMBR],['Purchasing Receipt Line History'].[LOCNCODE] ), 'PO Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppPurchaseOrder(1,2,3,['Purchasing Receipt History'].[POPTYPE],0, ['Purchasing Receipt History'].[VENDORID],['Purchasing Receipt Line History'].[PONUMBER], '',['Purchasing Receipt Line History'].[POPRCTNM],['Purchasing Receipt Line History'].[POPRCTNM],'','' ), 'Vendor ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppVendorID(1,['Purchasing Receipt History'].[VENDORID] )      from [POP30310] as ['Purchasing Receipt Line History'] with (NOLOCK) left outer join [POP30300] as ['Purchasing Receipt History'] with (NOLOCK) on ['Purchasing Receipt Line History'].[POPRCTNM] = ['Purchasing Receipt History'].[POPRCTNM] left outer join [ASIV0001] as ['Purchasing Receipt Line Quantities'] with (NOLOCK) on ['Purchasing Receipt Line History'].[POPRCTNM] = ['Purchasing Receipt Line Quantities'].[POPRCTNM]  and ['Purchasing Receipt Line History'].[RCPTLNNM] = ['Purchasing Receipt Line Quantities'].[RCPTLNNM] left outer join [POP10500] as ['Purchasing Receipt Line Quantities Table'] with (NOLOCK) on ['Purchasing Receipt Line History'].[POPRCTNM] = ['Purchasing Receipt Line Quantities Table'].[POPRCTNM]  and ['Purchasing Receipt Line History'].[RCPTLNNM] = ['Purchasing Receipt Line Quantities Table'].[RCPTLNNM] left outer join [IV00101] as ['Item Master'] with (NOLOCK) on ['Purchasing Receipt Line History'].[ITEMNMBR] = ['Item Master'].[ITEMNMBR] 
GO
GRANT SELECT ON  [dbo].[ReceivingsLineItems] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[ReceivingsLineItems] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[ReceivingsLineItems] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[ReceivingsLineItems] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[ReceivingsLineItems] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[ReceivingsLineItems] TO [rpt_purchasing agent]
GO
GRANT SELECT ON  [dbo].[ReceivingsLineItems] TO [rpt_purchasing manager]
GO
GRANT SELECT ON  [dbo].[ReceivingsLineItems] TO [rpt_shipping and receiving]
GO
