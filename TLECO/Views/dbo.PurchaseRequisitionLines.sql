SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[PurchaseRequisitionLines] AS select rtrim(['Purchasing Requisition Line'].[POPRequisitionNumber]) as 'Requisition Number', 'Status' = dbo.DYN_FUNC_Requisition_Line_Status(['Purchasing Requisition Line'].[RequisitionLineStatus]), rtrim(['Purchasing Requisition Line'].[ITEMNMBR]) as 'Item Number', rtrim(['Purchasing Requisition Line'].[ITEMDESC]) as 'Item Description', rtrim(['Purchasing Requisition Line'].[VENDORID]) as 'Vendor ID', ['Purchasing Requisition Line'].[QTYORDER] as 'QTY Ordered', ['Purchasing Requisition Line'].[UNITCOST] as 'Unit Cost', ['Purchasing Requisition Line'].[EXTDCOST] as 'Extended Cost',  rtrim(['Purchasing Requisition Line'].[ADDRESS1]) as 'Address 1', rtrim(['Purchasing Requisition Line'].[ADDRESS2]) as 'Address 2', rtrim(['Purchasing Requisition Line'].[ADDRESS3]) as 'Address 3', rtrim(['Purchasing Requisition Line'].[ADRSCODE]) as 'Address ID', 'Address Source' = dbo.DYN_FUNC_Address_Source(['Purchasing Requisition Line'].[ADDRSOURCE]), rtrim(['Purchasing Requisition Line'].[CITY]) as 'City', rtrim(['Purchasing Requisition Line'].[COMMNTID]) as 'Comment ID', rtrim(['Purchasing Requisition Line'].[CMPNYNAM]) as 'Company Name', rtrim(['Purchasing Requisition Line'].[CONTACT]) as 'Contact', rtrim(['Purchasing Requisition Line'].[COUNTRY]) as 'Country', rtrim(['Purchasing Requisition Line'].[CCode]) as 'Country Code', rtrim(['Purchasing Requisition Line'].[CURNCYID]) as 'Currency ID', rtrim(['Purchasing Requisition Line'].[CURRNIDX]) as 'Currency Index', rtrim(['Purchasing Requisition Line'].[Currency_Note_Index]) as 'Currency Note Index', 'Decimal Places Currency' = dbo.DYN_FUNC_Decimal_Places_Currency(['Purchasing Requisition Line'].[DECPLCUR]), 'Decimal Places QTYS' = dbo.DYN_FUNC_Decimal_Places_QTYS(['Purchasing Requisition Line'].[DECPLQTY]), ['Purchasing Requisition Line'].[DENXRATE] as 'Denomination Exchange Rate', 'Document Status' = dbo.DYN_FUNC_Requisition_Document_Status(1), ['Purchasing Requisition Line'].[EXCHDATE] as 'Exchange Date', ['Purchasing Requisition Line'].[XCHGRATE] as 'Exchange Rate', rtrim(['Purchasing Requisition Line'].[EXGTBLID]) as 'Exchange Table ID', rtrim(['Purchasing Requisition Line'].[FAX]) as 'Fax', ['Purchasing Requisition Line'].[FRTAMNT] as 'Freight Amount', 'Invalid Data Flag' = case ['Purchasing Requisition Line'].[Flags] when 0 then dbo.DYN_FUNC_Boolean_All(0) else dbo.DYN_FUNC_Boolean_All(1) end, (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Purchasing Requisition Line'].[INVINDX]) as 'Inventory Account Number', 'Item Tracking Option' = dbo.DYN_FUNC_Item_Tracking_Option(['Purchasing Requisition Line'].[ITMTRKOP]), ['Purchasing Requisition Line'].[LineNumber] as 'LineNumber', 'MC Transaction State' = dbo.DYN_FUNC_MC_Transaction_State(['Purchasing Requisition Line'].[MCTRXSTT]), 'Non IV' = dbo.DYN_FUNC_Boolean_All(['Purchasing Requisition Line'].[NONINVEN]), ['Purchasing Requisition Line'].[ORD] as 'Ord', 'Originating Decimal Places Currency' = dbo.DYN_FUNC_Currency_Decimals(['Purchasing Requisition Line'].[ODECPLCU]), ['Purchasing Requisition Line'].[OREXTCST] as 'Originating Extended Cost', ['Purchasing Requisition Line'].[ORFRTAMT] as 'Originating Freight Amount', ['Purchasing Requisition Line'].[ORTAXAMT] as 'Originating Tax Amount', rtrim(['Purchasing Requisition Line'].[PHONE1]) as 'Phone 1', rtrim(['Purchasing Requisition Line'].[PHONE2]) as 'Phone 2', rtrim(['Purchasing Requisition Line'].[PHONE3]) as 'Phone 3', ['Purchasing Requisition Line'].[QTYCMTBASE] as 'QTY Committed In Base', ['Purchasing Requisition Line'].[QTYUNCMTBASE] as 'QTY Uncommitted In Base', 'Rate Calc Method' = dbo.DYN_FUNC_Rate_Calculation_Method(['Purchasing Requisition Line'].[RATECALC]), rtrim(['Purchasing Requisition Line'].[RATETPID]) as 'Rate Type ID', ['Purchasing Requisition Line'].[ACCNTNTINDX] as 'Req Note ID - Account', ['Purchasing Requisition Line'].[Comment_Note_Index] as 'Req Note ID - Comment', ['Purchasing Requisition Line'].[Item_Number_Note_Index] as 'Req Note ID - Item', ['Purchasing Requisition Line'].[Location_Code_Note_Index] as 'Req Note ID - Site', ['Purchasing Requisition Line'].[ShippingMethodNoteIndex] as 'Req Note ID - Shipping', ['Purchasing Requisition Line'].[Vendor_Note_Index] as 'Req Note ID - Vendor', ['Purchasing Requisition Line'].[REQDATE] as 'Required Date', 'Requisition Status' = dbo.DYN_FUNC_Requisition_Status(['Purchasing Requisitions'].[RequisitionStatus]), rtrim(['Purchasing Requisition Line'].[SHIPMTHD]) as 'Shipping Method', rtrim(['Purchasing Requisition Line'].[LOCNCODE]) as 'Site ID', rtrim(['Purchasing Requisition Line'].[STATE]) as 'State', ['Purchasing Requisition Line'].[TAXAMNT] as 'Tax Amount', rtrim(['Purchasing Requisition Line'].[UOFM]) as 'U Of M', ['Purchasing Requisition Line'].[UMQTYINB] as 'U Of M QTY In Base', rtrim(['Purchasing Requisition Line'].[USERDEF1]) as 'User Defined 1', rtrim(['Purchasing Requisition Line'].[USERDEF1]) as 'User Defined 2', 'Valuation Method' = dbo.DYN_FUNC_Valuation_Method(['Purchasing Requisition Line'].[VCTNMTHD]), rtrim(['Purchasing Requisition Line'].[ZIPCODE]) as 'Zip Code', 'Requisition Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppPurchaseRequisitionNumber(1,['Purchasing Requisition Line'].[POPRequisitionNumber],0 )  from [POP10210] as ['Purchasing Requisition Line'] with (NOLOCK) left outer join [POP10200] as ['Purchasing Requisitions'] with (NOLOCK) on ['Purchasing Requisition Line'].[POPRequisitionNumber] = ['Purchasing Requisitions'].[POPRequisitionNumber]  union all select rtrim(['Purchasing Requisition Line History'].[POPRequisitionNumber]) as 'Requisition Number', 'Status' = dbo.DYN_FUNC_Requisition_Line_Status(['Purchasing Requisition Line History'].[RequisitionLineStatus]), rtrim(['Purchasing Requisition Line History'].[ITEMNMBR]) as 'Item Number', rtrim(['Purchasing Requisition Line History'].[ITEMDESC]) as 'Item Description', rtrim(['Purchasing Requisition Line History'].[VENDORID]) as 'Vendor ID', ['Purchasing Requisition Line History'].[QTYORDER] as 'QTY Ordered', ['Purchasing Requisition Line History'].[UNITCOST] as 'Unit Cost', ['Purchasing Requisition Line History'].[EXTDCOST] as 'Extended Cost',  rtrim(['Purchasing Requisition Line History'].[ADDRESS1]) as 'Address 1', rtrim(['Purchasing Requisition Line History'].[ADDRESS2]) as 'Address 2', rtrim(['Purchasing Requisition Line History'].[ADDRESS3]) as 'Address 3', rtrim(['Purchasing Requisition Line History'].[ADRSCODE]) as 'Address ID', 'Address Source' = dbo.DYN_FUNC_Address_Source(['Purchasing Requisition Line History'].[ADDRSOURCE]), rtrim(['Purchasing Requisition Line History'].[CITY]) as 'City', rtrim(['Purchasing Requisition Line History'].[COMMNTID]) as 'Comment ID', rtrim(['Purchasing Requisition Line History'].[CMPNYNAM]) as 'Company Name', rtrim(['Purchasing Requisition Line History'].[CONTACT]) as 'Contact', rtrim(['Purchasing Requisition Line History'].[COUNTRY]) as 'Country', rtrim(['Purchasing Requisition Line History'].[CCode]) as 'Country Code', rtrim(['Purchasing Requisition Line History'].[CURNCYID]) as 'Currency ID', rtrim(['Purchasing Requisition Line History'].[CURRNIDX]) as 'Currency Index', rtrim(['Purchasing Requisition Line History'].[Currency_Note_Index]) as 'Currency Note Index', 'Decimal Places Currency' = dbo.DYN_FUNC_Decimal_Places_Currency(['Purchasing Requisition Line History'].[DECPLCUR]), 'Decimal Places QTYS' = dbo.DYN_FUNC_Decimal_Places_QTYS(['Purchasing Requisition Line History'].[DECPLQTY]), ['Purchasing Requisition Line History'].[DENXRATE] as 'Denomination Exchange Rate', 'Document Status' = dbo.DYN_FUNC_Requisition_Document_Status(2), ['Purchasing Requisition Line History'].[EXCHDATE] as 'Exchange Date', ['Purchasing Requisition Line History'].[XCHGRATE] as 'Exchange Rate', rtrim(['Purchasing Requisition Line History'].[EXGTBLID]) as 'Exchange Table ID', rtrim(['Purchasing Requisition Line History'].[FAX]) as 'Fax', ['Purchasing Requisition Line History'].[FRTAMNT] as 'Freight Amount', 'Invalid Data Flag' = case ['Purchasing Requisition Line History'].[Flags] when 0 then dbo.DYN_FUNC_Boolean_All(0) else dbo.DYN_FUNC_Boolean_All(1) end, (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Purchasing Requisition Line History'].[INVINDX]) as 'Inventory Account Number', 'Item Tracking Option' = dbo.DYN_FUNC_Item_Tracking_Option(['Purchasing Requisition Line History'].[ITMTRKOP]), ['Purchasing Requisition Line History'].[LineNumber] as 'LineNumber', 'MC Transaction State' = dbo.DYN_FUNC_MC_Transaction_State(['Purchasing Requisition Line History'].[MCTRXSTT]), 'Non IV' = dbo.DYN_FUNC_Boolean_All(['Purchasing Requisition Line History'].[NONINVEN]), ['Purchasing Requisition Line History'].[ORD] as 'Ord', 'Originating Decimal Places Currency' = dbo.DYN_FUNC_Currency_Decimals(['Purchasing Requisition Line History'].[ODECPLCU]), ['Purchasing Requisition Line History'].[OREXTCST] as 'Originating Extended Cost', ['Purchasing Requisition Line History'].[ORFRTAMT] as 'Originating Freight Amount', ['Purchasing Requisition Line History'].[ORTAXAMT] as 'Originating Tax Amount', rtrim(['Purchasing Requisition Line History'].[PHONE1]) as 'Phone 1', rtrim(['Purchasing Requisition Line History'].[PHONE2]) as 'Phone 2', rtrim(['Purchasing Requisition Line History'].[PHONE3]) as 'Phone 3', ['Purchasing Requisition Line History'].[QTYCMTBASE] as 'QTY Committed In Base', ['Purchasing Requisition Line History'].[QTYUNCMTBASE] as 'QTY Uncommitted In Base', 'Rate Calc Method' = dbo.DYN_FUNC_Rate_Calculation_Method(['Purchasing Requisition Line History'].[RATECALC]), rtrim(['Purchasing Requisition Line History'].[RATETPID]) as 'Rate Type ID', ['Purchasing Requisition Line History'].[ACCNTNTINDX] as 'Req Note ID - Account', ['Purchasing Requisition Line History'].[Comment_Note_Index] as 'Req Note ID - Comment', ['Purchasing Requisition Line History'].[Item_Number_Note_Index] as 'Req Note ID - Item', ['Purchasing Requisition Line History'].[Location_Code_Note_Index] as 'Req Note ID - Site', ['Purchasing Requisition Line History'].[ShippingMethodNoteIndex] as 'Req Note ID - Shipping', ['Purchasing Requisition Line History'].[Vendor_Note_Index] as 'Req Note ID - Vendor', ['Purchasing Requisition Line History'].[REQDATE] as 'Required Date', 'Requisition Status' = dbo.DYN_FUNC_Requisition_Status(['Purchasing Requisition History'].[RequisitionStatus]), rtrim(['Purchasing Requisition Line History'].[SHIPMTHD]) as 'Shipping Method', rtrim(['Purchasing Requisition Line History'].[LOCNCODE]) as 'Site ID', rtrim(['Purchasing Requisition Line History'].[STATE]) as 'State', ['Purchasing Requisition Line History'].[TAXAMNT] as 'Tax Amount', rtrim(['Purchasing Requisition Line History'].[UOFM]) as 'U Of M', ['Purchasing Requisition Line History'].[UMQTYINB] as 'U Of M QTY In Base', rtrim(['Purchasing Requisition Line History'].[USERDEF1]) as 'User Defined 1', rtrim(['Purchasing Requisition Line History'].[USERDEF1]) as 'User Defined 2', 'Valuation Method' = dbo.DYN_FUNC_Valuation_Method(['Purchasing Requisition Line History'].[VCTNMTHD]), rtrim(['Purchasing Requisition Line History'].[ZIPCODE]) as 'Zip Code', 'Requisition Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppPurchaseRequisitionNumber(1,['Purchasing Requisition Line History'].[POPRequisitionNumber],1 )        from [POP30210] as ['Purchasing Requisition Line History'] with (NOLOCK) left outer join [POP30200] as ['Purchasing Requisition History'] with (NOLOCK) on ['Purchasing Requisition Line History'].[POPRequisitionNumber] = ['Purchasing Requisition History'].[POPRequisitionNumber] 
GO
GRANT SELECT ON  [dbo].[PurchaseRequisitionLines] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[PurchaseRequisitionLines] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[PurchaseRequisitionLines] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[PurchaseRequisitionLines] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[PurchaseRequisitionLines] TO [rpt_accounting manager]
GO
GRANT SELECT ON  [dbo].[PurchaseRequisitionLines] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[PurchaseRequisitionLines] TO [rpt_operations manager]
GO
GRANT SELECT ON  [dbo].[PurchaseRequisitionLines] TO [rpt_purchasing agent]
GO
GRANT SELECT ON  [dbo].[PurchaseRequisitionLines] TO [rpt_purchasing manager]
GO
