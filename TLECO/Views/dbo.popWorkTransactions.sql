SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 CREATE VIEW [dbo].[popWorkTransactions] as (  select 0 as 'MKTOPROC',  0 as 'InfoValue',  0 as 'CURRNIDX',   GETDATE() AS 'DOCDATE',  REPLICATE('X', 15) as 'VENDORID',  REPLICATE('X', 65) as 'VENDNAME',  REPLICATE('X', 61) as 'CONTACT',  0 as 'SOURCE',  0 as 'DOCTYPE',  REPLICATE('X', 21) as 'DOCTYNAM',  REPLICATE('X', 21) as 'DOCNUMBR',  REPLICATE('X', 21) as 'Other_Number',  REPLICATE('X', 13) as 'TRXSORCE',  0 as 'CNTRLTYP',  0 as 'DCSTATUS',  0 as 'POSTATUS',  REPLICATE('X', 31) as 'STSDESCR',  9999999999999.99999 as 'DOCAMNT',  REPLICATE('X', 15) as 'CURNCYID',  REPLICATE('X', 15) as 'PRSTADCD',  0 as 'VOIDED',  GETDATE() AS 'PRMDATE',  GETDATE() AS 'REQDATE',  GETDATE() AS 'Workflow_Due_Date',  0 as 'Workflow_Approval_Status',  0 as 'Workflow_Status',  REPLICATE('X', 51) as 'Workflow_Name',  REPLICATE('X', 238) as 'Workflow_Approver',  0 as 'Workflow_Priority',  REPLICATE('X', 238) as 'Workflow_Originator',  0 as 'HOLD',  GETDATE() AS 'DUEDATE',  GETDATE() AS 'DISCDATE',  0 as 'WF_Step_Type',  0 as 'RATECALC',  9999999999999.99999 as 'XCHGRATE',  9999999999999.99999 as 'DENXRATE',  0 as 'Emailed'  where (1 = 0)  UNION ALL  select 0 as 'MKTOPROC',   0 as 'InfoValue',  0 as 'CURRNIDX',  ['Purchase Order Work'].[DOCDATE] as 'DOCDATE',  rtrim(['Purchase Order Work'].[VENDORID]) as 'VENDORID',  rtrim(['Purchase Order Work'].[VENDNAME]) as 'VENDNAME',  rtrim(['Purchase Order Work'].[CONTACT]) as 'CONTACT',  1 as 'SOURCE',   ['Purchase Order Work'].[POTYPE] as 'DOCTYPE',  DOCTYNAM = dbo.DYN_FUNC_PO_Type(['Purchase Order Work'].[POTYPE]),  rtrim(['Purchase Order Work'].[PONUMBER]) as 'DOCNUMBR',  '' as 'Other_Number',  '' as 'TRXSORCE',  0 as 'CNTRLTYP',  DCSTATUS = 2,  ['Purchase Order Work'].[POSTATUS] as 'POSTATUS',  STSDESCR = dbo.DYN_FUNC_PO_Status(['Purchase Order Work'].[POSTATUS]),   DOCAMNT = case  when (select((['Purchase Order Work'].[ORSUBTOT] - ['Purchase Order Work'].[ORTDISAM]) +  ['Purchase Order Work'].[ORFRTAMT] + ['Purchase Order Work'].[OMISCAMT] +   ['Purchase Order Work'].[ORTAXAMT])) > 99999999999999.99999   then 99999999999999.99999   else (select((['Purchase Order Work'].[ORSUBTOT] - ['Purchase Order Work'].[ORTDISAM]) +  ['Purchase Order Work'].[ORFRTAMT] + ['Purchase Order Work'].[OMISCAMT] +   ['Purchase Order Work'].[ORTAXAMT]))  end,    rtrim(['Purchase Order Work'].[CURNCYID]) as 'CURNCYID',   rtrim(['Purchase Order Work'].[PRSTADCD]) as 'PRSTADCD',  0 as 'VOIDED',  rtrim(['Purchase Order Work'].[PRMDATE]) as 'PRMDATE',  rtrim(['Purchase Order Work'].[REQDATE]) as 'REQDATE',  '01-01-1900' as Workflow_Due_Date,  'Workflow_Approval_Status' = ['Purchase Order Work'].[Workflow_Approval_Status],  'Workflow_Status' = ['Purchase Order Work'].[Workflow_Status],  '' as Workflow_Name,   '' as Workflow_Approver,  Workflow_Priority = ['Purchase Order Work'].[Workflow_Priority],  '' as Workflow_Originator,  HOLD = ['Purchase Order Work'].[HOLD],  DUEDATE = ['Purchase Order Work'].[DUEDATE],  DISCDATE = ['Purchase Order Work'].[DISCDATE],  0 as WF_Step_Type,  RATECALC = ['Purchase Order Work'].[RATECALC],  XCHGRATE = ['Purchase Order Work'].[XCHGRATE],  DENXRATE = ['Purchase Order Work'].[DENXRATE],  Emailed = dbo.coIsDocumentEmailed(0,12,1,['Purchase Order Work'].[PONUMBER])    from [POP10100] as ['Purchase Order Work'] with (NOLOCK)   where ['Purchase Order Work'].[POTYPE] between 1 and 4 UNION ALL  select 0 as 'MKTOPROC',   0 as 'InfoValue',  0 as 'CURRNIDX',  ['Purchasing Receipt Work'].[receiptdate] as 'DOCDATE',  rtrim(['Purchasing Receipt Work'].[VENDORID]) as 'VENDORID',  rtrim(['Purchasing Receipt Work'].[VENDNAME]) as 'VENDNAME',  (select rtrim(VNDCNTCT) from PM00200 where VENDORID = ['Purchasing Receipt Work'].[VENDORID]) as 'CONTACT',  2 as 'SOURCE',   ['Purchasing Receipt Work'].[POPTYPE] as 'DOCTYPE',  DOCTYNAM = dbo.DYN_FUNC_POP_Type(['Purchasing Receipt Work'].[POPTYPE]),  rtrim(['Purchasing Receipt Work'].[POPRCTNM]) as 'DOCNUMBR',  rtrim(['Purchasing Receipt Work'].[VNDDOCNM]) as 'Other_Number',  '' as 'TRXSORCE',  0 as 'CNTRLTYP',  DCSTATUS = 1,  0 as 'POSTATUS',  '' as 'STSDESCR',   DOCAMNT = dbo.popCalcReceiptTotal(['Purchasing Receipt Work'].[ORSUBTOT],  ['Purchasing Receipt Work'].[ORTDISAM],  ['Purchasing Receipt Work'].[ORFRTAMT],  ['Purchasing Receipt Work'].[ORMISCAMT],  ['Purchasing Receipt Work'].[ORTAXAMT],  ['Purchasing Receipt Work'].[POPTYPE]),   rtrim(['Purchasing Receipt Work'].[CURNCYID]) as 'CURNCYID',   '' as 'PRSTADCD',  0 as 'VOIDED',  '01-01-1900' as 'PRMDATE',  '01-01-1900' as 'REQDATE',  '01-01-1900' as Workflow_Due_Date,  0 as 'Workflow_Approval_Status',  0 as 'Workflow_Status',  '' as Workflow_Name,   '' as Workflow_Approver,  0 as 'Workflow_Priority',  '' as Workflow_Originator,  0 as HOLD,  DUEDATE = ['Purchasing Receipt Work'].[DUEDATE],  DISCDATE = ['Purchasing Receipt Work'].[DISCDATE],  0 as WF_Step_Type,  RATECALC = ['Purchasing Receipt Work'].[RATECALC],  XCHGRATE = ['Purchasing Receipt Work'].[XCHGRATE],  DENXRATE = ['Purchasing Receipt Work'].[DENXRATE],  Emailed = 0    from [POP10300] as ['Purchasing Receipt Work'] with (NOLOCK)   where ['Purchasing Receipt Work'].[POPTYPE] <= 8 )   
GO
GRANT SELECT ON  [dbo].[popWorkTransactions] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[popWorkTransactions] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[popWorkTransactions] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[popWorkTransactions] TO [DYNGRP]
GO
