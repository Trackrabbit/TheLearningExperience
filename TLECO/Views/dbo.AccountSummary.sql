SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[AccountSummary] AS select rtrim(['Account Current Summary Master'].[YEAR1]) as 'Year', ['Account Current Summary Master'].[PERIODID] as 'Period ID', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Account Master'].[ACTINDX]) as 'Account Number', rtrim(['Account Master'].[ACTDESCR]) as 'Account Description', ['Account Current Summary Master'].[DEBITAMT] as 'Debit Amount', ['Account Current Summary Master'].[CRDTAMNT] as 'Credit Amount',  rtrim(['Account Master'].[ACTALIAS]) as 'Account Alias', 'Account Category Number' = dbo.DYN_FUNC_Account_Category_Number(['Account Current Summary Master'].[ACCATNUM]), ['Account Current Summary Master'].[ACTINDX] as 'Account Index', 'Account Type' = dbo.DYN_FUNC_Account_Type(['Account Master'].[ACCTTYPE]), 'Active' = dbo.DYN_FUNC_Boolean_All(['Account Master'].[ACTIVE]), 'Adjust for Inflation' = dbo.DYN_FUNC_Boolean_All(['Account Master'].[ADJINFL]), 'Balance For Calculation' = dbo.DYN_FUNC_Balance_For_Calculation(['Account Master'].[BALFRCLC]), 'Conversion Method' = dbo.DYN_FUNC_Conversion_Method(['Account Master'].[CNVRMTHD]), ['Account Master'].[CREATDDT] as 'Created Date', 'Decimal Places' = dbo.DYN_FUNC_Decimal_Places_QTYS(['Account Master'].[DECPLACS]), 'Document Status' = dbo.DYN_FUNC_Document_Status_GL_Sum(1), 'Fixed Or Variable' = dbo.DYN_FUNC_Fixed_Or_Variable(['Account Master'].[FXDORVAR]), ['Account Master'].[HSTRCLRT] as 'Historical Rate', ['Account Master'].[INFLAEQU] as 'Inflation Equity Account Index', ['Account Master'].[INFLAREV] as 'Inflation Revenue Account Index', rtrim(['Account Master'].[MNACSGMT]) as 'Main Account Segment', ['Account Master'].[MODIFDT] as 'Modified Date', ['Account Master'].[NOTEINDX] as 'Note Index', ['Account Current Summary Master'].[PERDBLNC] as 'Period Balance', 'Post Inventory In' = dbo.DYN_FUNC_Post_Inventory_In(['Account Master'].[PostIvIn]), 'Post Payroll In' = dbo.DYN_FUNC_Post_Payroll_In(['Account Master'].[PostPRIn]), 'Post Purchasing In' = dbo.DYN_FUNC_Post_Purchasing_In(['Account Master'].[PostPurchIn]), 'Post Sales In' = dbo.DYN_FUNC_Post_Sales_In(['Account Master'].[PostSlsIn]), 'Posting Type' = dbo.DYN_FUNC_Posting_Type(['Account Master'].[PSTNGTYP]), ['Account Master'].[ACTNUMBR_1] as 'Segment1', ['Account Master'].[ACTNUMBR_2] as 'Segment2', ['Account Master'].[ACTNUMBR_3] as 'Segment3', ['Account Master'].[ACTNUMBR_4] as 'Segment4', 'Typical Balance' = dbo.DYN_FUNC_Typical_Balance(['Account Master'].[TPCLBLNC]), rtrim(['Account Master'].[USERDEF1]) as 'User Defined 1', rtrim(['Account Master'].[USERDEF2]) as 'User Defined 2',  '4' as 'Segments', 'Ledger Name' = dbo.DYN_FUNC_GL_Ledger_Name(['Account Current Summary Master'].[Ledger_ID]), 'Ledger Description' = dbo.DYN_FUNC_GL_Ledger_Description(['Account Current Summary Master'].[Ledger_ID]), 'Account Index For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Account Current Summary Master'].[ACTINDX] )  from [GL10110] as ['Account Current Summary Master'] with (NOLOCK) left outer join [GL00100] as ['Account Master'] with (NOLOCK) on ['Account Current Summary Master'].[ACTINDX] = ['Account Master'].[ACTINDX]  union all select rtrim(['Account Summary History'].[YEAR1]) as 'Year', ['Account Summary History'].[PERIODID] as 'Period ID', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Account Master'].[ACTINDX]) as 'Account Number', rtrim(['Account Master'].[ACTDESCR]) as 'Account Description', ['Account Summary History'].[DEBITAMT] as 'Debit Amount', ['Account Summary History'].[CRDTAMNT] as 'Credit Amount',  rtrim(['Account Master'].[ACTALIAS]) as 'Account Alias', 'Account Category Number' = dbo.DYN_FUNC_Account_Category_Number(['Account Summary History'].[ACCATNUM]), ['Account Summary History'].[ACTINDX] as 'Account Index', 'Account Type' = dbo.DYN_FUNC_Account_Type(['Account Master'].[ACCTTYPE]), 'Active' = dbo.DYN_FUNC_Boolean_All(['Account Master'].[ACTIVE]), 'Adjust for Inflation' = dbo.DYN_FUNC_Boolean_All(['Account Master'].[ADJINFL]), 'Balance For Calculation' = dbo.DYN_FUNC_Balance_For_Calculation(['Account Master'].[BALFRCLC]), 'Conversion Method' = dbo.DYN_FUNC_Conversion_Method(['Account Master'].[CNVRMTHD]), ['Account Master'].[CREATDDT] as 'Created Date', 'Decimal Places' = dbo.DYN_FUNC_Decimal_Places_QTYS(['Account Master'].[DECPLACS]), 'Document Status' = dbo.DYN_FUNC_Document_Status_GL_Sum(2), 'Fixed Or Variable' = dbo.DYN_FUNC_Fixed_Or_Variable(['Account Master'].[FXDORVAR]), ['Account Master'].[HSTRCLRT] as 'Historical Rate', ['Account Master'].[INFLAEQU] as 'Inflation Equity Account Index', ['Account Master'].[INFLAREV] as 'Inflation Revenue Account Index', rtrim(['Account Master'].[MNACSGMT]) as 'Main Account Segment', ['Account Master'].[MODIFDT] as 'Modified Date', ['Account Master'].[NOTEINDX] as 'Note Index', ['Account Summary History'].[PERDBLNC] as 'Period Balance', 'Post Inventory In' = dbo.DYN_FUNC_Post_Inventory_In(['Account Master'].[PostIvIn]), 'Post Payroll In' = dbo.DYN_FUNC_Post_Payroll_In(['Account Master'].[PostPRIn]), 'Post Purchasing In' = dbo.DYN_FUNC_Post_Purchasing_In(['Account Master'].[PostPurchIn]), 'Post Sales In' = dbo.DYN_FUNC_Post_Sales_In(['Account Master'].[PostSlsIn]), 'Posting Type' = dbo.DYN_FUNC_Posting_Type(['Account Master'].[PSTNGTYP]), ['Account Master'].[ACTNUMBR_1] as 'Segment1', ['Account Master'].[ACTNUMBR_2] as 'Segment2', ['Account Master'].[ACTNUMBR_3] as 'Segment3', ['Account Master'].[ACTNUMBR_4] as 'Segment4', 'Typical Balance' = dbo.DYN_FUNC_Typical_Balance(['Account Master'].[TPCLBLNC]), rtrim(['Account Master'].[USERDEF1]) as 'User Defined 1', rtrim(['Account Master'].[USERDEF2]) as 'User Defined 2',  '4' as 'Segments', 'Ledger Name' = dbo.DYN_FUNC_GL_Ledger_Name(['Account Summary History'].[Ledger_ID]), 'Ledger Description' = dbo.DYN_FUNC_GL_Ledger_Description(['Account Summary History'].[Ledger_ID]), 'Account Index For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Account Summary History'].[ACTINDX] )      from [GL10111] as ['Account Summary History'] with (NOLOCK) left outer join [GL00100] as ['Account Master'] with (NOLOCK) on ['Account Summary History'].[ACTINDX] = ['Account Master'].[ACTINDX] 
GO
GRANT ALTER ON  [dbo].[AccountSummary] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[AccountSummary] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[AccountSummary] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[AccountSummary] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[AccountSummary] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[AccountSummary] TO [rpt_accounting manager]
GO
GRANT SELECT ON  [dbo].[AccountSummary] TO [rpt_bookkeeper]
GO
GRANT SELECT ON  [dbo].[AccountSummary] TO [rpt_certified accountant]
GO
GRANT SELECT ON  [dbo].[AccountSummary] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[AccountSummary] TO [rpt_materials manager]
GO
GRANT SELECT ON  [dbo].[AccountSummary] TO [rpt_operations manager]
GO
GRANT SELECT ON  [dbo].[AccountSummary] TO [rpt_order processor]
GO
GRANT SELECT ON  [dbo].[AccountSummary] TO [rpt_production manager]
GO
GRANT SELECT ON  [dbo].[AccountSummary] TO [rpt_warehouse manager]
GO
