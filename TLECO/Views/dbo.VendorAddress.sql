SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[VendorAddress] AS select rtrim(['PM Address MSTR'].[VENDORID]) as 'Vendor ID', rtrim(['PM Vendor Master File'].[VENDNAME]) as 'Vendor Name', rtrim(['PM Address MSTR'].[ADDRESS1]) as 'Address 1', rtrim(['PM Address MSTR'].[ADDRESS2]) as 'Address 2', rtrim(['PM Address MSTR'].[CITY]) as 'City', rtrim(['PM Address MSTR'].[STATE]) as 'State', rtrim(['PM Address MSTR'].[ZIPCODE]) as 'Zip Code', rtrim(['PM Address MSTR'].[PHNUMBR1]) as 'Phone Number 1',  '1099 Type' = dbo.DYN_FUNC_1099_Type(['PM Vendor Master File'].[TEN99TYPE]), rtrim(['PM Vendor Master File'].[ACNMVNDR]) as 'Account Number With Vendor', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMAPINDX]) as 'Accounts Payable Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[ACPURIDX]) as 'Accrued Purchases Account Number', rtrim(['PM Address MSTR'].[ADDRESS3]) as 'Address 3', rtrim(['PM Address MSTR'].[ADRSCODE]) as 'Address Code', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMCSHIDX]) as 'Cash Account Number', ['PM Vendor Master File'].[CRTCOMDT] as 'Certificate Commencing Date', ['PM Vendor Master File'].[CRTEXPDT] as 'Certificate Expiration Date', rtrim(['PM Vendor Master File'].[CHEKBKID]) as 'Checkbook ID', rtrim(['PM Vendor Master File'].[COMMENT1]) as 'Comment1', rtrim(['PM Vendor Master File'].[COMMENT2]) as 'Comment2', rtrim(['PM Address MSTR'].[COUNTRY]) as 'Country', ['PM Vendor Master File'].[CREATDDT] as 'Created Date', 'Credit Limit' = dbo.DYN_FUNC_Credit_Limit(['PM Vendor Master File'].[CREDTLMT]), ['PM Vendor Master File'].[CRLMTDLR] as 'Credit Limit Dollar', rtrim(['PM Vendor Master File'].[CURNCYID]) as 'Currency ID', rtrim(['PM Vendor Master File'].[DXVARNUM]) as 'Deduction Exemption/Variation Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMDAVIDX]) as 'Discount Available Account Number', ['PM Vendor Master File'].[DISGRPER] as 'Discount Grace Period', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMDTKIDX]) as 'Discount Taken Account Number', rtrim(['PM Vendor Master File'].[DOCFMTID]) as 'Document Format ID', ['PM Vendor Master File'].[DUEGRPER] as 'Due Date Grace Period', 'Expiration Date Obligation' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[XPDTOBLG]), rtrim(['PM Address MSTR'].[FAXNUMBR]) as 'Fax Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMFINIDX]) as 'Finance Charge Account Number', 'Free On Board' = dbo.DYN_FUNC_Free_On_Board(['PM Vendor Master File'].[FREEONBOARD]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMFRTIDX]) as 'Freight Account Number', rtrim(['PM Vendor Master File'].[GOVCRPID]) as 'Governmental Corporate ID', rtrim(['PM Vendor Master File'].[GOVINDID]) as 'Governmental Individual ID', 'Hold' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[HOLD]), rtrim(['Internet Addresses'].[INET1]) as 'INet1', rtrim(['Internet Addresses'].[INET2]) as 'INet2', rtrim(['Internet Addresses'].[INET3]) as 'INet3', rtrim(['Internet Addresses'].[INET4]) as 'INet4', rtrim(['Internet Addresses'].[INET5]) as 'INet5', rtrim(['Internet Addresses'].[INET6]) as 'INet6', rtrim(['Internet Addresses'].[INET7]) as 'INet7', rtrim(['Internet Addresses'].[INET8]) as 'INet8', 'Keep Calendar History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPCALHST]), 'Keep GL Dist History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KGLDSTHS]), 'Keep Period History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPERHIST]), 'Keep Trx History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPTRXHST]), 'Maximum Invoice Amount For Vendors' = dbo.DYN_FUNC_Maximum_Invoice_Amount_For_Vendors(['PM Vendor Master File'].[MXIAFVND]), ['PM Vendor Master File'].[MAXINDLR] as 'Maximum Invoice Dollar', ['PM Vendor Master File'].[MXWOFAMT] as 'Maximum Write Off Amount', ['PM Vendor Master File'].[MINORDER] as 'Minimum Order', ['PM Vendor Master File'].[MINPYDLR] as 'Minimum Payment Dollar', ['PM Vendor Master File'].[MINPYPCT]/100.00 as 'Minimum Payment Percent', 'Minimum Payment Type' = dbo.DYN_FUNC_Minimum_Payment_Type(['PM Vendor Master File'].[MINPYTYP]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMMSCHIX]) as 'Misc Charges Account Number', ['PM Vendor Master File'].[MODIFDT] as 'Modified Date', ['PM Vendor Master File'].[NOTEINDX] as 'Note Index', ['PM Vendor Master File'].[PPSTAXRT]/100.00 as 'PPS Tax Rate', rtrim(['PM Vendor Master File'].[PARVENID]) as 'Parent Vendor ID', rtrim(['PM Vendor Master File'].[PYMNTPRI]) as 'Payment Priority', rtrim(['PM Vendor Master File'].[PYMTRMID]) as 'Payment Terms ID', rtrim(['PM Vendor Master File'].[PHONE3]) as 'Phone 3', rtrim(['PM Address MSTR'].[PHNUMBR2]) as 'Phone Number 2', 'Post Results To' = dbo.DYN_FUNC_Post_Results_To_Vendor(['PM Vendor Master File'].[Post_Results_To]),  'Post To Cash Account From' = dbo.DYN_FUNC_Post_To_Cash_Account_From(['PM Vendor Master File'].[PTCSHACF]), 'Prescribed Payee' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[PRSPAYEE]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PURPVIDX]) as 'Purchase Price Variance Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMPRCHIX]) as 'Purchases Account Number', rtrim(['PM Vendor Master File'].[RATETPID]) as 'Rate Type ID', 'Reporting Obligation Undertaken' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[RTOBUTKN]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMRTNGIX]) as 'Retainage Account Number', 'Revalue Vendor' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[Revalue_Vendor]), rtrim(['PM Address MSTR'].[SHIPMTHD]) as 'Shipping Method', 'Subject To PPS Deductions' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[SBPPSDED]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMTAXIDX]) as 'Tax Account Number', rtrim(['PM Vendor Master File'].[TXIDNMBR]) as 'Tax ID Number', 'Tax Invoice Received' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[TaxInvRecvd]), rtrim(['PM Vendor Master File'].[TXRGNNUM]) as 'Tax Registration Number', rtrim(['PM Address MSTR'].[TAXSCHID]) as 'Tax Schedule ID', ['PM Vendor Master File'].[TRDDISCT]/100.00 as 'Trade Discount', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMTDSCIX]) as 'Trade Discount Account Number', rtrim(['PM Address MSTR'].[UPSZONE]) as 'UPS Zone', rtrim(['PM Vendor Master File'].[USERDEF1]) as 'User Defined 1', rtrim(['PM Vendor Master File'].[USERDEF2]) as 'User Defined 2', rtrim(['PM Vendor Master File'].[VADDCDPR]) as 'Vendor Address Code - Primary', rtrim(['PM Vendor Master File'].[VADCDPAD]) as 'Vendor Address Code - Purchase Address', rtrim(['PM Vendor Master File'].[VADCDTRO]) as 'Vendor Address Code - Remit To', rtrim(['PM Vendor Master File'].[VADCDSFR]) as 'Vendor Address Code - Ship From', rtrim(['PM Vendor Master File'].[VNDCHKNM]) as 'Vendor Check Name', rtrim(['PM Vendor Master File'].[VNDCLSID]) as 'Vendor Class ID', rtrim(['PM Address MSTR'].[VNDCNTCT]) as 'Vendor Contact', rtrim(['PM Vendor Master File'].[VENDSHNM]) as 'Vendor Short Name', 'Vendor Status' = dbo.DYN_FUNC_Vendor_Status(['PM Vendor Master File'].[VENDSTTS]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMWRTIDX]) as 'Write Offs Account Number', 'Writeoff' = dbo.DYN_FUNC_Writeoff(['PM Vendor Master File'].[WRITEOFF]), '1099 Box' = dbo.DYN_FUNC_1099_Box_Type(['PM Vendor Master File'].[TEN99TYPE],['PM Vendor Master File'].[TEN99BOXNUMBER]),  'Accounts Payable Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMAPINDX] ), 'Accrued Purchases Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[ACPURIDX] ), 'Cash Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMCSHIDX] ),  'Checkbook ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCheckbookID(1,['PM Vendor Master File'].[CHEKBKID] ), 'Discount Available Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMDAVIDX] ), 'Discount Taken Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMDTKIDX] ), 'Finance Charge Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMFINIDX] ),  'Freight Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMFRTIDX] ), 'Misc Charges Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMMSCHIX] ), 'Purchase Price Variance Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PURPVIDX] ), 'Purchases Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMPRCHIX] ),  'Retainage Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMRTNGIX] ), 'Tax Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMTAXIDX] ), 'Trade Discount Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMTDSCIX] ), 'Vendor ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppVendorID(1,['PM Address MSTR'].[VENDORID] ),  'Write Offs Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMWRTIDX] )     from [PM00300] as ['PM Address MSTR'] with (NOLOCK) left outer join [PM00200] as ['PM Vendor Master File'] with (NOLOCK) on ['PM Address MSTR'].[VENDORID] = ['PM Vendor Master File'].[VENDORID] left outer join [SY01200] as ['Internet Addresses'] with (NOLOCK) on 'VEN' = ['Internet Addresses'].[Master_Type]  and ['PM Address MSTR'].[VENDORID] = ['Internet Addresses'].[Master_ID]  and ['PM Address MSTR'].[ADRSCODE] = ['Internet Addresses'].[ADRSCODE] 
GO
GRANT SELECT ON  [dbo].[VendorAddress] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[VendorAddress] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[VendorAddress] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[VendorAddress] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[VendorAddress] TO [rpt_accounting manager]
GO
GRANT SELECT ON  [dbo].[VendorAddress] TO [rpt_accounts payable coordinator]
GO
GRANT SELECT ON  [dbo].[VendorAddress] TO [rpt_bookkeeper]
GO
GRANT SELECT ON  [dbo].[VendorAddress] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[VendorAddress] TO [rpt_materials manager]
GO
GRANT SELECT ON  [dbo].[VendorAddress] TO [rpt_operations manager]
GO
GRANT SELECT ON  [dbo].[VendorAddress] TO [rpt_production manager]
GO
GRANT SELECT ON  [dbo].[VendorAddress] TO [rpt_purchasing agent]
GO
GRANT SELECT ON  [dbo].[VendorAddress] TO [rpt_warehouse manager]
GO
