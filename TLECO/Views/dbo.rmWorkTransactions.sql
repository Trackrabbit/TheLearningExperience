SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 CREATE VIEW [dbo].[rmWorkTransactions] as (  select 0 as 'MKTOPROC',  0 as 'InfoValue',  0 as 'CURRNIDX',   GETDATE() AS 'DOCDATE',  0 as 'SOURCE',  0 as 'DOCTYPE',  REPLICATE('X', 21) as 'DOCTYNAM',  REPLICATE('X', 21) as 'DOCNUMBR',  REPLICATE('X', 15) as 'CUSTNMBR',  REPLICATE('X', 65) as 'CUSTNAME',  0 as 'PROSPECT',  0 as 'DCSTATUS',  REPLICATE('X', 31) as 'STSDESCR',  9999999999999.99999 as 'DOCAMNT',  REPLICATE('X', 15) as 'CURNCYID',  REPLICATE('X', 21) as 'CSTPONBR',  REPLICATE('X', 15) as 'PRSTADCD',  REPLICATE('X', 15) as 'SLPRSNID',  REPLICATE('X', 21) as 'SOPNUMBE',  0 as 'SOPSTATUS',  REPLICATE('X', 51) as 'SOPSTSDESCR',  REPLICATE('X', 21) as 'INVCNMBR',  0 as 'VOIDED',  REPLICATE('X', 15) as 'PRCHLDID',  GETDATE() AS 'QUOEXPDA',  GETDATE() AS 'ReqShipDate',  0 as 'ALLOCABY',  REPLICATE('X', 15) as 'DOCID',  0 as 'Password_Valid',  REPLICATE('X', 51) as 'Workflow_Name',  0 as 'Workflow_Approval_Status',  GETDATE() AS 'Workflow_Due_Date',  0 as 'Workflow_Priority',  REPLICATE('X', 238) as 'Workflow_Originator',  REPLICATE('X', 238) as 'Workflow_Approver',  9999999999999.9999 as 'QTYTOPURCH',  0 as 'SHIPCOMPLETE',  0 as 'WF_Step_Type',  REPLICATE('X', 15) as 'BACHNUMB',  REPLICATE('X', 15) as 'BCHSOURC',  REPLICATE('X', 13) as 'TRXSORCE',  REPLICATE('X', 30) as 'TRXDSCRN',  0 as 'Emailed'  where (1 = 0)  UNION ALL  select 0 as 'MKTOPROC',  0 as 'InfoValue',  0 as 'CURRNIDX',   ['RM Sales Work File'].[DOCDATE] as 'DOCDATE',  9 as 'SOURCE',  ['RM Sales Work File'].[RMDTYPAL] as 'DOCTYPE',  'DOCTYNAM' = dbo.DYN_FUNC_Document_Type_RM_Trx(['RM Sales Work File'].[RMDTYPAL]),   rtrim(['RM Sales Work File'].[DOCNUMBR]) as 'DOCNUMBR',  rtrim(['RM Customer MSTR'].[CUSTNMBR]) as 'CUSTNMBR',  rtrim(['RM Customer MSTR'].[CUSTNAME]) as 'CUSTNAME',  0 as 'PROSPECT',  1 as 'DCSTATUS',  'STSDESCR' = dbo.DYN_FUNC_Document_Status_RM_Trx(1),  ['RM Sales Work File'].[DOCAMNT] as 'DOCAMNT',  rtrim(['RM Sales Work File'].[CURNCYID]) as 'CURNCYID',  rtrim(['RM Sales Work File'].[CSTPONBR]) as 'CSTPONBR',  '' as 'PRSTADCD',  rtrim(['RM Sales Work File'].[SLPRSNID]) as 'SLPRSNID',  '' as 'SOPNUMBE',  0 as 'SOPSTATUS',  '' as 'SOPSTSDESCR',  '' as 'INVCNMBR',  0 as 'VOIDED',  '' as 'PRCHLDID',  '01-01-1900' as 'QUOEXPDA',  '01-01-1900' as 'ReqShipDate',  '' as 'ALLOCABY',  '' as 'DOCID',  0 as 'Password_Valid',  '' as 'Workflow_Name',  0 as 'Workflow_Approval_Status',  '01-01-1900' as 'Workflow_Due_Date',  0 as 'Workflow_Priority',  '' as 'Workflow_Originator',  '' as 'Workflow_Approver',  0.0 as 'QTYTOPURCH',  0 as 'SHIPCOMPLETE',  0 as 'WF_Step_Type',  rtrim(['RM Sales Work File'].[BACHNUMB]) as 'BACHNUMB',  rtrim(['RM Sales Work File'].[BCHSOURC]) as 'BCHSOURC',  '' as 'TRXSORCE',  '' as 'TRXDSCRN',  Emailed = dbo.coIsDocumentEmailed(0,9,['RM Sales Work File'].[RMDTYPAL] ,['RM Sales Work File'].[DOCNUMBR])  from [RM10301] as ['RM Sales Work File'] with (NOLOCK)   left outer join [RM00101] as ['RM Customer MSTR'] with (NOLOCK)   on ['RM Sales Work File'].[CUSTNMBR] = ['RM Customer MSTR'].[CUSTNMBR]   UNION ALL  select 0 as 'MKTOPROC',  0 as 'InfoValue',  0 as 'CURRNIDX',   ['RM Cash Receipts Work File'].[DOCDATE] as 'DOCDATE',  9 as 'SOURCE',  ['RM Cash Receipts Work File'].[RMDTYPAL] as 'DOCTYPE',  'DOCTYNAM' = dbo.DYN_FUNC_Document_Type_RM_Trx(['RM Cash Receipts Work File'].[RMDTYPAL]),   rtrim(['RM Cash Receipts Work File'].[DOCNUMBR]) as 'DOCNUMBR',  rtrim(['RM Customer MSTR'].[CUSTNMBR]) as 'CUSTNMBR',  rtrim(['RM Customer MSTR'].[CUSTNAME]) as 'CUSTNAME',  0 as 'PROSPECT',  1 as 'DCSTATUS',  'STSDESCR' = dbo.DYN_FUNC_Document_Status_RM_Trx(1),  ['RM Cash Receipts Work File'].[ORTRXAMT] as 'DOCAMNT',  rtrim(['RM Cash Receipts Work File'].[CURNCYID]) as 'CURNCYID',  '' as 'CSTPONBR',  '' as 'PRSTADCD',  '' as 'SLPRSNID',  '' as 'SOPNUMBE',  0 as 'SOPSTATUS',  '' as 'SOPSTSDESCR',  '' as 'INVCNMBR',  0 as 'VOIDED',  '' as 'PRCHLDID',  '01-01-1900' as 'QUOEXPDA',  '01-01-1900' as 'ReqShipDate',  '' as 'ALLOCABY',  '' as 'DOCID',  0 as 'Password_Valid',  '' as 'Workflow_Name',  0 as 'Workflow_Approval_Status',  '01-01-1900' as 'Workflow_Due_Date',  0 as 'Workflow_Priority',  '' as 'Workflow_Originator',  '' as 'Workflow_Approver',  0.0 as 'QTYTOPURCH',  0 as 'SHIPCOMPLETE',  0 as 'WF_Step_Type',  rtrim(['RM Cash Receipts Work File'].[BACHNUMB]) as 'BACHNUMB',  rtrim(['RM Cash Receipts Work File'].[BCHSOURC]) as 'BCHSOURC',  '' as 'TRXSORCE',  '' as 'TRXDSCRN',  Emailed = 0  from [RM10201] as ['RM Cash Receipts Work File'] with (NOLOCK)   left outer join [RM00101] as ['RM Customer MSTR'] with (NOLOCK)   on ['RM Cash Receipts Work File'].[CUSTNMBR] = ['RM Customer MSTR'].[CUSTNMBR]   UNION ALL  select 0 as 'MKTOPROC',  0 as 'InfoValue',  0 as 'CURRNIDX',   ['RM Open File'].[DOCDATE] as 'DOCDATE',  9 as 'SOURCE',  ['RM Open File'].[RMDTYPAL] as 'DOCTYPE',  'DOCTYNAM' = dbo.DYN_FUNC_Document_Type_RM_Trx(['RM Open File'].[RMDTYPAL]),   rtrim(['RM Open File'].[DOCNUMBR]) as 'DOCNUMBR',  rtrim(['RM Customer MSTR'].[CUSTNMBR]) as 'CUSTNMBR',  rtrim(['RM Customer MSTR'].[CUSTNAME]) as 'CUSTNAME',  0 as 'PROSPECT',  2 as 'DCSTATUS',  '' as 'STSDESCR',  ['RM Open File'].[ORTRXAMT] as 'DOCAMNT',  rtrim(['RM Open File'].[CURNCYID]) as 'CURNCYID',  rtrim(['RM Open File'].[CSPORNBR]) as 'CSTPONBR',  '' as 'PRSTADCD',  rtrim(['RM Open File'].[SLPRSNID]) as 'SLPRSNID',  '' as 'SOPNUMBE',  0 as 'SOPSTATUS',  '' as 'SOPSTSDESCR',  '' as 'INVCNMBR',  'VOIDED' = case   when ['RM Open File'].[VOIDSTTS] > 0 then 1  else 0  end,  '' as 'PRCHLDID',  '01-01-1900' as 'QUOEXPDA',  '01-01-1900' as 'ReqShipDate',  '' as 'ALLOCABY',  '' as 'DOCID',  0 as 'Password_Valid',  '' as 'Workflow_Name',  0 as 'Workflow_Approval_Status',  '01-01-1900' as 'Workflow_Due_Date',  0 as 'Workflow_Priority',  '' as 'Workflow_Originator',  '' as 'Workflow_Approver',  0.0 as 'QTYTOPURCH',  0 as 'SHIPCOMPLETE',  0 as 'WF_Step_Type',  rtrim(['RM Open File'].[BACHNUMB]) as 'BACHNUMB',  rtrim(['RM Open File'].[BCHSOURC]) as 'BCHSOURC',  rtrim(['RM Open File'].[TRXSORCE]) as 'TRXSORCE',  rtrim(['RM Open File'].[TRXDSCRN]) as 'TRXDSCRN',  Emailed =   case   when ['RM Open File'].[TRXSORCE] like (select DISTINCT RTRIM(SQL_MSG) from DYNAMICS..MESSAGES where MSGNUM in (16540))+'%'   or ['RM Open File'].[TRXSORCE] like (select DISTINCT RTRIM(SQL_MSG) from DYNAMICS..MESSAGES where MSGNUM in (16541))+'%' THEN   case ['RM Open File'].[RMDTYPAL]  when 1 then dbo.coIsDocumentEmailed(0,11,3,['RM Open File'].[DOCNUMBR])  when 8 then dbo.coIsDocumentEmailed(0,11,4,['RM Open File'].[DOCNUMBR])  end  else   dbo.coIsDocumentEmailed(0,9,['RM Open File'].[RMDTYPAL] ,['RM Open File'].[DOCNUMBR])  end  from [RM20101] as ['RM Open File'] with (NOLOCK)   left outer join [RM00101] as ['RM Customer MSTR'] with (NOLOCK)   on ['RM Open File'].[CUSTNMBR] = ['RM Customer MSTR'].[CUSTNMBR]  where ['RM Open File'].[RMDTYPAL] IN (1,2,3,4,5,6,7,8,9) )   
GO
GRANT SELECT ON  [dbo].[rmWorkTransactions] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[rmWorkTransactions] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[rmWorkTransactions] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[rmWorkTransactions] TO [DYNGRP]
GO
