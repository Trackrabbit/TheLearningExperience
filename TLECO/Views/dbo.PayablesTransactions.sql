SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[PayablesTransactions] AS select rtrim(['PM Transaction WORK File'].[VCHRNMBR]) as 'Voucher Number', rtrim(['PM Transaction WORK File'].[VENDORID]) as 'Vendor ID', 'Document Type' = dbo.DYN_FUNC_Document_Type_PM_Trx(['PM Transaction WORK File'].[DOCTYPE]), ['PM Transaction WORK File'].[DOCDATE] as 'Document Date', rtrim(['PM Transaction WORK File'].[DOCNUMBR]) as 'Document Number', ['PM Transaction WORK File'].[CURTRXAM] as 'Current Trx Amount',  ['PM Transaction WORK File'].[TEN99AMNT] as '1099 Amount', ['PM Vendor Master Summary'].[TEN99ALIF] as '1099 Amount LIFE', ['PM Vendor Master Summary'].[TEN99ALYR] as '1099 Amount LYR', ['PM Vendor Master Summary'].[TEN99AYTD] as '1099 Amount YTD', '1099 Type from Vendor Master' = dbo.DYN_FUNC_1099_Type(['PM Vendor Master File'].[TEN99TYPE]), rtrim(['PM Vendor Master File'].[ACNMVNDR]) as 'Account Number With Vendor', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMAPINDX]) as 'Accounts Payable Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[ACPURIDX]) as 'Accrued Purchases Account Number', rtrim(['PM Vendor Master File'].[ADDRESS1]) as 'Address 1', rtrim(['PM Vendor Master File'].[ADDRESS2]) as 'Address 2', rtrim(['PM Vendor Master File'].[ADDRESS3]) as 'Address 3', ['PM Vendor Master Summary'].[AMBLDLIF] as 'Amount Billed LIFE', ['PM Vendor Master Summary'].[AMBLDLYR] as 'Amount Billed LYR', ['PM Vendor Master Summary'].[AMBLDTYD] as 'Amount Billed YTD', ['PM Vendor Master Summary'].[AMTPDLIF] as 'Amount Paid LIFE', ['PM Vendor Master Summary'].[AMTPDLYR] as 'Amount Paid LYR', ['PM Vendor Master Summary'].[AMTPDYTD] as 'Amount Paid YTD', ['PM Transaction WORK File'].[APPLDAMT] as 'Applied Amount', ['PM Transaction WORK File'].[APDSTKAM] as 'Applied Discount Taken Amount', 'Apply Withholding' = dbo.DYN_FUNC_Boolean_All(['PM Transaction WORK File'].[APLYWITH]), ['PM Vendor Master Summary'].[AVDTPLIF] as 'Average Days To Pay - Life', ['PM Vendor Master Summary'].[AVGDTPYR] as 'Average Days To Pay - Year', ['PM Transaction WORK File'].[BKTFRTAM] as 'Backout Freight Amount', ['PM Transaction WORK File'].[BKTMSCAM] as 'Backout Misc Amount', ['PM Transaction WORK File'].[BKTPURAM] as 'Backout Purchases Amount', ['PM Transaction WORK File'].[BNKRCAMT] as 'Bank Receipts Amount', rtrim(['PM Transaction WORK File'].[BACHNUMB]) as 'Batch Number', rtrim(['PM Transaction WORK File'].[BCHSOURC]) as 'Batch Source', rtrim(['PM Transaction WORK File'].[CARDNAME]) as 'Card Name', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMCSHIDX]) as 'Cash Account Number', ['PM Transaction WORK File'].[CASHAMNT] as 'Cash Amount', rtrim(['PM Transaction WORK File'].[CAMCBKID]) as 'Cash Amount Checkbook ID', ['PM Transaction WORK File'].[CAMTDATE] as 'Cash Amount Date', rtrim(['PM Transaction WORK File'].[CAMPMTNM]) as 'Cash Amount Payment Number', rtrim(['PM Transaction WORK File'].[CDOCNMBR]) as 'Cash Document Number', ['PM Vendor Master File'].[CRTCOMDT] as 'Certificate Commencing Date', ['PM Vendor Master File'].[CRTEXPDT] as 'Certificate Expiration Date', ['PM Transaction WORK File'].[CHRGAMNT] as 'Charge Amount', ['PM Transaction WORK File'].[CHEKAMNT] as 'Check Amount', rtrim(['PM Transaction WORK File'].[CHAMCBID]) as 'Check Amount Checkbook ID', rtrim(['PM Transaction WORK File'].[CAMPYNBR]) as 'Check Amount Payment Number', ['PM Transaction WORK File'].[CHEKDATE] as 'Check Date', rtrim(['PM Transaction WORK File'].[CHEKNMBR]) as 'Check Number', rtrim(['PM Transaction WORK File'].[CHEKBKID]) as 'Checkbook ID', rtrim(['PM Vendor Master File'].[CHEKBKID]) as 'Checkbook ID from Vendor Master', rtrim(['PM Vendor Master File'].[CITY]) as 'City', rtrim(['PM Vendor Master File'].[COMMENT1]) as 'Comment1', rtrim(['PM Vendor Master File'].[COMMENT2]) as 'Comment2', 'Control Type' = dbo.DYN_FUNC_Control_Type_PM_Trx(['PM Transaction WORK File'].[CNTRLTYP]), 'Correction' = dbo.DYN_FUNC_Boolean_All(['PM Transaction WORK File'].[CORRCTN]), 'Correction to Nonexisting Transaction' = dbo.DYN_FUNC_Boolean_All(['PM Transaction WORK File'].[CORRNXST]), rtrim(['PM Vendor Master File'].[COUNTRY]) as 'Country', ['PM Vendor Master File'].[CREATDDT] as 'Created Date from Vendor Master', ['PM Transaction WORK File'].[CRCRDAMT] as 'Credit Card Amount', rtrim(['PM Transaction WORK File'].[CCAMPYNM]) as 'Credit Card Amount Payment Number', ['PM Transaction WORK File'].[CRCARDDT] as 'Credit Card Date', rtrim(['PM Transaction WORK File'].[CCRCTNUM]) as 'Credit Card Receipt Number', 'Credit Limit' = dbo.DYN_FUNC_Credit_Limit(['PM Vendor Master File'].[CREDTLMT]), ['PM Vendor Master File'].[CRLMTDLR] as 'Credit Limit Dollar', rtrim(['PM Transaction WORK File'].[CURNCYID]) as 'Currency ID', rtrim(['PM Vendor Master File'].[CURNCYID]) as 'Currency ID from Vendor Master', NULL  as 'Currency Index', ['PM Vendor Master Summary'].[CURRBLNC] as 'Current Balance', ['PM Vendor Master Summary'].[CURUNPBN] as 'Current Unapplied Payment Balance', NULL  as 'Date Invoice Paid Off', ['PM Vendor Master Summary'].[DYCHTCLR] as 'Days Checks To Clear',  rtrim(['PM Vendor Master File'].[DXVARNUM]) as 'Deduction Exemption/Variation Number', ['Multicurrency Payables Transactions'].[DENXRATE] as 'Denomination Exchange Rate', NULL  as 'Discount Amount', ['PM Transaction WORK File'].[DISAMTAV] as 'Discount Amount Available', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMDAVIDX]) as 'Discount Available Account Number', ['PM Vendor Master Summary'].[DISAVLIF] as 'Discount Available LIFE', ['PM Vendor Master Summary'].[DISAVLYR] as 'Discount Available LYR', NULL  as 'Discount Available Taken', ['PM Vendor Master Summary'].[DISAVYTD] as 'Discount Available YTD', ['PM Transaction WORK File'].[DISCDATE] as 'Discount Date', ['PM Transaction WORK File'].[DSCDLRAM] as 'Discount Dollar Amount', ['PM Vendor Master File'].[DISGRPER] as 'Discount Grace Period', ['PM Vendor Master Summary'].[DISLSTLF] as 'Discount Lost LIFE', ['PM Vendor Master Summary'].[DISLSLYR] as 'Discount Lost LYR', ['PM Vendor Master Summary'].[DISLSYTD] as 'Discount Lost YTD', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMDTKIDX]) as 'Discount Taken Account Number', ['PM Transaction WORK File'].[DISTKNAM] as 'Discount Taken Amount', ['PM Vendor Master Summary'].[DISTKNLF] as 'Discount Taken LIFE', ['PM Vendor Master Summary'].[DISTKLYR] as 'Discount Taken LYR', ['PM Vendor Master Summary'].[DISTKYTD] as 'Discount Taken YTD', 'DocPrinted' = dbo.DYN_FUNC_Boolean_All(['PM Transaction WORK File'].[DocPrinted]), ['PM Transaction WORK File'].[DOCAMNT] as 'Document Amount', rtrim(['PM Vendor Master File'].[DOCFMTID]) as 'Document Format ID', 'Document Status' = dbo.DYN_FUNC_Document_Status_PM_Trx(1), ['PM Transaction WORK File'].[DUEDATE] as 'Due Date', ['PM Vendor Master File'].[DUEGRPER] as 'Due Date Grace Period', 'EC Transaction' = dbo.DYN_FUNC_Boolean_All(['PM Transaction WORK File'].[ECTRX]), 'Electronic' = dbo.DYN_FUNC_Boolean_All(['PM Transaction WORK File'].[Electronic]), ['Multicurrency Payables Transactions'].[EXCHDATE] as 'Exchange Date', ['Multicurrency Payables Transactions'].[XCHGRATE] as 'Exchange Rate', rtrim(['Multicurrency Payables Transactions'].[EXGTBLID]) as 'Exchange Table ID', 'Expiration Date Obligation' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[XPDTOBLG]), rtrim(['PM Vendor Master File'].[FAXNUMBR]) as 'Fax Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMFINIDX]) as 'Finance Charge Account Number', ['PM Vendor Master Summary'].[FINCHLIF] as 'Finance Charge LIFE', ['PM Vendor Master Summary'].[FINCHLYR] as 'Finance Charge LYR', ['PM Vendor Master Summary'].[FINCHYTD] as 'Finance Charge YTD', ['PM Vendor Master Summary'].[FSTPURDT] as 'First Purchase Date', 'Free On Board' = dbo.DYN_FUNC_Free_On_Board(['PM Vendor Master File'].[FREEONBOARD]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMFRTIDX]) as 'Freight Account Number', ['PM Transaction WORK File'].[FRTAMNT] as 'Freight Amount', rtrim(['PM Transaction WORK File'].[FRTSCHID]) as 'Freight Schedule ID', ['PM Transaction WORK File'].[GSTDSAMT] as 'GST Discount Amount', rtrim(['PM Vendor Master File'].[GOVCRPID]) as 'Governmental Corporate ID', rtrim(['PM Vendor Master File'].[GOVINDID]) as 'Governmental Individual ID', ['PM Vendor Master Summary'].[HIESTBAL] as 'Highest Balance', NULL  as 'Hold', 'Hold from Vendor Master' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[HOLD]), 'IC TRX' = dbo.DYN_FUNC_Boolean_All(['PM Transaction WORK File'].[ICTRX]), 'Keep Calendar History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPCALHST]), 'Keep GL Dist History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KGLDSTHS]), 'Keep Period History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPERHIST]), 'Keep Trx History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPTRXHST]), ['PM Vendor Master Summary'].[LSTCHAMT] as 'Last Check Amount', ['PM Vendor Master Summary'].[LSTCHKDT] as 'Last Check Date', rtrim(['PM Vendor Master Summary'].[LSTCHNUM]) as 'Last Check Number', ['PM Vendor Master Summary'].[LSTINVAM] as 'Last Invoice Amount', rtrim(['PM Vendor Master Summary'].[LSTINNUM]) as 'Last Invoice Number', ['PM Vendor Master Summary'].[LSTPURDT] as 'Last Purchase Date', ['Multicurrency Payables Transactions'].[MCTRXSTT] as 'MC Transaction State', 'Maximum Invoice Amount For Vendors' = dbo.DYN_FUNC_Maximum_Invoice_Amount_For_Vendors(['PM Vendor Master File'].[MXIAFVND]), ['PM Vendor Master File'].[MAXINDLR] as 'Maximum Invoice Dollar', ['PM Vendor Master File'].[MXWOFAMT] as 'Maximum Write Off Amount', ['PM Vendor Master File'].[MINORDER] as 'Minimum Order', ['PM Vendor Master File'].[MINPYDLR] as 'Minimum Payment Dollar', ['PM Vendor Master File'].[MINPYPCT]/100.00 as 'Minimum Payment Percent', 'Minimum Payment Type' = dbo.DYN_FUNC_Minimum_Payment_Type(['PM Vendor Master File'].[MINPYTYP]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMMSCHIX]) as 'Misc Charges Account Number', ['PM Transaction WORK File'].[MSCCHAMT] as 'Misc Charges Amount', rtrim(['PM Transaction WORK File'].[MSCSCHID]) as 'Misc Schedule ID', ['PM Transaction WORK File'].[MODIFDT] as 'Modified Date', ['PM Vendor Master File'].[MODIFDT] as 'Modified Date from Vendor Master', rtrim(['PM Transaction WORK File'].[MDFUSRID]) as 'Modified User ID',  ['PM Transaction WORK File'].[NOTEINDX] as 'Note Index', ['PM Vendor Master File'].[NOTEINDX] as 'Note Index from Vendor Master', ['PM Vendor Master Summary'].[NFNCHLIF] as 'Number of Finance Charges LIFE', ['PM Vendor Master Summary'].[NFNCHLYR] as 'Number of Finance Charges LYR', ['PM Vendor Master Summary'].[NFNCHYTD] as 'Number of Finance Charges YTD', ['PM Vendor Master Summary'].[NOINVLIF] as 'Number of Invoices LIFE', ['PM Vendor Master Summary'].[NOINVLYR] as 'Number of Invoices LYR', ['PM Vendor Master Summary'].[NOINVYTD] as 'Number of Invoices YTD', ['PM Vendor Master Summary'].[NOPILIFE] as 'Number of Paid Invoices LIFE', ['PM Vendor Master Summary'].[NOPINYTD] as 'Number of Paid Invoices YTD', ['PM Vendor Master Summary'].[ONORDAMT] as 'On Order Amount', ['Multicurrency Payables Transactions'].[OR1099AM] as 'Originating 1099 Amount', ['Multicurrency Payables Transactions'].[ORAPPAMT] as 'Originating Applied Amount', ['Multicurrency Payables Transactions'].[ORGAPDISCTKN] as 'Originating Applied Discount Taken Amount', ['Multicurrency Payables Transactions'].[ORBKTFRT] as 'Originating Backout Freight Amount', ['Multicurrency Payables Transactions'].[ORBKTMSC] as 'Originating Backout Misc Amount', ['Multicurrency Payables Transactions'].[OBKPURAMT] as 'Originating Backout Purchases Amount', ['Multicurrency Payables Transactions'].[ORCASAMT] as 'Originating Cash Amount', ['Multicurrency Payables Transactions'].[OCHGAMT] as 'Originating Charge Amount', ['Multicurrency Payables Transactions'].[ORCHKAMT] as 'Originating Check Amount', ['Multicurrency Payables Transactions'].[ORCHKTTL] as 'Originating Check Total', ['Multicurrency Payables Transactions'].[ORCCDAMT] as 'Originating Credit Card Amount', ['Multicurrency Payables Transactions'].[ORCTRXAM] as 'Originating Current Trx Amount', ['Multicurrency Payables Transactions'].[ODISAMTAV] as 'Originating Discount Amount Available', ['Multicurrency Payables Transactions'].[ORDATKN] as 'Originating Discount Available Taken', ['Multicurrency Payables Transactions'].[ORDDLRAT] as 'Originating Discount Dollar Amount', ['Multicurrency Payables Transactions'].[ORDISTKN] as 'Originating Discount Taken Amount', ['Multicurrency Payables Transactions'].[ORDOCAMT] as 'Originating Document Amount', ['Multicurrency Payables Transactions'].[ORFRTAMT] as 'Originating Freight Amount', ['Multicurrency Payables Transactions'].[OMISCAMT] as 'Originating Misc Charges Amount', ['Multicurrency Payables Transactions'].[OPURAMT] as 'Originating Purchases Amount', ['Multicurrency Payables Transactions'].[ORTAXAMT] as 'Originating Tax Amount', ['Multicurrency Payables Transactions'].[OTOTPAY] as 'Originating Total Payments', ['Multicurrency Payables Transactions'].[ORTDISAM] as 'Originating Trade Discount Amount', ['Multicurrency Payables Transactions'].[ORWROFAM] as 'Originating Write Off Amount', ['PM Transaction WORK File'].[PPSAMDED] as 'PPS Amount Deducted', ['PM Transaction WORK File'].[PPSTAXRT]/100.00 as 'PPS Tax Rate', ['PM Vendor Master File'].[PPSTAXRT]/100.00 as 'PPS Tax Rate from Vendor Master', rtrim(['PM Vendor Master File'].[PARVENID]) as 'Parent Vendor ID', NULL  as 'Payment Entry Type', rtrim(['PM Vendor Master File'].[PYMNTPRI]) as 'Payment Priority', rtrim(['PM Transaction WORK File'].[PYMTRMID]) as 'Payment Terms ID', rtrim(['PM Vendor Master File'].[PYMTRMID]) as 'Payment Terms ID from Vendor Master', ['PM Transaction WORK File'].[PRCTDISC] as 'Percent Discount', ['PM Transaction WORK File'].[PGRAMSBJ]/100.00 as 'Percent Of Gross Amount Subject', rtrim(['PM Vendor Master File'].[PHONE3]) as 'Phone 3', rtrim(['PM Vendor Master File'].[PHNUMBR1]) as 'Phone Number 1', rtrim(['PM Vendor Master File'].[PHNUMBR2]) as 'Phone Number 2', 'Post Results To' = dbo.DYN_FUNC_Post_Results_To_Vendor(['PM Vendor Master File'].[Post_Results_To]), 'Post To Cash Account From' = dbo.DYN_FUNC_Post_To_Cash_Account_From(['PM Vendor Master File'].[PTCSHACF]), 'Posted' = dbo.DYN_FUNC_Boolean_All(['PM Transaction WORK File'].[POSTED]), ['PM Transaction WORK File'].[POSTEDDT] as 'Posted Date', rtrim(['PM Transaction WORK File'].[PTDUSRID]) as 'Posted User ID', ['PM Transaction WORK File'].[PSTGDATE] as 'Posting Date', 'Prescribed Payee' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[PRSPAYEE]), 'Printed' = dbo.DYN_FUNC_Boolean_All(['PM Transaction WORK File'].[PRINTED]), ['PM Transaction WORK File'].[PRCHDATE] as 'Purchase Date', rtrim(['PM Transaction WORK File'].[PORDNMBR]) as 'Purchase Order Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PURPVIDX]) as 'Purchase Price Variance Account Number', rtrim(['PM Transaction WORK File'].[PCHSCHID]) as 'Purchase Schedule ID', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMPRCHIX]) as 'Purchases Account Number', ['PM Transaction WORK File'].[PRCHAMNT] as 'Purchases Amount', 'Rate Calculation Method' = dbo.DYN_FUNC_Rate_Calculation_Method(['Multicurrency Payables Transactions'].[RTCLCMTD]), rtrim(['Multicurrency Payables Transactions'].[RATETPID]) as 'Rate Type ID', rtrim(['PM Vendor Master File'].[RATETPID]) as 'Rate Type ID from Vendor Master', 'Reporting Obligation Undertaken' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[RTOBUTKN]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMRTNGIX]) as 'Retainage Account Number', ['PM Transaction WORK File'].[RETNAGAM] as 'Retainage Amount', ['PM Vendor Master Summary'].[RTNGOWED] as 'Retainage Owed', ['PM Vendor Master Summary'].[RTRNSLIF] as 'Returns LIFE',  ['PM Vendor Master Summary'].[RTRNSLYR] as 'Returns LYR', ['PM Vendor Master Summary'].[RTRNSYTD] as 'Returns YTD', 'Revalue Vendor' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[Revalue_Vendor]), rtrim(['PM Transaction WORK File'].[SHIPMTHD]) as 'Shipping Method', rtrim(['PM Vendor Master File'].[SHIPMTHD]) as 'Shipping Method from Vendor Master', 'Simplified' = dbo.DYN_FUNC_Boolean_All(['PM Transaction WORK File'].[SIMPLIFD]), rtrim(['PM Transaction WORK File'].[SOURCDOC]) as 'Source Document', rtrim(['PM Vendor Master File'].[STATE]) as 'State', 'Subject To PPS Deductions' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[SBPPSDED]), NULL  as 'TRX Source', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMTAXIDX]) as 'Tax Account Number', ['PM Transaction WORK File'].[TAXAMNT] as 'Tax Amount', ['PM Transaction WORK File'].[Tax_Date] as 'Tax Date', 'Tax Engine Called' = dbo.DYN_FUNC_Boolean_All(['PM Transaction WORK File'].[TXENGCLD]), rtrim(['PM Vendor Master File'].[TXIDNMBR]) as 'Tax ID Number', 'Tax Invoice Received from Vendor Master' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[TaxInvRecvd]), 'Tax Invoice Required' = dbo.DYN_FUNC_Boolean_All(['PM Transaction WORK File'].[TaxInvReqd]), rtrim(['PM Vendor Master File'].[TXRGNNUM]) as 'Tax Registration Number', rtrim(['PM Transaction WORK File'].[TAXSCHID]) as 'Tax Schedule ID', rtrim(['PM Vendor Master File'].[TAXSCHID]) as 'Tax Schedule ID from Vendor Master', ['Multicurrency Payables Transactions'].[TIME1] as 'Time', NULL  as 'Total Payments', ['PM Vendor Master File'].[TRDDISCT]/100.00 as 'Trade Discount', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMTDSCIX]) as 'Trade Discount Account Number', ['PM Transaction WORK File'].[TRDISAMT] as 'Trade Discount Amount', ['PM Vendor Master Summary'].[TRDTKLIF] as 'Trade Discounts Taken LIFE', ['PM Vendor Master Summary'].[TRDTLYR] as 'Trade Discounts Taken LYR', ['PM Vendor Master Summary'].[TRDTYTD] as 'Trade Discounts Taken YTD', rtrim(['PM Transaction WORK File'].[TRXDSCRN]) as 'Transaction Description', rtrim(['PM Vendor Master File'].[UPSZONE]) as 'UPS Zone', ['PM Transaction WORK File'].[UN1099AM] as 'Unapplied 1099 Amount', ['PM Vendor Master Summary'].[UNPDFNCH] as 'Unpaid Finance Charges', ['Multicurrency Payables Transactions'].[UNGANLOS] as 'Unrealized Gain-Loss Amount', rtrim(['PM Vendor Master File'].[USERDEF1]) as 'User Defined 1', rtrim(['PM Vendor Master File'].[USERDEF2]) as 'User Defined 2', rtrim(['PM Transaction WORK File'].[VADDCDPR]) as 'Vendor Address Code - Primary', rtrim(['PM Vendor Master File'].[VADDCDPR]) as 'Vendor Address Code - Primary from Vendor Master', rtrim(['PM Vendor Master File'].[VADCDPAD]) as 'Vendor Address Code - Purchase Address', rtrim(['PM Transaction WORK File'].[VADCDTRO]) as 'Vendor Address Code - Remit To', rtrim(['PM Vendor Master File'].[VADCDTRO]) as 'Vendor Address Code - Remit To from Vendor Master', rtrim(['PM Vendor Master File'].[VADCDSFR]) as 'Vendor Address Code - Ship From', NULL  as 'Vendor Check Name', rtrim(['PM Vendor Master File'].[VNDCHKNM]) as 'Vendor Check Name from Vendor Master', rtrim(['PM Vendor Master File'].[VNDCLSID]) as 'Vendor Class ID', rtrim(['PM Vendor Master File'].[VNDCNTCT]) as 'Vendor Contact', rtrim(['PM Vendor Master File'].[VENDNAME]) as 'Vendor Name', rtrim(['PM Vendor Master File'].[VENDSHNM]) as 'Vendor Short Name', 'Vendor Status' = dbo.DYN_FUNC_Vendor_Status(['PM Vendor Master File'].[VENDSTTS]), NULL  as 'Void GL Posting Date', NULL  as 'Voided', rtrim(['PM Transaction WORK File'].[VCHRNCOR]) as 'Voucher Number Corrected', ['PM Vendor Master Summary'].[Withholding_LIFE] as 'Withholding LIFE', ['PM Vendor Master Summary'].[WITHLYR] as 'Withholding LYR', ['PM Vendor Master Summary'].[WITHYTD] as 'Withholding YTD', ['PM Transaction WORK File'].[WROFAMNT] as 'Write Off Amount', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMWRTIDX]) as 'Write Offs Account Number', ['PM Vendor Master Summary'].[WROFSLIF] as 'Write Offs LIFE', ['PM Vendor Master Summary'].[WROFSLYR] as 'Write Offs LYR', ['PM Vendor Master Summary'].[WROFSYTD] as 'Write Offs YTD', 'Writeoff' = dbo.DYN_FUNC_Writeoff(['PM Vendor Master File'].[WRITEOFF]), rtrim(['PM Vendor Master File'].[ZIPCODE]) as 'Zip Code',  case   when datediff(dd,['PM Transaction WORK File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 1) or  ((select ENDGPDYS from PM40101 where INDEX1 = 1) = 999) or  ['PM Transaction WORK File'].[DOCTYPE] >= 4  then 'Aging Bucket1'   when datediff(dd,['PM Transaction WORK File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 2) or  ((select ENDGPDYS from PM40101 where INDEX1 = 2) = 999)   then 'Aging Bucket2'   when datediff(dd,['PM Transaction WORK File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 3) or  ((select ENDGPDYS from PM40101 where INDEX1 = 3) = 999)   then 'Aging Bucket3'   when datediff(dd,['PM Transaction WORK File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 4) or  ((select ENDGPDYS from PM40101 where INDEX1 = 4) = 999)   then 'Aging Bucket4'   when datediff(dd,['PM Transaction WORK File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 5) or  ((select ENDGPDYS from PM40101 where INDEX1 = 5) = 999)   then 'Aging Bucket5'   when datediff(dd,['PM Transaction WORK File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 6) or  ((select ENDGPDYS from PM40101 where INDEX1 = 6) = 999)   then 'Aging Bucket6'   else 'Aging Bucket7'  end as 'Aging Bucket', case   when datediff(dd,['PM Transaction WORK File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 1) or  ((select ENDGPDYS from PM40101 where INDEX1 = 1) = 999) or  ['PM Transaction WORK File'].[DOCTYPE] >= 4   then (select DSCRIPTN from PM40101 where INDEX1 = 1)   when datediff(dd,['PM Transaction WORK File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 2) or  ((select ENDGPDYS from PM40101 where INDEX1 = 2) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 2)   when datediff(dd,['PM Transaction WORK File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 3) or  ((select ENDGPDYS from PM40101 where INDEX1 = 3) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 3)   when datediff(dd,['PM Transaction WORK File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 4) or  ((select ENDGPDYS from PM40101 where INDEX1 = 4) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 4)   when datediff(dd,['PM Transaction WORK File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 5) or  ((select ENDGPDYS from PM40101 where INDEX1 = 5) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 5)   when datediff(dd,['PM Transaction WORK File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 6) or  ((select ENDGPDYS from PM40101 where INDEX1 = 6) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 6)   else (select DSCRIPTN from PM40101 where INDEX1 = 7) end as 'Aging Bucket Description', ['PM Transaction WORK File'].[DOCTYPE] as 'Document Type Int', '1099 Type' = dbo.DYN_FUNC_1099_Type(['PM Transaction WORK File'].[TEN99TYPE]), '1099 Box' = dbo.DYN_FUNC_1099_Box_Type(['PM Transaction WORK File'].[TEN99TYPE],['PM Transaction WORK File'].[TEN99BOXNUMBER]), 'Workflow Approval Status' = dbo.DYN_FUNC_Workflow_Approval_Status(['Posting Definitions Master'].[Workflow_Approval_Status]), 'Workflow Priority' = dbo.DYN_FUNC_Workflow_Priority(['Posting Definitions Master'].[Workflow_Priority]),  'Accounts Payable Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMAPINDX] ), 'Accrued Purchases Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[ACPURIDX] ), 'Cash Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMCSHIDX] ),  'Checkbook ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCheckbookID(1,['PM Transaction WORK File'].[CHEKBKID] ), 'Discount Available Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMDAVIDX] ), 'Discount Taken Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMDTKIDX] ), 'Document Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppPayablesTransactionNumber(1,['PM Transaction WORK File'].[DOCTYPE],['PM Transaction WORK File'].[VCHRNMBR],1,1,-1,['Posting Definitions Master'].[TRXSORCE],'' ),  'Finance Charge Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMFINIDX] ), 'Freight Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMFRTIDX] ), 'Misc Charges Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMMSCHIX] ), 'Purchase Order Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppPurchaseOrder(1,1,1,['PM Transaction WORK File'].[DOCTYPE],0, ['PM Transaction WORK File'].[VENDORID],['PM Transaction WORK File'].[PORDNMBR], '','',['PM Transaction WORK File'].[DOCNUMBR],'',['PM Transaction WORK File'].[VCHRNMBR] ),  'Purchase Price Variance Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PURPVIDX] ), 'Purchases Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMPRCHIX] ), 'Retainage Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMRTNGIX] ), 'Tax Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMTAXIDX] ),  'Trade Discount Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMTDSCIX] ), 'Vendor ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppVendorID(1,['PM Transaction WORK File'].[VENDORID] ), 'Write Offs Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMWRTIDX] )  from [PM10000] as ['PM Transaction WORK File'] with (NOLOCK) left outer join [MC020103] as ['Multicurrency Payables Transactions'] with (NOLOCK) on ['PM Transaction WORK File'].[DOCTYPE] = ['Multicurrency Payables Transactions'].[DOCTYPE]  and ['PM Transaction WORK File'].[VCHRNMBR] = ['Multicurrency Payables Transactions'].[VCHRNMBR] left outer join [PM00200] as ['PM Vendor Master File'] with (NOLOCK) on ['PM Transaction WORK File'].[VENDORID] = ['PM Vendor Master File'].[VENDORID] left outer join [PM00201] as ['PM Vendor Master Summary'] with (NOLOCK) on ['PM Transaction WORK File'].[VENDORID] = ['PM Vendor Master Summary'].[VENDORID] left outer join [SY00500] as ['Posting Definitions Master'] with (NOLOCK) on ['PM Transaction WORK File'].[BCHSOURC] = ['Posting Definitions Master'].[BCHSOURC]  and ['PM Transaction WORK File'].[BACHNUMB] = ['Posting Definitions Master'].[BACHNUMB]  union all select rtrim(['PM Transaction OPEN File'].[VCHRNMBR]) as 'Voucher Number', rtrim(['PM Transaction OPEN File'].[VENDORID]) as 'Vendor ID', 'Document Type' = dbo.DYN_FUNC_Document_Type_PM_Trx(['PM Transaction OPEN File'].[DOCTYPE]), ['PM Transaction OPEN File'].[DOCDATE] as 'Document Date', rtrim(['PM Transaction OPEN File'].[DOCNUMBR]) as 'Document Number', ['PM Transaction OPEN File'].[CURTRXAM] as 'Current Trx Amount',  ['PM Transaction OPEN File'].[TEN99AMNT] as '1099 Amount', ['PM Vendor Master Summary'].[TEN99ALIF] as '1099 Amount LIFE', ['PM Vendor Master Summary'].[TEN99ALYR] as '1099 Amount LYR', ['PM Vendor Master Summary'].[TEN99AYTD] as '1099 Amount YTD', '1099 Type from Vendor Master' = dbo.DYN_FUNC_1099_Type(['PM Vendor Master File'].[TEN99TYPE]), rtrim(['PM Vendor Master File'].[ACNMVNDR]) as 'Account Number With Vendor', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMAPINDX]) as 'Accounts Payable Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[ACPURIDX]) as 'Accrued Purchases Account Number', rtrim(['PM Vendor Master File'].[ADDRESS1]) as 'Address 1', rtrim(['PM Vendor Master File'].[ADDRESS2]) as 'Address 2', rtrim(['PM Vendor Master File'].[ADDRESS3]) as 'Address 3', ['PM Vendor Master Summary'].[AMBLDLIF] as 'Amount Billed LIFE', ['PM Vendor Master Summary'].[AMBLDLYR] as 'Amount Billed LYR', ['PM Vendor Master Summary'].[AMBLDTYD] as 'Amount Billed YTD', ['PM Vendor Master Summary'].[AMTPDLIF] as 'Amount Paid LIFE', ['PM Vendor Master Summary'].[AMTPDLYR] as 'Amount Paid LYR', ['PM Vendor Master Summary'].[AMTPDYTD] as 'Amount Paid YTD', NULL  as 'Applied Amount', NULL  as 'Applied Discount Taken Amount', 'Apply Withholding' = dbo.DYN_FUNC_Boolean_All(['PM Transaction OPEN File'].[APLYWITH]), ['PM Vendor Master Summary'].[AVDTPLIF] as 'Average Days To Pay - Life', ['PM Vendor Master Summary'].[AVGDTPYR] as 'Average Days To Pay - Year', ['PM Transaction OPEN File'].[BKTFRTAM] as 'Backout Freight Amount', ['PM Transaction OPEN File'].[BKTMSCAM] as 'Backout Misc Amount', ['PM Transaction OPEN File'].[BKTPURAM] as 'Backout Purchases Amount', ['PM Transaction OPEN File'].[BNKRCAMT] as 'Bank Receipts Amount', rtrim(['PM Transaction OPEN File'].[BACHNUMB]) as 'Batch Number', rtrim(['PM Transaction OPEN File'].[BCHSOURC]) as 'Batch Source', rtrim(['PM Transaction OPEN File'].[CARDNAME]) as 'Card Name', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMCSHIDX]) as 'Cash Account Number', NULL  as 'Cash Amount', NULL  as 'Cash Amount Checkbook ID', NULL  as 'Cash Amount Date', NULL  as 'Cash Amount Payment Number', NULL  as 'Cash Document Number', ['PM Vendor Master File'].[CRTCOMDT] as 'Certificate Commencing Date', ['PM Vendor Master File'].[CRTEXPDT] as 'Certificate Expiration Date', NULL  as 'Charge Amount', NULL  as 'Check Amount', NULL  as 'Check Amount Checkbook ID', NULL  as 'Check Amount Payment Number', NULL  as 'Check Date', NULL  as 'Check Number', rtrim(['PM Transaction OPEN File'].[CHEKBKID]) as 'Checkbook ID', rtrim(['PM Vendor Master File'].[CHEKBKID]) as 'Checkbook ID from Vendor Master', rtrim(['PM Vendor Master File'].[CITY]) as 'City', rtrim(['PM Vendor Master File'].[COMMENT1]) as 'Comment1', rtrim(['PM Vendor Master File'].[COMMENT2]) as 'Comment2', 'Control Type' = dbo.DYN_FUNC_Control_Type_PM_Trx(['PM Transaction OPEN File'].[CNTRLTYP]), 'Correction' = dbo.DYN_FUNC_Boolean_All(['PM Transaction OPEN File'].[CORRCTN]), NULL  as 'Correction to Nonexisting Transaction', rtrim(['PM Vendor Master File'].[COUNTRY]) as 'Country', ['PM Vendor Master File'].[CREATDDT] as 'Created Date from Vendor Master', NULL  as 'Credit Card Amount', NULL  as 'Credit Card Amount Payment Number', NULL  as 'Credit Card Date', NULL  as 'Credit Card Receipt Number', 'Credit Limit' = dbo.DYN_FUNC_Credit_Limit(['PM Vendor Master File'].[CREDTLMT]), ['PM Vendor Master File'].[CRLMTDLR] as 'Credit Limit Dollar', rtrim(['PM Transaction OPEN File'].[CURNCYID]) as 'Currency ID', rtrim(['PM Vendor Master File'].[CURNCYID]) as 'Currency ID from Vendor Master', NULL  as 'Currency Index', ['PM Vendor Master Summary'].[CURRBLNC] as 'Current Balance', ['PM Vendor Master Summary'].[CURUNPBN] as 'Current Unapplied Payment Balance', ['PM Transaction OPEN File'].[DINVPDOF] as 'Date Invoice Paid Off', ['PM Vendor Master Summary'].[DYCHTCLR] as 'Days Checks To Clear', rtrim(['PM Vendor Master File'].[DXVARNUM]) as 'Deduction Exemption/Variation Number', ['Multicurrency Payables Transactions'].[DENXRATE] as 'Denomination Exchange Rate', ['PM Transaction OPEN File'].[DISCAMNT] as 'Discount Amount', ['PM Transaction OPEN File'].[DISAMTAV] as 'Discount Amount Available', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMDAVIDX]) as 'Discount Available Account Number', ['PM Vendor Master Summary'].[DISAVLIF] as 'Discount Available LIFE', ['PM Vendor Master Summary'].[DISAVLYR] as 'Discount Available LYR',  ['PM Transaction OPEN File'].[DISAVTKN] as 'Discount Available Taken', ['PM Vendor Master Summary'].[DISAVYTD] as 'Discount Available YTD', ['PM Transaction OPEN File'].[DISCDATE] as 'Discount Date', ['PM Transaction OPEN File'].[DSCDLRAM] as 'Discount Dollar Amount', ['PM Vendor Master File'].[DISGRPER] as 'Discount Grace Period', ['PM Vendor Master Summary'].[DISLSTLF] as 'Discount Lost LIFE', ['PM Vendor Master Summary'].[DISLSLYR] as 'Discount Lost LYR', ['PM Vendor Master Summary'].[DISLSYTD] as 'Discount Lost YTD', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMDTKIDX]) as 'Discount Taken Account Number', ['PM Transaction OPEN File'].[DISTKNAM] as 'Discount Taken Amount', ['PM Vendor Master Summary'].[DISTKNLF] as 'Discount Taken LIFE', ['PM Vendor Master Summary'].[DISTKLYR] as 'Discount Taken LYR', ['PM Vendor Master Summary'].[DISTKYTD] as 'Discount Taken YTD', 'DocPrinted' = dbo.DYN_FUNC_Boolean_All(['PM Transaction OPEN File'].[DocPrinted]), ['PM Transaction OPEN File'].[DOCAMNT] as 'Document Amount', rtrim(['PM Vendor Master File'].[DOCFMTID]) as 'Document Format ID', 'Document Status' = dbo.DYN_FUNC_Document_Status_PM_Trx(2), ['PM Transaction OPEN File'].[DUEDATE] as 'Due Date', ['PM Vendor Master File'].[DUEGRPER] as 'Due Date Grace Period', 'EC Transaction' = dbo.DYN_FUNC_Boolean_All(['PM Transaction OPEN File'].[ECTRX]), 'Electronic' = dbo.DYN_FUNC_Boolean_All(['PM Transaction OPEN File'].[Electronic]), ['Multicurrency Payables Transactions'].[EXCHDATE] as 'Exchange Date', ['Multicurrency Payables Transactions'].[XCHGRATE] as 'Exchange Rate', rtrim(['Multicurrency Payables Transactions'].[EXGTBLID]) as 'Exchange Table ID', 'Expiration Date Obligation' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[XPDTOBLG]), rtrim(['PM Vendor Master File'].[FAXNUMBR]) as 'Fax Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMFINIDX]) as 'Finance Charge Account Number', ['PM Vendor Master Summary'].[FINCHLIF] as 'Finance Charge LIFE', ['PM Vendor Master Summary'].[FINCHLYR] as 'Finance Charge LYR', ['PM Vendor Master Summary'].[FINCHYTD] as 'Finance Charge YTD', ['PM Vendor Master Summary'].[FSTPURDT] as 'First Purchase Date', 'Free On Board' = dbo.DYN_FUNC_Free_On_Board(['PM Vendor Master File'].[FREEONBOARD]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMFRTIDX]) as 'Freight Account Number', ['PM Transaction OPEN File'].[FRTAMNT] as 'Freight Amount', rtrim(['PM Transaction OPEN File'].[FRTSCHID]) as 'Freight Schedule ID', ['PM Transaction OPEN File'].[GSTDSAMT] as 'GST Discount Amount', rtrim(['PM Vendor Master File'].[GOVCRPID]) as 'Governmental Corporate ID', rtrim(['PM Vendor Master File'].[GOVINDID]) as 'Governmental Individual ID', ['PM Vendor Master Summary'].[HIESTBAL] as 'Highest Balance', 'Hold' = dbo.DYN_FUNC_Boolean_All(['PM Transaction OPEN File'].[HOLD]), 'Hold from Vendor Master' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[HOLD]), 'IC TRX' = dbo.DYN_FUNC_Boolean_All(['PM Transaction OPEN File'].[ICTRX]), 'Keep Calendar History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPCALHST]), 'Keep GL Dist History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KGLDSTHS]), 'Keep Period History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPERHIST]), 'Keep Trx History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPTRXHST]), ['PM Vendor Master Summary'].[LSTCHAMT] as 'Last Check Amount', ['PM Vendor Master Summary'].[LSTCHKDT] as 'Last Check Date', rtrim(['PM Vendor Master Summary'].[LSTCHNUM]) as 'Last Check Number', ['PM Vendor Master Summary'].[LSTINVAM] as 'Last Invoice Amount', rtrim(['PM Vendor Master Summary'].[LSTINNUM]) as 'Last Invoice Number', ['PM Vendor Master Summary'].[LSTPURDT] as 'Last Purchase Date', ['Multicurrency Payables Transactions'].[MCTRXSTT] as 'MC Transaction State', 'Maximum Invoice Amount For Vendors' = dbo.DYN_FUNC_Maximum_Invoice_Amount_For_Vendors(['PM Vendor Master File'].[MXIAFVND]), ['PM Vendor Master File'].[MAXINDLR] as 'Maximum Invoice Dollar', ['PM Vendor Master File'].[MXWOFAMT] as 'Maximum Write Off Amount', ['PM Vendor Master File'].[MINORDER] as 'Minimum Order', ['PM Vendor Master File'].[MINPYDLR] as 'Minimum Payment Dollar', ['PM Vendor Master File'].[MINPYPCT]/100.00 as 'Minimum Payment Percent', 'Minimum Payment Type' = dbo.DYN_FUNC_Minimum_Payment_Type(['PM Vendor Master File'].[MINPYTYP]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMMSCHIX]) as 'Misc Charges Account Number', ['PM Transaction OPEN File'].[MSCCHAMT] as 'Misc Charges Amount', rtrim(['PM Transaction OPEN File'].[MSCSCHID]) as 'Misc Schedule ID', ['PM Transaction OPEN File'].[MODIFDT] as 'Modified Date', ['PM Vendor Master File'].[MODIFDT] as 'Modified Date from Vendor Master', rtrim(['PM Transaction OPEN File'].[MDFUSRID]) as 'Modified User ID', ['PM Transaction OPEN File'].[NOTEINDX] as 'Note Index', ['PM Vendor Master File'].[NOTEINDX] as 'Note Index from Vendor Master', ['PM Vendor Master Summary'].[NFNCHLIF] as 'Number of Finance Charges LIFE', ['PM Vendor Master Summary'].[NFNCHLYR] as 'Number of Finance Charges LYR', ['PM Vendor Master Summary'].[NFNCHYTD] as 'Number of Finance Charges YTD', ['PM Vendor Master Summary'].[NOINVLIF] as 'Number of Invoices LIFE', ['PM Vendor Master Summary'].[NOINVLYR] as 'Number of Invoices LYR',  ['PM Vendor Master Summary'].[NOINVYTD] as 'Number of Invoices YTD', ['PM Vendor Master Summary'].[NOPILIFE] as 'Number of Paid Invoices LIFE', ['PM Vendor Master Summary'].[NOPINYTD] as 'Number of Paid Invoices YTD', ['PM Vendor Master Summary'].[ONORDAMT] as 'On Order Amount', ['Multicurrency Payables Transactions'].[OR1099AM] as 'Originating 1099 Amount', ['Multicurrency Payables Transactions'].[ORAPPAMT] as 'Originating Applied Amount', ['Multicurrency Payables Transactions'].[ORGAPDISCTKN] as 'Originating Applied Discount Taken Amount', ['Multicurrency Payables Transactions'].[ORBKTFRT] as 'Originating Backout Freight Amount', ['Multicurrency Payables Transactions'].[ORBKTMSC] as 'Originating Backout Misc Amount', ['Multicurrency Payables Transactions'].[OBKPURAMT] as 'Originating Backout Purchases Amount', ['Multicurrency Payables Transactions'].[ORCASAMT] as 'Originating Cash Amount', ['Multicurrency Payables Transactions'].[OCHGAMT] as 'Originating Charge Amount', ['Multicurrency Payables Transactions'].[ORCHKAMT] as 'Originating Check Amount', ['Multicurrency Payables Transactions'].[ORCHKTTL] as 'Originating Check Total', ['Multicurrency Payables Transactions'].[ORCCDAMT] as 'Originating Credit Card Amount', ['Multicurrency Payables Transactions'].[ORCTRXAM] as 'Originating Current Trx Amount', ['Multicurrency Payables Transactions'].[ODISAMTAV] as 'Originating Discount Amount Available', ['Multicurrency Payables Transactions'].[ORDATKN] as 'Originating Discount Available Taken', ['Multicurrency Payables Transactions'].[ORDDLRAT] as 'Originating Discount Dollar Amount', ['Multicurrency Payables Transactions'].[ORDISTKN] as 'Originating Discount Taken Amount', ['Multicurrency Payables Transactions'].[ORDOCAMT] as 'Originating Document Amount', ['Multicurrency Payables Transactions'].[ORFRTAMT] as 'Originating Freight Amount', ['Multicurrency Payables Transactions'].[OMISCAMT] as 'Originating Misc Charges Amount', ['Multicurrency Payables Transactions'].[OPURAMT] as 'Originating Purchases Amount', ['Multicurrency Payables Transactions'].[ORTAXAMT] as 'Originating Tax Amount', ['Multicurrency Payables Transactions'].[OTOTPAY] as 'Originating Total Payments', ['Multicurrency Payables Transactions'].[ORTDISAM] as 'Originating Trade Discount Amount', ['Multicurrency Payables Transactions'].[ORWROFAM] as 'Originating Write Off Amount', ['PM Transaction OPEN File'].[PPSAMDED] as 'PPS Amount Deducted', ['PM Transaction OPEN File'].[PPSTAXRT]/100.00 as 'PPS Tax Rate', ['PM Vendor Master File'].[PPSTAXRT]/100.00 as 'PPS Tax Rate from Vendor Master', rtrim(['PM Vendor Master File'].[PARVENID]) as 'Parent Vendor ID', 'Payment Entry Type' = dbo.DYN_FUNC_Payment_Entry_Type(['PM Transaction OPEN File'].[PYENTTYP]), rtrim(['PM Vendor Master File'].[PYMNTPRI]) as 'Payment Priority', rtrim(['PM Transaction OPEN File'].[PYMTRMID]) as 'Payment Terms ID', rtrim(['PM Vendor Master File'].[PYMTRMID]) as 'Payment Terms ID from Vendor Master', ['PM Transaction OPEN File'].[PRCTDISC] as 'Percent Discount', ['PM Transaction OPEN File'].[PGRAMSBJ]/100.00 as 'Percent Of Gross Amount Subject', rtrim(['PM Vendor Master File'].[PHONE3]) as 'Phone 3', rtrim(['PM Vendor Master File'].[PHNUMBR1]) as 'Phone Number 1', rtrim(['PM Vendor Master File'].[PHNUMBR2]) as 'Phone Number 2', 'Post Results To' = dbo.DYN_FUNC_Post_Results_To_Vendor(['PM Vendor Master File'].[Post_Results_To]), 'Post To Cash Account From' = dbo.DYN_FUNC_Post_To_Cash_Account_From(['PM Vendor Master File'].[PTCSHACF]), NULL  as 'Posted', ['PM Transaction OPEN File'].[POSTEDDT] as 'Posted Date', rtrim(['PM Transaction OPEN File'].[PTDUSRID]) as 'Posted User ID', ['PM Transaction OPEN File'].[PSTGDATE] as 'Posting Date', 'Prescribed Payee' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[PRSPAYEE]), NULL  as 'Printed', ['PM Transaction OPEN File'].[PRCHDATE] as 'Purchase Date', rtrim(['PM Transaction OPEN File'].[PORDNMBR]) as 'Purchase Order Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PURPVIDX]) as 'Purchase Price Variance Account Number', rtrim(['PM Transaction OPEN File'].[PCHSCHID]) as 'Purchase Schedule ID', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMPRCHIX]) as 'Purchases Account Number', ['PM Transaction OPEN File'].[PRCHAMNT] as 'Purchases Amount', 'Rate Calculation Method' = dbo.DYN_FUNC_Rate_Calculation_Method(['Multicurrency Payables Transactions'].[RTCLCMTD]), rtrim(['Multicurrency Payables Transactions'].[RATETPID]) as 'Rate Type ID', rtrim(['PM Vendor Master File'].[RATETPID]) as 'Rate Type ID from Vendor Master', 'Reporting Obligation Undertaken' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[RTOBUTKN]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMRTNGIX]) as 'Retainage Account Number', ['PM Transaction OPEN File'].[RETNAGAM] as 'Retainage Amount', ['PM Vendor Master Summary'].[RTNGOWED] as 'Retainage Owed', ['PM Vendor Master Summary'].[RTRNSLIF] as 'Returns LIFE', ['PM Vendor Master Summary'].[RTRNSLYR] as 'Returns LYR', ['PM Vendor Master Summary'].[RTRNSYTD] as 'Returns YTD', 'Revalue Vendor' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[Revalue_Vendor]), rtrim(['PM Transaction OPEN File'].[SHIPMTHD]) as 'Shipping Method', rtrim(['PM Vendor Master File'].[SHIPMTHD]) as 'Shipping Method from Vendor Master', 'Simplified' = dbo.DYN_FUNC_Boolean_All(['PM Transaction OPEN File'].[SIMPLIFD]), NULL  as 'Source Document', rtrim(['PM Vendor Master File'].[STATE]) as 'State',  'Subject To PPS Deductions' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[SBPPSDED]), rtrim(['PM Transaction OPEN File'].[TRXSORCE]) as 'TRX Source', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMTAXIDX]) as 'Tax Account Number', ['PM Transaction OPEN File'].[TAXAMNT] as 'Tax Amount', ['PM Transaction OPEN File'].[Tax_Date] as 'Tax Date', NULL  as 'Tax Engine Called', rtrim(['PM Vendor Master File'].[TXIDNMBR]) as 'Tax ID Number', 'Tax Invoice Received from Vendor Master' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[TaxInvRecvd]), 'Tax Invoice Required' = dbo.DYN_FUNC_Boolean_All(['PM Transaction OPEN File'].[TaxInvReqd]), rtrim(['PM Vendor Master File'].[TXRGNNUM]) as 'Tax Registration Number', rtrim(['PM Transaction OPEN File'].[TAXSCHID]) as 'Tax Schedule ID', rtrim(['PM Vendor Master File'].[TAXSCHID]) as 'Tax Schedule ID from Vendor Master', ['Multicurrency Payables Transactions'].[TIME1] as 'Time', ['PM Transaction OPEN File'].[TTLPYMTS] as 'Total Payments', ['PM Vendor Master File'].[TRDDISCT]/100.00 as 'Trade Discount', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMTDSCIX]) as 'Trade Discount Account Number', ['PM Transaction OPEN File'].[TRDISAMT] as 'Trade Discount Amount', ['PM Vendor Master Summary'].[TRDTKLIF] as 'Trade Discounts Taken LIFE', ['PM Vendor Master Summary'].[TRDTLYR] as 'Trade Discounts Taken LYR', ['PM Vendor Master Summary'].[TRDTYTD] as 'Trade Discounts Taken YTD', rtrim(['PM Transaction OPEN File'].[TRXDSCRN]) as 'Transaction Description', rtrim(['PM Vendor Master File'].[UPSZONE]) as 'UPS Zone', ['PM Transaction OPEN File'].[UN1099AM] as 'Unapplied 1099 Amount', ['PM Vendor Master Summary'].[UNPDFNCH] as 'Unpaid Finance Charges', ['Multicurrency Payables Transactions'].[UNGANLOS] as 'Unrealized Gain-Loss Amount', rtrim(['PM Vendor Master File'].[USERDEF1]) as 'User Defined 1', rtrim(['PM Vendor Master File'].[USERDEF2]) as 'User Defined 2', NULL  as 'Vendor Address Code - Primary', rtrim(['PM Vendor Master File'].[VADDCDPR]) as 'Vendor Address Code - Primary from Vendor Master', rtrim(['PM Vendor Master File'].[VADCDPAD]) as 'Vendor Address Code - Purchase Address', rtrim(['PM Transaction OPEN File'].[VADCDTRO]) as 'Vendor Address Code - Remit To', rtrim(['PM Vendor Master File'].[VADCDTRO]) as 'Vendor Address Code - Remit To from Vendor Master', rtrim(['PM Vendor Master File'].[VADCDSFR]) as 'Vendor Address Code - Ship From', rtrim(['PM Transaction OPEN File'].[VNDCHKNM]) as 'Vendor Check Name', rtrim(['PM Vendor Master File'].[VNDCHKNM]) as 'Vendor Check Name from Vendor Master', rtrim(['PM Vendor Master File'].[VNDCLSID]) as 'Vendor Class ID', rtrim(['PM Vendor Master File'].[VNDCNTCT]) as 'Vendor Contact', rtrim(['PM Vendor Master File'].[VENDNAME]) as 'Vendor Name', rtrim(['PM Vendor Master File'].[VENDSHNM]) as 'Vendor Short Name', 'Vendor Status' = dbo.DYN_FUNC_Vendor_Status(['PM Vendor Master File'].[VENDSTTS]), NULL  as 'Void GL Posting Date', 'Voided' = dbo.DYN_FUNC_Boolean_All(['PM Transaction OPEN File'].[VOIDED]), NULL  as 'Voucher Number Corrected', ['PM Vendor Master Summary'].[Withholding_LIFE] as 'Withholding LIFE', ['PM Vendor Master Summary'].[WITHLYR] as 'Withholding LYR', ['PM Vendor Master Summary'].[WITHYTD] as 'Withholding YTD', ['PM Transaction OPEN File'].[WROFAMNT] as 'Write Off Amount', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMWRTIDX]) as 'Write Offs Account Number', ['PM Vendor Master Summary'].[WROFSLIF] as 'Write Offs LIFE', ['PM Vendor Master Summary'].[WROFSLYR] as 'Write Offs LYR', ['PM Vendor Master Summary'].[WROFSYTD] as 'Write Offs YTD', 'Writeoff' = dbo.DYN_FUNC_Writeoff(['PM Vendor Master File'].[WRITEOFF]), rtrim(['PM Vendor Master File'].[ZIPCODE]) as 'Zip Code',  case   when datediff(dd,['PM Transaction OPEN File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 1) or  ((select ENDGPDYS from PM40101 where INDEX1 = 1) = 999) or  ['PM Transaction OPEN File'].[DOCTYPE] >= 4  then 'Aging Bucket1'   when datediff(dd,['PM Transaction OPEN File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 2) or  ((select ENDGPDYS from PM40101 where INDEX1 = 2) = 999)   then 'Aging Bucket2'   when datediff(dd,['PM Transaction OPEN File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 3) or  ((select ENDGPDYS from PM40101 where INDEX1 = 3) = 999)   then 'Aging Bucket3'   when datediff(dd,['PM Transaction OPEN File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 4) or  ((select ENDGPDYS from PM40101 where INDEX1 = 4) = 999)   then 'Aging Bucket4'   when datediff(dd,['PM Transaction OPEN File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 5) or  ((select ENDGPDYS from PM40101 where INDEX1 = 5) = 999)   then 'Aging Bucket5'   when datediff(dd,['PM Transaction OPEN File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 6) or  ((select ENDGPDYS from PM40101 where INDEX1 = 6) = 999)   then 'Aging Bucket6'   else 'Aging Bucket7'  end as 'Aging Bucket', case   when datediff(dd,['PM Transaction OPEN File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 1) or  ((select ENDGPDYS from PM40101 where INDEX1 = 1) = 999) or  ['PM Transaction OPEN File'].[DOCTYPE] >= 4   then (select DSCRIPTN from PM40101 where INDEX1 = 1)   when datediff(dd,['PM Transaction OPEN File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 2) or  ((select ENDGPDYS from PM40101 where INDEX1 = 2) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 2)   when datediff(dd,['PM Transaction OPEN File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 3) or  ((select ENDGPDYS from PM40101 where INDEX1 = 3) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 3)   when datediff(dd,['PM Transaction OPEN File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 4) or  ((select ENDGPDYS from PM40101 where INDEX1 = 4) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 4)   when datediff(dd,['PM Transaction OPEN File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 5) or  ((select ENDGPDYS from PM40101 where INDEX1 = 5) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 5)   when datediff(dd,['PM Transaction OPEN File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 6) or  ((select ENDGPDYS from PM40101 where INDEX1 = 6) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 6)   else (select DSCRIPTN from PM40101 where INDEX1 = 7) end as 'Aging Bucket Description', ['PM Transaction OPEN File'].[DOCTYPE] as 'Document Type Int', '1099 Type' = dbo.DYN_FUNC_1099_Type(['PM Transaction OPEN File'].[TEN99TYPE]), '1099 Box' = dbo.DYN_FUNC_1099_Box_Type(['PM Transaction OPEN File'].[TEN99TYPE],['PM Transaction OPEN File'].[TEN99BOXNUMBER]), 'Workflow Approval Status' = dbo.DYN_FUNC_Workflow_Approval_Status(['Posting Definitions Master'].[Workflow_Approval_Status]), 'Workflow Priority' = dbo.DYN_FUNC_Workflow_Priority(['Posting Definitions Master'].[Workflow_Priority]),  'Accounts Payable Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMAPINDX] ), 'Accrued Purchases Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[ACPURIDX] ), 'Cash Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMCSHIDX] ),  'Checkbook ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCheckbookID(1,['PM Transaction OPEN File'].[CHEKBKID] ), 'Discount Available Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMDAVIDX] ), 'Discount Taken Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMDTKIDX] ), 'Document Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppPayablesTransactionNumber(1,['PM Transaction OPEN File'].[DOCTYPE],['PM Transaction OPEN File'].[VCHRNMBR],2,1,-1,['PM Transaction OPEN File'].[TRXSORCE],'' ),  'Finance Charge Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMFINIDX] ), 'Freight Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMFRTIDX] ), 'Misc Charges Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMMSCHIX] ), 'Purchase Order Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppPurchaseOrder(1,1,2,['PM Transaction OPEN File'].[DOCTYPE],0, ['PM Transaction OPEN File'].[VENDORID],['PM Transaction OPEN File'].[PORDNMBR], '','',['PM Transaction OPEN File'].[DOCNUMBR],'',['PM Transaction OPEN File'].[VCHRNMBR] ),  'Purchase Price Variance Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PURPVIDX] ), 'Purchases Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMPRCHIX] ), 'Retainage Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMRTNGIX] ), 'Tax Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMTAXIDX] ),  'Trade Discount Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMTDSCIX] ), 'Vendor ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppVendorID(1,['PM Transaction OPEN File'].[VENDORID] ), 'Write Offs Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMWRTIDX] )  from [PM20000] as ['PM Transaction OPEN File'] with (NOLOCK) left outer join [MC020103] as ['Multicurrency Payables Transactions'] with (NOLOCK) on ['PM Transaction OPEN File'].[DOCTYPE] = ['Multicurrency Payables Transactions'].[DOCTYPE]  and ['PM Transaction OPEN File'].[VCHRNMBR] = ['Multicurrency Payables Transactions'].[VCHRNMBR] left outer join [PM00200] as ['PM Vendor Master File'] with (NOLOCK) on ['PM Transaction OPEN File'].[VENDORID] = ['PM Vendor Master File'].[VENDORID] left outer join [PM00201] as ['PM Vendor Master Summary'] with (NOLOCK) on ['PM Transaction OPEN File'].[VENDORID] = ['PM Vendor Master Summary'].[VENDORID] left outer join [SY00500] as ['Posting Definitions Master'] with (NOLOCK) on ['PM Transaction OPEN File'].[BCHSOURC] = ['Posting Definitions Master'].[BCHSOURC]  and ['PM Transaction OPEN File'].[BACHNUMB] = ['Posting Definitions Master'].[BACHNUMB]  union all select rtrim(['PM Paid Transaction History File'].[VCHRNMBR]) as 'Voucher Number', rtrim(['PM Paid Transaction History File'].[VENDORID]) as 'Vendor ID', 'Document Type' = dbo.DYN_FUNC_Document_Type_PM_Trx(['PM Paid Transaction History File'].[DOCTYPE]), ['PM Paid Transaction History File'].[DOCDATE] as 'Document Date', rtrim(['PM Paid Transaction History File'].[DOCNUMBR]) as 'Document Number', ['PM Paid Transaction History File'].[CURTRXAM] as 'Current Trx Amount',  ['PM Paid Transaction History File'].[TEN99AMNT] as '1099 Amount', ['PM Vendor Master Summary'].[TEN99ALIF] as '1099 Amount LIFE', ['PM Vendor Master Summary'].[TEN99ALYR] as '1099 Amount LYR', ['PM Vendor Master Summary'].[TEN99AYTD] as '1099 Amount YTD', '1099 Type from Vendor Master' = dbo.DYN_FUNC_1099_Type(['PM Vendor Master File'].[TEN99TYPE]), rtrim(['PM Vendor Master File'].[ACNMVNDR]) as 'Account Number With Vendor', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMAPINDX]) as 'Accounts Payable Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[ACPURIDX]) as 'Accrued Purchases Account Number', rtrim(['PM Vendor Master File'].[ADDRESS1]) as 'Address 1', rtrim(['PM Vendor Master File'].[ADDRESS2]) as 'Address 2', rtrim(['PM Vendor Master File'].[ADDRESS3]) as 'Address 3', ['PM Vendor Master Summary'].[AMBLDLIF] as 'Amount Billed LIFE', ['PM Vendor Master Summary'].[AMBLDLYR] as 'Amount Billed LYR', ['PM Vendor Master Summary'].[AMBLDTYD] as 'Amount Billed YTD', ['PM Vendor Master Summary'].[AMTPDLIF] as 'Amount Paid LIFE', ['PM Vendor Master Summary'].[AMTPDLYR] as 'Amount Paid LYR', ['PM Vendor Master Summary'].[AMTPDYTD] as 'Amount Paid YTD', NULL  as 'Applied Amount', NULL  as 'Applied Discount Taken Amount', 'Apply Withholding' = dbo.DYN_FUNC_Boolean_All(['PM Paid Transaction History File'].[APLYWITH]), ['PM Vendor Master Summary'].[AVDTPLIF] as 'Average Days To Pay - Life', ['PM Vendor Master Summary'].[AVGDTPYR] as 'Average Days To Pay - Year', ['PM Paid Transaction History File'].[BKTFRTAM] as 'Backout Freight Amount', ['PM Paid Transaction History File'].[BKTMSCAM] as 'Backout Misc Amount', ['PM Paid Transaction History File'].[BKTPURAM] as 'Backout Purchases Amount', NULL  as 'Bank Receipts Amount', rtrim(['PM Paid Transaction History File'].[BACHNUMB]) as 'Batch Number', rtrim(['PM Paid Transaction History File'].[BCHSOURC]) as 'Batch Source', rtrim(['PM Paid Transaction History File'].[CARDNAME]) as 'Card Name', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMCSHIDX]) as 'Cash Account Number', NULL  as 'Cash Amount', NULL  as 'Cash Amount Checkbook ID', NULL  as 'Cash Amount Date', NULL  as 'Cash Amount Payment Number', NULL  as 'Cash Document Number', ['PM Vendor Master File'].[CRTCOMDT] as 'Certificate Commencing Date', ['PM Vendor Master File'].[CRTEXPDT] as 'Certificate Expiration Date', NULL  as 'Charge Amount', NULL  as 'Check Amount', NULL  as 'Check Amount Checkbook ID', NULL  as 'Check Amount Payment Number', NULL  as 'Check Date', NULL  as 'Check Number', rtrim(['PM Paid Transaction History File'].[CHEKBKID]) as 'Checkbook ID', rtrim(['PM Vendor Master File'].[CHEKBKID]) as 'Checkbook ID from Vendor Master', rtrim(['PM Vendor Master File'].[CITY]) as 'City', rtrim(['PM Vendor Master File'].[COMMENT1]) as 'Comment1', rtrim(['PM Vendor Master File'].[COMMENT2]) as 'Comment2', 'Control Type' = dbo.DYN_FUNC_Control_Type_PM_Trx(['PM Paid Transaction History File'].[CNTRLTYP]), 'Correction' = dbo.DYN_FUNC_Boolean_All(['PM Paid Transaction History File'].[CORRCTN]), NULL  as 'Correction to Nonexisting Transaction', rtrim(['PM Vendor Master File'].[COUNTRY]) as 'Country', ['PM Vendor Master File'].[CREATDDT] as 'Created Date from Vendor Master', NULL  as 'Credit Card Amount', NULL  as 'Credit Card Amount Payment Number', NULL  as 'Credit Card Date', NULL  as 'Credit Card Receipt Number', 'Credit Limit' = dbo.DYN_FUNC_Credit_Limit(['PM Vendor Master File'].[CREDTLMT]), ['PM Vendor Master File'].[CRLMTDLR] as 'Credit Limit Dollar', rtrim(['PM Paid Transaction History File'].[CURNCYID]) as 'Currency ID', rtrim(['PM Vendor Master File'].[CURNCYID]) as 'Currency ID from Vendor Master', NULL  as 'Currency Index', ['PM Vendor Master Summary'].[CURRBLNC] as 'Current Balance', ['PM Vendor Master Summary'].[CURUNPBN] as 'Current Unapplied Payment Balance', ['PM Paid Transaction History File'].[DINVPDOF] as 'Date Invoice Paid Off', ['PM Vendor Master Summary'].[DYCHTCLR] as 'Days Checks To Clear', rtrim(['PM Vendor Master File'].[DXVARNUM]) as 'Deduction Exemption/Variation Number', ['Multicurrency Payables Transactions'].[DENXRATE] as 'Denomination Exchange Rate', ['PM Paid Transaction History File'].[DISCAMNT] as 'Discount Amount', ['PM Paid Transaction History File'].[DISAMTAV] as 'Discount Amount Available', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMDAVIDX]) as 'Discount Available Account Number',  ['PM Vendor Master Summary'].[DISAVLIF] as 'Discount Available LIFE', ['PM Vendor Master Summary'].[DISAVLYR] as 'Discount Available LYR', ['PM Paid Transaction History File'].[DISAVTKN] as 'Discount Available Taken', ['PM Vendor Master Summary'].[DISAVYTD] as 'Discount Available YTD', ['PM Paid Transaction History File'].[DISCDATE] as 'Discount Date', ['PM Paid Transaction History File'].[DSCDLRAM] as 'Discount Dollar Amount', ['PM Vendor Master File'].[DISGRPER] as 'Discount Grace Period', ['PM Vendor Master Summary'].[DISLSTLF] as 'Discount Lost LIFE', ['PM Vendor Master Summary'].[DISLSLYR] as 'Discount Lost LYR', ['PM Vendor Master Summary'].[DISLSYTD] as 'Discount Lost YTD', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMDTKIDX]) as 'Discount Taken Account Number', ['PM Paid Transaction History File'].[DISTKNAM] as 'Discount Taken Amount', ['PM Vendor Master Summary'].[DISTKNLF] as 'Discount Taken LIFE', ['PM Vendor Master Summary'].[DISTKLYR] as 'Discount Taken LYR', ['PM Vendor Master Summary'].[DISTKYTD] as 'Discount Taken YTD', 'DocPrinted' = dbo.DYN_FUNC_Boolean_All(['PM Paid Transaction History File'].[DocPrinted]), ['PM Paid Transaction History File'].[DOCAMNT] as 'Document Amount', rtrim(['PM Vendor Master File'].[DOCFMTID]) as 'Document Format ID', 'Document Status' = dbo.DYN_FUNC_Document_Status_PM_Trx(3), ['PM Paid Transaction History File'].[DUEDATE] as 'Due Date', ['PM Vendor Master File'].[DUEGRPER] as 'Due Date Grace Period', 'EC Transaction' = dbo.DYN_FUNC_Boolean_All(['PM Paid Transaction History File'].[ECTRX]), 'Electronic' = dbo.DYN_FUNC_Boolean_All(['PM Paid Transaction History File'].[Electronic]), ['Multicurrency Payables Transactions'].[EXCHDATE] as 'Exchange Date', ['Multicurrency Payables Transactions'].[XCHGRATE] as 'Exchange Rate', rtrim(['Multicurrency Payables Transactions'].[EXGTBLID]) as 'Exchange Table ID', 'Expiration Date Obligation' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[XPDTOBLG]), rtrim(['PM Vendor Master File'].[FAXNUMBR]) as 'Fax Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMFINIDX]) as 'Finance Charge Account Number', ['PM Vendor Master Summary'].[FINCHLIF] as 'Finance Charge LIFE', ['PM Vendor Master Summary'].[FINCHLYR] as 'Finance Charge LYR', ['PM Vendor Master Summary'].[FINCHYTD] as 'Finance Charge YTD', ['PM Vendor Master Summary'].[FSTPURDT] as 'First Purchase Date', 'Free On Board' = dbo.DYN_FUNC_Free_On_Board(['PM Vendor Master File'].[FREEONBOARD]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMFRTIDX]) as 'Freight Account Number', ['PM Paid Transaction History File'].[FRTAMNT] as 'Freight Amount', rtrim(['PM Paid Transaction History File'].[FRTSCHID]) as 'Freight Schedule ID', ['PM Paid Transaction History File'].[GSTDSAMT] as 'GST Discount Amount', rtrim(['PM Vendor Master File'].[GOVCRPID]) as 'Governmental Corporate ID', rtrim(['PM Vendor Master File'].[GOVINDID]) as 'Governmental Individual ID', ['PM Vendor Master Summary'].[HIESTBAL] as 'Highest Balance', 'Hold' = dbo.DYN_FUNC_Boolean_All(['PM Paid Transaction History File'].[HOLD]), 'Hold from Vendor Master' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[HOLD]), NULL  as 'IC TRX', 'Keep Calendar History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPCALHST]), 'Keep GL Dist History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KGLDSTHS]), 'Keep Period History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPERHIST]), 'Keep Trx History' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[KPTRXHST]), ['PM Vendor Master Summary'].[LSTCHAMT] as 'Last Check Amount', ['PM Vendor Master Summary'].[LSTCHKDT] as 'Last Check Date', rtrim(['PM Vendor Master Summary'].[LSTCHNUM]) as 'Last Check Number', ['PM Vendor Master Summary'].[LSTINVAM] as 'Last Invoice Amount', rtrim(['PM Vendor Master Summary'].[LSTINNUM]) as 'Last Invoice Number', ['PM Vendor Master Summary'].[LSTPURDT] as 'Last Purchase Date', ['Multicurrency Payables Transactions'].[MCTRXSTT] as 'MC Transaction State', 'Maximum Invoice Amount For Vendors' = dbo.DYN_FUNC_Maximum_Invoice_Amount_For_Vendors(['PM Vendor Master File'].[MXIAFVND]), ['PM Vendor Master File'].[MAXINDLR] as 'Maximum Invoice Dollar', ['PM Vendor Master File'].[MXWOFAMT] as 'Maximum Write Off Amount', ['PM Vendor Master File'].[MINORDER] as 'Minimum Order', ['PM Vendor Master File'].[MINPYDLR] as 'Minimum Payment Dollar', ['PM Vendor Master File'].[MINPYPCT]/100.00 as 'Minimum Payment Percent', 'Minimum Payment Type' = dbo.DYN_FUNC_Minimum_Payment_Type(['PM Vendor Master File'].[MINPYTYP]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMMSCHIX]) as 'Misc Charges Account Number', ['PM Paid Transaction History File'].[MSCCHAMT] as 'Misc Charges Amount', rtrim(['PM Paid Transaction History File'].[MSCSCHID]) as 'Misc Schedule ID', ['PM Paid Transaction History File'].[MODIFDT] as 'Modified Date', ['PM Vendor Master File'].[MODIFDT] as 'Modified Date from Vendor Master', rtrim(['PM Paid Transaction History File'].[MDFUSRID]) as 'Modified User ID', ['PM Paid Transaction History File'].[NOTEINDX] as 'Note Index', ['PM Vendor Master File'].[NOTEINDX] as 'Note Index from Vendor Master', ['PM Vendor Master Summary'].[NFNCHLIF] as 'Number of Finance Charges LIFE', ['PM Vendor Master Summary'].[NFNCHLYR] as 'Number of Finance Charges LYR',  ['PM Vendor Master Summary'].[NFNCHYTD] as 'Number of Finance Charges YTD', ['PM Vendor Master Summary'].[NOINVLIF] as 'Number of Invoices LIFE', ['PM Vendor Master Summary'].[NOINVLYR] as 'Number of Invoices LYR', ['PM Vendor Master Summary'].[NOINVYTD] as 'Number of Invoices YTD', ['PM Vendor Master Summary'].[NOPILIFE] as 'Number of Paid Invoices LIFE', ['PM Vendor Master Summary'].[NOPINYTD] as 'Number of Paid Invoices YTD', ['PM Vendor Master Summary'].[ONORDAMT] as 'On Order Amount', ['Multicurrency Payables Transactions'].[OR1099AM] as 'Originating 1099 Amount', ['Multicurrency Payables Transactions'].[ORAPPAMT] as 'Originating Applied Amount', ['Multicurrency Payables Transactions'].[ORGAPDISCTKN] as 'Originating Applied Discount Taken Amount', ['Multicurrency Payables Transactions'].[ORBKTFRT] as 'Originating Backout Freight Amount', ['Multicurrency Payables Transactions'].[ORBKTMSC] as 'Originating Backout Misc Amount', ['Multicurrency Payables Transactions'].[OBKPURAMT] as 'Originating Backout Purchases Amount', ['Multicurrency Payables Transactions'].[ORCASAMT] as 'Originating Cash Amount', ['Multicurrency Payables Transactions'].[OCHGAMT] as 'Originating Charge Amount', ['Multicurrency Payables Transactions'].[ORCHKAMT] as 'Originating Check Amount', ['Multicurrency Payables Transactions'].[ORCHKTTL] as 'Originating Check Total', ['Multicurrency Payables Transactions'].[ORCCDAMT] as 'Originating Credit Card Amount', ['Multicurrency Payables Transactions'].[ORCTRXAM] as 'Originating Current Trx Amount', ['Multicurrency Payables Transactions'].[ODISAMTAV] as 'Originating Discount Amount Available', ['Multicurrency Payables Transactions'].[ORDATKN] as 'Originating Discount Available Taken', ['Multicurrency Payables Transactions'].[ORDDLRAT] as 'Originating Discount Dollar Amount', ['Multicurrency Payables Transactions'].[ORDISTKN] as 'Originating Discount Taken Amount', ['Multicurrency Payables Transactions'].[ORDOCAMT] as 'Originating Document Amount', ['Multicurrency Payables Transactions'].[ORFRTAMT] as 'Originating Freight Amount', ['Multicurrency Payables Transactions'].[OMISCAMT] as 'Originating Misc Charges Amount', ['Multicurrency Payables Transactions'].[OPURAMT] as 'Originating Purchases Amount', ['Multicurrency Payables Transactions'].[ORTAXAMT] as 'Originating Tax Amount', ['Multicurrency Payables Transactions'].[OTOTPAY] as 'Originating Total Payments', ['Multicurrency Payables Transactions'].[ORTDISAM] as 'Originating Trade Discount Amount', ['Multicurrency Payables Transactions'].[ORWROFAM] as 'Originating Write Off Amount', ['PM Paid Transaction History File'].[PPSAMDED] as 'PPS Amount Deducted', ['PM Paid Transaction History File'].[PPSTAXRT]/100.00 as 'PPS Tax Rate', ['PM Vendor Master File'].[PPSTAXRT]/100.00 as 'PPS Tax Rate from Vendor Master', rtrim(['PM Vendor Master File'].[PARVENID]) as 'Parent Vendor ID', 'Payment Entry Type' = dbo.DYN_FUNC_Payment_Entry_Type(['PM Paid Transaction History File'].[PYENTTYP]), rtrim(['PM Vendor Master File'].[PYMNTPRI]) as 'Payment Priority', rtrim(['PM Paid Transaction History File'].[PYMTRMID]) as 'Payment Terms ID', rtrim(['PM Vendor Master File'].[PYMTRMID]) as 'Payment Terms ID from Vendor Master', ['PM Paid Transaction History File'].[PRCTDISC] as 'Percent Discount', ['PM Paid Transaction History File'].[PGRAMSBJ]/100.00 as 'Percent Of Gross Amount Subject', rtrim(['PM Vendor Master File'].[PHONE3]) as 'Phone 3', rtrim(['PM Vendor Master File'].[PHNUMBR1]) as 'Phone Number 1', rtrim(['PM Vendor Master File'].[PHNUMBR2]) as 'Phone Number 2', 'Post Results To' = dbo.DYN_FUNC_Post_Results_To_Vendor(['PM Vendor Master File'].[Post_Results_To]), 'Post To Cash Account From' = dbo.DYN_FUNC_Post_To_Cash_Account_From(['PM Vendor Master File'].[PTCSHACF]), NULL  as 'Posted', ['PM Paid Transaction History File'].[POSTEDDT] as 'Posted Date', rtrim(['PM Paid Transaction History File'].[PTDUSRID]) as 'Posted User ID', ['PM Paid Transaction History File'].[PSTGDATE] as 'Posting Date', 'Prescribed Payee' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[PRSPAYEE]), NULL  as 'Printed', ['PM Paid Transaction History File'].[PRCHDATE] as 'Purchase Date', rtrim(['PM Paid Transaction History File'].[PORDNMBR]) as 'Purchase Order Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PURPVIDX]) as 'Purchase Price Variance Account Number', rtrim(['PM Paid Transaction History File'].[PCHSCHID]) as 'Purchase Schedule ID', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMPRCHIX]) as 'Purchases Account Number', ['PM Paid Transaction History File'].[PRCHAMNT] as 'Purchases Amount', 'Rate Calculation Method' = dbo.DYN_FUNC_Rate_Calculation_Method(['Multicurrency Payables Transactions'].[RTCLCMTD]), rtrim(['Multicurrency Payables Transactions'].[RATETPID]) as 'Rate Type ID', rtrim(['PM Vendor Master File'].[RATETPID]) as 'Rate Type ID from Vendor Master', 'Reporting Obligation Undertaken' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[RTOBUTKN]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMRTNGIX]) as 'Retainage Account Number', ['PM Paid Transaction History File'].[RETNAGAM] as 'Retainage Amount', ['PM Vendor Master Summary'].[RTNGOWED] as 'Retainage Owed', ['PM Vendor Master Summary'].[RTRNSLIF] as 'Returns LIFE', ['PM Vendor Master Summary'].[RTRNSLYR] as 'Returns LYR', ['PM Vendor Master Summary'].[RTRNSYTD] as 'Returns YTD', 'Revalue Vendor' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[Revalue_Vendor]),  rtrim(['PM Paid Transaction History File'].[SHIPMTHD]) as 'Shipping Method', rtrim(['PM Vendor Master File'].[SHIPMTHD]) as 'Shipping Method from Vendor Master', 'Simplified' = dbo.DYN_FUNC_Boolean_All(['PM Paid Transaction History File'].[SIMPLIFD]), NULL  as 'Source Document', rtrim(['PM Vendor Master File'].[STATE]) as 'State', 'Subject To PPS Deductions' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[SBPPSDED]), rtrim(['PM Paid Transaction History File'].[TRXSORCE]) as 'TRX Source', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMTAXIDX]) as 'Tax Account Number', ['PM Paid Transaction History File'].[TAXAMNT] as 'Tax Amount', ['PM Paid Transaction History File'].[Tax_Date] as 'Tax Date', NULL  as 'Tax Engine Called', rtrim(['PM Vendor Master File'].[TXIDNMBR]) as 'Tax ID Number', 'Tax Invoice Received from Vendor Master' = dbo.DYN_FUNC_Boolean_All(['PM Vendor Master File'].[TaxInvRecvd]), 'Tax Invoice Required' = dbo.DYN_FUNC_Boolean_All(['PM Paid Transaction History File'].[TaxInvReqd]), rtrim(['PM Vendor Master File'].[TXRGNNUM]) as 'Tax Registration Number', rtrim(['PM Paid Transaction History File'].[TAXSCHID]) as 'Tax Schedule ID', rtrim(['PM Vendor Master File'].[TAXSCHID]) as 'Tax Schedule ID from Vendor Master', ['Multicurrency Payables Transactions'].[TIME1] as 'Time', ['PM Paid Transaction History File'].[TTLPYMTS] as 'Total Payments', ['PM Vendor Master File'].[TRDDISCT]/100.00 as 'Trade Discount', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMTDSCIX]) as 'Trade Discount Account Number', ['PM Paid Transaction History File'].[TRDISAMT] as 'Trade Discount Amount', ['PM Vendor Master Summary'].[TRDTKLIF] as 'Trade Discounts Taken LIFE', ['PM Vendor Master Summary'].[TRDTLYR] as 'Trade Discounts Taken LYR', ['PM Vendor Master Summary'].[TRDTYTD] as 'Trade Discounts Taken YTD', rtrim(['PM Paid Transaction History File'].[TRXDSCRN]) as 'Transaction Description', rtrim(['PM Vendor Master File'].[UPSZONE]) as 'UPS Zone', ['PM Paid Transaction History File'].[UN1099AM] as 'Unapplied 1099 Amount', ['PM Vendor Master Summary'].[UNPDFNCH] as 'Unpaid Finance Charges', ['Multicurrency Payables Transactions'].[UNGANLOS] as 'Unrealized Gain-Loss Amount', rtrim(['PM Vendor Master File'].[USERDEF1]) as 'User Defined 1', rtrim(['PM Vendor Master File'].[USERDEF2]) as 'User Defined 2', NULL  as 'Vendor Address Code - Primary', rtrim(['PM Vendor Master File'].[VADDCDPR]) as 'Vendor Address Code - Primary from Vendor Master', rtrim(['PM Vendor Master File'].[VADCDPAD]) as 'Vendor Address Code - Purchase Address', rtrim(['PM Paid Transaction History File'].[VADCDTRO]) as 'Vendor Address Code - Remit To', rtrim(['PM Vendor Master File'].[VADCDTRO]) as 'Vendor Address Code - Remit To from Vendor Master', rtrim(['PM Vendor Master File'].[VADCDSFR]) as 'Vendor Address Code - Ship From', rtrim(['PM Paid Transaction History File'].[VNDCHKNM]) as 'Vendor Check Name', rtrim(['PM Vendor Master File'].[VNDCHKNM]) as 'Vendor Check Name from Vendor Master', rtrim(['PM Vendor Master File'].[VNDCLSID]) as 'Vendor Class ID', rtrim(['PM Vendor Master File'].[VNDCNTCT]) as 'Vendor Contact', rtrim(['PM Vendor Master File'].[VENDNAME]) as 'Vendor Name', rtrim(['PM Vendor Master File'].[VENDSHNM]) as 'Vendor Short Name', 'Vendor Status' = dbo.DYN_FUNC_Vendor_Status(['PM Vendor Master File'].[VENDSTTS]), ['PM Paid Transaction History File'].[VOIDPDATE] as 'Void GL Posting Date', 'Voided' = dbo.DYN_FUNC_Boolean_All(['PM Paid Transaction History File'].[VOIDED]), NULL  as 'Voucher Number Corrected', ['PM Vendor Master Summary'].[Withholding_LIFE] as 'Withholding LIFE', ['PM Vendor Master Summary'].[WITHLYR] as 'Withholding LYR', ['PM Vendor Master Summary'].[WITHYTD] as 'Withholding YTD', ['PM Paid Transaction History File'].[WROFAMNT] as 'Write Off Amount', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PM Vendor Master File'].[PMWRTIDX]) as 'Write Offs Account Number', ['PM Vendor Master Summary'].[WROFSLIF] as 'Write Offs LIFE', ['PM Vendor Master Summary'].[WROFSLYR] as 'Write Offs LYR', ['PM Vendor Master Summary'].[WROFSYTD] as 'Write Offs YTD', 'Writeoff' = dbo.DYN_FUNC_Writeoff(['PM Vendor Master File'].[WRITEOFF]), rtrim(['PM Vendor Master File'].[ZIPCODE]) as 'Zip Code',  case   when datediff(dd,['PM Paid Transaction History File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 1) or  ((select ENDGPDYS from PM40101 where INDEX1 = 1) = 999) or  ['PM Paid Transaction History File'].[DOCTYPE] >= 4  then 'Aging Bucket1'   when datediff(dd,['PM Paid Transaction History File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 2) or  ((select ENDGPDYS from PM40101 where INDEX1 = 2) = 999)   then 'Aging Bucket2'   when datediff(dd,['PM Paid Transaction History File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 3) or  ((select ENDGPDYS from PM40101 where INDEX1 = 3) = 999)   then 'Aging Bucket3'   when datediff(dd,['PM Paid Transaction History File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 4) or  ((select ENDGPDYS from PM40101 where INDEX1 = 4) = 999)   then 'Aging Bucket4'   when datediff(dd,['PM Paid Transaction History File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 5) or  ((select ENDGPDYS from PM40101 where INDEX1 = 5) = 999)   then 'Aging Bucket5'   when datediff(dd,['PM Paid Transaction History File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 6) or  ((select ENDGPDYS from PM40101 where INDEX1 = 6) = 999)   then 'Aging Bucket6'   else 'Aging Bucket7'  end as 'Aging Bucket', case   when datediff(dd,['PM Paid Transaction History File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 1) or  ((select ENDGPDYS from PM40101 where INDEX1 = 1) = 999) or  ['PM Paid Transaction History File'].[DOCTYPE] >= 4   then (select DSCRIPTN from PM40101 where INDEX1 = 1)   when datediff(dd,['PM Paid Transaction History File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 2) or  ((select ENDGPDYS from PM40101 where INDEX1 = 2) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 2)   when datediff(dd,['PM Paid Transaction History File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 3) or  ((select ENDGPDYS from PM40101 where INDEX1 = 3) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 3)   when datediff(dd,['PM Paid Transaction History File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 4) or  ((select ENDGPDYS from PM40101 where INDEX1 = 4) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 4)   when datediff(dd,['PM Paid Transaction History File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 5) or  ((select ENDGPDYS from PM40101 where INDEX1 = 5) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 5)   when datediff(dd,['PM Paid Transaction History File'].[DOCDATE] , GETDATE()) <=   (select ENDGPDYS from PM40101 where INDEX1 = 6) or  ((select ENDGPDYS from PM40101 where INDEX1 = 6) = 999)   then (select DSCRIPTN from PM40101 where INDEX1 = 6)   else (select DSCRIPTN from PM40101 where INDEX1 = 7) end as 'Aging Bucket Description', ['PM Paid Transaction History File'].[DOCTYPE] as 'Document Type Int', '1099 Type' = dbo.DYN_FUNC_1099_Type(['PM Paid Transaction History File'].[TEN99TYPE]), '1099 Box' = dbo.DYN_FUNC_1099_Box_Type(['PM Paid Transaction History File'].[TEN99TYPE],['PM Paid Transaction History File'].[TEN99BOXNUMBER]), 'Workflow Approval Status' = dbo.DYN_FUNC_Workflow_Approval_Status(['Posting Definitions Master'].[Workflow_Approval_Status]), 'Workflow Priority' = dbo.DYN_FUNC_Workflow_Priority(['Posting Definitions Master'].[Workflow_Priority]),  'Accounts Payable Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMAPINDX] ), 'Accrued Purchases Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[ACPURIDX] ), 'Cash Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMCSHIDX] ),  'Checkbook ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCheckbookID(1,['PM Paid Transaction History File'].[CHEKBKID] ), 'Discount Available Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMDAVIDX] ), 'Discount Taken Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMDTKIDX] ), 'Document Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppPayablesTransactionNumber(1,['PM Paid Transaction History File'].[DOCTYPE],['PM Paid Transaction History File'].[VCHRNMBR],3,1,-1,['PM Paid Transaction History File'].[TRXSORCE],'' ),  'Finance Charge Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMFINIDX] ), 'Freight Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMFRTIDX] ), 'Misc Charges Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMMSCHIX] ), 'Purchase Order Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppPurchaseOrder(1,1,3,['PM Paid Transaction History File'].[DOCTYPE],0, ['PM Paid Transaction History File'].[VENDORID],['PM Paid Transaction History File'].[PORDNMBR], '','',['PM Paid Transaction History File'].[DOCNUMBR],'',['PM Paid Transaction History File'].[VCHRNMBR] ),  'Purchase Price Variance Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PURPVIDX] ), 'Purchases Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMPRCHIX] ), 'Retainage Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMRTNGIX] ), 'Tax Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMTAXIDX] ),  'Trade Discount Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMTDSCIX] ), 'Vendor ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppVendorID(1,['PM Paid Transaction History File'].[VENDORID] ), 'Write Offs Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['PM Vendor Master File'].[PMWRTIDX] )  from [PM30200] as ['PM Paid Transaction History File'] with (NOLOCK) left outer join [MC020103] as ['Multicurrency Payables Transactions'] with (NOLOCK) on ['PM Paid Transaction History File'].[DOCTYPE] = ['Multicurrency Payables Transactions'].[DOCTYPE]  and ['PM Paid Transaction History File'].[VCHRNMBR] = ['Multicurrency Payables Transactions'].[VCHRNMBR] left outer join [PM00200] as ['PM Vendor Master File'] with (NOLOCK) on ['PM Paid Transaction History File'].[VENDORID] = ['PM Vendor Master File'].[VENDORID] left outer join [PM00201] as ['PM Vendor Master Summary'] with (NOLOCK) on ['PM Paid Transaction History File'].[VENDORID] = ['PM Vendor Master Summary'].[VENDORID] left outer join [SY00500] as ['Posting Definitions Master'] with (NOLOCK) on ['PM Paid Transaction History File'].[BCHSOURC] = ['Posting Definitions Master'].[BCHSOURC]  and ['PM Paid Transaction History File'].[BACHNUMB] = ['Posting Definitions Master'].[BACHNUMB] 
GO
GRANT SELECT ON  [dbo].[PayablesTransactions] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[PayablesTransactions] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[PayablesTransactions] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[PayablesTransactions] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[PayablesTransactions] TO [rpt_accounting manager]
GO
GRANT SELECT ON  [dbo].[PayablesTransactions] TO [rpt_accounts payable coordinator]
GO
GRANT SELECT ON  [dbo].[PayablesTransactions] TO [rpt_bookkeeper]
GO
GRANT SELECT ON  [dbo].[PayablesTransactions] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[PayablesTransactions] TO [rpt_materials manager]
GO
GRANT SELECT ON  [dbo].[PayablesTransactions] TO [rpt_operations manager]
GO
GRANT SELECT ON  [dbo].[PayablesTransactions] TO [rpt_production manager]
GO
GRANT SELECT ON  [dbo].[PayablesTransactions] TO [rpt_purchasing agent]
GO
GRANT SELECT ON  [dbo].[PayablesTransactions] TO [rpt_warehouse manager]
GO
