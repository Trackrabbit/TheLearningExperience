SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[BankTransactions] AS select rtrim(['CM Transaction'].[CHEKBKID]) as 'Checkbook ID', ['CM Transaction'].[GLPOSTDT] as 'GL Posting Date', rtrim(['CM Transaction'].[DSCRIPTN]) as 'Description', rtrim(['CM Transaction'].[SOURCDOC]) as 'Source Document', ['CM Transaction'].[Checkbook_Amount] as 'Checkbook Amount',  rtrim(['CM Transaction'].[AUDITTRAIL]) as 'Audit Trail Code', NULL  as 'Bank Branch', NULL  as 'Bank Name', rtrim(['CM Transaction'].[CMLinkID]) as 'CMLinkID', rtrim(['CM Transaction'].[CMTrxNum]) as 'CM Trx Number', 'CM Trx Type' = dbo.DYN_FUNC_CM_Trx_Type(['CM Transaction'].[CMTrxType]), ['CM Transaction'].[CMTrxType] as 'CM Trx Type Int', NULL  as 'Card Name', NULL  as 'Cash Account Number', ['CM Transaction'].[ClrdAmt] as 'Cleared Amount', ['CM Transaction'].[clearedate] as 'Cleared Date', NULL  as 'Control Type', rtrim(['CM Transaction'].[CURNCYID]) as 'Currency ID', ['CM Transaction'].[CURRNIDX] as 'Currency Index', 'Decimal Places Currency' = dbo.DYN_FUNC_Decimal_Places_Currency(['CM Transaction'].[DECPLCUR]), ['CM Transaction'].[DENXRATE] as 'Denomination Exchange Rate', NULL  as 'Deposit Number', 'Deposit Type' = dbo.DYN_FUNC_Deposit_Type(['CM Transaction'].[DEPTYPE]), NULL  as 'Deposited', 'Document Status' = dbo.DYN_FUNC_Document_Status_CM_Trx(2), ['CM Transaction'].[EXCHDATE] as 'Exchange Date', ['CM Transaction'].[XCHGRATE] as 'Exchange Rate', rtrim(['CM Transaction'].[EXGTBLID]) as 'Exchange Table ID', ['CM Transaction'].[EXPNDATE] as 'Expiration Date', 'MC Transaction State' = dbo.DYN_FUNC_MC_Transaction_State(['CM Transaction'].[MCTRXSTT]), ['CM Transaction'].[MODIFDT] as 'Modified Date', rtrim(['CM Transaction'].[MDFUSRID]) as 'Modified User ID', ['CM Transaction'].[NOTEINDX] as 'Note Index', ['CM Transaction'].[ORIGAMT] as 'Originating Amount', rtrim(['CM Transaction'].[paidtorcvdfrom]) as 'Paid ToRcvd From', ['CM Transaction'].[POSTEDDT] as 'Posted Date', rtrim(['CM Transaction'].[PTDUSRID]) as 'Posted User ID', 'Rate Calculation Method' = dbo.DYN_FUNC_Rate_Calculation_Method(['CM Transaction'].[RTCLCMTD]), rtrim(['CM Transaction'].[RATETPID]) as 'Rate Type ID', NULL  as 'Realized GL Account Number', NULL  as 'Realized Gain-Loss Amount', NULL  as 'Receipt Amount', NULL  as 'Receipt Date', NULL  as 'Receipt Number', NULL  as 'Receipt Type', NULL  as 'Received From', NULL  as 'Receiving Denomination Exchange Rate', NULL  as 'Receiving Exchange Rate', NULL  as 'Receiving MC Transaction State', NULL  as 'Receiving Rate Calc Method', NULL  as 'Receiving Rate Type ID', ['CM Transaction'].[RECONUM] as 'Reconcile Number', 'Reconciled' = dbo.DYN_FUNC_Boolean_All(['CM Transaction'].[Recond]), ['CM Transaction'].[CMRECNUM] as 'Record Number', rtrim(['CM Transaction'].[sRecNum]) as 'Record Number String', 'Record Status' = dbo.DYN_FUNC_Record_Status(['CM Transaction'].[RCRDSTTS]), rtrim(['CM Transaction'].[SRCDOCNUM]) as 'Source Doc Number', ['CM Transaction'].[SRCDOCTYP] as 'Source Doc Type', ['CM Transaction'].[TRXAMNT] as 'TRX Amount', ['CM Transaction'].[TRXDATE] as 'TRX Date', ['CM Transaction'].[TIME1] as 'Time', rtrim(['CM Transaction'].[USERDEF1]) as 'User Defined 1', rtrim(['CM Transaction'].[USERDEF2]) as 'User Defined 2', ['CM Transaction'].[VOIDDATE] as 'Void Date', rtrim(['CM Transaction'].[VOIDDESC]) as 'Void Description', ['CM Transaction'].[VOIDPDATE] as 'Void GL Posting Date', 'Voided' = dbo.DYN_FUNC_Boolean_All(['CM Transaction'].[VOIDED]), ['CM Transaction'].[Xfr_Record_Number] as 'Xfr Record Number', rtrim(['CM Checkbook Master'].[DSCRIPTN]) as 'Checkbook Description', rtrim(['CM Checkbook Master'].[CMUSRDF1]) as 'CM User Defined 1', ['CM Checkbook Master'].[CURRBLNC] as 'Current Balance', NULL  as 'Cash Account Number For Drillback', NULL  as 'Realized GL Account Number For Drillback', 'Checkbook ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCheckbookID(1,['CM Transaction'].[CHEKBKID] )  from [CM20200] as ['CM Transaction'] with (NOLOCK) left outer join [CM00100] as ['CM Checkbook Master'] with (NOLOCK) on ['CM Transaction'].[CHEKBKID] = ['CM Checkbook Master'].[CHEKBKID]  union all select rtrim(['CM Receipt'].[CHEKBKID]) as 'Checkbook ID', ['CM Receipt'].[GLPOSTDT] as 'GL Posting Date', rtrim(['CM Receipt'].[DSCRIPTN]) as 'Description', rtrim(['CM Receipt'].[SOURCDOC]) as 'Source Document', ['CM Receipt'].[Checkbook_Amount] as 'Checkbook Amount',  rtrim(['CM Receipt'].[AUDITTRAIL]) as 'Audit Trail Code', rtrim(['CM Receipt'].[BNKBRNCH]) as 'Bank Branch', rtrim(['CM Receipt'].[BANKNAME]) as 'Bank Name', rtrim(['CM Receipt'].[CMLinkID]) as 'CMLinkID', NULL  as 'CM Trx Number', NULL  as 'CM Trx Type', NULL  as 'CM Trx Type Int', rtrim(['CM Receipt'].[CARDNAME]) as 'Card Name', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['CM Receipt'].[Cash_Account_Index]) as 'Cash Account Number', NULL  as 'Cleared Amount', NULL  as 'Cleared Date', 'Control Type' = dbo.DYN_FUNC_Control_Type_CM(['CM Receipt'].[CNTRLTYP]), rtrim(['CM Receipt'].[CURNCYID]) as 'Currency ID', ['CM Receipt'].[CURRNIDX] as 'Currency Index', 'Decimal Places Currency' = dbo.DYN_FUNC_Decimal_Places_Currency(['CM Receipt'].[DECPLCUR]), ['CM Receipt'].[DENXRATE] as 'Denomination Exchange Rate', rtrim(['CM Receipt'].[depositnumber]) as 'Deposit Number', NULL  as 'Deposit Type', 'Deposited' = dbo.DYN_FUNC_Boolean_All(['CM Receipt'].[DEPOSITED]), 'Document Status' = dbo.DYN_FUNC_Document_Status_CM_Trx(1), ['CM Receipt'].[EXCHDATE] as 'Exchange Date', ['CM Receipt'].[XCHGRATE] as 'Exchange Rate', rtrim(['CM Receipt'].[EXGTBLID]) as 'Exchange Table ID', ['CM Receipt'].[EXPNDATE] as 'Expiration Date', 'MC Transaction State' = dbo.DYN_FUNC_MC_Transaction_State(['CM Receipt'].[MCTRXSTT]), ['CM Receipt'].[MODIFDT] as 'Modified Date', rtrim(['CM Receipt'].[MDFUSRID]) as 'Modified User ID', ['CM Receipt'].[NOTEINDX] as 'Note Index', ['CM Receipt'].[ORIGAMT] as 'Originating Amount', NULL  as 'Paid ToRcvd From', ['CM Receipt'].[POSTEDDT] as 'Posted Date', rtrim(['CM Receipt'].[PTDUSRID]) as 'Posted User ID', 'Rate Calculation Method' = dbo.DYN_FUNC_Rate_Calculation_Method(['CM Receipt'].[RTCLCMTD]), rtrim(['CM Receipt'].[RATETPID]) as 'Rate Type ID', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['CM Receipt'].[Realized_GL_Account_Inde]) as 'Realized GL Account Number', ['CM Receipt'].[RLGANLOS] as 'Realized Gain-Loss Amount', ['CM Receipt'].[RCPTAMT] as 'Receipt Amount', ['CM Receipt'].[receiptdate] as 'Receipt Date', rtrim(['CM Receipt'].[RCPTNMBR]) as 'Receipt Number', 'Receipt Type' = dbo.DYN_FUNC_Receipt_Type(['CM Receipt'].[RcpType]), rtrim(['CM Receipt'].[RcvdFrom]) as 'Received From', ['CM Receipt'].[Receiving_DenomEXRate] as 'Receiving Denomination Exchange Rate', ['CM Receipt'].[Receiving_Exchange_Rate] as 'Receiving Exchange Rate', 'Receiving MC Transaction State' = dbo.DYN_FUNC_Receiving_MC_Transaction_State(['CM Receipt'].[Receiving_MC_Transaction]), 'Receiving Rate Calc Method' = dbo.DYN_FUNC_Receiving_Rate_Calc_Method(['CM Receipt'].[RCVGRTCLCMTD]), rtrim(['CM Receipt'].[RCVGRATETPID]) as 'Receiving Rate Type ID', NULL  as 'Reconcile Number', NULL  as 'Reconciled', ['CM Receipt'].[CMRECNUM] as 'Record Number', rtrim(['CM Receipt'].[sRecNum]) as 'Record Number String', 'Record Status' = dbo.DYN_FUNC_Record_Status(['CM Receipt'].[RCRDSTTS]), rtrim(['CM Receipt'].[SRCDOCNUM]) as 'Source Doc Number', ['CM Receipt'].[SRCDOCTYP] as 'Source Doc Type', NULL  as 'TRX Amount', NULL  as 'TRX Date', ['CM Receipt'].[TIME1] as 'Time', rtrim(['CM Receipt'].[USERDEF1]) as 'User Defined 1', rtrim(['CM Receipt'].[USERDEF2]) as 'User Defined 2', ['CM Receipt'].[VOIDDATE] as 'Void Date', rtrim(['CM Receipt'].[VOIDDESC]) as 'Void Description', ['CM Receipt'].[VOIDPDATE] as 'Void GL Posting Date', 'Voided' = dbo.DYN_FUNC_Boolean_All(['CM Receipt'].[VOIDED]), NULL  as 'Xfr Record Number', rtrim(['CM Checkbook Master'].[DSCRIPTN]) as 'Checkbook Description', rtrim(['CM Checkbook Master'].[CMUSRDF1]) as 'CM User Defined 1', ['CM Checkbook Master'].[CURRBLNC] as 'Current Balance', 'Cash Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['CM Receipt'].[Cash_Account_Index] ), 'Realized GL Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['CM Receipt'].[Realized_GL_Account_Inde] ), 'Checkbook ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCheckbookID(1,['CM Receipt'].[CHEKBKID] )        from [CM20300] as ['CM Receipt'] with (NOLOCK) left outer join [CM00100] as ['CM Checkbook Master'] with (NOLOCK) on ['CM Receipt'].[CHEKBKID] = ['CM Checkbook Master'].[CHEKBKID] 
GO
GRANT SELECT ON  [dbo].[BankTransactions] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[BankTransactions] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[BankTransactions] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[BankTransactions] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[BankTransactions] TO [rpt_accounting manager]
GO
GRANT SELECT ON  [dbo].[BankTransactions] TO [rpt_bookkeeper]
GO
GRANT SELECT ON  [dbo].[BankTransactions] TO [rpt_executive]
GO
