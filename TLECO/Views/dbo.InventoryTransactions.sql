SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[InventoryTransactions] AS select rtrim(['Inventory Transaction Amounts Work'].[IVDOCNBR]) as 'Document Number', 'Document Type' = dbo.DYN_FUNC_Document_Type_IV_Trx(['Inventory Transaction Amounts Work'].[IVDOCTYP]), rtrim(['Inventory Transaction Amounts Work'].[ITEMNMBR]) as 'Item Number', rtrim(['Inventory Transaction Amounts Work'].[UOFM]) as 'U Of M', ['Inventory Transaction Amounts Work'].[TRXQTY] as 'TRX QTY', ['Inventory Transaction Amounts Work'].[UNITCOST] as 'Unit Cost', ['Inventory Transaction Amounts Work'].[EXTDCOST] as 'Extended Cost', rtrim(['Inventory Transaction Amounts Work'].[TRXLOCTN]) as 'TRX Location', ['Inventory Transaction Work'].[DOCDATE] as 'Document Date', 'Document Status' = dbo.DYN_FUNC_Document_Status_IV_Trx(1),  'ABC Code' = dbo.DYN_FUNC_ABC_Code(['Item Master'].[ABCCODE]), 'Allow Back Orders' = dbo.DYN_FUNC_Boolean_All(['Item Master'].[ALWBKORD]), rtrim(['Item Master'].[ALTITEM1]) as 'Alternate Item 1', rtrim(['Item Master'].[ALTITEM2]) as 'Alternate Item 2', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[ASMVRIDX]) as 'Assembly Variance Account Number', rtrim(['Inventory Transaction Work'].[BACHNUMB]) as 'Batch Number', rtrim(['Inventory Transaction Work'].[BCHSOURC]) as 'Batch Source', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVCOGSIX]) as 'COGS Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[CGSINFLX]) as 'COGS Inflation Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[CGSMCIDX]) as 'COGS Monetary Correction Account Number', ['Item Master'].[CREATDDT] as 'Created Date', ['Item Master'].[CURRCOST] as 'Current Cost', NULL  as 'Customer Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVDMGIDX]) as 'Damaged Account Number', 'Decimal Places Currency' = dbo.DYN_FUNC_Decimal_Places_Currency(['Item Master'].[DECPLCUR]), 'Decimal Places QTYS' = dbo.DYN_FUNC_Decimal_Places_QTYS(['Item Master'].[DECPLQTY]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[DPSHPIDX]) as 'Drop Ship Account Number', ['Inventory Transaction Work'].[GLPOSTDT] as 'GL Posting Date', NULL  as 'History Module', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVINSVIX]) as 'In Service Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVINUSIX]) as 'In Use Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Inventory Transaction Amounts Work'].[IVIVINDX]) as 'Inventory Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVIVINDX]) as 'Inventory Account Number from Item Master', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVINFIDX]) as 'Inventory Inflation Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[INVMCIDX]) as 'Inventory Monetary Correction Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Inventory Transaction Amounts Work'].[IVIVOFIX]) as 'Inventory Offset Account Number', NULL  as 'Inventory Offset Account Number from Item Master', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVRETIDX]) as 'Inventory Returns Account Number', rtrim(['Item Master'].[ITMCLSCD]) as 'Item Class Code', rtrim(['Item Master'].[ITEMCODE]) as 'Item Code', rtrim(['Item Master'].[ITEMDESC]) as 'Item Description', rtrim(['Item Master'].[ITMGEDSC]) as 'Item Generic Description', ['Item Master'].[ITEMSHWT]/100.00 as 'Item Shipping Weight', rtrim(['Item Master'].[ITMSHNAM]) as 'Item Short Name', rtrim(['Item Master'].[ITMTSHID]) as 'Item Tax Schedule ID', 'Item Tracking Option' = dbo.DYN_FUNC_Item_Tracking_Option(['Item Master'].[ITMTRKOP]), 'Item Type' = dbo.DYN_FUNC_Item_Type(['Item Master'].[ITEMTYPE]), 'Keep Calendar History' = dbo.DYN_FUNC_Boolean_All(['Item Master'].[KPCALHST]), 'Keep Distribution History' = dbo.DYN_FUNC_Boolean_All(['Item Master'].[KPDSTHST]), 'Keep Period History' = dbo.DYN_FUNC_Boolean_All(['Item Master'].[KPERHIST]), 'Keep Trx History' = dbo.DYN_FUNC_Boolean_All(['Item Master'].[KPTRXHST]), 'Kit COGS Account Source' = dbo.DYN_FUNC_Kit_COGS_Account_Source(['Item Master'].[KTACCTSR]), rtrim(['Item Master'].[LASTGENSN]) as 'Last Generated Serial Number', ['Inventory Transaction Amounts Work'].[LNSEQNBR] as 'Line SEQ Number', rtrim(['Item Master'].[LOCNCODE]) as 'Location Code', rtrim(['Item Master'].[LOTTYPE]) as 'Lot Type', ['Item Master'].[MSTRCDTY] as 'Master Record Type', ['Item Master'].[MODIFDT] as 'Modified Date', rtrim(['Inventory Transaction Work'].[MDFUSRID]) as 'Modified User ID', ['Inventory Transaction Work'].[NOTEINDX] as 'Note Index', ['Inventory Transaction Work'].[POSTEDDT] as 'Posted Date', rtrim(['Inventory Transaction Work'].[PTDUSRID]) as 'Posted User ID',  ['Inventory Transaction Work'].[PSTGSTUS] as 'Posting Status', rtrim(['Item Master'].[PRCLEVEL]) as 'PriceLevel', rtrim(['Item Master'].[PriceGroup]) as 'Price Group', 'Price Method' = dbo.DYN_FUNC_Price_Method(['Item Master'].[PRICMTHD]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[PINFLIDX]) as 'Purch Inflation Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[PURMCIDX]) as 'Purch Monetary Correction Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[PURPVIDX]) as 'Purchase Price Variance Account Number', rtrim(['Item Master'].[PRCHSUOM]) as 'Purchasing U Of M', ['Inventory Transaction Amounts Work'].[QTYBSUOM] as 'QTY In Base U Of M', rtrim(['Inventory Transaction Work'].[RCDOCNUM]) as 'Recurring Document Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVSLSIDX]) as 'Sales Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVSLDSIX]) as 'Sales Discounts Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVSLRNIX]) as 'Sales Returns Account Number', rtrim(['Item Master'].[SELNGUOM]) as 'Selling U Of M', 'Source Indicator' = dbo.DYN_FUNC_Source_Indicator(['Inventory Transaction Work'].[SOURCEINDICATOR]), rtrim(['Inventory Transaction Work'].[SRCRFRNCNMBR]) as 'Source Reference Number', ['Item Master'].[STNDCOST] as 'Standard Cost', ['Inventory Transaction Work'].[TRXQTYTL] as 'TRX QTY Total', NULL  as 'TRX Source', rtrim(['Item Master'].[TCC]) as 'Tax Commodity Code', 'Tax Options' = dbo.DYN_FUNC_Tax_Options(['Item Master'].[TAXOPTNS]), 'Transfer From QTY Type' = dbo.DYN_FUNC_Transfer_From_QTY_Type(['Inventory Transaction Amounts Work'].[TRFQTYTY]), rtrim(['Inventory Transaction Amounts Work'].[TRNSTLOC]) as 'Transfer To Location', 'Transfer To QTY Type' = dbo.DYN_FUNC_Transfer_To_QTY_Type(['Inventory Transaction Amounts Work'].[TRTQTYTY]), rtrim(['Item Master'].[UOMSCHDL]) as 'U Of M Schedule', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[UPPVIDX]) as 'Unrealized Purchase Price Variance Account Number', ['Inventory Transaction Amounts Work'].[USAGETYPE] as 'Usage Type', rtrim(['Item Master'].[USCATVLS_1]) as 'User Category Value 1', rtrim(['Item Master'].[USCATVLS_2]) as 'User Category Value 2', rtrim(['Item Master'].[USCATVLS_3]) as 'User Category Value 3', rtrim(['Item Master'].[USCATVLS_4]) as 'User Category Value 4', rtrim(['Item Master'].[USCATVLS_5]) as 'User Category Value 5', rtrim(['Item Master'].[USCATVLS_6]) as 'User Category Value 6', 'Valuation Method' = dbo.DYN_FUNC_Valuation_Method(['Item Master'].[VCTNMTHD]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVVARIDX]) as 'Variances Account Number', ['Item Master'].[WRNTYDYS] as 'Warranty Days',  'Assembly Variance Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[ASMVRIDX] ), 'COGS Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVCOGSIX] ), 'COGS Inflation Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[CGSINFLX] ), 'COGS Monetary Correction Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[CGSMCIDX] ),  'Damaged Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVDMGIDX] ), 'Document Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppItemTransactionNumber(1,['Inventory Transaction Amounts Work'].[ITEMNMBR],['Inventory Transaction Amounts Work'].[IVDOCTYP],['Inventory Transaction Amounts Work'].[IVDOCNBR],1 ), 'Drop Ship Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[DPSHPIDX] ), 'In Service Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVINSVIX] ),  'In Use Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVINUSIX] ), 'Inventory Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Inventory Transaction Amounts Work'].[IVIVINDX] ), 'Inventory Inflation Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVINFIDX] ), 'Inventory Monetary Correction Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[INVMCIDX] ),  'Inventory Offset Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Inventory Transaction Amounts Work'].[IVIVOFIX] ), 'Inventory Returns Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVRETIDX] ), 'Item Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppItemID(1,['Inventory Transaction Amounts Work'].[ITEMNMBR],['Item Master'].[LOCNCODE] ), 'Purch Inflation Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[PINFLIDX] ),  'Purch Monetary Correction Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[PURMCIDX] ), 'Purchase Price Variance Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[PURPVIDX] ), 'Sales Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVSLSIDX] ), 'Sales Discounts Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVSLDSIX] ),  'Sales Returns Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVSLRNIX] ), 'Unrealized Purchase Price Variance Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[UPPVIDX] ), 'Variances Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVVARIDX] )  from [IV10001] as ['Inventory Transaction Amounts Work'] with (NOLOCK) left outer join [IV10000] as ['Inventory Transaction Work'] with (NOLOCK) on ['Inventory Transaction Amounts Work'].[IVDOCTYP] = ['Inventory Transaction Work'].[IVDOCTYP]  and ['Inventory Transaction Amounts Work'].[IVDOCNBR] = ['Inventory Transaction Work'].[IVDOCNBR] left outer join [IV00101] as ['Item Master'] with (NOLOCK) on ['Inventory Transaction Amounts Work'].[ITEMNMBR] = ['Item Master'].[ITEMNMBR]  union all select rtrim(['Inventory Transaction Amounts History'].[DOCNUMBR]) as 'Document Number', 'Document Type' = dbo.DYN_FUNC_Document_Type_IV_Trx(['Inventory Transaction Amounts History'].[DOCTYPE]), rtrim(['Inventory Transaction Amounts History'].[ITEMNMBR]) as 'Item Number', rtrim(['Inventory Transaction Amounts History'].[UOFM]) as 'U Of M', ['Inventory Transaction Amounts History'].[TRXQTY] as 'TRX QTY', ['Inventory Transaction Amounts History'].[UNITCOST] as 'Unit Cost', ['Inventory Transaction Amounts History'].[EXTDCOST] as 'Extended Cost', rtrim(['Inventory Transaction Amounts History'].[TRXLOCTN]) as 'TRX Location', ['Inventory Transaction Amounts History'].[DOCDATE] as 'Document Date', 'Document Status' = dbo.DYN_FUNC_Document_Status_IV_Trx(2),  'ABC Code' = dbo.DYN_FUNC_ABC_Code(['Item Master'].[ABCCODE]), 'Allow Back Orders' = dbo.DYN_FUNC_Boolean_All(['Item Master'].[ALWBKORD]), rtrim(['Item Master'].[ALTITEM1]) as 'Alternate Item 1', rtrim(['Item Master'].[ALTITEM2]) as 'Alternate Item 2', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[ASMVRIDX]) as 'Assembly Variance Account Number', rtrim(['Inventory Transaction History'].[BACHNUMB]) as 'Batch Number', rtrim(['Inventory Transaction History'].[BCHSOURC]) as 'Batch Source', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVCOGSIX]) as 'COGS Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[CGSINFLX]) as 'COGS Inflation Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[CGSMCIDX]) as 'COGS Monetary Correction Account Number', ['Item Master'].[CREATDDT] as 'Created Date', ['Item Master'].[CURRCOST] as 'Current Cost', NULL  as 'Customer Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVDMGIDX]) as 'Damaged Account Number', 'Decimal Places Currency' = dbo.DYN_FUNC_Decimal_Places_Currency(['Item Master'].[DECPLCUR]), 'Decimal Places QTYS' = dbo.DYN_FUNC_Decimal_Places_QTYS(['Item Master'].[DECPLQTY]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[DPSHPIDX]) as 'Drop Ship Account Number', ['Inventory Transaction History'].[GLPOSTDT] as 'GL Posting Date', rtrim(['Inventory Transaction Amounts History'].[HSTMODUL]) as 'History Module', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVINSVIX]) as 'In Service Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVINUSIX]) as 'In Use Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Inventory Transaction Amounts History'].[IVIVINDX]) as 'Inventory Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVIVINDX]) as 'Inventory Account Number from Item Master', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVINFIDX]) as 'Inventory Inflation Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[INVMCIDX]) as 'Inventory Monetary Correction Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Inventory Transaction Amounts History'].[IVIVOFIX]) as 'Inventory Offset Account Number', NULL  as 'Inventory Offset Account Number from Item Master', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVRETIDX]) as 'Inventory Returns Account Number', rtrim(['Item Master'].[ITMCLSCD]) as 'Item Class Code', rtrim(['Item Master'].[ITEMCODE]) as 'Item Code', rtrim(['Item Master'].[ITEMDESC]) as 'Item Description', rtrim(['Item Master'].[ITMGEDSC]) as 'Item Generic Description', ['Item Master'].[ITEMSHWT]/100.00 as 'Item Shipping Weight', rtrim(['Item Master'].[ITMSHNAM]) as 'Item Short Name', rtrim(['Item Master'].[ITMTSHID]) as 'Item Tax Schedule ID', 'Item Tracking Option' = dbo.DYN_FUNC_Item_Tracking_Option(['Item Master'].[ITMTRKOP]), 'Item Type' = dbo.DYN_FUNC_Item_Type(['Item Master'].[ITEMTYPE]), 'Keep Calendar History' = dbo.DYN_FUNC_Boolean_All(['Item Master'].[KPCALHST]), 'Keep Distribution History' = dbo.DYN_FUNC_Boolean_All(['Item Master'].[KPDSTHST]), 'Keep Period History' = dbo.DYN_FUNC_Boolean_All(['Item Master'].[KPERHIST]), 'Keep Trx History' = dbo.DYN_FUNC_Boolean_All(['Item Master'].[KPTRXHST]), 'Kit COGS Account Source' = dbo.DYN_FUNC_Kit_COGS_Account_Source(['Item Master'].[KTACCTSR]), rtrim(['Item Master'].[LASTGENSN]) as 'Last Generated Serial Number', ['Inventory Transaction Amounts History'].[LNSEQNBR] as 'Line SEQ Number', rtrim(['Item Master'].[LOCNCODE]) as 'Location Code', rtrim(['Item Master'].[LOTTYPE]) as 'Lot Type', ['Item Master'].[MSTRCDTY] as 'Master Record Type', ['Item Master'].[MODIFDT] as 'Modified Date', NULL  as 'Modified User ID', ['Inventory Transaction History'].[NOTEINDX] as 'Note Index', NULL  as 'Posted Date', NULL  as 'Posted User ID', NULL  as 'Posting Status', rtrim(['Item Master'].[PRCLEVEL]) as 'PriceLevel',  rtrim(['Item Master'].[PriceGroup]) as 'Price Group', 'Price Method' = dbo.DYN_FUNC_Price_Method(['Item Master'].[PRICMTHD]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[PINFLIDX]) as 'Purch Inflation Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[PURMCIDX]) as 'Purch Monetary Correction Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[PURPVIDX]) as 'Purchase Price Variance Account Number', rtrim(['Item Master'].[PRCHSUOM]) as 'Purchasing U Of M', ['Inventory Transaction Amounts History'].[QTYBSUOM] as 'QTY In Base U Of M', NULL  as 'Recurring Document Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVSLSIDX]) as 'Sales Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVSLDSIX]) as 'Sales Discounts Account Number', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVSLRNIX]) as 'Sales Returns Account Number', rtrim(['Item Master'].[SELNGUOM]) as 'Selling U Of M', 'Source Indicator' = dbo.DYN_FUNC_Source_Indicator(['Inventory Transaction History'].[SOURCEINDICATOR]), rtrim(['Inventory Transaction History'].[SRCRFRNCNMBR]) as 'Source Reference Number', ['Item Master'].[STNDCOST] as 'Standard Cost', NULL  as 'TRX QTY Total', NULL  as 'TRX Source', rtrim(['Item Master'].[TCC]) as 'Tax Commodity Code', 'Tax Options' = dbo.DYN_FUNC_Tax_Options(['Item Master'].[TAXOPTNS]), 'Transfer From QTY Type' = dbo.DYN_FUNC_Transfer_From_QTY_Type(['Inventory Transaction Amounts History'].[TRFQTYTY]), rtrim(['Inventory Transaction Amounts History'].[TRNSTLOC]) as 'Transfer To Location', 'Transfer To QTY Type' = dbo.DYN_FUNC_Transfer_To_QTY_Type(['Inventory Transaction Amounts History'].[TRTQTYTY]), rtrim(['Item Master'].[UOMSCHDL]) as 'U Of M Schedule', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[UPPVIDX]) as 'Unrealized Purchase Price Variance Account Number', NULL  as 'Usage Type', rtrim(['Item Master'].[USCATVLS_1]) as 'User Category Value 1', rtrim(['Item Master'].[USCATVLS_2]) as 'User Category Value 2', rtrim(['Item Master'].[USCATVLS_3]) as 'User Category Value 3', rtrim(['Item Master'].[USCATVLS_4]) as 'User Category Value 4', rtrim(['Item Master'].[USCATVLS_5]) as 'User Category Value 5', rtrim(['Item Master'].[USCATVLS_6]) as 'User Category Value 6', 'Valuation Method' = dbo.DYN_FUNC_Valuation_Method(['Item Master'].[VCTNMTHD]), (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['Item Master'].[IVVARIDX]) as 'Variances Account Number', ['Item Master'].[WRNTYDYS] as 'Warranty Days',  'Assembly Variance Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[ASMVRIDX] ), 'COGS Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVCOGSIX] ), 'COGS Inflation Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[CGSINFLX] ), 'COGS Monetary Correction Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[CGSMCIDX] ),  'Damaged Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVDMGIDX] ), 'Document Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppItemTransactionNumber(1,['Inventory Transaction Amounts History'].[ITEMNMBR],['Inventory Transaction Amounts History'].[DOCTYPE],['Inventory Transaction Amounts History'].[DOCNUMBR],3 ), 'Drop Ship Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[DPSHPIDX] ), 'In Service Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVINSVIX] ),  'In Use Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVINUSIX] ), 'Inventory Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Inventory Transaction Amounts History'].[IVIVINDX] ), 'Inventory Inflation Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVINFIDX] ), 'Inventory Monetary Correction Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[INVMCIDX] ),  'Inventory Offset Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Inventory Transaction Amounts History'].[IVIVOFIX] ), 'Inventory Returns Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVRETIDX] ), 'Item Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppItemID(1,['Inventory Transaction Amounts History'].[ITEMNMBR],['Item Master'].[LOCNCODE] ), 'Purch Inflation Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[PINFLIDX] ),  'Purch Monetary Correction Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[PURMCIDX] ), 'Purchase Price Variance Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[PURPVIDX] ), 'Sales Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVSLSIDX] ), 'Sales Discounts Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVSLDSIX] ),  'Sales Returns Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVSLRNIX] ), 'Unrealized Purchase Price Variance Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[UPPVIDX] ), 'Variances Account Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppAccountIndex(1,['Item Master'].[IVVARIDX] )  from [IV30300] as ['Inventory Transaction Amounts History'] with (NOLOCK) left outer join [IV30200] as ['Inventory Transaction History'] with (NOLOCK) on ['Inventory Transaction Amounts History'].[DOCTYPE] = ['Inventory Transaction History'].[IVDOCTYP]  and ['Inventory Transaction Amounts History'].[DOCNUMBR] = ['Inventory Transaction History'].[DOCNUMBR] left outer join [IV00101] as ['Item Master'] with (NOLOCK) on ['Inventory Transaction Amounts History'].[ITEMNMBR] = ['Item Master'].[ITEMNMBR] 
GO
GRANT SELECT ON  [dbo].[InventoryTransactions] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[InventoryTransactions] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[InventoryTransactions] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[InventoryTransactions] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[InventoryTransactions] TO [rpt_customer service rep]
GO
GRANT SELECT ON  [dbo].[InventoryTransactions] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[InventoryTransactions] TO [rpt_materials manager]
GO
GRANT SELECT ON  [dbo].[InventoryTransactions] TO [rpt_operations manager]
GO
GRANT SELECT ON  [dbo].[InventoryTransactions] TO [rpt_order processor]
GO
GRANT SELECT ON  [dbo].[InventoryTransactions] TO [rpt_production manager]
GO
GRANT SELECT ON  [dbo].[InventoryTransactions] TO [rpt_purchasing agent]
GO
GRANT SELECT ON  [dbo].[InventoryTransactions] TO [rpt_purchasing manager]
GO
GRANT SELECT ON  [dbo].[InventoryTransactions] TO [rpt_sales manager]
GO
GRANT SELECT ON  [dbo].[InventoryTransactions] TO [rpt_shipping and receiving]
GO
GRANT SELECT ON  [dbo].[InventoryTransactions] TO [rpt_warehouse manager]
GO
