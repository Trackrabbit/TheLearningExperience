SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[HistoryRMALines] AS select rtrim(['SVC_RMA_Line_HIST'].[RETDOCID]) as 'Return Document ID', 'Return Record Type' = dbo.FS_FUNC_Return_Record_Type(['SVC_RMA_Line_HIST'].[Return_Record_Type]), ['SVC_RMA_Line_HIST'].[LNSEQNBR] as 'Line SEQ Number', rtrim(['SVC_RMA_Line_HIST'].[RETTYPE]) as 'SVC Return Type', 'RMA Status' = dbo.FS_FUNC_RMA_Status(['SVC_RMA_Line_HIST'].[RMA_Status]), rtrim(['SVC_RMA_Line_HIST'].[RETSTAT]) as 'Return Status', 'Received' = dbo.DYN_FUNC_Boolean_All(['SVC_RMA_Line_HIST'].[Received]), 'SVC Ready To Close' = dbo.DYN_FUNC_Boolean_All(['SVC_RMA_Line_HIST'].[SVC_Ready_To_Close]), 'Return Origin' = dbo.FS_FUNC_Return_Origin(['SVC_RMA_Line_HIST'].[RETORIG]), rtrim(['SVC_RMA_Line_HIST'].[RETREF]) as 'Return Reference', ['SVC_RMA_Line_HIST'].[ENTDTE] as 'Entry Date', ['SVC_RMA_Line_HIST'].[ETADTE] as 'ETA Date', ['SVC_RMA_Line_HIST'].[RETUDATE] as 'Return Date', ['SVC_RMA_Line_HIST'].[COMPDTE] as 'Complete Date', rtrim(['SVC_RMA_Line_HIST'].[OFFID]) as 'Office ID', rtrim(['SVC_RMA_Line_HIST'].[LOCNCODE]) as 'Location Code', rtrim(['RM Customer MSTR'].[CUSTNMBR]) as 'Customer ID', rtrim(['SVC_RMA_Line_HIST'].[ADRSCODE]) as 'Address Code', rtrim(['SVC_RMA_Line_HIST'].[ITEMNMBR]) as 'Item Number', ['SVC_RMA_Line_HIST'].[EXTDCOST] as 'Extended Cost', ['SVC_RMA_Line_HIST'].[XTNDPRCE] as 'Extended Price',  rtrim(['SVC_RMA_Line_HIST'].[ADDRESS1]) as 'Address 1', rtrim(['SVC_RMA_Line_HIST'].[ADDRESS2]) as 'Address 2', rtrim(['SVC_RMA_Line_HIST'].[ADDRESS3]) as 'Address 3', rtrim(['RM Customer MSTR2'].[CUSTNMBR]) as 'Bill To Customer ID', rtrim(['RM Customer MSTR2'].[CUSTNAME]) as 'Bill To Customer Name', rtrim(['SVC_RMA_Line_HIST'].[Bill_of_Lading]) as 'Bill of Lading', rtrim(['SVC_RMA_Line_HIST'].[CITY]) as 'City', ['SVC_RMA_Line_HIST'].[Commit_Date] as 'Commit Date', ['SVC_RMA_Line_HIST'].[Commit_Time] as 'Commit Time', ['SVC_RMA_Line_HIST'].[COMPTME] as 'Complete Time', ['SVC_RMA_Line_HIST'].[CMPNTSEQ] as 'Component Sequence', rtrim(['SVC_RMA_Line_HIST'].[CONTACT]) as 'Contact', rtrim(['SVC_RMA_Line_HIST'].[COUNTRY]) as 'Country', ['SVC_RMA_Line_HIST'].[Credit_SOP_Line_Item_Seq] as 'Credit SOP Line Item Sequence', rtrim(['SVC_RMA_Line_HIST'].[Credit_SOP_Number]) as 'Credit SOP Number', 'Credit SOP Type' = dbo.DYN_FUNC_SOP_Type(['SVC_RMA_Line_HIST'].[Credit_SOP_Type]), ['SVC_RMA_Line_HIST'].[CURRNIDX] as 'Currency Index', rtrim(['SVC_RMA_Line_HIST'].[CUSTNAME]) as 'Customer Name', 'Customer Owned' = dbo.DYN_FUNC_Boolean_All(['SVC_RMA_Line_HIST'].[CUSTOWN]), rtrim(['SVC_RMA_Line_HIST'].[CSTPONBR]) as 'Customer PO Number', 'Decimal Places Currency' = dbo.DYN_FUNC_Decimal_Places_Currency(['SVC_RMA_Line_HIST'].[DECPLCUR]), 'Decimal Places QTYS' = dbo.DYN_FUNC_Decimal_Places_QTYS(['SVC_RMA_Line_HIST'].[DECPLQTY]), ['SVC_RMA_Line_HIST'].[ETATME] as 'ETA Time', ['SVC_RMA_Line_HIST'].[ENTTME] as 'Entry Time', ['SVC_RMA_Line_HIST'].[EQPLINE] as 'Equipment Line Item Sequence', 'Factory Sealed' = dbo.DYN_FUNC_Boolean_All(['SVC_RMA_Line_HIST'].[FACTSEAL]), ['SVC_RMA_Line_HIST'].[Flat_Rate_Repair_Price] as 'Flat Rate Repair Price', rtrim(['SVC_RMA_Line_HIST'].[ITEMDESC]) as 'Item Description', rtrim(['SVC_RMA_Line_HIST'].[Item_Number_Invoice]) as 'Item Number Invoice', ['SVC_RMA_Line_HIST'].[LNITMSEQ] as 'Line Item Sequence', rtrim(['SVC_RMA_Line_HIST'].[Location_Code_Replacemen]) as 'Location Code Replacement', ['SVC_RMA_Line_HIST'].[NTE_Price] as 'NTE Price', ['SVC_RMA_Line_HIST'].[NOTEINDX] as 'Note Index', rtrim(['SVC_RMA_Line_HIST'].[ORDDOCID]) as 'Order Document ID', 'Originating Decimal Places Currency' = dbo.DYN_FUNC_Decimal_Places_Currency(['SVC_RMA_Line_HIST'].[ODECPLCU]), ['SVC_RMA_Line_HIST'].[OREXTCST] as 'Originating Extended Cost', ['SVC_RMA_Line_HIST'].[OXTNDPRC] as 'Originating Extended Price', ['SVC_RMA_Line_HIST'].[Orig_Flat_RepairPrice] as 'Originating Flat Rate Repair Price', ['SVC_RMA_Line_HIST'].[Originating_NTE_Price] as 'Originating NTE Price', ['SVC_RMA_Line_HIST'].[Originating_Repair_Cost] as 'Originating Repair Cost', ['SVC_RMA_Line_HIST'].[Originating_Repair_Price] as 'Originating Repair Price', ['SVC_RMA_Line_HIST'].[Originating_Replace_Cost] as 'Originating Replace Cost', ['SVC_RMA_Line_HIST'].[Originating_Replace_Pric] as 'Originating Replace Price', ['SVC_RMA_Line_HIST'].[Originating_Return_Cost] as 'Originating Return Cost', ['SVC_RMA_Line_HIST'].[Originating_Return_Price] as 'Originating Return Price', ['SVC_RMA_Line_HIST'].[ORUNTCST] as 'Originating Unit Cost', ['SVC_RMA_Line_HIST'].[ORUNTPRC] as 'Originating Unit Price', ['SVC_RMA_Line_HIST'].[PRMDATE] as 'Promised Date', ['SVC_RMA_Line_HIST'].[QUANTITY] as 'QTY', rtrim(['SVC_RMA_Line_HIST'].[REFRENCE]) as 'Reference', ['SVC_RMA_Line_HIST'].[Repair_Cost] as 'Repair Cost', ['SVC_RMA_Line_HIST'].[Repair_Price] as 'Repair Price', ['SVC_RMA_Line_HIST'].[Replace_Cost] as 'Replace Cost', rtrim(['SVC_RMA_Line_HIST'].[Replace_Item_Number]) as 'Replace Item Number', ['SVC_RMA_Line_HIST'].[Replace_Price] as 'Replace Price', rtrim(['SVC_RMA_Line_HIST'].[Replace_Price_Level]) as 'Replace Price Level', ['SVC_RMA_Line_HIST'].[Replace_QTY] as 'Replace QTY', ['SVC_RMA_Line_HIST'].[Replace_SOP_Line_Item_Se] as 'Replace SOP Line Item Sequence', rtrim(['SVC_RMA_Line_HIST'].[Replace_SOP_Number]) as 'Replace SOP Number', 'Replace SOP Type' = dbo.DYN_FUNC_SOP_Type(['SVC_RMA_Line_HIST'].[Replace_SOP_Type]),  rtrim(['SVC_RMA_Line_HIST'].[Replace_U_Of_M]) as 'Replace U Of M', rtrim(['SVC_RMA_Line_HIST'].[RETADDR1]) as 'Return Address 1', rtrim(['SVC_RMA_Line_HIST'].[RETADDR2]) as 'Return Address 2', rtrim(['SVC_RMA_Line_HIST'].[RETADDR3]) as 'Return Address 3', rtrim(['SVC_RMA_Line_HIST'].[RTRNCITY]) as 'Return Address City', rtrim(['SVC_RMA_Line_HIST'].[RTRNNAME]) as 'Return Address Name', rtrim(['SVC_RMA_Line_HIST'].[RTRNZIP]) as 'Return Address Zip Code', ['SVC_RMA_Line_HIST'].[RETCOST] as 'Return Cost', rtrim(['SVC_RMA_Line_HIST'].[Return_Country]) as 'Return Country', rtrim(['SVC_RMA_Line_HIST'].[Return_Item_Description]) as 'Return Item Description', rtrim(['SVC_RMA_Line_HIST'].[Return_Item_Number]) as 'Return Item Number', rtrim(['SVC_RMA_Line_HIST'].[Return_Location_Code]) as 'Return Location Code', ['SVC_RMA_Line_HIST'].[Return_QTY] as 'Return QTY', ['SVC_RMA_Line_HIST'].[Return_Time] as 'Return Time', rtrim(['SVC_RMA_Line_HIST'].[Return_U_Of_M]) as 'Return U Of M', ['SVC_RMA_Line_HIST'].[SOP_Line_Item_Sequence] as 'SOP Line Item Sequence', rtrim(['SVC_RMA_Line_HIST'].[SOPNUMBE]) as 'SOP Number', rtrim(['SVC_RMA_Line_HIST'].[SOP_Number_Invoice]) as 'SOP Number Invoice', 'SOP Type' = dbo.DYN_FUNC_SOP_Type(['SVC_RMA_Line_HIST'].[SOPTYPE]), rtrim(['SVC_RMA_Line_HIST'].[SVC_Bill_To_Address_Code]) as 'SVC Bill To Address Code', ['SVC_RMA_Line_HIST'].[SVC_Extended_Return_Cost] as 'SVC Extended Return Cost', ['SVC_RMA_Line_HIST'].[SVC_Extended_Return_Pric] as 'SVC Extended Return Price', rtrim(['SVC_RMA_Line_HIST'].[SVC_FO_ID]) as 'SVC FO ID', ['SVC_RMA_Line_HIST'].[SVC_Next_Line_SEQ_Number] as 'SVC Next Line SEQ Number', ['SVC_RMA_Line_HIST'].[SVC_Orig_Ext_Return_Cost] as 'SVC Originating Extended Return Cost', ['SVC_RMA_Line_HIST'].[SVC_Orig_Ext_Return_Pric] as 'SVC Originating Extended Return Price', ['SVC_RMA_Line_HIST'].[SVC_Prev_Line_SEQ_Number] as 'SVC Prev Line SEQ Number', 'SVC RMA From Service' = dbo.DYN_FUNC_Boolean_All(['SVC_RMA_Line_HIST'].[SVC_RMA_From_Service]), rtrim(['SVC_RMA_Line_HIST'].[SVC_RMA_Reason_Code]) as 'SVC_RMA_Reason_Code', rtrim(['SVC_RMA_Line_HIST'].[SVC_RMA_Reason_Code_Desc]) as 'SVC_RMA_Reason_Code_Desc', ['SVC_RMA_Line_HIST'].[SVC_Return_Price] as 'SVC Return Price', rtrim(['SVC_RMA_Line_HIST'].[SVC_Return_Price_Level]) as 'SVC Return Price Level', rtrim(['SVC_RMA_Line_HIST'].[SVC_Return_State]) as 'SVC Return State', ['SVC_RMA_Line_HIST'].[SVC_SCM_Complete] as 'SVC SCM Complete', rtrim(['SVC_RMA_Line_HIST'].[CALLNBR]) as 'Service Call Number', 'Service Record Type' = dbo.FS_FUNC_Service_Record_Type(['SVC_RMA_Line_HIST'].[SRVRECTYPE]), rtrim(['SVC_RMA_Line_HIST'].[SHIPMTHD]) as 'Shipping Method', rtrim(['SVC_RMA_Line_HIST'].[STATE]) as 'State', ['SVC_RMA_Line_HIST'].[TRANSLINESEQ] as 'Transfer Line Item Sequence', ['SVC_RMA_Line_HIST'].[STATUS] as 'Transfer Status', 'Traveler Printed' = dbo.DYN_FUNC_Boolean_All(['SVC_RMA_Line_HIST'].[Traveler_Printed]), rtrim(['SVC_RMA_Line_HIST'].[UOFM]) as 'U Of M', ['SVC_RMA_Line_HIST'].[UNITCOST] as 'Unit Cost', ['SVC_RMA_Line_HIST'].[UNITPRCE] as 'Unit Price', rtrim(['SVC_RMA_Line_HIST'].[USERDEF1]) as 'User Defined 1', rtrim(['SVC_RMA_Line_HIST'].[USERDEF2]) as 'User Defined 2', rtrim(['SVC_RMA_Line_HIST'].[USRDEF03]) as 'User Defined 3', rtrim(['SVC_RMA_Line_HIST'].[USRDEF04]) as 'User Defined 4', rtrim(['SVC_RMA_Line_HIST'].[USRDEF05]) as 'User Defined 5', rtrim(['SVC_RMA_Line_HIST'].[USERID]) as 'User ID', rtrim(['SVC_RMA_Line_HIST'].[ZIPCODE]) as 'Zip Code',  'Customer ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCustomerID(1,['RM Customer MSTR'].[CUSTNMBR] ), 'Item Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppItemID(1,['SVC_RMA_Line_HIST'].[ITEMNMBR],'' ), 'Return Document ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=949' +dbo.dgppRMANumber(1,['SVC_RMA_Line_HIST'].[RETDOCID],['SVC_RMA_Line_HIST'].[Return_Record_Type] ), 'Service Call Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=949' +dbo.dgppServiceRecordType(1,['SVC_RMA_Line_HIST'].[CALLNBR],['SVC_RMA_Line_HIST'].[SRVRECTYPE] ),  'SOP Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppSalesOrder(1,3,11,'',0,0,['SVC_RMA_Line_HIST'].[CUSTNMBR],'',0,'',['SVC_RMA_Line_HIST'].[SOPTYPE],['SVC_RMA_Line_HIST'].[SOPNUMBE] )        from [SVC35200] as ['SVC_RMA_Line_HIST'] with (NOLOCK) left outer join [RM00101] as ['RM Customer MSTR'] with (NOLOCK) on ['SVC_RMA_Line_HIST'].[CUSTNMBR] = ['RM Customer MSTR'].[CUSTNMBR] left outer join [RM00101] as ['RM Customer MSTR2'] with (NOLOCK) on ['SVC_RMA_Line_HIST'].[Bill_To_Customer] = ['RM Customer MSTR2'].[CUSTNMBR] 
GO
GRANT SELECT ON  [dbo].[HistoryRMALines] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[HistoryRMALines] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[HistoryRMALines] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[HistoryRMALines] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[HistoryRMALines] TO [rpt_customer service rep]
GO
GRANT SELECT ON  [dbo].[HistoryRMALines] TO [rpt_dispatcher]
GO
GRANT SELECT ON  [dbo].[HistoryRMALines] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[HistoryRMALines] TO [rpt_project manager]
GO
