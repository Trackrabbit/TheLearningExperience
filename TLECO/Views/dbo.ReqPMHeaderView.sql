SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[ReqPMHeaderView] AS 
select 
	1 "TrxState", -- WORK 
	BACHNUMB, 
	BCHSOURC, 
	(SELECT CREATDDT FROM SY00500 WHERE PM10000.BACHNUMB = SY00500.BACHNUMB AND PM10000.BCHSOURC = SY00500.BCHSOURC) "BatchCreatedDate", 
	(SELECT TIME1 FROM SY00500 WHERE PM10000.BACHNUMB = SY00500.BACHNUMB AND PM10000.BCHSOURC = SY00500.BCHSOURC) "BatchCreatedTime", 
	PM10000.VCHNUMWK "VCHRNMBR", 
	PM10000.VENDORID, 
	(select VENDNAME from PM00200 where PM00200.VENDORID = PM10000.VENDORID) "VENDNAME", 
	DOCNUMBR, 
	PM10000.DOCTYPE, 
	PM10000.DOCDATE, 
	VADDCDPR, 
	VADCDTRO, 
	TAXSCHID, 
	TRXDSCRN, 
	PRCHAMNT, 
	MC020103.OPURAMT, 
	TRDISAMT, 
	MC020103.ORTDISAM, 
	TAXAMNT, 
	MC020103.ORTAXAMT, 
	FRTAMNT, 
	MC020103.OMISCAMT, 
	MSCCHAMT, 
	MC020103.ORFRTAMT, 
	DOCAMNT, 
	MC020103.ORDOCAMT, 
	CHRGAMNT, 
	MC020103.OCHGAMT, 
	TEN99AMNT, 
	MC020103.OR1099AM, 
	MC020103.XCHGRATE, 
	MC020103.EXCHDATE, 
	PORDNMBR, 
	SHIPMTHD, 
	PCHSCHID, 
	FRTSCHID, 
	MSCSCHID, 
	Tax_Date, 
	PM10000.CURNCYID, 
	PM10000.DEX_ROW_TS, 
	MDFUSRID, 
	POSTEDDT, 
	PTDUSRID, 
	'' "TRXSORCE", 
	PSTGDATE, 
	0 "VOIDED", 
	ICDISTS, 
	ICTRX,                            
	PYMTRMID, 
	DUEDATE, 
	DSCDLRAM, 
	MC020103.ORDDLRAT, 
	PRCTDISC, 
	DISCDATE, 
	DISAMTAV, 
	MC020103.ODISAMTAV, 
	DISTKNAM, 
	MC020103.ORDISTKN, 
	APDSTKAM, 
	MC020103.ORGAPDISCTKN, 
	WROFAMNT, 
	MC020103.ORWROFAM, 
	CASHAMNT, 
	MC020103.ORCASAMT, 
	CAMCBKID, 
	CDOCNMBR, 
	CAMTDATE, 
	CAMPMTNM, 
	CHEKAMNT, 
	MC020103.ORCHKTTL, 
	CHAMCBID, 
	CHEKDATE, 
	CAMPYNBR, 
	CHEKNMBR, 
	CRCRDAMT, 
	MC020103.ORCCDAMT, 
	CCAMPYNM, 
	CARDNAME, 
	CCRCTNUM, 
	CRCARDDT, 
	0 "TTLPYMTS",             
	MC020103.OTOTPAY, 
	PM10000.DEX_ROW_ID 
from  
	PM10000 left outer join MC020103 on (PM10000.VCHNUMWK = MC020103.VCHRNMBR and PM10000.DOCTYPE = MC020103.DOCTYPE) 
 
union all 
 
select 
	2 "TrxState", -- OPEN 
	BACHNUMB, 
	BCHSOURC, 
	'', --BatchCreatedDate 
	'', --BatchCreatedTime 
	PM20000.VCHRNMBR, 
	PM20000.VENDORID, 
	(select VENDNAME from PM00200 where PM00200.VENDORID = PM20000.VENDORID) "VENDNAME", 
	DOCNUMBR, 
	PM20000.DOCTYPE, 
	PM20000.DOCDATE, 
	'', -- "VADDCDPR" 
	VADCDTRO, 
	TAXSCHID, 
	TRXDSCRN, 
	PRCHAMNT, 
	MC020103.OPURAMT, 
	TRDISAMT, 
	MC020103.ORTDISAM, 
	TAXAMNT, 
	MC020103.ORTAXAMT, 
	FRTAMNT, 
	MC020103.OMISCAMT, 
	MSCCHAMT, 
	MC020103.ORFRTAMT, 
	DOCAMNT, 
	MC020103.ORDOCAMT, 
	0.00, -- "CHRGAMNT" 
	MC020103.OCHGAMT, 
	TEN99AMNT, 
	MC020103.OR1099AM, 
	MC020103.XCHGRATE, 
	MC020103.EXCHDATE, 
	PORDNMBR, 
	SHIPMTHD, 
	PCHSCHID, 
	FRTSCHID, 
	MSCSCHID, 
	Tax_Date, 
	PM20000.CURNCYID, 
	PM20000.DEX_ROW_TS, 
	MDFUSRID, 
	POSTEDDT, 
	PTDUSRID, 
	TRXSORCE, 
	PSTGDATE, 
	VOIDED, 
	NULL, -- "ICDISTS" 
	ICTRX,                            
	PYMTRMID, 
	DUEDATE, 
	DSCDLRAM, 
	MC020103.ORDDLRAT, 
	PRCTDISC, 
	DISCDATE, 
	DISAMTAV, 
	MC020103.ODISAMTAV, 
	DISTKNAM, 
	MC020103.ORDISTKN, 
	0.00, -- "APDSTKAM" 
	MC020103.ORGAPDISCTKN, 
	WROFAMNT, 
	MC020103.ORWROFAM, 
	0.00, -- "CASHAMNT" 
	MC020103.ORCASAMT, 
	'', -- "CAMCBKID" 
	'', -- "CDOCNMBR" 
	'1900-01-01 00:00:00.000', --  "CAMTDATE" 
	'', --  "CAMPMTNM" 
	0.00, -- "CHEKAMNT" 
	MC020103.ORCHKTTL, 
	'', -- "CHAMCBID" 
	'1900-01-01 00:00:00.000', -- "CHEKDATE" 
	'', -- "CAMPYNBR" 
	'', -- "CHEKNMBR" 
	0.00, -- "CRCRDAMT" 
	MC020103.ORCCDAMT, 
	'', -- "CCAMPYNM" 
	CARDNAME, 
	'', -- "CCRCTNUM" 
	'1900-01-01 00:00:00.000', -- "CRCARDDT" 
	TTLPYMTS,             
	MC020103.OTOTPAY, 
	PM20000.DEX_ROW_ID 
from  
	PM20000 left outer join MC020103 on (PM20000.VCHRNMBR = MC020103.VCHRNMBR and PM20000.DOCTYPE = MC020103.DOCTYPE) 
 
union all 
 
select 
	3 "TrxState", -- HISTORY 
	BACHNUMB, 
	BCHSOURC, 
	'', --BatchCreatedDate 
	'', --BatchCreatedTime 
	PM30200.VCHRNMBR, 
	PM30200.VENDORID, 
	(select VENDNAME from PM00200 where PM00200.VENDORID = PM30200.VENDORID) "VENDNAME", 
	DOCNUMBR, 
	PM30200.DOCTYPE, 
	PM30200.DOCDATE, 
	'', -- "VADDCDPR" 
	VADCDTRO, 
	TAXSCHID, 
	TRXDSCRN, 
	PRCHAMNT, 
	MC020103.OPURAMT, 
	TRDISAMT, 
	MC020103.ORTDISAM, 
	TAXAMNT, 
	MC020103.ORTAXAMT, 
	FRTAMNT, 
	MC020103.OMISCAMT, 
	MSCCHAMT, 
	MC020103.ORFRTAMT, 
	DOCAMNT, 
	MC020103.ORDOCAMT, 
	0.00, -- "CHRGAMNT" 
	MC020103.OCHGAMT, 
	TEN99AMNT, 
	MC020103.OR1099AM, 
	MC020103.XCHGRATE, 
	MC020103.EXCHDATE, 
	PORDNMBR, 
	SHIPMTHD, 
	PCHSCHID, 
	FRTSCHID, 
	MSCSCHID, 
	Tax_Date, 
	PM30200.CURNCYID, 
	PM30200.DEX_ROW_TS, 
	MDFUSRID, 
	POSTEDDT, 
	PTDUSRID, 
	TRXSORCE, 
	PSTGDATE, 
	VOIDED, 
	NULL, -- "ICDISTS" 
	ICTRX,                            
	PYMTRMID, 
	DUEDATE, 
	DSCDLRAM, 
	MC020103.ORDDLRAT, 
	PRCTDISC, 
	DISCDATE, 
	DISAMTAV, 
	MC020103.ODISAMTAV, 
	DISTKNAM, 
	MC020103.ORDISTKN, 
	0.00, -- "APDSTKAM" 
	MC020103.ORGAPDISCTKN, 
	WROFAMNT, 
	MC020103.ORWROFAM, 
	0.00, -- "CASHAMNT" 
	MC020103.ORCASAMT, 
	'', -- "CAMCBKID" 
	'', -- "CDOCNMBR" 
	'1900-01-01 00:00:00.000', -- "CAMTDATE" 
	'', -- "CAMPMTNM" 
	0.00, -- "CHEKAMNT" 
	MC020103.ORCHKTTL, 
	'', -- "CHAMCBID" 
	'1900-01-01 00:00:00.000', -- "CHEKDATE" 
	'', -- "CAMPYNBR" 
	'', -- "CHEKNMBR" 
	0.00, -- "CRCRDAMT" 
	MC020103.ORCCDAMT, 
	'', -- "CCAMPYNM" 
	CARDNAME, 
	'', -- "CCRCTNUM" 
	'1900-01-01 00:00:00.000', -- "CRCARDDT" 
	TTLPYMTS,             
	MC020103.OTOTPAY, 
	PM30200.DEX_ROW_ID 
from  
	PM30200 left outer join MC020103 on (PM30200.VCHRNMBR = MC020103.VCHRNMBR and PM30200.DOCTYPE = MC020103.DOCTYPE) 
 
GO
GRANT SELECT ON  [dbo].[ReqPMHeaderView] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[ReqPMHeaderView] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[ReqPMHeaderView] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[ReqPMHeaderView] TO [DYNGRP]
GO
