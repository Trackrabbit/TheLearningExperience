SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[Contracts] AS select 'Contract Record Type' = dbo.FS_FUNC_Contract_Record_Type(['SVC_Contract_HDR'].[CONSTS]), rtrim(['SVC_Contract_HDR'].[CONTNBR]) as 'Contract Number', rtrim(['SVC_Contract_HDR'].[ADRSCODE]) as 'Address Code', ['SVC_Contract_HDR'].[BILSTRT] as 'Bill Start', ['SVC_Contract_HDR'].[BILEND] as 'Bill End', ['SVC_Contract_HDR'].[BILLNGTH] as 'Bill Length', 'Bill Period' = dbo.FS_FUNC_Bill_Period(['SVC_Contract_HDR'].[BILPRD]), ['SVC_Contract_HDR'].[TOTAL] as 'Total', rtrim(['SVC_Contract_HDR'].[CUSTNMBR]) as 'Customer ID', ['SVC_Contract_HDR'].[BILONDY] as 'Bill On Day', 'Billing Cycle' = dbo.FS_FUNC_Billing_Cycle(['SVC_Contract_HDR'].[BILCYC]), ['SVC_Contract_HDR'].[STRTDATE] as 'Start Date', ['SVC_Contract_HDR'].[ENDDATE] as 'End Date', 'SVC_Liability_Type' = dbo.FS_FUNC_SVC_Liability_Type(['SVC_Contract_HDR'].[SVC_Liability_Type]),  ['SVC_Contract_HDR'].[ACTCAL] as 'Actual Number of Calls', ['SVC_Contract_HDR'].[Amount_To_Invoice] as 'Amount To Invoice', 'Auto Renewing' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[AUTOREN]), rtrim(['SVC_Contract_HDR'].[AUTOREN]) as 'Auto Renewing Evergreen', 'Bill For Retainer' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[BILFRRET]), rtrim(['RM Customer MSTR2'].[CUSTNMBR]) as 'Bill To Customer ID', rtrim(['RM Customer MSTR2'].[CUSTNAME]) as 'Bill To Customer Name', 'Billing Status' = dbo.FS_FUNC_Billing_Status(['SVC_Contract_HDR'].[BILSTAT]), ['SVC_Contract_HDR'].[BLKTIM] as 'Blocked Time', rtrim(['SVC_Contract_HDR'].[COMMCODE]) as 'Commission Code', ['SVC_Contract_HDR'].[COMDLRAM] as 'Commission Dollar Amount', ['SVC_Contract_HDR'].[COMPRCNT] as 'Commission Percent', rtrim(['SVC_Contract_HDR'].[CONTACT]) as 'Contact', ['SVC_Contract_HDR'].[Contract_Coverage_Period_1] as 'Contract Coverage Periods End', ['SVC_Contract_HDR'].[CNTCOVPD_1] as 'Contract Coverage Periods Start', ['SVC_Contract_HDR'].[Contract_Length] as 'Contract Length', 'Contract Period' = dbo.FS_FUNC_Contract_Period(['SVC_Contract_HDR'].[Contract_Period]), ['SVC_Contract_HDR'].[CONTPRC] as 'Contract Price', rtrim(['SVC_Contract_HDR'].[Contract_Renewal_Contact]) as 'Contract Renewal Contact', rtrim(['SVC_Contract_HDR'].[Contract_Response_Time]) as 'Contract Response Time', ['SVC_Contract_HDR'].[Contract_Transfer_Date] as 'Contract Transfer Date', 'Contract Transfer Status' = dbo.FS_FUNC_Contract_Transfer_Status(['SVC_Contract_HDR'].[Contract_Transfer_Status]), rtrim(['SVC_Contract_HDR'].[CNTTYPE]) as 'Contract Type', rtrim(['SVC_Contract_HDR'].[COUNTRY]) as 'Country', 'Credit Hold' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[Credit_Hold]), rtrim(['SVC_Contract_HDR'].[CURNCYID]) as 'Currency ID', ['SVC_Contract_HDR'].[CURRNIDX] as 'Currency Index', rtrim(['RM Customer MSTR'].[CUSTNAME]) as 'Customer Name', 'Decimal Places' = dbo.DYN_FUNC_Decimal_Places_QTYS(['SVC_Contract_HDR'].[DECPLACS]), ['SVC_Contract_HDR'].[DENXRATE] as 'Denomination Exchange Rate', rtrim(['SVC_Contract_HDR'].[DSCRIPTN]) as 'Description', ['SVC_Contract_HDR'].[DSCDLRAM] as 'Discount Dollar Amount', ['SVC_Contract_HDR'].[DSCPCTAM]/100.00 as 'Discount Percent Amount', ['SVC_Contract_HDR'].[ENTDTE] as 'Entry Date', ['SVC_Contract_HDR'].[ENTTME] as 'Entry Time', 'Evergreen Contract' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[SVC_Evergreen_Contract]), ['SVC_Contract_HDR'].[SVC_Evergreen_RenewLimit] as 'Evergreen Renew Limit', ['SVC_Contract_HDR'].[SVC_Evergreen_Renewals] as 'Evergreen Renewals', ['SVC_Contract_HDR'].[EXCHDATE] as 'Exchange Date', ['SVC_Contract_HDR'].[XCHGRATE] as 'Exchange Rate', rtrim(['SVC_Contract_HDR'].[EXGTBLID]) as 'Exchange Table ID', ['SVC_Contract_HDR'].[EXPNDATE] as 'Expiration Date', ['SVC_Contract_HDR'].[FRSTBLDTE] as 'First Bill Date', ['SVC_Contract_HDR'].[FRZEND] as 'Frozen End', ['SVC_Contract_HDR'].[FRXSTRT] as 'Frozen Start', ['SVC_Contract_HDR'].[ISMCTRX] as 'IS MC Trx', ['SVC_Contract_HDR'].[Invoiced_Amount] as 'Invoiced Amount', ['SVC_Contract_HDR'].[LABPCT] as 'Labor Pct', ['SVC_Contract_HDR'].[Last_Amount_Billed] as 'Last Amount Billed', ['SVC_Contract_HDR'].[LSTBLDTE] as 'Last Bill Date', ['SVC_Contract_HDR'].[Last_Liability_Date] as 'Last Liability Date', ['SVC_Contract_HDR'].[Liability_Amount] as 'Liability Amount', ['SVC_Contract_HDR'].[Liability_Months] as 'Liability Months', 'Liability Reduction' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[Liabiltiy_Reduction]), rtrim(['SVC_Contract_HDR'].[Location_Segment]) as 'Location Segment', ['SVC_Contract_HDR'].[MCTRXSTT] as 'MC Transaction State', rtrim(['SVC_Contract_HDR'].[MSTCNTRCT]) as 'Master Contract Number', ['SVC_Contract_HDR'].[MAXBILL] as 'Max Billable', ['SVC_Contract_HDR'].[MAXBIL] as 'Max Billable Call', ['SVC_Contract_HDR'].[MXINCPCT] as 'Max Increase Percentage', ['SVC_Contract_HDR'].[NBRCAL] as 'Max Number of Calls', ['SVC_Contract_HDR'].[MINBIL] as 'Min Billable Call', ['SVC_Contract_HDR'].[MISCPCT] as 'Misc Pct', 'New PO Required' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[New_PO_Required]), ['SVC_Contract_HDR'].[NXTBLDTE] as 'Next Bill Date', ['SVC_Contract_HDR'].[Next_Liability_Date] as 'Next Liability Date', ['SVC_Contract_HDR'].[NOTEINDX] as 'Note Index', ['SVC_Contract_HDR'].[NUMOFINV] as 'Number of Invoices', ['SVC_Contract_HDR'].[Orig_Amount_To_Invoice] as 'Originating Amount To Invoice',  ['SVC_Contract_HDR'].[ORCOMAMT] as 'Originating Commission Dollar Amount', ['SVC_Contract_HDR'].[ORDDLRAT] as 'Originating Discount Dollar Amount', ['SVC_Contract_HDR'].[OrigDiscountNext] as 'Originating Discount Next', ['SVC_Contract_HDR'].[OrigDiscountReceived] as 'Originating Discount Recognized', ['SVC_Contract_HDR'].[OrigDiscountRemaining] as 'Originating Discount Remaining', ['SVC_Contract_HDR'].[Orig_Invoiced_Amount] as 'Originating Invoiced Amount', ['SVC_Contract_HDR'].[ORIGLASTAmountBilled] as 'Originating Last Amount Billed', ['SVC_Contract_HDR'].[Orig_Liability_Amount] as 'Originating Liability Amount', ['SVC_Contract_HDR'].[Originating_Max_Billable] as 'Originating Max Billable', ['SVC_Contract_HDR'].[ORIGMAXBIL] as 'Originating Max Billable Call', ['SVC_Contract_HDR'].[ORIGMINBIL] as 'Originating Min Billable Call', ['SVC_Contract_HDR'].[ORIGRETNAGAM] as 'Originating Retainage Amount', ['SVC_Contract_HDR'].[ORIGRTNBILLD] as 'Originating Retainage Billed', ['SVC_Contract_HDR'].[Orig_SVC_Invoiced_Cost] as 'Originating SVC Invoiced Cost', ['SVC_Contract_HDR'].[ORIGTOTAL] as 'Originating Service Total', ['SVC_Contract_HDR'].[ORIGTOTBIL] as 'Originating Total Billed', ['SVC_Contract_HDR'].[OrigTotLiabilityAmount] as 'Originating Total Liability Amount', ['SVC_Contract_HDR'].[OrigTotLiabBilled] as 'Originating Total Liability Billed', ['SVC_Contract_HDR'].[Originating_Total_Unit] as 'Originating Total Unit', ['SVC_Contract_HDR'].[ORIGTOTVALCAL] as 'Originating Total Value of Calls', ['SVC_Contract_HDR'].[ORIGVALTIM] as 'Originating Value of Time', ['SVC_Contract_HDR'].[PMLABPCT] as 'PM Labor Pct', ['SVC_Contract_HDR'].[PMMSCPCT] as 'PM Misc Pct', ['SVC_Contract_HDR'].[PMPRTPCT] as 'PM Part Pct', ['SVC_Contract_HDR'].[PARTPCT] as 'Part Pct', ['SVC_Contract_HDR'].[PCTCRYFWD] as 'Percentage Carried Forward', 'Pre Paid' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[PREPAID]), rtrim(['SVC_Contract_HDR'].[PRICSHED]) as 'Price Schedule', ['SVC_Contract_HDR'].[priorityLevel] as 'priorityLevel', rtrim(['SVC_Contract_HDR'].[PORDNMBR]) as 'Purchase Order Number', ['SVC_Contract_HDR'].[QUOEXPDA] as 'Quote Expiration Date', ['SVC_Contract_HDR'].[RATECALC] as 'Rate Calc Method', rtrim(['SVC_Contract_HDR'].[RATETPID]) as 'Rate Type ID', 'Renewing Contract Type' = dbo.FS_FUNC_Renewing_Contract_Type(['SVC_Contract_HDR'].[RENCNTTYP]), rtrim(['SVC_Contract_HDR'].[RENPRCSCHD]) as 'Renewing Price Schedule', ['SVC_Contract_HDR'].[RETNAGAM] as 'Retainage Amount', ['SVC_Contract_HDR'].[RTNBILLD] as 'Retainage Billed', rtrim(['SVC_Contract_HDR'].[SVC_Bill_To_Address_Code]) as 'SVC Bill To Address Code', ['SVC_Contract_HDR'].[SVC_Contract_Signed] as 'SVC_Contract_Signed', rtrim(['SVC_Contract_HDR'].[Created_User_ID]) as 'SVC_Created User ID', ['SVC_Contract_HDR'].[SVC_Discount_Next] as 'SVC Discount Next', ['SVC_Contract_HDR'].[SVC_Discount_Recognized] as 'SVC Discount Recognized', ['SVC_Contract_HDR'].[SVC_Discount_Remaining] as 'SVC Discount Remaining', rtrim(['SVC_Contract_HDR'].[SVC_FO_ID]) as 'SVC FO ID', 'SVC Invoice Detail' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[SVC_Invoice_Detail]), ['SVC_Contract_HDR'].[SVC_Invoiced_Cost] as 'SVC Invoiced Cost', rtrim(['SVC_Contract_HDR'].[SVC_New_Contract_Number]) as 'SVC New Contract Number', 'SVC Paid Contract' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[SVC_Paid_Contract]), rtrim(['SVC_Contract_HDR'].[RETTYPE]) as 'SVC Return Type', 'SVC Use Same Number' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[SVC_Use_Same_Number]), rtrim(['SVC_Contract_HDR'].[SLPRSNID]) as 'Salesperson ID', rtrim(['SVC_Contract_HDR'].[SRVTYPE]) as 'Service Type', 'Smooth Invoice Calculation' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[SmoothInvoiceCalc]), 'Smooth Revenue Calculation' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[SmoothRevenueCalc]), rtrim(['SVC_Contract_HDR'].[Source_Contract_Number]) as 'Source Contract Number', 'Source Contract Type' = dbo.FS_FUNC_Source_Contract_Type(['SVC_Contract_HDR'].[Source_Contract_Type]), rtrim(['SVC_Contract_HDR'].[Source_User_ID]) as 'Source User ID', rtrim(['SVC_Contract_HDR'].[PRCSTAT]) as 'Status of Price', rtrim(['SVC_Contract_HDR'].[TAXEXMT1]) as 'Tax Exempt 1', rtrim(['SVC_Contract_HDR'].[TAXEXMT2]) as 'Tax Exempt 2', rtrim(['SVC_Contract_HDR'].[TAXSCHID]) as 'Tax Schedule ID', ['SVC_Contract_HDR'].[TIME1] as 'Time', rtrim(['SVC_Contract_HDR'].[TIMEZONE]) as 'TimeZone', ['SVC_Contract_HDR'].[TOTBIL] as 'Total Billed', ['SVC_Contract_HDR'].[Total_Liability_Amount] as 'Total Liability Amount', ['SVC_Contract_HDR'].[Total_Liability_Billed] as 'Total Liability Billed', ['SVC_Contract_HDR'].[Total_Unit] as 'Total Unit', ['SVC_Contract_HDR'].[TOTVALCAL] as 'Total Value of Calls', rtrim(['SVC_Contract_HDR'].[UOFM]) as 'U Of M', 'Use Coverage Period' = dbo.DYN_FUNC_Boolean_All(['SVC_Contract_HDR'].[USECVPD_1]), rtrim(['SVC_Contract_HDR'].[USERDEF1]) as 'User Defined 1', rtrim(['SVC_Contract_HDR'].[USERDEF2]) as 'User Defined 2', rtrim(['SVC_Contract_HDR'].[USRDEF03]) as 'User Defined 3', rtrim(['SVC_Contract_HDR'].[USRDEF04]) as 'User Defined 4', rtrim(['SVC_Contract_HDR'].[USRDEF05]) as 'User Defined 5', ['SVC_Contract_HDR'].[VALTIM] as 'Value of Time', rtrim(['SVC_Contract_HDR'].[VENDORID]) as 'Vendor ID', ['SVC_Contract_HDR'].[VIEWMODE] as 'View Mode',  'Customer ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCustomerID(1,['SVC_Contract_HDR'].[CUSTNMBR] ), 'Salesperson ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppSalespersonID(1,['SVC_Contract_HDR'].[SLPRSNID],2 ), 'Vendor ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppVendorID(1,['SVC_Contract_HDR'].[VENDORID] )         from [SVC00600] as ['SVC_Contract_HDR'] with (NOLOCK) left outer join [RM00101] as ['RM Customer MSTR'] with (NOLOCK) on ['SVC_Contract_HDR'].[CUSTNMBR] = ['RM Customer MSTR'].[CUSTNMBR] left outer join [RM00101] as ['RM Customer MSTR2'] with (NOLOCK) on ['SVC_Contract_HDR'].[Bill_To_Customer] = ['RM Customer MSTR2'].[CUSTNMBR] 
GO
GRANT SELECT ON  [dbo].[Contracts] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[Contracts] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[Contracts] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[Contracts] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[Contracts] TO [rpt_customer service rep]
GO
GRANT SELECT ON  [dbo].[Contracts] TO [rpt_dispatcher]
GO
GRANT SELECT ON  [dbo].[Contracts] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[Contracts] TO [rpt_project manager]
GO
