SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[ReqIVHeaderView] AS   
select   
	1 "TrxState", -- WORK   
 	BACHNUMB,  
 	BCHSOURC, 
	(SELECT CREATDDT FROM SY00500 WHERE IV10000.BACHNUMB = SY00500.BACHNUMB AND IV10000.BCHSOURC = SY00500.BCHSOURC) "BatchCreatedDate", 
	(SELECT TIME1 FROM SY00500 WHERE IV10000.BACHNUMB = SY00500.BACHNUMB AND IV10000.BCHSOURC = SY00500.BCHSOURC) "BatchCreatedTime", 
 	IVDOCNBR,  
 	IVDOCTYP, 
 	DOCDATE,   
	'1900-01-01T00:00:00.000' "CREATDDT", 
 	DEX_ROW_TS,   
 	NULL "TRXSORCE",   
	GLPOSTDT, 
 	DEX_ROW_ID   
from   
 	IV10000   
   
union all   
   
select   
 	3 "TrxState", -- HISTORY   
 	BACHNUMB,   
 	BCHSOURC, 
 	'', --BatchCreatedDate 
	'', --BatchCreatedTime 
 	DOCNUMBR,   
 	IVDOCTYP, 
 	DOCDATE,   
	'1900-01-01T00:00:00.000' "CREATDDT", 
 	DEX_ROW_TS, 
 	TRXSORCE,   
	GLPOSTDT, 
 	DEX_ROW_ID   
from   
 	IV30200   
GO
GRANT SELECT ON  [dbo].[ReqIVHeaderView] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[ReqIVHeaderView] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[ReqIVHeaderView] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[ReqIVHeaderView] TO [DYNGRP]
GO
