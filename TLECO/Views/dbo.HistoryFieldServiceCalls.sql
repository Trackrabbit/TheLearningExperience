SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[HistoryFieldServiceCalls] AS select rtrim(['Service Call Master History'].[CALLNBR]) as 'Service Call Number', 'Service Record Type' = dbo.FS_FUNC_Service_Record_Type(['Service Call Master History'].[SRVRECTYPE]), rtrim(['Service Call Master History'].[SRVSTAT]) as 'Service Call Status', rtrim(['Service Call Master History'].[SRVTYPE]) as 'Service Type', rtrim(['Service Call Master History'].[SVCDESCR]) as 'Service Description', ['Service Call Master History'].[priorityLevel] as 'priorityLevel', rtrim(['RM Customer MSTR'].[CUSTNMBR]) as 'Customer ID', rtrim(['Service Call Master History'].[Customer_Reference]) as 'Customer Reference', rtrim(['Service Call Master History'].[ADRSCODE]) as 'Address Code', rtrim(['RM Customer MSTR'].[CUSTNAME]) as 'Name', rtrim(['Service Call Master History'].[OFFID]) as 'Office ID', rtrim(['Service Call Master History'].[SVCAREA]) as 'Service Area', rtrim(['Service Call Master History'].[TECHID]) as 'Tech ID', ['Service Call Master History'].[ENTDTE] as 'Entry Date', ['Service Call Master History'].[TOTAL] as 'Total',  rtrim(['Service Call Master History'].[ADDRESS1]) as 'Address 1', rtrim(['Service Call Master History'].[ADDRESS2]) as 'Address 2', rtrim(['Service Call Master History'].[ADDRESS3]) as 'Address 3', ['Service Call Master History'].[ARRIVDTE] as 'Arrival Date', ['Service Call Master History'].[ARRIVTME] as 'Arrival Time', rtrim(['RM Customer MSTR2'].[CUSTNMBR]) as 'Bill To Customer ID', rtrim(['RM Customer MSTR2'].[CUSTNAME]) as 'Bill To Customer Name', 'Callback' = dbo.DYN_FUNC_Boolean_All(['Service Call Master History'].[Callback]), rtrim(['Service Call Master History'].[CITY]) as 'City', ['Service Call Master History'].[COMPDTE] as 'Complete Date', ['Service Call Master History'].[COMPTME] as 'Complete Time', rtrim(['Service Call Master History'].[CNTCPRSN]) as 'Contact Person', rtrim(['Service Call Master History'].[CONTNBR]) as 'Contract Number', 'Contract Record Type' = dbo.FS_FUNC_Contract_Record_Type(['Service Call Master History'].[CONSTS]), rtrim(['Service Call Master History'].[COUNTRY]) as 'Country', rtrim(['Service Call Master History'].[CURNCYID]) as 'Currency ID', ['Service Call Master History'].[CURRNIDX] as 'Currency Index', 'Decimal Places' = dbo.DYN_FUNC_Decimal_Places_QTYS(['Service Call Master History'].[DECPLACS]), ['Service Call Master History'].[DENXRATE] as 'Denomination Exchange Rate', ['Service Call Master History'].[DISPDTE] as 'Dispatch Date', ['Service Call Master History'].[DISPTME] as 'Dispatch Time', ['Service Call Master History'].[ETADTE] as 'ETA Date', ['Service Call Master History'].[ETATME] as 'ETA Time', ['Service Call Master History'].[ETTR] as 'ETTR', ['Service Call Master History'].[ENTTME] as 'Entry Time', rtrim(['Serial Master'].[SERLNMBR]) as 'Equipment/Serial Number', ['Service Call Master History'].[ESCDATE] as 'Escalation Date', ['Service Call Master History'].[Escalation_Level] as 'Escalation Level', ['Service Call Master History'].[ESCTIME] as 'Escalation Time', ['Service Call Master History'].[EXCHDATE] as 'Exchange Date', ['Service Call Master History'].[XCHGRATE] as 'Exchange Rate', rtrim(['Service Call Master History'].[EXGTBLID]) as 'Exchange Table ID', ['Service Call Master History'].[EXPNDATE] as 'Expiration Date', ['Service Call Master History'].[ISMCTRX] as 'IS MC Trx', ['Service Call Master History'].[Invoiced_Amount] as 'Invoiced Amount', rtrim(['Service Call Equipment History'].[ITEMNMBR]) as 'Item Number', ['Service Call Master History'].[LABPCT] as 'Labor Pct', ['Service Call Master History'].[LABSTOTCST] as 'Labor Sub Total Cost', ['Service Call Master History'].[LABSTOTPRC] as 'Labor Sub Total Price', ['Service Call Master History'].[MCTRXSTT] as 'MC Transaction State', rtrim(['Service Call Master History'].[MSTRCALLNBR]) as 'Master Service Call Number', 'Master Service Record Type' = dbo.FS_FUNC_Master_Service_Record_Type(['Service Call Master History'].[MSTRRECTYPE]), ['Service Call Master History'].[METER1] as 'Meter 1', ['Service Call Master History'].[METER2] as 'Meter 2', ['Service Call Master History'].[METER3] as 'Meter 3', ['Service Call Master History'].[Meter_Internal_Uses_1] as 'Meter Internal Uses', ['Service Call Master History'].[Meters_1] as 'Meters', ['Service Call Master History'].[MISCPCT] as 'Misc Pct', ['Service Call Master History'].[MISSTOTCST] as 'Misc Sub Total Cost', ['Service Call Master History'].[MSCSTOTPRC] as 'Misc Sub Total Price', ['Service Call Master History'].[NOTEINDX] as 'Note Index', ['Service Call Master History'].[Notify_Date] as 'Notify Date', 'Notify Flag' = dbo.DYN_FUNC_Boolean_All(['Service Call Master History'].[NOTFYFLAG]), ['Service Call Master History'].[Notify_Time] as 'Notify Time', ['Service Call Master History'].[Orig_Invoiced_Amount] as 'Originating Invoiced Amount', ['Service Call Master History'].[ORIGLABSUBTOTCOST] as 'Originating Labor Sub Total Cost', ['Service Call Master History'].[ORIGLABSTOTPRC] as 'Originating Labor Sub Total Price', ['Service Call Master History'].[ORIGMISSTOTCST] as 'Originating Misc Sub Total Cost', ['Service Call Master History'].[ORIGMSCSTOTPRC] as 'Originating Misc Sub Total Price', ['Service Call Master History'].[ORIGPARSTOTCST] as 'Originating Part Sub Total Cost', ['Service Call Master History'].[ORIGPARSTOTPRC] as 'Originating Part Sub Total Price', ['Service Call Master History'].[ORIGPRETAXTOT] as 'Originating PreTax Total',  ['Service Call Master History'].[ORIGTOTAL] as 'Originating Service Total', ['Service Call Master History'].[ORTAXAMT] as 'Originating Tax Amount', ['Service Call Master History'].[PARTPCT] as 'Part Pct', ['Service Call Master History'].[PARSTOTCST] as 'Part Sub Total Cost', ['Service Call Master History'].[PARSTOTPRC] as 'Part Sub Total Price', rtrim(['Service Call Master History'].[PYMTRMID]) as 'Payment Terms ID', rtrim(['Service Call Master History'].[PHONE1]) as 'Phone 1', ['Service Call Master History'].[PRETAXTOT] as 'PreTax Total', rtrim(['Service Call Master History'].[PRICELVL]) as 'Price Level', 'Print to Web' = dbo.DYN_FUNC_Boolean_All(['Service Call Master History'].[Print_to_Web]), rtrim(['Service Call Master History'].[ProjectRef1_1]) as 'ProjectRef1', rtrim(['Service Call Master History'].[PROJCTID]) as 'Project ID', rtrim(['Service Call Master History'].[PORDNMBR]) as 'Purchase Order Number', ['Service Call Master History'].[RATECALC] as 'Rate Calc Method', rtrim(['Service Call Master History'].[RATETPID]) as 'Rate Type ID', rtrim(['Service Call Master History'].[Replaces_1]) as 'Replaces', ['Service Call Master History'].[Response_Date] as 'Response Date', ['Service Call Master History'].[Response_Time] as 'Response Time', rtrim(['Service Call Master History'].[SVC_Bill_To_Address_Code]) as 'SVC Bill To Address Code', ['Service Call Master History'].[SVC_Contract_Line_SEQ] as 'SVC_Contract_Line_SEQ_Number', rtrim(['Service Call Master History'].[SVC_FO_ID]) as 'SVC FO ID', 'SVC On Hold' = dbo.DYN_FUNC_Boolean_All(['Service Call Master History'].[SVC_On_Hold]), 'SVC_Pre600' = dbo.DYN_FUNC_Boolean_All(['Service Call Master History'].[SVC_Pre600]), rtrim(['Service Call Master History'].[SLPRSNID]) as 'Salesperson ID', rtrim(['Service Call Master History'].[SPLTTERMS]) as 'Split Terms Code', rtrim(['Service Call Master History'].[STATE]) as 'State', ['Service Call Master History'].[TAXAMNT] as 'Tax Amount', rtrim(['Service Call Master History'].[TAXEXMT1]) as 'Tax Exempt 1', rtrim(['Service Call Master History'].[TAXEXMT2]) as 'Tax Exempt 2', rtrim(['Service Call Master History'].[TAXSCHID]) as 'Tax Schedule ID', ['Service Call Master History'].[TIME1] as 'Time', rtrim(['Service Call Master History'].[TIMEZONE]) as 'TimeZone', rtrim(['Service Call Master History'].[USERDEF1]) as 'User Defined 1', rtrim(['Service Call Master History'].[USERDEF2]) as 'User Defined 2', rtrim(['Service Call Master History'].[USRDEF03]) as 'User Defined 3', rtrim(['Service Call Master History'].[USRDEF04]) as 'User Defined 4', rtrim(['Service Call Master History'].[USRDEF05]) as 'User Defined 5', ['Service Call Master History'].[VIEWMODE] as 'View Mode', rtrim(['Service Call Master History'].[ZIP]) as 'Zip',  'Customer ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppCustomerID(1,['RM Customer MSTR'].[CUSTNMBR] ), 'Item Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppItemID(1,['Service Call Equipment History'].[ITEMNMBR],'' ), 'Salesperson ID For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=0' +dbo.dgppSalespersonID(1,['Service Call Master History'].[SLPRSNID],2 ), 'Service Call Number For Drillback' = 'dgpp://DGPB/?Db=&Srv=TLEFLSQL3&Cmp=TLECO&Prod=949' +dbo.dgppServiceRecordType(1,['Service Call Master History'].[CALLNBR],['Service Call Master History'].[SRVRECTYPE] )         from [SVC30200] as ['Service Call Master History'] with (NOLOCK) left outer join [RM00101] as ['RM Customer MSTR'] with (NOLOCK) on ['Service Call Master History'].[CUSTNMBR] = ['RM Customer MSTR'].[CUSTNMBR] left outer join [SVC30202] as ['Service Call Equipment History'] with (NOLOCK) on ['Service Call Master History'].[SRVRECTYPE] = ['Service Call Equipment History'].[SRVRECTYPE]  and ['Service Call Master History'].[CALLNBR] = ['Service Call Equipment History'].[CALLNBR] left outer join [RM00101] as ['RM Customer MSTR2'] with (NOLOCK) on ['Service Call Master History'].[Bill_To_Customer] = ['RM Customer MSTR2'].[CUSTNMBR] left outer join [SVC00300] as ['Serial Master'] with (NOLOCK) on ['Service Call Equipment History'].[EQUIPID] = ['Serial Master'].[EQUIPID] 
GO
GRANT SELECT ON  [dbo].[HistoryFieldServiceCalls] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[HistoryFieldServiceCalls] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[HistoryFieldServiceCalls] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[HistoryFieldServiceCalls] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[HistoryFieldServiceCalls] TO [rpt_customer service rep]
GO
GRANT SELECT ON  [dbo].[HistoryFieldServiceCalls] TO [rpt_dispatcher]
GO
GRANT SELECT ON  [dbo].[HistoryFieldServiceCalls] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[HistoryFieldServiceCalls] TO [rpt_project manager]
GO
