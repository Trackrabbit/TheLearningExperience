SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
-- SO Line View unioning SOP10200 and SOP30300 
 
CREATE VIEW [dbo].[ReqSOLineView] AS 
select  
	SOP10200.SOPTYPE, 
	SOP10200.SOPNUMBE, 
	SOP10200.LNITMSEQ, 
	SOP10200.CMPNTSEQ, 
	ITEMNMBR, 
	ITEMDESC, 
	NONINVEN, 
	DROPSHIP, 
	UOFM, 
	LOCNCODE, 
	UNITCOST, 
	ORUNTCST, 
	UNITPRCE, 
	ORUNTPRC, 
	XTNDPRCE, 
	OXTNDPRC, 
	EXTDCOST, 
	OREXTCST, 
	MRKDNAMT, 
	ORMRKDAM, 
	MRKDNPCT, 
	MRKDNTYP, 
	ITMTSHID, 
	IVITMTXB, 
	TAXAMNT, 
	ORTAXAMT, 
	QUANTITY, 
	ATYALLOC, 
	QTYTBAOR, 
	QTYTOINV, 
	QTYTORDR, 
	QTYCANCE, 
	QTYFULFI, 
	ReqShipDate, 
	FUFILDAT, 
	ACTLSHIP, 
	SHIPMTHD, 
	SALSTERR, 
	SLPRSNID, 
	PRCLEVEL, 
	COMMNTID, 
	TAXSCHID, 
	PRSTADCD, 
	ShipToName, 
	CNTCPRSN, 
	ADDRESS1, 
	ADDRESS2, 
	ADDRESS3, 
	CITY, 
	STATE, 
	ZIPCODE, 
	COUNTRY, 
	CCode, 
	PHONE1, 
	PHONE2, 
	PHONE3, 
	FAXNUMBR, 
	SOP10202.CMMTTEXT, 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP10200.CSLSINDX) "CSLSACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP10200.DMGDINDX) "DMGDACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP10200.INSRINDX) "INSRACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP10200.INUSINDX) "INUSACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP10200.INVINDX) "INVACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP10200.MKDNINDX) "MKDNACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP10200.RTNSINDX) "RTNSACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP10200.SLSINDX) "SLSACTNUMST", 
	DECPLCUR, 
	ODECPLCU, 
	DECPLQTY, 
	GPSFOINTEGRATIONID, 
	INTEGRATIONSOURCE, 
	INTEGRATIONID, 
	 
	-- Additional Columns are for Sales Return 
	QTYINSVC, 
	QTYINUSE, 
	QTYDMGED, 
	QTYRTRND, 
	QTYONHND 
 
from 
	SOP10200 left outer join SOP10202 on (SOP10200.SOPTYPE = SOP10202.SOPTYPE and SOP10200.SOPNUMBE = SOP10202.SOPNUMBE and SOP10200.LNITMSEQ = SOP10202.LNITMSEQ) 
where 
	SOP10200.CMPNTSEQ = 0 
 
union all 
 
select 
	SOP30300.SOPTYPE, 
	SOP30300.SOPNUMBE, 
	SOP30300.LNITMSEQ, 
	SOP30300.CMPNTSEQ, 
	ITEMNMBR, 
	ITEMDESC, 
	NONINVEN, 
	DROPSHIP, 
	UOFM, 
	LOCNCODE, 
	UNITCOST, 
	ORUNTCST, 
	UNITPRCE, 
	ORUNTPRC, 
	XTNDPRCE, 
	OXTNDPRC, 
	EXTDCOST, 
	OREXTCST, 
	MRKDNAMT, 
	ORMRKDAM, 
	MRKDNPCT, 
	MRKDNTYP, 
	ITMTSHID, 
	IVITMTXB, 
	TAXAMNT, 
	ORTAXAMT, 
	QUANTITY, 
	ATYALLOC, 
	QTYTBAOR, 
	QTYTOINV, 
	QTYTORDR, 
	QTYCANCE, 
	QTYFULFI, 
	ReqShipDate, 
	FUFILDAT, 
	ACTLSHIP, 
	SHIPMTHD, 
	SALSTERR, 
	SLPRSNID, 
	PRCLEVEL, 
	COMMNTID, 
	TAXSCHID, 
	PRSTADCD, 
	ShipToName, 
	CNTCPRSN, 
	ADDRESS1, 
	ADDRESS2, 
	ADDRESS3, 
	CITY, 
	STATE, 
	ZIPCODE, 
	COUNTRY, 
	CCode, 
	PHONE1, 
	PHONE2, 
	PHONE3, 
	FAXNUMBR, 
	SOP10202.CMMTTEXT, 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP30300.CSLSINDX) "CSLSACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP30300.DMGDINDX) "DMGDACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP30300.INSRINDX) "INSRACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP30300.INUSINDX) "INUSACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP30300.INVINDX) "INVACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP30300.MKDNINDX) "MKDNACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP30300.RTNSINDX) "RTNSACTNUMST", 
	(select ACTNUMST from GL00105 where GL00105.ACTINDX = SOP30300.SLSINDX) "SLSACTNUMST", 
	DECPLCUR, 
	ODECPLCU, 
	DECPLQTY, 
	'', 		-- GPSFOINTEGRATIONID, 
	0, 		-- INTEGRATIONSOURCE, 
	'', 		-- INTEGRATIONID, 
 
	-- Additional Columns are for Sales Return 
	QTYINSVC, 
	QTYINUSE, 
	QTYDMGED, 
	QTYRTRND, 
	QTYONHND 
 
from  
	SOP30300 left outer join SOP10202 on (SOP30300.SOPTYPE = SOP10202.SOPTYPE and SOP30300.SOPNUMBE = SOP10202.SOPNUMBE and SOP30300.LNITMSEQ = SOP10202.LNITMSEQ) 
where 
	SOP30300.CMPNTSEQ = 0 
 
GO
GRANT SELECT ON  [dbo].[ReqSOLineView] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[ReqSOLineView] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[ReqSOLineView] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[ReqSOLineView] TO [DYNGRP]
GO
