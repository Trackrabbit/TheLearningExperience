SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE VIEW [dbo].[EmployeeTimecardPending] AS  SELECT        TOP (100) PERCENT TH.EMPLOYID, TH.Pay_Schedule, TH.YEAR1, TH.PERIODID, MAX(SD.PERNAME) AS PERNAME, MAX(SD.STRTDATE) AS STRTDATE, MAX(SD.ENDDATE) AS ENDDATE, 0 AS Group_ID,   '' AS LVLLABEL, MAX(E.LASTNAME) AS LASTNAME, MAX(E.FRSTNAME) AS FRSTNAME, MAX(E.MIDLNAME) AS MIDLNAME, MAX(E.EMPLSUFF) AS EMPLSUFF, MAX(ISNULL(S.EMPLOYID, ''))   AS Supervisor_Employee_ID, MAX(E.USERID) AS USERID, MAX(E.SUPERVISORCODE_I) AS SUPERVISORCODE_I, MAX(ISNULL(S.SUPERVISOR, '')) AS SUPERVISOR, MAX(ISNULL(ADD1.PHONE1, '')) AS PHONE1,   MAX(ISNULL(ADD2.PHONE2, '')) AS PHONE2, ISNULL(LEFT(LTRIM(RTRIM(MAX(SUP.LASTNAME))) + ', ' + LTRIM(RTRIM(MAX(SUP.FRSTNAME))) + ' ' + LTRIM(RTRIM(MAX(SUP.MIDLNAME))), 40), '') AS EMPLNAME,   SUM(TD.UNTSTOPY) AS UNTSTOPY, MAX(SH.PAYPEROD) AS PAYPEROD, 0 AS InfoValue, 0 AS MKTOPROC, MAX(TH.Workflow_Status) AS Workflow_Status, MAX(E.DEPRTMNT) AS DEPRTMNT, MAX(E.JOBTITLE)   AS JOBTITLE, MAX(E.LOCATNID) AS LOCATNID, MAX(E.DIVISIONCODE_I) AS DIVISIONCODE_I, '' AS CMMTTEXT FROM            dbo.UPR10500 AS TH INNER JOIN  dbo.UPR10501 AS TD ON TH.EMPLOYID = TD.EMPLOYID AND TH.Pay_Schedule = TD.Pay_Schedule AND TH.YEAR1 = TD.YEAR1 AND TH.PERIODID = TD.PERIODID INNER JOIN  dbo.UPR42101 AS SD ON SD.Pay_Schedule = TH.Pay_Schedule AND SD.YEAR1 = TH.YEAR1 AND SD.PERIODID = TH.PERIODID INNER JOIN  dbo.UPR42100 AS SH ON SH.Pay_Schedule = SD.Pay_Schedule INNER JOIN  dbo.UPR00100 AS E ON E.EMPLOYID = TH.EMPLOYID LEFT OUTER JOIN  dbo.UPR00102 AS ADD1 ON E.EMPLOYID = ADD1.EMPLOYID AND E.ADRSCODE = ADD1.ADRSCODE LEFT OUTER JOIN  dbo.UPR41700 AS S ON E.SUPERVISORCODE_I = S.SUPERVISORCODE_I LEFT OUTER JOIN  dbo.UPR00100 AS SUP ON S.EMPLOYID = SUP.EMPLOYID LEFT OUTER JOIN  dbo.UPR00102 AS ADD2 ON ADD2.EMPLOYID = S.EMPLOYID AND ADD2.ADRSCODE = SUP.ADRSCODE WHERE        (TH.Workflow_Status = 4) GROUP BY TH.EMPLOYID, TH.Pay_Schedule, TH.YEAR1, TH.PERIODID    
GO
GRANT SELECT ON  [dbo].[EmployeeTimecardPending] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[EmployeeTimecardPending] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[EmployeeTimecardPending] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[EmployeeTimecardPending] TO [DYNGRP]
GO
