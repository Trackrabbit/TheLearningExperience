SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[PositionControl] AS select rtrim(['Position Plans'].[PLANCODE]) as 'Plan Code', rtrim(['Position Plans'].[DSCRIPTN]) as 'Plan Code Description', ['Position Plans'].[STRTDATE] as 'Plan Start Date', ['Position Plans'].[ENDDATE] as 'Plan End Date', rtrim(['PC Position Setup'].[JOBTITLE]) as 'Position Code', rtrim(['PC Position Setup'].[DSCRIPTN]) as 'Position Code Description',  'Accrue Sick Time' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[ACRUSTIM]), 'Accrue Vacation' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[ACRUVACN]), 'Assignment Status' = dbo.HR_FUNC_Assignment_Status(['PC Position Seats Detail'].[ASSIGNMENTSTATUS]), 'Auto Accrue Sick Time' = dbo.DYN_FUNC_Boolean_All(['PC Position Setup'].[ATACRSTM]), 'Auto Accrue Vacation' = dbo.DYN_FUNC_Boolean_All(['PC Position Setup'].[ATACRVAC]), rtrim(['Payroll Pay Code Setup'].[BSPAYRCD]) as 'Base Pay Record', 'Base Step Increases On' = dbo.HR_FUNC_Base_Step_Increases_On(['Position Pay Codes'].[Base_Step_Increased_On]), ['Payroll Pay Code Setup'].[BSDONRTE] as 'Based On Rate', ['HR Benefit_SETP'].[BENAMOUNT_I] as 'Ben Amount', rtrim(['PC Position Benefits'].[BENEFIT]) as 'Benefit', ['HR Benefit_SETP'].[BNFBEGDT] as 'Benefit Beginning Date', rtrim(['HR Benefit_SETP'].[CHANGEBY_I]) as 'Beneficiary Index', ['HR Benefit_SETP'].[CHANGEDATE_I] as 'Benefit Change Date', ['HR Benefit_SETP'].[BENEFITDEDUCTIBLE_I] as 'Benefit Deductible', rtrim(['HR Benefit_SETP'].[DSCRIPTN]) as 'Benefit Description', ['HR Benefit_SETP'].[BNFENDDT] as 'Benefit End Date', ['HR Benefit_SETP'].[BNFFRMLA] as 'Benefit Formula', 'Benefit Frequency' = dbo.HR_FUNC_Benefit_Frequency(['HR Benefit_SETP'].[BNFTFREQ]), ['HR Benefit_SETP'].[BNFLFMAX] as 'Benefit Lifetime Max', ['HR Benefit_SETP'].[BNFTMTHD] as 'Benefit Method', ['HR Benefit_SETP'].[BNPAYPMX] as 'Benefit Pay Period Max', ['HR Benefit_SETP'].[BNFPRCNT_1] as 'Benefit Percent 1', ['HR Benefit_SETP'].[BNFPRCNT_2] as 'Benefit Percent 2', ['HR Benefit_SETP'].[BNFPRCNT_3] as 'Benefit Percent 3', ['HR Benefit_SETP'].[BNFPRCNT_4] as 'Benefit Percent 4', ['HR Benefit_SETP'].[BNFPRCNT_5] as 'Benefit Percent 5', 'Benefit Type' = dbo.HR_FUNC_Benefit_Kind(['HR Benefit_SETP'].[BENEFITKIND_I]), ['HR Benefit_SETP'].[BNFYRMAX] as 'Benefit Year Max', 'Bonus Election Active' = dbo.DYN_FUNC_Boolean_All(['HR Benefit_SETP'].[BONUSELACTIVE_I]), ['PC Position Setup'].[BUDGETBENAMOUNT] as 'Budget Benefit Amount', ['PC Position Setup'].[BUGETBENPERCENT] as 'Budget Benefit Percent', ['PC Position Setup'].[BUDGETPERMSEATAMT] as 'Budget Pemanent Seats', ['PC Position Setup'].[BUDGETTAXAMOUNT] as 'Budget Tax Amount', ['PC Position Setup'].[BUDGETTAXPERCENT] as 'Budget Tax Percent', ['PC Position Setup'].[BUDGETTEMPSEATAMT] as 'Budget Temp Seats', 'Budgeted' = dbo.DYN_FUNC_Boolean_All(['Position Pay Codes'].[BUDGETED]), ['PC Position Setup'].[BUDGETEDFTE] as 'Budgeted FTE', 'Budget Sched Start Date' = dbo.HR_FUNC_FormatDate(['PC Position Budget'].[STRTDATE]), 'Budget Sched End Date' = dbo.HR_FUNC_FormatDate(['PC Position Budget'].[ENDDATE]), ['PC Position Budget'].[BUDGETPLANAMT] as 'Budget Sched Amount', ['PC Position Budget'].[DSCRIPTN] as 'Budget Sched Description', 'Calc Min Wage Bal' = dbo.DYN_FUNC_Boolean_All(['PC Position Setup'].[Calc_Min_Wage_Bal]), rtrim(['HR Benefit_SETP'].[CARRIER]) as 'Carrier', ['PC Position Setup'].[CONTENDDTE] as 'Contract End Date', ['PC Position Setup'].[CONTSTARTDTE] as 'Contract Start Date', ['HR Benefit_SETP'].[CONTRIBDOLLAR_I] as 'Contrib Dollar', ['HR Benefit_SETP'].[CONTEMPMATCH_I] as 'Contrib Employer Match', ['HR Benefit_SETP'].[CONTRIBEMPLOYERMAX_I] as 'Contrib Employer Max', ['HR Benefit_SETP'].[CONTRIBPERCENT_I] as 'Contrib Percent', ['HR Benefit_SETP'].[COSTCOBRA_I] as 'Cost COBRA', ['HR Benefit_SETP'].[COSTEMPLOYEE_I] as 'Cost Employee', ['HR Benefit_SETP'].[COSTEMPLOYER_I] as 'Cost Employer', ['HR Benefit_SETP'].[COSTOTHER1_I] as 'Cost Other 1', ['HR Benefit_SETP'].[COSTOTHER2_I] as 'Cost Other 2', ['HR Benefit_SETP'].[COSTTOTAL_I] as 'Cost Total', rtrim(['PC Position Setup'].[CRUSRID]) as 'Created By', ['PC Position Setup'].[CREATDDT] as 'Created Date', 'Data Entry Default' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[DATAENTDFLT]), ['HR Benefit_SETP'].[DEDFRMLA] as 'Deduction Formula', ['HR Benefit_SETP'].[DEDLTMAX] as 'Deduction Lifetime Max', 'Deduction Method' = dbo.HR_FUNC_Deduction_Method(['HR Benefit_SETP'].[DEDNMTHD]), ['HR Benefit_SETP'].[DEPYPRMX] as 'Deduction Pay Period Max', ['HR Benefit_SETP'].[DEDNPRCT_1] as 'Deduction Percent 1', ['HR Benefit_SETP'].[DEDNPRCT_2] as 'Deduction Percent 2', ['HR Benefit_SETP'].[DEDNPRCT_3] as 'Deduction Percent 3', ['HR Benefit_SETP'].[DEDNPRCT_4] as 'Deduction Percent 4', ['HR Benefit_SETP'].[DEDNPRCT_5] as 'Deduction Percent 5', ['HR Benefit_SETP'].[DEDYRMAX] as 'Deduction Year Max', rtrim(['PC Position Setup'].[DEPRTMNT]) as 'Department', rtrim(['PC Position Setup'].[DIVISIONCODE_I]) as 'Division Code', 'EEO Class' = dbo.HR_FUNC_EEOClass(['PC Position Setup'].[EEOCLASS_I],(select POINTS_I from DYNAMICS.dbo.SUSPREF where IINDEX_I = 33)), rtrim(['PC Position Setup'].[EMPLCLAS]) as 'Employee Class', rtrim(['PC Position Seats Detail'].[EMPLOYID]) as 'Employee ID', 'Expired CB' = dbo.DYN_FUNC_Boolean_All(['PC Position Seats Detail'].[EXPIREDCB]), 'FLSA Status' = dbo.HR_FUNC_FLSA_Status(['PC Position Setup'].[FLSASTATUS]), ['PC Position Seats'].[FTE] as 'FTE', ['HR Benefit_SETP'].[FACTOR_I] as 'Factor', rtrim(['Payroll Employee Master'].[FRSTNAME]) as 'First Name', ['Payroll Pay Code Setup'].[FFEDTXRT] as 'Flat Federal Tax Rate', ['Payroll Pay Code Setup'].[FLSTTXRT] as 'Flat State Tax Rate', (select rtrim([ACTNUMST]) from [GL00105] as ['Account Index Master'] where ['Account Index Master'].[ACTINDX] = ['PC Position Funds'].[ACTINDX]) as 'Fund Account', ['PC Position Funds'].[FUNDSOURCE] as 'Fund Source', ['PC Position Funds'].[PRCNTAGE] as 'Fund Percentage', 'Garnishment' = dbo.DYN_FUNC_Boolean_All(['HR Benefit_SETP'].[GARNISHMENT]), rtrim(['HR Benefit_SETP'].[GROUPNUMBER_I]) as 'Group Number',  'Hardship Withdrawals' = dbo.DYN_FUNC_Boolean_All(['HR Benefit_SETP'].[HARDSHPWITHDRAW_I]), 'Inactive Benefit Employee' = dbo.DYN_FUNC_Boolean_All(['HR Benefit_SETP'].[INACTBENEMPLOYEE]), 'Inactive Benefit Employer' = dbo.DYN_FUNC_Boolean_All(['HR Benefit_SETP'].[INACTBENEMPLR]), 'Inactive Employee' = dbo.DYN_FUNC_Boolean_All(['Payroll Employee Master'].[INACTIVE]), 'Inactive HR Benefit' = dbo.DYN_FUNC_Boolean_All(['HR Benefit_SETP'].[INACTIVE]), 'Inactive PR Pay Code' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[INACTIVE]), 'Inactive Plan' = dbo.DYN_FUNC_Boolean_All(['Position Plans'].[INACTIVE]), 'Inactive Seat' = dbo.HR_FUNC_Position_Status(['PC Position Seats'].[INACTIVE] + 1), 'Inheritance Lock Status' = dbo.DYN_FUNC_Boolean_All(['PC Position Setup'].[INHERITANCELOCK]), 'Inheritance Status' = dbo.HR_FUNC_Inheritance_Status(['PC Position Seats Detail'].[INHERITSTATUS]), rtrim(['Payroll Employee Master'].[LASTNAME]) as 'Last Name', 'Loans Allowed' = dbo.DYN_FUNC_Boolean_All(['HR Benefit_SETP'].[LOANSALLOWED_I]), rtrim(['PC Position Setup'].[LOCATNID]) as 'Location ID', ['HR Benefit_SETP'].[MAJMEDCOVERAGE_I] as 'Major Medical Coverage', ['HR Benefit_SETP'].[MAXAGEDEP_I] as 'Max Age-Dep', ['HR Benefit_SETP'].[MAXAGEEMP_I] as 'Max Age-Emp', ['HR Benefit_SETP'].[MAXAGESP_I] as 'Max Age-Sp', ['HR Benefit_SETP'].[MAXOUTOFPOCKET_I] as 'Max Out-Of-Pocket', ['Payroll Pay Code Setup'].[MXPYPPER] as 'Max Pay Per Period', rtrim(['Payroll Employee Master'].[MIDLNAME]) as 'Middle Name', ['HR Benefit_SETP'].[MINAGE_I] as 'Min Age', ['HR Benefit_SETP'].[NEAREST_I] as 'Nearest', ['HR Benefit_SETP'].[NEARESTCHILD_I] as 'Nearest(Child)', ['HR Benefit_SETP'].[NEARESTEMPLOYER_I] as 'Nearest(Employer)', ['HR Benefit_SETP'].[NEARESTSPOUSE_I] as 'Nearest(Spouse)', 'PC Benefit Default Permanent Option' = dbo.HR_FUNC_Permanent_Option(['PC Position Benefits'].[DEFPERMOPTION]), 'PC Benefit Default Temporary Option' = dbo.HR_FUNC_Permanent_Option(['PC Position Benefits'].[DEFTEMPOPTION]), 'PC Pay Code Default Permanent Option' = dbo.HR_FUNC_Permanent_Option(['Position Pay Codes'].[DEFPERMOPTION]), 'PC Pay Code Default Temporary Option' = dbo.HR_FUNC_Permanent_Option(['Position Pay Codes'].[DEFTEMPOPTION]), ['Position Pay Codes'].[PAYRTAMT] as 'PC Pay Code Pay Rate', 'PC  Pay Code Primary Position/Seat' = dbo.DYN_FUNC_Boolean_All(['Position Pay Codes'].[PRIMARYPOSSEAT]), ['Payroll Pay Code Setup'].[PAYADVNC] as 'Pay Advance', rtrim(['Position Pay Codes'].[PayCode]) as 'Pay Code', rtrim(['Payroll Pay Code Setup'].[DSCRIPTN]) as 'Pay Code Description', ['Payroll Pay Code Setup'].[PAYFACTR] as 'Pay Factor', ['Payroll Pay Code Setup'].[PAYPRPRD] as 'Pay Per Period', 'Pay Period' = dbo.HR_FUNC_Benefit_Frequency(['Payroll Pay Code Setup'].[PAYPEROD]), ['Payroll Pay Code Setup'].[PAYRTAMT] as 'Pay Rate Amount', 'Pay Rate Based On' = dbo.HR_FUNC_Pay_Rate_Based_On(['PC Position Seats Detail'].[PAYRATEBASEDON]), rtrim(['Position Pay Codes'].[PYSTPTBLID]) as 'Pay Step Table ID', 'Pay Type' = dbo.HR_FUNC_Pay_Type(['Payroll Pay Code Setup'].[PAYTYPE]), rtrim(['Payroll Pay Code Setup'].[PAYUNIT]) as 'Pay Unit', 'Pay Unit Period' = dbo.HR_FUNC_Benefit_Frequency(['Payroll Pay Code Setup'].[PAYUNPER]), 'Portable Benefit' = dbo.DYN_FUNC_Boolean_All(['HR Benefit_SETP'].[PORTABLEBENEFIT_I]), rtrim(['PC Position Setup'].[CHANGEBY_I]) as 'Position Change By', ['PC Position Setup'].[CHANGEDATE_I] as 'Position Change Date', 'Position Status' = dbo.HR_FUNC_Position_Status(['PC Position Setup'].[POSSTATUS]), ['HR Benefit_SETP'].[PREMMETHOD_I] as 'Prem Method', ['HR Benefit_SETP'].[PREMIUMCHILD_I] as 'Premium Child', ['HR Benefit_SETP'].[PREMIUMEMPLOYEE_I] as 'Premium Employee', ['HR Benefit_SETP'].[PREMIUMEMPLOYER_I] as 'Premium Employer', ['HR Benefit_SETP'].[PREMIUMSMOKER_I] as 'Premium Smoker', ['HR Benefit_SETP'].[PREMIUMSPOUSE_I] as 'Premium Spouse', 'Report As Wages' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[RPTASWGS]), rtrim(['PC Position Setup'].[REPORTSTOPOS]) as 'Reports To Position', rtrim(['HR_Review_Setup_MSTR_V2'].[REVIEWSETUPNAME_I]) as 'Review Type', 'Round Up' = dbo.DYN_FUNC_Boolean_All(['HR Benefit_SETP'].[ROUNDUP_I]), ['PC Position Seats'].[SEAT] as 'Seat', 'Seat Base Step Increases On' = dbo.HR_FUNC_Base_Step_Increases_On(['PC Position Seats Detail'].[Base_Step_Increased_On]), rtrim(['PC Position Seats'].[DSCRIPTN]) as 'Seat Description', rtrim(['PC Position Seats Detail'].[PYSTPTBLID]) as 'Seat Pay Step Table ID', ['PC Position Seats Detail'].[Step] as 'Seat Step', ['PC Position Seats Detail'].[Step_Effective_Date] as 'Seat Step Effective Date', 'Seat Type' = dbo.HR_FUNC_Seat_Type(['PC Position Seats'].[TEMPSEAT]), ['PC Position Seats'].[WKHRPRYR] as 'Seat Work Hours Per Year', 'Seats End Date' = dbo.HR_FUNC_FormatDate(['PC Position Seats Detail'].[ENDDATE]), 'Seats Start Date' = dbo.HR_FUNC_FormatDate(['PC Position Seats Detail'].[STRTDATE]), ['PC Position Seats Detail'].[PAYRATE] as 'Seats Pay Rate', 'Seats Primary Position/Seat' = dbo.DYN_FUNC_Boolean_All(['PC Position Seats Detail'].[PRIMARYPOSSEAT]), ['PC Position Seats Detail'].[SEQNUMBR] as 'Sequence Number', rtrim(['Payroll Pay Code Setup'].[SHFTCODE]) as 'Shift Code', ['PC Position Setup'].[SKTMACAM] as 'Sick Time Accrual Amount', 'Sick Time Accrual Method' = dbo.DYN_FUNC_Sick_Time_Accrual_Method(['PC Position Setup'].[STMACMTH]), ['PC Position Setup'].[SKTMHPYR] as 'Sick Time Hours Per Year', rtrim(['HR_Skills_Sets'].[SKILLSET_I]) as 'Skill Set', ['Position Pay Codes'].[Step] as 'Step/Grade', ['Position Pay Codes'].[Step_Effective_Date] as 'Step Effective Date', 'Subject To Federal Tax' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[SBJTFDTX]), 'Subject To Futa' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[SBJTFUTA]),  'Subject To Local Tax' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[SBJTLTAX]), 'Subject To Medicare' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[SBJTMCAR]), 'Subject To Social Security' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[SBJTSSEC]), 'Subject To State Tax' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[SBJTSTTX]), 'Subject To Suta' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[SBJTSUTA]), rtrim(['PC Position Setup'].[SUPERVISORCODE_I]) as 'Supervisor Code', 'Taxable' = dbo.DYN_FUNC_Boolean_All(['Payroll Pay Code Setup'].[TAXABLE]), 'Tip Type' = dbo.DYN_FUNC_Tip_Type(['Payroll Pay Code Setup'].[TipType]), 'Type of Employment' = dbo.DYN_FUNC_Type_of_Employment(['PC Position Setup'].[EMPLOYMENTTYPE]), ['PC Position Setup'].[CONTACTNUM_I] as 'Union Contract Number', ['PC Position Setup'].[UNIONDUESAMOUNT_I] as 'Union Dues Amount', rtrim(['PC Position Setup'].[UNIONNAME_I]) as 'Union Name', ['PC Position Setup'].[VACCRAMT] as 'Vacation Accrual Method', 'Vacation Accrual Amount' = dbo.DYN_FUNC_Vacation_Accrual_Method(['PC Position Setup'].[VACCRMTH]), ['PC Position Setup'].[VACAPRYR] as 'Vacation Hours Per Year', rtrim(['Payroll Pay Code Setup'].[W2BXLABL]) as 'W2 Box Label', ['Payroll Pay Code Setup'].[W2BXNMBR] as 'W2 Box Number', ['HR Benefit_SETP'].[WAITINGPERIOD_I] as 'Waiting Period', 'Warn Sick Time Falls Below Zero' = dbo.DYN_FUNC_Boolean_All(['PC Position Setup'].[WRNSTFLSBLWZR]), 'Warn Vacation Falls Below Zero' = dbo.DYN_FUNC_Boolean_All(['PC Position Setup'].[WRNVCNFLSBLWZR]), rtrim(['PC Position Setup'].[WRKRCOMP]) as 'Workers Comp', (select POINTS_I from DYNAMICS.dbo.SUSPREF where IINDEX_I = 33) as 'EEO Class Preference'         from [PC40300] as ['Position Plans'] with (NOLOCK) left outer join [PC40301] as ['PC Position Setup'] with (NOLOCK) on ['Position Plans'].[PLANCODE] = ['PC Position Setup'].[PLANCODE] left outer join [DYNAMICS].[dbo].[HR2SKL05] as ['HR_Skills_Sets'] with (NOLOCK) on ['PC Position Setup'].[SKILLSETNUMBER_I] = ['HR_Skills_Sets'].[SKILLSETNUMBER_I] left outer join [RV020121] as ['HR_Review_Setup_MSTR_V2'] with (NOLOCK) on ['PC Position Setup'].[REVIEWSETUPCODE_I] = ['HR_Review_Setup_MSTR_V2'].[REVIEWSETUPCODE_I] left outer join [PC40302] as ['Position Pay Codes'] with (NOLOCK) on ['PC Position Setup'].[JOBTITLE] = ['Position Pay Codes'].[JOBTITLE]  and ['PC Position Setup'].[PLANCODE] = ['Position Pay Codes'].[PLANCODE] left outer join [UPR40600] as ['Payroll Pay Code Setup'] with (NOLOCK) on ['Position Pay Codes'].[PayCode] = ['Payroll Pay Code Setup'].[PAYRCORD] left outer join [PC40303] as ['PC Position Benefits'] with (NOLOCK) on ['PC Position Setup'].[JOBTITLE] = ['PC Position Benefits'].[JOBTITLE]  and ['PC Position Setup'].[PLANCODE] = ['PC Position Benefits'].[PLANCODE] left outer join [BE020230] as ['HR Benefit_SETP'] with (NOLOCK) on ['PC Position Benefits'].[BENEFIT] = ['HR Benefit_SETP'].[BENEFIT] left outer join [PC40304] as ['PC Position Seats'] with (NOLOCK) on ['PC Position Setup'].[JOBTITLE] = ['PC Position Seats'].[JOBTITLE]  and ['PC Position Setup'].[PLANCODE] = ['PC Position Seats'].[PLANCODE] left outer join [PC40305] as ['PC Position Seats Detail'] with (NOLOCK) on ['PC Position Seats'].[SEAT] = ['PC Position Seats Detail'].[SEAT]  and ['PC Position Seats'].[JOBTITLE] = ['PC Position Seats Detail'].[JOBTITLE]  and ['PC Position Seats'].[PLANCODE] = ['PC Position Seats Detail'].[PLANCODE] left outer join [PC40306] as ['PC Position Budget'] with (NOLOCK) on ['PC Position Setup'].[JOBTITLE] = ['PC Position Budget'].[JOBTITLE]  and ['PC Position Setup'].[PLANCODE] = ['PC Position Budget'].[PLANCODE] left outer join [PC40307] as ['PC Position Funds'] with (NOLOCK) on ['PC Position Setup'].[JOBTITLE] = ['PC Position Funds'].[JOBTITLE]  and ['PC Position Setup'].[PLANCODE] = ['PC Position Funds'].[PLANCODE] left outer join [UPR00100] as ['Payroll Employee Master'] with (NOLOCK) on ['PC Position Seats Detail'].[EMPLOYID] = ['Payroll Employee Master'].[EMPLOYID] 
GO
GRANT SELECT ON  [dbo].[PositionControl] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[PositionControl] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[PositionControl] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[PositionControl] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[PositionControl] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[PositionControl] TO [rpt_human resource administrator]
GO
