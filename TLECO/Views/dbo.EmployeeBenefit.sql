SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [dbo].[EmployeeBenefit] AS select rtrim(['Payroll Master'].[EMPLOYID]) as 'Employee ID', rtrim(['Payroll Master'].[FRSTNAME]) as 'First Name', rtrim(['Payroll Master'].[LASTNAME]) as 'Last Name', rtrim(['Payroll Master'].[SOCSCNUM]) as 'Social Security Number', rtrim(['HR_Benefit_MSTR'].[BENEFIT]) as 'Benefit', 'Benefit Kind' = dbo.HR_FUNC_Benefit_Kind(['HR_Benefit_MSTR'].[BENEFITKIND_I]), ['HR_Benefit_MSTR'].[BNFBEGDT] as 'Benefit Beginning Date', ['HR_Benefit_MSTR'].[COSTEMPLOYEE_I] as 'Cost Employee', ['HR_Benefit_MSTR'].[COSTEMPLOYER_I] as 'Cost Employer',  ['Payroll Master'].[ACTINDX] as 'Account Index', rtrim(['Payroll Address Master'].[ADDRESS1]) as 'Address 1', rtrim(['Payroll Address Master'].[ADDRESS2]) as 'Address 2', rtrim(['Payroll Address Master'].[ADDRESS3]) as 'Address 3', rtrim(['Payroll Master'].[ADRSCODE]) as 'Address Code', rtrim(['Payroll Master'].[ALTERNATENAME]) as 'Alternate Name', 'Auto Accrue Sick Time' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[ATACRSTM]), 'Auto Accrue Vacation' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[ATACRVAC]), ['Payroll Master'].[BENADJDATE] as 'Ben Adj Date', ['HR_Benefit_MSTR'].[BENEFICIARYINDEX_I] as 'Beneficiary Index', rtrim(['HR_Benefit_MSTR'].[CHANGEBY_I]) as 'Benefit Change By', ['HR_Benefit_MSTR'].[CHANGEDATE_I] as 'Benefit Change Date', ['HR_Benefit_MSTR'].[BENEFITDEDUCTIBLE_I] as 'Benefit Deductible', ['HR_Benefit_MSTR'].[BNFENDDT] as 'Benefit End Date', ['Payroll Master'].[BENEFITEXPIRE_I] as 'Benefit Expire', 'Benefit Formula' = dbo.HR_FUNC_Benefit_Formula(['HR_Benefit_MSTR'].[BNFFRMLA]), 'Benefit Frequency' = dbo.HR_FUNC_Benefit_Frequency(['HR_Benefit_MSTR'].[BNFTFREQ]), ['HR_Benefit_MSTR'].[BNFLFMAX] as 'Benefit Lifetime Max', 'Benefit Method' = dbo.HR_FUNC_Benefit_Method(['HR_Benefit_MSTR'].[BNFTMTHD]), ['HR_Benefit_MSTR'].[BNPAYPMX] as 'Benefit Pay Period Max', 'Benefit Status' = dbo.HR_FUNC_Benefit_Status(['HR_Benefit_MSTR'].[BENEFITSTATUS_I]), rtrim(['HR_Benefit_MSTR'].[BENEFITTYPE_I]) as 'Benefit Type', ['HR_Benefit_MSTR'].[BNFYRMAX] as 'Benefit Year Max', ['Payroll Master'].[BRTHDATE] as 'Birth Date', ['Payroll Master'].[BIRTHDAY] as 'Birth Day', rtrim(['Payroll Master'].[BIRTHMONTH]) as 'Birth Month', 'Calc Min Wage Bal' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[Calc_Min_Wage_Bal]), 'Check1' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[CHECK1_I]), 'Check2' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[CHECK2_I]), 'Check3' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[CHECK3_I]), 'Check4' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[CHECK4_I]), 'Check5' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[CHECK5_I]), 'Citizen' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[CITIZEN]), rtrim(['Payroll Address Master'].[CITY]) as 'City', rtrim(['HR_Benefit_MSTR'].[COMMENTSTR10_I]) as 'CommentStr10', 'Completion Status' = dbo.HR_FUNC_Completion_Status(['HR_Benefit_MSTR'].[COMPLETIONSTATUS_I]), ['HR_Benefit_MSTR'].[CONTRIBAFTERTAX_I] as 'Contrib After Tax', ['HR_Benefit_MSTR'].[CONTAFTERTAXDLR_I] as 'Contrib After Tax Dollar', ['HR_Benefit_MSTR'].[CONTRIBBONUS_I] as 'Contrib Bonus', ['HR_Benefit_MSTR'].[CONTRIBBONUSDOLLAR_I] as 'Contrib Bonus Dollar', ['HR_Benefit_MSTR'].[CONTRIBPRETAX_I] as 'Contrib Pre Tax', ['HR_Benefit_MSTR'].[CONTPRETAXDLR_I] as 'Contrib Pre Tax Dollar', ['HR_Benefit_MSTR'].[COSTCOBRA_I] as 'Cost COBRA', ['HR_Benefit_MSTR'].[COSTOTHER1_I] as 'Cost Other 1', ['HR_Benefit_MSTR'].[COSTOTHER2_I] as 'Cost Other 2', ['HR_Benefit_MSTR'].[COSTTOTAL_I] as 'Cost Total', rtrim(['Payroll Address Master'].[COUNTRY]) as 'Country', rtrim(['Payroll Address Master'].[CCode]) as 'Country Code', rtrim(['Payroll Address Master'].[COUNTY]) as 'County', ['HR_Benefit_MSTR'].[DATEDUE_I] as 'Date Due', ['Payroll Master'].[DEMPINAC] as 'Date Employee Inactivated', ['Payroll Master'].[DATEOFLASTREVIEW_I] as 'Date Of Last Review', ['Payroll Master'].[DATEOFNEXTREVIEW_I] as 'Date Of Next Review', 'Deduction Formula' = dbo.HR_FUNC_Deduction_Formula(['HR_Benefit_MSTR'].[DEDFRMLA]), ['HR_Benefit_MSTR'].[DEDINITBAL] as 'Deduction Initial Balance', 'Deduction Method' = dbo.HR_FUNC_Deduction_Method(['HR_Benefit_MSTR'].[DEDNMTHD]), ['HR_Benefit_MSTR'].[DEPYPRMX] as 'Deduction Pay Period Max', ['HR_Benefit_MSTR'].[DEDNPRCT_1] as 'Deduction Percent', ['HR_Benefit_MSTR'].[DEDYRMAX] as 'Deduction Year Max', rtrim(['Payroll Master'].[DEPRTMNT]) as 'Department', rtrim(['HR_Benefit_MSTR'].[DSCRIPTN]) as 'Description', 'Disabled Veteran' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[DISABLEDVETERAN]), rtrim(['Payroll Master'].[DIVISIONCODE_I]) as 'Division Code', ['HR_Benefit_MSTR'].[ELIGIBILITYDATE_I] as 'Eligibility Date', rtrim(['Payroll Master'].[EMPLCLAS]) as 'Employee Class', 'Ethnic Origin' = dbo.HR_FUNC_Ethnic_Origin(['Payroll Master'].[ETHNORGN]), rtrim(['Payroll Address Master'].[FAX]) as 'Fax', rtrim(['Payroll Master'].[FEDCLSSCD]) as 'Federal Classification Code', 'Foreign Address' = dbo.DYN_FUNC_Boolean_All(['Payroll Address Master'].[Foreign_Address]), rtrim(['Payroll Address Master'].[Foreign_Postal_Code]) as 'Foreign Postal Code', rtrim(['Payroll Address Master'].[Foreign_StateProvince]) as 'Foreign State/Province', 'Gender' = dbo.HR_FUNC_Gender(['Payroll Master'].[GENDER]), 'HR Status' = dbo.HR_FUNC_HR_Status(['Payroll Master'].[HRSTATUS]),  'Handicapped' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[HANDICAPPED]), 'Highly Compensated' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[HIGHLYCOMPENSATED_I]), ['Payroll Master'].[I9RENEW] as 'I9renew', ['HR_Benefit_MSTR'].[IBENEFITAMOUNT_I] as 'IBenefit Amount', ['HR_Benefit_MSTR'].[IINDEX_I] as 'IIndex', 'Inactive from Benefit Master' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[INACTIVE]), 'Inactive' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[INACTIVE]), 'Inactive Benefit Employee' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[INACTBENEMPLOYEE]), 'Inactive Benefit Employer' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[INACTBENEMPLR]), rtrim(['Payroll Master'].[JOBTITLE]) as 'Job Title', ['Payroll Master'].[LASTDAYWORKED_I] as 'Last Day Worked', ['HR_Benefit_MSTR'].[LIFEAMTCHILDREN_I] as 'Life Amt Child(ren)', ['HR_Benefit_MSTR'].[LIFEAMTEMPL_I] as 'Life Amt Empl', ['HR_Benefit_MSTR'].[LIFEAMTSPOUSE_I] as 'Life Amt Spouse', 'Loan Active' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[LOANACTIVE_I]), rtrim(['Payroll Master'].[LOCATNID]) as 'Location ID', ['HR_Benefit_MSTR'].[MAJMEDCOVERAGE_I] as 'Major Medical Coverage', 'Marital Status' = dbo.HR_FUNC_Marital_Status(['Payroll Master'].[MARITALSTATUS]), ['HR_Benefit_MSTR'].[MAXOUTOFPOCKET_I] as 'Max Out-Of-Pocket', rtrim(['Payroll Master'].[MIDLNAME]) as 'Middle Name', ['Payroll Master'].[MINETPAY] as 'Minimum Net Pay', rtrim(['Payroll Master'].[NICKNAME]) as 'NickName', ['Payroll Master'].[NOTEINDX] as 'Note Index', ['Payroll Master'].[NOTEINDX2] as 'Note Index2', ['HR_Benefit_MSTR'].[NOTESINDEX_I] as 'Notes Index', ['HR_Benefit_MSTR'].[NUMBEROFCHILDREN_I] as 'Number of Children', 'Override' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[OVERRIDE_I]), rtrim(['Payroll Address Master'].[PHONE1]) as 'Phone 1', rtrim(['Payroll Address Master'].[PHONE2]) as 'Phone 2', rtrim(['Payroll Address Master'].[PHONE3]) as 'Phone 3', rtrim(['HR_Benefit_MSTR'].[POLICYNUMBER_I]) as 'Policy Number', rtrim(['HR_Benefit_MSTR'].[PRIMARYBENEFICIARY_I]) as 'Primary Beneficiary', rtrim(['Payroll Master'].[Primary_Pay_Record]) as 'Primary Pay Record', rtrim(['Payroll Master'].[RATECLSS]) as 'Rate Class', rtrim(['Payroll Master'].[RSNEMPIN]) as 'Reason Employee Inactivated', rtrim(['Payroll Master'].[SUTASTAT]) as 'SUTA State', rtrim(['HR_Benefit_MSTR'].[SECBENEFICIARY_I]) as 'Secondary Beneficiary', ['Payroll Master'].[SKTMACAM]/100.00 as 'Sick Time Accrual Amount', 'Sick Time Accrual Method' = dbo.DYN_FUNC_Sick_Time_Accrual_Method(['Payroll Master'].[STMACMTH]), ['Payroll Master'].[SIKTIMAV]/100.00 as 'Sick Time Available', ['Payroll Master'].[SKTMHPYR]/100.00 as 'Sick Time Hours Per Year', 'Smoker' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[SMOKER_I]), rtrim(['Payroll Master'].[SPOUSE]) as 'Spouse', rtrim(['Payroll Master'].[SPOUSESSN]) as 'Spouse SSN', ['Payroll Master'].[STRTDATE] as 'Start Date', rtrim(['Payroll Address Master'].[STATE]) as 'State', rtrim(['Payroll Master'].[SUPERVISORCODE_I]) as 'Supervisor Code', 'Tiers Used' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[TIERSUSED_I]), 'Type of Code' = dbo.HR_FUNC_Type_of_Code(['HR_Benefit_MSTR'].[TYPEOFCODE_I]), 'Type of Employment' = dbo.HR_FUNC_Type_of_Employment(['Payroll Master'].[EMPLOYMENTTYPE]), rtrim(['Payroll Master'].[UNIONCD]) as 'Union Code', 'Union Employee' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[UNIONEMPLOYEE]), rtrim(['Payroll Master'].[USERDEF1]) as 'User Defined 1', rtrim(['Payroll Master'].[USERDEF2]) as 'User Defined 2', ['Payroll Master'].[VACCRAMT]/100.00 as 'Vacation Accrual Amount', 'Vacation Accrual Method' = dbo.DYN_FUNC_Vacation_Accrual_Method(['Payroll Master'].[VACCRMTH]), ['Payroll Master'].[VACAVLBL]/100.00 as 'Vacation Available', ['Payroll Master'].[VACAPRYR]/100.00 as 'Vacation Hours Per Year', 'Variable Benefit' = dbo.DYN_FUNC_Boolean_All(['HR_Benefit_MSTR'].[VARBENFT]), 'Verified' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[VERIFIED]), 'Veteran' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[VETERAN]), 'Vietnam Veteran' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[VIETNAMVETERAN]), 'Warn Sick Time Falls Before Zero' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[WRNSTFLSBLWZR]), 'Warn Vacation Falls Before Zero' = dbo.DYN_FUNC_Boolean_All(['Payroll Master'].[WRNVCNFLSBLWZR]), 'Which Miscellaneous Benefit For Pay' = dbo.DYN_FUNC_Which_Cash_Account_For_Pay(['Payroll Master'].[WCACFPAY]), ['Payroll Master'].[WKHRPRYR] as 'Work Hours Per Year', rtrim(['Payroll Master'].[WRKRCOMP]) as 'Workers Comp', rtrim(['Payroll Address Master'].[ZIPCODE]) as 'Zip Code', ['HR_Benefit_MSTR'].[I1_I] as 'i1', ['HR_Benefit_MSTR'].[I2_I] as 'i2', ['HR_Benefit_MSTR'].[I3_I] as 'i3', ['HR_Benefit_MSTR'].[I4_I] as 'i4', ['HR_Benefit_SETP'].[CONTEMPMATCH_I] as 'Contrib Employer Match', 'Deduction Type' = dbo.HR_FUNC_Deduction_Type(['Payroll Deduction Setup'].[DEDTYPE]), ['Payroll Deduction Sequence Setup'].[DEDNSQNC] as 'Deduction Sequence'          from [BE010130] as ['HR_Benefit_MSTR'] with (NOLOCK) left outer join [UPR00100] as ['Payroll Master'] with (NOLOCK) on ['HR_Benefit_MSTR'].[EMPID_I] = ['Payroll Master'].[EMPLOYID] left outer join [UPR00102] as ['Payroll Address Master'] with (NOLOCK) on ['Payroll Master'].[EMPLOYID] = ['Payroll Address Master'].[EMPLOYID]  and ['Payroll Master'].[ADRSCODE] = ['Payroll Address Master'].[ADRSCODE] left outer join [BE020230] as ['HR_Benefit_SETP'] with (NOLOCK) on ['HR_Benefit_MSTR'].[BENEFIT] = ['HR_Benefit_SETP'].[BENEFIT] left outer join [UPR00500] as ['Payroll Deduction Master'] with (NOLOCK) on ['HR_Benefit_MSTR'].[EMPID_I] = ['Payroll Deduction Master'].[EMPLOYID]  and ['HR_Benefit_MSTR'].[BENEFIT] = ['Payroll Deduction Master'].[DEDUCTON] left outer join [UPR40900] as ['Payroll Deduction Setup'] with (NOLOCK) on ['Payroll Deduction Master'].[DEDUCTON] = ['Payroll Deduction Setup'].[DEDUCTON] left outer join [UPR40902] as ['Payroll Deduction Sequence Setup'] with (NOLOCK) on ['Payroll Deduction Setup'].[DEDUCTON] = ['Payroll Deduction Sequence Setup'].[DEDUCTON] 
GO
GRANT SELECT ON  [dbo].[EmployeeBenefit] TO [DYNGRP]
GO
GRANT INSERT ON  [dbo].[EmployeeBenefit] TO [DYNGRP]
GO
GRANT DELETE ON  [dbo].[EmployeeBenefit] TO [DYNGRP]
GO
GRANT UPDATE ON  [dbo].[EmployeeBenefit] TO [DYNGRP]
GO
GRANT SELECT ON  [dbo].[EmployeeBenefit] TO [rpt_executive]
GO
GRANT SELECT ON  [dbo].[EmployeeBenefit] TO [rpt_human resource administrator]
GO
