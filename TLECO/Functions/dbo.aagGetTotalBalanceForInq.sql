SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 CREATE FUNCTION [dbo].[aagGetTotalBalanceForInq]() RETURNS  NUMERIC(19,5) AS BEGIN DECLARE @aaBudgetID INTEGER , @aaCodeSequence INTEGER , @ACTINDX INTEGER , @aaActualPriliminary INTEGER , @NETCHNG TINYINT , @YEAR1 SMALLINT, @aaRange SMALLINT, @STR30 CHAR(31), @aaFiscalPeriod INTEGER ,  @aaTotal NUMERIC(19,5), @USERID   CHAR(15), @WINTYPE   SMALLINT, @CMPANYID INTEGER  SELECT @USERID  = SYSTEM_USER SELECT @WINTYPE = 2  SELECT @CMPANYID = dbo.aagGetCompanyID()  SELECT @aaBudgetID = aaBudgetID , @aaCodeSequence = aaCodeSequence , @ACTINDX = ACTINDX , @aaActualPriliminary = aaActualPriliminary , @YEAR1 = AAG00906.YEAR1 , @aaRange = aaRange, @NETCHNG = NETCHNG, @STR30 = STR30 FROM AAG00906 WHERE USERID = @USERID AND WINTYPE = @WINTYPE AND CMPANYID = @CMPANYID  IF @NETCHNG = 0  BEGIN SELECT @aaTotal = PERDBLNC from aaActualBudgetInquiryViewAlt  END ELSE BEGIN SELECT @aaTotal = SUM(PERDBLNC) from aaActualBudgetInquiryViewAlt END RETURN (@aaTotal)  END    
GO
GRANT EXECUTE ON  [dbo].[aagGetTotalBalanceForInq] TO [DYNGRP]
GO
