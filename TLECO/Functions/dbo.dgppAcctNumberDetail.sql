SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 CREATE FUNCTION [dbo].[dgppAcctNumberDetail]  (  @action int,  @AccountIndex int,  @Year int,  @DateRange smallint,  @StartDate datetime,  @EndDate datetime,  @DocSrcRange smallint,  @StartDocSrc varchar(10),  @EndDocSrc varchar(10),  @CurrencyIDRange smallint,  @StartCurrencyID varchar(15),  @EndCurrencyID varchar(15)   )  RETURNS varchar(2000) AS BEGIN   DECLARE @COMPID varchar(5),  @ActionType varchar(15),  @FunctionName varchar(50),  @EncodedAcctNumber varchar(255),  @EncodedStartDocSrc varchar(255),  @EncodedEndDocSrc varchar(255),  @EncodedStartCurrencyID varchar(255),  @EncodedEndCurrencyID varchar(255),  @URIstring varchar(360)   select @FunctionName = 'OpenAcctDtl'   if @action=1  select @ActionType = 'OPEN'  else  select @ActionType = 'OPEN'   select @EncodedStartDocSrc = DYNAMICS.dbo.encodeUrlString(rtrim(@StartDocSrc))  select @EncodedEndDocSrc = DYNAMICS.dbo.encodeUrlString(rtrim(@EndDocSrc))  select @EncodedStartCurrencyID = DYNAMICS.dbo.encodeUrlString(rtrim(@StartCurrencyID))  select @EncodedEndCurrencyID = DYNAMICS.dbo.encodeUrlString(rtrim(@EndCurrencyID))   select @URIstring = '&Act=' + @ActionType + '&Func=' + @FunctionName +   '&ACTINDX=' + ltrim(str(@AccountIndex)) +   '&Year=' + ltrim(str(@Year)) +   '&DateRange=' + ltrim(str(@DateRange)) + '&StartDate=' +  rtrim(convert(char,@StartDate, 101))  + '&EndDate=' + rtrim(convert(char,@EndDate, 101)) +  '&DocSrcRange=' + ltrim(str(@DocSrcRange)) + '&StartDocSrc=' + @EncodedStartDocSrc + '&EndDocSrc=' + @EncodedEndDocSrc +   '&CurrIDRange=' + ltrim(str(@CurrencyIDRange)) + '&StartCurrID=' + @EncodedStartCurrencyID + '&EndCurrID=' + @EncodedEndCurrencyID  RETURN(@URIstring) END   
GO
GRANT EXECUTE ON  [dbo].[dgppAcctNumberDetail] TO [DYNGRP]
GO
