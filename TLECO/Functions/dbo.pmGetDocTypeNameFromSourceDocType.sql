SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 CREATE FUNCTION [dbo].[pmGetDocTypeNameFromSourceDocType] (  @I_nLanguageID smallint = 0,  @I_sDocSource smallint = 0,  @I_sDocType smallint = 0,  @I_tVoided tinyint  = 0,  @I_cDocTypeName char(21) ) RETURNS char(21) AS BEGIN  declare  @cTypeName char(21)  (select @cTypeName = case @I_sDocSource   when 2 then  (select case  when @I_sDocType = 2 then   (rtrim((select SQL_MSG from DYNAMICS.dbo.MESSAGES where Language_ID = @I_nLanguageID and MSGNUM = 155)) + (select ISNULL((select '*' where @I_tVoided = 1), '')))  when @I_sDocType = 3 then   (rtrim((select SQL_MSG from DYNAMICS.dbo.MESSAGES where Language_ID = @I_nLanguageID and MSGNUM = 3005)) + (select ISNULL((select '*' where @I_tVoided = 1), '')))  end)  when 4 then  (select case  when @I_sDocType = 4 then   (rtrim((select SQL_MSG from DYNAMICS.dbo.MESSAGES where Language_ID = @I_nLanguageID and MSGNUM = 5004)) + (select ISNULL((select '*' where @I_tVoided = 1), '')))  when @I_sDocType = 5 then   (rtrim((select SQL_MSG from DYNAMICS.dbo.MESSAGES where Language_ID = @I_nLanguageID and MSGNUM = 3089)) + (select ISNULL((select '*' where @I_tVoided = 1), '')))  when @I_sDocType = 6 then   (rtrim((select SQL_MSG from DYNAMICS.dbo.MESSAGES where Language_ID = @I_nLanguageID and MSGNUM = 3091)) + (select ISNULL((select '*' where @I_tVoided = 1), '')))  when @I_sDocType = 7 then   (rtrim((select SQL_MSG from DYNAMICS.dbo.MESSAGES where Language_ID = @I_nLanguageID and MSGNUM = 3092)) + (select ISNULL((select '*' where @I_tVoided = 1), '')))  else (rtrim((select SQL_MSG from DYNAMICS.dbo.MESSAGES where Language_ID = @I_nLanguageID and MSGNUM = 151)) + (select ISNULL((select '*' where @I_tVoided = 1), '')))  end)  else (select @I_cDocTypeName)  end)  set @cTypeName = isnull(@cTypeName, '')  return @cTypeName END   
GO
GRANT EXECUTE ON  [dbo].[pmGetDocTypeNameFromSourceDocType] TO [DYNGRP]
GO
