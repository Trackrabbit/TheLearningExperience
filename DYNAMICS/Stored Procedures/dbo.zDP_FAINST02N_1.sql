SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_FAINST02N_1] (@BS int, @Install_Date_and_Time char(31), @CMPANYID smallint, @Install_Step char(81), @Install_Component_Name char(81), @Install_Date_and_Time_RS char(31), @CMPANYID_RS smallint, @Install_Step_RS char(81), @Install_Component_Name_RS char(81), @Install_Date_and_Time_RE char(31), @CMPANYID_RE smallint, @Install_Step_RE char(81), @Install_Component_Name_RE char(81)) AS  set nocount on IF @Install_Date_and_Time_RS IS NULL BEGIN SELECT TOP 25  Install_Date_and_Time, CMPANYID, Install_Step, Install_Component_Name, ERMSGTXT, DEX_ROW_ID FROM .FAINST02 WHERE ( Install_Date_and_Time = @Install_Date_and_Time AND CMPANYID = @CMPANYID AND Install_Step = @Install_Step AND Install_Component_Name > @Install_Component_Name OR Install_Date_and_Time = @Install_Date_and_Time AND CMPANYID = @CMPANYID AND Install_Step > @Install_Step OR Install_Date_and_Time = @Install_Date_and_Time AND CMPANYID > @CMPANYID OR Install_Date_and_Time > @Install_Date_and_Time ) ORDER BY Install_Date_and_Time ASC, CMPANYID ASC, Install_Step ASC, Install_Component_Name ASC END ELSE IF @Install_Date_and_Time_RS = @Install_Date_and_Time_RE BEGIN SELECT TOP 25  Install_Date_and_Time, CMPANYID, Install_Step, Install_Component_Name, ERMSGTXT, DEX_ROW_ID FROM .FAINST02 WHERE Install_Date_and_Time = @Install_Date_and_Time_RS AND CMPANYID BETWEEN @CMPANYID_RS AND @CMPANYID_RE AND Install_Step BETWEEN @Install_Step_RS AND @Install_Step_RE AND Install_Component_Name BETWEEN @Install_Component_Name_RS AND @Install_Component_Name_RE AND ( Install_Date_and_Time = @Install_Date_and_Time AND CMPANYID = @CMPANYID AND Install_Step = @Install_Step AND Install_Component_Name > @Install_Component_Name OR Install_Date_and_Time = @Install_Date_and_Time AND CMPANYID = @CMPANYID AND Install_Step > @Install_Step OR Install_Date_and_Time = @Install_Date_and_Time AND CMPANYID > @CMPANYID OR Install_Date_and_Time > @Install_Date_and_Time ) ORDER BY Install_Date_and_Time ASC, CMPANYID ASC, Install_Step ASC, Install_Component_Name ASC END ELSE BEGIN SELECT TOP 25  Install_Date_and_Time, CMPANYID, Install_Step, Install_Component_Name, ERMSGTXT, DEX_ROW_ID FROM .FAINST02 WHERE Install_Date_and_Time BETWEEN @Install_Date_and_Time_RS AND @Install_Date_and_Time_RE AND CMPANYID BETWEEN @CMPANYID_RS AND @CMPANYID_RE AND Install_Step BETWEEN @Install_Step_RS AND @Install_Step_RE AND Install_Component_Name BETWEEN @Install_Component_Name_RS AND @Install_Component_Name_RE AND ( Install_Date_and_Time = @Install_Date_and_Time AND CMPANYID = @CMPANYID AND Install_Step = @Install_Step AND Install_Component_Name > @Install_Component_Name OR Install_Date_and_Time = @Install_Date_and_Time AND CMPANYID = @CMPANYID AND Install_Step > @Install_Step OR Install_Date_and_Time = @Install_Date_and_Time AND CMPANYID > @CMPANYID OR Install_Date_and_Time > @Install_Date_and_Time ) ORDER BY Install_Date_and_Time ASC, CMPANYID ASC, Install_Step ASC, Install_Component_Name ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_FAINST02N_1] TO [DYNGRP]
GO
