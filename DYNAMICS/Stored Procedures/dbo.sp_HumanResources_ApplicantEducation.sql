SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_HumanResources_ApplicantEducation] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @First_Name varchar(255), @Last_Name varchar(255), @University varchar(255), @Major varchar(255), @Graduation_Year varchar(255), @Degree varchar(255), @Applicant_Number varchar(255), @ISSN varchar(255), @Middle_Name varchar(255), @Address_1 varchar(255), @Address_2 varchar(255), @City varchar(255), @State varchar(255), @Zip_Code varchar(255), @Country varchar(255), @Home_Phone varchar(255), @Work_Phone varchar(255), @Ext varchar(255), @lSequence_Number varchar(255), @Apply_Date varchar(255), @Requisition_Number varchar(255), @Company_Code varchar(255), @Division_Code varchar(255), @Department_Code varchar(255), @Position_Code varchar(255), @Location_Code varchar(255), @Status varchar(255), @Rejection_Reason varchar(255), @Description varchar(255), @Relocation varchar(255), @Reply_Letter_Sent varchar(255), @Color_Code varchar(255), @Color_String varchar(255), @Ref_Source_DDL varchar(255), @Reference_Source varchar(255), @Gender_GB varchar(255), @EEO_Ethnic_Origin varchar(255), @EEO_Age varchar(255), @Handicapped varchar(255), @Veteran varchar(255), @Disabled_Veteran varchar(255), @Vietnam_Veteran varchar(255), @Notes_Index__Applicant_ varchar(255), @Change_By__Applicant_ varchar(255), @Change_Date__Applicant_ varchar(255), @Years varchar(255), @Notes_Index varchar(255), @Change_By varchar(255), @Change_Date varchar(255) select @I_iDictID = 414 select @I_iMessageNumber = 26400 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @First_Name output  select @I_iDictID = 414 select @I_iMessageNumber = 26401 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Name output  select @I_iDictID = 414 select @I_iMessageNumber = 26402 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @University output  select @I_iDictID = 414 select @I_iMessageNumber = 26403 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Major output  select @I_iDictID = 414 select @I_iMessageNumber = 26404 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Graduation_Year output  select @I_iDictID = 414 select @I_iMessageNumber = 26405 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Degree output  select @I_iDictID = 414 select @I_iMessageNumber = 26407 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Applicant_Number output  select @I_iDictID = 414 select @I_iMessageNumber = 26408 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ISSN output  select @I_iDictID = 414 select @I_iMessageNumber = 26409 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Middle_Name output  select @I_iDictID = 414 select @I_iMessageNumber = 26410 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_1 output  select @I_iDictID = 414 select @I_iMessageNumber = 26411 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_2 output  select @I_iDictID = 414 select @I_iMessageNumber = 26412 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @City output  select @I_iDictID = 414 select @I_iMessageNumber = 26413 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @State output  select @I_iDictID = 414 select @I_iMessageNumber = 26414 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Zip_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26415 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Country output  select @I_iDictID = 414 select @I_iMessageNumber = 26416 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Home_Phone output  select @I_iDictID = 414 select @I_iMessageNumber = 26417 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Work_Phone output  select @I_iDictID = 414 select @I_iMessageNumber = 26418 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ext output  select @I_iDictID = 414 select @I_iMessageNumber = 26419 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @lSequence_Number output  select @I_iDictID = 414 select @I_iMessageNumber = 26420 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Apply_Date output  select @I_iDictID = 414 select @I_iMessageNumber = 26421 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Requisition_Number output  select @I_iDictID = 414 select @I_iMessageNumber = 26422 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Company_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26423 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Division_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26424 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Department_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26425 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Position_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26426 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Location_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26427 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Status output  select @I_iDictID = 414 select @I_iMessageNumber = 26428 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Rejection_Reason output  select @I_iDictID = 414 select @I_iMessageNumber = 26429 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Description output  select @I_iDictID = 414 select @I_iMessageNumber = 26430 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Relocation output  select @I_iDictID = 414 select @I_iMessageNumber = 26431 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reply_Letter_Sent output  select @I_iDictID = 414 select @I_iMessageNumber = 26432 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Color_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26433 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Color_String output  select @I_iDictID = 414 select @I_iMessageNumber = 26434 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ref_Source_DDL output  select @I_iDictID = 414 select @I_iMessageNumber = 26435 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reference_Source output  select @I_iDictID = 414 select @I_iMessageNumber = 26436 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Gender_GB output  select @I_iDictID = 414 select @I_iMessageNumber = 26437 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @EEO_Ethnic_Origin output  select @I_iDictID = 414 select @I_iMessageNumber = 26438 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @EEO_Age output  select @I_iDictID = 414 select @I_iMessageNumber = 26439 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Handicapped output  select @I_iDictID = 414 select @I_iMessageNumber = 26440 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Veteran output  select @I_iDictID = 414 select @I_iMessageNumber = 26441 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Disabled_Veteran output  select @I_iDictID = 414 select @I_iMessageNumber = 26442 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vietnam_Veteran output  select @I_iDictID = 414 select @I_iMessageNumber = 26443 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Notes_Index__Applicant_ output  select @I_iDictID = 414 select @I_iMessageNumber = 26444 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Change_By__Applicant_ output  select @I_iDictID = 414 select @I_iMessageNumber = 26445 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Change_Date__Applicant_ output  select @I_iDictID = 414 select @I_iMessageNumber = 26506 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Years output  select @I_iDictID = 414 select @I_iMessageNumber = 26507 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Notes_Index output  select @I_iDictID = 414 select @I_iMessageNumber = 26508 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Change_By output  select @I_iDictID = 414 select @I_iMessageNumber = 26509 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Change_Date output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[ApplicantEducation]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[ApplicantEducation] '  select @sqldefaultstring =   'CREATE VIEW ApplicantEducation AS ' +   'select ' +   'rtrim([''HR_Applicant''].[LLASTNAME_I]) as ''' + @First_Name + ''', ' + 'rtrim([''HR_Applicant''].[FFIRSTNAME_I]) as ''' + @Last_Name + ''', ' + 'rtrim([''HR_Applicant_Education''].[UNIVERSITY]) as ''' + @University + ''', ' + 'rtrim([''HR_Applicant_Education''].[MAJOR]) as ''' + @Major + ''', ' + 'rtrim([''HR_Applicant_Education''].[GRADUATIONYEAR]) as ''' + @Graduation_Year + ''', ' + 'rtrim([''HR_Applicant_Education''].[DEGREE]) as ''' + @Degree + ''', '   select @sqlstring1 =   'rtrim([''HR_Applicant''].[ADDRESS1]) as ''' + @Address_1 + ''', ' +  'rtrim([''HR_Applicant''].[ADDRESS2]) as ''' + @Address_2 + ''', ' +  '[''HR_Applicant_Education''].[APPLICANTNUMBER_I] as ''' + @Applicant_Number + ''', ' +  '[''HR_Applicant''].[APPLYDATE_I] as ''' + @Apply_Date + ''', ' +  'rtrim([''HR_Applicant_Education''].[CHANGEBY_I]) as ''' + @Change_By + ''', ' +  'rtrim([''HR_Applicant''].[CHANGEBY_I]) as ''' + @Change_By__Applicant_ + ''', ' +  '[''HR_Applicant_Education''].[CHANGEDATE_I] as ''' + @Change_Date + ''', ' +  '[''HR_Applicant''].[CHANGEDATE_I] as ''' + @Change_Date__Applicant_ + ''', ' +  'rtrim([''HR_Applicant''].[CITY]) as ''' + @City + ''', ' +  '[''HR_Applicant''].[COLORCODE_I] as ''' + @Color_Code + ''', ' +  'rtrim([''HR_Applicant''].[COLORSTRING_I]) as ''' + @Color_String + ''', ' +  'rtrim([''HR_Applicant''].[COMPANYCODE_I]) as ''' + @Company_Code + ''', ' +  'rtrim([''HR_Applicant''].[COUNTRY]) as ''' + @Country + ''', ' +  'rtrim([''HR_Applicant''].[DEPARTMENTCODE_I]) as ''' + @Department_Code + ''', ' +  'rtrim([''HR_Applicant''].[DSCRIPTN]) as ''' + @Description + ''', ' +  '''' + @Disabled_Veteran + ''' = dbo.DYN_FUNC_Boolean_All([''HR_Applicant''].[DISABLEDVETERAN]), ' +  'rtrim([''HR_Applicant''].[DIVISIONCODE_I]) as ''' + @Division_Code + ''', ' +  '''' + @EEO_Age + ''' = dbo.HR_FUNC_EEO_Age([''HR_Applicant''].[EEOAGE_I]), ' +  '''' + @EEO_Ethnic_Origin + ''' = dbo.HR_FUNC_Ethnic_Origin([''HR_Applicant''].[EEOETHNICORIGIN_I]), ' +  'rtrim([''HR_Applicant''].[EXT_I]) as ''' + @Ext + ''', ' +  '''' + @Gender_GB + ''' = dbo.HR_FUNC_Gender_GB([''HR_Applicant''].[GENDERGB_I]), ' +  '''' + @Handicapped + ''' = dbo.DYN_FUNC_Boolean_All([''HR_Applicant''].[HANDICAPPED]), ' +  'rtrim([''HR_Applicant''].[HOMEPHONE]) as ''' + @Home_Phone + ''', ' +  'rtrim([''HR_Applicant''].[SSN_I]) as ''' + @ISSN + ''', ' +  'rtrim([''HR_Applicant''].[LOCATNID]) as ''' + @Location_Code + ''', ' +  'rtrim([''HR_Applicant''].[MIDLNAME]) as ''' + @Middle_Name + ''', ' +  '[''HR_Applicant_Education''].[NOTESINDEX_I] as ''' + @Notes_Index + ''', ' +  '[''HR_Applicant''].[NOTESINDEX_I] as ''' + @Notes_Index__Applicant_ + ''', ' +  'rtrim([''HR_Applicant''].[POSITIONCODE_I]) as ''' + @Position_Code + ''', ' +  '''' + @Ref_Source_DDL + ''' = dbo.HR_FUNC_Ref_Source_DDL([''HR_Applicant''].[REFSOURCEDDL_I]), ' +  'rtrim([''HR_Applicant''].[REFERENCESOURCE_I]) as ''' + @Reference_Source + ''', ' +  '''' + @Rejection_Reason + ''' = dbo.HR_FUNC_Rejection_Reason([''HR_Applicant''].[REJECTREASON_I]), ' +  '''' + @Relocation + ''' = dbo.HR_FUNC_Relocation([''HR_Applicant''].[RELOCATION_I]), ' +  '''' + @Reply_Letter_Sent + ''' = dbo.DYN_FUNC_Boolean_All([''HR_Applicant''].[REPLYLETTERSENT_I]), ' +  '[''HR_Applicant''].[REQUISITIONNUMBER_I] as ''' + @Requisition_Number + ''', ' +  'rtrim([''HR_Applicant''].[STATE]) as ''' + @State + ''', ' +  '''' + @Status + ''' = dbo.HR_FUNC_Status_Applicant_Education([''HR_Applicant''].[STATUS0_I]), ' +  '''' + @Veteran + ''' = dbo.DYN_FUNC_Boolean_All([''HR_Applicant''].[VETERAN]), ' +  '''' + @Vietnam_Veteran + ''' = dbo.DYN_FUNC_Boolean_All([''HR_Applicant''].[VIETNAMVETERAN]), ' +  'rtrim([''HR_Applicant''].[WORKPHONE]) as ''' + @Work_Phone + ''', ' +  'rtrim([''HR_Applicant_Education''].[YEARS]) as ''' + @Years + ''', ' +  'rtrim([''HR_Applicant''].[ZIPCODE_I]) as ''' + @Zip_Code + ''', ' +  '[''HR_Applicant_Education''].[ISEQUENCENUMBER_I] as ''' + @lSequence_Number + ''' '   select @sqljoinstring =   'from [HR2APP04] as [''HR_Applicant_Education''] with (NOLOCK) '   + 'left outer join [HR2APP12] as [''HR_Applicant''] with (NOLOCK) on '   + '[''HR_Applicant_Education''].[APPLICANTNUMBER_I] = [''HR_Applicant''].[APPLICANTNUMBER_I] '   select @sqlaccessstring =  'GRANT SELECT ON [dbo].[ApplicantEducation] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[ApplicantEducation] TO [rpt_human resource administrator]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_HumanResources_ApplicantEducation] TO [DYNGRP]
GO
