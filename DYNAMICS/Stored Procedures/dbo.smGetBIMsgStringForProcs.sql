SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[smGetBIMsgStringForProcs]   @I_iFieldMessageNumber int    = NULL,   @I_iTableAliasMessageNumber int    = NULL,   @I_iDictID int    = NULL,  @I_iLangID int    = NULL,  @O_vMessage varchar(255) = NULL output,   @O_iErrorState int    = NULL output  as   declare  @sLanguageID smallint,  @TableAliasMSG varchar(255),  @FieldAliasMSG varchar(255),  @iStatus int,   @iErrorState int   if @I_iFieldMessageNumber is NULL begin  select @O_iErrorState = 20267  return end if @I_iTableAliasMessageNumber is NULL begin  select @O_iErrorState = 20267  return end if @I_iDictID is NULL begin  select @O_iErrorState = 20267  return end  select @O_iErrorState = 0  select @TableAliasMSG = ''  if @I_iTableAliasMessageNumber <> 0 begin  select @TableAliasMSG =  rtrim(SQL_MSG)   from SY10996   where MSGNUM = @I_iTableAliasMessageNumber and  DICTID = @I_iDictID and   Language_ID = @I_iLangID   if PATINDEX ('%',@TableAliasMSG) = 1  select @TableAliasMSG = SUBSTRING(@TableAliasMSG,3,LEN(@TableAliasMSG)) end  if @I_iTableAliasMessageNumber <> 0 begin  if @TableAliasMSG = ''  begin  select @TableAliasMSG =  rtrim(SQL_MSG)   from SY10996   where MSGNUM = @I_iTableAliasMessageNumber and  DICTID = @I_iDictID and   Language_ID = 0   if PATINDEX ('%',@TableAliasMSG) = 1  select @TableAliasMSG = SUBSTRING(@TableAliasMSG,3,LEN(@TableAliasMSG))  end end  select @FieldAliasMSG = ''  select @FieldAliasMSG =   rtrim(SQL_MSG)  from SY10996   where MSGNUM = @I_iFieldMessageNumber and  DICTID = @I_iDictID and   Language_ID = @I_iLangID  if @FieldAliasMSG = '' begin  select @FieldAliasMSG =   rtrim(SQL_MSG)   from SY10996   where MSGNUM = @I_iFieldMessageNumber and  DICTID = @I_iDictID and   Language_ID = 0 end  if @I_iTableAliasMessageNumber <> 0  select @O_vMessage = @FieldAliasMSG + @TableAliasMSG else  select @O_vMessage = @FieldAliasMSG select @O_vMessage = REPLACE(@O_vMessage, '''''', '''')  if @@rowcount <> 1  select @O_iErrorState = 20062 return    
GO
GRANT EXECUTE ON  [dbo].[smGetBIMsgStringForProcs] TO [DYNGRP]
GO
