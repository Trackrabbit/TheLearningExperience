SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_SY20000VL_1] (@PRODID_RS smallint, @RESID_RS smallint, @ReportStatus_RS smallint, @DSPLNAME_RS char(81), @CMPANYID_RS smallint, @PRODID_RE smallint, @RESID_RE smallint, @ReportStatus_RE smallint, @DSPLNAME_RE char(81), @CMPANYID_RE smallint) AS  set nocount on IF @PRODID_RS IS NULL BEGIN SELECT TOP 25  DSPLNAME, PRODID, ReportStatus, TemplateID, CMPANYID, RESID, IsDefault, DEX_ROW_ID FROM .SY20000V ORDER BY PRODID DESC, RESID DESC, ReportStatus DESC, DSPLNAME DESC, CMPANYID DESC END ELSE IF @PRODID_RS = @PRODID_RE BEGIN SELECT TOP 25  DSPLNAME, PRODID, ReportStatus, TemplateID, CMPANYID, RESID, IsDefault, DEX_ROW_ID FROM .SY20000V WHERE PRODID = @PRODID_RS AND RESID BETWEEN @RESID_RS AND @RESID_RE AND ReportStatus BETWEEN @ReportStatus_RS AND @ReportStatus_RE AND DSPLNAME BETWEEN @DSPLNAME_RS AND @DSPLNAME_RE AND CMPANYID BETWEEN @CMPANYID_RS AND @CMPANYID_RE ORDER BY PRODID DESC, RESID DESC, ReportStatus DESC, DSPLNAME DESC, CMPANYID DESC END ELSE BEGIN SELECT TOP 25  DSPLNAME, PRODID, ReportStatus, TemplateID, CMPANYID, RESID, IsDefault, DEX_ROW_ID FROM .SY20000V WHERE PRODID BETWEEN @PRODID_RS AND @PRODID_RE AND RESID BETWEEN @RESID_RS AND @RESID_RE AND ReportStatus BETWEEN @ReportStatus_RS AND @ReportStatus_RE AND DSPLNAME BETWEEN @DSPLNAME_RS AND @DSPLNAME_RE AND CMPANYID BETWEEN @CMPANYID_RS AND @CMPANYID_RE ORDER BY PRODID DESC, RESID DESC, ReportStatus DESC, DSPLNAME DESC, CMPANYID DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY20000VL_1] TO [DYNGRP]
GO
