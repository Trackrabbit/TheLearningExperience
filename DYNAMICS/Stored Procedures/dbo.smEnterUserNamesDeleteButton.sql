SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[smEnterUserNamesDeleteButton]  @I_cUserID char(15) = NULL,  @I_iSQLID int  = NULL,  @I_tControlLogin tinyint = NULL,  @I_tControlUser tinyint = NULL,  @O_iErrorState int  = NULL output as  declare  @iError int,    @iStatus int,    @tTransaction tinyint,   @cMasterOwner char(30),   @cDynamicsOwner char(30),   @iNumberOfRows int,    @TRUE tinyint   if @I_cUserID is NULL   or @I_iSQLID is NULL  or @I_tControlLogin is NULL  or @I_tControlUser is NULL begin  select @O_iErrorState = 20181  return end  select  @O_iErrorState = 0,  @iStatus  = 0,  @tTransaction = NULL,  @iNumberOfRows = 0  exec @iStatus = dbo.smGetConstantInt  'TRUE',  @TRUE output,  @O_iErrorState output  select @iError = @@error if @iStatus = 0 and @iError <> 0 begin  select @iStatus = @iError end  if @iStatus <> 0 or @O_iErrorState <> 0  return @iStatus  delete  SY01400 where  USERID = @I_cUserID  if @@rowcount <> 1 begin  select @O_iErrorState = 20197  return end  select  @iNumberOfRows = count(USERID) from  SY01600 where  USERID = @I_cUserID  if @iNumberOfRows > 0  begin  delete  SY01600  where  USERID = @I_cUserID   if @@rowcount <> @iNumberOfRows  begin  select @O_iErrorState = 20199  return  end end  select  @iNumberOfRows = count(CMPANYID) from  SY10500 where  USERID = @I_cUserID  if @iNumberOfRows > 0  begin  delete from   SY10500  where  USERID = @I_cUserID   if @@rowcount <> @iNumberOfRows  begin  select @O_iErrorState = 21104   return  end end  select  @iNumberOfRows = count(CMPANYID) from  SY10550 where  USERID = @I_cUserID  if @iNumberOfRows > 0  begin  delete from   SY10550  where  USERID = @I_cUserID   if @@rowcount <> @iNumberOfRows  begin  select @O_iErrorState = 21105   return  end end  return    
GO
GRANT EXECUTE ON  [dbo].[smEnterUserNamesDeleteButton] TO [DYNGRP]
GO
