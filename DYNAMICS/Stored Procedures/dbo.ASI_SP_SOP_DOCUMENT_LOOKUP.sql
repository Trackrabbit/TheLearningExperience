SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[ASI_SP_SOP_DOCUMENT_LOOKUP]  @temptable varchar(20),  @table varchar(20),  @db varchar(20),  @from1 varchar (254),  @from2 varchar (254),  @from3 varchar (254),  @from4 varchar (254),  @from5 varchar (254),  @from6 varchar (254),  @from7 varchar (254),  @from8 varchar (254),  @from9 varchar (254),  @where1 varchar (254),  @where2 varchar (254),  @where3 varchar (254),  @where4 varchar (254),  @where5 varchar (254),  @where6 varchar (254),  @where7 varchar (254),  @where8 varchar (254),  @where9 varchar (254) AS  declare @cmd varchar(5000) set @cmd = 'delete ' + @temptable +  ' insert ' + @temptable + ' SELECT ' +  @db + @table + '.SOPTYPE,' + @db + @table + '.SOPNUMBE,' + @db + @table + '.ORIGTYPE,' + @db + @table + '.ORIGNUMB,' + @db + @table + '.DOCID,' + @db + @table + '.DOCDATE,' + @db + @table + '.GLPOSTDT,' + @db + @table + '.QUOTEDAT,' + @db + @table + '.QUOEXPDA,' + @db + @table + '.ORDRDATE,' + @db + @table + '.INVODATE,' + @db + @table + '.BACKDATE,' + @db + @table + '.RETUDATE,' + @db + @table + '.ReqShipDate,' + @db + @table + '.FUFILDAT,' + @db + @table + '.ACTLSHIP,' + @db + @table + '.DISCDATE,' + @db + @table + '.DUEDATE,' + @db + @table + '.REPTING,' + @db + @table + '.TRXFREQU,' + @db + @table + '.TIMEREPD,' + @db + @table + '.TIMETREP,' + @db + @table + '.DYSTINCR,' + @db + @table + '.DTLSTREP,' + @db + @table + '.DSTBTCH1,' + @db + @table + '.DSTBTCH2,' + @db + @table + '.USDOCID1,' + @db + @table + '.USDOCID2,' + @db + @table + '.DISCFRGT,' + @db + @table + '.ORDAVFRT,' + @db + @table + '.DISCMISC,' + @db + @table + '.ORDAVMSC,' + @db + @table + '.DISAVAMT,' + @db + @table + '.ORDAVAMT,' + @db + @table + '.DISCRTND,' + @db + @table + '.ORDISRTD,' + @db + @table + '.DISTKNAM,' + @db + @table + '.ORDISTKN,' + @db + @table + '.DSCPCTAM,' + @db + @table + '.DSCDLRAM,' + @db + @table + '.ORDDLRAT,' + @db + @table + '.DISAVTKN,' + @db + @table + '.ORDATKN,' + @db + @table + '.PYMTRMID,' + @db + @table + '.PRCLEVEL,' + @db + @table + '.LOCNCODE,' + @db + @table + '.BCHSOURC,' + @db + @table + '.BACHNUMB,' + @db + @table + '.CUSTNMBR,' + @db + @table + '.CUSTNAME,' + @db + @table + '.CSTPONBR,' + @db + @table + '.PROSPECT,' + @db + @table + '.MSTRNUMB,' + @db + @table + '.PCKSLPNO,' + @db + @table + '.PICTICNU,' + @db + @table + '.MRKDNAMT,' + @db + @table + '.ORMRKDAM,' + @db + @table + '.PRBTADCD,' + @db + @table + '.PRSTADCD,' + @db + @table + '.CNTCPRSN,' + @db + @table + '.ShipToName,' + @db + @table + '.ADDRESS1,' + @db + @table + '.ADDRESS2,' + @db + @table + '.ADDRESS3,' + @db + @table + '.CITY,' + @db + @table + '.STATE,' + @db + @table + '.ZIPCODE,' + @db + @table + '.COUNTRY,' + @db + @table + '.PHNUMBR1,' + @db + @table + '.PHNUMBR2,' + @db + @table + '.PHONE3,' + @db + @table + '.FAXNUMBR,' + @db + @table + '.COMAPPTO,' + @db + @table + '.COMMAMNT,' + @db + @table + '.OCOMMAMT,' + @db + @table + '.CMMSLAMT,' + @db + @table + '.ORCOSAMT,' + @db + @table + '.NCOMAMNT,' + @db + @table + '.ORNCMAMT,' + @db + @table + '.SHIPMTHD,' + @db + @table + '.TRDISAMT,' + @db + @table + '.ORTDISAM,' + @db + @table + '.TRDISPCT,' + @db + @table + '.SUBTOTAL,' + @db + @table + '.ORSUBTOT,' + @db + @table + '.REMSUBTO,' + @db + @table + '.OREMSUBT,' + @db + @table + '.EXTDCOST,' + @db + @table + '.OREXTCST,' + @db + @table + '.FRTAMNT,' + @db + @table + '.ORFRTAMT,' + @db + @table + '.MISCAMNT,' + @db + @table + '.ORMISCAMT,' + @db + @table + '.TXENGCLD,' + @db + @table + '.TAXEXMT1,' + @db + @table + '.TAXEXMT2,' + @db + @table + '.TXRGNNUM,' + @db + @table + '.TAXSCHID,' + @db + @table + '.TXSCHSRC,' + @db + @table + '.BSIVCTTL,' + @db + @table + '.FRTSCHID,' + @db + @table + '.FRTTXAMT,' + @db + @table + '.ORFRTTAX,' + @db + @table + '.FRGTTXBL,' + @db + @table + '.MSCSCHID,' + @db + @table + '.MSCTXAMT,' + @db + @table + '.ORMSCTAX,' + @db + @table + '.MISCTXBL,' + @db + @table + '.BKTFRTAM,' + @db + @table + '.ORBKTFRT,' + @db + @table + '.BKTMSCAM,' + @db + @table + '.ORBKTMSC,' + @db + @table + '.BCKTXAMT,' + @db + @table + '.OBTAXAMT,' + @db + @table + '.TXBTXAMT,' + @db + @table + '.OTAXTAMT,' + @db + @table + '.TAXAMNT,' + @db + @table + '.ORTAXAMT,' + @db + @table + '.ECTRX,' + @db + @table + '.DOCAMNT,' + @db + @table + '.ORDOCAMT,' + @db + @table + '.PYMTRCVD,' + @db + @table + '.ORPMTRVD,' + @db + @table + '.DEPRECVD,' + @db + @table + '.ORDEPRVD,' + @db + @table + '.CODAMNT,' + @db + @table + '.ORCODAMT,' + @db + @table + '.ACCTAMNT,' + @db + @table + '.ORACTAMT,' + @db + @table + '.SALSTERR,' + @db + @table + '.SLPRSNID,' + @db + @table + '.UPSZONE,' + @db + @table + '.TIMESPRT,' + @db + @table + '.PSTGSTUS,' + @db + @table + '.VOIDSTTS,' + @db + @table + '.ALLOCABY,' + @db + @table + '.NOTEINDX,' + @db + @table + '.CURNCYID,' + @db + @table + '.CURRNIDX,' + @db + @table + '.RATETPID,' + @db + @table + '.EXGTBLID,' + @db + @table + '.XCHGRATE,' + @db + @table + '.DENXRATE,' + @db + @table + '.EXCHDATE,' + @db + @table + '.TIME1,' + @db + @table + '.RTCLCMTD,' + @db + @table + '.MCTRXSTT,' + @db + @table + '.TRXSORCE,' + @db + @table + '.SOPHDRE1,' + @db + @table + '.SOPHDRE2,' + @db + @table + '.SOPLNERR,' + @db + @table + '.SOPHDRFL,' if @table = 'SOP10100'  set @cmd = @cmd + @db + @table + '.SOPMCERR,' else  set @cmd = @cmd + '0x00000000,' set @cmd = @cmd + @db + @table + '.COMMNTID,' + @db + @table + '.REFRENCE,' + @db + @table + '.POSTEDDT,' + @db + @table + '.PTDUSRID,' + @db + @table + '.USER2ENT,' + @db + @table + '.CREATDDT,' + @db + @table + '.MODIFDT,' + @db + @table + '.Tax_Date,' + @db + @table + '.APLYWITH,' + @db + @table + '.WITHHAMT,' + @db + @table + '.SHPPGDOC,' + @db + @table + '.CORRCTN,' + @db + @table + '.SIMPLIFD,' if @table = 'SOP10100'  set @cmd = @cmd + @db + @table + '.CORRNXST,' else  set @cmd = @cmd + '0,' set @cmd = @cmd + @db + @table + '.DOCNCORR,' + @db + @table + '.SEQNCORR,' + @db + @table + '.SALEDATE,' if @table = 'SOP10100'  set @cmd = @cmd +  @db + @table + '.SOPHDRE3,' +  @db + @table + '.EXCEPTIONALDEMAND' else  set @cmd = @cmd +  '0x00000000,' +  '0' exec( @cmd +  @from1 + @from2 + @from3 + @from4 + @from5 + @from6 + @from7 + @from8 + @from9 + @where1 + @where2 + @where3 + @where4 + @where5 + @where6 + @where7 + @where8 + @where9  )   
GO
GRANT EXECUTE ON  [dbo].[ASI_SP_SOP_DOCUMENT_LOOKUP] TO [DYNGRP]
GO
