SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_HRAPP003N_5] (@BS int, @REVIEWRATINGDECIMA_I numeric(19,5), @DEX_ROW_ID int, @REVIEWRATINGDECIMA_I_RS numeric(19,5), @REVIEWRATINGDECIMA_I_RE numeric(19,5)) AS  set nocount on IF @REVIEWRATINGDECIMA_I_RS IS NULL BEGIN SELECT TOP 25  APPLICANTNUMBER_I, APPINTTYPECODE_I, APPINTTYPESTR_I, APPLYDATE_I, COMPANYCODE_I, DIVISIONCODE_I, DEPARTMENTCODE_I, POSITIONCODE_I, EFFECTIVEDATE_I, REVIEWRATINGDECIMA_I, REVIEWRANGE_I, WEIGHTSUM_I, TOTALWEIGHT_I, NOTESINDEX_I, DEX_ROW_ID FROM .HRAPP003 WHERE ( REVIEWRATINGDECIMA_I = @REVIEWRATINGDECIMA_I AND DEX_ROW_ID > @DEX_ROW_ID OR REVIEWRATINGDECIMA_I < @REVIEWRATINGDECIMA_I ) ORDER BY REVIEWRATINGDECIMA_I DESC, DEX_ROW_ID ASC END ELSE IF @REVIEWRATINGDECIMA_I_RS = @REVIEWRATINGDECIMA_I_RE BEGIN SELECT TOP 25  APPLICANTNUMBER_I, APPINTTYPECODE_I, APPINTTYPESTR_I, APPLYDATE_I, COMPANYCODE_I, DIVISIONCODE_I, DEPARTMENTCODE_I, POSITIONCODE_I, EFFECTIVEDATE_I, REVIEWRATINGDECIMA_I, REVIEWRANGE_I, WEIGHTSUM_I, TOTALWEIGHT_I, NOTESINDEX_I, DEX_ROW_ID FROM .HRAPP003 WHERE REVIEWRATINGDECIMA_I = @REVIEWRATINGDECIMA_I_RE AND ( REVIEWRATINGDECIMA_I = @REVIEWRATINGDECIMA_I AND DEX_ROW_ID > @DEX_ROW_ID OR REVIEWRATINGDECIMA_I < @REVIEWRATINGDECIMA_I ) ORDER BY REVIEWRATINGDECIMA_I DESC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  APPLICANTNUMBER_I, APPINTTYPECODE_I, APPINTTYPESTR_I, APPLYDATE_I, COMPANYCODE_I, DIVISIONCODE_I, DEPARTMENTCODE_I, POSITIONCODE_I, EFFECTIVEDATE_I, REVIEWRATINGDECIMA_I, REVIEWRANGE_I, WEIGHTSUM_I, TOTALWEIGHT_I, NOTESINDEX_I, DEX_ROW_ID FROM .HRAPP003 WHERE REVIEWRATINGDECIMA_I BETWEEN @REVIEWRATINGDECIMA_I_RE AND @REVIEWRATINGDECIMA_I_RS AND ( REVIEWRATINGDECIMA_I = @REVIEWRATINGDECIMA_I AND DEX_ROW_ID > @DEX_ROW_ID OR REVIEWRATINGDECIMA_I < @REVIEWRATINGDECIMA_I ) ORDER BY REVIEWRATINGDECIMA_I DESC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_HRAPP003N_5] TO [DYNGRP]
GO
