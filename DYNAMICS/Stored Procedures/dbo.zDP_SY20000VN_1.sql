SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_SY20000VN_1] (@BS int, @PRODID smallint, @RESID smallint, @ReportStatus smallint, @DSPLNAME char(81), @CMPANYID smallint, @PRODID_RS smallint, @RESID_RS smallint, @ReportStatus_RS smallint, @DSPLNAME_RS char(81), @CMPANYID_RS smallint, @PRODID_RE smallint, @RESID_RE smallint, @ReportStatus_RE smallint, @DSPLNAME_RE char(81), @CMPANYID_RE smallint) AS  set nocount on IF @PRODID_RS IS NULL BEGIN SELECT TOP 25  DSPLNAME, PRODID, ReportStatus, TemplateID, CMPANYID, RESID, IsDefault, DEX_ROW_ID FROM .SY20000V WHERE ( PRODID = @PRODID AND RESID = @RESID AND ReportStatus = @ReportStatus AND DSPLNAME = @DSPLNAME AND CMPANYID > @CMPANYID OR PRODID = @PRODID AND RESID = @RESID AND ReportStatus = @ReportStatus AND DSPLNAME > @DSPLNAME OR PRODID = @PRODID AND RESID = @RESID AND ReportStatus > @ReportStatus OR PRODID = @PRODID AND RESID > @RESID OR PRODID > @PRODID ) ORDER BY PRODID ASC, RESID ASC, ReportStatus ASC, DSPLNAME ASC, CMPANYID ASC END ELSE IF @PRODID_RS = @PRODID_RE BEGIN SELECT TOP 25  DSPLNAME, PRODID, ReportStatus, TemplateID, CMPANYID, RESID, IsDefault, DEX_ROW_ID FROM .SY20000V WHERE PRODID = @PRODID_RS AND RESID BETWEEN @RESID_RS AND @RESID_RE AND ReportStatus BETWEEN @ReportStatus_RS AND @ReportStatus_RE AND DSPLNAME BETWEEN @DSPLNAME_RS AND @DSPLNAME_RE AND CMPANYID BETWEEN @CMPANYID_RS AND @CMPANYID_RE AND ( PRODID = @PRODID AND RESID = @RESID AND ReportStatus = @ReportStatus AND DSPLNAME = @DSPLNAME AND CMPANYID > @CMPANYID OR PRODID = @PRODID AND RESID = @RESID AND ReportStatus = @ReportStatus AND DSPLNAME > @DSPLNAME OR PRODID = @PRODID AND RESID = @RESID AND ReportStatus > @ReportStatus OR PRODID = @PRODID AND RESID > @RESID OR PRODID > @PRODID ) ORDER BY PRODID ASC, RESID ASC, ReportStatus ASC, DSPLNAME ASC, CMPANYID ASC END ELSE BEGIN SELECT TOP 25  DSPLNAME, PRODID, ReportStatus, TemplateID, CMPANYID, RESID, IsDefault, DEX_ROW_ID FROM .SY20000V WHERE PRODID BETWEEN @PRODID_RS AND @PRODID_RE AND RESID BETWEEN @RESID_RS AND @RESID_RE AND ReportStatus BETWEEN @ReportStatus_RS AND @ReportStatus_RE AND DSPLNAME BETWEEN @DSPLNAME_RS AND @DSPLNAME_RE AND CMPANYID BETWEEN @CMPANYID_RS AND @CMPANYID_RE AND ( PRODID = @PRODID AND RESID = @RESID AND ReportStatus = @ReportStatus AND DSPLNAME = @DSPLNAME AND CMPANYID > @CMPANYID OR PRODID = @PRODID AND RESID = @RESID AND ReportStatus = @ReportStatus AND DSPLNAME > @DSPLNAME OR PRODID = @PRODID AND RESID = @RESID AND ReportStatus > @ReportStatus OR PRODID = @PRODID AND RESID > @RESID OR PRODID > @PRODID ) ORDER BY PRODID ASC, RESID ASC, ReportStatus ASC, DSPLNAME ASC, CMPANYID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY20000VN_1] TO [DYNGRP]
GO
