SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE PROC [dbo].[zDP_NCIC1004N_3] (@BS int, @Remote_Company_ID char(5), @CMPANYID smallint, @JRNENTRY int, @SQNCLINE numeric(19,5), @Remote_Company_ID_RS char(5), @CMPANYID_RS smallint, @JRNENTRY_RS int, @SQNCLINE_RS numeric(19,5), @Remote_Company_ID_RE char(5), @CMPANYID_RE smallint, @JRNENTRY_RE int, @SQNCLINE_RE numeric(19,5)) AS /* 14.00.0084.000 */ set nocount on IF @Remote_Company_ID_RS IS NULL BEGIN SELECT TOP 25  CMPANYID, NC_Source_Company_ID, NC_Src_Account_Index, NC_Src_IC_Account_Index, NC_Dest_Account_Index, NC_Dest_IC_Account_Index, NC_Trigger_Account_Index, JRNENTRY, SQNCLINE, ACTINDX, DEBITAMT, CRDTAMNT, ORDBTAMT, ORCRDAMT, XCHGRATE, DSCRIPTN, GLLINMSG, GLLINMS2, CURRNIDX, DECPLACS, ORCTRNUM, ORDOCNUM, ORMSTRID, ORMSTRNM, ORTRXTYP, OrigSeqNum, OrigDTASeries, SEQNUMBR, DTA_GL_Status, DTAREF, DTA_Index, RATETPID, EXGTBLID, EXCHDATE, TIME1, RTCLCMTD, DENXRATE, MCTRXSTT, NC_Src_Batch_Created, NC_Dest_Batch_Created, NC_Copy_MDA_CB, NC_Reverse_MDA_CB, MKDTOPST, SOURCDOC, USERID, TRXDATE, CURRVAL, DATE1, String1, STRGA255, IntegerValue, NC_Source_Currency_Index, SERIES, Remote_Company_ID, Remote_Destination_Accou, Remote_Destination_IC_Ac, MCSTRUCT_1, MCSTRUCT_2, MCSTRUCT_3, MCSTRUCT_4, MCSTRUCT_5, MCSTRUCT_6, MCSTRUCT_7, MCSTRUCT_8, MCSTRUCT_9, MCSTRUCT_10, MCSTRUCT_11, MCSTRUCT_12, MCSTRUCT_13, MCSTRUCT_14, ORTRXDESC, NC_Spare_Int, NC_Bank_Currency_ID, NC_FunctionalOriginating, DEX_ROW_ID FROM .NCIC1004 WHERE ( Remote_Company_ID = @Remote_Company_ID AND CMPANYID = @CMPANYID AND JRNENTRY = @JRNENTRY AND SQNCLINE > @SQNCLINE OR Remote_Company_ID = @Remote_Company_ID AND CMPANYID = @CMPANYID AND JRNENTRY > @JRNENTRY OR Remote_Company_ID = @Remote_Company_ID AND CMPANYID > @CMPANYID OR Remote_Company_ID > @Remote_Company_ID ) ORDER BY Remote_Company_ID ASC, CMPANYID ASC, JRNENTRY ASC, SQNCLINE ASC END ELSE IF @Remote_Company_ID_RS = @Remote_Company_ID_RE BEGIN SELECT TOP 25  CMPANYID, NC_Source_Company_ID, NC_Src_Account_Index, NC_Src_IC_Account_Index, NC_Dest_Account_Index, NC_Dest_IC_Account_Index, NC_Trigger_Account_Index, JRNENTRY, SQNCLINE, ACTINDX, DEBITAMT, CRDTAMNT, ORDBTAMT, ORCRDAMT, XCHGRATE, DSCRIPTN, GLLINMSG, GLLINMS2, CURRNIDX, DECPLACS, ORCTRNUM, ORDOCNUM, ORMSTRID, ORMSTRNM, ORTRXTYP, OrigSeqNum, OrigDTASeries, SEQNUMBR, DTA_GL_Status, DTAREF, DTA_Index, RATETPID, EXGTBLID, EXCHDATE, TIME1, RTCLCMTD, DENXRATE, MCTRXSTT, NC_Src_Batch_Created, NC_Dest_Batch_Created, NC_Copy_MDA_CB, NC_Reverse_MDA_CB, MKDTOPST, SOURCDOC, USERID, TRXDATE, CURRVAL, DATE1, String1, STRGA255, IntegerValue, NC_Source_Currency_Index, SERIES, Remote_Company_ID, Remote_Destination_Accou, Remote_Destination_IC_Ac, MCSTRUCT_1, MCSTRUCT_2, MCSTRUCT_3, MCSTRUCT_4, MCSTRUCT_5, MCSTRUCT_6, MCSTRUCT_7, MCSTRUCT_8, MCSTRUCT_9, MCSTRUCT_10, MCSTRUCT_11, MCSTRUCT_12, MCSTRUCT_13, MCSTRUCT_14, ORTRXDESC, NC_Spare_Int, NC_Bank_Currency_ID, NC_FunctionalOriginating, DEX_ROW_ID FROM .NCIC1004 WHERE Remote_Company_ID = @Remote_Company_ID_RS AND CMPANYID BETWEEN @CMPANYID_RS AND @CMPANYID_RE AND JRNENTRY BETWEEN @JRNENTRY_RS AND @JRNENTRY_RE AND SQNCLINE BETWEEN @SQNCLINE_RS AND @SQNCLINE_RE AND ( Remote_Company_ID = @Remote_Company_ID AND CMPANYID = @CMPANYID AND JRNENTRY = @JRNENTRY AND SQNCLINE > @SQNCLINE OR Remote_Company_ID = @Remote_Company_ID AND CMPANYID = @CMPANYID AND JRNENTRY > @JRNENTRY OR Remote_Company_ID = @Remote_Company_ID AND CMPANYID > @CMPANYID OR Remote_Company_ID > @Remote_Company_ID ) ORDER BY Remote_Company_ID ASC, CMPANYID ASC, JRNENTRY ASC, SQNCLINE ASC END ELSE BEGIN SELECT TOP 25  CMPANYID, NC_Source_Company_ID, NC_Src_Account_Index, NC_Src_IC_Account_Index, NC_Dest_Account_Index, NC_Dest_IC_Account_Index, NC_Trigger_Account_Index, JRNENTRY, SQNCLINE, ACTINDX, DEBITAMT, CRDTAMNT, ORDBTAMT, ORCRDAMT, XCHGRATE, DSCRIPTN, GLLINMSG, GLLINMS2, CURRNIDX, DECPLACS, ORCTRNUM, ORDOCNUM, ORMSTRID, ORMSTRNM, ORTRXTYP, OrigSeqNum, OrigDTASeries, SEQNUMBR, DTA_GL_Status, DTAREF, DTA_Index, RATETPID, EXGTBLID, EXCHDATE, TIME1, RTCLCMTD, DENXRATE, MCTRXSTT, NC_Src_Batch_Created, NC_Dest_Batch_Created, NC_Copy_MDA_CB, NC_Reverse_MDA_CB, MKDTOPST, SOURCDOC, USERID, TRXDATE, CURRVAL, DATE1, String1, STRGA255, IntegerValue, NC_Source_Currency_Index, SERIES, Remote_Company_ID, Remote_Destination_Accou, Remote_Destination_IC_Ac, MCSTRUCT_1, MCSTRUCT_2, MCSTRUCT_3, MCSTRUCT_4, MCSTRUCT_5, MCSTRUCT_6, MCSTRUCT_7, MCSTRUCT_8, MCSTRUCT_9, MCSTRUCT_10, MCSTRUCT_11, MCSTRUCT_12, MCSTRUCT_13, MCSTRUCT_14, ORTRXDESC, NC_Spare_Int, NC_Bank_Currency_ID, NC_FunctionalOriginating, DEX_ROW_ID FROM .NCIC1004 WHERE Remote_Company_ID BETWEEN @Remote_Company_ID_RS AND @Remote_Company_ID_RE AND CMPANYID BETWEEN @CMPANYID_RS AND @CMPANYID_RE AND JRNENTRY BETWEEN @JRNENTRY_RS AND @JRNENTRY_RE AND SQNCLINE BETWEEN @SQNCLINE_RS AND @SQNCLINE_RE AND ( Remote_Company_ID = @Remote_Company_ID AND CMPANYID = @CMPANYID AND JRNENTRY = @JRNENTRY AND SQNCLINE > @SQNCLINE OR Remote_Company_ID = @Remote_Company_ID AND CMPANYID = @CMPANYID AND JRNENTRY > @JRNENTRY OR Remote_Company_ID = @Remote_Company_ID AND CMPANYID > @CMPANYID OR Remote_Company_ID > @Remote_Company_ID ) ORDER BY Remote_Company_ID ASC, CMPANYID ASC, JRNENTRY ASC, SQNCLINE ASC END set nocount off 
GO
GRANT EXECUTE ON  [dbo].[zDP_NCIC1004N_3] TO [DYNGRP]
GO
