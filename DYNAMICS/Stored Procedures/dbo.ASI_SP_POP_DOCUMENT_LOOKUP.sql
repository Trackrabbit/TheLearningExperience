SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[ASI_SP_POP_DOCUMENT_LOOKUP]  @temptable varchar(20),  @table varchar(20),  @db varchar(20),  @from1 varchar (254),  @from2 varchar (254),  @from3 varchar (254),  @from4 varchar (254),  @from5 varchar (254),  @from6 varchar (254),  @from7 varchar (254),  @from8 varchar (254),  @from9 varchar (254),  @where1 varchar (254),  @where2 varchar (254),  @where3 varchar (254),  @where4 varchar (254),  @where5 varchar (254),  @where6 varchar (254),  @where7 varchar (254),  @where8 varchar (254),  @where9 varchar (254) AS  declare @cmd varchar(5000)  set @cmd = 'delete ' + @temptable +  ' insert ' + @temptable + ' SELECT ' +  @db + @table + '.PONUMBER,' + @db + @table + '.POSTATUS,' + @db + @table + '.STATGRP,' + @db + @table + '.POTYPE,' + @db + @table + '.USER2ENT,' + @db + @table + '.CONFIRM1,' + @db + @table + '.DOCDATE,' + @db + @table + '.LSTEDTDT,' + @db + @table + '.LSTPRTDT,' + @db + @table + '.PRMDATE,' + @db + @table + '.PRMSHPDTE,' + @db + @table + '.REQDATE,' + @db + @table + '.REQTNDT,' + @db + @table + '.SHIPMTHD,' + @db + @table + '.TXRGNNUM,' + @db + @table + '.REMSUBTO,' + @db + @table + '.SUBTOTAL,' + @db + @table + '.TRDISAMT,' + @db + @table + '.FRTAMNT,' + @db + @table + '.MSCCHAMT,' + @db + @table + '.TAXAMNT,' + @db + @table + '.VENDORID,' + @db + @table + '.VENDNAME,' + @db + @table + '.MINORDER,' + @db + @table + '.VADCDPAD,' + @db + @table + '.CMPANYID,' + @db + @table + '.PRBTADCD,' + @db + @table + '.PRSTADCD,' + @db + @table + '.CMPNYNAM,' + @db + @table + '.CONTACT,' + @db + @table + '.ADDRESS1,' + @db + @table + '.ADDRESS2,' + @db + @table + '.ADDRESS3,' + @db + @table + '.CITY,' + @db + @table + '.STATE,' + @db + @table + '.ZIPCODE,' + @db + @table + '.COUNTRY,' + @db + @table + '.PHONE1,' + @db + @table + '.PHONE2,' + @db + @table + '.PHONE3,' + @db + @table + '.FAX,' + @db + @table + '.PYMTRMID,' + @db + @table + '.DSCDLRAM,' + @db + @table + '.DSCPCTAM,' + @db + @table + '.DISAMTAV,' + @db + @table + '.DISCDATE,' + @db + @table + '.DUEDATE,' + @db + @table + '.TRDPCTPR,' + @db + @table + '.CUSTNMBR,' + @db + @table + '.TIMESPRT,' + @db + @table + '.CREATDDT,' + @db + @table + '.MODIFDT,' + @db + @table + '.PONOTIDS_1,' + @db + @table + '.PONOTIDS_2,' + @db + @table + '.PONOTIDS_3,' + @db + @table + '.PONOTIDS_4,' + @db + @table + '.PONOTIDS_5,' + @db + @table + '.PONOTIDS_6,' + @db + @table + '.PONOTIDS_7,' + @db + @table + '.PONOTIDS_8,' + @db + @table + '.PONOTIDS_9,' + @db + @table + '.PONOTIDS_10,' + @db + @table + '.PONOTIDS_11,' + @db + @table + '.PONOTIDS_12,' + @db + @table + '.PONOTIDS_13,' + @db + @table + '.PONOTIDS_14,' + @db + @table + '.PONOTIDS_15,' + @db + @table + '.COMMNTID,' + @db + @table + '.CANCSUB,' + @db + @table + '.CURNCYID,' + @db + @table + '.CURRNIDX,' + @db + @table + '.RATETPID,' + @db + @table + '.EXGTBLID,' + @db + @table + '.XCHGRATE,' + @db + @table + '.EXCHDATE,' + @db + @table + '.TIME1,' + @db + @table + '.RATECALC,' + @db + @table + '.DENXRATE,' + @db + @table + '.MCTRXSTT,' + @db + @table + '.OREMSUBT,' + @db + @table + '.ORSUBTOT,' + @db + @table + '.Originating_Canceled_Sub,' + @db + @table + '.ORTDISAM,' + @db + @table + '.ORFRTAMT,' + @db + @table + '.OMISCAMT,' + @db + @table + '.ORTAXAMT,' + @db + @table + '.ORDDLRAT,' + @db + @table + '.ODISAMTAV,' + @db + @table + '.BUYERID,' if @table = 'POP10100'  set @cmd = @cmd +   @db + @table + '.ONORDAMT,' +  @db + @table + '.ORORDAMT,' +  @db + @table + '.HOLD,' +  @db + @table + '.ONHOLDDATE,' +  @db + @table + '.ONHOLDBY,' +  @db + @table + '.HOLDREMOVEDATE,' +  @db + @table + '.HOLDREMOVEBY,' else  set @cmd = @cmd +   'CONVERT(money,0.0000),' +  'CONVERT(money,0.0000),' +  'CONVERT(numeric,0),' +  'convert(datetime,01/01/1900),' +  ''''',' +  'convert(datetime,01/01/1900),' +  ''''',' set @cmd = @cmd + @db + @table + '.ALLOWSOCMTS,' + @db + @table + '.DISGRPER,' + @db + @table + '.DUEGRPER,' + @db + @table + '.Revision_Number,' if @table = 'POP10100'  set @cmd = @cmd +   @db + @table + '.Change_Order_Flag,' +  @db + @table + '.PO_Field_Changes,' +  @db + @table + '.PO_Status_Orig,' else  set @cmd = @cmd +  'CONVERT(numeric,0),' +  '0x00000000,' +  'CONVERT(numeric,0),' set @cmd = @cmd + @db + @table + '.TAXSCHID,' + @db + @table + '.BSIVCTTL,' + @db + @table + '.Purchase_Freight_Taxable,' + @db + @table + '.Purchase_Misc_Taxable,' + @db + @table + '.FRTSCHID,' + @db + @table + '.MSCSCHID,' + @db + @table + '.FRTTXAMT,' + @db + @table + '.ORFRTTAX,' + @db + @table + '.MSCTXAMT,' + @db + @table + '.ORMSCTAX,' + @db + @table + '.BCKTXAMT,' + @db + @table + '.OBTAXAMT,' + @db + @table + '.BackoutFreightTaxAmt,' + @db + @table + '.OrigBackoutFreightTaxAmt,' + @db + @table + '.BackoutMiscTaxAmt,' + @db + @table + '.OrigBackoutMiscTaxAmt,' if @table = 'POP10100'  set @cmd = @cmd +   @db + @table + '.BackoutTradeDiscTax,' +  @db + @table + '.OrigBackoutTradeDiscTax' else  set @cmd = @cmd +   '0.0,' +   '0.0' exec( @cmd +  @from1 + @from2 + @from3 + @from4 + @from5 + @from6 + @from7 + @from8 + @from9 + @where1 + @where2 + @where3 + @where4 + @where5 + @where6 + @where7 + @where8 + @where9  )   
GO
GRANT EXECUTE ON  [dbo].[ASI_SP_POP_DOCUMENT_LOOKUP] TO [DYNGRP]
GO
