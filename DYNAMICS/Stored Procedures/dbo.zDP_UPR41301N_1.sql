SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_UPR41301N_1] (@BS int, @TAXCODE char(7), @TXFLGSTS char(7), @TAXCODE_RS char(7), @TXFLGSTS_RS char(7), @TAXCODE_RE char(7), @TXFLGSTS_RE char(7)) AS  set nocount on IF @TAXCODE_RS IS NULL BEGIN SELECT TOP 25  TAXCODE, TXFLGSTS, STSDESCR, LINCLIM, PRSEXAMT, INCPSNEX, INCADALW, INCLDEPN, FDTXPRCT, FEDTXMAX, FICATXPT, FICATXMN, FLATAXRT, STDDMTHD, STDDPCNT, STDDEDAM, STDEDMIN, STDEDMAX, SPCLEXAM, SPCLSDED, SPCLTXRT, DEX_ROW_ID FROM .UPR41301 WHERE ( TAXCODE = @TAXCODE AND TXFLGSTS > @TXFLGSTS OR TAXCODE > @TAXCODE ) ORDER BY TAXCODE ASC, TXFLGSTS ASC END ELSE IF @TAXCODE_RS = @TAXCODE_RE BEGIN SELECT TOP 25  TAXCODE, TXFLGSTS, STSDESCR, LINCLIM, PRSEXAMT, INCPSNEX, INCADALW, INCLDEPN, FDTXPRCT, FEDTXMAX, FICATXPT, FICATXMN, FLATAXRT, STDDMTHD, STDDPCNT, STDDEDAM, STDEDMIN, STDEDMAX, SPCLEXAM, SPCLSDED, SPCLTXRT, DEX_ROW_ID FROM .UPR41301 WHERE TAXCODE = @TAXCODE_RS AND TXFLGSTS BETWEEN @TXFLGSTS_RS AND @TXFLGSTS_RE AND ( TAXCODE = @TAXCODE AND TXFLGSTS > @TXFLGSTS OR TAXCODE > @TAXCODE ) ORDER BY TAXCODE ASC, TXFLGSTS ASC END ELSE BEGIN SELECT TOP 25  TAXCODE, TXFLGSTS, STSDESCR, LINCLIM, PRSEXAMT, INCPSNEX, INCADALW, INCLDEPN, FDTXPRCT, FEDTXMAX, FICATXPT, FICATXMN, FLATAXRT, STDDMTHD, STDDPCNT, STDDEDAM, STDEDMIN, STDEDMAX, SPCLEXAM, SPCLSDED, SPCLTXRT, DEX_ROW_ID FROM .UPR41301 WHERE TAXCODE BETWEEN @TAXCODE_RS AND @TAXCODE_RE AND TXFLGSTS BETWEEN @TXFLGSTS_RS AND @TXFLGSTS_RE AND ( TAXCODE = @TAXCODE AND TXFLGSTS > @TXFLGSTS OR TAXCODE > @TAXCODE ) ORDER BY TAXCODE ASC, TXFLGSTS ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_UPR41301N_1] TO [DYNGRP]
GO
