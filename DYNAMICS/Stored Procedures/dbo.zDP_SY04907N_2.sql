SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_SY04907N_2] (@BS int, @EmailSeriesID smallint, @EmailDocumentID smallint, @DEX_ROW_ID int, @EmailSeriesID_RS smallint, @EmailDocumentID_RS smallint, @EmailSeriesID_RE smallint, @EmailDocumentID_RE smallint) AS  set nocount on IF @EmailSeriesID_RS IS NULL BEGIN SELECT TOP 25  EmailSeriesID, EmailDocumentID, Field_DictID, FIELDNAM, AdditionalFields, HistoryTable, OpenTable, WorkTable, HistOpenColumn, WorkColumn, Condition, DEX_ROW_ID FROM .SY04907 WHERE ( EmailSeriesID = @EmailSeriesID AND EmailDocumentID = @EmailDocumentID AND DEX_ROW_ID > @DEX_ROW_ID OR EmailSeriesID = @EmailSeriesID AND EmailDocumentID > @EmailDocumentID OR EmailSeriesID > @EmailSeriesID ) ORDER BY EmailSeriesID ASC, EmailDocumentID ASC, DEX_ROW_ID ASC END ELSE IF @EmailSeriesID_RS = @EmailSeriesID_RE BEGIN SELECT TOP 25  EmailSeriesID, EmailDocumentID, Field_DictID, FIELDNAM, AdditionalFields, HistoryTable, OpenTable, WorkTable, HistOpenColumn, WorkColumn, Condition, DEX_ROW_ID FROM .SY04907 WHERE EmailSeriesID = @EmailSeriesID_RS AND EmailDocumentID BETWEEN @EmailDocumentID_RS AND @EmailDocumentID_RE AND ( EmailSeriesID = @EmailSeriesID AND EmailDocumentID = @EmailDocumentID AND DEX_ROW_ID > @DEX_ROW_ID OR EmailSeriesID = @EmailSeriesID AND EmailDocumentID > @EmailDocumentID OR EmailSeriesID > @EmailSeriesID ) ORDER BY EmailSeriesID ASC, EmailDocumentID ASC, DEX_ROW_ID ASC END ELSE BEGIN SELECT TOP 25  EmailSeriesID, EmailDocumentID, Field_DictID, FIELDNAM, AdditionalFields, HistoryTable, OpenTable, WorkTable, HistOpenColumn, WorkColumn, Condition, DEX_ROW_ID FROM .SY04907 WHERE EmailSeriesID BETWEEN @EmailSeriesID_RS AND @EmailSeriesID_RE AND EmailDocumentID BETWEEN @EmailDocumentID_RS AND @EmailDocumentID_RE AND ( EmailSeriesID = @EmailSeriesID AND EmailDocumentID = @EmailDocumentID AND DEX_ROW_ID > @DEX_ROW_ID OR EmailSeriesID = @EmailSeriesID AND EmailDocumentID > @EmailDocumentID OR EmailSeriesID > @EmailSeriesID ) ORDER BY EmailSeriesID ASC, EmailDocumentID ASC, DEX_ROW_ID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY04907N_2] TO [DYNGRP]
GO
