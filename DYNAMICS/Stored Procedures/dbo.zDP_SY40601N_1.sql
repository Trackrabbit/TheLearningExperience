SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_SY40601N_1] (@BS int, @CMPANYID smallint, @CmdDictID smallint, @CmdFormID smallint, @CmdID smallint, @TYPEID smallint, @AssignedUserID char(15), @CMPANYID_RS smallint, @CmdDictID_RS smallint, @CmdFormID_RS smallint, @CmdID_RS smallint, @TYPEID_RS smallint, @AssignedUserID_RS char(15), @CMPANYID_RE smallint, @CmdDictID_RE smallint, @CmdFormID_RE smallint, @CmdID_RE smallint, @TYPEID_RE smallint, @AssignedUserID_RE char(15)) AS  set nocount on IF @CMPANYID_RS IS NULL BEGIN SELECT TOP 25  AssignNum, CmdDictID, CmdFormID, CmdID, AssignedUserID, TYPEID, STRTDATE, DUEDATE, Status, UserWhoCreated, CMPANYID, AssignmentDate, Completion_Date, COMPLETEDBY, DEX_ROW_ID, CMMTTEXT FROM .SY40601 WHERE ( CMPANYID = @CMPANYID AND CmdDictID = @CmdDictID AND CmdFormID = @CmdFormID AND CmdID = @CmdID AND TYPEID = @TYPEID AND AssignedUserID > @AssignedUserID OR CMPANYID = @CMPANYID AND CmdDictID = @CmdDictID AND CmdFormID = @CmdFormID AND CmdID = @CmdID AND TYPEID > @TYPEID OR CMPANYID = @CMPANYID AND CmdDictID = @CmdDictID AND CmdFormID = @CmdFormID AND CmdID > @CmdID OR CMPANYID = @CMPANYID AND CmdDictID = @CmdDictID AND CmdFormID > @CmdFormID OR CMPANYID = @CMPANYID AND CmdDictID > @CmdDictID OR CMPANYID > @CMPANYID ) ORDER BY CMPANYID ASC, CmdDictID ASC, CmdFormID ASC, CmdID ASC, TYPEID ASC, AssignedUserID ASC END ELSE IF @CMPANYID_RS = @CMPANYID_RE BEGIN SELECT TOP 25  AssignNum, CmdDictID, CmdFormID, CmdID, AssignedUserID, TYPEID, STRTDATE, DUEDATE, Status, UserWhoCreated, CMPANYID, AssignmentDate, Completion_Date, COMPLETEDBY, DEX_ROW_ID, CMMTTEXT FROM .SY40601 WHERE CMPANYID = @CMPANYID_RS AND CmdDictID BETWEEN @CmdDictID_RS AND @CmdDictID_RE AND CmdFormID BETWEEN @CmdFormID_RS AND @CmdFormID_RE AND CmdID BETWEEN @CmdID_RS AND @CmdID_RE AND TYPEID BETWEEN @TYPEID_RS AND @TYPEID_RE AND AssignedUserID BETWEEN @AssignedUserID_RS AND @AssignedUserID_RE AND ( CMPANYID = @CMPANYID AND CmdDictID = @CmdDictID AND CmdFormID = @CmdFormID AND CmdID = @CmdID AND TYPEID = @TYPEID AND AssignedUserID > @AssignedUserID OR CMPANYID = @CMPANYID AND CmdDictID = @CmdDictID AND CmdFormID = @CmdFormID AND CmdID = @CmdID AND TYPEID > @TYPEID OR CMPANYID = @CMPANYID AND CmdDictID = @CmdDictID AND CmdFormID = @CmdFormID AND CmdID > @CmdID OR CMPANYID = @CMPANYID AND CmdDictID = @CmdDictID AND CmdFormID > @CmdFormID OR CMPANYID = @CMPANYID AND CmdDictID > @CmdDictID OR CMPANYID > @CMPANYID ) ORDER BY CMPANYID ASC, CmdDictID ASC, CmdFormID ASC, CmdID ASC, TYPEID ASC, AssignedUserID ASC END ELSE BEGIN SELECT TOP 25  AssignNum, CmdDictID, CmdFormID, CmdID, AssignedUserID, TYPEID, STRTDATE, DUEDATE, Status, UserWhoCreated, CMPANYID, AssignmentDate, Completion_Date, COMPLETEDBY, DEX_ROW_ID, CMMTTEXT FROM .SY40601 WHERE CMPANYID BETWEEN @CMPANYID_RS AND @CMPANYID_RE AND CmdDictID BETWEEN @CmdDictID_RS AND @CmdDictID_RE AND CmdFormID BETWEEN @CmdFormID_RS AND @CmdFormID_RE AND CmdID BETWEEN @CmdID_RS AND @CmdID_RE AND TYPEID BETWEEN @TYPEID_RS AND @TYPEID_RE AND AssignedUserID BETWEEN @AssignedUserID_RS AND @AssignedUserID_RE AND ( CMPANYID = @CMPANYID AND CmdDictID = @CmdDictID AND CmdFormID = @CmdFormID AND CmdID = @CmdID AND TYPEID = @TYPEID AND AssignedUserID > @AssignedUserID OR CMPANYID = @CMPANYID AND CmdDictID = @CmdDictID AND CmdFormID = @CmdFormID AND CmdID = @CmdID AND TYPEID > @TYPEID OR CMPANYID = @CMPANYID AND CmdDictID = @CmdDictID AND CmdFormID = @CmdFormID AND CmdID > @CmdID OR CMPANYID = @CMPANYID AND CmdDictID = @CmdDictID AND CmdFormID > @CmdFormID OR CMPANYID = @CMPANYID AND CmdDictID > @CmdDictID OR CMPANYID > @CMPANYID ) ORDER BY CMPANYID ASC, CmdDictID ASC, CmdFormID ASC, CmdID ASC, TYPEID ASC, AssignedUserID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY40601N_1] TO [DYNGRP]
GO
