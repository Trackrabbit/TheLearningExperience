SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_SY07105L_1] (@USERID_RS char(15), @CmdDictID_RS smallint, @CmdFormID_RS smallint, @CmdID_RS smallint, @USERID_RE char(15), @CmdDictID_RE smallint, @CmdFormID_RE smallint, @CmdID_RE smallint) AS  set nocount on IF @USERID_RS IS NULL BEGIN SELECT TOP 25  USERID, CmdDictID, CmdFormID, CmdID, CmdCaption, CmdTooltip, CmdNormalImageType, CmdNormalImageDictID, CmdNormalImageResID, CmdCheckedImageType, CmdCheckedImageDictID, CmdCheckedImageResID, CmdMenuDisplayOption, CmdButtonDisplayOption, DEX_ROW_ID FROM .SY07105 ORDER BY USERID DESC, CmdDictID DESC, CmdFormID DESC, CmdID DESC END ELSE IF @USERID_RS = @USERID_RE BEGIN SELECT TOP 25  USERID, CmdDictID, CmdFormID, CmdID, CmdCaption, CmdTooltip, CmdNormalImageType, CmdNormalImageDictID, CmdNormalImageResID, CmdCheckedImageType, CmdCheckedImageDictID, CmdCheckedImageResID, CmdMenuDisplayOption, CmdButtonDisplayOption, DEX_ROW_ID FROM .SY07105 WHERE USERID = @USERID_RS AND CmdDictID BETWEEN @CmdDictID_RS AND @CmdDictID_RE AND CmdFormID BETWEEN @CmdFormID_RS AND @CmdFormID_RE AND CmdID BETWEEN @CmdID_RS AND @CmdID_RE ORDER BY USERID DESC, CmdDictID DESC, CmdFormID DESC, CmdID DESC END ELSE BEGIN SELECT TOP 25  USERID, CmdDictID, CmdFormID, CmdID, CmdCaption, CmdTooltip, CmdNormalImageType, CmdNormalImageDictID, CmdNormalImageResID, CmdCheckedImageType, CmdCheckedImageDictID, CmdCheckedImageResID, CmdMenuDisplayOption, CmdButtonDisplayOption, DEX_ROW_ID FROM .SY07105 WHERE USERID BETWEEN @USERID_RS AND @USERID_RE AND CmdDictID BETWEEN @CmdDictID_RS AND @CmdDictID_RE AND CmdFormID BETWEEN @CmdFormID_RS AND @CmdFormID_RE AND CmdID BETWEEN @CmdID_RS AND @CmdID_RE ORDER BY USERID DESC, CmdDictID DESC, CmdFormID DESC, CmdID DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY07105L_1] TO [DYNGRP]
GO
