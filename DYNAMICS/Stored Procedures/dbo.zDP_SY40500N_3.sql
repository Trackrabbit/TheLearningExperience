SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_SY40500N_3] (@BS int, @DSCRIPTN char(31), @BUSALRTID char(15), @DBNAME char(11), @DSCRIPTN_RS char(31), @BUSALRTID_RS char(15), @DBNAME_RS char(11), @DSCRIPTN_RE char(31), @BUSALRTID_RE char(15), @DBNAME_RE char(11)) AS  set nocount on IF @DSCRIPTN_RS IS NULL BEGIN SELECT TOP 25  BARULEID, DSCRIPTN, BUSALRTID, EMAILMSG, LSTRWCHKD, INCLDRSLTS, DBNAME, CMPANYID, FREQTYPE, FREQINT, FRQSUBTYP, FRQSUBINT, FRQRELINT, FRQRCINT, STRTTIME, ENDTIME, STRTDATE, ENDDATE, CREATDDT, CRUSRID, MODIFDT, MDFUSRID, ENABLED, KEEPHIST, NMBRTIME, NOTEINDX, SCHEDTXT, DEX_ROW_ID FROM .SY40500 WHERE ( DSCRIPTN = @DSCRIPTN AND BUSALRTID = @BUSALRTID AND DBNAME > @DBNAME OR DSCRIPTN = @DSCRIPTN AND BUSALRTID > @BUSALRTID OR DSCRIPTN > @DSCRIPTN ) ORDER BY DSCRIPTN ASC, BUSALRTID ASC, DBNAME ASC END ELSE IF @DSCRIPTN_RS = @DSCRIPTN_RE BEGIN SELECT TOP 25  BARULEID, DSCRIPTN, BUSALRTID, EMAILMSG, LSTRWCHKD, INCLDRSLTS, DBNAME, CMPANYID, FREQTYPE, FREQINT, FRQSUBTYP, FRQSUBINT, FRQRELINT, FRQRCINT, STRTTIME, ENDTIME, STRTDATE, ENDDATE, CREATDDT, CRUSRID, MODIFDT, MDFUSRID, ENABLED, KEEPHIST, NMBRTIME, NOTEINDX, SCHEDTXT, DEX_ROW_ID FROM .SY40500 WHERE DSCRIPTN = @DSCRIPTN_RS AND BUSALRTID BETWEEN @BUSALRTID_RS AND @BUSALRTID_RE AND DBNAME BETWEEN @DBNAME_RS AND @DBNAME_RE AND ( DSCRIPTN = @DSCRIPTN AND BUSALRTID = @BUSALRTID AND DBNAME > @DBNAME OR DSCRIPTN = @DSCRIPTN AND BUSALRTID > @BUSALRTID OR DSCRIPTN > @DSCRIPTN ) ORDER BY DSCRIPTN ASC, BUSALRTID ASC, DBNAME ASC END ELSE BEGIN SELECT TOP 25  BARULEID, DSCRIPTN, BUSALRTID, EMAILMSG, LSTRWCHKD, INCLDRSLTS, DBNAME, CMPANYID, FREQTYPE, FREQINT, FRQSUBTYP, FRQSUBINT, FRQRELINT, FRQRCINT, STRTTIME, ENDTIME, STRTDATE, ENDDATE, CREATDDT, CRUSRID, MODIFDT, MDFUSRID, ENABLED, KEEPHIST, NMBRTIME, NOTEINDX, SCHEDTXT, DEX_ROW_ID FROM .SY40500 WHERE DSCRIPTN BETWEEN @DSCRIPTN_RS AND @DSCRIPTN_RE AND BUSALRTID BETWEEN @BUSALRTID_RS AND @BUSALRTID_RE AND DBNAME BETWEEN @DBNAME_RS AND @DBNAME_RE AND ( DSCRIPTN = @DSCRIPTN AND BUSALRTID = @BUSALRTID AND DBNAME > @DBNAME OR DSCRIPTN = @DSCRIPTN AND BUSALRTID > @BUSALRTID OR DSCRIPTN > @DSCRIPTN ) ORDER BY DSCRIPTN ASC, BUSALRTID ASC, DBNAME ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY40500N_3] TO [DYNGRP]
GO
