SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_SY20000L_2] (@PRODID_RS smallint, @RESID_RS smallint, @ReportStatus_RS smallint, @DSPLNAME_RS char(81), @PRODID_RE smallint, @RESID_RE smallint, @ReportStatus_RE smallint, @DSPLNAME_RE char(81)) AS  set nocount on IF @PRODID_RS IS NULL BEGIN SELECT TOP 25  TemplateID, DSPLNAME, fileName, PredefinedTemplateID, EntityDriven, PRODID, RESID, ReportStatus, Report_Series_DictID, ReportSeries_ID, MODIFDT, MDFUSRID, CREATDDT, CRUSRID, DEX_ROW_ID FROM .SY20000 ORDER BY PRODID DESC, RESID DESC, ReportStatus DESC, DSPLNAME DESC END ELSE IF @PRODID_RS = @PRODID_RE BEGIN SELECT TOP 25  TemplateID, DSPLNAME, fileName, PredefinedTemplateID, EntityDriven, PRODID, RESID, ReportStatus, Report_Series_DictID, ReportSeries_ID, MODIFDT, MDFUSRID, CREATDDT, CRUSRID, DEX_ROW_ID FROM .SY20000 WHERE PRODID = @PRODID_RS AND RESID BETWEEN @RESID_RS AND @RESID_RE AND ReportStatus BETWEEN @ReportStatus_RS AND @ReportStatus_RE AND DSPLNAME BETWEEN @DSPLNAME_RS AND @DSPLNAME_RE ORDER BY PRODID DESC, RESID DESC, ReportStatus DESC, DSPLNAME DESC END ELSE BEGIN SELECT TOP 25  TemplateID, DSPLNAME, fileName, PredefinedTemplateID, EntityDriven, PRODID, RESID, ReportStatus, Report_Series_DictID, ReportSeries_ID, MODIFDT, MDFUSRID, CREATDDT, CRUSRID, DEX_ROW_ID FROM .SY20000 WHERE PRODID BETWEEN @PRODID_RS AND @PRODID_RE AND RESID BETWEEN @RESID_RS AND @RESID_RE AND ReportStatus BETWEEN @ReportStatus_RS AND @ReportStatus_RE AND DSPLNAME BETWEEN @DSPLNAME_RS AND @DSPLNAME_RE ORDER BY PRODID DESC, RESID DESC, ReportStatus DESC, DSPLNAME DESC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_SY20000L_2] TO [DYNGRP]
GO
