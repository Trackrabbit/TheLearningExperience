SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 create procedure [dbo].[taCreateApplicant] @I_vLLASTNAME_I char(21),       @I_vFFIRSTNAME_I char(15),       @I_vAPPLYDATE_I datetime,       @I_vAPPLICANTNUMBER_I numeric(19,5)=null,   @I_vISEQUENCENUMBER_I smallint=null,    @I_vMIDLNAME char(15)= null,      @I_vSSN_I char(15)= null,       @I_vADDRESS1 char(61) = null,      @I_vADDRESS2 char(61) = null,      @I_vCITY char(35) = null,       @I_vSTATE char(29) = null,       @I_vZIPCODE_I char(11) = null,      @I_vCOUNTRY char(61) = null,      @I_vHOMEPHONE char(21) = null,      @I_vWORKPHONE char(21) = null,      @I_vEXT_I char(5) = null,       @I_vREQUISITIONNUMBER_I int = null,      @I_vCOMPANYCODE_I char(5),       @I_vDIVISIONCODE_I char(7) = null,     @I_vDEPARTMENTCODE_I char(7) = null,    @I_vPOSITIONCODE_I char(7) = null,     @I_vLOCATNID char(15) = null,      @I_vSTATUS0_I smallint = null,      @I_vREJECTREASON_I smallint = null,     @I_vDSCRIPTN char(31) = null,      @I_vRELOCATION_I smallint = null,     @I_vREPLYLETTERSENT_I tinyint = null,    @I_vCOLORCODE_I smallint = null,     @I_vREFSOURCEDDL_I smallint = null,      @I_vREFERENCESOURCE_I char(31) = null,    @I_vGENDERGB_I smallint = null,      @I_vEEOETHNICORIGIN_I smallint = null,     @I_vEEOAGE_I smallint = null,      @I_vHANDICAPPED tinyint = null,      @I_vVETERAN tinyint = null,       @I_vDISABLEDVETERAN tinyint = null,     @I_vVIETNAMVETERAN tinyint = null,      @I_vOTHERVET tinyint = null,      @I_vCHANGEBY_I char(15) = null,      @I_vDATE1_I datetime = null,      @I_vDATE2_I datetime = null,      @I_vDATE3_I datetime = null,      @I_vDATE4_I datetime = null,      @I_vDATE5_I datetime = null,      @I_vSTRINGS_I_1 char(31) = null,     @I_vSTRINGS_I_2 char(31) = null,     @I_vSTRINGS_I_3 char(31) = null,     @I_vSTRINGS_I_4 char(31) = null,     @I_vSTRINGS_I_5 char(31) = null,     @I_vNUMERICEXTRA_1 int = null,      @I_vNUMERICEXTRA_2 int = null,      @I_vNUMERICEXTRA_3 int = null,      @I_vNUMERICEXTRA_4 int = null,      @I_vNUMERICEXTRA_5 int = null,      @I_vDOLLARS_I_1 numeric(19,5) = null,    @I_vDOLLARS_I_2 numeric(19,5) = null,    @I_vDOLLARS_I_3 numeric(19,5) = null,    @I_vDOLLARS_I_4 numeric(19,5) = null,    @I_vDOLLARS_I_5 numeric(19,5) = null,    @I_vCHECKBOXES_I_1 tinyint = null,     @I_vCHECKBOXES_I_2 tinyint = null,     @I_vCHECKBOXES_I_3 tinyint = null,     @I_vCHECKBOXES_I_4 tinyint = null,     @I_vCHECKBOXES_I_5 tinyint = null,     @I_vUpdateIfExists tinyint = 1,      @I_vRequesterTrx smallint = 0,      @I_vUSRDEFND1 char(50) = '',         @I_vUSRDEFND2 char(50) = '',         @I_vUSRDEFND3 char(50) = '',         @I_vUSRDEFND4 varchar(8000) = '',     @I_vUSRDEFND5 varchar(8000) = '',     @O_iErrorState int output,       @oErrString varchar(255) output       with encryption as  set transaction isolation level read uncommitted set nocount on  declare  @LLASTNAME_I char(21),     @FFIRSTNAME_I char(15),     @LastNameChanged tinyint,  @FirstNameChanged tinyint,   @appcount tinyint,  @linecount tinyint,  @lineexists tinyint,  @ActualDate datetime,  @xtrafields tinyint,  @iStatus int,  @iCustomState int,  @iCustomErrString varchar(255),  @nNextNoteIndex int,     @iGetNextNoteIdxErrState int,   @iAddCodeErrState int,  @O_oErrorState int,  @iError int        select  @LLASTNAME_I = '',  @FFIRSTNAME_I = '',  @LastNameChanged = 0,  @FirstNameChanged= 0,  @appcount = 0,  @linecount = 0,  @lineexists = 0,  @ActualDate = '',  @xtrafields = 0,  @O_iErrorState = 0      if (@oErrString is NULL) begin  select @oErrString = '' end  exec @iStatus = taCreateApplicantPre  @I_vLLASTNAME_I output,  @I_vFFIRSTNAME_I output,  @I_vAPPLYDATE_I output,  @I_vAPPLICANTNUMBER_I output,  @I_vISEQUENCENUMBER_I output,  @I_vMIDLNAME output,  @I_vSSN_I output,  @I_vADDRESS1 output,  @I_vADDRESS2 output,  @I_vCITY output,  @I_vSTATE output,  @I_vZIPCODE_I output,  @I_vCOUNTRY output,  @I_vHOMEPHONE output,  @I_vWORKPHONE output,  @I_vEXT_I output,  @I_vREQUISITIONNUMBER_I output,  @I_vCOMPANYCODE_I output,  @I_vDIVISIONCODE_I output,  @I_vDEPARTMENTCODE_I output,  @I_vPOSITIONCODE_I output,  @I_vLOCATNID output,  @I_vSTATUS0_I output,  @I_vREJECTREASON_I output,  @I_vDSCRIPTN output,  @I_vRELOCATION_I output,  @I_vREPLYLETTERSENT_I output,  @I_vCOLORCODE_I output,  @I_vREFSOURCEDDL_I output,  @I_vREFERENCESOURCE_I output,  @I_vGENDERGB_I output,  @I_vEEOETHNICORIGIN_I output,  @I_vEEOAGE_I output,  @I_vHANDICAPPED output,  @I_vVETERAN output,  @I_vDISABLEDVETERAN output,  @I_vVIETNAMVETERAN output,  @I_vOTHERVET output,  @I_vCHANGEBY_I output,  @I_vDATE1_I output,  @I_vDATE2_I output,  @I_vDATE3_I output,  @I_vDATE4_I output,  @I_vDATE5_I output,  @I_vSTRINGS_I_1 output,  @I_vSTRINGS_I_2 output,  @I_vSTRINGS_I_3 output,  @I_vSTRINGS_I_4 output,  @I_vSTRINGS_I_5 output,  @I_vNUMERICEXTRA_1 output,  @I_vNUMERICEXTRA_2 output,  @I_vNUMERICEXTRA_3 output,  @I_vNUMERICEXTRA_4 output,  @I_vNUMERICEXTRA_5 output,  @I_vDOLLARS_I_1 output,  @I_vDOLLARS_I_2 output,  @I_vDOLLARS_I_3 output,  @I_vDOLLARS_I_4 output,  @I_vDOLLARS_I_5 output,  @I_vCHECKBOXES_I_1 output,  @I_vCHECKBOXES_I_2 output,  @I_vCHECKBOXES_I_3 output,  @I_vCHECKBOXES_I_4 output,  @I_vCHECKBOXES_I_5 output,  @I_vUpdateIfExists output,  @I_vRequesterTrx output,  @I_vUSRDEFND1 output,  @I_vUSRDEFND2 output,  @I_vUSRDEFND3 output,  @I_vUSRDEFND4 output,  @I_vUSRDEFND5 output,  @O_iErrorState = @iCustomState output,  @oErrString = @iCustomErrString output select @iError = @@error if ((@iStatus <> 0) or (@iCustomState <> 0) or (@iError <> 0)) begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@iCustomErrString))  select @O_iErrorState = 8413    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  if (  @I_vLLASTNAME_I is NULL or  @I_vFFIRSTNAME_I is NULL or   @I_vAPPLYDATE_I is NULL or  @I_vCOMPANYCODE_I is NULL or   @I_vUpdateIfExists is NULL or  @I_vRequesterTrx is NULL or  @I_vUSRDEFND1 is NULL or  @I_vUSRDEFND2 is NULL or  @I_vUSRDEFND3 is NULL or  @I_vUSRDEFND4 is NULL or  @I_vUSRDEFND5 is NULL   ) begin  select @O_iErrorState = 8414    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  select @I_vPOSITIONCODE_I = UPPER(@I_vPOSITIONCODE_I),  @I_vDIVISIONCODE_I = UPPER(@I_vDIVISIONCODE_I),  @I_vDEPARTMENTCODE_I = UPPER(@I_vDEPARTMENTCODE_I),  @I_vLOCATNID = UPPER(@I_vLOCATNID),  @I_vCOMPANYCODE_I = UPPER(@I_vCOMPANYCODE_I)  select @ActualDate = convert(varchar(12),getdate())  if (@I_vISEQUENCENUMBER_I is not null) and (@I_vUpdateIfExists = 0) begin  select @O_iErrorState = 8415     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState) end  if (@I_vISEQUENCENUMBER_I is not null) and (@I_vUpdateIfExists = 1) begin  select @lineexists = 1 end  if (@I_vUpdateIfExists = 0) and (@I_vAPPLICANTNUMBER_I is not null) begin  if exists (select 1 from DYNAMICS..HR2APP12 (nolock) where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I)  begin  select @O_iErrorState = 20147     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end   if (@I_vUpdateIfExists = 1) and (@I_vAPPLICANTNUMBER_I is not null) begin  if not exists (select 1 from DYNAMICS..HR2APP12 (nolock) where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I)  begin  select @O_iErrorState = 20148     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end   if (@I_vUpdateIfExists = 1) and (@I_vAPPLICANTNUMBER_I is not null) begin  select @FFIRSTNAME_I = FFIRSTNAME_I,  @LLASTNAME_I = LLASTNAME_I  from DYNAMICS..HR2APP12 where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I end   if (@I_vUpdateIfExists = 1) and (@I_vAPPLICANTNUMBER_I is not null) and (@I_vFFIRSTNAME_I <> @FFIRSTNAME_I) begin  select @FirstNameChanged = 1 end   if (@I_vUpdateIfExists = 1) and (@I_vAPPLICANTNUMBER_I is not null) and (@I_vLLASTNAME_I <> @LLASTNAME_I) begin  select @LastNameChanged = 1 end   if (@I_vUpdateIfExists = 0) and (@I_vAPPLICANTNUMBER_I is null)      begin  select @I_vAPPLICANTNUMBER_I = isnull(APPLICANTNUMBER_I,1) from DYNAMICS..HR3APP99 WITH (TABLOCKX HOLDLOCK)  if (@I_vAPPLICANTNUMBER_I is null)  begin  select @I_vAPPLICANTNUMBER_I = 1  insert into DYNAMICS..HR3APP99 values (1)  end  update DYNAMICS..HR3APP99 set APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I + 1  if @@error <> 0  begin  select @O_iErrorState = 8417    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end  select @I_vISEQUENCENUMBER_I = 1 end  if (@I_vUpdateIfExists = 0) and (@I_vAPPLICANTNUMBER_I is not null)  begin  update DYNAMICS..HR3APP99 set APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I + 1  if @@error <> 0  begin  select @O_iErrorState = 20149    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end  select @I_vISEQUENCENUMBER_I = 1 end  select @appcount = count(APPLICANTNUMBER_I) from DYNAMICS..HR2APP12 (nolock)   where UPPER(LLASTNAME_I) = UPPER(@I_vLLASTNAME_I) and UPPER(FFIRSTNAME_I) = UPPER(@I_vFFIRSTNAME_I)  if (@I_vAPPLICANTNUMBER_I is null) and (@I_vUpdateIfExists = 1) and (@appcount = 1) begin  select @I_vAPPLICANTNUMBER_I = APPLICANTNUMBER_I from DYNAMICS..HR2APP12 (nolock) where UPPER(LLASTNAME_I) = UPPER(@I_vLLASTNAME_I) and UPPER(FFIRSTNAME_I) = UPPER(@I_vFFIRSTNAME_I) end  if (@I_vAPPLICANTNUMBER_I is null) and (@I_vUpdateIfExists = 1) and (@appcount > 1) begin  select @O_iErrorState = 8418     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState) end  if (@appcount > 1) and (@I_vAPPLICANTNUMBER_I is null) and (@I_vUpdateIfExists = 1) begin  select @O_iErrorState = 8419     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState) end  if (@appcount = 0) and (@I_vUpdateIfExists = 1) and (@FirstNameChanged = 0) and (@LastNameChanged = 0)    begin  select @O_iErrorState = 8420     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState) end  select @linecount = count(ISEQUENCENUMBER_I) from DYNAMICS..HR4APP02 (nolock) where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I  if (@I_vUpdateIfExists = 1) and (@I_vISEQUENCENUMBER_I is null)  begin  select @I_vISEQUENCENUMBER_I = isnull(max(ISEQUENCENUMBER_I),0) + 1 from DYNAMICS..HR4APP02 (nolock) where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I end  if (@I_vUpdateIfExists = 1) and (@lineexists = 1) begin  if not exists (select 1 from DYNAMICS..HR4APP02 (nolock) where  APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I and ISEQUENCENUMBER_I = @I_vISEQUENCENUMBER_I)  begin  select @O_iErrorState = 8421     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end  if (@I_vREQUISITIONNUMBER_I is not null) and (@I_vREQUISITIONNUMBER_I <> 0)and not exists (select 1 from DYNAMICS..HR2REQ01 (nolock) where REQUISITIONNUMBER_I = @I_vREQUISITIONNUMBER_I) begin  select @O_iErrorState = 8422     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState) end  if (@I_vREQUISITIONNUMBER_I is not null) and (@I_vREQUISITIONNUMBER_I <> 0) and (@I_vCOMPANYCODE_I is null)  begin   select @I_vCOMPANYCODE_I = COMPANYCODE_I from DYNAMICS..HR2REQ01 (nolock) where REQUISITIONNUMBER_I = @I_vREQUISITIONNUMBER_I end   if (@I_vREQUISITIONNUMBER_I is not null) and (@I_vREQUISITIONNUMBER_I <> 0) and (@I_vDIVISIONCODE_I is null)  begin   select @I_vDIVISIONCODE_I = DIVISIONCODE_I from DYNAMICS..HR2REQ01 (nolock) where REQUISITIONNUMBER_I = @I_vREQUISITIONNUMBER_I end   if (@I_vREQUISITIONNUMBER_I is not null) and (@I_vREQUISITIONNUMBER_I <> 0) and (@I_vDEPARTMENTCODE_I is null)  begin   select @I_vDEPARTMENTCODE_I = DEPARTMENTCODE_I from DYNAMICS..HR2REQ01 (nolock) where REQUISITIONNUMBER_I = @I_vREQUISITIONNUMBER_I end   if (@I_vREQUISITIONNUMBER_I is not null) and (@I_vREQUISITIONNUMBER_I <> 0) and (@I_vPOSITIONCODE_I is null)  begin   select @I_vPOSITIONCODE_I = POSITIONCODE_I from DYNAMICS..HR2REQ01 (nolock) where REQUISITIONNUMBER_I = @I_vREQUISITIONNUMBER_I end   if (@I_vDATE1_I is not null or   @I_vDATE2_I is not null or  @I_vDATE3_I is not null or  @I_vDATE4_I is not null or  @I_vDATE5_I is not null or  @I_vSTRINGS_I_1 is not null or  @I_vSTRINGS_I_2 is not null or  @I_vSTRINGS_I_3 is not null or  @I_vSTRINGS_I_4 is not null or  @I_vSTRINGS_I_5 is not null or  @I_vNUMERICEXTRA_1 is not null or  @I_vNUMERICEXTRA_2 is not null or  @I_vNUMERICEXTRA_3 is not null or  @I_vNUMERICEXTRA_4 is not null or  @I_vNUMERICEXTRA_5 is not null or  @I_vDOLLARS_I_1 is not null or  @I_vDOLLARS_I_2 is not null or  @I_vDOLLARS_I_3 is not null or  @I_vDOLLARS_I_4 is not null or  @I_vDOLLARS_I_5 is not null or  @I_vCHECKBOXES_I_1 is not null or  @I_vCHECKBOXES_I_2 is not null or  @I_vCHECKBOXES_I_3 is not null or  @I_vCHECKBOXES_I_4 is not null or  @I_vCHECKBOXES_I_5 is not null  ) begin  select @xtrafields = 1 end  if (@xtrafields = 1) and (@I_vUpdateIfExists = 1) begin   select   @I_vDATE1_I =   case   when @I_vDATE1_I is null   then DATE1_I  when @I_vDATE1_I is not null  then @I_vDATE1_I  else ''  end,  @I_vDATE2_I =   case   when @I_vDATE2_I is null   then DATE2_I  when @I_vDATE2_I is not null  then @I_vDATE2_I  else ''  end,  @I_vDATE3_I =   case   when @I_vDATE3_I is null   then DATE3_I  when @I_vDATE3_I is not null  then @I_vDATE3_I  else ''  end,  @I_vDATE4_I =   case   when @I_vDATE4_I is null   then DATE4_I  when @I_vDATE4_I is not null  then @I_vDATE4_I  else ''  end,  @I_vDATE5_I =   case   when @I_vDATE5_I is null   then DATE5_I  when @I_vDATE5_I is not null  then @I_vDATE5_I  else ''  end,  @I_vSTRINGS_I_1 =   case   when @I_vSTRINGS_I_1 is null   then STRINGS_I_1  when @I_vSTRINGS_I_1 is not null  then @I_vSTRINGS_I_1  else ''  end,  @I_vSTRINGS_I_2 =   case   when @I_vSTRINGS_I_2 is null   then STRINGS_I_2  when @I_vSTRINGS_I_2 is not null  then @I_vSTRINGS_I_2  else ''  end,  @I_vSTRINGS_I_3 =   case   when @I_vSTRINGS_I_3 is null   then STRINGS_I_3  when @I_vSTRINGS_I_3 is not null  then @I_vSTRINGS_I_3  else ''  end,  @I_vSTRINGS_I_4 =   case   when @I_vSTRINGS_I_4 is null   then STRINGS_I_4  when @I_vSTRINGS_I_4 is not null  then @I_vSTRINGS_I_4  else ''  end,  @I_vSTRINGS_I_5 =   case   when @I_vSTRINGS_I_5 is null   then STRINGS_I_5  when @I_vSTRINGS_I_5 is not null  then @I_vSTRINGS_I_5  else ''  end,  @I_vNUMERICEXTRA_1 =   case   when @I_vNUMERICEXTRA_1 is null   then NUMERICEXTRA_1  when @I_vNUMERICEXTRA_1 is not null  then @I_vNUMERICEXTRA_1  else 0  end,  @I_vNUMERICEXTRA_2 =   case   when @I_vNUMERICEXTRA_2 is null   then NUMERICEXTRA_2  when @I_vNUMERICEXTRA_2 is not null  then @I_vNUMERICEXTRA_2  else 0  end,  @I_vNUMERICEXTRA_3 =   case   when @I_vNUMERICEXTRA_3 is null   then NUMERICEXTRA_3  when @I_vNUMERICEXTRA_3 is not null  then @I_vNUMERICEXTRA_3  else 0  end,  @I_vNUMERICEXTRA_4 =   case   when @I_vNUMERICEXTRA_4 is null   then NUMERICEXTRA_4  when @I_vNUMERICEXTRA_4 is not null  then @I_vNUMERICEXTRA_4  else 0  end,  @I_vNUMERICEXTRA_5 =   case   when @I_vNUMERICEXTRA_5 is null   then NUMERICEXTRA_5  when @I_vNUMERICEXTRA_5 is not null  then @I_vNUMERICEXTRA_5  else 0  end,  @I_vDOLLARS_I_1 =   case  when @I_vDOLLARS_I_1 is null   then DOLLARS_I_1  when @I_vDOLLARS_I_1 is not null  then @I_vDOLLARS_I_1  else 0  end,  @I_vDOLLARS_I_2 =   case  when @I_vDOLLARS_I_2 is null   then DOLLARS_I_2  when @I_vDOLLARS_I_2 is not null  then @I_vDOLLARS_I_2  else 0  end,  @I_vDOLLARS_I_3 =   case  when @I_vDOLLARS_I_3 is null   then DOLLARS_I_3  when @I_vDOLLARS_I_3 is not null  then @I_vDOLLARS_I_3  else 0  end,  @I_vDOLLARS_I_4 =   case  when @I_vDOLLARS_I_4 is null   then DOLLARS_I_4  when @I_vDOLLARS_I_4 is not null  then @I_vDOLLARS_I_4  else 0  end,  @I_vDOLLARS_I_5 =   case  when @I_vDOLLARS_I_5 is null   then DOLLARS_I_5  when @I_vDOLLARS_I_5 is not null  then @I_vDOLLARS_I_5  else 0  end,  @I_vCHECKBOXES_I_1 =   case  when @I_vCHECKBOXES_I_1 is null   then CHECKBOXES_I_1  when @I_vCHECKBOXES_I_1 is not null  then @I_vCHECKBOXES_I_1  else 0  end,  @I_vCHECKBOXES_I_2 =   case  when @I_vCHECKBOXES_I_2 is null   then CHECKBOXES_I_2  when @I_vCHECKBOXES_I_2 is not null  then @I_vCHECKBOXES_I_2  else 0  end,  @I_vCHECKBOXES_I_3 =   case  when @I_vCHECKBOXES_I_3 is null   then CHECKBOXES_I_3  when @I_vCHECKBOXES_I_3 is not null  then @I_vCHECKBOXES_I_3  else 0  end,  @I_vCHECKBOXES_I_4 =   case  when @I_vCHECKBOXES_I_4 is null   then CHECKBOXES_I_4  when @I_vCHECKBOXES_I_4 is not null  then @I_vCHECKBOXES_I_4  else 0  end,  @I_vCHECKBOXES_I_5 =   case  when @I_vCHECKBOXES_I_5 is null   then CHECKBOXES_I_5  when @I_vCHECKBOXES_I_5 is not null  then @I_vCHECKBOXES_I_5  else 0  end  from DYNAMICS..AX010130 (nolock) where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I  end  else  begin   select @I_vDATE1_I =   case   when @I_vDATE1_I is null   then ''  else @I_vDATE1_I  end,  @I_vDATE2_I =   case   when @I_vDATE2_I is null   then ''  else @I_vDATE2_I  end,  @I_vDATE3_I =   case   when @I_vDATE3_I is null   then ''  else @I_vDATE3_I  end,  @I_vDATE4_I =   case   when @I_vDATE4_I is null   then ''  else @I_vDATE4_I  end,  @I_vDATE5_I =   case   when @I_vDATE5_I is null   then ''  else @I_vDATE5_I  end,  @I_vSTRINGS_I_1 =   case   when @I_vSTRINGS_I_1 is null   then ''  else @I_vSTRINGS_I_1  end,  @I_vSTRINGS_I_2 =   case   when @I_vSTRINGS_I_2 is null   then ''  else @I_vSTRINGS_I_2  end,  @I_vSTRINGS_I_3 =   case   when @I_vSTRINGS_I_3 is null   then ''  else @I_vSTRINGS_I_3  end,  @I_vSTRINGS_I_4 =   case   when @I_vSTRINGS_I_4 is null   then ''  else @I_vSTRINGS_I_4  end,  @I_vSTRINGS_I_5 =   case   when @I_vSTRINGS_I_5 is null   then ''  else @I_vSTRINGS_I_5  end,  @I_vNUMERICEXTRA_1 =   case   when @I_vNUMERICEXTRA_1 is null   then 0  else @I_vNUMERICEXTRA_1  end,  @I_vNUMERICEXTRA_2 =   case   when @I_vNUMERICEXTRA_2 is null   then 0  else @I_vNUMERICEXTRA_2  end,  @I_vNUMERICEXTRA_3 =   case   when @I_vNUMERICEXTRA_3 is null   then 0  else @I_vNUMERICEXTRA_3  end,  @I_vNUMERICEXTRA_4 =   case   when @I_vNUMERICEXTRA_4 is null   then 0  else @I_vNUMERICEXTRA_4  end,  @I_vNUMERICEXTRA_5 =   case   when @I_vNUMERICEXTRA_5 is null   then 0  else @I_vNUMERICEXTRA_5  end,  @I_vDOLLARS_I_1 =   case  when @I_vDOLLARS_I_1 is null   then 0  else @I_vDOLLARS_I_1  end,  @I_vDOLLARS_I_2 =   case  when @I_vDOLLARS_I_2 is null   then 0  else @I_vDOLLARS_I_2  end,  @I_vDOLLARS_I_3 =   case  when @I_vDOLLARS_I_3 is null   then 0  else @I_vDOLLARS_I_3  end,  @I_vDOLLARS_I_4 =   case  when @I_vDOLLARS_I_4 is null   then 0  else @I_vDOLLARS_I_4  end,  @I_vDOLLARS_I_5 =   case  when @I_vDOLLARS_I_5 is null   then 0  else @I_vDOLLARS_I_5  end,  @I_vCHECKBOXES_I_1 =   case  when @I_vCHECKBOXES_I_1 is null   then 0  else @I_vCHECKBOXES_I_1  end,  @I_vCHECKBOXES_I_2 =   case  when @I_vCHECKBOXES_I_2 is null   then 0  else @I_vCHECKBOXES_I_2  end,  @I_vCHECKBOXES_I_3 =   case  when @I_vCHECKBOXES_I_3 is null   then 0  else @I_vCHECKBOXES_I_3  end,  @I_vCHECKBOXES_I_4 =   case  when @I_vCHECKBOXES_I_4 is null   then 0  else @I_vCHECKBOXES_I_4  end,  @I_vCHECKBOXES_I_5 =   case  when @I_vCHECKBOXES_I_5 is null   then 0  else @I_vCHECKBOXES_I_5  end end  if (@appcount >= 1) and (@I_vUpdateIfExists = 1) begin  select   @I_vMIDLNAME =   case   when @I_vMIDLNAME is null   then MIDLNAME  when @I_vMIDLNAME is not null  then @I_vMIDLNAME  else ''  end,  @I_vSSN_I =   case  when @I_vSSN_I is null   then SSN_I  when @I_vSSN_I is not null  then @I_vSSN_I  else ''  end,  @I_vADDRESS1 =   case  when @I_vADDRESS1 is null   then ADDRESS1  when @I_vADDRESS1 is not null  then @I_vADDRESS1  else ''  end,   @I_vADDRESS2 =   case  when @I_vADDRESS2 is null   then ADDRESS2  when @I_vADDRESS2 is not null  then @I_vADDRESS2  else ''  end,   @I_vCITY =   case  when @I_vCITY is null   then CITY  when @I_vCITY is not null  then @I_vCITY  else ''  end,   @I_vSTATE =   case   when @I_vSTATE is null   then STATE  when @I_vSTATE is not null  then @I_vSTATE  else ''  end,   @I_vZIPCODE_I =   case   when @I_vZIPCODE_I is null   then ZIPCODE_I  when @I_vZIPCODE_I is not null  then @I_vZIPCODE_I  else ''  end,   @I_vCOUNTRY =   case   when @I_vCOUNTRY is null   then COUNTRY  when @I_vCOUNTRY is not null  then @I_vCOUNTRY  else ''  end,   @I_vHOMEPHONE =   case   when @I_vHOMEPHONE is null   then HOMEPHONE  when @I_vHOMEPHONE is not null  then @I_vHOMEPHONE  else ''  end,   @I_vWORKPHONE =   case   when @I_vWORKPHONE is null   then WORKPHONE  when @I_vWORKPHONE is not null  then @I_vWORKPHONE  else ''  end,   @I_vEXT_I =   case   when @I_vEXT_I is null   then EXT_I  when @I_vEXT_I is not null  then @I_vEXT_I  else ''  end,   @I_vREQUISITIONNUMBER_I =   case   when @I_vREQUISITIONNUMBER_I is null   then REQUISITIONNUMBER_I  when @I_vREQUISITIONNUMBER_I is not null  then @I_vREQUISITIONNUMBER_I  else 0  end,   @I_vDIVISIONCODE_I =   case   when @I_vDIVISIONCODE_I is null   then DIVISIONCODE_I  when @I_vDIVISIONCODE_I is not null  then @I_vDIVISIONCODE_I  else ''  end,   @I_vDEPARTMENTCODE_I =   case   when @I_vDEPARTMENTCODE_I is null   then DEPARTMENTCODE_I  when @I_vDEPARTMENTCODE_I is not null  then @I_vDEPARTMENTCODE_I  else ''  end,   @I_vPOSITIONCODE_I =   case   when @I_vPOSITIONCODE_I is null   then POSITIONCODE_I  when @I_vPOSITIONCODE_I is not null  then @I_vPOSITIONCODE_I  else ''  end,   @I_vLOCATNID =   case   when @I_vLOCATNID is null   then LOCATNID  when @I_vLOCATNID is not null  then @I_vLOCATNID  else ''  end,   @I_vSTATUS0_I =   case   when @I_vSTATUS0_I is null   then STATUS0_I  when @I_vSTATUS0_I is not null  then @I_vSTATUS0_I  else 0  end,   @I_vREJECTREASON_I =   case   when @I_vREJECTREASON_I is null   then REJECTREASON_I  when @I_vREJECTREASON_I is not null  then @I_vREJECTREASON_I  else 0  end,   @I_vDSCRIPTN =   case   when @I_vDSCRIPTN is null   then DSCRIPTN  when @I_vDSCRIPTN is not null  then @I_vDSCRIPTN  else ''  end,   @I_vRELOCATION_I =   case   when @I_vRELOCATION_I is null   then RELOCATION_I  when @I_vRELOCATION_I is not null  then @I_vRELOCATION_I  else 0  end,   @I_vREPLYLETTERSENT_I =   case   when @I_vREPLYLETTERSENT_I is null   then REPLYLETTERSENT_I  when @I_vREPLYLETTERSENT_I is not null  then @I_vREPLYLETTERSENT_I  else 0  end,   @I_vCOLORCODE_I =   case   when @I_vCOLORCODE_I is null   then COLORCODE_I  when @I_vCOLORCODE_I is not null  then @I_vCOLORCODE_I  else 5  end,   @I_vREFSOURCEDDL_I =  case   when @I_vREFSOURCEDDL_I is null   then REFSOURCEDDL_I  when @I_vREFSOURCEDDL_I is not null  then @I_vREFSOURCEDDL_I  else 0  end,   @I_vREFERENCESOURCE_I =  case   when @I_vREFERENCESOURCE_I is null   then REFERENCESOURCE_I  when @I_vREFERENCESOURCE_I is not null  then @I_vREFERENCESOURCE_I  else ''  end,   @I_vGENDERGB_I =   case   when @I_vGENDERGB_I is null   then GENDERGB_I  when @I_vGENDERGB_I is not null  then @I_vGENDERGB_I  else 2  end,   @I_vEEOETHNICORIGIN_I =   case   when @I_vEEOETHNICORIGIN_I is null   then EEOETHNICORIGIN_I  when @I_vEEOETHNICORIGIN_I is not null  then @I_vEEOETHNICORIGIN_I  else 7  end,   @I_vEEOAGE_I =   case   when @I_vEEOAGE_I is null   then EEOAGE_I  when @I_vEEOAGE_I is not null  then @I_vEEOAGE_I  else 6  end,   @I_vHANDICAPPED =   case   when @I_vHANDICAPPED is null   then HANDICAPPED  when @I_vHANDICAPPED is not null  then @I_vHANDICAPPED  else 0  end,   @I_vVETERAN =   case   when @I_vVETERAN is null   then VETERAN  when @I_vVETERAN is not null  then @I_vVETERAN  else 0  end,   @I_vDISABLEDVETERAN =   case   when @I_vDISABLEDVETERAN is null   then DISABLEDVETERAN  when @I_vDISABLEDVETERAN is not null  then @I_vDISABLEDVETERAN  else 0  end,   @I_vVIETNAMVETERAN =   case   when @I_vVIETNAMVETERAN is null   then VIETNAMVETERAN  when @I_vVIETNAMVETERAN is not null  then @I_vVIETNAMVETERAN  else 0  end,   @I_vOTHERVET =   case   when @I_vOTHERVET is null   then OTHERVET  when @I_vOTHERVET is not null  then @I_vOTHERVET  else 0  end,  @I_vCHANGEBY_I =   case   when @I_vCHANGEBY_I is null  then CHANGEBY_I  when @I_vCHANGEBY_I is not null  then @I_vCHANGEBY_I  else 'eConnect'  end  from DYNAMICS..HR2APP12 (nolock) where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I end  else  begin    select @I_vMIDLNAME =   case   when @I_vMIDLNAME is null   then ''  else @I_vMIDLNAME  end,  @I_vSSN_I =   case  when @I_vSSN_I is null   then ''  else @I_vSSN_I  end,  @I_vADDRESS1 =   case  when @I_vADDRESS1 is null   then ''  else @I_vADDRESS1  end,   @I_vADDRESS2 =   case  when @I_vADDRESS2 is null   then ''  else @I_vADDRESS2  end,   @I_vCITY =   case  when @I_vCITY is null   then ''  else @I_vCITY  end,   @I_vSTATE =   case   when @I_vSTATE is null  then ''  else @I_vSTATE  end,   @I_vZIPCODE_I =   case   when @I_vZIPCODE_I is null   then ''  else @I_vZIPCODE_I  end,   @I_vCOUNTRY =   case   when @I_vCOUNTRY is null   then ''  else @I_vCOUNTRY  end,   @I_vHOMEPHONE =   case   when @I_vHOMEPHONE is null   then ''  else @I_vHOMEPHONE  end,   @I_vWORKPHONE =   case   when @I_vWORKPHONE is null   then ''  else @I_vWORKPHONE  end,   @I_vEXT_I =   case   when @I_vEXT_I is null   then ''  else @I_vEXT_I  end,   @I_vREQUISITIONNUMBER_I =   case   when @I_vREQUISITIONNUMBER_I is null   then 0  else @I_vREQUISITIONNUMBER_I  end,   @I_vDIVISIONCODE_I =   case   when @I_vDIVISIONCODE_I is null  then ''  else @I_vDIVISIONCODE_I  end,   @I_vDEPARTMENTCODE_I =   case   when @I_vDEPARTMENTCODE_I is null   then ''  else @I_vDEPARTMENTCODE_I  end,   @I_vPOSITIONCODE_I =   case   when @I_vPOSITIONCODE_I is null   then ''  else @I_vPOSITIONCODE_I  end,   @I_vLOCATNID =   case   when @I_vLOCATNID is null  then ''  else @I_vLOCATNID  end,   @I_vSTATUS0_I =   case   when @I_vSTATUS0_I is null  then 0  else @I_vSTATUS0_I  end,   @I_vREJECTREASON_I =   case   when @I_vREJECTREASON_I is null   then 0  else @I_vREJECTREASON_I  end,   @I_vDSCRIPTN =   case   when @I_vDSCRIPTN is null  then ''  else @I_vDSCRIPTN  end,   @I_vRELOCATION_I =   case   when @I_vRELOCATION_I is null   then 0  else @I_vRELOCATION_I  end,   @I_vREPLYLETTERSENT_I =   case   when @I_vREPLYLETTERSENT_I is null   then 0  else @I_vREPLYLETTERSENT_I  end,   @I_vCOLORCODE_I =   case   when @I_vCOLORCODE_I is null   then 5  else @I_vCOLORCODE_I  end,   @I_vREFSOURCEDDL_I =  case   when @I_vREFSOURCEDDL_I is null   then 0  else @I_vREFSOURCEDDL_I  end,   @I_vREFERENCESOURCE_I =  case   when @I_vREFERENCESOURCE_I is null   then ''  else @I_vREFERENCESOURCE_I  end,   @I_vGENDERGB_I =   case   when @I_vGENDERGB_I is null   then 2  else @I_vGENDERGB_I  end,   @I_vEEOETHNICORIGIN_I =   case   when @I_vEEOETHNICORIGIN_I is null   then 7  else @I_vEEOETHNICORIGIN_I  end,   @I_vEEOAGE_I =   case   when @I_vEEOAGE_I is null   then 6  else @I_vEEOAGE_I  end,   @I_vHANDICAPPED =   case   when @I_vHANDICAPPED is null   then 0  else @I_vHANDICAPPED  end,   @I_vVETERAN =   case   when @I_vVETERAN is null   then 0  else @I_vVETERAN  end,   @I_vDISABLEDVETERAN =   case   when @I_vDISABLEDVETERAN is null   then 0  else @I_vDISABLEDVETERAN  end,   @I_vVIETNAMVETERAN =   case   when @I_vVIETNAMVETERAN is null   then 0  else @I_vVIETNAMVETERAN  end,   @I_vOTHERVET =   case   when @I_vOTHERVET is null   then 0  else @I_vOTHERVET  end,  @I_vCHANGEBY_I =   case   when @I_vCHANGEBY_I is null  then 'eConnect'  else @I_vCHANGEBY_I  end end  if (@I_vLLASTNAME_I = '') begin  select @O_iErrorState = 8423     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState) end  if (@I_vFFIRSTNAME_I = '') begin  select @O_iErrorState = 20150     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState) end  if (@I_vAPPLYDATE_I = '') begin  select @O_iErrorState = 8424     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState) end  if (@I_vCOMPANYCODE_I = '') begin  select @O_iErrorState = 11324     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState) end  if (@I_vCOMPANYCODE_I <> '') begin  if (not exists(select INTERID from DYNAMICS..SY01500 (nolock) where INTERID = @I_vCOMPANYCODE_I))  begin  select @O_iErrorState = 11015     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end  if (@I_vSSN_I <> '') and exists (select 1 from DYNAMICS..HR2APP12 (nolock) where SSN_I = @I_vSSN_I and APPLICANTNUMBER_I <> @I_vAPPLICANTNUMBER_I) begin  select @O_iErrorState = 8425     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState) end  if ( @I_vUpdateIfExists < 0 or @I_vUpdateIfExists > 1 )  begin  select @O_iErrorState = 8426    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if ( @I_vRequesterTrx < 0 or @I_vRequesterTrx > 1 )  begin  select @O_iErrorState = 8427    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vSTATUS0_I not in (0,1,2,3,4,5)) begin  select @O_iErrorState = 8428    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vREJECTREASON_I <> 0) and (@I_vSTATUS0_I not in(3)) begin  select @O_iErrorState = 8429     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vDSCRIPTN <> '') and (@I_vSTATUS0_I not in (3)) begin  select @O_iErrorState = 8430     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vRELOCATION_I not in (0,1)) begin  select @O_iErrorState = 8431     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vREPLYLETTERSENT_I not in (0,1)) begin  select @O_iErrorState = 11000     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vCOLORCODE_I not in (1,2,3,4,5)) begin  select @O_iErrorState = 11001     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vREFSOURCEDDL_I not in (0,1,2,3,4,5,6))  begin  select @O_iErrorState = 11002     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vGENDERGB_I not in (0,1,2)) begin  select @O_iErrorState = 11003     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vEEOETHNICORIGIN_I not in (1,2,3,4,5,6,7,8)) begin  select @O_iErrorState = 11004     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vEEOAGE_I < 1 or @I_vEEOAGE_I > 7) begin  select @O_iErrorState = 11005     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vHANDICAPPED not in (0,1)) begin  select @O_iErrorState = 11006     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vVETERAN not in (0,1)) begin  select @O_iErrorState = 11007     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vDISABLEDVETERAN not in (0,1)) begin  select @O_iErrorState = 11008      exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vVIETNAMVETERAN not in (0,1)) begin  select @O_iErrorState = 11009     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vOTHERVET not in (0,1)) begin  select @O_iErrorState = 11010     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output end  if (@I_vDIVISIONCODE_I <> '') begin  if (not exists(select DIVISIONCODE_I from DYNAMICS..HRPMDV01 (nolock) where DIVISIONCODE_I = @I_vDIVISIONCODE_I and COMPANYCODE_I = @I_vCOMPANYCODE_I))  begin  select @O_iErrorState = 11011     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end  if (@I_vDEPARTMENTCODE_I <> '') begin  if (not exists(select DEPARTMENTCODE_I from DYNAMICS..HRPMDP01 (nolock) where DEPARTMENTCODE_I = @I_vDEPARTMENTCODE_I and COMPANYCODE_I = @I_vCOMPANYCODE_I))  begin  select @O_iErrorState = 11012     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end   if (@I_vPOSITIONCODE_I <> '') begin  if (not exists(select POSITIONCODE_I from DYNAMICS..HRPMPS01 (nolock) where POSITIONCODE_I = @I_vPOSITIONCODE_I and COMPANYCODE_I = @I_vCOMPANYCODE_I))  begin  select @O_iErrorState = 11013     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end  if (@I_vLOCATNID <> '') begin  if (not exists(select LOCCODE_I from DYNAMICS..HRPMLC01 (nolock) where LOCCODE_I = @I_vLOCATNID and COMPANYCODE_I = @I_vCOMPANYCODE_I))  begin  select @O_iErrorState = 11014     exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end end  if @O_iErrorState <> 0  return (@O_iErrorState)  begin  if not exists(select 1 from DYNAMICS..HR2APP12 (nolock) where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I)  begin  insert DYNAMICS..HR2APP12(  APPLICANTNUMBER_I,   SSN_I,   LLASTNAME_I,   FFIRSTNAME_I,   MIDLNAME,   ADDRESS1,   ADDRESS2,   CITY,   STATE,   ZIPCODE_I,   COUNTRY,   HOMEPHONE,   WORKPHONE,   EXT_I,   ISEQUENCENUMBER_I,   APPLYDATE_I,   REQUISITIONNUMBER_I,   COMPANYCODE_I,   DIVISIONCODE_I,   DEPARTMENTCODE_I,   POSITIONCODE_I,   LOCATNID,   STATUS0_I,   REJECTREASON_I,   DSCRIPTN,   RELOCATION_I,   REPLYLETTERSENT_I,   COLORCODE_I,   COLORSTRING_I,   REFSOURCEDDL_I,   REFERENCESOURCE_I,   GENDERGB_I,   EEOETHNICORIGIN_I,   EEOAGE_I,   HANDICAPPED,   VETERAN,   DISABLEDVETERAN,   VIETNAMVETERAN,   NOTESINDEX_I,   CHANGEBY_I,   CHANGEDATE_I,   OTHERVET  )  select  @I_vAPPLICANTNUMBER_I,     @I_vSSN_I,        @I_vLLASTNAME_I,      @I_vFFIRSTNAME_I,      @I_vMIDLNAME,       @I_vADDRESS1,       @I_vADDRESS2,       @I_vCITY,        @I_vSTATE,        @I_vZIPCODE_I,       @I_vCOUNTRY,       @I_vHOMEPHONE,       @I_vWORKPHONE,       @I_vEXT_I,        @I_vISEQUENCENUMBER_I,     @I_vAPPLYDATE_I,      @I_vREQUISITIONNUMBER_I,    @I_vCOMPANYCODE_I,      @I_vDIVISIONCODE_I,      @I_vDEPARTMENTCODE_I,     @I_vPOSITIONCODE_I,      @I_vLOCATNID,       @I_vSTATUS0_I,       @I_vREJECTREASON_I,      @I_vDSCRIPTN,       @I_vRELOCATION_I,      @I_vREPLYLETTERSENT_I,     @I_vCOLORCODE_I,      case         when @I_vCOLORCODE_I = 1  then 'Blue'  when @I_vCOLORCODE_I = 2  then 'Green'  when @I_vCOLORCODE_I = 3  then 'Yellow'  when @I_vCOLORCODE_I = 4   then 'Red'  else 'N/A'  end,   @I_vREFSOURCEDDL_I,      @I_vREFERENCESOURCE_I,     @I_vGENDERGB_I,       @I_vEEOETHNICORIGIN_I,     @I_vEEOAGE_I,       @I_vHANDICAPPED,      @I_vVETERAN,       @I_vDISABLEDVETERAN,     @I_vVIETNAMVETERAN,      0,          @I_vCHANGEBY_I,       @ActualDate,       @I_vOTHERVET       if @@error <> 0  begin  select @O_iErrorState = 11016    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end  end  else  if (@I_vUpdateIfExists = 1)  begin  update DYNAMICS..HR2APP12   set   SSN_I = @I_vSSN_I,  LLASTNAME_I = @I_vLLASTNAME_I,  FFIRSTNAME_I = @I_vFFIRSTNAME_I,  MIDLNAME = @I_vMIDLNAME,  ISEQUENCENUMBER_I = @I_vISEQUENCENUMBER_I,  ADDRESS1 = @I_vADDRESS1,  ADDRESS2 = @I_vADDRESS2,  CITY = @I_vCITY,  STATE = @I_vSTATE,  ZIPCODE_I = @I_vZIPCODE_I,  COUNTRY = @I_vCOUNTRY,  HOMEPHONE = @I_vHOMEPHONE,  WORKPHONE = @I_vWORKPHONE,  EXT_I = @I_vEXT_I,  APPLYDATE_I = @I_vAPPLYDATE_I,  REQUISITIONNUMBER_I = @I_vREQUISITIONNUMBER_I,  COMPANYCODE_I = @I_vCOMPANYCODE_I,  DIVISIONCODE_I = @I_vDIVISIONCODE_I,  DEPARTMENTCODE_I = @I_vDEPARTMENTCODE_I,  POSITIONCODE_I = @I_vPOSITIONCODE_I,  LOCATNID = @I_vLOCATNID,  STATUS0_I = @I_vSTATUS0_I,  REJECTREASON_I = @I_vREJECTREASON_I,  DSCRIPTN = @I_vDSCRIPTN,  RELOCATION_I = @I_vRELOCATION_I,  REPLYLETTERSENT_I = @I_vREPLYLETTERSENT_I,  COLORCODE_I = @I_vCOLORCODE_I,  COLORSTRING_I =   case   when @I_vCOLORCODE_I = 1  then 'Blue'  when @I_vCOLORCODE_I = 2  then 'Green'  when @I_vCOLORCODE_I = 3  then 'Yellow'  when @I_vCOLORCODE_I = 4   then 'Red'  else 'N/A'  end,   REFSOURCEDDL_I = @I_vREFSOURCEDDL_I,  REFERENCESOURCE_I = @I_vREFERENCESOURCE_I,  GENDERGB_I = @I_vGENDERGB_I,  EEOETHNICORIGIN_I = @I_vEEOETHNICORIGIN_I,  EEOAGE_I = @I_vEEOAGE_I,  HANDICAPPED = @I_vHANDICAPPED,  VETERAN = @I_vVETERAN,  DISABLEDVETERAN = @I_vDISABLEDVETERAN,  VIETNAMVETERAN = @I_vVIETNAMVETERAN,  CHANGEBY_I = @I_vCHANGEBY_I,  CHANGEDATE_I = @ActualDate,  OTHERVET = @I_vOTHERVET  where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I  if @@error <> 0  begin  select @O_iErrorState = 11017    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end  end end  begin  if not exists(select 1 from DYNAMICS..HR4APP02 (nolock) where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I and ISEQUENCENUMBER_I = @I_vISEQUENCENUMBER_I)  begin  insert DYNAMICS..HR4APP02(  APPLICANTNUMBER_I,  ISEQUENCENUMBER_I,  APPLYDATE_I,  REQUISITIONNUMBER_I,  COMPANYCODE_I,  DIVISIONCODE_I,  DEPARTMENTCODE_I,  POSITIONCODE_I,  LOCCODE_I,  STATUS0_I,  REJECTREASON_I,  DSCRIPTN,  NOTESINDEX_I,  COLORCODE_I,  COLORSTRING_I,  REFSOURCEDDL_I,  REFERENCESOURCE_I,  RELOCATION_I,  REPLYLETTERSENT_I,  CHANGEBY_I,  CHANGEDATE_I  )  select  @I_vAPPLICANTNUMBER_I,     @I_vISEQUENCENUMBER_I,     @I_vAPPLYDATE_I,      @I_vREQUISITIONNUMBER_I,    @I_vCOMPANYCODE_I,      @I_vDIVISIONCODE_I,      @I_vDEPARTMENTCODE_I,     @I_vPOSITIONCODE_I,      @I_vLOCATNID,       @I_vSTATUS0_I,       @I_vREJECTREASON_I,      @I_vDSCRIPTN,       0,          @I_vCOLORCODE_I,      case         when @I_vCOLORCODE_I = 1  then 'Blue'  when @I_vCOLORCODE_I = 2  then 'Green'  when @I_vCOLORCODE_I = 3  then 'Yellow'  when @I_vCOLORCODE_I = 4   then 'Red'  else 'N/A'  end,   @I_vREFSOURCEDDL_I,      @I_vREFERENCESOURCE_I,     @I_vRELOCATION_I,      @I_vREPLYLETTERSENT_I,     @I_vCHANGEBY_I,       @ActualDate        if @@error <> 0  begin  select @O_iErrorState = 11018    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end  end  else  if (@I_vUpdateIfExists = 1) and (@appcount = 1)   begin  update DYNAMICS..HR4APP02   set   APPLYDATE_I = @I_vAPPLYDATE_I,  REQUISITIONNUMBER_I = @I_vREQUISITIONNUMBER_I,  COMPANYCODE_I = @I_vCOMPANYCODE_I,  DIVISIONCODE_I = @I_vDIVISIONCODE_I,  DEPARTMENTCODE_I = @I_vDEPARTMENTCODE_I,  POSITIONCODE_I = @I_vPOSITIONCODE_I,  LOCCODE_I = @I_vLOCATNID,  STATUS0_I = @I_vSTATUS0_I,  REJECTREASON_I = @I_vREJECTREASON_I,  DSCRIPTN = @I_vDSCRIPTN,  COLORCODE_I = @I_vCOLORCODE_I,  COLORSTRING_I =   case   when @I_vCOLORCODE_I = 1  then 'Blue'  when @I_vCOLORCODE_I = 2  then 'Green'  when @I_vCOLORCODE_I = 3  then 'Yellow'  when @I_vCOLORCODE_I = 4   then 'Red'  else 'N/A'  end,   REFSOURCEDDL_I = @I_vREFSOURCEDDL_I,  REFERENCESOURCE_I = @I_vREFERENCESOURCE_I,  RELOCATION_I = @I_vRELOCATION_I,  REPLYLETTERSENT_I = @I_vREPLYLETTERSENT_I,  CHANGEBY_I = @I_vCHANGEBY_I,   CHANGEDATE_I = @ActualDate  where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I and ISEQUENCENUMBER_I = @I_vISEQUENCENUMBER_I  if @@error <> 0  begin  select @O_iErrorState = 11019    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end  end end  if (@xtrafields = 1) begin  if not exists(select 1 from DYNAMICS..AX010130 (nolock) where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I)  begin  insert DYNAMICS..AX010130(  APPLICANTNUMBER_I,  DATE1_I,  DATE2_I,  DATE3_I,  DATE4_I,  DATE5_I,  STRINGS_I_1,  STRINGS_I_2,  STRINGS_I_3,  STRINGS_I_4,  STRINGS_I_5,  NUMERICEXTRA_1,  NUMERICEXTRA_2,  NUMERICEXTRA_3,  NUMERICEXTRA_4,  NUMERICEXTRA_5,  DOLLARS_I_1,  DOLLARS_I_2,  DOLLARS_I_3,  DOLLARS_I_4,  DOLLARS_I_5,  CHECKBOXES_I_1,  CHECKBOXES_I_2,  CHECKBOXES_I_3,  CHECKBOXES_I_4,  CHECKBOXES_I_5,  NOTESINDEX_I,  CHANGEBY_I,  CHANGEDATE_I  )  select  @I_vAPPLICANTNUMBER_I,     @I_vDATE1_I,       @I_vDATE2_I,       @I_vDATE3_I,       @I_vDATE4_I,       @I_vDATE5_I,       @I_vSTRINGS_I_1,      @I_vSTRINGS_I_2,      @I_vSTRINGS_I_3,      @I_vSTRINGS_I_4,      @I_vSTRINGS_I_5,      @I_vNUMERICEXTRA_1,      @I_vNUMERICEXTRA_2,      @I_vNUMERICEXTRA_3,      @I_vNUMERICEXTRA_4,      @I_vNUMERICEXTRA_5,      @I_vDOLLARS_I_1,      @I_vDOLLARS_I_2,      @I_vDOLLARS_I_3,      @I_vDOLLARS_I_4,      @I_vDOLLARS_I_5,      @I_vCHECKBOXES_I_1,      @I_vCHECKBOXES_I_2,      @I_vCHECKBOXES_I_3,      @I_vCHECKBOXES_I_4,      @I_vCHECKBOXES_I_5,      0,          @I_vCHANGEBY_I,       @ActualDate        if @@error <> 0  begin  select @O_iErrorState = 11020    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end  end  else  if (@I_vUpdateIfExists = 1) and (@appcount = 1)   begin  update DYNAMICS..AX010130   set   DATE1_I = @I_vDATE1_I,  DATE2_I = @I_vDATE2_I,  DATE3_I = @I_vDATE3_I,  DATE4_I = @I_vDATE4_I,  DATE5_I = @I_vDATE5_I,  STRINGS_I_1 = @I_vSTRINGS_I_1,  STRINGS_I_2 = @I_vSTRINGS_I_2,  STRINGS_I_3 = @I_vSTRINGS_I_3,  STRINGS_I_4 = @I_vSTRINGS_I_4,  STRINGS_I_5 = @I_vSTRINGS_I_5,  NUMERICEXTRA_1 = @I_vNUMERICEXTRA_1,  NUMERICEXTRA_2 = @I_vNUMERICEXTRA_2,  NUMERICEXTRA_3 = @I_vNUMERICEXTRA_3,  NUMERICEXTRA_4 = @I_vNUMERICEXTRA_4,  NUMERICEXTRA_5 = @I_vNUMERICEXTRA_5,  DOLLARS_I_1 = @I_vDOLLARS_I_1,  DOLLARS_I_2 = @I_vDOLLARS_I_2,  DOLLARS_I_3 = @I_vDOLLARS_I_3,  DOLLARS_I_4 = @I_vDOLLARS_I_4,  DOLLARS_I_5 = @I_vDOLLARS_I_5,  CHECKBOXES_I_1 = @I_vCHECKBOXES_I_1,  CHECKBOXES_I_2 = @I_vCHECKBOXES_I_2,  CHECKBOXES_I_3 = @I_vCHECKBOXES_I_3,  CHECKBOXES_I_4 = @I_vCHECKBOXES_I_4,  CHECKBOXES_I_5 = @I_vCHECKBOXES_I_5,  CHANGEBY_I = @I_vCHANGEBY_I,   CHANGEDATE_I = @ActualDate  where APPLICANTNUMBER_I = @I_vAPPLICANTNUMBER_I  if @@error <> 0  begin  select @O_iErrorState = 11021    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @iAddCodeErrState output  return (@O_iErrorState)  end  end end  exec @iStatus = taCreateApplicantPost  @I_vLLASTNAME_I,  @I_vFFIRSTNAME_I,  @I_vAPPLYDATE_I,  @I_vAPPLICANTNUMBER_I,  @I_vISEQUENCENUMBER_I,  @I_vMIDLNAME,  @I_vSSN_I,  @I_vADDRESS1,  @I_vADDRESS2,  @I_vCITY,  @I_vSTATE,  @I_vZIPCODE_I,  @I_vCOUNTRY,  @I_vHOMEPHONE,  @I_vWORKPHONE,  @I_vEXT_I,  @I_vREQUISITIONNUMBER_I,  @I_vCOMPANYCODE_I,  @I_vDIVISIONCODE_I,  @I_vDEPARTMENTCODE_I,  @I_vPOSITIONCODE_I,  @I_vLOCATNID,  @I_vSTATUS0_I,  @I_vREJECTREASON_I,  @I_vDSCRIPTN,  @I_vRELOCATION_I,  @I_vREPLYLETTERSENT_I,  @I_vCOLORCODE_I,  @I_vREFSOURCEDDL_I,  @I_vREFERENCESOURCE_I,  @I_vGENDERGB_I,  @I_vEEOETHNICORIGIN_I,  @I_vEEOAGE_I,  @I_vHANDICAPPED,  @I_vVETERAN,  @I_vDISABLEDVETERAN,  @I_vVIETNAMVETERAN,  @I_vOTHERVET,  @I_vCHANGEBY_I,  @I_vDATE1_I,  @I_vDATE2_I,  @I_vDATE3_I,  @I_vDATE4_I,  @I_vDATE5_I,  @I_vSTRINGS_I_1,  @I_vSTRINGS_I_2,  @I_vSTRINGS_I_3,  @I_vSTRINGS_I_4,  @I_vSTRINGS_I_5,  @I_vNUMERICEXTRA_1,  @I_vNUMERICEXTRA_2,  @I_vNUMERICEXTRA_3,  @I_vNUMERICEXTRA_4,  @I_vNUMERICEXTRA_5,  @I_vDOLLARS_I_1,  @I_vDOLLARS_I_2,  @I_vDOLLARS_I_3,  @I_vDOLLARS_I_4,  @I_vDOLLARS_I_5,  @I_vCHECKBOXES_I_1,  @I_vCHECKBOXES_I_2,  @I_vCHECKBOXES_I_3,  @I_vCHECKBOXES_I_4,  @I_vCHECKBOXES_I_5,  @I_vUpdateIfExists,  @I_vRequesterTrx,  @I_vUSRDEFND1,  @I_vUSRDEFND2,  @I_vUSRDEFND3,  @I_vUSRDEFND4,  @I_vUSRDEFND5,  @O_iErrorState = @iCustomState output,  @oErrString = @iCustomErrString output select @iError = @@error if ((@iStatus <> 0) or (@iCustomState <> 0) or (@iError <> 0)) begin  select @oErrString = rtrim(@oErrString) + ' ' + ltrim(rtrim(@iCustomErrString))  select @O_iErrorState = 11022    exec @iStatus = taUpdateString  @O_iErrorState,  @oErrString,  @oErrString output,  @O_oErrorState output  return (@O_iErrorState) end  return (@O_iErrorState)   
GO
GRANT EXECUTE ON  [dbo].[taCreateApplicant] TO [DYNGRP]
GO
