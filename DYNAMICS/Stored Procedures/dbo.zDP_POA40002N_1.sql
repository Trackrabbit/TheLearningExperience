SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_POA40002N_1] (@BS int, @APRVLUSERID char(15), @CMPANYID smallint, @APRVLUSERID_RS char(15), @CMPANYID_RS smallint, @APRVLUSERID_RE char(15), @CMPANYID_RE smallint) AS  set nocount on IF @APRVLUSERID_RS IS NULL BEGIN SELECT TOP 25  APRVLUSERID, CMPANYID, POA_Approval_Type, POA_Approval_Authority_A, POA_Report_To_User_ID, POA_Security_Type, DEX_ROW_ID FROM .POA40002 WHERE ( APRVLUSERID = @APRVLUSERID AND CMPANYID > @CMPANYID OR APRVLUSERID > @APRVLUSERID ) ORDER BY APRVLUSERID ASC, CMPANYID ASC END ELSE IF @APRVLUSERID_RS = @APRVLUSERID_RE BEGIN SELECT TOP 25  APRVLUSERID, CMPANYID, POA_Approval_Type, POA_Approval_Authority_A, POA_Report_To_User_ID, POA_Security_Type, DEX_ROW_ID FROM .POA40002 WHERE APRVLUSERID = @APRVLUSERID_RS AND CMPANYID BETWEEN @CMPANYID_RS AND @CMPANYID_RE AND ( APRVLUSERID = @APRVLUSERID AND CMPANYID > @CMPANYID OR APRVLUSERID > @APRVLUSERID ) ORDER BY APRVLUSERID ASC, CMPANYID ASC END ELSE BEGIN SELECT TOP 25  APRVLUSERID, CMPANYID, POA_Approval_Type, POA_Approval_Authority_A, POA_Report_To_User_ID, POA_Security_Type, DEX_ROW_ID FROM .POA40002 WHERE APRVLUSERID BETWEEN @APRVLUSERID_RS AND @APRVLUSERID_RE AND CMPANYID BETWEEN @CMPANYID_RS AND @CMPANYID_RE AND ( APRVLUSERID = @APRVLUSERID AND CMPANYID > @CMPANYID OR APRVLUSERID > @APRVLUSERID ) ORDER BY APRVLUSERID ASC, CMPANYID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_POA40002N_1] TO [DYNGRP]
GO
