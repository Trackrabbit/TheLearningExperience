SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE procedure [dbo].[TA_ParentInsertRM]   @MASTERDB char(15), @CUSTNMBR char(30), @CUSTNAME char(85), @CUSTCLAS char(17), @CPRCSTNM char(17), @CNTCPRSN char(40), @STMTNAME char(85), @SHRTNAME char(25), @ADRSCODE char(30), @UPSZONE char(5), @SHIPMTHD char(30), @TAXSCHID char(17), @ADDRESS1 char(40), @ADDRESS2 char(40), @ADDRESS3 char(40), @COUNTRY char(30), @CITY char(40), @STATE char(40), @ZIP char(20), @PHONE1 char(21), @PHONE2 char(21), @PHONE3 char(21), @FAX char(21), @PRBTADCD char(30), @PRSTADCD char(30), @STADDRCD char(30), @SLPRSNID char(30), @CHEKBKID char(30), @PYMTRMID char(30), @CRLMTTYP smallint, @CRLMTAMT numeric(19,5), @CRLMTPER smallint, @CRLMTPAM numeric(19,5), @CURNCYID char(15), @RATETPID char(15), @CUSTDISC smallint, @PRCLEVEL char(11), @MINPYTYP smallint, @MINPYDLR numeric(19,5), @MINPYPCT smallint, @FNCHATYP smallint, @FNCHPCNT smallint, @FINCHDLR numeric(19,5), @MXWOFTYP smallint, @MXWROFAM numeric(19,5), @COMMENT1 char(40), @COMMENT2 char(40), @USERDEF1 char(30), @USERDEF2 char(30), @TAXEXMT1 char(27), @TAXEXMT2 char(27), @TXRGNNUM char(27), @BALNCTYP smallint, @STMTCYCL smallint, @BANKNAME char(40), @BNKBRNCH char(30), @SALSTERR char(30), @DEFCACTY smallint, @FRSTINDT datetime, @INACTIVE tinyint , @HOLD tinyint , @CRCARDID char(17), @CRCRDNUM char(21), @CCRDXPDT datetime, @KPDSTHST tinyint , @KPCALHST tinyint , @KPERHIST tinyint , @KPTRXHST tinyint , @NOTEINDX numeric(19,5), @CREATDDT datetime, @MODIFDT datetime, @Revalue_Customer tinyint, @Post_Results_To smallint, @FINCHID char(15), @GOVCRPID char(31), @GOVINDID char(31), @DISGRPER smallint, @DUEGRPER smallint, @DOCFMTID char(17), @Send_Email_Statements tinyint,				 @USERLANG smallint,					 @GPSFOINTEGRATIONID char(40),				 @INTEGRATIONSOURCE smallint,				 @INTEGRATIONID char(33),				 @ORDERFULFILLDEFAULT smallint,				 @CUSTPRIORITY smallint,					 @CCode char(10),					 @DECLID char(25),					 @SHIPCOMPLETE tinyint,					 @CBVAT tinyint,						 @INCLUDEINDP tinyint,					 @RMCSHACC_ACTNUMST char(129), @RMARACC_ACTNUMST char(129), @RMSLSACC_ACTNUMST char(129), @RMIVACC_ACTNUMST char(129), @RMCOSACC_ACTNUMST char(129), @RMTAKACC_ACTNUMST char(129), @RMAVACC_ACTNUMST char(129), @RMFCGACC_ACTNUMST char(129), @RMWRACC_ACTNUMST char(129), @RMSORACC_ACTNUMST char(129),				 @RMOvrpymtWrtoffAcctIdx_ACTNUMST char(129), 		 @O_SQL_Error_State int = NULL  output with encryption as set transaction isolation level read uncommitted set nocount on declare @RMCSHACC int, @RMARACC  int, @RMSLSACC int, @RMIVACC  int, @RMCOSACC int, @RMTAKACC int, @RMAVACC  int, @RMFCGACC int, @RMWRACC  int, @RMSORACC int,				 @RMOvrpymtWrtoffAcctIdx int,		 @CUSTNMBR2 char(17), @CMPNYNAM char(255), @CStatement varchar(1000), @CStatement1 varchar(1000), @CStatement2 varchar(1000), @CStatement3 varchar(1000), @CStatement4 varchar(1000), @CStatement5 varchar(1000), @CStatement6 varchar(1000), @CStatement7 varchar(1000), @CStatement8 varchar(1000), @CStatement9 varchar(1000), @CStatement10 varchar(1000), @CStatement11 varchar(1000), @CStatement12 varchar(1000), @CStatement13 varchar(1000), @CStatement14 varchar(1000), @CStatement15 varchar(1000), @CStatement16 varchar(1000), @CStatement17 varchar(1000), @CStatement18 varchar(1000), @CStatement19 varchar(1000), @CStatement20 varchar(1000), @CStatement21 varchar(1000), @CStatement22 varchar(1000), @CStatement23 varchar(1000), @CStatement24 varchar(1000), @CStatement25 varchar(1000), @CStatement26 varchar(1000), @CStatement27 varchar(1000), @CStatement28 varchar(1000), @CStatement29 varchar(1000), @CStatement30 varchar(1000), @CStatement31 varchar(1000), @CStatement32 varchar(1000), @CStatement33 varchar(1000), @CStatement34 varchar(1000), @CStatement35 varchar(1000), @CStatement36 varchar(1000), @CStatement37 varchar(1000), @CStatement38 varchar(1000), @CStatement39 varchar(1000), @CStatement40 varchar(1000), @CStatement41 varchar(1000), @CStatement42 varchar(1000), @CStatement43 varchar(1000), @CStatement44 varchar(1000), @CStatement45 varchar(1000), @CStatement46 varchar(1000), @CStatement47 varchar(1000), @CStatement48 varchar(1000), @CStatement49 varchar(1000), @CheckStatus2 int, @CheckStatus3 int, @iStatus int,			 @O_iErrorState int,		 @iError int, @CMPNYNAMID int select	@O_iErrorState = 0, @iStatus = 0 select @CUSTNMBR2 = @CUSTNMBR, @CPRCSTNM = '' Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CUSTNMBR, @CUSTNMBR output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CUSTNAME, @CUSTNAME output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @SHRTNAME, @SHRTNAME output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @STMTNAME, @STMTNAME output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @ADRSCODE, @ADRSCODE output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CNTCPRSN, @CNTCPRSN output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @ADDRESS1, @ADDRESS1 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @ADDRESS2, @ADDRESS2 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @ADDRESS3, @ADDRESS3 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CITY, @CITY output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @STATE, @STATE output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @ZIP, @ZIP output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @COUNTRY, @COUNTRY output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @PRBTADCD, @PRBTADCD output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @PRSTADCD, @PRSTADCD output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @STADDRCD, @STADDRCD output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CUSTCLAS, @CUSTCLAS output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @SLPRSNID, @SLPRSNID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @UPSZONE, @UPSZONE output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @SHIPMTHD, @SHIPMTHD output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @TAXSCHID, @TAXSCHID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @TAXEXMT1, @TAXEXMT1 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @TAXEXMT2, @TAXEXMT2 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @TXRGNNUM, @TXRGNNUM output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @BANKNAME, @BANKNAME output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @BNKBRNCH, @BNKBRNCH output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @COMMENT1, @COMMENT1 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @COMMENT2, @COMMENT2 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @USERDEF1, @USERDEF1 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @USERDEF2, @USERDEF2 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CRCARDID, @CRCARDID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CRCRDNUM, @CRCRDNUM output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @SALSTERR, @SALSTERR output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @GOVCRPID, @GOVCRPID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @GOVINDID, @GOVINDID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @FINCHID, @FINCHID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CHEKBKID, @CHEKBKID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CPRCSTNM, @CPRCSTNM output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @DOCFMTID, @DOCFMTID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @GPSFOINTEGRATIONID, @GPSFOINTEGRATIONID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @INTEGRATIONID, @INTEGRATIONID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CCode, @CCode output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @DECLID, @DECLID output, @O_iErrorState output if not exists( select 1 from tempdb..sysobjects where name = '##REPLMSTR') begin create table ##REPLMSTR (TYPE int, VALUE char (200)) end if not exists(select 1 from ##REPLMSTR where TYPE = 1 and VALUE = @CUSTNMBR2) begin insert into ##REPLMSTR select 1,@CUSTNMBR2 declare taParentInsertRMCursor insensitive CURSOR for select REPLICATE_TO_DB from DYNAMICS..TA_Map where MASTERDB = @MASTERDB and Customers = 1 select  '0' 'CLASSID',0 'RMCSHACC',0 'RMARACC',0 'RMSLSACC',0 'RMIVACC',0 'RMCOSACC',0 'RMTAKACC',  0 'RMAVACC',0 'RMFCGACC',0 'RMWRACC',0 'RMSORACC',0 'RMOvrpymtWrtoffAcctIdx' into #RM00101 set nocount on OPEN taParentInsertRMCursor FETCH NEXT FROM taParentInsertRMCursor INTO @CMPNYNAM WHILE (@@FETCH_STATUS <> -1) begin select @CMPNYNAMID = CMPANYID from SY01500 (nolock) where INTERID = @CMPNYNAM exec @iStatus = DYNAMICS..smGetNextNoteIndex @I_sCompanyID 	= @CMPNYNAMID, @I_iSQLSessionID= 0, @O_mNoteIndex 	= @NOTEINDX output select @iError = @@error if ((@iStatus <> 0)or (@iError <> 0)) begin break end select @CStatement = ' update #RM00101 set RMCSHACC = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@RMCSHACC_ACTNUMST)+'''' select @CStatement1 = ' update #RM00101 set RMARACC = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@RMARACC_ACTNUMST)+'''' select @CStatement2 = ' update #RM00101 set RMSLSACC = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@RMSLSACC_ACTNUMST)+'''' select @CStatement3 = ' update #RM00101 set RMIVACC = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@RMIVACC_ACTNUMST)+'''' select @CStatement4 = ' update #RM00101 set RMCOSACC = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@RMCOSACC_ACTNUMST)+'''' select @CStatement5 = ' update #RM00101 set RMTAKACC = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@RMTAKACC_ACTNUMST)+'''' select @CStatement6 = ' update #RM00101 set RMAVACC = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@RMAVACC_ACTNUMST)+''''	 select @CStatement7 = ' update #RM00101 set RMFCGACC = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@RMFCGACC_ACTNUMST)+'''' select @CStatement8 = ' update #RM00101 set RMWRACC = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@RMWRACC_ACTNUMST)+'''' select @CStatement9 = ' update #RM00101 set RMSORACC = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@RMSORACC_ACTNUMST)+'''' select @CStatement10 = ' update #RM00101 set RMOvrpymtWrtoffAcctIdx = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@RMOvrpymtWrtoffAcctIdx_ACTNUMST)+'''' exec (@CStatement + @CStatement1 + @CStatement2 + @CStatement3 +  @CStatement4 +  @CStatement5 + @CStatement6 + @CStatement7 + @CStatement8 + @CStatement9 + @CStatement10) select @CStatement1 =  ' select distinct(0) as STATUS into ##CheckStatus2 from '+ rtrim(@CMPNYNAM)+'..RM00401 where CUSTNMBR = '+ @CUSTNMBR+'' +'and DCSTATUS = 1 or DCSTATUS = 2' exec (@CStatement1) select @CheckStatus2 = 1  select @CheckStatus2 = STATUS from ##CheckStatus2 if exists( select 1 from tempdb..sysobjects where name = '##CheckStatus2') drop table ##CheckStatus2 select @CStatement1 =  ' select distinct(0) as STATUS into ##CheckStatus3 from '+ rtrim(@CMPNYNAM)+'..RM00401 where CUSTNMBR = '+ @CUSTNMBR+''  exec (@CStatement1) select @CheckStatus3 = 1  select @CheckStatus3 = STATUS from ##CheckStatus3 if exists( select 1 from tempdb..sysobjects where name = '##CheckStatus3') drop table ##CheckStatus3 select  	@RMCSHACC = isnull(RMCSHACC,0), @RMARACC = isnull(RMARACC,0), @RMSLSACC = isnull(RMSLSACC,0), @RMIVACC = isnull(RMIVACC,0), @RMCOSACC = isnull(RMCOSACC,0), @RMTAKACC = isnull(RMTAKACC,0), @RMAVACC = isnull(RMAVACC,0), @RMFCGACC = isnull(RMFCGACC,0), @RMWRACC = isnull(RMWRACC,0), @RMSORACC = isnull(RMSORACC,0), @RMOvrpymtWrtoffAcctIdx = isnull(RMOvrpymtWrtoffAcctIdx,0) from #RM00101 select @CStatement = 'if not exists (select 1 from '+ rtrim(@CMPNYNAM) + '..RM00101 where CUSTNMBR ='+''+rtrim(@CUSTNMBR)+')' select @CStatement1 = 'insert into '+rtrim(@CMPNYNAM) + '..RM00101 (CUSTNMBR,CUSTNAME,CUSTCLAS,CPRCSTNM,CNTCPRSN,STMTNAME, SHRTNAME,ADRSCODE,UPSZONE,SHIPMTHD,TAXSCHID,ADDRESS1, ADDRESS2,ADDRESS3,COUNTRY,CITY,STATE,ZIP,' select @CStatement2 = ' PHONE1,PHONE2,PHONE3,FAX,PRBTADCD,PRSTADCD, STADDRCD,SLPRSNID,CHEKBKID,PYMTRMID,CRLMTTYP,CRLMTAMT, CRLMTPER,CRLMTPAM,CURNCYID,RATETPID,CUSTDISC,PRCLEVEL,' select @CStatement3 = ' MINPYTYP,MINPYDLR,MINPYPCT,FNCHATYP,FNCHPCNT,FINCHDLR, MXWOFTYP,MXWROFAM,COMMENT1,COMMENT2,USERDEF1,USERDEF2, TAXEXMT1,TAXEXMT2,TXRGNNUM,BALNCTYP,STMTCYCL,BANKNAME,' 	select @CStatement4 = ' BNKBRNCH,SALSTERR,DEFCACTY,RMCSHACC,RMARACC,RMSLSACC, RMIVACC,RMCOSACC,RMTAKACC,RMAVACC,RMFCGACC,RMWRACC,RMSORACC, FRSTINDT,INACTIVE,HOLD,CRCARDID,CRCRDNUM,CCRDXPDT,' select @CStatement5 = ' KPDSTHST,KPCALHST,KPERHIST,KPTRXHST,NOTEINDX,CREATDDT, MODIFDT,Revalue_Customer,Post_Results_To,FINCHID,GOVCRPID,GOVINDID, DISGRPER,DUEGRPER,DOCFMTID,Send_Email_Statements,USERLANG,GPSFOINTEGRATIONID,INTEGRATIONSOURCE,INTEGRATIONID, ORDERFULFILLDEFAULT,CUSTPRIORITY,CCode,DECLID,RMOvrpymtWrtoffAcctIdx,SHIPCOMPLETE,CBVAT,INCLUDEINDP)' select @CStatement6 = ' select '+rtrim(@CUSTNMBR)+','+rtrim(@CUSTNAME)+','+rtrim(@CUSTCLAS)+','+rtrim(@CPRCSTNM)+','+rtrim(@CNTCPRSN)+','+rtrim(@STMTNAME)+',' select @CStatement7 =	''+rtrim(@SHRTNAME)+','+rtrim(@ADRSCODE)+','+rtrim(@UPSZONE)+','+rtrim(@SHIPMTHD)+','+rtrim(@TAXSCHID)+','+rtrim(@ADDRESS1)+',' select @CStatement8 =	''+rtrim(@ADDRESS2)+','+rtrim(@ADDRESS3)+','+rtrim(@COUNTRY)+','+rtrim(@CITY)+','+rtrim(@STATE)+','+rtrim(@ZIP)+',' select @CStatement9 =   ''''+rtrim(@PHONE1)+''','''+rtrim(@PHONE2)+''','''+rtrim(@PHONE3)+''','''+rtrim(@FAX)+''','+rtrim(@PRBTADCD)+','+rtrim(@PRSTADCD)+',' select @CStatement10 =	''+rtrim(@STADDRCD)+','+rtrim(@SLPRSNID)+','+rtrim(@CHEKBKID)+','''+rtrim(@PYMTRMID)+''','+str(@CRLMTTYP)+','+str(@CRLMTAMT)+',' select @CStatement11 =	str(@CRLMTPER)+','+str(@CRLMTPAM)+','''+rtrim(@CURNCYID)+''','''+rtrim(@RATETPID)+''','+str(@CUSTDISC)+','''+rtrim(@PRCLEVEL)+''',' select @CStatement12 =  str(@MINPYTYP)+','+str(@MINPYDLR)+','+str(@MINPYPCT)+','+str(@FNCHATYP)+','+str(@FNCHPCNT)+','+str(@FINCHDLR)+',' select @CStatement13 =	str(@MXWOFTYP)+','+str(@MXWROFAM)+','+rtrim(@COMMENT1)+','+rtrim(@COMMENT2)+','+rtrim(@USERDEF1)+','+rtrim(@USERDEF2)+',' select @CStatement14 =	''+rtrim(@TAXEXMT1)+','+rtrim(@TAXEXMT2)+','+rtrim(@TXRGNNUM)+','+str(@BALNCTYP)+','+str(@STMTCYCL)+','+rtrim(@BANKNAME)+',' select @CStatement15 = 	''+rtrim(@BNKBRNCH)+','+rtrim(@SALSTERR)+','+str(@DEFCACTY)+','+str(@RMCSHACC)+','+str(@RMARACC)+','+str(@RMSLSACC)+',' select @CStatement16 = 	str(@RMIVACC)+','+str(@RMCOSACC)+','+str(@RMTAKACC)+','+str(@RMAVACC)+','+str(@RMFCGACC)+','+str(@RMWRACC)+','+str(@RMSORACC)+',' select @CStatement17 = 	''''+rtrim(@FRSTINDT)+''','+str(@INACTIVE)+','+str(@HOLD)+','+rtrim(@CRCARDID)+','+rtrim(@CRCRDNUM)+','''+rtrim(@CCRDXPDT)+''',' select @CStatement18 =  str(@KPDSTHST)+','+str(@KPCALHST)+','+str(@KPERHIST)+','+str(@KPTRXHST)+','+str(@NOTEINDX)+','''+rtrim(@CREATDDT)+''',' select @CStatement19 = 	''''+rtrim(@MODIFDT)+''','+str(@Revalue_Customer)+','+str(@Post_Results_To)+','+rtrim(@FINCHID)+','+rtrim(@GOVCRPID)+','+rtrim(@GOVINDID)+',' select @CStatement20 = 	str(@DISGRPER)+','+str(@DUEGRPER)+','+rtrim(@DOCFMTID)+','+str(@Send_Email_Statements)+','+str(@USERLANG)+','+rtrim(@GPSFOINTEGRATIONID)+',' select @CStatement21 =	str(@INTEGRATIONSOURCE)+','+rtrim(@INTEGRATIONID)+','+str(@ORDERFULFILLDEFAULT)+','+str(@CUSTPRIORITY)+','+rtrim(@CCode)+','+rtrim(@DECLID)+',' select @CStatement22 = str(@RMOvrpymtWrtoffAcctIdx)+','+str(@SHIPCOMPLETE)+','+str(@CBVAT)+','+str(@INCLUDEINDP)+'' select @CStatement23 = 'else update '+rtrim(@CMPNYNAM) + '..RM00101 ' select @CStatement24 = ' set CUSTNAME = '+rtrim(@CUSTNAME)+', CUSTCLAS = '+rtrim(@CUSTCLAS)+', CPRCSTNM = '+rtrim(@CPRCSTNM)+',' select @CStatement25 = '     CNTCPRSN = '+rtrim(@CNTCPRSN)+', STMTNAME = '+rtrim(@STMTNAME)+', SHRTNAME = '+rtrim(@SHRTNAME)+',' select @CStatement26 = '     ADRSCODE = '+rtrim(@ADRSCODE)+', UPSZONE = '+rtrim(@UPSZONE)+', SHIPMTHD = '+rtrim(@SHIPMTHD)+',' select @CStatement27 = '     TAXSCHID = '+rtrim(@TAXSCHID)+',  ADDRESS1 = '+rtrim(@ADDRESS1)+', ADDRESS2 = '+rtrim(@ADDRESS2)+',' select @CStatement28 = '     ADDRESS3 = '+rtrim(@ADDRESS3)+', COUNTRY = '+rtrim(@COUNTRY)+', CITY = '+rtrim(@CITY)+',' select @CStatement29 = '     STATE = '+rtrim(@STATE)+', ZIP = '+rtrim(@ZIP)+', PHONE1 = '''+rtrim(@PHONE1)+''',' select @CStatement30 = '     PHONE2 = '''+rtrim(@PHONE2)+''', PHONE3 = '''+rtrim(@PHONE3)+''', FAX = '''+rtrim(@FAX)+''',' select @CStatement31 = '     PRBTADCD = '+rtrim(@PRBTADCD)+', PRSTADCD = '+rtrim(@PRSTADCD)+', STADDRCD = '+rtrim(@STADDRCD)+',' select @CStatement32 ='	     SLPRSNID = '+rtrim(@SLPRSNID)+',  CHEKBKID = '+rtrim(@CHEKBKID)+', PYMTRMID = '''+rtrim(@PYMTRMID)+''',' select @CStatement33 ='	     CRLMTTYP = '+str(@CRLMTTYP)+', CRLMTAMT = '+str(@CRLMTAMT)+', CRLMTPER = '+str(@CRLMTPER)+',' select @CStatement34 ='      CRLMTPAM = '+str(@CRLMTPAM)+', CURNCYID = '''+rtrim(@CURNCYID)+''', RATETPID = '''+rtrim(@RATETPID)+''',' select @CStatement35 ='      CUSTDISC = '+str(@CUSTDISC)+', PRCLEVEL = '''+rtrim(@PRCLEVEL)+''', MINPYTYP = '+str(@MINPYTYP)+',' select @CStatement36 ='      MINPYDLR = '+str(@MINPYDLR)+', MINPYPCT = '+str(@MINPYPCT)+', FNCHATYP = '+str(@FNCHATYP)+',' select @CStatement37 ='      FNCHPCNT = '+str(@FNCHPCNT)+', FINCHDLR = '+str(@FINCHDLR)+', MXWOFTYP = '+str(@MXWOFTYP)+',' select @CStatement38 ='      MXWROFAM = '+str(@MXWROFAM)+', COMMENT1 = '+rtrim(@COMMENT1)+', COMMENT2 = '+rtrim(@COMMENT2)+',' select @CStatement39 ='      USERDEF1 = '+rtrim(@USERDEF1)+', USERDEF2 = '+rtrim(@USERDEF2)+', TAXEXMT1 = '+rtrim(@TAXEXMT1)+',' select @CStatement40 ='      TAXEXMT2 = '+rtrim(@TAXEXMT2)+',  TXRGNNUM = '+rtrim(@TXRGNNUM)+',  BALNCTYP = case when ('+str(@CheckStatus3)+' = 1)	 then '+str(@BALNCTYP)+' else BALNCTYP end,  STMTCYCL = '+str(@STMTCYCL)+',' select @CStatement41 ='      BANKNAME = '+rtrim(@BANKNAME)+', BNKBRNCH = '+rtrim(@BNKBRNCH)+',' select @CStatement42 ='      SALSTERR = '+rtrim(@SALSTERR)+', DEFCACTY = '+str(@DEFCACTY)+', FRSTINDT = '''+rtrim(@FRSTINDT)+''',' select @CStatement43 ='      INACTIVE = case when ('+str(@CheckStatus2)+' = 1) then '+str(@INACTIVE)+' else INACTIVE end, HOLD = '+str(@HOLD)+',	 CRCARDID = '+rtrim(@CRCARDID)+','  select @CStatement44 ='      CRCRDNUM = '+rtrim(@CRCRDNUM)+',  CCRDXPDT = '''+rtrim(@CCRDXPDT)+''',  KPDSTHST = '+str(@KPDSTHST)+','   select @CStatement45 ='      KPCALHST = '+str(@KPCALHST)+',  KPERHIST = '+str(@KPERHIST)+',  KPTRXHST = '+str(@KPTRXHST)+',' select @CStatement46 ='      Revalue_Customer = '+str(@Revalue_Customer)+', Post_Results_To = '+str(@Post_Results_To)+', FINCHID = '+rtrim(@FINCHID)+','	 select @CStatement47 ='      GOVCRPID = '+rtrim(@GOVCRPID)+', Send_Email_Statements = '+str(@Send_Email_Statements)+', USERLANG = '+str(@USERLANG)+', GPSFOINTEGRATIONID = '+rtrim(@GPSFOINTEGRATIONID)+',' select @CStatement48 ='	     INTEGRATIONSOURCE = '+str(@INTEGRATIONSOURCE)+', INTEGRATIONID = '+rtrim(@INTEGRATIONID)+',	 GOVINDID = '+rtrim(@GOVINDID)+', ORDERFULFILLDEFAULT = '+str(@ORDERFULFILLDEFAULT)+', CUSTPRIORITY = '+str(@CUSTPRIORITY)+', CCode = '+rtrim(@CCode)+', DECLID = '+rtrim(@DECLID)+', SHIPCOMPLETE = '+str(@SHIPCOMPLETE)+', CBVAT = '+str(@CBVAT)+', INCLUDEINDP = '+str(@INCLUDEINDP)+'' select @CStatement49 = '     where CUSTNMBR = '+rtrim(@CUSTNMBR)+'' exec (@CStatement+ @CStatement1 + @CStatement2 + @CStatement3 + @CStatement4 + @CStatement5 + @CStatement6 +  @CStatement7 + @CStatement8 + @CStatement9 + @CStatement10 + @CStatement11 + @CStatement12 + @CStatement13 + @CStatement14 + @CStatement15 + @CStatement16 + @CStatement17 + @CStatement18 + @CStatement19 + @CStatement20 + @CStatement21 + @CStatement22 + @CStatement23 + @CStatement24 + @CStatement25 + @CStatement26 + @CStatement27 + @CStatement28 + @CStatement29 + @CStatement30 + @CStatement31 + @CStatement32 + @CStatement33 + @CStatement34 + @CStatement35 + @CStatement36 + @CStatement37 + @CStatement38 + @CStatement39 + @CStatement40 + @CStatement41 + @CStatement42 + @CStatement43 + @CStatement44 + @CStatement45 + @CStatement46 + @CStatement47 + @CStatement48 + @CStatement49) select @CStatement = 'if not exists (select 1 from '+ rtrim(@CMPNYNAM) + '..RM00103 where CUSTNMBR ='+''+rtrim(@CUSTNMBR)+')' select @CStatement1 = 'insert into '+rtrim(@CMPNYNAM) + '..RM00103 (CUSTNMBR)' select @CStatement2 = ' select '+rtrim(@CUSTNMBR)+'' exec (@CStatement + @CStatement1 + @CStatement2) FETCH NEXT FROM taParentInsertRMCursor INTO @CMPNYNAM end DEALLOCATE taParentInsertRMCursor delete ##REPLMSTR where VALUE = @CUSTNMBR2 and TYPE = 1 end 
GO
GRANT EXECUTE ON  [dbo].[TA_ParentInsertRM] TO [DYNGRP]
GO
