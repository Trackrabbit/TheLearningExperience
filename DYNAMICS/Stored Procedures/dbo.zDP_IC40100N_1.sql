SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS OFF
GO
 CREATE PROC [dbo].[zDP_IC40100N_1] (@BS int, @ORCOMID char(5), @DSTCOMID char(5), @ORCOMID_RS char(5), @DSTCOMID_RS char(5), @ORCOMID_RE char(5), @DSTCOMID_RE char(5)) AS  set nocount on IF @ORCOMID_RS IS NULL BEGIN SELECT TOP 25  ORCOMID, DSTCOMID, ORGFRIDX, ORGTOIDX, DSTFRIDX, DSTTOIDX, USER2ENT, CREATDDT, MODIFDT, MDFUSRID, DEX_ROW_ID FROM .IC40100 WHERE ( ORCOMID = @ORCOMID AND DSTCOMID > @DSTCOMID OR ORCOMID > @ORCOMID ) ORDER BY ORCOMID ASC, DSTCOMID ASC END ELSE IF @ORCOMID_RS = @ORCOMID_RE BEGIN SELECT TOP 25  ORCOMID, DSTCOMID, ORGFRIDX, ORGTOIDX, DSTFRIDX, DSTTOIDX, USER2ENT, CREATDDT, MODIFDT, MDFUSRID, DEX_ROW_ID FROM .IC40100 WHERE ORCOMID = @ORCOMID_RS AND DSTCOMID BETWEEN @DSTCOMID_RS AND @DSTCOMID_RE AND ( ORCOMID = @ORCOMID AND DSTCOMID > @DSTCOMID OR ORCOMID > @ORCOMID ) ORDER BY ORCOMID ASC, DSTCOMID ASC END ELSE BEGIN SELECT TOP 25  ORCOMID, DSTCOMID, ORGFRIDX, ORGTOIDX, DSTFRIDX, DSTTOIDX, USER2ENT, CREATDDT, MODIFDT, MDFUSRID, DEX_ROW_ID FROM .IC40100 WHERE ORCOMID BETWEEN @ORCOMID_RS AND @ORCOMID_RE AND DSTCOMID BETWEEN @DSTCOMID_RS AND @DSTCOMID_RE AND ( ORCOMID = @ORCOMID AND DSTCOMID > @DSTCOMID OR ORCOMID > @ORCOMID ) ORDER BY ORCOMID ASC, DSTCOMID ASC END set nocount off    
GO
GRANT EXECUTE ON  [dbo].[zDP_IC40100N_1] TO [DYNGRP]
GO
