SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
CREATE procedure [dbo].[TA_ParentInsertPM]   @MASTERDB char(15), @VENDORID char(30), @VENDNAME char(80),  @VNDCHKNM char(80), @VENDSHNM char(80), @VADDCDPR char(30), @VADCDPAD char(30), @VADCDSFR char(30), @VADCDTRO char(30), @VNDCLSID char(30), @VNDCNTCT char(40), @ADDRESS1 char(40), @ADDRESS2 char(40), @ADDRESS3 char(40), @CITY char(40),     @STATE char(40),    @ZIPCODE char(13),  @COUNTRY char(40),  @PHNUMBR1 char(15), @PHNUMBR2 char(15), @PHONE3 char(15), @FAXNUMBR char(21), @UPSZONE char(5),   @SHIPMTHD char(40), @TAXSCHID char(17), @ACNMVNDR char(23), @TXIDNMBR char(13), @VENDSTTS smallint, @CURNCYID char(15), @TXRGNNUM char(27), @PARVENID char(17), @TRDDISCT smallint, @TEN99TYPE smallint, @TEN99BOXNUMBER smallint, @MINORDER numeric (19,5), @PYMTRMID char(21), @MINPYTYP smallint, @MINPYPCT smallint, @MINPYDLR numeric (19,5), @MXIAFVND smallint, @MAXINDLR numeric (19,5), @COMMENT1 char(40), @COMMENT2 char(40), @USERDEF1 char(40), @USERDEF2 char(40), @CRLMTDLR numeric (19,5), @PYMNTPRI char(5), @KPCALHST tinyint, @KGLDSTHS tinyint, @KPERHIST tinyint, @KPTRXHST tinyint, @HOLD tinyint, @PTCSHACF smallint, @CREDTLMT smallint, @WRITEOFF smallint, @MXWOFAMT numeric (19,5), @SBPPSDED tinyint, @PPSTAXRT smallint, @DXVARNUM char(25), @CRTCOMDT datetime, @CRTEXPDT datetime, @RTOBUTKN tinyint, @XPDTOBLG tinyint, @PRSPAYEE tinyint, @NOTEINDX numeric (19,5), @CHEKBKID char(30), @MODIFDT  datetime, @CREATDDT datetime, @RATETPID char(15), @Revalue_Vendor tinyint, @Post_Results_To smallint, @FREEONBOARD smallint, @GOVCRPID char(33), @GOVINDID char(33), @DISGRPER smallint, @DUEGRPER smallint, @DOCFMTID char(15), @TaxInvRecvd tinyint, @USERLANG smallint,			 @WithholdingType smallint,		 @WithholdingFormType smallint,		 @WithholdingEntityType smallint,	 @TaxFileNumMode smallint,		 @BRTHDATE datetime,			 @LaborPmtType smallint,			 @CCode char(10),			 @DECLID char(25),			 @CBVAT tinyint,				 @Workflow_Approval_Status smallint,  @Workflow_Priority smallint,  @VADCD1099 char(15), @PMAPINDX_ACTNUMST char(129), @PMCSHIDX_ACTNUMST char(129), @PMDAVIDX_ACTNUMST char(129), @PMDTKIDX_ACTNUMST char(129), @PMFINIDX_ACTNUMST char(129), @PMMSCHIX_ACTNUMST char(129), @PMFRTIDX_ACTNUMST char(129), @PMTAXIDX_ACTNUMST char(129), @PMWRTIDX_ACTNUMST char(129), @PMPRCHIX_ACTNUMST char(129), @PMRTNGIX_ACTNUMST char(129), @PMTDSCIX_ACTNUMST char(129), @ACPURIDX_ACTNUMST char(129),  @PURPVIDX_ACTNUMST char(129), @O_SQL_Error_State int = NULL  output as set transaction isolation level read uncommitted set nocount on declare @PMAPINDX int, @PMCSHIDX int, @PMDAVIDX int, @PMDTKIDX int, @PMFINIDX int, @PMMSCHIX int, @PMFRTIDX int, @PMTAXIDX int, @PMWRTIDX int, @PMPRCHIX int, @PMRTNGIX int, @PMTDSCIX int, @ACPURIDX int, @PURPVIDX int, @VENDORID2 char(17),				 @CMPNYNAM char(255), @CStatement varchar(1000),  @CStatement1 varchar(1000),  @CStatement2 varchar(1000), @CStatement3 varchar(1000), @CStatement4 varchar(1000), @CStatement5 varchar(1000), @CStatement6 varchar(1000), @CStatement7 varchar(1000), @CStatement8 varchar(1000), @CStatement9 varchar(1000), @CStatement10 varchar(1000), @CStatement11 varchar(1000),  @CStatement12 varchar(1000), @CStatement13 varchar(1000), @CStatement14 varchar(1000), @CStatement15 varchar(1000), @CStatement16 varchar(1000), @CStatement17 varchar(1000), @CStatement18 varchar(1000), @CStatement19 varchar(1000), @CStatement20 varchar(1000), @CStatement21 varchar(1000), @CStatement22 varchar(1000), @CStatement23 varchar(1000), @CStatement24 varchar(1000), @CStatement25 varchar(1000), @CStatement26 varchar(1000), @CStatement27 varchar(1000), @CStatement28 varchar(1000), @CStatement29 varchar(1000), @CStatement30 varchar(1000), @CStatement31 varchar(1000),  @CStatement32 varchar(1000), @CStatement33 varchar(1000), @CStatement34 varchar(1000), @CStatement35 varchar(1000), @CStatement36 varchar(1000), @CStatement37 varchar(1000), @CStatement38 varchar(1000), @CStatement39 varchar(1000), @CStatement40 varchar(1000), @CStatement41 varchar(1000),  @CStatement42 varchar(1000), @CStatement43 varchar(1000), @CStatement44 varchar(1000), @CStatement45 varchar(1000), @CStatement46 varchar(1000), @CStatement47 varchar(1000), @CStatement48 varchar(1000), @CStatement49 varchar(1000), @CStatement50 varchar(1000), @CheckStatus int,		 @iStatus int,			 @O_iErrorState int,		 @iError int, @CMPNYNAMID int select	@O_iErrorState = 0, @iStatus = 0 select @VENDORID2 = @VENDORID Exec @iStatus = DYNAMICS..taFormatStringsForExecs @VENDORID, @VENDORID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @VENDNAME, @VENDNAME output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @VNDCHKNM, @VNDCHKNM output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @VENDSHNM, @VENDSHNM output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @VADDCDPR, @VADDCDPR output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @VADCDPAD, @VADCDPAD output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @VADCDSFR, @VADCDSFR output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @VADCDTRO, @VADCDTRO output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @VNDCLSID, @VNDCLSID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @VNDCNTCT, @VNDCNTCT output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @ADDRESS1, @ADDRESS1 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @ADDRESS2, @ADDRESS2 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @ADDRESS3, @ADDRESS3 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CITY, @CITY output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @STATE, @STATE output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @ZIPCODE, @ZIPCODE output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @COUNTRY, @COUNTRY output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @UPSZONE, @UPSZONE output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @SHIPMTHD, @SHIPMTHD output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @TAXSCHID, @TAXSCHID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @ACNMVNDR, @ACNMVNDR output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @COMMENT1, @COMMENT1 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @COMMENT2, @COMMENT2 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @USERDEF1, @USERDEF1 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @USERDEF2, @USERDEF2 output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @TXIDNMBR, @TXIDNMBR output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @TXRGNNUM, @TXRGNNUM output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CHEKBKID, @CHEKBKID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @PARVENID, @PARVENID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @GOVCRPID, @GOVCRPID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @GOVINDID, @GOVINDID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @CCode, @CCode output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @DECLID, @DECLID output, @O_iErrorState output Exec @iStatus = DYNAMICS..taFormatStringsForExecs @VADCD1099, @VADCD1099 output, @O_iErrorState output if not exists( select 1 from tempdb..sysobjects where name = '##REPLMSTR') begin create table ##REPLMSTR ( TYPE int, VALUE char (200) ) end if not exists( select 1 from ##REPLMSTR where TYPE = 2 and VALUE = @VENDORID2 ) begin insert into ##REPLMSTR select 2,@VENDORID2 declare TAParentInsertPM insensitive CURSOR for select REPLICATE_TO_DB from DYNAMICS..TA_Map where MASTERDB = @MASTERDB and Vendors = 1 select  '0' 'VNDCLSID', 0 'PMAPINDX',0 'PMCSHIDX' ,0 'PMDAVIDX' ,0 'PMDTKIDX',0 'PMFINIDX' ,0 'PMMSCHIX' ,  0 'PMFRTIDX',0 'PMTAXIDX' ,0 'PMWRTIDX' ,0 'PMPRCHIX' ,0 'PMRTNGIX',0 'PMTDSCIX' , 0 'ACPURIDX',0 'PURPVIDX' into #PM00200 set nocount on OPEN TAParentInsertPM FETCH NEXT FROM TAParentInsertPM INTO @CMPNYNAM WHILE (@@FETCH_STATUS <> -1) begin select @CMPNYNAMID = CMPANYID from SY01500 (nolock) where INTERID = @CMPNYNAM exec @iStatus = DYNAMICS..smGetNextNoteIndex @I_sCompanyID 	= @CMPNYNAMID, @I_iSQLSessionID= 0, @O_mNoteIndex 	= @NOTEINDX output select @iError = @@error if ((@iStatus <> 0)or (@iError <> 0)) begin break end select @CStatement = ' update #PM00200 set PMAPINDX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PMAPINDX_ACTNUMST)+'''' select @CStatement1 = ' update #PM00200 set PMCSHIDX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PMCSHIDX_ACTNUMST)+'''' select @CStatement2 = ' update #PM00200 set PMDAVIDX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PMDAVIDX_ACTNUMST)+'''' select @CStatement3 = ' update #PM00200 set PMDTKIDX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PMDTKIDX_ACTNUMST)+'''' select @CStatement4 = ' update #PM00200 set PMFINIDX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PMFINIDX_ACTNUMST)+'''' select @CStatement5 = ' update #PM00200 set PMMSCHIX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PMMSCHIX_ACTNUMST)+'''' select @CStatement6 = ' update #PM00200 set PMFRTIDX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PMFRTIDX_ACTNUMST)+'''' select @CStatement7 = ' update #PM00200 set PMTAXIDX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PMTAXIDX_ACTNUMST)+'''' select @CStatement8 = ' update #PM00200 set PMWRTIDX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PMWRTIDX_ACTNUMST)+'''' select @CStatement9 = ' update #PM00200 set PMPRCHIX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PMPRCHIX_ACTNUMST)+'''' select @CStatement10 = ' update #PM00200 set PMRTNGIX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PMRTNGIX_ACTNUMST)+'''' select @CStatement11 = ' update #PM00200 set PMTDSCIX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PMTDSCIX_ACTNUMST)+'''' select @CStatement12 = ' update #PM00200 set ACPURIDX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@ACPURIDX_ACTNUMST)+'''' select @CStatement13 = ' update #PM00200 set PURPVIDX = ACTINDX from '+ rtrim(@CMPNYNAM) + '..GL00105 where ACTNUMST ='+''''+rtrim(@PURPVIDX_ACTNUMST)+'''' exec ( @CStatement + @CStatement1 + @CStatement2 + @CStatement3 + @CStatement4 + @CStatement5 + @CStatement6 + @CStatement7 + @CStatement8 + @CStatement9 + @CStatement10 + @CStatement11 + @CStatement12 + @CStatement13) select @CStatement1 =  ' select distinct(0) as STATUS into ##CheckStatus from '+ rtrim(@CMPNYNAM)+'..PM00400 where VENDORID = '+ @VENDORID+'' +'and (DCSTATUS = 1 or DCSTATUS = 2)' exec (@CStatement1) select @CheckStatus = 1  select @CheckStatus = STATUS from ##CheckStatus if exists( select 1 from tempdb..sysobjects where name = '##CheckStatus') drop table ##CheckStatus	 select  	@PMAPINDX = isnull(PMAPINDX,0), @PMCSHIDX = isnull(PMCSHIDX,0), @PMDAVIDX = isnull(PMDAVIDX,0), @PMDTKIDX = isnull(PMDTKIDX,0), @PMFINIDX = isnull(PMFINIDX,0), @PMMSCHIX = isnull(PMMSCHIX,0), @PMFRTIDX = isnull(PMFRTIDX,0), @PMTAXIDX = isnull(PMTAXIDX,0), @PMWRTIDX = isnull(PMWRTIDX,0), @PMPRCHIX = isnull(PMPRCHIX,0), @PMRTNGIX = isnull(PMRTNGIX,0), @PMTDSCIX = isnull(PMTDSCIX,0), @ACPURIDX = isnull(ACPURIDX,0), @PURPVIDX = isnull(PURPVIDX,0) from #PM00200 select @CStatement = 'if not exists (select 1 from '+ rtrim(@CMPNYNAM) + '..PM00200 where VENDORID ='+''+rtrim(@VENDORID)+')' select @CStatement1 = 	'insert into '+rtrim(@CMPNYNAM) + '..PM00200 			 (VENDORID,VENDNAME,VNDCHKNM,VENDSHNM,VADDCDPR,VADCDPAD, VADCDSFR,VADCDTRO,VNDCLSID,VNDCNTCT,ADDRESS1,ADDRESS2, ADDRESS3,CITY,STATE,ZIPCODE,COUNTRY,PHNUMBR1,' select @CStatement2 = ' PHNUMBR2,PHONE3,FAXNUMBR,UPSZONE,SHIPMTHD,TAXSCHID,ACNMVNDR, TXIDNMBR,VENDSTTS,CURNCYID,TXRGNNUM,PARVENID,TRDDISCT, TEN99TYPE,TEN99BOXNUMBER,MINORDER,PYMTRMID,MINPYTYP,MINPYPCT,'				 select @CStatement3 = ' MINPYDLR,MXIAFVND,MAXINDLR,COMMENT1,COMMENT2,USERDEF1, USERDEF2,CRLMTDLR,PYMNTPRI,KPCALHST,KGLDSTHS,KPERHIST, KPTRXHST,HOLD,PTCSHACF,CREDTLMT,WRITEOFF,MXWOFAMT,' 		select @CStatement4 = ' SBPPSDED,PPSTAXRT,DXVARNUM,CRTCOMDT,CRTEXPDT,RTOBUTKN, XPDTOBLG,PRSPAYEE,PMAPINDX,PMCSHIDX,PMDAVIDX,PMDTKIDX, PMFINIDX,PMMSCHIX,PMFRTIDX,PMTAXIDX,PMWRTIDX,PMPRCHIX,' select @CStatement5 = ' PMRTNGIX,PMTDSCIX,ACPURIDX,PURPVIDX,NOTEINDX,CHEKBKID, MODIFDT,CREATDDT,RATETPID,Revalue_Vendor,Post_Results_To,FREEONBOARD, GOVCRPID,GOVINDID,DISGRPER,DUEGRPER,DOCFMTID,TaxInvRecvd, USERLANG,WithholdingType,WithholdingFormType,WithholdingEntityType,TaxFileNumMode, BRTHDATE,LaborPmtType,CCode,DECLID,CBVAT,Workflow_Approval_Status,Workflow_Priority,VADCD1099)' select @CStatement6 = ' select '+rtrim(@VENDORID)+','+rtrim(@VENDNAME)+','+rtrim(@VNDCHKNM)+','+rtrim(@VENDSHNM)+','+rtrim(@VADDCDPR)+','+rtrim(@VADCDPAD)+',' select @CStatement7 =	''+rtrim(@VADCDSFR)+','+rtrim(@VADCDTRO)+','+rtrim(@VNDCLSID)+','+rtrim(@VNDCNTCT)+','+rtrim(@ADDRESS1)+','+rtrim(@ADDRESS2)+',' select @CStatement8 =	''+rtrim(@ADDRESS3)+','+rtrim(@CITY)+','+rtrim(@STATE)+','+rtrim(@ZIPCODE)+','+rtrim(@COUNTRY)+','''+rtrim(@PHNUMBR1)+''',' select @CStatement9 =   ''''+rtrim(@PHNUMBR2)+''','''+rtrim(@PHONE3)+''','''+rtrim(@FAXNUMBR)+''','+rtrim(@UPSZONE)+','+rtrim(@SHIPMTHD)+','+rtrim(@TAXSCHID)+','+rtrim(@ACNMVNDR)+',' select @CStatement10 =	''+rtrim(@TXIDNMBR)+','+str(@VENDSTTS)+','''+rtrim(@CURNCYID)+''','+rtrim(@TXRGNNUM)+','+rtrim(@PARVENID)+','+str(@TRDDISCT)+',' select @CStatement11 =	ltrim(str(@TEN99TYPE))+','+ltrim(str(@TEN99BOXNUMBER))+','+str(@MINORDER)+','''+rtrim(@PYMTRMID)+''','+str(@MINPYTYP)+','+str(@MINPYPCT)+','				 select @CStatement12 =  ltrim(str(@MINPYDLR))+','+str(@MXIAFVND)+','+str(@MAXINDLR)+','+rtrim(@COMMENT1)+','+rtrim(@COMMENT2)+','+rtrim(@USERDEF1)+',' select @CStatement13 =	''+rtrim(@USERDEF2)+','+str(@CRLMTDLR)+','''+rtrim(@PYMNTPRI)+''','+str(@KPCALHST)+','+str(@KGLDSTHS)+','+str(@KPERHIST)+',' select @CStatement14 =	str(@KPTRXHST)+','+str(@HOLD)+','+str(@PTCSHACF)+','+str(@CREDTLMT)+','+str(@WRITEOFF)+','+str(@MXWOFAMT)+',' select @CStatement15 = 	str(@SBPPSDED)+','+str(@PPSTAXRT)+','''+rtrim(@DXVARNUM)+''','''+rtrim(@CRTCOMDT)+''','''+rtrim(@CRTEXPDT)+''','+str(@RTOBUTKN)+',' select @CStatement16 = 	str(@XPDTOBLG)+','+str(@PRSPAYEE)+','+str(@PMAPINDX)+','+str(@PMCSHIDX)+','+str(@PMDAVIDX)+','+str(@PMDTKIDX)+',' select @CStatement17 = 	str(@PMFINIDX)+','+str(@PMMSCHIX)+','+str(@PMFRTIDX)+','+str(@PMTAXIDX)+','+str(@PMWRTIDX)+','+str(@PMPRCHIX)+',' select @CStatement18 =  str(@PMRTNGIX)+','+str(@PMTDSCIX)+','+str(@ACPURIDX)+','+str(@PURPVIDX)+','+str(@NOTEINDX)+','+rtrim(@CHEKBKID)+',' select @CStatement19 = 	''''+rtrim(@MODIFDT)+''','''+rtrim(@CREATDDT)+''','''+rtrim(@RATETPID)+''','+str(@Revalue_Vendor)+','+str(@Post_Results_To)+','+str(@FREEONBOARD)+',' select @CStatement20 = 	''+rtrim(@GOVCRPID)+','+rtrim(@GOVINDID)+','+str(@DISGRPER)+','+str(@DUEGRPER)+','''+rtrim(@DOCFMTID)+''','+str(@TaxInvRecvd)+',' select @CStatement21 =  str(@USERLANG)+','+str(@WithholdingType)+','+str(@WithholdingFormType)+','+str(@WithholdingEntityType)+','+str(@TaxFileNumMode)+',' select @CStatement22 =  ''''+rtrim(@BRTHDATE)+''','+str(@LaborPmtType)+','+rtrim(@CCode)+','+rtrim(@DECLID)+','+str(@CBVAT)+','+str(@Workflow_Approval_Status)+','+str(@Workflow_Priority)+','+rtrim(@VADCD1099) select @CStatement23 = ' else update '+rtrim(@CMPNYNAM) + '..PM00200 '			 select @CStatement24 = ' set VENDNAME = '+rtrim(@VENDNAME)+', VNDCHKNM = '+rtrim(@VNDCHKNM)+', VENDSHNM = '+rtrim(@VENDSHNM)+',' select @CStatement25 = '     VADDCDPR = '+rtrim(@VADDCDPR)+', VADCDPAD = '+rtrim(@VADCDPAD)+', VADCDSFR = '+rtrim(@VADCDSFR)+',' select @CStatement26 = '     VADCDTRO = '+rtrim(@VADCDTRO)+', VNDCLSID = '+rtrim(@VNDCLSID)+', VNDCNTCT = '+rtrim(@VNDCNTCT)+',' select @CStatement27 = '     ADDRESS1 = '+rtrim(@ADDRESS1)+',  ADDRESS2 = '+rtrim(@ADDRESS2)+', ADDRESS3 = '+rtrim(@ADDRESS3)+',' select @CStatement28 = '     CITY = '+rtrim(@CITY)+', STATE = '+rtrim(@STATE)+', ZIPCODE = '+rtrim(@ZIPCODE)+',' select @CStatement29 = '     COUNTRY = '+rtrim(@COUNTRY)+', PHNUMBR1 = '''+rtrim(@PHNUMBR1)+''', PHNUMBR2 = '''+rtrim(@PHNUMBR2)+''',' select @CStatement30 = '     PHONE3 = '''+rtrim(@PHONE3)+''', FAXNUMBR = '''+rtrim(@FAXNUMBR)+''', UPSZONE = '+rtrim(@UPSZONE)+',' select @CStatement31 = '     SHIPMTHD = '+rtrim(@SHIPMTHD)+', TAXSCHID = '+rtrim(@TAXSCHID)+', ACNMVNDR = '+rtrim(@ACNMVNDR)+',' select @CStatement32 ='	     TXIDNMBR = '+rtrim(@TXIDNMBR)+',  VENDSTTS = case when ('+str(@CheckStatus)+' = 1) then '+str(@VENDSTTS)+'  else VENDSTTS end, CURNCYID = '''+rtrim(@CURNCYID)+''',' select @CStatement33 ='	     TXRGNNUM = '+rtrim(@TXRGNNUM)+', PARVENID = '+rtrim(@PARVENID)+', TRDDISCT = '+str(@TRDDISCT)+',' select @CStatement34 ='      TEN99TYPE = '+str(@TEN99TYPE)+', TEN99BOXNUMBER = '+str(@TEN99BOXNUMBER)+', MINORDER = '+str(@MINORDER)+', PYMTRMID = '''+rtrim(@PYMTRMID)+''',' select @CStatement35 ='      MINPYTYP = '+str(@MINPYTYP)+', MINPYPCT = '+str(@MINPYPCT)+', MINPYDLR = '+str(@MINPYDLR)+', COMMENT1 = '+rtrim(@COMMENT1)+',' select @CStatement36 ='      COMMENT2 = '+rtrim(@COMMENT2)+', USERDEF1 = '+rtrim(@USERDEF1)+', USERDEF2 = '+rtrim(@USERDEF2)+',' select @CStatement37 ='      CRLMTDLR = '+str(@CRLMTDLR)+', PYMNTPRI = '''+rtrim(@PYMNTPRI)+''', KPCALHST = '+str(@KPCALHST)+',' select @CStatement38 ='      KGLDSTHS = '+str(@KGLDSTHS)+', KPERHIST = '+str(@KPERHIST)+', KPTRXHST = '+str(@KPTRXHST)+',' select @CStatement39 ='      HOLD = '+str(@HOLD)+', PTCSHACF = '+str(@PTCSHACF)+', CREDTLMT = '+str(@CREDTLMT)+',' select @CStatement40 ='      WRITEOFF = '+str(@WRITEOFF)+', MXWOFAMT = '+str(@MXWOFAMT)+', SBPPSDED = '+str(@SBPPSDED)+',' select @CStatement41 ='      PPSTAXRT = '+str(@PPSTAXRT)+', DXVARNUM = '''+rtrim(@DXVARNUM)+''', CRTCOMDT = '''+rtrim(@CRTCOMDT)+''',' select @CStatement42 ='      CRTEXPDT = '''+rtrim(@CRTEXPDT)+''', RTOBUTKN = '+str(@RTOBUTKN)+', XPDTOBLG = '+str(@XPDTOBLG)+',' select @CStatement43 ='      PRSPAYEE = '+str(@PRSPAYEE)+',	 CHEKBKID = '+rtrim(@CHEKBKID)+',	 RATETPID = '''+rtrim(@RATETPID)+''','  select @CStatement44 ='      Revalue_Vendor = '+str(@Revalue_Vendor)+','  select @CStatement45 ='      Post_Results_To = '+str(@Post_Results_To)+', FREEONBOARD = '+str(@FREEONBOARD)+','	 select @CStatement46 ='      GOVCRPID = '+rtrim(@GOVCRPID)+',	 GOVINDID = '+rtrim(@GOVINDID)+', DISGRPER = '+str(@DISGRPER)+',' select @CStatement47 ='      DUEGRPER = '+str(@DUEGRPER)+', DOCFMTID = '''+rtrim(@DOCFMTID)+''', TaxInvRecvd = '+str(@KPCALHST)+',' select @CStatement48 ='	     USERLANG = '+str(@USERLANG)+', WithholdingType = '+str(@WithholdingType)+', WithholdingFormType = '+str(@WithholdingFormType)+', WithholdingEntityType = '+str(@WithholdingEntityType)+',' select @CStatement49 ='	     TaxFileNumMode = '+str(@TaxFileNumMode)+', BRTHDATE = '''+rtrim(@BRTHDATE)+''', LaborPmtType = '+str(@LaborPmtType)+', CCode = '+rtrim(@CCode)+', DECLID = '+rtrim(@DECLID)+', CBVAT = '+str(@CBVAT)+', Workflow_Approval_Status = '+str(@Workflow_Approval_Status)+', Workflow_Priority = '+str(@Workflow_Priority)+', VADCD1099 = '+rtrim(@VADCD1099)+'' select @CStatement50 = '     where VENDORID = '+rtrim(@VENDORID)+'' exec (@CStatement + @CStatement1 + @CStatement2 + @CStatement3 + @CStatement4 + @CStatement5 + @CStatement6 +  @CStatement7 + @CStatement8 + @CStatement9 + @CStatement10 + @CStatement11 + @CStatement12 + @CStatement13 + @CStatement14 + @CStatement15 + @CStatement16 + @CStatement17 + @CStatement18 + @CStatement19 + @CStatement20 + @CStatement21 + @CStatement22 + @CStatement23 + @CStatement24 + @CStatement25 + @CStatement26 + @CStatement27 + @CStatement28 + @CStatement29 + @CStatement30 + @CStatement31 + @CStatement32 + @CStatement33 + @CStatement34 + @CStatement35 + @CStatement36 + @CStatement37 + @CStatement38 + @CStatement39 + @CStatement40 + @CStatement41 + @CStatement42 + @CStatement43 + @CStatement44 + @CStatement45 + @CStatement46 + @CStatement47 + @CStatement48 + @CStatement49 + @CStatement50 )  FETCH NEXT FROM TAParentInsertPM INTO @CMPNYNAM end DEALLOCATE TAParentInsertPM delete ##REPLMSTR where VALUE = @VENDORID2 and TYPE = 2 end 
GO
GRANT EXECUTE ON  [dbo].[TA_ParentInsertPM] TO [DYNGRP]
GO
