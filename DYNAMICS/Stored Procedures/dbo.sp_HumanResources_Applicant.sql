SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 CREATE PROCEDURE [dbo].[sp_HumanResources_Applicant] @iLanguageID int  as  set nocount on   declare @sqldropstring varchar(400),  @sqldefaultstring varchar(8000),  @sqlstring1 varchar(8000),  @sqlstring2 varchar(8000),  @sqlstring3 varchar(8000),  @sqlstring4 varchar(8000),  @sqlstring5 varchar(8000),  @sqlstring6 varchar(8000),  @sqlstring7 varchar(8000),  @sqlstring8 varchar(8000),  @sqlstring9 varchar(8000),  @sqlstring10 varchar(8000),  @sqljoinstring varchar(8000),  @sqlaccessstring varchar(2000),  @tNumberSegments int,  @tSegment int,  @I_iDictID int,  @I_iLangID int,  @I_iMessageNumber int,  @I_iAliasMessageNumber int,  @I_iIntegerValue int,  @First_Name varchar(255), @Last_Name varchar(255), @Address_1 varchar(255), @Address_2 varchar(255), @City varchar(255), @State varchar(255), @Zip_Code varchar(255), @Home_Phone varchar(255), @Work_Phone varchar(255), @Applicant_Number varchar(255), @ISSN varchar(255), @Middle_Name varchar(255), @Country varchar(255), @Ext varchar(255), @ISequence_Number varchar(255), @Apply_Date varchar(255), @Requisition_Number varchar(255), @Company_Code varchar(255), @Division_Code varchar(255), @Department_Code varchar(255), @Position_Code varchar(255), @Location_Code varchar(255), @Status varchar(255), @Reject_Reason varchar(255), @Reject_Comment varchar(255), @Relocation varchar(255), @Reply_Letter_Sent varchar(255), @Color_Code varchar(255), @Color_String varchar(255), @Ref_Source_DDL varchar(255), @Description varchar(255), @Gender_GB varchar(255), @EEO_Ethnic_Origin varchar(255), @EEO_Age varchar(255), @Handicapped varchar(255), @Veteran varchar(255), @Disabled_Veteran varchar(255), @Vietnam_Veteran varchar(255), @Notes_Index varchar(255), @Change_By varchar(255), @Change_Date varchar(255) select @I_iDictID = 414 select @I_iMessageNumber = 26100 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @First_Name output  select @I_iDictID = 414 select @I_iMessageNumber = 26101 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Last_Name output  select @I_iDictID = 414 select @I_iMessageNumber = 26102 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_1 output  select @I_iDictID = 414 select @I_iMessageNumber = 26103 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Address_2 output  select @I_iDictID = 414 select @I_iMessageNumber = 26104 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @City output  select @I_iDictID = 414 select @I_iMessageNumber = 26105 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @State output  select @I_iDictID = 414 select @I_iMessageNumber = 26106 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Zip_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26107 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Home_Phone output  select @I_iDictID = 414 select @I_iMessageNumber = 26108 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Work_Phone output  select @I_iDictID = 414 select @I_iMessageNumber = 26109 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Applicant_Number output  select @I_iDictID = 414 select @I_iMessageNumber = 26110 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ISSN output  select @I_iDictID = 414 select @I_iMessageNumber = 26111 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Middle_Name output  select @I_iDictID = 414 select @I_iMessageNumber = 26112 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Country output  select @I_iDictID = 414 select @I_iMessageNumber = 26113 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ext output  select @I_iDictID = 414 select @I_iMessageNumber = 26114 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @ISequence_Number output  select @I_iDictID = 414 select @I_iMessageNumber = 26115 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Apply_Date output  select @I_iDictID = 414 select @I_iMessageNumber = 26116 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Requisition_Number output  select @I_iDictID = 414 select @I_iMessageNumber = 26117 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Company_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26118 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Division_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26119 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Department_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26120 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Position_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26121 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Location_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26122 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Status output  select @I_iDictID = 414 select @I_iMessageNumber = 26123 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reject_Reason output  select @I_iDictID = 414 select @I_iMessageNumber = 26124 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reject_Comment output  select @I_iDictID = 414 select @I_iMessageNumber = 26125 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Relocation output  select @I_iDictID = 414 select @I_iMessageNumber = 26126 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Reply_Letter_Sent output  select @I_iDictID = 414 select @I_iMessageNumber = 26127 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Color_Code output  select @I_iDictID = 414 select @I_iMessageNumber = 26128 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Color_String output  select @I_iDictID = 414 select @I_iMessageNumber = 26129 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Ref_Source_DDL output  select @I_iDictID = 414 select @I_iMessageNumber = 26130 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Description output  select @I_iDictID = 414 select @I_iMessageNumber = 26131 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Gender_GB output  select @I_iDictID = 414 select @I_iMessageNumber = 26132 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @EEO_Ethnic_Origin output  select @I_iDictID = 414 select @I_iMessageNumber = 26133 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @EEO_Age output  select @I_iDictID = 414 select @I_iMessageNumber = 26134 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Handicapped output  select @I_iDictID = 414 select @I_iMessageNumber = 26135 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Veteran output  select @I_iDictID = 414 select @I_iMessageNumber = 26136 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Disabled_Veteran output  select @I_iDictID = 414 select @I_iMessageNumber = 26137 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Vietnam_Veteran output  select @I_iDictID = 414 select @I_iMessageNumber = 26138 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Notes_Index output  select @I_iDictID = 414 select @I_iMessageNumber = 26139 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Change_By output  select @I_iDictID = 414 select @I_iMessageNumber = 26140 select @I_iAliasMessageNumber = 0 exec DYNAMICS..smGetBIMsgString  @I_iMessageNumber, @I_iAliasMessageNumber, @I_iDictID, @iLanguageID, @Change_Date output   select @sqldropstring =   'if exists (select * from dbo.sysobjects where id = object_id(N''[dbo].[Applicant]'') and OBJECTPROPERTY(id, N''IsView'') = 1) ' +  'drop view [dbo].[Applicant] '  select @sqldefaultstring =   'CREATE VIEW Applicant AS ' +   'select ' +   'rtrim([''HR_Applicant''].[FFIRSTNAME_I]) as ''' + @First_Name + ''', ' + 'rtrim([''HR_Applicant''].[LLASTNAME_I]) as ''' + @Last_Name + ''', ' + 'rtrim([''HR_Applicant''].[ADDRESS1]) as ''' + @Address_1 + ''', ' + 'rtrim([''HR_Applicant''].[ADDRESS2]) as ''' + @Address_2 + ''', ' + 'rtrim([''HR_Applicant''].[CITY]) as ''' + @City + ''', ' + 'rtrim([''HR_Applicant''].[STATE]) as ''' + @State + ''', ' + 'rtrim([''HR_Applicant''].[ZIPCODE_I]) as ''' + @Zip_Code + ''', ' + 'rtrim([''HR_Applicant''].[HOMEPHONE]) as ''' + @Home_Phone + ''', ' + 'rtrim([''HR_Applicant''].[WORKPHONE]) as ''' + @Work_Phone + ''', '   select @sqlstring1 =   '[''HR_Applicant''].[APPLICANTNUMBER_I] as ''' + @Applicant_Number + ''', ' +  '[''HR_Applicant''].[APPLYDATE_I] as ''' + @Apply_Date + ''', ' +  'rtrim([''HR_Applicant''].[CHANGEBY_I]) as ''' + @Change_By + ''', ' +  '[''HR_Applicant''].[CHANGEDATE_I] as ''' + @Change_Date + ''', ' +  '''' + @Color_Code + ''' = dbo.HR_FUNC_Color_Code([''HR_Applicant''].[COLORCODE_I]), ' +  'rtrim([''HR_Applicant''].[COLORSTRING_I]) as ''' + @Color_String + ''', ' +  'rtrim([''HR_Applicant''].[COMPANYCODE_I]) as ''' + @Company_Code + ''', ' +  'rtrim([''HR_Applicant''].[COUNTRY]) as ''' + @Country + ''', ' +  'rtrim([''HR_Applicant''].[DEPARTMENTCODE_I]) as ''' + @Department_Code + ''', ' +  'rtrim([''HR_Applicant''].[DSCRIPTN]) as ''' + @Description + ''', ' +  '''' + @Disabled_Veteran + ''' = dbo.DYN_FUNC_Boolean_All([''HR_Applicant''].[DISABLEDVETERAN]), ' +  'rtrim([''HR_Applicant''].[DIVISIONCODE_I]) as ''' + @Division_Code + ''', ' +  '''' + @EEO_Age + ''' = dbo.HR_FUNC_EEO_Age([''HR_Applicant''].[EEOAGE_I]), ' +  '''' + @EEO_Ethnic_Origin + ''' = dbo.HR_FUNC_Ethnic_Origin([''HR_Applicant''].[EEOETHNICORIGIN_I]), ' +  'rtrim([''HR_Applicant''].[EXT_I]) as ''' + @Ext + ''', ' +  '''' + @Gender_GB + ''' = dbo.HR_FUNC_Gender_GB([''HR_Applicant''].[GENDERGB_I]), ' +  '''' + @Handicapped + ''' = dbo.DYN_FUNC_Boolean_All([''HR_Applicant''].[HANDICAPPED]), ' +  'rtrim([''HR_Applicant''].[SSN_I]) as ''' + @ISSN + ''', ' +  '[''HR_Applicant''].[ISEQUENCENUMBER_I] as ''' + @ISequence_Number + ''', ' +  'rtrim([''HR_Applicant''].[LOCATNID]) as ''' + @Location_Code + ''', ' +  'rtrim([''HR_Applicant''].[MIDLNAME]) as ''' + @Middle_Name + ''', ' +  '[''HR_Applicant''].[NOTESINDEX_I] as ''' + @Notes_Index + ''', ' +  'rtrim([''HR_Applicant''].[POSITIONCODE_I]) as ''' + @Position_Code + ''', ' +  '''' + @Ref_Source_DDL + ''' = dbo.HR_FUNC_Ref_Source_DDL([''HR_Applicant''].[REFSOURCEDDL_I]), ' +  'rtrim([''HR_Applicant''].[DSCRIPTN]) as ''' + @Reject_Comment + ''', ' +  '''' + @Reject_Reason + ''' = dbo.HR_FUNC_Reject_Reason([''HR_Applicant''].[REJECTREASON_I]), ' +  '''' + @Relocation + ''' = dbo.HR_FUNC_Relocation([''HR_Applicant''].[RELOCATION_I]), ' +  '''' + @Reply_Letter_Sent + ''' = dbo.DYN_FUNC_Boolean_All([''HR_Applicant''].[REPLYLETTERSENT_I]), ' +  '[''HR_Applicant''].[REQUISITIONNUMBER_I] as ''' + @Requisition_Number + ''', ' +  '''' + @Status + ''' = dbo.HR_FUNC_Status_Applicant([''HR_Applicant''].[STATUS0_I]), ' +  '''' + @Veteran + ''' = dbo.DYN_FUNC_Boolean_All([''HR_Applicant''].[VETERAN]), ' +  '''' + @Vietnam_Veteran + ''' = dbo.DYN_FUNC_Boolean_All([''HR_Applicant''].[VIETNAMVETERAN]) '   select @sqljoinstring =   'from [HR2APP12] as [''HR_Applicant''] with (NOLOCK) '   select @sqlaccessstring =  'GRANT SELECT ON [dbo].[Applicant] TO [rpt_executive]' + 'GRANT SELECT ON [dbo].[Applicant] TO [rpt_human resource administrator]'   exec (@sqldropstring)  exec (@sqldefaultstring+' '+@sqlstring1+' '+@sqlstring2+' '+@sqlstring3+' '+@sqlstring4+' '+@sqlstring5+' '+@sqlstring6+' '+@sqlstring7+' '+@sqlstring8+' '+@sqlstring9+' '+@sqlstring10+' '+@sqljoinstring)  exec (@sqlaccessstring)   set nocount off    
GO
GRANT EXECUTE ON  [dbo].[sp_HumanResources_Applicant] TO [DYNGRP]
GO
